From MAILER-DAEMON Fri Mar 31 23:17:05 2006
Return-Path: 
 <hadoop-dev-return-649-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20204 invoked from network); 31 Mar 2006 23:17:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 23:17:05 -0000
Received: (qmail 89826 invoked by uid 500); 31 Mar 2006 23:17:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89799 invoked by uid 500); 31 Mar 2006 23:17:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89790 invoked by uid 99); 31 Mar 2006 23:17:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 15:17:04 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 15:17:03 -0800
Received: from [192.168.0.254] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k2VNGwQ06948
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 17:16:58 -0600
Message-ID: <442DB850.6040503@getopt.org>
Date: Sat, 01 Apr 2006 01:16:32 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Copy errors - unable to complete jobs.
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

I'm getting frequent errors running Nutch fetcher, but it seems to me 
the problem lies in Hadoop. As a result I'm unable to complete any fetching.

The environment seems healthy, it consists of 6 tasktracker/datanode 
machines and one jobtracker/nameserver.

The map phase works flawlessly. However, reduce tasks report two kinds 
of errors (and in the end the whole job fails):

* from time to time a reduce task would say "No valid local directories 
in property: mapred.local.dir" - but there is such a property defined in 
hadoop-site.xml, and it points to a valid location. These errors seem 
innocuous, and reducing continues anyway.

* 060331 055932 task_r_8kge0k copy failed: task_m_67k3s0 from 
nutch5.xxx.xxx/nnn.nnn.nnn.nnn:50040
java.io.IOException: timed out waiting for response
        at org.apache.hadoop.ipc.Client.call(Client.java:305)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141)
        at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
        at 
org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:106)
        at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:66)
060331 055932 task_r_8kge0k 0.07692308% reduce > copy > 
task_m_67k3s0@nutch5.xxx.xxx:50040
060331 055932 task_r_8kge0k Got 1 map output locations.

This error in the end is fatal. In the logs I can see that copying is 
attempted several times, but finally it gives up. The same problem 
occurs frequently for all reduce tasks, but most of the time it finally 
succeeds. If I could venture a wild guess I would say that some of the 
map output is removed prematurely; or perhaps the source node is so busy 
it cannot bother to response in a timely fashion?

What is especially irritating with these errors is that they happen at 
the very end of a long running job, where 99.5% of all work is done 
(including fetching millions pages from the 'net) - and all this work is 
irretrievably lost.

I dearly wish for an option in Hadoop that would allow me to keep at 
least the map results, and restart the job so that it performs just the 
reduce step. This way I wouldn't have to refetch a million pages... 
(which also speaks for processing smaller segments than larger).

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Sat Apr  1 08:21:49 2006
Return-Path: 
 <hadoop-dev-return-650-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86758 invoked from network); 1 Apr 2006 08:21:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 08:21:49 -0000
Received: (qmail 76444 invoked by uid 500); 1 Apr 2006 08:21:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76433 invoked by uid 500); 1 Apr 2006 08:21:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76424 invoked by uid 99); 1 Apr 2006 08:21:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 00:21:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 00:21:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CE09D6ACB2
	for <hadoop-dev@lucene.apache.org>; Sat,  1 Apr 2006 09:21:26 +0100 (BST)
Message-ID: <1179424213.1143879686841.JavaMail.jira@ajax>
Date: Sat, 1 Apr 2006 09:21:26 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Reopened: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-115?page=all ]
     
Owen O'Malley reopened HADOOP-115:
----------------------------------


Let's reopen this. I've had discussions with Runping today, and it seems to me that:

1. It is basically free with respect to the framework.
2. It allows more applications to be written using the framework rather than working around the framework.
3. It is less clear that we should allow the user to change the key type in the reduce, but since the current API does allow them to change the value (if not the type), I think we should be consistent and allow a type change too.

I propose:

1. Add {set,get}MapOutput{Key,Value}Class functions in JobConf.
2. The default values for getMapOutput{Key,Value}Class are the values from getOutput{Key,Value}Class.
3. Always check the types in the output collector rather that the OutputFormat, so that even text output files are check for type correctness.

We should include a javadoc comment for setMapOutputKeyClass will warn that changing the key in the reduce will mean that your output is NOT sorted.

> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  1 14:45:49 2006
Return-Path: 
 <hadoop-dev-return-651-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12488 invoked from network); 1 Apr 2006 14:45:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 14:45:49 -0000
Received: (qmail 98263 invoked by uid 500); 1 Apr 2006 14:45:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98235 invoked by uid 500); 1 Apr 2006 14:45:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98226 invoked by uid 99); 1 Apr 2006 14:45:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 06:45:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 06:45:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B7C4A6ACB2
	for <hadoop-dev@lucene.apache.org>; Sat,  1 Apr 2006 15:45:26 +0100 (BST)
Message-ID: <1240542043.1143902726750.JavaMail.jira@ajax>
Date: Sat, 1 Apr 2006 15:45:26 +0100 (BST)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12372781 ] 

eric baldeschwieler commented on HADOOP-115:
--------------------------------------------

+1

But MapOutput seems confusing.  Shouldn't these be called FinalOutput or ReduceOutput?


> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  1 15:37:49 2006
Return-Path: 
 <hadoop-dev-return-652-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27324 invoked from network); 1 Apr 2006 15:37:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 15:37:49 -0000
Received: (qmail 33419 invoked by uid 500); 1 Apr 2006 15:37:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33398 invoked by uid 500); 1 Apr 2006 15:37:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33389 invoked by uid 99); 1 Apr 2006 15:37:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 07:37:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 07:37:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7EC7A6ACB2
	for <hadoop-dev@lucene.apache.org>; Sat,  1 Apr 2006 16:37:27 +0100 (BST)
Message-ID: <2006631731.1143905847516.JavaMail.jira@ajax>
Date: Sat, 1 Apr 2006 16:37:27 +0100 (BST)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12372783 ] 

eric baldeschwieler commented on HADOOP-115:
--------------------------------------------

Ah!  Are you suggesting that getOutput* describes the final classes output from reduce always and if you don't set the new variables MapOutput* it also controls the map?  That is clear enough and backwards compatible.  I just was not looking at it the right way!


> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  1 17:19:50 2006
Return-Path: 
 <hadoop-dev-return-653-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59953 invoked from network); 1 Apr 2006 17:19:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 17:19:50 -0000
Received: (qmail 29729 invoked by uid 500); 1 Apr 2006 17:19:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29711 invoked by uid 500); 1 Apr 2006 17:19:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29700 invoked by uid 99); 1 Apr 2006 17:19:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 09:19:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 09:19:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DEA486ACB3
	for <hadoop-dev@lucene.apache.org>; Sat,  1 Apr 2006 18:19:27 +0100 (BST)
Message-ID: <794631863.1143911967909.JavaMail.jira@ajax>
Date: Sat, 1 Apr 2006 18:19:27 +0100 (BST)
From: "Teppo Kurki (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12372790 ] 

Teppo Kurki commented on HADOOP-115:
------------------------------------

+1

My original post about the issue gives a simple case that would benefit from this: http://www.mail-archive.com/hadoop-user%40lucene.apache.org/msg00073.html

As already said, this would add more transformational power to Hadoop and make certain cases more straightforward.



> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  1 17:25:59 2006
Return-Path: 
 <hadoop-dev-return-654-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64627 invoked from network); 1 Apr 2006 17:25:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 17:25:59 -0000
Received: (qmail 32597 invoked by uid 500); 1 Apr 2006 17:25:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32580 invoked by uid 500); 1 Apr 2006 17:25:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32570 invoked by uid 99); 1 Apr 2006 17:25:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 09:25:58 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [64.62.190.91] (HELO mcnabbs.org) (64.62.190.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 09:25:57 -0800
Received: from mcbain.mcnabbs.org (c-67-169-251-185.hsd1.ut.comcast.net
 [67.169.251.185])
	by mcnabbs.org (Postfix) with ESMTP id 7AB1C3759D
	for <hadoop-dev@lucene.apache.org>; Sat,  1 Apr 2006 11:25:36 -0600 (CST)
Received: by mcbain.mcnabbs.org (Postfix, from userid 1001)
	id 02E93E792A; Sat,  1 Apr 2006 10:25:34 -0700 (MST)
Date: Sat, 1 Apr 2006 10:25:34 -0700
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Reopened: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
Message-ID: <20060401172534.GB32496@mcnabbs.org>
References: <393765989.1143819100222.JavaMail.jira@ajax>
 <1179424213.1143879686841.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="WIyZ46R2i8wDzkSu"
Content-Disposition: inline
In-Reply-To: <1179424213.1143879686841.JavaMail.jira@ajax>
User-Agent: Mutt/1.5.11+cvs20060126
From: amcnabb@mcnabbs.org (Andrew McNabb)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--WIyZ46R2i8wDzkSu
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Sat, Apr 01, 2006 at 09:21:26AM +0100, Owen O'Malley (JIRA) wrote:
>=20
> Let's reopen this. I've had discussions with Runping today, and it seems =
to me that:


> 3. It is less clear that we should allow the user to change the key
> type in the reduce, but since the current API does allow them to
> change the value (if not the type), I think we should be consistent
> and allow a type change too.

I strongly disagree.  I think it's unnecessary, and I think it breaks
the model too much.  Google has many thousands of map reduce
applications, and they haven't broken the model yet.  I don't really
care about output formats, but I think we're just asking for trouble if
we allow the type of the reduce output to be different from the type of
the map output.

--=20
Andrew McNabb
http://www.mcnabbs.org/andrew/
PGP Fingerprint: 8A17 B57C 6879 1863 DE55  8012 AB4D 6098 8826 6868

--WIyZ46R2i8wDzkSu
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)

iD8DBQFELreOq01gmIgmaGgRArZgAJ94DTJPjn3xDHXRKxo7T90AElH5+QCfU5fx
D2hN3YWtbG9wnIzKp6WYBAg=
=7bTD
-----END PGP SIGNATURE-----

--WIyZ46R2i8wDzkSu--

From MAILER-DAEMON Sat Apr  1 17:29:50 2006
Return-Path: 
 <hadoop-dev-return-655-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66866 invoked from network); 1 Apr 2006 17:29:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 17:29:50 -0000
Received: (qmail 36782 invoked by uid 500); 1 Apr 2006 17:29:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36759 invoked by uid 500); 1 Apr 2006 17:29:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36742 invoked by uid 99); 1 Apr 2006 17:29:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 09:29:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [64.62.190.91] (HELO mcnabbs.org) (64.62.190.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 09:29:48 -0800
Received: from mcbain.mcnabbs.org (c-67-169-251-185.hsd1.ut.comcast.net
 [67.169.251.185])
	by mcnabbs.org (Postfix) with ESMTP id 94F273759D
	for <hadoop-dev@lucene.apache.org>; Sat,  1 Apr 2006 11:29:27 -0600 (CST)
Received: by mcbain.mcnabbs.org (Postfix, from userid 1001)
	id 8C565E792A; Sat,  1 Apr 2006 10:29:26 -0700 (MST)
Date: Sat, 1 Apr 2006 10:29:26 -0700
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
Message-ID: <20060401172926.GC32496@mcnabbs.org>
References: <393765989.1143819100222.JavaMail.jira@ajax>
 <794631863.1143911967909.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="rJwd6BRFiFCcLxzm"
Content-Disposition: inline
In-Reply-To: <794631863.1143911967909.JavaMail.jira@ajax>
User-Agent: Mutt/1.5.11+cvs20060126
From: amcnabb@mcnabbs.org (Andrew McNabb)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--rJwd6BRFiFCcLxzm
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Sat, Apr 01, 2006 at 06:19:27PM +0100, Teppo Kurki (JIRA) wrote:
>=20
> My original post about the issue gives a simple case that would benefit f=
rom this: http://www.mail-archive.com/hadoop-user%40lucene.apache.org/msg00=
073.html
>=20

This should be done in two map-reduce phases.  There's nothing wrong
with running two phases (or 10,000).

--=20
Andrew McNabb
http://www.mcnabbs.org/andrew/
PGP Fingerprint: 8A17 B57C 6879 1863 DE55  8012 AB4D 6098 8826 6868

--rJwd6BRFiFCcLxzm
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)

iD8DBQFELrh2q01gmIgmaGgRAgFLAJ48FJIeEKG2FXC/8ounm8ckfvxI4gCfbBcR
RZWmF1k03k1NUvnlBjFvPT0=
=jqPP
-----END PGP SIGNATURE-----

--rJwd6BRFiFCcLxzm--

From MAILER-DAEMON Sat Apr  1 21:27:51 2006
Return-Path: 
 <hadoop-dev-return-656-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45320 invoked from network); 1 Apr 2006 21:27:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 21:27:51 -0000
Received: (qmail 72070 invoked by uid 500); 1 Apr 2006 21:27:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72045 invoked by uid 500); 1 Apr 2006 21:27:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72036 invoked by uid 99); 1 Apr 2006 21:27:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 13:27:50 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 13:27:49 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CA8F16ACB3
	for <hadoop-dev@lucene.apache.org>; Sat,  1 Apr 2006 22:27:28 +0100 (BST)
Message-ID: <26503057.1143926848827.JavaMail.jira@ajax>
Date: Sat, 1 Apr 2006 22:27:28 +0100 (BST)
From: "Teppo Kurki (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12372801 ] 

Teppo Kurki commented on HADOOP-115:
------------------------------------

" I.e., the input keys and values are drawn from a different
  domain than the output keys and values. Furthermore,
  the intermediate keys and values are from the same domain
  as the output keys and values. "

The Google MapReduce paper states the Web-Link graph example where this is not the case:

"Reverse Web-Link Graph: The map function outputs
(target; source) pairs for each link to a target
URL found in a page named source. The reduce
function concatenates the list of all source URLs associated
with a given target URL and emits the pair:
(target; list(source))".



> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  1 22:15:50 2006
Return-Path: 
 <hadoop-dev-return-657-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54526 invoked from network); 1 Apr 2006 22:15:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 22:15:50 -0000
Received: (qmail 97027 invoked by uid 500); 1 Apr 2006 22:15:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96935 invoked by uid 500); 1 Apr 2006 22:15:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96926 invoked by uid 99); 1 Apr 2006 22:15:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 14:15:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 14:15:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id EE8976ACB4
	for <hadoop-dev@lucene.apache.org>; Sat,  1 Apr 2006 23:15:27 +0100 (BST)
Message-ID: <1170089505.1143929727974.JavaMail.jira@ajax>
Date: Sat, 1 Apr 2006 23:15:27 +0100 (BST)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12372803 ] 

Bryan Pendleton commented on HADOOP-115:
----------------------------------------

I've implemented the above case with the existing code, and it's pretty simple... the output is actually always list(source), or perhaps a new type that encapsulates the list, and it just means that the map actually outputs a list of length 1, and the combiner/reducer concatenates lists.

> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  1 22:29:40 2006
Return-Path: 
 <hadoop-dev-return-658-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60491 invoked from network); 1 Apr 2006 22:29:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Apr 2006 22:29:40 -0000
Received: (qmail 6199 invoked by uid 500); 1 Apr 2006 22:29:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6182 invoked by uid 500); 1 Apr 2006 22:29:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6155 invoked by uid 99); 1 Apr 2006 22:29:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 14:29:39 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [194.215.205.14] (HELO ultra14.almamedia.fi) (194.215.205.14)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 01 Apr 2006 14:29:38 -0800
Received: (qmail 26624 invoked from network); 1 Apr 2006 22:29:15 -0000
Received: from unknown (HELO ?193.211.51.32?) (193.211.51.32)
  by ultra14g.almamedia.fi with SMTP; 1 Apr 2006 22:29:15 -0000
Message-ID: <442EFEBB.7060501@iki.fi>
Date: Sun, 02 Apr 2006 01:29:15 +0300
From: Teppo Kurki <tjk@iki.fi>
User-Agent: Mozilla Thunderbird 1.0.7 (Windows/20050923)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: TextInputFormat performance improvements
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Just a few patches that made a surprisingly big difference in my pet 
project:

As TextInputFormat parses the input it creates first a String which is 
stored in an UTF8. If the Map operation does not use directly UTF8's 
internal byte array and accesses the contents via toString() the 
encoding and decoding is just cpu overhead.

By using a separate StringHolder (for lack of a better name) interface 
would make it possible to swap out another, maybe more efficient  
implementation via JobConf.setInputValueClass.

It seems that TextInputFormat.readLine does not have to be static and 
the StringBuffer can be reused.  If it needs to be static the 
StringBuffer's internal buffer can be preallocated.

Hope this helps someone...

Index: 
C:/data/eclipse_workspace/hadoop/src/java/org/apache/hadoop/io/UTF8.java
===================================================================
--- 
C:/data/eclipse_workspace/hadoop/src/java/org/apache/hadoop/io/UTF8.java    
(revision 389671)
+++ 
C:/data/eclipse_workspace/hadoop/src/java/org/apache/hadoop/io/UTF8.java    
(working copy)
@@ -21,8 +21,11 @@
 import java.io.DataOutput;
 
 import java.util.logging.Logger;
+
+import org.apache.hadoop.mapred.TextInputFormat;
 import org.apache.hadoop.util.LogFormatter;
 
+
 /** A WritableComparable for strings that uses the UTF8 encoding.
  *
  * <p>Also includes utilities for efficiently reading and writing UTF-8.
@@ -29,7 +32,7 @@
  *
  * @author Doug Cutting
  */
-public class UTF8 implements WritableComparable {
+public class UTF8 implements WritableComparable, 
TextInputFormat.StringHolder {
   private static final Logger LOG= 
LogFormatter.getLogger("org.apache.hadoop.io.UTF8");
   private static final DataOutputBuffer OBUF = new DataOutputBuffer();
   private static final DataInputBuffer IBUF = new DataInputBuffer();
Index: 
C:/data/eclipse_workspace/hadoop/src/java/org/apache/hadoop/mapred/TextInputFormat.java
===================================================================
--- 
C:/data/eclipse_workspace/hadoop/src/java/org/apache/hadoop/mapred/TextInputFormat.java    
(revision 389671)
+++ 
C:/data/eclipse_workspace/hadoop/src/java/org/apache/hadoop/mapred/TextInputFormat.java    
(working copy)
@@ -29,6 +29,10 @@
  * Either linefeed or carriage-return are used to signal end of line.  
Keys are
  * the position in the file, and values are the line of text.. */
 public class TextInputFormat extends InputFormatBase {
+  private StringBuffer buffer = new StringBuffer(24 * 80); //preallocate
+  public interface StringHolder extends Writable {
+    public void set(String s);
+  }
 
   public RecordReader getRecordReader(FileSystem fs, FileSplit split,
                                       JobConf job, Reporter reporter)
@@ -61,7 +65,7 @@
             return false;
 
           ((LongWritable)key).set(pos);           // key is position
-          ((UTF8)value).set(readLine(in));        // value is line
+          ((StringHolder)value).set(readLine(in));        // value is line
           return true;
         }
        
@@ -74,8 +78,8 @@
       };
   }
 
-  private static String readLine(FSDataInputStream in) throws IOException {
-    StringBuffer buffer = new StringBuffer();
+  private String readLine(FSDataInputStream in) throws IOException {
+    buffer.setLength(0);
     while (true) {
 
       int b = in.read();


From MAILER-DAEMON Sun Apr  2 00:40:11 2006
Return-Path: 
 <hadoop-dev-return-659-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94481 invoked from network); 2 Apr 2006 00:40:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Apr 2006 00:40:11 -0000
Received: (qmail 82105 invoked by uid 500); 2 Apr 2006 00:40:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82082 invoked by uid 500); 2 Apr 2006 00:40:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82068 invoked by uid 99); 2 Apr 2006 00:40:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 16:40:10 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Apr 2006 16:40:09 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k320dPHg052510
	for <hadoop-dev@lucene.apache.org>; Sat, 1 Apr 2006 16:39:25 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=ZF0bkMESh7lhdQJULtZu1chhjC38e0SH7eQ7b+U6dUxEJfT3nA+PftyGcFOvTNhU
Received: from [10.0.1.4] ([172.21.179.133]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Sat, 1 Apr 2006 16:39:23 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <20060401172926.GC32496@mcnabbs.org>
References: <393765989.1143819100222.JavaMail.jira@ajax>
 <794631863.1143911967909.JavaMail.jira@ajax>
 <20060401172926.GC32496@mcnabbs.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <F26D1A07-9CF5-45FF-A546-F6ACAEF22658@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
Date: Sat, 1 Apr 2006 16:39:21 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 02 Apr 2006 00:39:23.0965 (UTC)
 FILETIME=[E388EED0:01C655ED]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Sure there is something wrong with requiring extra map-reduce  
passes.  Without significant development it can be very expensive  
(shuffling, sorting and rewriting your whole output set can be a  
significant burden).  Pointlessly so, since the extension is clear,  
safe and easier to explain then the restriction.

I think we can all agree that a project goal is to keep the design as  
simple and focused as possible.  I'd find an argument against an  
extension based on those goals pretty compelling, but the lack of a  
feature in a paper from google doesn't seem like a compelling reason  
to reject something.  The hadoop approach to many decisions varies  
from google's, this is not a bad thing.

I can not think of a case where this proposed extension complicates  
code or reduces compressibility.  Since it is backwards compatible  
with your desired API, purists can simply ignore the option.

On Apr 1, 2006, at 9:29 AM, Andrew McNabb wrote:

> On Sat, Apr 01, 2006 at 06:19:27PM +0100, Teppo Kurki (JIRA) wrote:
>>
>> My original post about the issue gives a simple case that would  
>> benefit from this: http://www.mail-archive.com/hadoop-user% 
>> 40lucene.apache.org/msg00073.html
>>
>
> This should be done in two map-reduce phases.  There's nothing wrong
> with running two phases (or 10,000).
>
> -- 
> Andrew McNabb
> http://www.mcnabbs.org/andrew/
> PGP Fingerprint: 8A17 B57C 6879 1863 DE55  8012 AB4D 6098 8826 6868


From MAILER-DAEMON Sun Apr  2 19:44:41 2006
Return-Path: 
 <hadoop-dev-return-660-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13612 invoked from network); 2 Apr 2006 19:44:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Apr 2006 19:44:41 -0000
Received: (qmail 99491 invoked by uid 500); 2 Apr 2006 19:44:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99469 invoked by uid 500); 2 Apr 2006 19:44:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99460 invoked by uid 99); 2 Apr 2006 19:44:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Apr 2006 12:44:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Apr 2006 12:44:40 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k32JiDbL021807
	for <hadoop-dev@lucene.apache.org>; Sun, 2 Apr 2006 15:44:13 -0400
X-ORBL: [69.228.236.205]
Received: from [192.168.168.15] (adsl-69-228-236-205.dsl.pltn13.pacbell.net
 [69.228.236.205])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k32Ji7ka228788;
	Sun, 2 Apr 2006 15:44:12 -0400
Message-ID: <44302987.4090506@apache.org>
Date: Sun, 02 Apr 2006 12:44:07 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: release 0.1.0 available
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Release 0.1.0 of Hadoop is now available.

The release may be downloaded from:

   http://www.apache.org/dyn/closer.cgi/lucene/hadoop/

Developers:

The tagged release is in Subversion at:

   https://svn.apache.org/repos/asf/lucene/hadoop/tags/release-0.1.0/

The branch for future 0.1.x releases is at:

   https://svn.apache.org/repos/asf/lucene/hadoop/branches/branch-0.1/

However we should continue to primarily develop in trunk, and backport 
patches to the 0.1 branch using 'svn merge' with a commit message that 
names both the Jira bug number and the Subversion revision numbers merged.

The release procedure I used is documented at:

   http://wiki.apache.org/lucene-hadoop/HowToRelease

Doug

From MAILER-DAEMON Sun Apr  2 20:30:32 2006
Return-Path: 
 <hadoop-dev-return-661-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32623 invoked from network); 2 Apr 2006 20:30:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Apr 2006 20:30:32 -0000
Received: (qmail 38659 invoked by uid 500); 2 Apr 2006 20:30:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38641 invoked by uid 500); 2 Apr 2006 20:30:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38632 invoked by uid 99); 2 Apr 2006 20:30:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Apr 2006 13:30:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Apr 2006 13:30:30 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k32KU6ai005166
	for <hadoop-dev@lucene.apache.org>; Sun, 2 Apr 2006 16:30:06 -0400
X-ORBL: [69.228.236.205]
Received: from [192.168.168.15] (adsl-69-228-236-205.dsl.pltn13.pacbell.net
 [69.228.236.205])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k32KTsaL097442;
	Sun, 2 Apr 2006 16:29:59 -0400
Message-ID: <44303442.4090604@apache.org>
Date: Sun, 02 Apr 2006 13:29:54 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
References: <393765989.1143819100222.JavaMail.jira@ajax>
 <794631863.1143911967909.JavaMail.jira@ajax>
 <20060401172926.GC32496@mcnabbs.org>
 <F26D1A07-9CF5-45FF-A546-F6ACAEF22658@yahoo-inc.com>
In-Reply-To: <F26D1A07-9CF5-45FF-A546-F6ACAEF22658@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
> I can not think of a case where this proposed extension complicates  
> code or reduces compressibility.  Since it is backwards compatible  with 
> your desired API, purists can simply ignore the option.

It makes the insertion of a combiner no longer transparent.  The reducer 
would have to know whether a combiner had been used in order to know how 
to process the map output.

In general this seems like a micro-optimization.  It saves little code. 
  Instead of writing 'collector.collect(key, new List(value))' one could 
write 'collector.collect(key, value)'.

Taking this to its logical extreme, in the classic word-count use of 
MapReduce, why should one have to emit ones for the map values?  Why 
have a value at all?  Why not add a collect(key) method, then permit 
reducers to be passed an iterator which returns null for all values 
where collect(key) was called.  That would save a little code and make 
the intermediate data a bit smaller.  So should we do it?  I'd argue not.

Doug

From MAILER-DAEMON Sun Apr  2 23:26:39 2006
Return-Path: 
 <hadoop-dev-return-662-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76457 invoked from network); 2 Apr 2006 23:26:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Apr 2006 23:26:39 -0000
Received: (qmail 22543 invoked by uid 500); 2 Apr 2006 23:26:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22517 invoked by uid 500); 2 Apr 2006 23:26:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22508 invoked by uid 99); 2 Apr 2006 23:26:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Apr 2006 16:26:38 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Apr 2006 16:26:38 -0700
Received: from explainfloorlx (snvvpn2-10-72-76-c96.corp.yahoo.com
 [10.72.76.96])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k32NQ0Sk009282
	for <hadoop-dev@lucene.apache.org>; Sun, 2 Apr 2006 16:26:01 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=B3u0LZ1+/ukSkjnncYARQUwpc4YyclYCA9Q0xX+en0qIXynGANrudn4MV6AQDWLV
From: "Runping Qi" <runping@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
Date: Sun, 2 Apr 2006 16:27:59 -0700
Message-ID: <00a801c656ad$1467b670$e6e77ecf@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <44303442.4090604@apache.org>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZWlFW5YYIMwkN2R4+VIIGjcK3rqAAEsR9Q
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


The argument of using local combiners is interesting. To me, combiner class
is just another layer of transformer.  It does not mean that the combiner
class has to be the same as the reducer class. The only criteria is that
they meet the associate rule:  
	Let L1, L2, ..., Ln and K1, K2, .., Km be two partitions of S, then 
	Reduce(list(Combiner(L1), Combiner(L2),..., Combiner(Ln))) and 
	Reduce(list(Combiner(K1), Combiner(K2), ..., Combiner(Km)) are the
same.

A special (maybe very common) scenario is that combiner and reducer are the
same class and reduce function is associate. However, this needs not to be
the case in general. And the class of the reduce outputs need not to be the
same as that of the combiner, if the combiner and the reducer are not the
same class.
 

Runping

-----Original Message-----
From: Doug Cutting [mailto:cutting@apache.org] 
Sent: Sunday, April 02, 2006 1:30 PM
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
use SequentialFileOutputformat as the output format and to choose key/value
classes that are different from those for map output.

Eric Baldeschwieler wrote:
> I can not think of a case where this proposed extension complicates  
> code or reduces compressibility.  Since it is backwards compatible  with 
> your desired API, purists can simply ignore the option.

It makes the insertion of a combiner no longer transparent.  The reducer 
would have to know whether a combiner had been used in order to know how 
to process the map output.

In general this seems like a micro-optimization.  It saves little code. 
  Instead of writing 'collector.collect(key, new List(value))' one could 
write 'collector.collect(key, value)'.

Taking this to its logical extreme, in the classic word-count use of 
MapReduce, why should one have to emit ones for the map values?  Why 
have a value at all?  Why not add a collect(key) method, then permit 
reducers to be passed an iterator which returns null for all values 
where collect(key) was called.  That would save a little code and make 
the intermediate data a bit smaller.  So should we do it?  I'd argue not.

Doug



From MAILER-DAEMON Mon Apr  3 05:29:43 2006
Return-Path: 
 <hadoop-dev-return-663-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91001 invoked from network); 3 Apr 2006 05:29:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 05:29:43 -0000
Received: (qmail 6613 invoked by uid 500); 3 Apr 2006 05:29:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6585 invoked by uid 500); 3 Apr 2006 05:29:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6576 invoked by uid 99); 3 Apr 2006 05:29:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Apr 2006 22:29:42 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Apr 2006 22:29:41 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k335TEbL002199
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 01:29:14 -0400
X-ORBL: [69.228.236.205]
Received: from [192.168.168.15] (adsl-69-228-236-205.dsl.pltn13.pacbell.net
 [69.228.236.205])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k335TALa134532;
	Mon, 3 Apr 2006 01:29:14 -0400
Message-ID: <4430B2A5.3000203@apache.org>
Date: Sun, 02 Apr 2006 22:29:09 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
References: <00a801c656ad$1467b670$e6e77ecf@ds.corp.yahoo.com>
In-Reply-To: <00a801c656ad$1467b670$e6e77ecf@ds.corp.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Runping Qi wrote:
> The argument of using local combiners is interesting. To me, combiner class
> is just another layer of transformer.  It does not mean that the combiner
> class has to be the same as the reducer class. The only criteria is that
> they meet the associate rule:  
> 	Let L1, L2, ..., Ln and K1, K2, .., Km be two partitions of S, then 
> 	Reduce(list(Combiner(L1), Combiner(L2),..., Combiner(Ln))) and 
> 	Reduce(list(Combiner(K1), Combiner(K2), ..., Combiner(Km)) are the
> same.
> 
> A special (maybe very common) scenario is that combiner and reducer are the
> same class and reduce function is associate. However, this needs not to be
> the case in general. And the class of the reduce outputs need not to be the
> same as that of the combiner, if the combiner and the reducer are not the
> same class.

This indeed may be be an intriguing generalization of the MapReduce 
model.  But it does add more possible failure modes.  At present we have 
far too few unit tests for the existing, simpler MapReduce model, and 
the platform is still shakey.  Thus I am reluctant to spend a lot of 
extending the model in ways that are not absolutely essential.

My goal is for Hadoop to be widely used.  I do not feel that the power 
of the MapReduce model is currently a primary bottleneck to wider 
adoption.  The larger issues we face are performance, reliability, 
scalability and documentation.

If I am to commit a patch, then I must feel that I can support and 
maintain it, that it fits within my priorities.  Otherwise, if it causes 
problems that I don't have time to attend to (even if this only means 
reviewing and testing fixes submitted by others) then the quality of the 
system will decrease, a vector we must avoid.

Currently we have just four committers on Hadoop.  For Mike and Andrzej, 
Nutch is a secondary effort.  Owen has been voted in as a Hadoop 
committer, but his paperwork is not yet complete.  So I am the 
bottleneck.  I spend a lot of time on annoying yet critical issues like 
making sure that recent extensions to Hadoop don't break Nutch running 
in pseudo-distributed mode on Windows.

I don't particularly like things this way, but that's where we are right 
now.  The best way to get out of here is for folks who'd like to be 
committers to submit high-quality, well documented, well-formatted, 
non-disruptive, unit-test-bearing patches that are easy for me to apply 
and make Hadoop easier to use and more reliable, thus earning points 
towards becoming committers.  If we have more committers then we should 
be able to advance with confidence on more fronts in parallel.

Doug

From MAILER-DAEMON Mon Apr  3 17:30:09 2006
Return-Path: 
 <hadoop-dev-return-665-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23132 invoked from network); 3 Apr 2006 17:30:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 17:30:09 -0000
Received: (qmail 96193 invoked by uid 500); 3 Apr 2006 17:30:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96163 invoked by uid 500); 3 Apr 2006 17:30:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96152 invoked by uid 99); 3 Apr 2006 17:30:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 10:30:08 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 10:30:06 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k33HScNJ046475
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 10:28:38 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=Dpj5LH/NcSOQu6gbM5CooxaSh1AOP+INOudUuUwrVbJESdEnO7M3sEgk8Rvo1aQe
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 3 Apr 2006 10:28:35 -0700
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <4430B2A5.3000203@apache.org>
References: <00a801c656ad$1467b670$e6e77ecf@ds.corp.yahoo.com>
 <4430B2A5.3000203@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <EE7EDF1D-B91B-408D-8AA9-1FB65A308376@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
Date: Mon, 3 Apr 2006 08:51:04 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 03 Apr 2006 17:28:35.0833 (UTC)
 FILETIME=[09AC7E90:01C65744]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

An observation...  this whole thread is about limits caused by type  
safety.  Interestingly, the other implementation of map-reduce does  
not support types at all.  Everything is a string.

So I agree that our departure from the paper is the problem.  ;-)

I'm comfortable letting this lie for a while.  But I predict we've  
not heard the last of it.

On Apr 2, 2006, at 10:29 PM, Doug Cutting wrote:

> Runping Qi wrote:
>> The argument of using local combiners is interesting. To me,  
>> combiner class
>> is just another layer of transformer.  It does not mean that the  
>> combiner
>> class has to be the same as the reducer class. The only criteria  
>> is that
>> they meet the associate rule:  	Let L1, L2, ..., Ln and K1,  
>> K2, .., Km be two partitions of S, then 	Reduce(list(Combiner(L1),  
>> Combiner(L2),..., Combiner(Ln))) and 	Reduce(list(Combiner(K1),  
>> Combiner(K2), ..., Combiner(Km)) are the
>> same.
>> A special (maybe very common) scenario is that combiner and  
>> reducer are the
>> same class and reduce function is associate. However, this needs  
>> not to be
>> the case in general. And the class of the reduce outputs need not  
>> to be the
>> same as that of the combiner, if the combiner and the reducer are  
>> not the
>> same class.
>
> This indeed may be be an intriguing generalization of the MapReduce  
> model.  But it does add more possible failure modes.  At present we  
> have far too few unit tests for the existing, simpler MapReduce  
> model, and the platform is still shakey.  Thus I am reluctant to  
> spend a lot of extending the model in ways that are not absolutely  
> essential.
>
> My goal is for Hadoop to be widely used.  I do not feel that the  
> power of the MapReduce model is currently a primary bottleneck to  
> wider adoption.  The larger issues we face are performance,  
> reliability, scalability and documentation.
>
> If I am to commit a patch, then I must feel that I can support and  
> maintain it, that it fits within my priorities.  Otherwise, if it  
> causes problems that I don't have time to attend to (even if this  
> only means reviewing and testing fixes submitted by others) then  
> the quality of the system will decrease, a vector we must avoid.
>
> Currently we have just four committers on Hadoop.  For Mike and  
> Andrzej, Nutch is a secondary effort.  Owen has been voted in as a  
> Hadoop committer, but his paperwork is not yet complete.  So I am  
> the bottleneck.  I spend a lot of time on annoying yet critical  
> issues like making sure that recent extensions to Hadoop don't  
> break Nutch running in pseudo-distributed mode on Windows.
>
> I don't particularly like things this way, but that's where we are  
> right now.  The best way to get out of here is for folks who'd like  
> to be committers to submit high-quality, well documented, well- 
> formatted, non-disruptive, unit-test-bearing patches that are easy  
> for me to apply and make Hadoop easier to use and more reliable,  
> thus earning points towards becoming committers.  If we have more  
> committers then we should be able to advance with confidence on  
> more fronts in parallel.
>
> Doug


From MAILER-DAEMON Mon Apr  3 16:15:19 2006
Return-Path: 
 <hadoop-dev-return-664-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72863 invoked from network); 3 Apr 2006 16:15:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 16:15:19 -0000
Received: (qmail 68534 invoked by uid 500); 3 Apr 2006 16:15:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68510 invoked by uid 500); 3 Apr 2006 16:15:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68501 invoked by uid 99); 3 Apr 2006 16:15:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 09:15:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 09:15:17 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 94128D4A01
	for <hadoop-dev@lucene.apache.org>; Mon,  3 Apr 2006 17:14:56 +0100 (BST)
Message-ID: <517786485.1144080896603.JavaMail.jira@ajax>
Date: Mon, 3 Apr 2006 17:14:56 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12372967 ] 

Owen O'Malley commented on HADOOP-115:
--------------------------------------

I should have addressed the combiner before. *smile* Of course the combiner input and output has to match the map output types. So, it looks like:

map: k1,v1 -> seq(k2,v2)
combine: k2,seq(v2) -> seq(k2,v2)
reduce: k2, seq(v2) -> seq(k3,v3)

So the only extra code is to set/get the types for k2/v2 (or equivalent k3/v3), although I would recommend adding a type check in the reduce collector. It is completely upward compatible.

As for user confusion, I've already had to explain this restriction (k2==k3 and v2==v3) far more times than I'd like.

On a side note, we could hack around the problem by defining an OutputFormat that uses SequenceFileWriter, but doesn't open the file until the first key/value pair is written and takes the types from the first instances. But that breaks when someone puts the type check into the reduce collector.

> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr  3 17:45:41 2006
Return-Path: 
 <hadoop-dev-return-666-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32182 invoked from network); 3 Apr 2006 17:45:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 17:45:41 -0000
Received: (qmail 23056 invoked by uid 500); 3 Apr 2006 17:45:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23037 invoked by uid 500); 3 Apr 2006 17:45:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23028 invoked by uid 99); 3 Apr 2006 17:45:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 10:45:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 10:45:40 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k33HjDbL012373
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 13:45:13 -0400
X-ORBL: [69.228.236.205]
Received: from [192.168.168.15] (adsl-69-228-236-205.dsl.pltn13.pacbell.net
 [69.228.236.205])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k33HjGoO069408;
	Mon, 3 Apr 2006 13:45:17 -0400
Message-ID: <44315F2C.9080209@apache.org>
Date: Mon, 03 Apr 2006 10:45:16 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
References: <00a801c656ad$1467b670$e6e77ecf@ds.corp.yahoo.com>
 <4430B2A5.3000203@apache.org>
 <EE7EDF1D-B91B-408D-8AA9-1FB65A308376@yahoo-inc.com>
In-Reply-To: <EE7EDF1D-B91B-408D-8AA9-1FB65A308376@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
> An observation...  this whole thread is about limits caused by type  
> safety.  Interestingly, the other implementation of map-reduce does  not 
> support types at all.  Everything is a string.
> 
> So I agree that our departure from the paper is the problem.  ;-)

A corollary is that one could simply use BytesWritable for all one's 
keys and values, altering only one's WritableComparator implementation, 
and one would not encounter this problem.  The use of types in Hadoop is 
thus an optional feature.  One could even layer a different type system 
on top of BytesWritable that exhibits the desired properties.

> I'm comfortable letting this lie for a while.  But I predict we've  not 
> heard the last of it.

Owen seems to be picking it up, which is fine by me.

Doug

From MAILER-DAEMON Mon Apr  3 20:35:52 2006
Return-Path: 
 <hadoop-dev-return-667-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42007 invoked from network); 3 Apr 2006 20:35:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 20:35:52 -0000
Received: (qmail 84267 invoked by uid 500); 3 Apr 2006 20:35:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84168 invoked by uid 500); 3 Apr 2006 20:35:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84133 invoked by uid 99); 3 Apr 2006 20:35:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 13:35:44 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 13:35:41 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k33KYXm7017912
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 13:34:33 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=fhyowpm22l4SC7rcAS84OI2ToxIiFnpAZTb1h0kpV4vW8Ze3hLXNvtCVtLoqD3iI
Message-ID: <4431874D.3080208@yahoo-inc.com>
Date: Mon, 03 Apr 2006 13:36:29 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
References: <00a801c656ad$1467b670$e6e77ecf@ds.corp.yahoo.com>
 <4430B2A5.3000203@apache.org>
 <EE7EDF1D-B91B-408D-8AA9-1FB65A308376@yahoo-inc.com>
 <44315F2C.9080209@apache.org>
In-Reply-To: <44315F2C.9080209@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I agree that the framework must be as general as possible. Which means 
one should use some simple
data structure for keys and value, like string or BytesWritable.
Also nothing prevents us from implementing other types on top of the 
framework as an optional
layer of higher level API.

Here is another example, that I dealt with.
I wanted to use different value types (long, float or string) for both 
map and reduce tasks,
depending on the actual key values. So the solution was to encode the 
value type into the key value.
I used keys of the form
l:<name> - indicating the value type is expected to be long
f:<name> - value type is expected to be float
s:<name> - value is a string
The example is under HADOOP-95.
Thought somebody might find it practical.

--Konstantin


Doug Cutting wrote:

> Eric Baldeschwieler wrote:
>
>> An observation...  this whole thread is about limits caused by type  
>> safety.  Interestingly, the other implementation of map-reduce does  
>> not support types at all.  Everything is a string.
>>
>> So I agree that our departure from the paper is the problem.  ;-)
>
>
> A corollary is that one could simply use BytesWritable for all one's 
> keys and values, altering only one's WritableComparator 
> implementation, and one would not encounter this problem.  The use of 
> types in Hadoop is thus an optional feature.  One could even layer a 
> different type system on top of BytesWritable that exhibits the 
> desired properties.
>
>> I'm comfortable letting this lie for a while.  But I predict we've  
>> not heard the last of it.
>
>
> Owen seems to be picking it up, which is fine by me.
>
> Doug
>
>
>


From MAILER-DAEMON Mon Apr  3 20:50:29 2006
Return-Path: 
 <hadoop-dev-return-668-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47271 invoked from network); 3 Apr 2006 20:50:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 20:50:29 -0000
Received: (qmail 1399 invoked by uid 500); 3 Apr 2006 20:50:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1379 invoked by uid 500); 3 Apr 2006 20:50:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1370 invoked by uid 99); 3 Apr 2006 20:50:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 13:50:28 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.145.48.34] (HELO mail-relay1.yahoo.com) (216.145.48.34)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 13:50:27 -0700
Received: from KEPTSHOULDLX (keptshould-lx.corp.yahoo.com [66.228.170.54])
	by mail-relay1.yahoo.com (8.13.6/8.13.6/mr1) with ESMTP id k33Ko7A8037176
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 13:50:07 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	x-mailer:x-mimeole:thread-index;
	b=mCGW0NgshFsphm7FAQGr2cEkZ8RgFzUlk1eureML1HEnDPT8J3fxfE+GaGDAahMa
From: "Hairong Kuang" <hairong@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: dfs datanode heartbeats and getBlockwork requests
Date: Mon, 3 Apr 2006 13:52:02 -0700
Message-ID: <003001c65760$7591bc80$d09215ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0031_01C65725.C932E480"
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2670
Thread-Index: AcZXYHUrH6WkjmPmR+eFgMhPL3ew2Q==
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_NextPart_000_0031_01C65725.C932E480
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Currently dfs datanodes send heartbeats and getBlockwork requests to the
namenode at the same frequency (once every 3 seconds) after certain startup
time. Is there any design reason that we need two seperate messages instead
of one? I am thinking that if we let a sendHeartbeat request return the
blocks to be deleted or replicated, we are able to cut the network traffic
in dfs.
 
Hairong

------=_NextPart_000_0031_01C65725.C932E480--


From MAILER-DAEMON Mon Apr  3 21:03:40 2006
Return-Path: 
 <hadoop-dev-return-669-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51126 invoked from network); 3 Apr 2006 21:03:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 21:03:40 -0000
Received: (qmail 15069 invoked by uid 500); 3 Apr 2006 21:03:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15052 invoked by uid 500); 3 Apr 2006 21:03:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15043 invoked by uid 99); 3 Apr 2006 21:03:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:03:40 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:03:36 -0700
Received: from explainfloorlx (explainfloor-lx.corp.yahoo.com
 [207.126.231.230])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k33L2iYt025133
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 14:02:44 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	x-mailer:x-mimeole:thread-index;
	b=CXA3tkfRl4n4AOttDA+BqidI7qbvkTcVKUn9Jl7/wJzHQKEZwqH/X3yM+LuwsGrF
From: "Runping Qi" <runping@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: Can we use the features that are new in Java 1.5 for Hadoop
 contribution?
Date: Mon, 3 Apr 2006 14:04:37 -0700
Message-ID: <00da01c65762$37c66c00$e6e77ecf@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_00DB_01C65727.8B679400"
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZXYjdS4x8SmVykQOmFvppjuIX7WQ==
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_NextPart_000_00DB_01C65727.8B679400
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit

In other words, does Hadoop need to be compatible with Java 1.4?

 

Thanks.

 

Runping

 

 


------=_NextPart_000_00DB_01C65727.8B679400--


From MAILER-DAEMON Mon Apr  3 21:29:40 2006
Return-Path: 
 <hadoop-dev-return-670-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62739 invoked from network); 3 Apr 2006 21:29:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 21:29:40 -0000
Received: (qmail 44774 invoked by uid 500); 3 Apr 2006 21:29:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44754 invoked by uid 500); 3 Apr 2006 21:29:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44745 invoked by uid 99); 3 Apr 2006 21:29:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:29:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:29:38 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k33LTNYC011307
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 17:29:24 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k33LTAtA296586;
	Mon, 3 Apr 2006 17:29:13 -0400
Message-ID: <443193A6.7090802@apache.org>
Date: Mon, 03 Apr 2006 14:29:10 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Can we use the features that are new in Java 1.5 for Hadoop
 contribution?
References: <00da01c65762$37c66c00$e6e77ecf@ds.corp.yahoo.com>
In-Reply-To: <00da01c65762$37c66c00$e6e77ecf@ds.corp.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Runping Qi wrote:
> In other words, does Hadoop need to be compatible with Java 1.4?

That's a good question.  I think it also really needs to be asked on the 
Nutch user list, since most Hadoop users are using Hadoop via its 
inclusion in Nutch.  The issue will be (from my experience with Lucene) 
folks whose platform does not yet support Java 1.5.  Owen & looked into 
this a bit, and it seems like Java 1.5 has made it to Macs, FreeBSD, 
etc. by now, but it's hard to know whether there are other fringe 
platforms that don't yet have a solid Java 1.5 port.  We don't need to 
support everyone forever, but we also don't want to alienate a host of 
users.

What features are you interested in using?  Some features, like the 
concurrency stuff, have been backported.  (Nutch currently uses a 
backported version of that.)  Others, like generics, would be more 
difficult to back-port.

Doug

From MAILER-DAEMON Mon Apr  3 21:36:12 2006
Return-Path: 
 <hadoop-dev-return-671-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64569 invoked from network); 3 Apr 2006 21:36:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 21:36:12 -0000
Received: (qmail 50326 invoked by uid 500); 3 Apr 2006 21:36:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50265 invoked by uid 500); 3 Apr 2006 21:36:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50215 invoked by uid 99); 3 Apr 2006 21:36:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:36:11 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:36:10 -0700
Received: from explainfloorlx (explainfloor-lx.corp.yahoo.com
 [207.126.231.230])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k33LZRuF029111
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 14:35:28 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=KDrMNk0nnqMjZ+pT/7fM4z998IxnGbygLJjXmKyfEPyBOsA7Dp3q7PNrbnKz9+Z9
From: "Runping Qi" <runping@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: Can we use the features that are new in Java 1.5 for Hadoop
 contribution?
Date: Mon, 3 Apr 2006 14:37:15 -0700
Message-ID: <00ee01c65766$c71f0f20$e6e77ecf@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <443193A6.7090802@apache.org>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZXZb2LFuMPUgCvT6+KG1kj/VRg4QAAObaQ
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


I am thinking of the parameterized collection library.

Runping

-----Original Message-----
From: Doug Cutting [mailto:cutting@apache.org] 
Sent: Monday, April 03, 2006 2:29 PM
To: hadoop-dev@lucene.apache.org
Subject: Re: Can we use the features that are new in Java 1.5 for Hadoop
contribution?

Runping Qi wrote:
> In other words, does Hadoop need to be compatible with Java 1.4?

That's a good question.  I think it also really needs to be asked on the 
Nutch user list, since most Hadoop users are using Hadoop via its 
inclusion in Nutch.  The issue will be (from my experience with Lucene) 
folks whose platform does not yet support Java 1.5.  Owen & looked into 
this a bit, and it seems like Java 1.5 has made it to Macs, FreeBSD, 
etc. by now, but it's hard to know whether there are other fringe 
platforms that don't yet have a solid Java 1.5 port.  We don't need to 
support everyone forever, but we also don't want to alienate a host of 
users.

What features are you interested in using?  Some features, like the 
concurrency stuff, have been backported.  (Nutch currently uses a 
backported version of that.)  Others, like generics, would be more 
difficult to back-port.

Doug



From MAILER-DAEMON Mon Apr  3 21:42:56 2006
Return-Path: 
 <hadoop-dev-return-672-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67094 invoked from network); 3 Apr 2006 21:42:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 21:42:56 -0000
Received: (qmail 57908 invoked by uid 500); 3 Apr 2006 21:42:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57892 invoked by uid 500); 3 Apr 2006 21:42:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57882 invoked by uid 99); 3 Apr 2006 21:42:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:42:56 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:42:52 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k33LgQbL011871
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 17:42:26 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k33LgLKL039334;
	Mon, 3 Apr 2006 17:42:26 -0400
Message-ID: <443196BC.5070001@apache.org>
Date: Mon, 03 Apr 2006 14:42:20 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: dfs datanode heartbeats and getBlockwork requests
References: <003001c65760$7591bc80$d09215ac@ds.corp.yahoo.com>
In-Reply-To: <003001c65760$7591bc80$d09215ac@ds.corp.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hairong Kuang wrote:
> Currently dfs datanodes send heartbeats and getBlockwork requests to the
> namenode at the same frequency (once every 3 seconds) after certain startup
> time. Is there any design reason that we need two seperate messages instead
> of one? I am thinking that if we let a sendHeartbeat request return the
> blocks to be deleted or replicated, we are able to cut the network traffic
> in dfs.

No, that sounds like a reasonable change to me.

The startup delay will be need to be somehow re-implemented.  Perhaps we 
could simply change this to a timer in the namenode on startup, so that 
it waits a while on startup before giving any blockwork.  We might then 
have issues if, e.g, the namenode's ethernet cable were yanked for a few 
minutes.  When it is re-connected, the namenode will start issuing lots 
of uneeded replication requests.  Having a delay in blockwork at the 
datanode each time it establishes a new connection to the namenode 
solves that problem.  Are there other cases that the current startup 
blockwork delay is handling?

Doug

From MAILER-DAEMON Mon Apr  3 21:44:06 2006
Return-Path: 
 <hadoop-dev-return-673-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67464 invoked from network); 3 Apr 2006 21:44:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 21:44:06 -0000
Received: (qmail 63001 invoked by uid 500); 3 Apr 2006 21:44:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62980 invoked by uid 500); 3 Apr 2006 21:44:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62970 invoked by uid 99); 3 Apr 2006 21:44:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:44:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:44:05 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k33LhjBf000450
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 17:43:46 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k33LhfPh082678;
	Mon, 3 Apr 2006 17:43:42 -0400
Message-ID: <4431970D.1080700@apache.org>
Date: Mon, 03 Apr 2006 14:43:41 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Can we use the features that are new in Java 1.5 for Hadoop
 contribution?
References: <00ee01c65766$c71f0f20$e6e77ecf@ds.corp.yahoo.com>
In-Reply-To: <00ee01c65766$c71f0f20$e6e77ecf@ds.corp.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Runping Qi wrote:
> I am thinking of the parameterized collection library.

I.e., generics, so there's no easy backport strategy.  Thus we need to 
poll Hadoop and Nutch users.

Doug

From MAILER-DAEMON Mon Apr  3 21:56:37 2006
Return-Path: 
 <hadoop-dev-return-674-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72208 invoked from network); 3 Apr 2006 21:56:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 21:56:37 -0000
Received: (qmail 85019 invoked by uid 500); 3 Apr 2006 21:56:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84927 invoked by uid 500); 3 Apr 2006 21:56:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84918 invoked by uid 99); 3 Apr 2006 21:56:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:56:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:56:35 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k33LuGYC025963
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 17:56:21 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k33Lu8Rg117188;
	Mon, 3 Apr 2006 17:56:08 -0400
Message-ID: <443199F7.8060901@apache.org>
Date: Mon, 03 Apr 2006 14:56:07 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-115) Hadoop should allow the user to
 use SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
References: <00a801c656ad$1467b670$e6e77ecf@ds.corp.yahoo.com>
 <4430B2A5.3000203@apache.org>
 <EE7EDF1D-B91B-408D-8AA9-1FB65A308376@yahoo-inc.com>
 <44315F2C.9080209@apache.org> <4431874D.3080208@yahoo-inc.com>
In-Reply-To: <4431874D.3080208@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Konstantin Shvachko wrote:
> Here is another example, that I dealt with.
> I wanted to use different value types (long, float or string) for both 
> map and reduce tasks,
> depending on the actual key values. So the solution was to encode the 
> value type into the key value.
> I used keys of the form
> l:<name> - indicating the value type is expected to be long
> f:<name> - value type is expected to be float
> s:<name> - value is a string
> The example is under HADOOP-95.
> Thought somebody might find it practical.

On a related note, ObjectWritable can be used as input or output type, 
and can wrap any Writable class, thus permitting polymorphic inputs and 
outputs.  Nutch uses this to, e.g., combine a URL's incoming anchor 
texts and its content when indexing.  The input type is ObjectWritable, 
and the indexer's InputFormat wraps values from a variety of files.  The 
indexing reducer can then use the 'instanceof' operator to determine how 
to process each input value.  To be more object-oriented, one could have 
all of these classes implement some Indexable interface whose methods 
are invoked when reducing.

Doug

From MAILER-DAEMON Mon Apr  3 21:58:00 2006
Return-Path: 
 <hadoop-dev-return-675-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72711 invoked from network); 3 Apr 2006 21:58:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Apr 2006 21:58:00 -0000
Received: (qmail 85205 invoked by uid 500); 3 Apr 2006 21:58:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85177 invoked by uid 500); 3 Apr 2006 21:58:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85167 invoked by uid 99); 3 Apr 2006 21:57:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:57:59 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 14:57:58 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id EEBC314441C
	for <hadoop-dev@lucene.apache.org>; Mon,  3 Apr 2006 23:45:12 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 24328-10 for <hadoop-dev@lucene.apache.org>;
	Mon, 3 Apr 2006 23:45:12 +0200 (CEST)
Received: from [10.10.16.238] (unknown [64.71.164.125])
	by mslinux.media-style.com (Postfix) with ESMTP id 76CC114441B
	for <hadoop-dev@lucene.apache.org>; Mon,  3 Apr 2006 23:45:09 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <4431970D.1080700@apache.org>
References: <00ee01c65766$c71f0f20$e6e77ecf@ds.corp.yahoo.com>
 <4431970D.1080700@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <48DB2385-2D66-4B07-8B3F-D39CCED6AAF5@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: Can we use the features that are new in Java 1.5 for Hadoop
 contribution?
Date: Mon, 3 Apr 2006 23:57:17 +0200
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

> I.e., generics, so there's no easy backport strategy.  Thus we need  
> to poll Hadoop and Nutch users.

As a user,  I would love to stay hadoop  java 1.4 compatible for some  
more time.
  

From MAILER-DAEMON Tue Apr  4 02:59:38 2006
Return-Path: 
 <hadoop-dev-return-676-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8669 invoked from network); 4 Apr 2006 02:59:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 02:59:38 -0000
Received: (qmail 82539 invoked by uid 500); 4 Apr 2006 02:59:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82517 invoked by uid 500); 4 Apr 2006 02:59:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82501 invoked by uid 99); 4 Apr 2006 02:59:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 19:59:37 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 19:59:37 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k342wIUf059489
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 19:58:18 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=GKH7qD04mDVMagooxkqQIRcKToHeAQsS9DwyB8k397799oY7vEJutEKfQvprFyvK
Received: from [10.0.1.2] ([172.21.179.133]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 3 Apr 2006 19:58:16 -0700
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <48DB2385-2D66-4B07-8B3F-D39CCED6AAF5@media-style.com>
References: <00ee01c65766$c71f0f20$e6e77ecf@ds.corp.yahoo.com>
 <4431970D.1080700@apache.org>
 <48DB2385-2D66-4B07-8B3F-D39CCED6AAF5@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <83D905E2-D9B5-4341-8C23-E4F7803BB212@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: Can we use the features that are new in Java 1.5 for Hadoop
 contribution?
Date: Mon, 3 Apr 2006 17:12:55 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 04 Apr 2006 02:58:16.0111 (UTC)
 FILETIME=[9EB503F0:01C65793]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

why?

Does the recent release satisfy this need?

On Apr 3, 2006, at 2:57 PM, Stefan Groschupf wrote:

>> I.e., generics, so there's no easy backport strategy.  Thus we  
>> need to poll Hadoop and Nutch users.
>
> As a user,  I would love to stay hadoop  java 1.4 compatible for  
> some more time.


From MAILER-DAEMON Tue Apr  4 03:22:33 2006
Return-Path: 
 <hadoop-dev-return-677-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16774 invoked from network); 4 Apr 2006 03:22:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 03:22:33 -0000
Received: (qmail 571 invoked by uid 500); 4 Apr 2006 03:22:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 552 invoked by uid 500); 4 Apr 2006 03:22:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 543 invoked by uid 99); 4 Apr 2006 03:22:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 20:22:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 20:22:32 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id EE41814440E
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 05:09:50 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 25954-07 for <hadoop-dev@lucene.apache.org>;
	Tue, 4 Apr 2006 05:09:50 +0200 (CEST)
Received: from [10.10.16.236] (unknown [64.71.164.125])
	by mslinux.media-style.com (Postfix) with ESMTP id CDE4814440D
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 05:09:49 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <83D905E2-D9B5-4341-8C23-E4F7803BB212@yahoo-inc.com>
References: <00ee01c65766$c71f0f20$e6e77ecf@ds.corp.yahoo.com>
 <4431970D.1080700@apache.org>
 <48DB2385-2D66-4B07-8B3F-D39CCED6AAF5@media-style.com>
 <83D905E2-D9B5-4341-8C23-E4F7803BB212@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <3A65A9AB-A069-4EC0-A5BA-DD5BE547CD9F@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: Can we use the features that are new in Java 1.5 for Hadoop
 contribution?
Date: Tue, 4 Apr 2006 05:22:03 +0200
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

It would be nice to have, nothing more.
Hadoop 0.2 will introduce some features that can be very useful for  
nutch.
Nutch is mostly used as smaller  horizontal search engines or  
alternatives to google appliance servers.
In such scenarios I saw often that it runs on the same servers as the  
portal or webpage that still use java 1.4.
Again, nice to have - no requirement.

Stefan

Am 04.04.2006 um 02:12 schrieb Eric Baldeschwieler:

> why?
>
> Does the recent release satisfy this need?
>
> On Apr 3, 2006, at 2:57 PM, Stefan Groschupf wrote:
>
>>> I.e., generics, so there's no easy backport strategy.  Thus we  
>>> need to poll Hadoop and Nutch users.
>>
>> As a user,  I would love to stay hadoop  java 1.4 compatible for  
>> some more time.
>
>

---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Tue Apr  4 04:15:06 2006
Return-Path: 
 <hadoop-dev-return-678-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38039 invoked from network); 4 Apr 2006 04:15:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 04:15:06 -0000
Received: (qmail 37494 invoked by uid 500); 4 Apr 2006 04:15:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37475 invoked by uid 500); 4 Apr 2006 04:15:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37465 invoked by uid 99); 4 Apr 2006 04:15:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 21:15:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 21:15:05 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 6004BD49FF
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 05:14:44 +0100 (BST)
Message-ID: <1251503110.1144124084390.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 05:14:44 +0100 (BST)
From: "raghavendra prabhu (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-116) cleaning up /tmp/hadoop/mapred/system
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

cleaning up /tmp/hadoop/mapred/system
-------------------------------------

         Key: HADOOP-116
         URL: http://issues.apache.org/jira/browse/HADOOP-116
     Project: Hadoop
        Type: Improvement

  Components: mapred  
 Environment: Windows with Cygwin
    Reporter: raghavendra prabhu


Clean up directories

submit_ which contain job.xml and job.jar files as and when the job is finished

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 04:17:13 2006
Return-Path: 
 <hadoop-dev-return-679-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38474 invoked from network); 4 Apr 2006 04:17:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 04:17:13 -0000
Received: (qmail 37926 invoked by uid 500); 4 Apr 2006 04:17:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37906 invoked by uid 500); 4 Apr 2006 04:17:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37897 invoked by uid 99); 4 Apr 2006 04:17:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 21:17:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 21:17:12 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B062AD49FE
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 05:16:51 +0100 (BST)
Message-ID: <1219394759.1144124211719.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 05:16:51 +0100 (BST)
From: "raghavendra prabhu (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-116) cleaning up /tmp/hadoop/mapred/system
In-Reply-To: <1251503110.1144124084390.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-116?page=all ]

raghavendra prabhu updated HADOOP-116:
--------------------------------------

    Attachment: jobclient.patch

This tries to delete the submit_ (which contains job.xml and job.jar file)

Tested with mapred "local" option

> cleaning up /tmp/hadoop/mapred/system
> -------------------------------------
>
>          Key: HADOOP-116
>          URL: http://issues.apache.org/jira/browse/HADOOP-116
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>  Environment: Windows with Cygwin
>     Reporter: raghavendra prabhu
>  Attachments: jobclient.patch
>
> Clean up directories
> submit_ which contain job.xml and job.jar files as and when the job is finished

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 04:48:06 2006
Return-Path: 
 <hadoop-dev-return-680-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49369 invoked from network); 4 Apr 2006 04:48:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 04:48:06 -0000
Received: (qmail 69131 invoked by uid 500); 4 Apr 2006 04:48:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69035 invoked by uid 500); 4 Apr 2006 04:48:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69026 invoked by uid 99); 4 Apr 2006 04:48:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 21:48:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 21:48:05 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id AB55C6ACA9
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 05:47:44 +0100 (BST)
Message-ID: <98493585.1144126064699.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 05:47:44 +0100 (BST)
From: "raghavendra prabhu (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-117) map red /tmp/hadoop/mapred/
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

map red /tmp/hadoop/mapred/
---------------------------

         Key: HADOOP-117
         URL: http://issues.apache.org/jira/browse/HADOOP-117
     Project: Hadoop
        Type: Bug

    Versions: 0.1.1    
 Environment: windows with cygwin
    Reporter: raghavendra prabhu
    Priority: Critical


I found out that JobConf.java

Created interchanged names with parent being file and file being parent directory

As a result files were not getting deleted

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 04:50:09 2006
Return-Path: 
 <hadoop-dev-return-681-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49969 invoked from network); 4 Apr 2006 04:50:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 04:50:09 -0000
Received: (qmail 73678 invoked by uid 500); 4 Apr 2006 04:50:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73585 invoked by uid 500); 4 Apr 2006 04:50:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73572 invoked by uid 99); 4 Apr 2006 04:50:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 21:50:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 21:50:08 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A063C6ACA9
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 05:49:47 +0100 (BST)
Message-ID: <1892847195.1144126187654.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 05:49:47 +0100 (BST)
From: "raghavendra prabhu (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-117) map red /tmp/hadoop/mapred/
In-Reply-To: <98493585.1144126064699.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-117?page=all ]

raghavendra prabhu updated HADOOP-117:
--------------------------------------

    Attachment: JobConf.patch

Fixes the reversal of directory and child file

As a result, deletion is proper

> map red /tmp/hadoop/mapred/
> ---------------------------
>
>          Key: HADOOP-117
>          URL: http://issues.apache.org/jira/browse/HADOOP-117
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.1.1
>  Environment: windows with cygwin
>     Reporter: raghavendra prabhu
>     Priority: Critical
>  Attachments: JobConf.patch
>
> I found out that JobConf.java
> Created interchanged names with parent being file and file being parent directory
> As a result files were not getting deleted

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 06:52:51 2006
Return-Path: 
 <hadoop-dev-return-682-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95380 invoked from network); 4 Apr 2006 06:52:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 06:52:51 -0000
Received: (qmail 54210 invoked by uid 500); 4 Apr 2006 06:52:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54186 invoked by uid 500); 4 Apr 2006 06:52:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54176 invoked by uid 99); 4 Apr 2006 06:52:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 23:52:50 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Apr 2006 23:52:49 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k346of7U083102
	for <hadoop-dev@lucene.apache.org>; Mon, 3 Apr 2006 23:50:41 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=UwE2EA31LR1eo6w6eyHJEHvaKjo/N5x6QXSC7bzMzwuhW9XR4/LH0KBFI5C5qPe2
Received: from [10.0.1.2] ([172.21.179.133]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 3 Apr 2006 23:50:37 -0700
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <443196BC.5070001@apache.org>
References: <003001c65760$7591bc80$d09215ac@ds.corp.yahoo.com>
 <443196BC.5070001@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <65AFB9E5-D90B-4575-A319-5CEF85D639C3@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: dfs datanode heartbeats and getBlockwork requests
Date: Mon, 3 Apr 2006 23:50:38 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 04 Apr 2006 06:50:37.0176 (UTC)
 FILETIME=[143AB780:01C657B4]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

If we moved to a scheme where the name node was just given a small  
number of blocks with each heartbeat, there would be no reason to not  
start reporting blocks immediately, would there?  Or the name node to  
respond to the heartbeat with the block range it wanted next  
heartbeat...

On Apr 3, 2006, at 2:42 PM, Doug Cutting wrote:

> Hairong Kuang wrote:
>> Currently dfs datanodes send heartbeats and getBlockwork requests  
>> to the
>> namenode at the same frequency (once every 3 seconds) after  
>> certain startup
>> time. Is there any design reason that we need two seperate  
>> messages instead
>> of one? I am thinking that if we let a sendHeartbeat request  
>> return the
>> blocks to be deleted or replicated, we are able to cut the network  
>> traffic
>> in dfs.
>
> No, that sounds like a reasonable change to me.
>
> The startup delay will be need to be somehow re-implemented.   
> Perhaps we could simply change this to a timer in the namenode on  
> startup, so that it waits a while on startup before giving any  
> blockwork.  We might then have issues if, e.g, the namenode's  
> ethernet cable were yanked for a few minutes.  When it is re- 
> connected, the namenode will start issuing lots of uneeded  
> replication requests.  Having a delay in blockwork at the datanode  
> each time it establishes a new connection to the namenode solves  
> that problem.  Are there other cases that the current startup  
> blockwork delay is handling?
>
> Doug


From MAILER-DAEMON Tue Apr  4 10:49:32 2006
Return-Path: 
 <hadoop-dev-return-683-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36754 invoked from network); 4 Apr 2006 10:49:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 10:49:32 -0000
Received: (qmail 84330 invoked by uid 500); 4 Apr 2006 10:49:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84252 invoked by uid 500); 4 Apr 2006 10:49:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84235 invoked by uid 99); 4 Apr 2006 10:49:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 03:49:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 03:49:29 -0700
Received: from [192.168.0.253] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k34AnCh22785;
	Tue, 4 Apr 2006 05:49:12 -0500
Message-ID: <44324F14.1020403@getopt.org>
Date: Tue, 04 Apr 2006 12:48:52 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
CC: hadoop-commits@lucene.apache.org
Subject: Re: svn commit: r390260 -
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/mapred/MapReduceBase.java
References: <20060330222235.98730.qmail@minotaur.apache.org>
In-Reply-To: <20060330222235.98730.qmail@minotaur.apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

cutting@apache.org wrote:
> Author: cutting
> Date: Thu Mar 30 14:22:31 2006
> New Revision: 390260
>
> URL: http://svn.apache.org/viewcvs?rev=390260&view=rev
> Log:
> Fix for HADOOP-103, part II: I forgot to add this file the first time!
>   

> +public class MapReduceBase implements Closeable, JobConfigurable {
> +
> +  public void close() {
> +  }
>   

Shouldn't this method throw an IOException, as it is declared in Closeable?

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Tue Apr  4 13:44:06 2006
Return-Path: 
 <hadoop-dev-return-684-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40838 invoked from network); 4 Apr 2006 13:44:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 13:44:06 -0000
Received: (qmail 12994 invoked by uid 500); 4 Apr 2006 13:44:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12971 invoked by uid 500); 4 Apr 2006 13:44:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12962 invoked by uid 99); 4 Apr 2006 13:44:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 06:44:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 06:44:05 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 167E6D49FF
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 14:43:44 +0100 (BST)
Message-ID: <1754085203.1144158224089.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 14:43:44 +0100 (BST)
From: "raghavendra prabhu (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-117) map red /tmp/hadoop/mapred/
In-Reply-To: <98493585.1144126064699.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-117?page=comments#action_12373091 ] 

raghavendra prabhu commented on HADOOP-117:
-------------------------------------------

There is also one more issue

Two instances of directories /tmp are found now. One in root directory and other in current directory(where application is run)

As a result it is looking at the wrong folder to delete (different /tmp). WIll try to fix this problem if more users confirm that delete is not happening



> map red /tmp/hadoop/mapred/
> ---------------------------
>
>          Key: HADOOP-117
>          URL: http://issues.apache.org/jira/browse/HADOOP-117
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.1.1
>  Environment: windows with cygwin
>     Reporter: raghavendra prabhu
>     Priority: Critical
>  Attachments: JobConf.patch
>
> I found out that JobConf.java
> Created interchanged names with parent being file and file being parent directory
> As a result files were not getting deleted

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 14:07:06 2006
Return-Path: 
 <hadoop-dev-return-685-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57697 invoked from network); 4 Apr 2006 14:07:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 14:07:06 -0000
Received: (qmail 61112 invoked by uid 500); 4 Apr 2006 14:07:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61098 invoked by uid 500); 4 Apr 2006 14:07:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61089 invoked by uid 99); 4 Apr 2006 14:07:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 07:07:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 07:07:05 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 203DE6ACA9
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 15:06:44 +0100 (BST)
Message-ID: <2075529038.1144159604129.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 15:06:44 +0100 (BST)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-117) map red /tmp/hadoop/mapred/
In-Reply-To: <98493585.1144126064699.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-117?page=comments#action_12373095 ] 

Andrzej Bialecki  commented on HADOOP-117:
------------------------------------------

Are you sure you are running the latest hadoop? There was an issue, which resulted in such behaviour on Cygwin, but it's been fixed in rev. 389633.

> map red /tmp/hadoop/mapred/
> ---------------------------
>
>          Key: HADOOP-117
>          URL: http://issues.apache.org/jira/browse/HADOOP-117
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.1.1
>  Environment: windows with cygwin
>     Reporter: raghavendra prabhu
>     Priority: Critical
>  Attachments: JobConf.patch
>
> I found out that JobConf.java
> Created interchanged names with parent being file and file being parent directory
> As a result files were not getting deleted

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 14:46:29 2006
Return-Path: 
 <hadoop-dev-return-686-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83647 invoked from network); 4 Apr 2006 14:46:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 14:46:29 -0000
Received: (qmail 31056 invoked by uid 500); 4 Apr 2006 14:46:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31032 invoked by uid 500); 4 Apr 2006 14:46:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31023 invoked by uid 99); 4 Apr 2006 14:46:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 07:46:28 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of d.zbik@softwaremind.pl
 designates 62.233.162.146 as permitted sender)
Received: from [62.233.162.146] (HELO mail.softwaremind.pl) (62.233.162.146)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 07:46:27 -0700
Received: from localhost (localhost.softwaremind.pl [127.0.0.1])
	by mail.softwaremind.pl (Postfix) with ESMTP id E887428453
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 16:46:05 +0200 (CEST)
Received: from mail.softwaremind.pl ([127.0.0.1])
 by localhost (server.softwaremind.pl [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 41684-09 for <hadoop-dev@lucene.apache.org>;
 Tue,  4 Apr 2006 16:45:56 +0200 (CEST)
Received: from [193.203.246.180] (unknown [193.203.246.180])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.softwaremind.pl (Postfix) with ESMTP id 3B22F2842C
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 16:45:55 +0200 (CEST)
Message-ID: <443286A0.2010100@softwaremind.pl>
Date: Tue, 04 Apr 2006 15:45:52 +0100
From: Darek Zbik <d.zbik@softwaremind.pl>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
 rv:1.7.10) Gecko/20050716
X-Accept-Language: en-us, en, pl
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: svn commit: r390260 -
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/mapred/MapReduceBase.java
References: <20060330222235.98730.qmail@minotaur.apache.org>
 <44324F14.1020403@getopt.org>
In-Reply-To: <44324F14.1020403@getopt.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by amavisd-new at mail.softwaremind.pl
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Andrzej Bialecki wrote:

> Shouldn't this method throw an IOException, as it is declared in 
> Closeable?

It is possible to add IOExcpetion to JobConfigurable.configure()  either?
Currently there is no possibility to inform hadoop that something is 
wrong in configure inside map/reduce?

darek


From MAILER-DAEMON Tue Apr  4 16:31:05 2006
Return-Path: 
 <hadoop-dev-return-687-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50413 invoked from network); 4 Apr 2006 16:31:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 16:31:05 -0000
Received: (qmail 39869 invoked by uid 500); 4 Apr 2006 16:31:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39850 invoked by uid 500); 4 Apr 2006 16:31:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39841 invoked by uid 99); 4 Apr 2006 16:31:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 09:31:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 09:31:04 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8B3F7D49FF
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 17:30:43 +0100 (BST)
Message-ID: <1720783348.1144168243567.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 17:30:43 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-118) Namenode does not always clean up
 pendingCreates
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Namenode does not always clean up pendingCreates
------------------------------------------------

         Key: HADOOP-118
         URL: http://issues.apache.org/jira/browse/HADOOP-118
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.1.0    
 Environment: 195 node cluster running redhat linux (2.6 kernel)
    Reporter: Owen O'Malley
    Priority: Critical


In some failure modes, the pending creates list is not cleaned up and prevents that file from ever being created.

When I try to create the file after the first job was killed (hours previously), I get:

060404 084619 Cannot start file because pendingCreates is non-null. src=/user/oom/rand/part000118
060404 084619 Server handler 0 on 8020 call error: java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
        at org.apache.hadoop.dfs.NameNode.create(NameNode.java:147)
        at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 16:52:10 2006
Return-Path: 
 <hadoop-dev-return-689-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61126 invoked from network); 4 Apr 2006 16:52:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 16:52:10 -0000
Received: (qmail 77258 invoked by uid 500); 4 Apr 2006 16:52:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77222 invoked by uid 500); 4 Apr 2006 16:52:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77179 invoked by uid 99); 4 Apr 2006 16:52:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 09:52:08 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 09:52:07 -0700
Received: from [207.126.231.161] (oom-mac.corp.yahoo.com [207.126.231.161])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k34GoM28055901
	for <hadoop-dev@lucene.apache.org>; Tue, 4 Apr 2006 09:50:22 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:in-reply-to:references:content-type:message-id:
	content-transfer-encoding:from:subject:date:to:x-mailer;
	b=JfoksCK+TSuepwjPYXWmgDiEhbO0g5nLCa6/RGbGRs1eNTTF7y/WJZ/G+HnhIsa0
Mime-Version: 1.0 (Apple Message framework v623)
In-Reply-To: <44324F14.1020403@getopt.org>
References: <20060330222235.98730.qmail@minotaur.apache.org>
 <44324F14.1020403@getopt.org>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Message-Id: <1aac7add45d58f024d1b350c545b6c38@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: Re: svn commit: r390260 -
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/mapred/MapReduceBase.java
Date: Tue, 4 Apr 2006 09:50:46 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


On Apr 4, 2006, at 3:48 AM, Andrzej Bialecki wrote:
>
> Shouldn't this method throw an IOException, as it is declared in 
> Closeable?

Yes, it should. Thanks for the catch Andrzej.

-- Owen


From MAILER-DAEMON Tue Apr  4 16:51:34 2006
Return-Path: 
 <hadoop-dev-return-688-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60646 invoked from network); 4 Apr 2006 16:51:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 16:51:34 -0000
Received: (qmail 75565 invoked by uid 500); 4 Apr 2006 16:51:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75546 invoked by uid 500); 4 Apr 2006 16:51:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75536 invoked by uid 99); 4 Apr 2006 16:51:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 09:51:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 09:51:23 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k34GoLbk018640
	for <hadoop-dev@lucene.apache.org>; Tue, 4 Apr 2006 12:50:22 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k34GolsB096188;
	Tue, 4 Apr 2006 12:50:51 -0400
Message-ID: <4432A3E6.5090705@apache.org>
Date: Tue, 04 Apr 2006 09:50:46 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: svn commit: r390260 -
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/mapred/MapReduceBase.java
References: <20060330222235.98730.qmail@minotaur.apache.org>
 <44324F14.1020403@getopt.org>
In-Reply-To: <44324F14.1020403@getopt.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Andrzej Bialecki wrote:
>> +public class MapReduceBase implements Closeable, JobConfigurable {
>> +
>> +  public void close() {
>> +  }
>>   
> 
> 
> Shouldn't this method throw an IOException, as it is declared in Closeable?

Good point.  I just fixed that.

Doug

From MAILER-DAEMON Tue Apr  4 16:59:00 2006
Return-Path: 
 <hadoop-dev-return-690-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63765 invoked from network); 4 Apr 2006 16:59:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 16:59:00 -0000
Received: (qmail 82217 invoked by uid 500); 4 Apr 2006 16:59:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82116 invoked by uid 500); 4 Apr 2006 16:59:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82107 invoked by uid 99); 4 Apr 2006 16:58:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 09:58:59 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 09:58:59 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k34GwHai021583
	for <hadoop-dev@lucene.apache.org>; Tue, 4 Apr 2006 12:58:33 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k34Gw8cC020986;
	Tue, 4 Apr 2006 12:58:11 -0400
Message-ID: <4432A59F.1080504@apache.org>
Date: Tue, 04 Apr 2006 09:58:07 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: dfs datanode heartbeats and getBlockwork requests
References: <003001c65760$7591bc80$d09215ac@ds.corp.yahoo.com>
 <443196BC.5070001@apache.org>
 <65AFB9E5-D90B-4575-A319-5CEF85D639C3@yahoo-inc.com>
In-Reply-To: <65AFB9E5-D90B-4575-A319-5CEF85D639C3@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
> If we moved to a scheme where the name node was just given a small  
> number of blocks with each heartbeat, there would be no reason to not  
> start reporting blocks immediately, would there?

There would still be a small storm of un-needed replications on startup. 
  Say it takes a minute at startup for all data nodes to report their 
complete block lists to the name node.  If heartbeats are every 3 
seconds, then all but the last data node to report in would be handed 20 
small lists of blocks to start replicating.  And the switches could be 
saturated doing a lot of un-needed transfers, which would slow startup. 
  Then, for the next minute after startup, the nodes would be told to 
delete blocks that are now over-replicated.  We'd like startup to be as 
fast and painless as possible.  Waiting a bit before checking to see if 
blocks are over- or under-replicated seems a good way.

Doug

From MAILER-DAEMON Tue Apr  4 17:23:49 2006
Return-Path: 
 <hadoop-dev-return-691-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74996 invoked from network); 4 Apr 2006 17:23:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 17:23:49 -0000
Received: (qmail 12068 invoked by uid 500); 4 Apr 2006 17:23:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12047 invoked by uid 500); 4 Apr 2006 17:23:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12038 invoked by uid 99); 4 Apr 2006 17:23:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 10:23:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 10:23:47 -0700
Received: from [192.168.0.253] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k34HNcX15345
	for <hadoop-dev@lucene.apache.org>; Tue, 4 Apr 2006 12:23:38 -0500
Message-ID: <4432AB80.50609@getopt.org>
Date: Tue, 04 Apr 2006 19:23:12 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: svn commit: r390260 -
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/mapred/MapReduceBase.java
References: <20060330222235.98730.qmail@minotaur.apache.org>
 <44324F14.1020403@getopt.org>
 <1aac7add45d58f024d1b350c545b6c38@yahoo-inc.com>
In-Reply-To: <1aac7add45d58f024d1b350c545b6c38@yahoo-inc.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Owen O'Malley wrote:
>
> On Apr 4, 2006, at 3:48 AM, Andrzej Bialecki wrote:
>>
>> Shouldn't this method throw an IOException, as it is declared in 
>> Closeable?
>
> Yes, it should. Thanks for the catch Andrzej.

What is interesting is that javac didn't catch it either... strange. I 
need to read a good book on Java basics, it seems. ;)

It makes sense also to add the throws clause to configure, I think, as 
Darek suggested in another post.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Tue Apr  4 17:36:24 2006
Return-Path: 
 <hadoop-dev-return-692-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81228 invoked from network); 4 Apr 2006 17:36:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 17:36:24 -0000
Received: (qmail 23140 invoked by uid 500); 4 Apr 2006 17:36:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23046 invoked by uid 500); 4 Apr 2006 17:36:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23037 invoked by uid 99); 4 Apr 2006 17:36:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 10:36:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 10:36:22 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k34HZTai011717
	for <hadoop-dev@lucene.apache.org>; Tue, 4 Apr 2006 13:35:57 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k34HZUvs026818;
	Tue, 4 Apr 2006 13:35:31 -0400
Message-ID: <4432AE62.8050400@apache.org>
Date: Tue, 04 Apr 2006 10:35:30 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: svn commit: r390260 -
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/mapred/MapReduceBase.java
References: <20060330222235.98730.qmail@minotaur.apache.org>
 <44324F14.1020403@getopt.org>
 <1aac7add45d58f024d1b350c545b6c38@yahoo-inc.com> <4432AB80.50609@getopt.org>
In-Reply-To: <4432AB80.50609@getopt.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Andrzej Bialecki wrote:
> What is interesting is that javac didn't catch it either... strange. I 
> need to read a good book on Java basics, it seems. ;)

When you implement a method you only need to declare those exceptions 
that can actually be thrown.  But you then also narrow the set of 
exceptions which can be thrown by subclasses.

> It makes sense also to add the throws clause to configure, I think, as 
> Darek suggested in another post.

This is a larger change, since it is not already in the interface.  All 
places that call this method will need to be changed to handle whatever 
is thrown.

What exception should this throw?  IOException is tempting, since most 
calling code probably already handles that, but configure() isn't really 
an io-related operation.  One can always throw RuntimeException with no 
declaration.  Or we could define a new ConfigurationException, thrown by 
both Configurable.setConf() and JobConfigurable.configure().

Are there cases where we need to automatically distinguish between a 
configuration problem and other problems?  If so, then we should 
probably add this new exception.  But if we don't have examples of such, 
we might just stick with RuntimeException for now.

Doug

From MAILER-DAEMON Tue Apr  4 17:37:33 2006
Return-Path: 
 <hadoop-dev-return-693-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81894 invoked from network); 4 Apr 2006 17:37:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 17:37:33 -0000
Received: (qmail 27255 invoked by uid 500); 4 Apr 2006 17:37:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27161 invoked by uid 500); 4 Apr 2006 17:37:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27152 invoked by uid 99); 4 Apr 2006 17:37:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 10:37:32 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 10:37:32 -0700
Received: from [207.126.231.161] (oom-mac.corp.yahoo.com [207.126.231.161])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k34HZIvP070478
	for <hadoop-dev@lucene.apache.org>; Tue, 4 Apr 2006 10:35:18 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:in-reply-to:references:content-type:message-id:
	content-transfer-encoding:from:subject:date:to:x-mailer;
	b=k35QDrJt8G5FUK8ilQ4HAaGp34Kr+2MvHFwPnl4yxENOqg4a6elh9jUItkBqlFhv
Mime-Version: 1.0 (Apple Message framework v623)
In-Reply-To: <4432AB80.50609@getopt.org>
References: <20060330222235.98730.qmail@minotaur.apache.org>
 <44324F14.1020403@getopt.org>
 <1aac7add45d58f024d1b350c545b6c38@yahoo-inc.com> <4432AB80.50609@getopt.org>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Message-Id: <1173c45990c2cf45b6e6ecb89d83cab2@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: Re: svn commit: r390260 -
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/mapred/MapReduceBase.java
Date: Tue, 4 Apr 2006 10:35:42 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


On Apr 4, 2006, at 10:23 AM, Andrzej Bialecki wrote:

> Owen O'Malley wrote:
>>
>> On Apr 4, 2006, at 3:48 AM, Andrzej Bialecki wrote:
>>>
>>> Shouldn't this method throw an IOException, as it is declared in 
>>> Closeable?
>>
>> Yes, it should. Thanks for the catch Andrzej.
>
> What is interesting is that javac didn't catch it either... strange. I 
> need to read a good book on Java basics, it seems. ;)

The throws clauses are allowed to be different in an implementation as 
long as it is stricter. In this case, throwing nothing is more strict 
than throwing IOException, so it is ok.

-- Owen


From MAILER-DAEMON Tue Apr  4 20:28:07 2006
Return-Path: 
 <hadoop-dev-return-694-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72789 invoked from network); 4 Apr 2006 20:28:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 20:28:07 -0000
Received: (qmail 94996 invoked by uid 500); 4 Apr 2006 20:28:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94901 invoked by uid 500); 4 Apr 2006 20:28:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94891 invoked by uid 99); 4 Apr 2006 20:28:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 13:28:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 13:28:04 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 88A426ACA9
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 21:27:43 +0100 (BST)
Message-ID: <1670355370.1144182463557.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 21:27:43 +0100 (BST)
From: "Darek Zbik (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-119) ReduceTask.configure() is called twice
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

ReduceTask.configure() is called twice
--------------------------------------

         Key: HADOOP-119
         URL: http://issues.apache.org/jira/browse/HADOOP-119
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2    
    Reporter: Darek Zbik


ReduceTask.configure() is called twice for each created reduce task 
First call is done indirect from 
org.apache.hadoop.mapred.JobConf.newInstance()
called in ReduceTask.run(). Second call was in ReduceTask.run() just after creating a new instance. I suggest to remove the second call. For all new instances created in case of map task there are no directly xxx.configure();

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 20:30:06 2006
Return-Path: 
 <hadoop-dev-return-695-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73846 invoked from network); 4 Apr 2006 20:30:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 20:30:06 -0000
Received: (qmail 96843 invoked by uid 500); 4 Apr 2006 20:30:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96827 invoked by uid 500); 4 Apr 2006 20:30:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96817 invoked by uid 99); 4 Apr 2006 20:30:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 13:30:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 13:30:05 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C9F3CD49FF
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 21:29:44 +0100 (BST)
Message-ID: <1421413760.1144182584824.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 21:29:44 +0100 (BST)
From: "Darek Zbik (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-119) ReduceTask.configure() is called twice
In-Reply-To: <1670355370.1144182463557.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-119?page=all ]

Darek Zbik updated HADOOP-119:
------------------------------

    Attachment: mapred.patch

One line patch tested in my codes.

> ReduceTask.configure() is called twice
> --------------------------------------
>
>          Key: HADOOP-119
>          URL: http://issues.apache.org/jira/browse/HADOOP-119
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Darek Zbik
>  Attachments: mapred.patch
>
> ReduceTask.configure() is called twice for each created reduce task 
> First call is done indirect from 
> org.apache.hadoop.mapred.JobConf.newInstance()
> called in ReduceTask.run(). Second call was in ReduceTask.run() just after creating a new instance. I suggest to remove the second call. For all new instances created in case of map task there are no directly xxx.configure();

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 22:07:06 2006
Return-Path: 
 <hadoop-dev-return-696-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23338 invoked from network); 4 Apr 2006 22:07:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 22:07:06 -0000
Received: (qmail 60616 invoked by uid 500); 4 Apr 2006 22:07:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60597 invoked by uid 500); 4 Apr 2006 22:07:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60588 invoked by uid 99); 4 Apr 2006 22:07:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 15:07:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 15:07:05 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 14310D49FF
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 23:06:44 +0100 (BST)
Message-ID: <1592207028.1144188404080.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 23:06:44 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-117) map red /tmp/hadoop/mapred/
In-Reply-To: <98493585.1144126064699.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-117?page=all ]
     
Doug Cutting resolved HADOOP-117:
---------------------------------

    Fix Version: 0.2
                 0.1.1
     Resolution: Fixed

I just fixed this.

> map red /tmp/hadoop/mapred/
> ---------------------------
>
>          Key: HADOOP-117
>          URL: http://issues.apache.org/jira/browse/HADOOP-117
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.1.1
>  Environment: windows with cygwin
>     Reporter: raghavendra prabhu
>     Priority: Critical
>      Fix For: 0.2, 0.1.1
>  Attachments: JobConf.patch
>
> I found out that JobConf.java
> Created interchanged names with parent being file and file being parent directory
> As a result files were not getting deleted

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 22:33:07 2006
Return-Path: 
 <hadoop-dev-return-697-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32226 invoked from network); 4 Apr 2006 22:33:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 22:33:07 -0000
Received: (qmail 85507 invoked by uid 500); 4 Apr 2006 22:33:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85488 invoked by uid 500); 4 Apr 2006 22:33:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85479 invoked by uid 99); 4 Apr 2006 22:33:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 15:33:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 15:33:06 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7630B6ACA9
	for <hadoop-dev@lucene.apache.org>; Tue,  4 Apr 2006 23:32:45 +0100 (BST)
Message-ID: <978018582.1144189965479.JavaMail.jira@ajax>
Date: Tue, 4 Apr 2006 23:32:45 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-116) cleaning up /tmp/hadoop/mapred/system
In-Reply-To: <1251503110.1144124084390.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-116?page=all ]

Doug Cutting reassigned HADOOP-116:
-----------------------------------

    Assign To: Doug Cutting

These files should not be removed by the JobClient, since that may exit while the job is still running.  Instead they should be removed by the LocalJobRunner or the TaskTracker, when the job is done.  I'm working on a patch to fix this.

> cleaning up /tmp/hadoop/mapred/system
> -------------------------------------
>
>          Key: HADOOP-116
>          URL: http://issues.apache.org/jira/browse/HADOOP-116
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>  Environment: Windows with Cygwin
>     Reporter: raghavendra prabhu
>     Assignee: Doug Cutting
>  Attachments: jobclient.patch
>
> Clean up directories
> submit_ which contain job.xml and job.jar files as and when the job is finished

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 23:55:05 2006
Return-Path: 
 <hadoop-dev-return-698-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62466 invoked from network); 4 Apr 2006 23:55:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 23:55:05 -0000
Received: (qmail 65869 invoked by uid 500); 4 Apr 2006 23:55:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65774 invoked by uid 500); 4 Apr 2006 23:55:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65736 invoked by uid 99); 4 Apr 2006 23:55:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 16:55:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 16:55:04 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B1DFCD49FE
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 00:54:43 +0100 (BST)
Message-ID: <925820144.1144194883725.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 00:54:43 +0100 (BST)
From: "Dick King (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-120) Reading an ArrayWriter does not work
 because valueClass does not get initialized
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Reading an ArrayWriter does not work because valueClass does not get initialized
--------------------------------------------------------------------------------

         Key: HADOOP-120
         URL: http://issues.apache.org/jira/browse/HADOOP-120
     Project: Hadoop
        Type: Bug

  Components: io  
 Environment: Red Hat  
    Reporter: Dick King


If you have a Reducer whose value type is an ArrayWriter it gets enstreamed alright but at reconstruction type when ArrayWriter::readFields(DataInput in) runs on a DataInput that has a nonempty ArrayWriter , newInstance fails trying to instantiate the null class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr  4 23:59:13 2006
Return-Path: 
 <hadoop-dev-return-699-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63419 invoked from network); 4 Apr 2006 23:59:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Apr 2006 23:59:13 -0000
Received: (qmail 69368 invoked by uid 500); 4 Apr 2006 23:59:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69349 invoked by uid 500); 4 Apr 2006 23:59:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69340 invoked by uid 99); 4 Apr 2006 23:59:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 16:59:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 16:59:12 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 76FECD49FE
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 00:58:51 +0100 (BST)
Message-ID: <1872316473.1144195131426.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 00:58:51 +0100 (BST)
From: "Dick King (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-120) Reading an ArrayWriter does not work
 because valueClass does not get initialized
In-Reply-To: <925820144.1144194883725.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-120?page=all ]

Dick King updated HADOOP-120:
-----------------------------

    Attachment: hadoop-120-fix.patch

This patch appears to fix the problem.  I don't know whether you will object to the exception modification on ClassNotFoundException .

-dk


> Reading an ArrayWriter does not work because valueClass does not get initialized
> --------------------------------------------------------------------------------
>
>          Key: HADOOP-120
>          URL: http://issues.apache.org/jira/browse/HADOOP-120
>      Project: Hadoop
>         Type: Bug

>   Components: io
>  Environment: Red Hat  
>     Reporter: Dick King
>  Attachments: hadoop-120-fix.patch
>
> If you have a Reducer whose value type is an ArrayWriter it gets enstreamed alright but at reconstruction type when ArrayWriter::readFields(DataInput in) runs on a DataInput that has a nonempty ArrayWriter , newInstance fails trying to instantiate the null class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 00:07:11 2006
Return-Path: 
 <hadoop-dev-return-700-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66440 invoked from network); 5 Apr 2006 00:07:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 00:07:11 -0000
Received: (qmail 74892 invoked by uid 500); 5 Apr 2006 00:07:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74797 invoked by uid 500); 5 Apr 2006 00:07:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74788 invoked by uid 99); 5 Apr 2006 00:07:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 17:07:10 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.145.48.34] (HELO mail-relay1.yahoo.com) (216.145.48.34)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 17:07:09 -0700
Received: from KEPTSHOULDLX (keptshould-lx.corp.yahoo.com [66.228.170.54])
	by mail-relay1.yahoo.com (8.13.6/8.13.6/mr1) with ESMTP id k3506mOS094111
	for <hadoop-dev@lucene.apache.org>; Tue, 4 Apr 2006 17:06:48 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=1HvDJzHDhGsWBH0AHcoLi+zaW0Kn8ewJPv1Pt4tQm4N9ZUnkxLFYllLyDcYRyBjA
From: "Hairong Kuang" <hairong@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: dfs datanode heartbeats and getBlockwork requests
Date: Tue, 4 Apr 2006 17:08:55 -0700
Message-ID: <002c01c65845$211834a0$d09215ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4432A59F.1080504@apache.org>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2670
Thread-Index: AcZYCRu96HVw3pkmTlepmiWDt0ft7gAKrvXg
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I think it is better to implement the start-up delay at the namenode. But
the key is that the name node should be able to tell if it is in a steady
state or not either at start-up time or at runtime after a network
disruption. It should not instruct datanodes to replicate or delete any
blocks before it has reached a steady state.

Hairong 

-----Original Message-----
From: Doug Cutting [mailto:cutting@apache.org] 
Sent: Tuesday, April 04, 2006 9:58 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: dfs datanode heartbeats and getBlockwork requests

Eric Baldeschwieler wrote:
> If we moved to a scheme where the name node was just given a small 
> number of blocks with each heartbeat, there would be no reason to not 
> start reporting blocks immediately, would there?

There would still be a small storm of un-needed replications on startup. 
  Say it takes a minute at startup for all data nodes to report their
complete block lists to the name node.  If heartbeats are every 3 seconds,
then all but the last data node to report in would be handed 20 small lists
of blocks to start replicating.  And the switches could be saturated doing a
lot of un-needed transfers, which would slow startup. 
  Then, for the next minute after startup, the nodes would be told to delete
blocks that are now over-replicated.  We'd like startup to be as fast and
painless as possible.  Waiting a bit before checking to see if blocks are
over- or under-replicated seems a good way.

Doug



From MAILER-DAEMON Wed Apr  5 05:06:31 2006
Return-Path: 
 <hadoop-dev-return-701-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70577 invoked from network); 5 Apr 2006 05:06:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 05:06:31 -0000
Received: (qmail 98174 invoked by uid 500); 5 Apr 2006 05:06:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98079 invoked by uid 500); 5 Apr 2006 05:06:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98070 invoked by uid 99); 5 Apr 2006 05:06:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 22:06:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 22:06:29 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9E92DD49FE
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 06:06:08 +0100 (BST)
Message-ID: <682576709.1144213568271.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 06:06:08 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-120) Reading an ArrayWriter does not work
 because valueClass does not get initialized
In-Reply-To: <925820144.1144194883725.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-120?page=comments#action_12373224 ] 

Owen O'Malley commented on HADOOP-120:
--------------------------------------

After thinking about it for a bit, the problem with this patch is that this is going to encode the typename in each and every record. So if your value type is ArrayWriter<UTF8>, you are going to spend an extra 2+strlen("org.apache.hadoop.io.UTF8") bytes per a record. That's a fair amount of overhead.

We also have to be a careful with the serialization of ArrayWritable because it is used in the DFS name node logs.

I'm not sure what the right solution is. Probably for right now, I would derive a subclass of ArrayWritable that is specific for your type. It isn't pretty, but it is guaranteed to be safe.

public class UTF8Array extends ArrayWritable {
  public UTF8Array() {
     super(UTF8.class);
  }
}

> Reading an ArrayWriter does not work because valueClass does not get initialized
> --------------------------------------------------------------------------------
>
>          Key: HADOOP-120
>          URL: http://issues.apache.org/jira/browse/HADOOP-120
>      Project: Hadoop
>         Type: Bug

>   Components: io
>  Environment: Red Hat  
>     Reporter: Dick King
>  Attachments: hadoop-120-fix.patch
>
> If you have a Reducer whose value type is an ArrayWriter it gets enstreamed alright but at reconstruction type when ArrayWriter::readFields(DataInput in) runs on a DataInput that has a nonempty ArrayWriter , newInstance fails trying to instantiate the null class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 06:47:22 2006
Return-Path: 
 <hadoop-dev-return-702-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16944 invoked from network); 5 Apr 2006 06:47:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 06:47:22 -0000
Received: (qmail 4954 invoked by uid 500); 5 Apr 2006 06:47:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4937 invoked by uid 500); 5 Apr 2006 06:47:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4928 invoked by uid 99); 5 Apr 2006 06:47:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 23:47:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Apr 2006 23:47:21 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 503D9D49FF
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 07:47:00 +0100 (BST)
Message-ID: <1443105688.1144219620250.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 07:47:00 +0100 (BST)
From: "Dick King (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-120) Reading an ArrayWriter does not work
 because valueClass does not get initialized
In-Reply-To: <925820144.1144194883725.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-120?page=comments#action_12373232 ] 

Dick King commented on HADOOP-120:
----------------------------------

I realized that, of course, but I'm not expecting a whole lot of small ArrayWritable's .

Owen O'Malley's solution has the problem that ArrayWritables can themselves contain ArrayWritables.  We might, for example, want to have a two-component ArrayWritable where there are some integers and some UTF8s,  so we need a class

  public class ArrayOfArrayOfSomeIntsAndSomeUTF8s extends ArrayWritable
  {
     ... filling this in gives me a headache
  }

-dk


> Reading an ArrayWriter does not work because valueClass does not get initialized
> --------------------------------------------------------------------------------
>
>          Key: HADOOP-120
>          URL: http://issues.apache.org/jira/browse/HADOOP-120
>      Project: Hadoop
>         Type: Bug

>   Components: io
>  Environment: Red Hat  
>     Reporter: Dick King
>  Attachments: hadoop-120-fix.patch
>
> If you have a Reducer whose value type is an ArrayWriter it gets enstreamed alright but at reconstruction type when ArrayWriter::readFields(DataInput in) runs on a DataInput that has a nonempty ArrayWriter , newInstance fails trying to instantiate the null class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 07:14:08 2006
Return-Path: 
 <hadoop-dev-return-703-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26546 invoked from network); 5 Apr 2006 07:14:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 07:14:08 -0000
Received: (qmail 23680 invoked by uid 500); 5 Apr 2006 07:14:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23660 invoked by uid 500); 5 Apr 2006 07:14:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23650 invoked by uid 99); 5 Apr 2006 07:14:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 00:14:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 00:14:07 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 6B6B5D49FF
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 08:13:46 +0100 (BST)
Message-ID: <1058640729.1144221226436.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 08:13:46 +0100 (BST)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-120) Reading an ArrayWriter does not work
 because valueClass does not get initialized
In-Reply-To: <925820144.1144194883725.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-120?page=comments#action_12373234 ] 

Andrzej Bialecki  commented on HADOOP-120:
------------------------------------------

Regarding the class name encoding: you could use the same trick that we use in Nutch, org.apache.nutch.crawl.MapWritable, which uses a sort of dictionary encoding, and as long as you use only the "standard" types the overhead is just 1 byte. For non-standard types, the type name is put into a dictionary (once), and henceforth only 1 byte is used, too.

> Reading an ArrayWriter does not work because valueClass does not get initialized
> --------------------------------------------------------------------------------
>
>          Key: HADOOP-120
>          URL: http://issues.apache.org/jira/browse/HADOOP-120
>      Project: Hadoop
>         Type: Bug

>   Components: io
>  Environment: Red Hat  
>     Reporter: Dick King
>  Attachments: hadoop-120-fix.patch
>
> If you have a Reducer whose value type is an ArrayWriter it gets enstreamed alright but at reconstruction type when ArrayWriter::readFields(DataInput in) runs on a DataInput that has a nonempty ArrayWriter , newInstance fails trying to instantiate the null class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 15:29:11 2006
Return-Path: 
 <hadoop-dev-return-704-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35137 invoked from network); 5 Apr 2006 15:29:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 15:29:11 -0000
Received: (qmail 82576 invoked by uid 500); 5 Apr 2006 15:29:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82539 invoked by uid 500); 5 Apr 2006 15:29:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82510 invoked by uid 99); 5 Apr 2006 15:29:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 08:29:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 08:29:08 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2D670D4A00
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 16:28:47 +0100 (BST)
Message-ID: <1661354824.1144250927182.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 16:28:47 +0100 (BST)
From: "Dick King (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-120) Reading an ArrayWriter does not work
 because valueClass does not get initialized
In-Reply-To: <925820144.1144194883725.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-120?page=comments#action_12373386 ] 

Dick King commented on HADOOP-120:
----------------------------------

The big deal is probably not so much the space it takes but the TIME it takes to look up a class.

Owen, I'll stop by at 11 to talk about this.  I think we need to generalize the notion of an input ot output class to an input or output _descriptor_ .

Gotta run now -- literally.

-dk


> Reading an ArrayWriter does not work because valueClass does not get initialized
> --------------------------------------------------------------------------------
>
>          Key: HADOOP-120
>          URL: http://issues.apache.org/jira/browse/HADOOP-120
>      Project: Hadoop
>         Type: Bug

>   Components: io
>  Environment: Red Hat  
>     Reporter: Dick King
>  Attachments: hadoop-120-fix.patch
>
> If you have a Reducer whose value type is an ArrayWriter it gets enstreamed alright but at reconstruction type when ArrayWriter::readFields(DataInput in) runs on a DataInput that has a nonempty ArrayWriter , newInstance fails trying to instantiate the null class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 15:33:15 2006
Return-Path: 
 <hadoop-dev-return-705-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38369 invoked from network); 5 Apr 2006 15:33:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 15:33:15 -0000
Received: (qmail 99715 invoked by uid 500); 5 Apr 2006 15:33:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99698 invoked by uid 500); 5 Apr 2006 15:33:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99689 invoked by uid 99); 5 Apr 2006 15:33:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 08:33:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 08:33:04 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id AD431D49FE
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 16:32:43 +0100 (BST)
Message-ID: <472822470.1144251163705.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 16:32:43 +0100 (BST)
From: "Dick King (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-120) Reading an ArrayWriter does not work
 because valueClass does not get initialized
In-Reply-To: <925820144.1144194883725.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-120?page=comments#action_12373388 ] 

Dick King commented on HADOOP-120:
----------------------------------

Regarding the dictionary approach ... remember the life of a dictionary is the lifetime of a DFS, not merely a particular run or a DFS file.  Also it does violate the apparent convention that the callER knows the type of the object.  Now maybe that should be rethought, but we should do so explicitly, not back into it.

-dk


> Reading an ArrayWriter does not work because valueClass does not get initialized
> --------------------------------------------------------------------------------
>
>          Key: HADOOP-120
>          URL: http://issues.apache.org/jira/browse/HADOOP-120
>      Project: Hadoop
>         Type: Bug

>   Components: io
>  Environment: Red Hat  
>     Reporter: Dick King
>  Attachments: hadoop-120-fix.patch
>
> If you have a Reducer whose value type is an ArrayWriter it gets enstreamed alright but at reconstruction type when ArrayWriter::readFields(DataInput in) runs on a DataInput that has a nonempty ArrayWriter , newInstance fails trying to instantiate the null class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 16:29:07 2006
Return-Path: 
 <hadoop-dev-return-706-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73381 invoked from network); 5 Apr 2006 16:29:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 16:29:07 -0000
Received: (qmail 68434 invoked by uid 500); 5 Apr 2006 16:29:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68334 invoked by uid 500); 5 Apr 2006 16:29:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68319 invoked by uid 99); 5 Apr 2006 16:29:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 09:29:05 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 09:29:04 -0700
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k35GSBYu096832
	for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006 09:28:11 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=14cARgcrImnsoRn2aaYqWieSlukhht8xVnR1cI91AkAoiOBvCybdyITUZoYLED/5
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: dfs datanode heartbeats and getBlockwork requests
Date: Wed, 5 Apr 2006 09:30:07 -0700
Message-ID: <00d801c658ce$335c1da0$929015ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <002c01c65845$211834a0$d09215ac@ds.corp.yahoo.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZYCRu96HVw3pkmTlepmiWDt0ft7gAKrvXgACYtkBA=
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Right!
The name node, on startup, should know which data nodes are expected to be
there, and not make replication decisions before he knows who's actually
there and who's not.
A crude way to achieve that is by just waiting for a while, hoping that all
the data nodes connect.
A more refined way would be to compare who connected to who is expected to
connect. It enables faster startup when everyone just connects quickly, and
better robustness when some data nodes are slow to connect, or when the name
node is slow to process the barrage of connections.
The rule could be "no replications until X% of the expected nodes have
connected, AND there are no pending unprocessed connection messages". X
should be on the order of 90, perhaps less for very small clusters.

Yoram

-----Original Message-----
From: Hairong Kuang [mailto:hairong@yahoo-inc.com] 
Sent: Tuesday, April 04, 2006 5:09 PM
To: hadoop-dev@lucene.apache.org
Subject: RE: dfs datanode heartbeats and getBlockwork requests

I think it is better to implement the start-up delay at the namenode. But
the key is that the name node should be able to tell if it is in a steady
state or not either at start-up time or at runtime after a network
disruption. It should not instruct datanodes to replicate or delete any
blocks before it has reached a steady state.

Hairong 

-----Original Message-----
From: Doug Cutting [mailto:cutting@apache.org]
Sent: Tuesday, April 04, 2006 9:58 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: dfs datanode heartbeats and getBlockwork requests

Eric Baldeschwieler wrote:
> If we moved to a scheme where the name node was just given a small 
> number of blocks with each heartbeat, there would be no reason to not 
> start reporting blocks immediately, would there?

There would still be a small storm of un-needed replications on startup. 
  Say it takes a minute at startup for all data nodes to report their
complete block lists to the name node.  If heartbeats are every 3 seconds,
then all but the last data node to report in would be handed 20 small lists
of blocks to start replicating.  And the switches could be saturated doing a
lot of un-needed transfers, which would slow startup. 
  Then, for the next minute after startup, the nodes would be told to delete
blocks that are now over-replicated.  We'd like startup to be as fast and
painless as possible.  Waiting a bit before checking to see if blocks are
over- or under-replicated seems a good way.

Doug




From MAILER-DAEMON Wed Apr  5 17:23:56 2006
Return-Path: 
 <hadoop-dev-return-707-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 5336 invoked from network); 5 Apr 2006 17:23:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 17:23:56 -0000
Received: (qmail 1814 invoked by uid 500); 5 Apr 2006 17:23:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1791 invoked by uid 500); 5 Apr 2006 17:23:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1782 invoked by uid 99); 5 Apr 2006 17:23:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 10:23:55 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 10:23:54 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k35HNZBf006126
	for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006 13:23:36 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k35HNKlK182640;
	Wed, 5 Apr 2006 13:23:23 -0400
Message-ID: <4433FD07.5060701@apache.org>
Date: Wed, 05 Apr 2006 10:23:19 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: dfs datanode heartbeats and getBlockwork requests
References: <00d801c658ce$335c1da0$929015ac@ds.corp.yahoo.com>
In-Reply-To: <00d801c658ce$335c1da0$929015ac@ds.corp.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I would rather avoid having to declare the set of expected data nodes if 
we can avoid it, as I think it introduces a number of complexities.  For 
example, if you wish to add new data nodes, you cannot simply configure 
them to point to the name node and start them.  Assuming we add a notion 
of 'on same rack' or 'on same switch' to dfs, and can ensure that copies 
of a block are always held on multiple racks/switches, then it's 
convenient to be able to safely take racks and switches offline and 
online without coordinating with the namenode.  If a switch fails at 
startup, and 90% of the expected nodes are not available, we should 
still start replication, no?  I think a startup replication delay at the 
namenode handles all of these cases.  If we're worried that the 
filesystem is unavailable, then we could make the delay smarter.  The 
namenode could delay some number of minutes or until every block is 
accounted for, whichever comes first.  And it could refuse/delay client 
requests until the delay period is over, so that applications don't 
start up until files are completely available.

Doug

Yoram Arnon wrote:
> Right!
> The name node, on startup, should know which data nodes are expected to be
> there, and not make replication decisions before he knows who's actually
> there and who's not.
> A crude way to achieve that is by just waiting for a while, hoping that all
> the data nodes connect.
> A more refined way would be to compare who connected to who is expected to
> connect. It enables faster startup when everyone just connects quickly, and
> better robustness when some data nodes are slow to connect, or when the name
> node is slow to process the barrage of connections.
> The rule could be "no replications until X% of the expected nodes have
> connected, AND there are no pending unprocessed connection messages". X
> should be on the order of 90, perhaps less for very small clusters.
> 
> Yoram
> 
> -----Original Message-----
> From: Hairong Kuang [mailto:hairong@yahoo-inc.com] 
> Sent: Tuesday, April 04, 2006 5:09 PM
> To: hadoop-dev@lucene.apache.org
> Subject: RE: dfs datanode heartbeats and getBlockwork requests
> 
> I think it is better to implement the start-up delay at the namenode. But
> the key is that the name node should be able to tell if it is in a steady
> state or not either at start-up time or at runtime after a network
> disruption. It should not instruct datanodes to replicate or delete any
> blocks before it has reached a steady state.
> 
> Hairong 
> 
> -----Original Message-----
> From: Doug Cutting [mailto:cutting@apache.org]
> Sent: Tuesday, April 04, 2006 9:58 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: dfs datanode heartbeats and getBlockwork requests
> 
> Eric Baldeschwieler wrote:
> 
>>If we moved to a scheme where the name node was just given a small 
>>number of blocks with each heartbeat, there would be no reason to not 
>>start reporting blocks immediately, would there?
> 
> 
> There would still be a small storm of un-needed replications on startup. 
>   Say it takes a minute at startup for all data nodes to report their
> complete block lists to the name node.  If heartbeats are every 3 seconds,
> then all but the last data node to report in would be handed 20 small lists
> of blocks to start replicating.  And the switches could be saturated doing a
> lot of un-needed transfers, which would slow startup. 
>   Then, for the next minute after startup, the nodes would be told to delete
> blocks that are now over-replicated.  We'd like startup to be as fast and
> painless as possible.  Waiting a bit before checking to see if blocks are
> over- or under-replicated seems a good way.
> 
> Doug
> 
> 
> 

From MAILER-DAEMON Wed Apr  5 18:26:12 2006
Return-Path: 
 <hadoop-dev-return-708-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38249 invoked from network); 5 Apr 2006 18:26:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 18:26:12 -0000
Received: (qmail 36384 invoked by uid 500); 5 Apr 2006 18:26:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36168 invoked by uid 500); 5 Apr 2006 18:26:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35984 invoked by uid 99); 5 Apr 2006 18:26:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 11:26:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 11:26:09 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 92288D4A00
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 19:25:48 +0100 (BST)
Message-ID: <1807834318.1144261548595.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 19:25:48 +0100 (BST)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-120) Reading an ArrayWriter does not work
 because valueClass does not get initialized
In-Reply-To: <925820144.1144194883725.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-120?page=comments#action_12373408 ] 

Andrzej Bialecki  commented on HADOOP-120:
------------------------------------------

Dictionary is stored together inside the file, so I don't think it's a problem - you can always read it later and restore the data.

Caller may be unaware of exact types stored in a Map-like structure, but it should not prevent him from knowing (and using) portions of data that he knows about, so I think this doesn't violate the convention... ok, maybe bends it a little ;)

> Reading an ArrayWriter does not work because valueClass does not get initialized
> --------------------------------------------------------------------------------
>
>          Key: HADOOP-120
>          URL: http://issues.apache.org/jira/browse/HADOOP-120
>      Project: Hadoop
>         Type: Bug

>   Components: io
>  Environment: Red Hat  
>     Reporter: Dick King
>  Attachments: hadoop-120-fix.patch
>
> If you have a Reducer whose value type is an ArrayWriter it gets enstreamed alright but at reconstruction type when ArrayWriter::readFields(DataInput in) runs on a DataInput that has a nonempty ArrayWriter , newInstance fails trying to instantiate the null class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 18:51:47 2006
Return-Path: 
 <hadoop-dev-return-709-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50112 invoked from network); 5 Apr 2006 18:51:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 18:51:47 -0000
Received: (qmail 75616 invoked by uid 500); 5 Apr 2006 18:51:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75520 invoked by uid 500); 5 Apr 2006 18:51:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75510 invoked by uid 99); 5 Apr 2006 18:51:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 11:51:47 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [66.228.160.55] (HELO mercury2.inktomi.com) (66.228.160.55)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 11:51:46 -0700
Received: from inbox2.inktomi.com (inbox2.inktomi.com [66.228.160.112])
	by mercury2.inktomi.com (8.13.4/8.13.4) with ESMTP id k35IounV025540
	for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006 11:50:56 -0700 (PDT)
Received: from [207.126.231.126] ([207.126.231.126]) by
          inbox2.inktomi.com (Netscape Messaging Server 4.1) with ESMTP id
          IX9J0W00.H3N for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006
          11:50:56 -0700
Message-ID: <44341210.6050607@yahoo-inc.com>
Date: Wed, 05 Apr 2006 11:53:04 -0700
From: Sameer Paranjpye <sameerp@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 0.7.1 (Windows/20040626)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: dfs datanode heartbeats and getBlockwork requests
References: <00d801c658ce$335c1da0$929015ac@ds.corp.yahoo.com>
 <4433FD07.5060701@apache.org>
In-Reply-To: <4433FD07.5060701@apache.org>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

There's complexity both ways. Not declaring the set of expected data 
nodes introduces a lot of complexity and delay in namenode startup, as 
seen in this thread.

In this respect, it feels like there's a fundamental difference between 
batch systems and storage systems. For a MapReduce JobTracker or Condor 
like system resource usage is transient, a job is executed on a node, it 
completes and exits, the system no longer cares about the node. In a DFS 
nodes store persistent data which mostly stays in place across namenode 
re-starts. Checkpointing the mapping of blocks to nodes would make 
startup much faster. Instead of waiting for datanodes to connect, the 
namenode could poll and find out who was around. Adding nodes does 
require co-ordination with the namenode, but it seems like node addition 
represents a big enough discontinuity for most installations that 
co-ordinating with the namenode is a small price to pay.

Sameer







Doug Cutting wrote:

> I would rather avoid having to declare the set of expected data nodes if 
> we can avoid it, as I think it introduces a number of complexities.  For 
> example, if you wish to add new data nodes, you cannot simply configure 
> them to point to the name node and start them.  Assuming we add a notion 
> of 'on same rack' or 'on same switch' to dfs, and can ensure that copies 
> of a block are always held on multiple racks/switches, then it's 
> convenient to be able to safely take racks and switches offline and 
> online without coordinating with the namenode.  If a switch fails at 
> startup, and 90% of the expected nodes are not available, we should 
> still start replication, no?  I think a startup replication delay at the 
> namenode handles all of these cases.  If we're worried that the 
> filesystem is unavailable, then we could make the delay smarter.  The 
> namenode could delay some number of minutes or until every block is 
> accounted for, whichever comes first.  And it could refuse/delay client 
> requests until the delay period is over, so that applications don't 
> start up until files are completely available.
> 
> Doug
> 
> Yoram Arnon wrote:
> 
>> Right!
>> The name node, on startup, should know which data nodes are expected 
>> to be
>> there, and not make replication decisions before he knows who's actually
>> there and who's not.
>> A crude way to achieve that is by just waiting for a while, hoping 
>> that all
>> the data nodes connect.
>> A more refined way would be to compare who connected to who is 
>> expected to
>> connect. It enables faster startup when everyone just connects 
>> quickly, and
>> better robustness when some data nodes are slow to connect, or when 
>> the name
>> node is slow to process the barrage of connections.
>> The rule could be "no replications until X% of the expected nodes have
>> connected, AND there are no pending unprocessed connection messages". X
>> should be on the order of 90, perhaps less for very small clusters.
>>
>> Yoram
>>
>> -----Original Message-----
>> From: Hairong Kuang [mailto:hairong@yahoo-inc.com] Sent: Tuesday, 
>> April 04, 2006 5:09 PM
>> To: hadoop-dev@lucene.apache.org
>> Subject: RE: dfs datanode heartbeats and getBlockwork requests
>>
>> I think it is better to implement the start-up delay at the namenode. But
>> the key is that the name node should be able to tell if it is in a steady
>> state or not either at start-up time or at runtime after a network
>> disruption. It should not instruct datanodes to replicate or delete any
>> blocks before it has reached a steady state.
>>
>> Hairong
>> -----Original Message-----
>> From: Doug Cutting [mailto:cutting@apache.org]
>> Sent: Tuesday, April 04, 2006 9:58 AM
>> To: hadoop-dev@lucene.apache.org
>> Subject: Re: dfs datanode heartbeats and getBlockwork requests
>>
>> Eric Baldeschwieler wrote:
>>
>>> If we moved to a scheme where the name node was just given a small 
>>> number of blocks with each heartbeat, there would be no reason to not 
>>> start reporting blocks immediately, would there?
>>
>>
>>
>> There would still be a small storm of un-needed replications on 
>> startup.   Say it takes a minute at startup for all data nodes to 
>> report their
>> complete block lists to the name node.  If heartbeats are every 3 
>> seconds,
>> then all but the last data node to report in would be handed 20 small 
>> lists
>> of blocks to start replicating.  And the switches could be saturated 
>> doing a
>> lot of un-needed transfers, which would slow startup.   Then, for the 
>> next minute after startup, the nodes would be told to delete
>> blocks that are now over-replicated.  We'd like startup to be as fast and
>> painless as possible.  Waiting a bit before checking to see if blocks are
>> over- or under-replicated seems a good way.
>>
>> Doug
>>
>>
>>
> 

From MAILER-DAEMON Wed Apr  5 19:03:08 2006
Return-Path: 
 <hadoop-dev-return-710-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56182 invoked from network); 5 Apr 2006 19:03:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 19:03:08 -0000
Received: (qmail 1203 invoked by uid 500); 5 Apr 2006 19:03:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1184 invoked by uid 500); 5 Apr 2006 19:03:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1175 invoked by uid 99); 5 Apr 2006 19:03:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 12:03:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 12:03:06 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id AAB696ACA9
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 20:02:45 +0100 (BST)
Message-ID: <1875072507.1144263765678.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 20:02:45 +0100 (BST)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Reopened: (HADOOP-112) copyFromLocal should exclude .crc
 files
In-Reply-To: <893191320.1143728846291.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-112?page=all ]
     
Konstantin Shvachko reopened HADOOP-112:
----------------------------------------


I cannot see what exactly was committed here, but now regular dfs -cp doesn't
copy crc files, which causes e.g. dfs -cat complain about it.
I presume that changes were made to FileUtil.copyContents() which is called in
several places, which sometimes do and sometimes do not need crc files.
In case of dfs copy the crc files are needed.

> copyFromLocal should exclude .crc files
> ---------------------------------------
>
>          Key: HADOOP-112
>          URL: http://issues.apache.org/jira/browse/HADOOP-112
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: DFS cluster of 6 3hz Xeons with 2Gb RAM running Centos 4.2 and Sun's JDK1.5 - but Probably applies in any environment
>     Reporter: Monu Ogbe
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.0

>
> Doug Cutting says: "The problem is that when copyFromLocal 
> enumerates local files it should exclude .crc files, but it does not. 
> This is the listFiles() call on DistributedFileSystem:160.  It should 
> filter this, excluding files that are FileSystem.isChecksumFile().
> BTW, as a workaround, it is safe to first remove all of the .crc files, 
> but your files will no longer be checksummed as they are read.  On 
> systems without ECC memory file corruption is not uncommon, but I have 
> seen very little on clusters that have ECC."
> Original observations:
> Hello Team,
> I created a backup of my DFS database:
> # bin/hadoop dfs -copyToLocal /user/root/crawl /mylocaldir
> I now want to restore from the backup using:
> # bin/hadoop dfs -copyFromLocal /mylocaldir/crawl /user/root
> However I'm getting the following error:
> copyFromLocal: Target /user/root/crawl/crawldb/current/part-00000/.data.crc
> already exists
> I get this message with every permutation of the command that I've tried, and
> even after totally deleting all content in the DFS directories.
> I'd be grateful for any pointers.
> Many thanks,

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 19:07:57 2006
Return-Path: 
 <hadoop-dev-return-711-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58641 invoked from network); 5 Apr 2006 19:07:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 19:07:57 -0000
Received: (qmail 14416 invoked by uid 500); 5 Apr 2006 19:07:57 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14317 invoked by uid 500); 5 Apr 2006 19:07:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14308 invoked by uid 99); 5 Apr 2006 19:07:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 12:07:56 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 12:07:55 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k35J7bBf020048
	for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006 15:07:37 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k35J7PX5299018;
	Wed, 5 Apr 2006 15:07:28 -0400
Message-ID: <4434156D.5030609@apache.org>
Date: Wed, 05 Apr 2006 12:07:25 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: code checker
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

The issue of unused variables and imports has come up for Hadoop. 
Different folks use different development environments, not all of which 
warn about the same things.  Perhaps if we integrated a code checker 
into Hadoop's build process then we could more easily guarantee that 
commits are not made that contain such things.

The PMD project includes an Ant task that implements code checking:

http://pmd.sourceforge.net/ant-task.html

We could incorporate this into Hadoop's build.xml.  We could add a 
"pre-commit" task that performs this along with "clean", "test", and 
perhaps "javadoc".  The PMD rule sets that look reasonable to me are: 
"Basic", "Unused Code", "Import Statements".

What do folks think?

Would anyone like to volunteer to add something like this to build.xml?

Doug

From MAILER-DAEMON Wed Apr  5 19:10:38 2006
Return-Path: 
 <hadoop-dev-return-712-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59790 invoked from network); 5 Apr 2006 19:10:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 19:10:38 -0000
Received: (qmail 20024 invoked by uid 500); 5 Apr 2006 19:10:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20007 invoked by uid 500); 5 Apr 2006 19:10:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19998 invoked by uid 99); 5 Apr 2006 19:10:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 12:10:37 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 12:10:36 -0700
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k35J9GQd049979
	for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006 12:09:16 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=LULaW+naiNmhk4I4vWlkclCNAgrQX7ckePBoitwZ7JnbGHuvFJxA/K9dQ8YDVUO3
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: dfs datanode heartbeats and getBlockwork requests
Date: Wed, 5 Apr 2006 12:11:20 -0700
Message-ID: <00e001c658e4$b91ab1c0$929015ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4433FD07.5060701@apache.org>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZY1cYCiN2QsZb1RJCvgSmvNspGPgADguSA
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Waiting until every block to be accounted for is a good approach, except
when a block is actually lost, which we expect to be rare.
Declaring the expected data nodes can be flexible however: initially the
list is empty, and it is populated as nodes first connect. It's kept
persistent, so that when the name node restarts it knows who was connected
when it went down, aka the expected list, and waits for them. When a node is
declared dead, and its blocks are replicated elsewhere, it is also taken off
the list. If/when it reconnects, it gets added back. That avoids having to
manually configure the list on the name node.
That said, it's useful to actully configure the name node manually,
preventing configuration errors where some data node connects to the wrong
name node. One central configuration is easier to control and maintain than
many remote configs. That's a separate argument though - we can get all we
need without this feature too.

Yoram

-----Original Message-----
From: Doug Cutting [mailto:cutting@apache.org] 
Sent: Wednesday, April 05, 2006 10:23 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: dfs datanode heartbeats and getBlockwork requests

I would rather avoid having to declare the set of expected data nodes if we
can avoid it, as I think it introduces a number of complexities.  For
example, if you wish to add new data nodes, you cannot simply configure them
to point to the name node and start them.  Assuming we add a notion of 'on
same rack' or 'on same switch' to dfs, and can ensure that copies of a block
are always held on multiple racks/switches, then it's convenient to be able
to safely take racks and switches offline and online without coordinating
with the namenode.  If a switch fails at startup, and 90% of the expected
nodes are not available, we should still start replication, no?  I think a
startup replication delay at the namenode handles all of these cases.  If
we're worried that the filesystem is unavailable, then we could make the
delay smarter.  The namenode could delay some number of minutes or until
every block is accounted for, whichever comes first.  And it could
refuse/delay client requests until the delay period is over, so that
applications don't start up until files are completely available.

Doug

Yoram Arnon wrote:
> Right!
> The name node, on startup, should know which data nodes are expected 
> to be there, and not make replication decisions before he knows who's 
> actually there and who's not.
> A crude way to achieve that is by just waiting for a while, hoping 
> that all the data nodes connect.
> A more refined way would be to compare who connected to who is 
> expected to connect. It enables faster startup when everyone just 
> connects quickly, and better robustness when some data nodes are slow 
> to connect, or when the name node is slow to process the barrage of
connections.
> The rule could be "no replications until X% of the expected nodes have 
> connected, AND there are no pending unprocessed connection messages". 
> X should be on the order of 90, perhaps less for very small clusters.
> 
> Yoram
> 
> -----Original Message-----
> From: Hairong Kuang [mailto:hairong@yahoo-inc.com]
> Sent: Tuesday, April 04, 2006 5:09 PM
> To: hadoop-dev@lucene.apache.org
> Subject: RE: dfs datanode heartbeats and getBlockwork requests
> 
> I think it is better to implement the start-up delay at the namenode. 
> But the key is that the name node should be able to tell if it is in a 
> steady state or not either at start-up time or at runtime after a 
> network disruption. It should not instruct datanodes to replicate or 
> delete any blocks before it has reached a steady state.
> 
> Hairong
> 
> -----Original Message-----
> From: Doug Cutting [mailto:cutting@apache.org]
> Sent: Tuesday, April 04, 2006 9:58 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: dfs datanode heartbeats and getBlockwork requests
> 
> Eric Baldeschwieler wrote:
> 
>>If we moved to a scheme where the name node was just given a small 
>>number of blocks with each heartbeat, there would be no reason to not 
>>start reporting blocks immediately, would there?
> 
> 
> There would still be a small storm of un-needed replications on startup. 
>   Say it takes a minute at startup for all data nodes to report their 
> complete block lists to the name node.  If heartbeats are every 3 
> seconds, then all but the last data node to report in would be handed 
> 20 small lists of blocks to start replicating.  And the switches could 
> be saturated doing a lot of un-needed transfers, which would slow startup.
>   Then, for the next minute after startup, the nodes would be told to 
> delete blocks that are now over-replicated.  We'd like startup to be 
> as fast and painless as possible.  Waiting a bit before checking to 
> see if blocks are
> over- or under-replicated seems a good way.
> 
> Doug
> 
> 
> 



From MAILER-DAEMON Wed Apr  5 19:18:10 2006
Return-Path: 
 <hadoop-dev-return-713-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62851 invoked from network); 5 Apr 2006 19:18:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 19:18:10 -0000
Received: (qmail 32301 invoked by uid 500); 5 Apr 2006 19:18:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32286 invoked by uid 500); 5 Apr 2006 19:18:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32277 invoked by uid 99); 5 Apr 2006 19:18:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 12:18:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 12:18:06 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 01683D4A00
	for <hadoop-dev@lucene.apache.org>; Wed,  5 Apr 2006 20:17:45 +0100 (BST)
Message-ID: <504504056.1144264665002.JavaMail.jira@ajax>
Date: Wed, 5 Apr 2006 20:17:45 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-112) copyFromLocal should exclude .crc
 files
In-Reply-To: <893191320.1143728846291.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-112?page=comments#action_12373413 ] 

Doug Cutting commented on HADOOP-112:
-------------------------------------

The changes made are listed at:

http://svn.apache.org/viewcvs?rev=390218&view=rev

The described problem was fixed: a -copyToLocal (a.k.a -get) followed by a -copyFromLocal (a.k.a. -put) no longer fails complaining about a .crc file.  If this is failing again then this bug should be re-opened.  Otherwise I think it should remain closed.

If there is a problem with 'dfs -cp' then I think that is a separate bug, no?


> copyFromLocal should exclude .crc files
> ---------------------------------------
>
>          Key: HADOOP-112
>          URL: http://issues.apache.org/jira/browse/HADOOP-112
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: DFS cluster of 6 3hz Xeons with 2Gb RAM running Centos 4.2 and Sun's JDK1.5 - but Probably applies in any environment
>     Reporter: Monu Ogbe
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.0

>
> Doug Cutting says: "The problem is that when copyFromLocal 
> enumerates local files it should exclude .crc files, but it does not. 
> This is the listFiles() call on DistributedFileSystem:160.  It should 
> filter this, excluding files that are FileSystem.isChecksumFile().
> BTW, as a workaround, it is safe to first remove all of the .crc files, 
> but your files will no longer be checksummed as they are read.  On 
> systems without ECC memory file corruption is not uncommon, but I have 
> seen very little on clusters that have ECC."
> Original observations:
> Hello Team,
> I created a backup of my DFS database:
> # bin/hadoop dfs -copyToLocal /user/root/crawl /mylocaldir
> I now want to restore from the backup using:
> # bin/hadoop dfs -copyFromLocal /mylocaldir/crawl /user/root
> However I'm getting the following error:
> copyFromLocal: Target /user/root/crawl/crawldb/current/part-00000/.data.crc
> already exists
> I get this message with every permutation of the command that I've tried, and
> even after totally deleting all content in the DFS directories.
> I'd be grateful for any pointers.
> Many thanks,

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 20:21:14 2006
Return-Path: 
 <hadoop-dev-return-714-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4154 invoked from network); 5 Apr 2006 20:21:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 20:21:14 -0000
Received: (qmail 64494 invoked by uid 500); 5 Apr 2006 20:21:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64398 invoked by uid 500); 5 Apr 2006 20:21:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64387 invoked by uid 99); 5 Apr 2006 20:21:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 13:21:13 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 13:21:12 -0700
Received: from [207.126.231.161] (oom-mac.corp.yahoo.com [207.126.231.161])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k35KKT7Q025905
	for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006 13:20:29 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:in-reply-to:references:content-type:message-id:
	content-transfer-encoding:from:subject:date:to:x-mailer;
	b=ZFiLPfQo1+WARIEXG861xTcAJOqe8QajRHyTz2k8h/iJHnm/8s2vGiNvQpNr5eiY
Mime-Version: 1.0 (Apple Message framework v623)
In-Reply-To: <4434156D.5030609@apache.org>
References: <4434156D.5030609@apache.org>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Message-Id: <963c9a4a61daa6124e97f2c8c44f9d6a@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: Re: code checker
Date: Wed, 5 Apr 2006 13:20:53 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


On Apr 5, 2006, at 12:07 PM, Doug Cutting wrote:

> The issue of unused variables and imports has come up for Hadoop. 
> Different folks use different development environments, not all of 
> which warn about the same things.  Perhaps if we integrated a code 
> checker into Hadoop's build process then we could more easily 
> guarantee that commits are not made that contain such things.
>
> The PMD project includes an Ant task that implements code checking:

Code checkers are good. The last time I used them, findBugs 
(http://findbugs.sourceforge.net/) was better than PMD in terms of both 
finding "real" things and a lower false positive rate.

-- Owen


From MAILER-DAEMON Wed Apr  5 20:28:36 2006
Return-Path: 
 <hadoop-dev-return-715-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10743 invoked from network); 5 Apr 2006 20:28:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 20:28:36 -0000
Received: (qmail 90594 invoked by uid 500); 5 Apr 2006 20:28:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90499 invoked by uid 500); 5 Apr 2006 20:28:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90489 invoked by uid 99); 5 Apr 2006 20:28:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 13:28:36 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of Lawrence@theladders.com
 designates 67.151.144.115 as permitted sender)
Received: from [67.151.144.115] (HELO hermes.laddersoffice.com)
 (67.151.144.115)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 13:28:34 -0700
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: quoted-printable
Subject: RE: code checker
Date: Wed, 5 Apr 2006 16:28:13 -0400
Message-ID: 
 <B117CDDF09DCE34A992927EE3581CA4C024A0AB1@hermes.laddersoffice.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: code checker
thread-index: AcZY7oJe1EDLL7HmTMGSrmCWp79eTwAABz/g
From: "Larry Ogrodnek" <Lawrence@theladders.com>
To: <hadoop-dev@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

CheckStyle [http://checkstyle.sourceforge.net/] is also pretty neat.
While it's more a coding style checker than a static code checker, it
does report on unused imports, unnecessary modifiers/casting, cyclomatic
complexity, etc.

It might be worth setting up in addition to either PMD or findbugs.

-----Original Message-----
From: Owen O'Malley [mailto:owen@yahoo-inc.com]=20
Sent: Wednesday, April 05, 2006 4:21 PM
To: hadoop-dev@lucene.apache.org
Subject: Re: code checker


On Apr 5, 2006, at 12:07 PM, Doug Cutting wrote:

> The issue of unused variables and imports has come up for Hadoop.=20
> Different folks use different development environments, not all of=20
> which warn about the same things.  Perhaps if we integrated a code=20
> checker into Hadoop's build process then we could more easily=20
> guarantee that commits are not made that contain such things.
>
> The PMD project includes an Ant task that implements code checking:

Code checkers are good. The last time I used them, findBugs=20
(http://findbugs.sourceforge.net/) was better than PMD in terms of both=20
finding "real" things and a lower false positive rate.

-- Owen


From MAILER-DAEMON Wed Apr  5 20:34:36 2006
Return-Path: 
 <hadoop-dev-return-716-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14304 invoked from network); 5 Apr 2006 20:34:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 20:34:36 -0000
Received: (qmail 2812 invoked by uid 500); 5 Apr 2006 20:34:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2790 invoked by uid 500); 5 Apr 2006 20:34:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2781 invoked by uid 99); 5 Apr 2006 20:34:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 13:34:35 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 13:34:34 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k35KY6bL013444
	for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006 16:34:07 -0400
X-ORBL: [69.228.204.183]
Received: from [192.168.168.15] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k35KY6hu077224;
	Wed, 5 Apr 2006 16:34:09 -0400
Message-ID: <443429BD.3020207@apache.org>
Date: Wed, 05 Apr 2006 13:34:05 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: code checker
References: <4434156D.5030609@apache.org>
 <963c9a4a61daa6124e97f2c8c44f9d6a@yahoo-inc.com>
In-Reply-To: <963c9a4a61daa6124e97f2c8c44f9d6a@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Owen O'Malley wrote:
> The last time I used them, findBugs 
> (http://findbugs.sourceforge.net/) was better than PMD in terms of both 
> finding "real" things and a lower false positive rate.

Unfortunately FindBugs is under LGPL, so we could not include it in 
Hadoop's lib directory, but must rather get folks to install it themselves.

Doug

From MAILER-DAEMON Wed Apr  5 23:22:05 2006
Return-Path: 
 <hadoop-dev-return-717-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84987 invoked from network); 5 Apr 2006 23:22:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 23:22:05 -0000
Received: (qmail 54420 invoked by uid 500); 5 Apr 2006 23:22:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54396 invoked by uid 500); 5 Apr 2006 23:22:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54387 invoked by uid 99); 5 Apr 2006 23:22:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 16:22:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 16:22:04 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7FCD56ACAC
	for <hadoop-dev@lucene.apache.org>; Thu,  6 Apr 2006 00:21:43 +0100 (BST)
Message-ID: <938081928.1144279303521.JavaMail.jira@ajax>
Date: Thu, 6 Apr 2006 00:21:43 +0100 (BST)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-121) failed to run FSck with -move option
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

failed to run FSck with -move option
------------------------------------

         Key: HADOOP-121
         URL: http://issues.apache.org/jira/browse/HADOOP-121
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.1.0    
    Reporter: Hairong Kuang


I received the following error when running FSck with -move option. The dfs was started as "crawler".  /export/crawlspace2/kryptonite/hadoop/dfs/data/tmp is writable only by "crawler". The fsck was ran by a client that did not have the write right to  /export/crawlspace2/kryptonite/hadoop/dfs/data/tmp.

 - moving to /lost+found: /data/webdata/fastcrawl/23FEB2006/82.PC
java.io.FileNotFoundException: /export/crawlspace2/kryptonite/hadoop/dfs/data/tmp/client-8234960199756230677 (Permission denied)
        at java.io.FileOutputStream.open(Native Method)
        at java.io.FileOutputStream.<init>(FileOutputStream.java:179)
        at java.io.FileOutputStream.<init>(FileOutputStream.java:131)
        at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.<init>(DFSClient.java:546)
        at org.apache.hadoop.dfs.DFSClient.create(DFSClient.java:99)
        at org.apache.hadoop.dfs.DFSck.lostFoundMove(DFSck.java:222)
        at org.apache.hadoop.dfs.DFSck.check(DFSck.java:178)
        at org.apache.hadoop.dfs.DFSck.check(DFSck.java:124)
        at org.apache.hadoop.dfs.DFSck.fsck(DFSck.java:112)
        at org.apache.hadoop.dfs.DFSck.main(DFSck.java:433)
Failed to move /data/webdata/fastcrawl/23FEB2006/82.PC to /lost+found: /export/crawlspace2/kryptonite/hadoop/dfs/data/tmp/client-8234960199756230677 (Permission denied)


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr  5 23:48:06 2006
Return-Path: 
 <hadoop-dev-return-718-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97394 invoked from network); 5 Apr 2006 23:48:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Apr 2006 23:48:06 -0000
Received: (qmail 85033 invoked by uid 500); 5 Apr 2006 23:48:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85013 invoked by uid 500); 5 Apr 2006 23:48:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85004 invoked by uid 99); 5 Apr 2006 23:48:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 16:48:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 16:48:05 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 275A76ACAC
	for <hadoop-dev@lucene.apache.org>; Thu,  6 Apr 2006 00:47:44 +0100 (BST)
Message-ID: <478483094.1144280864158.JavaMail.jira@ajax>
Date: Thu, 6 Apr 2006 00:47:44 +0100 (BST)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Deleted: (HADOOP-121) failed to run FSck with -move option
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-121?page=all ]
     
Sameer Paranjpye deleted HADOOP-121:
------------------------------------


> failed to run FSck with -move option
> ------------------------------------
>
>          Key: HADOOP-121
>          URL: http://issues.apache.org/jira/browse/HADOOP-121
>      Project: Hadoop
>         Type: Bug

>     Reporter: Hairong Kuang

>
> I received the following error when running FSck with -move option. The dfs was started as "crawler".  /export/crawlspace2/kryptonite/hadoop/dfs/data/tmp is writable only by "crawler". The fsck was ran by a client that did not have the write right to  /export/crawlspace2/kryptonite/hadoop/dfs/data/tmp.
>  - moving to /lost+found: /data/webdata/fastcrawl/23FEB2006/82.PC
> java.io.FileNotFoundException: /export/crawlspace2/kryptonite/hadoop/dfs/data/tmp/client-8234960199756230677 (Permission denied)
>         at java.io.FileOutputStream.open(Native Method)
>         at java.io.FileOutputStream.<init>(FileOutputStream.java:179)
>         at java.io.FileOutputStream.<init>(FileOutputStream.java:131)
>         at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.<init>(DFSClient.java:546)
>         at org.apache.hadoop.dfs.DFSClient.create(DFSClient.java:99)
>         at org.apache.hadoop.dfs.DFSck.lostFoundMove(DFSck.java:222)
>         at org.apache.hadoop.dfs.DFSck.check(DFSck.java:178)
>         at org.apache.hadoop.dfs.DFSck.check(DFSck.java:124)
>         at org.apache.hadoop.dfs.DFSck.fsck(DFSck.java:112)
>         at org.apache.hadoop.dfs.DFSck.main(DFSck.java:433)
> Failed to move /data/webdata/fastcrawl/23FEB2006/82.PC to /lost+found: /export/crawlspace2/kryptonite/hadoop/dfs/data/tmp/client-8234960199756230677 (Permission denied)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr  6 00:01:09 2006
Return-Path: 
 <hadoop-dev-return-719-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4019 invoked from network); 6 Apr 2006 00:01:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Apr 2006 00:01:09 -0000
Received: (qmail 97976 invoked by uid 500); 6 Apr 2006 00:01:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97957 invoked by uid 500); 6 Apr 2006 00:01:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97948 invoked by uid 99); 6 Apr 2006 00:01:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 17:01:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 17:01:05 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 79AE46ACAC
	for <hadoop-dev@lucene.apache.org>; Thu,  6 Apr 2006 01:00:44 +0100 (BST)
Message-ID: <1204783379.1144281644496.JavaMail.jira@ajax>
Date: Thu, 6 Apr 2006 01:00:44 +0100 (BST)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-122) Failed to execute fsck with -move
 option
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Failed to execute fsck with -move option
----------------------------------------

         Key: HADOOP-122
         URL: http://issues.apache.org/jira/browse/HADOOP-122
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Reporter: Hairong Kuang


I received the following error when running fsck with -move option. The dfs was started by a user while the fsck was ran by a different user that does not have the write access to the hadoop dfs data directory.

- moving to /lost+found: /data.txt
java.io.FileNotFoundException: hadoop-dfs-data-dir/tmp/client-8234960199756230677 (Permission denied)
at java.io.FileOutputStream.open(Native Method)
at java.io.FileOutputStream.<init>(FileOutputStream.java:179)
at java.io.FileOutputStream.<init>(FileOutputStream.java:131)
at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.<init>(DFSClient.java:546)
at org.apache.hadoop.dfs.DFSClient.create(DFSClient.java:99)
at org.apache.hadoop.dfs.DFSck.lostFoundMove(DFSck.java:222)
at org.apache.hadoop.dfs.DFSck.check(DFSck.java:178)
at org.apache.hadoop.dfs.DFSck.check(DFSck.java:124)
at org.apache.hadoop.dfs.DFSck.fsck(DFSck.java:112)
at org.apache.hadoop.dfs.DFSck.main(DFSck.java:433)
Failed to move /data.txt to /lost+found: hadoop-dfs-data-dir/tmp/client-8234960199756230677 (Permission denied)


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr  6 03:57:26 2006
Return-Path: 
 <hadoop-dev-return-720-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93779 invoked from network); 6 Apr 2006 03:57:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Apr 2006 03:57:26 -0000
Received: (qmail 99835 invoked by uid 500); 6 Apr 2006 03:57:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99810 invoked by uid 500); 6 Apr 2006 03:57:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99801 invoked by uid 99); 6 Apr 2006 03:57:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 20:57:25 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Apr 2006 20:57:24 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch1.xch.corp.yahoo.com
 [216.145.51.233])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k363tuRY002960
	for <hadoop-dev@lucene.apache.org>; Wed, 5 Apr 2006 20:55:56 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=k3VNXwBR5mu8BfQ1x01n1myvQ6I1ZtSiCXtBl3xq75EWDrdQfTr91M0j2ED07tN0
Received: from [10.0.1.2] ([172.21.179.133]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 5 Apr 2006 20:55:56 -0700
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <00e001c658e4$b91ab1c0$929015ac@ds.corp.yahoo.com>
References: <00e001c658e4$b91ab1c0$929015ac@ds.corp.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <09764B5C-2E6C-4BC4-9AB9-227446B0B063@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: dfs datanode heartbeats and getBlockwork requests
Date: Wed, 5 Apr 2006 20:55:50 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 06 Apr 2006 03:55:56.0290 (UTC)
 FILETIME=[01F5EE20:01C6592E]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

but I think we should work through the separate argument around  
configuration.  As sameer indicated, there are plenty of issues with  
our current approach.  I've had a lot of experience with systems  
where you enumerate the nodes in your storage.  Editing a single file  
is really not a lot of burden to impose on system owner who wants to  
add nodes.

It makes replication decisions much easier too.  Much of the "ease of  
admin" and "simplicity" perceived to be gained by not enumerating the  
nodes is simply illusory.  If you loose a rack and the system works,  
the system should recover, but how do you plan to define a rack?  If  
you loose some other 20% of your system, starting to replicate may or  
may not be the best strategy.  It certainly is not the best strategy  
on startup.

To repeat what sameer said, I think central configuration of the HDFS  
nodes is worth discussing.  Its how I'd prefer to operate our  
cluster.  It also keeps the configuration of the clients simpler and  
allows you to trivially move the master if it poles, which can be  
important if you loose the master node.  The map-reduce master is  
different.  There task trackers registering seems the more natural  
design.

On Apr 5, 2006, at 12:11 PM, Yoram Arnon wrote:

> Waiting until every block to be accounted for is a good approach,  
> except
> when a block is actually lost, which we expect to be rare.
> Declaring the expected data nodes can be flexible however:  
> initially the
> list is empty, and it is populated as nodes first connect. It's kept
> persistent, so that when the name node restarts it knows who was  
> connected
> when it went down, aka the expected list, and waits for them. When  
> a node is
> declared dead, and its blocks are replicated elsewhere, it is also  
> taken off
> the list. If/when it reconnects, it gets added back. That avoids  
> having to
> manually configure the list on the name node.
> That said, it's useful to actully configure the name node manually,
> preventing configuration errors where some data node connects to  
> the wrong
> name node. One central configuration is easier to control and  
> maintain than
> many remote configs. That's a separate argument though - we can get  
> all we
> need without this feature too.
>
> Yoram
>
> -----Original Message-----
> From: Doug Cutting [mailto:cutting@apache.org]
> Sent: Wednesday, April 05, 2006 10:23 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: dfs datanode heartbeats and getBlockwork requests
>
> I would rather avoid having to declare the set of expected data  
> nodes if we
> can avoid it, as I think it introduces a number of complexities.  For
> example, if you wish to add new data nodes, you cannot simply  
> configure them
> to point to the name node and start them.  Assuming we add a notion  
> of 'on
> same rack' or 'on same switch' to dfs, and can ensure that copies  
> of a block
> are always held on multiple racks/switches, then it's convenient to  
> be able
> to safely take racks and switches offline and online without  
> coordinating
> with the namenode.  If a switch fails at startup, and 90% of the  
> expected
> nodes are not available, we should still start replication, no?  I  
> think a
> startup replication delay at the namenode handles all of these  
> cases.  If
> we're worried that the filesystem is unavailable, then we could  
> make the
> delay smarter.  The namenode could delay some number of minutes or  
> until
> every block is accounted for, whichever comes first.  And it could
> refuse/delay client requests until the delay period is over, so that
> applications don't start up until files are completely available.
>
> Doug
>
> Yoram Arnon wrote:
>> Right!
>> The name node, on startup, should know which data nodes are expected
>> to be there, and not make replication decisions before he knows who's
>> actually there and who's not.
>> A crude way to achieve that is by just waiting for a while, hoping
>> that all the data nodes connect.
>> A more refined way would be to compare who connected to who is
>> expected to connect. It enables faster startup when everyone just
>> connects quickly, and better robustness when some data nodes are slow
>> to connect, or when the name node is slow to process the barrage of
> connections.
>> The rule could be "no replications until X% of the expected nodes  
>> have
>> connected, AND there are no pending unprocessed connection messages".
>> X should be on the order of 90, perhaps less for very small clusters.
>>
>> Yoram
>>
>> -----Original Message-----
>> From: Hairong Kuang [mailto:hairong@yahoo-inc.com]
>> Sent: Tuesday, April 04, 2006 5:09 PM
>> To: hadoop-dev@lucene.apache.org
>> Subject: RE: dfs datanode heartbeats and getBlockwork requests
>>
>> I think it is better to implement the start-up delay at the namenode.
>> But the key is that the name node should be able to tell if it is  
>> in a
>> steady state or not either at start-up time or at runtime after a
>> network disruption. It should not instruct datanodes to replicate or
>> delete any blocks before it has reached a steady state.
>>
>> Hairong
>>
>> -----Original Message-----
>> From: Doug Cutting [mailto:cutting@apache.org]
>> Sent: Tuesday, April 04, 2006 9:58 AM
>> To: hadoop-dev@lucene.apache.org
>> Subject: Re: dfs datanode heartbeats and getBlockwork requests
>>
>> Eric Baldeschwieler wrote:
>>
>>> If we moved to a scheme where the name node was just given a small
>>> number of blocks with each heartbeat, there would be no reason to  
>>> not
>>> start reporting blocks immediately, would there?
>>
>>
>> There would still be a small storm of un-needed replications on  
>> startup.
>>   Say it takes a minute at startup for all data nodes to report their
>> complete block lists to the name node.  If heartbeats are every 3
>> seconds, then all but the last data node to report in would be handed
>> 20 small lists of blocks to start replicating.  And the switches  
>> could
>> be saturated doing a lot of un-needed transfers, which would slow  
>> startup.
>>   Then, for the next minute after startup, the nodes would be told to
>> delete blocks that are now over-replicated.  We'd like startup to be
>> as fast and painless as possible.  Waiting a bit before checking to
>> see if blocks are
>> over- or under-replicated seems a good way.
>>
>> Doug
>>
>>
>>
>
>


From MAILER-DAEMON Thu Apr  6 17:31:34 2006
Return-Path: 
 <hadoop-dev-return-721-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54486 invoked from network); 6 Apr 2006 17:31:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Apr 2006 17:31:34 -0000
Received: (qmail 77105 invoked by uid 500); 6 Apr 2006 17:31:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77073 invoked by uid 500); 6 Apr 2006 17:31:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77049 invoked by uid 99); 6 Apr 2006 17:31:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 10:31:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 10:31:29 -0700
Received: from pimout3-ext.prodigy.net (pimout3-int.prodigy.net
 [207.115.4.218])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k36HV8Bf020135
	for <hadoop-dev@lucene.apache.org>; Thu, 6 Apr 2006 13:31:09 -0400
X-ORBL: [69.228.204.183]
Received: from [127.0.0.1] (adsl-69-228-204-183.dsl.pltn13.pacbell.net
 [69.228.204.183])
	by pimout3-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k36HUkV4072134;
	Thu, 6 Apr 2006 13:30:56 -0400
Message-ID: <4435503F.1000303@apache.org>
Date: Thu, 06 Apr 2006 10:30:39 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: dfs datanode heartbeats and getBlockwork requests
References: <00e001c658e4$b91ab1c0$929015ac@ds.corp.yahoo.com>
 <09764B5C-2E6C-4BC4-9AB9-227446B0B063@yahoo-inc.com>
In-Reply-To: <09764B5C-2E6C-4BC4-9AB9-227446B0B063@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
> To repeat what sameer said, I think central configuration of the HDFS 
> nodes is worth discussing.

Whatever.  I'm already tired of arguing about this.  Both ways can 
probably be made to work.  It's really up to whoever implements things. 
  We need a reliable, scalable, easy-to-operate and easy-to-maintain 
filesystem.  Code contributions towards that will not be rejected.

Doug

From MAILER-DAEMON Thu Apr  6 17:48:02 2006
Return-Path: 
 <hadoop-dev-return-722-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63246 invoked from network); 6 Apr 2006 17:48:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Apr 2006 17:48:02 -0000
Received: (qmail 10372 invoked by uid 500); 6 Apr 2006 17:48:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10275 invoked by uid 500); 6 Apr 2006 17:48:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10264 invoked by uid 99); 6 Apr 2006 17:48:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 10:48:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 10:48:01 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 373B4D4A00
	for <hadoop-dev@lucene.apache.org>; Thu,  6 Apr 2006 18:47:40 +0100 (BST)
Message-ID: <185979255.1144345660223.JavaMail.jira@ajax>
Date: Thu, 6 Apr 2006 18:47:40 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-118) Namenode does not always clean up
 pendingCreates
In-Reply-To: <1720783348.1144168243567.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-118?page=all ]

Owen O'Malley reassigned HADOOP-118:
------------------------------------

    Assign To: Owen O'Malley

> Namenode does not always clean up pendingCreates
> ------------------------------------------------
>
>          Key: HADOOP-118
>          URL: http://issues.apache.org/jira/browse/HADOOP-118
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>  Environment: 195 node cluster running redhat linux (2.6 kernel)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical

>
> In some failure modes, the pending creates list is not cleaned up and prevents that file from ever being created.
> When I try to create the file after the first job was killed (hours previously), I get:
> 060404 084619 Cannot start file because pendingCreates is non-null. src=/user/oom/rand/part000118
> 060404 084619 Server handler 0 on 8020 call error: java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
> java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
>         at org.apache.hadoop.dfs.NameNode.create(NameNode.java:147)
>         at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr  6 18:35:53 2006
Return-Path: 
 <hadoop-dev-return-723-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 98374 invoked from network); 6 Apr 2006 18:35:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Apr 2006 18:35:53 -0000
Received: (qmail 12199 invoked by uid 500); 6 Apr 2006 18:35:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12152 invoked by uid 500); 6 Apr 2006 18:35:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12105 invoked by uid 99); 6 Apr 2006 18:35:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 11:35:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 11:35:45 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 66F2F6ACA9
	for <hadoop-dev@lucene.apache.org>; Thu,  6 Apr 2006 19:35:24 +0100 (BST)
Message-ID: <927904038.1144348524414.JavaMail.jira@ajax>
Date: Thu, 6 Apr 2006 19:35:24 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-123) mini map/reduce cluster for junit
 tests
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

mini map/reduce cluster for junit tests
---------------------------------------

         Key: HADOOP-123
         URL: http://issues.apache.org/jira/browse/HADOOP-123
     Project: Hadoop
        Type: New Feature

  Components: mapred  
    Reporter: Owen O'Malley


I would like a single process map-reduce pseduo-distributed cluster that can be used for unit tests. We should add a unit test with a word count map/reduce.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr  6 18:35:55 2006
Return-Path: 
 <hadoop-dev-return-724-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 98453 invoked from network); 6 Apr 2006 18:35:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Apr 2006 18:35:55 -0000
Received: (qmail 13747 invoked by uid 500); 6 Apr 2006 18:35:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13731 invoked by uid 500); 6 Apr 2006 18:35:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13722 invoked by uid 99); 6 Apr 2006 18:35:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 11:35:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 11:35:53 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9F0A06ACAB
	for <hadoop-dev@lucene.apache.org>; Thu,  6 Apr 2006 19:35:32 +0100 (BST)
Message-ID: <755016489.1144348532648.JavaMail.jira@ajax>
Date: Thu, 6 Apr 2006 19:35:32 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-123) mini map/reduce cluster for junit
 tests
In-Reply-To: <927904038.1144348524414.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-123?page=all ]

Owen O'Malley reassigned HADOOP-123:
------------------------------------

    Assign To: Owen O'Malley

> mini map/reduce cluster for junit tests
> ---------------------------------------
>
>          Key: HADOOP-123
>          URL: http://issues.apache.org/jira/browse/HADOOP-123
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> I would like a single process map-reduce pseduo-distributed cluster that can be used for unit tests. We should add a unit test with a word count map/reduce.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr  6 20:43:54 2006
Return-Path: 
 <hadoop-dev-return-725-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83745 invoked from network); 6 Apr 2006 20:43:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Apr 2006 20:43:54 -0000
Received: (qmail 97063 invoked by uid 500); 6 Apr 2006 20:43:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97031 invoked by uid 500); 6 Apr 2006 20:43:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97018 invoked by uid 99); 6 Apr 2006 20:43:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 13:43:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 13:43:52 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7F088D4A00
	for <hadoop-dev@lucene.apache.org>; Thu,  6 Apr 2006 21:43:31 +0100 (BST)
Message-ID: <143606557.1144356211517.JavaMail.jira@ajax>
Date: Thu, 6 Apr 2006 21:43:31 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-118) Namenode does not always clean up
 pendingCreates
In-Reply-To: <1720783348.1144168243567.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-118?page=all ]

Owen O'Malley updated HADOOP-118:
---------------------------------

    Fix Version: 0.2

> Namenode does not always clean up pendingCreates
> ------------------------------------------------
>
>          Key: HADOOP-118
>          URL: http://issues.apache.org/jira/browse/HADOOP-118
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>  Environment: 195 node cluster running redhat linux (2.6 kernel)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2

>
> In some failure modes, the pending creates list is not cleaned up and prevents that file from ever being created.
> When I try to create the file after the first job was killed (hours previously), I get:
> 060404 084619 Cannot start file because pendingCreates is non-null. src=/user/oom/rand/part000118
> 060404 084619 Server handler 0 on 8020 call error: java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
> java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
>         at org.apache.hadoop.dfs.NameNode.create(NameNode.java:147)
>         at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 01:39:00 2006
Return-Path: 
 <hadoop-dev-return-726-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31872 invoked from network); 7 Apr 2006 01:39:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 01:39:00 -0000
Received: (qmail 91832 invoked by uid 500); 7 Apr 2006 01:39:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91814 invoked by uid 500); 7 Apr 2006 01:38:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91805 invoked by uid 99); 7 Apr 2006 01:38:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 18:38:59 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 18:38:59 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 1F2EDD49FE
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 02:38:38 +0100 (BST)
Message-ID: <575448725.1144373918032.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 02:38:38 +0100 (BST)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-48) add user data to task reports
In-Reply-To: <642884722.1140560655919.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-48?page=comments#action_12373563 ] 

paul sutter commented on HADOOP-48:
-----------------------------------

+1 that

> add user data to task reports
> -----------------------------
>
>          Key: HADOOP-48
>          URL: http://issues.apache.org/jira/browse/HADOOP-48
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>      Fix For: 0.2

>
> The Reporter interface should permit tasks to set user-data for a task, either as a String or, better-yet, as a Writable.  This should be returned with each TaskReport.  This would facilitate programmatic instrumentation of tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 01:43:55 2006
Return-Path: 
 <hadoop-dev-return-727-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33103 invoked from network); 7 Apr 2006 01:43:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 01:43:55 -0000
Received: (qmail 93771 invoked by uid 500); 7 Apr 2006 01:43:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93749 invoked by uid 500); 7 Apr 2006 01:43:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93726 invoked by uid 99); 7 Apr 2006 01:43:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 18:43:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 18:43:53 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0E975D49FE
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 02:43:33 +0100 (BST)
Message-ID: <2004626612.1144374213056.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 02:43:33 +0100 (BST)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-47) include records/second and
 bytes/second in  task reports
In-Reply-To: <579254540.1140560374384.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-47?page=comments#action_12373564 ] 

paul sutter commented on HADOOP-47:
-----------------------------------

+1 that

you might consider implementing this as a generic counter-object class that can be used by any job to create custom counters like dingbats per second or peak fidderwinks.

> include records/second and bytes/second in  task reports
> --------------------------------------------------------
>
>          Key: HADOOP-47
>          URL: http://issues.apache.org/jira/browse/HADOOP-47
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.2

>
> TaskReport should include fields for total records processed, total bytes processed and total seconds of task execution.  These should also be reported in the web ui, as bytes/second and records/second.  The job display could sum these to report total bytes/second and records/second for map and reduce.  Better yet would be a graph displaying the total rates over the course of the job...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 01:47:54 2006
Return-Path: 
 <hadoop-dev-return-728-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35338 invoked from network); 7 Apr 2006 01:47:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 01:47:54 -0000
Received: (qmail 99616 invoked by uid 500); 7 Apr 2006 01:47:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99596 invoked by uid 500); 7 Apr 2006 01:47:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99587 invoked by uid 99); 7 Apr 2006 01:47:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 18:47:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Apr 2006 18:47:53 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BC0CF6ACA9
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 02:47:32 +0100 (BST)
Message-ID: <1487961139.1144374452762.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 02:47:32 +0100 (BST)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-51) per-file replication counts
In-Reply-To: <1529480135.1140561049677.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-51?page=comments#action_12373565 ] 

paul sutter commented on HADOOP-51:
-----------------------------------

+1 that

it might be easier to use on a per-directory basis, examples:

- /tmp directory, replication count 2 (or 1!), a good place for the output of intermediate reduce steps
- /cached directory, infinite replicaton count, a good place for lookup files used in mappers or reducers


> per-file replication counts
> ---------------------------
>
>          Key: HADOOP-51
>          URL: http://issues.apache.org/jira/browse/HADOOP-51
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2

>
> It should be possible to specify different replication counts for different files.  Perhaps an option when creating a new file should be the desired replication count.  MapReduce should take advantage of this feature so that job.xml and job.jar files, which are frequently accessed by lots of machines, are more highly replicated than large data files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 16:25:48 2006
Return-Path: 
 <hadoop-dev-return-729-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11693 invoked from network); 7 Apr 2006 16:25:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 16:25:48 -0000
Received: (qmail 31642 invoked by uid 500); 7 Apr 2006 16:25:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31618 invoked by uid 500); 7 Apr 2006 16:25:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31608 invoked by uid 99); 7 Apr 2006 16:25:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 09:25:46 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 09:25:46 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4FC216ACAB
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 17:25:25 +0100 (BST)
Message-ID: <1182353804.1144427125324.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 17:25:25 +0100 (BST)
From: "Teppo Kurki (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-115?page=all ]

Teppo Kurki updated HADOOP-115:
-------------------------------

    Attachment: hadoop-115_tk.patch

(1) adds JobConf.set/getMapKey/ValueClass
(2) changes in ReduceTask so that the Map phase classes are used in append & sort
(3) explicit key and value class specification in OutputFormat.getRecordWriter so that they are not automatically pulled out of JobConf

Tests run ok, but I haven't added tests for different Map/Reduce key/value classes.

Owen's suggestion on automatically typing the OutputFormat when the first record is written would cause changes in fewer classes, but I had this already working...



> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Runping Qi
>  Attachments: hadoop-115_tk.patch
>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 17:20:57 2006
Return-Path: 
 <hadoop-dev-return-730-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44684 invoked from network); 7 Apr 2006 17:20:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 17:20:57 -0000
Received: (qmail 11336 invoked by uid 500); 7 Apr 2006 17:20:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11289 invoked by uid 500); 7 Apr 2006 17:20:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11230 invoked by uid 99); 7 Apr 2006 17:20:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 10:20:47 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 10:20:46 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7B973D4A00
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 18:20:25 +0100 (BST)
Message-ID: <869462880.1144430425503.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 18:20:25 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-117) mapred temporary files not deleted
In-Reply-To: <98493585.1144126064699.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-117?page=all ]

Doug Cutting updated HADOOP-117:
--------------------------------

      Summary: mapred temporary files not deleted  (was: map red /tmp/hadoop/mapred/)
    Component: mapred
    Assign To: Doug Cutting
     Priority: Blocker  (was: Critical)

> mapred temporary files not deleted
> ----------------------------------
>
>          Key: HADOOP-117
>          URL: http://issues.apache.org/jira/browse/HADOOP-117
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>  Environment: windows with cygwin
>     Reporter: raghavendra prabhu
>     Assignee: Doug Cutting
>     Priority: Blocker
>      Fix For: 0.2, 0.1.1
>  Attachments: JobConf.patch
>
> I found out that JobConf.java
> Created interchanged names with parent being file and file being parent directory
> As a result files were not getting deleted

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 17:46:52 2006
Return-Path: 
 <hadoop-dev-return-731-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63467 invoked from network); 7 Apr 2006 17:46:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 17:46:52 -0000
Received: (qmail 71692 invoked by uid 500); 7 Apr 2006 17:46:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71637 invoked by uid 500); 7 Apr 2006 17:46:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71600 invoked by uid 99); 7 Apr 2006 17:46:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 10:46:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 10:46:44 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A71176ACA9
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 18:46:23 +0100 (BST)
Message-ID: <464550433.1144431983681.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 18:46:23 +0100 (BST)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-124) Files still rotting in DFS of latest
 Hadoop
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Files still rotting in DFS of latest Hadoop
-------------------------------------------

         Key: HADOOP-124
         URL: http://issues.apache.org/jira/browse/HADOOP-124
     Project: Hadoop
        Type: Bug

  Components: dfs  
 Environment: ~30 node cluster
    Reporter: Bryan Pendleton


DFS files are still rotting.

I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.

I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 17:56:50 2006
Return-Path: 
 <hadoop-dev-return-732-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70647 invoked from network); 7 Apr 2006 17:56:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 17:56:50 -0000
Received: (qmail 97602 invoked by uid 500); 7 Apr 2006 17:56:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97498 invoked by uid 500); 7 Apr 2006 17:56:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97489 invoked by uid 99); 7 Apr 2006 17:56:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 10:56:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 10:56:47 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D5EE56ACA9
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 18:56:25 +0100 (BST)
Message-ID: <452285358.1144432585873.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 18:56:25 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) Files still rotting in DFS of latest
 Hadoop
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12373671 ] 

Doug Cutting commented on HADOOP-124:
-------------------------------------

Did you potentially start identically configured datanodes as a different user?

Right now the only "lock" preventing this is the pid file used by the nutch-daemon.sh script.  Perhaps the datanode should lock each directory in dfs.data.dir?  That should prevent this, no?

I suppose this could also happen if the datanode lost its connection to the namenode, but the namenode had not yet timed out the datanode.  Then the datanode would reconnect and blocks might be doubly-reported.  To fix this, perhaps the namenode should refuse to represent more than one copy of a block from a given IP?  If a second is reported, the first should be forgotten?



> Files still rotting in DFS of latest Hadoop
> -------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 18:21:47 2006
Return-Path: 
 <hadoop-dev-return-733-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84126 invoked from network); 7 Apr 2006 18:21:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 18:21:47 -0000
Received: (qmail 67472 invoked by uid 500); 7 Apr 2006 18:21:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67372 invoked by uid 500); 7 Apr 2006 18:21:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67362 invoked by uid 99); 7 Apr 2006 18:21:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 11:21:46 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 11:21:46 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 69DBED4A00
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 19:21:25 +0100 (BST)
Message-ID: <812255065.1144434085430.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 19:21:25 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) Files still rotting in DFS of latest
 Hadoop
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12373675 ] 

Owen O'Malley commented on HADOOP-124:
--------------------------------------

It seems like it would help to have the datanode generate a unique identifier the first time it is run, and save that in the data directory. On datanode restarts it uses the unique identifier from the data directory. The namenode would be able to complain about multiple instance of the same datanode.

> Files still rotting in DFS of latest Hadoop
> -------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 18:26:51 2006
Return-Path: 
 <hadoop-dev-return-734-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88368 invoked from network); 7 Apr 2006 18:26:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 18:26:51 -0000
Received: (qmail 78857 invoked by uid 500); 7 Apr 2006 18:26:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78815 invoked by uid 500); 7 Apr 2006 18:26:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78780 invoked by uid 99); 7 Apr 2006 18:26:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 11:26:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 11:26:45 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 403076ACA9
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 19:26:24 +0100 (BST)
Message-ID: <1543993904.1144434384259.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 19:26:24 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-116) cleaning up /tmp/hadoop/mapred/system
In-Reply-To: <1251503110.1144124084390.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-116?page=all ]
     
Doug Cutting resolved HADOOP-116:
---------------------------------

    Fix Version: 0.1.1
                 0.2
     Resolution: Fixed

Fixed in svn revision 392353.

> cleaning up /tmp/hadoop/mapred/system
> -------------------------------------
>
>          Key: HADOOP-116
>          URL: http://issues.apache.org/jira/browse/HADOOP-116
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>  Environment: Windows with Cygwin
>     Reporter: raghavendra prabhu
>     Assignee: Doug Cutting
>      Fix For: 0.1.1, 0.2
>  Attachments: jobclient.patch
>
> Clean up directories
> submit_ which contain job.xml and job.jar files as and when the job is finished

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 18:30:46 2006
Return-Path: 
 <hadoop-dev-return-735-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90986 invoked from network); 7 Apr 2006 18:30:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 18:30:46 -0000
Received: (qmail 96664 invoked by uid 500); 7 Apr 2006 18:30:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96645 invoked by uid 500); 7 Apr 2006 18:30:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96635 invoked by uid 99); 7 Apr 2006 18:30:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 11:30:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 11:30:45 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 41D166ACA9
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 19:30:24 +0100 (BST)
Message-ID: <1448416068.1144434624266.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 19:30:24 +0100 (BST)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) Files still rotting in DFS of latest
 Hadoop
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12373677 ] 

Bryan Pendleton commented on HADOOP-124:
----------------------------------------

I have certainly seen some weirdness with my cluster where a stop-all seemed to think it had succeeded but there were still datanode and tasktracker instances running. Locking at the directory level seems like a good hedge against that sort of problem. As a bonus - it'll prevent blocks from getting removed if someone mistakenly starts up a second set of datanodes against a different namenode, as long as the datanode daemon for the competing DFS instance is running on the machine.

Keeping track of only one copy of a block for a given IP seems like a good start, but might be too simple. What if, by some unfortunate process, a lot of duplicates get stored on a node. If there's no way to detect this, it could be that a bunch of copies of a block end up being duplicated on a node unnecessarily. One way out of that would be to notice if a host is reporting more than one copy of a block, and kick off a knee-jerk fix: 1) Extra-replicate the block 2) Ask the node with dups to remove its copies of the block. Of course, in the case where two datanode instances are somehow servicing from the same directory, the knee-jerk reaction would kick off for all blocks that get stored into that space - so locking would definitely be necessary to make this work.

> Files still rotting in DFS of latest Hadoop
> -------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 22:45:46 2006
Return-Path: 
 <hadoop-dev-return-736-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36994 invoked from network); 7 Apr 2006 22:45:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 22:45:46 -0000
Received: (qmail 63819 invoked by uid 500); 7 Apr 2006 22:45:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63713 invoked by uid 500); 7 Apr 2006 22:45:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63704 invoked by uid 99); 7 Apr 2006 22:45:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 15:45:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 15:45:44 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C5B046ACA9
	for <hadoop-dev@lucene.apache.org>; Fri,  7 Apr 2006 23:45:23 +0100 (BST)
Message-ID: <964737569.1144449923807.JavaMail.jira@ajax>
Date: Fri, 7 Apr 2006 23:45:23 +0100 (BST)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-125) LocalFileSystem.makeAbsolute bug on
 Windows
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

LocalFileSystem.makeAbsolute bug on Windows
-------------------------------------------

         Key: HADOOP-125
         URL: http://issues.apache.org/jira/browse/HADOOP-125
     Project: Hadoop
        Type: Bug

  Components: fs  
 Environment: Windows
    Reporter: paul sutter
    Priority: Minor



LocalFileSystem.makeAbsolute() has a bug when running on Windows (which is very useful for the development phase of a Hadoop task on one's laptop).

Problem:  if a pathname such as /tmp/hadoop... is given in a config file, when the jobconf file is created, it is put into the relative directory named: currentdir/tmp/hadoop..., but when hadoop tries to open the file, it looks in c:/tmp/hadoop..., and the job fails.

Cause: while Unix has two kinds of filespecs (relative and absolute), WIndows actually has three:

(1) relative to current directory (subdir/file)
(2) relative to current disk (/dir/subdir/file)
(3) absolute (c:/dir/subdir/file)

So when a config file specifies a directory with what-is-on-unix an absolute path (/tmp/hadoop...), the makeAbsolute() method will not work correctly. Basically, File.isAbsolute() will return false for cases (1) and (2) above, but true for case (3), which is not expected by the code below. 

The solution would be to code explicit detection of all three casses for Windows in the code below from LocalFileSystem:

    private File makeAbsolute(File f) {
      if (f.isAbsolute()) {
        return f;
      } else {
        return new File(workingDir, f.toString());
      }
    }

Im happy to explain if this explanation is confusing... 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 23:27:49 2006
Return-Path: 
 <hadoop-dev-return-737-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59217 invoked from network); 7 Apr 2006 23:27:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 23:27:49 -0000
Received: (qmail 12905 invoked by uid 500); 7 Apr 2006 23:27:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12889 invoked by uid 500); 7 Apr 2006 23:27:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12879 invoked by uid 99); 7 Apr 2006 23:27:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 16:27:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 16:27:48 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B90E9D49FE
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 00:27:27 +0100 (BST)
Message-ID: <694502513.1144452447755.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 00:27:27 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-125) LocalFileSystem.makeAbsolute bug on
 Windows
In-Reply-To: <964737569.1144449923807.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-125?page=all ]
     
Doug Cutting resolved HADOOP-125:
---------------------------------

    Fix Version: 0.1.1
                 0.2
     Resolution: Fixed
      Assign To: Doug Cutting

I just fixed this.

> LocalFileSystem.makeAbsolute bug on Windows
> -------------------------------------------
>
>          Key: HADOOP-125
>          URL: http://issues.apache.org/jira/browse/HADOOP-125
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>  Environment: Windows
>     Reporter: paul sutter
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.1, 0.2

>
> LocalFileSystem.makeAbsolute() has a bug when running on Windows (which is very useful for the development phase of a Hadoop task on one's laptop).
> Problem:  if a pathname such as /tmp/hadoop... is given in a config file, when the jobconf file is created, it is put into the relative directory named: currentdir/tmp/hadoop..., but when hadoop tries to open the file, it looks in c:/tmp/hadoop..., and the job fails.
> Cause: while Unix has two kinds of filespecs (relative and absolute), WIndows actually has three:
> (1) relative to current directory (subdir/file)
> (2) relative to current disk (/dir/subdir/file)
> (3) absolute (c:/dir/subdir/file)
> So when a config file specifies a directory with what-is-on-unix an absolute path (/tmp/hadoop...), the makeAbsolute() method will not work correctly. Basically, File.isAbsolute() will return false for cases (1) and (2) above, but true for case (3), which is not expected by the code below. 
> The solution would be to code explicit detection of all three casses for Windows in the code below from LocalFileSystem:
>     private File makeAbsolute(File f) {
>       if (f.isAbsolute()) {
>         return f;
>       } else {
>         return new File(workingDir, f.toString());
>       }
>     }
> Im happy to explain if this explanation is confusing... 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr  7 23:29:47 2006
Return-Path: 
 <hadoop-dev-return-738-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60405 invoked from network); 7 Apr 2006 23:29:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Apr 2006 23:29:47 -0000
Received: (qmail 15130 invoked by uid 500); 7 Apr 2006 23:29:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15109 invoked by uid 500); 7 Apr 2006 23:29:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15100 invoked by uid 99); 7 Apr 2006 23:29:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 16:29:46 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 16:29:46 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 43A9BD4A00
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 00:29:25 +0100 (BST)
Message-ID: <811438533.1144452565273.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 00:29:25 +0100 (BST)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-51) per-file replication counts
In-Reply-To: <1529480135.1140561049677.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-51?page=all ]

Konstantin Shvachko updated HADOOP-51:
--------------------------------------

    Attachment: Replication.patch

Here is rather big patch. The changes are.

- Create methods include new parameter "short replication"
- If replication is not specified the default replication is used.
- The namenode stores and maintains replication for each file separately.
- File replication can be obtained from the namenode as a part of DFSFileInfo.
- 2 new namenode config parameters
   dfs.replication.max
   dfs.replication.min
which are checked when a new file is created.
- Namenode image and edit log file format are modified. Both contain version
number at the beginning now. The versions are negative. I started from version -1.
When the namenode starts you should expect that your current dfs image will be
loaded and converted into new format. All old files will have the same default
replication equal to the value of dfs.replication of your config.



> per-file replication counts
> ---------------------------
>
>          Key: HADOOP-51
>          URL: http://issues.apache.org/jira/browse/HADOOP-51
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: Replication.patch
>
> It should be possible to specify different replication counts for different files.  Perhaps an option when creating a new file should be the desired replication count.  MapReduce should take advantage of this feature so that job.xml and job.jar files, which are frequently accessed by lots of machines, are more highly replicated than large data files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 00:01:14 2006
Return-Path: 
 <hadoop-dev-return-739-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70590 invoked from network); 8 Apr 2006 00:01:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 00:01:14 -0000
Received: (qmail 46333 invoked by uid 500); 8 Apr 2006 00:01:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46232 invoked by uid 500); 8 Apr 2006 00:01:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46223 invoked by uid 99); 8 Apr 2006 00:01:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:01:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:01:10 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 1C507D49FE
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 01:00:50 +0100 (BST)
Message-ID: <1936473781.1144454450113.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 01:00:50 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-116) cleaning up /tmp/hadoop/mapred/system
In-Reply-To: <1251503110.1144124084390.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-116?page=all ]
     
Doug Cutting closed HADOOP-116:
-------------------------------


> cleaning up /tmp/hadoop/mapred/system
> -------------------------------------
>
>          Key: HADOOP-116
>          URL: http://issues.apache.org/jira/browse/HADOOP-116
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>  Environment: Windows with Cygwin
>     Reporter: raghavendra prabhu
>     Assignee: Doug Cutting
>      Fix For: 0.1.1, 0.2
>  Attachments: jobclient.patch
>
> Clean up directories
> submit_ which contain job.xml and job.jar files as and when the job is finished

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 00:01:15 2006
Return-Path: 
 <hadoop-dev-return-740-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70610 invoked from network); 8 Apr 2006 00:01:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 00:01:15 -0000
Received: (qmail 46412 invoked by uid 500); 8 Apr 2006 00:01:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46345 invoked by uid 500); 8 Apr 2006 00:01:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46336 invoked by uid 99); 8 Apr 2006 00:01:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:01:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:01:12 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4D5EB6ACAD
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 01:00:51 +0100 (BST)
Message-ID: <923707550.1144454451313.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 01:00:51 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-117) mapred temporary files not deleted
In-Reply-To: <98493585.1144126064699.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-117?page=all ]
     
Doug Cutting closed HADOOP-117:
-------------------------------


> mapred temporary files not deleted
> ----------------------------------
>
>          Key: HADOOP-117
>          URL: http://issues.apache.org/jira/browse/HADOOP-117
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>  Environment: windows with cygwin
>     Reporter: raghavendra prabhu
>     Assignee: Doug Cutting
>     Priority: Blocker
>      Fix For: 0.2, 0.1.1
>  Attachments: JobConf.patch
>
> I found out that JobConf.java
> Created interchanged names with parent being file and file being parent directory
> As a result files were not getting deleted

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 00:01:16 2006
Return-Path: 
 <hadoop-dev-return-741-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70625 invoked from network); 8 Apr 2006 00:01:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 00:01:16 -0000
Received: (qmail 46491 invoked by uid 500); 8 Apr 2006 00:01:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46476 invoked by uid 500); 8 Apr 2006 00:01:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46467 invoked by uid 99); 8 Apr 2006 00:01:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:01:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:01:15 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B65B8D4A00
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 01:00:54 +0100 (BST)
Message-ID: <362099920.1144454454744.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 01:00:54 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-125) LocalFileSystem.makeAbsolute bug on
 Windows
In-Reply-To: <964737569.1144449923807.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-125?page=all ]
     
Doug Cutting closed HADOOP-125:
-------------------------------


> LocalFileSystem.makeAbsolute bug on Windows
> -------------------------------------------
>
>          Key: HADOOP-125
>          URL: http://issues.apache.org/jira/browse/HADOOP-125
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>  Environment: Windows
>     Reporter: paul sutter
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.1, 0.2

>
> LocalFileSystem.makeAbsolute() has a bug when running on Windows (which is very useful for the development phase of a Hadoop task on one's laptop).
> Problem:  if a pathname such as /tmp/hadoop... is given in a config file, when the jobconf file is created, it is put into the relative directory named: currentdir/tmp/hadoop..., but when hadoop tries to open the file, it looks in c:/tmp/hadoop..., and the job fails.
> Cause: while Unix has two kinds of filespecs (relative and absolute), WIndows actually has three:
> (1) relative to current directory (subdir/file)
> (2) relative to current disk (/dir/subdir/file)
> (3) absolute (c:/dir/subdir/file)
> So when a config file specifies a directory with what-is-on-unix an absolute path (/tmp/hadoop...), the makeAbsolute() method will not work correctly. Basically, File.isAbsolute() will return false for cases (1) and (2) above, but true for case (3), which is not expected by the code below. 
> The solution would be to code explicit detection of all three casses for Windows in the code below from LocalFileSystem:
>     private File makeAbsolute(File f) {
>       if (f.isAbsolute()) {
>         return f;
>       } else {
>         return new File(workingDir, f.toString());
>       }
>     }
> Im happy to explain if this explanation is confusing... 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 00:05:55 2006
Return-Path: 
 <hadoop-dev-return-742-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72159 invoked from network); 8 Apr 2006 00:05:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 00:05:55 -0000
Received: (qmail 48871 invoked by uid 500); 8 Apr 2006 00:05:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48850 invoked by uid 500); 8 Apr 2006 00:05:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48841 invoked by uid 99); 8 Apr 2006 00:05:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:05:55 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:05:54 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id AFC32D4A00
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 01:05:33 +0100 (BST)
Message-ID: <1435631528.1144454733717.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 01:05:33 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-112) copyFromLocal should exclude .crc files
In-Reply-To: <893191320.1143728846291.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-112?page=all ]
     
Doug Cutting closed HADOOP-112:
-------------------------------

    Resolution: Fixed

Given the lack of further comments, I will re-close this.  If there are other, related bugs, please report them as new bugs rather than re-opening this again.

> copyFromLocal should exclude .crc files
> ---------------------------------------
>
>          Key: HADOOP-112
>          URL: http://issues.apache.org/jira/browse/HADOOP-112
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: DFS cluster of 6 3hz Xeons with 2Gb RAM running Centos 4.2 and Sun's JDK1.5 - but Probably applies in any environment
>     Reporter: Monu Ogbe
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.0

>
> Doug Cutting says: "The problem is that when copyFromLocal 
> enumerates local files it should exclude .crc files, but it does not. 
> This is the listFiles() call on DistributedFileSystem:160.  It should 
> filter this, excluding files that are FileSystem.isChecksumFile().
> BTW, as a workaround, it is safe to first remove all of the .crc files, 
> but your files will no longer be checksummed as they are read.  On 
> systems without ECC memory file corruption is not uncommon, but I have 
> seen very little on clusters that have ECC."
> Original observations:
> Hello Team,
> I created a backup of my DFS database:
> # bin/hadoop dfs -copyToLocal /user/root/crawl /mylocaldir
> I now want to restore from the backup using:
> # bin/hadoop dfs -copyFromLocal /mylocaldir/crawl /user/root
> However I'm getting the following error:
> copyFromLocal: Target /user/root/crawl/crawldb/current/part-00000/.data.crc
> already exists
> I get this message with every permutation of the command that I've tried, and
> even after totally deleting all content in the DFS directories.
> I'd be grateful for any pointers.
> Many thanks,

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 00:05:58 2006
Return-Path: 
 <hadoop-dev-return-743-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72195 invoked from network); 8 Apr 2006 00:05:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 00:05:58 -0000
Received: (qmail 49073 invoked by uid 500); 8 Apr 2006 00:05:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48971 invoked by uid 500); 8 Apr 2006 00:05:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48962 invoked by uid 99); 8 Apr 2006 00:05:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:05:57 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:05:57 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 27CC2D4A03
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 01:05:36 +0100 (BST)
Message-ID: <163474305.1144454736160.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 01:05:36 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-111) JobClient.runJob() should return exit
 status for a job.
In-Reply-To: <3593804.1143715886185.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-111?page=all ]

Doug Cutting updated HADOOP-111:
--------------------------------

    Component: mapred

> JobClient.runJob() should return exit status for a job.
> -------------------------------------------------------
>
>          Key: HADOOP-111
>          URL: http://issues.apache.org/jira/browse/HADOOP-111
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Andrzej Bialecki 

>
> JobClient.runJob() doesn't return any values. Any information about the exit status of a job is discarded (or appears only in logs).
> It should be possible to return the exit status, so that JobClient users can determine whether a job was successfully completed or not. This is also important when using cmd-line tools in shell scripts - currently they don't return any exit codes, because it's not possible to determine the outcome of a job submitted through JobClient. As a consequence, it's difficult to automate repetitive jobs using shells scripts.
> It would be also nice to have an exit message in case of errors, for human consumption.
> I propose to implement one of the following:
> * change the return type of this method from void to int
> * or, better yet, to put the exit code and optional exit messages inside the JobConf instance under pre-defined keys.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 00:07:49 2006
Return-Path: 
 <hadoop-dev-return-744-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72881 invoked from network); 8 Apr 2006 00:07:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 00:07:49 -0000
Received: (qmail 50232 invoked by uid 500); 8 Apr 2006 00:07:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50210 invoked by uid 500); 8 Apr 2006 00:07:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50201 invoked by uid 99); 8 Apr 2006 00:07:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:07:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 17:07:47 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E0FCAD4A00
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 01:07:26 +0100 (BST)
Message-ID: <1991383205.1144454846919.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 01:07:26 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-114) Non-informative error message
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-114?page=all ]

Doug Cutting updated HADOOP-114:
--------------------------------

    Component: mapred
      Version: 0.2
                   (was: 0.1.0)
    Assign To: Doug Cutting

> Non-informative error message
> -----------------------------
>
>          Key: HADOOP-114
>          URL: http://issues.apache.org/jira/browse/HADOOP-114
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Rod Taylor
>     Assignee: Doug Cutting
>     Priority: Trivial
>  Attachments: nutch241-tasktracker-warning-correction.patch
>
> 060330 105006 mapred.child.heap.size is deprecated. Use mapred.child.heap.size instead. Meantime, interpolated child.heap.size into child.java.opt: -Xmx200m
> The instructions inform you to use the deprecated option.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 02:48:58 2006
Return-Path: 
 <hadoop-dev-return-745-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38814 invoked from network); 8 Apr 2006 02:48:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 02:48:58 -0000
Received: (qmail 46592 invoked by uid 500); 8 Apr 2006 02:48:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46480 invoked by uid 500); 8 Apr 2006 02:48:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46448 invoked by uid 99); 8 Apr 2006 02:48:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 19:48:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 19:48:51 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BC11FD49FE
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 03:48:30 +0100 (BST)
Message-ID: <1111450623.1144464510767.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 03:48:30 +0100 (BST)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-126) "hadoop dfs -cp" does not copy crc
 files
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

"hadoop dfs -cp" does not copy crc files
----------------------------------------

         Key: HADOOP-126
         URL: http://issues.apache.org/jira/browse/HADOOP-126
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Reporter: Konstantin Shvachko


DFSShell.copy() uses FileUtil.copyContents() which works with "Raw" files, and does not copy crc files.
Try
hadoop dfs -cp a b
Then either
hadoop dfs -cat b
hadoop dfs -copyToLocal b c
The last two complain about crc files
In fact DFSShell.copy() should use the same FileSystem methods as copyToLocal and copyFromLocal do.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 02:50:55 2006
Return-Path: 
 <hadoop-dev-return-746-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39261 invoked from network); 8 Apr 2006 02:50:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 02:50:55 -0000
Received: (qmail 49982 invoked by uid 500); 8 Apr 2006 02:50:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49965 invoked by uid 500); 8 Apr 2006 02:50:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49955 invoked by uid 99); 8 Apr 2006 02:50:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 19:50:55 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 19:50:54 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8F8F8D4A00
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 03:50:33 +0100 (BST)
Message-ID: <1834496112.1144464633585.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 03:50:33 +0100 (BST)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-126) "hadoop dfs -cp" does not copy crc
 files
In-Reply-To: <1111450623.1144464510767.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-126?page=all ]

Konstantin Shvachko updated HADOOP-126:
---------------------------------------

    Attachment: copy.patch

This fixes the problem.

> "hadoop dfs -cp" does not copy crc files
> ----------------------------------------
>
>          Key: HADOOP-126
>          URL: http://issues.apache.org/jira/browse/HADOOP-126
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Konstantin Shvachko
>  Attachments: copy.patch
>
> DFSShell.copy() uses FileUtil.copyContents() which works with "Raw" files, and does not copy crc files.
> Try
> hadoop dfs -cp a b
> Then either
> hadoop dfs -cat b
> hadoop dfs -copyToLocal b c
> The last two complain about crc files
> In fact DFSShell.copy() should use the same FileSystem methods as copyToLocal and copyFromLocal do.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 04:49:35 2006
Return-Path: 
 <hadoop-dev-return-747-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79297 invoked from network); 8 Apr 2006 04:49:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 04:49:35 -0000
Received: (qmail 29993 invoked by uid 500); 8 Apr 2006 04:49:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29978 invoked by uid 500); 8 Apr 2006 04:49:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29969 invoked by uid 99); 8 Apr 2006 04:49:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 21:49:34 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 21:49:33 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch1.xch.corp.yahoo.com
 [216.145.51.233])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k384n9IC061772
	for <hadoop-dev@lucene.apache.org>; Fri, 7 Apr 2006 21:49:09 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=FSSKTNqtpb90hngUGfNx8mrLxBUfe2OHK3cIqnZfKTB5YAujNf8d1tQFbxTzthVM
Received: from [10.0.1.2] ([10.72.76.252]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Fri, 7 Apr 2006 21:49:08 -0700
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <812255065.1144434085430.JavaMail.jira@ajax>
References: <812255065.1144434085430.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <096A864F-A91F-4C45-A034-384AF8BA5583@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-124) Files still rotting in DFS of
 latest Hadoop
Date: Fri, 7 Apr 2006 21:49:04 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 08 Apr 2006 04:49:09.0045 (UTC)
 FILETIME=[C5D12E50:01C65AC7]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

both seem like good ideas

On Apr 7, 2006, at 11:21 AM, Owen O'Malley (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-124? 
> page=comments#action_12373675 ]
>
> Owen O'Malley commented on HADOOP-124:
> --------------------------------------
>
> It seems like it would help to have the datanode generate a unique  
> identifier the first time it is run, and save that in the data  
> directory. On datanode restarts it uses the unique identifier from  
> the data directory. The namenode would be able to complain about  
> multiple instance of the same datanode.
>
>> Files still rotting in DFS of latest Hadoop
>> -------------------------------------------
>>
>>          Key: HADOOP-124
>>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>>      Project: Hadoop
>>         Type: Bug
>
>>   Components: dfs
>>  Environment: ~30 node cluster
>>     Reporter: Bryan Pendleton
>
>>
>> DFS files are still rotting.
>> I suspect that there's a problem with block accounting/detecting  
>> identical hosts in the namenode. I have 30 physical nodes, with  
>> various numbers of local disks, meaning that my current 'bin/ 
>> hadoop dfs -report" shows 80 nodes after a full restart. However,  
>> when I discovered the  problem (which resulted in losing about  
>> 500gb worth of temporary data because of missing blocks in some of  
>> the larger chunks) -report showed 96 nodes. I suspect somehow  
>> there were extra datanodes running against the same paths, and  
>> that the namenode was counting those as replicated instances,  
>> which then showed up over-replicated, and one of them was told to  
>> delete its local block, leading to the block actually getting lost.
>> I will debug it more the next time the situation arises. This is  
>> at least the 5th time I've had a large amount of file data "rot"  
>> in DFS since January.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Sat Apr  8 05:19:24 2006
Return-Path: 
 <hadoop-dev-return-748-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86606 invoked from network); 8 Apr 2006 05:19:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 05:19:24 -0000
Received: (qmail 42572 invoked by uid 500); 8 Apr 2006 05:19:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42470 invoked by uid 500); 8 Apr 2006 05:19:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42460 invoked by uid 99); 8 Apr 2006 05:19:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 22:19:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Apr 2006 22:19:23 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k385J9YC024457
	for <hadoop-dev@lucene.apache.org>; Sat, 8 Apr 2006 01:19:09 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k385Iuwl114410;
	Sat, 8 Apr 2006 01:18:59 -0400
Message-ID: <443747C0.1090200@apache.org>
Date: Fri, 07 Apr 2006 22:18:56 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: jira links to subversion
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

FYI, in case others have been as dense as I am, I just now figured out 
that Jira has had links to Subversion all along.  Simply click the "All" 
tab next to comments, and you'll see information about all commits that 
mention that bug.  So now putting bug numbers in commit messages is that 
much more useful!

Doug

From MAILER-DAEMON Sat Apr  8 07:11:07 2006
Return-Path: 
 <hadoop-dev-return-749-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19542 invoked from network); 8 Apr 2006 07:11:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 07:11:07 -0000
Received: (qmail 85788 invoked by uid 500); 8 Apr 2006 07:11:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85767 invoked by uid 500); 8 Apr 2006 07:11:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85758 invoked by uid 99); 8 Apr 2006 07:11:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Apr 2006 00:11:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Apr 2006 00:11:06 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4ED46D4A00
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 08:10:45 +0100 (BST)
Message-ID: <577106112.1144480245319.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 08:10:45 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-125) LocalFileSystem.makeAbsolute bug on
 Windows
In-Reply-To: <964737569.1144449923807.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-125?page=comments#action_12373713 ] 

Owen O'Malley commented on HADOOP-125:
--------------------------------------

Doug,
   Doesn't your fix break on unix if the user has a directory named "\\foo"? Certainly it would be a strange name, but it is legal. I was also curious why you took out setting the System property. It was convienent to be able to set the working directory on the local file system and be able to use File.getAbsolutePath(). Could we extend the FileSystem interface to add makeAbsolute?

> LocalFileSystem.makeAbsolute bug on Windows
> -------------------------------------------
>
>          Key: HADOOP-125
>          URL: http://issues.apache.org/jira/browse/HADOOP-125
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>  Environment: Windows
>     Reporter: paul sutter
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.1, 0.2

>
> LocalFileSystem.makeAbsolute() has a bug when running on Windows (which is very useful for the development phase of a Hadoop task on one's laptop).
> Problem:  if a pathname such as /tmp/hadoop... is given in a config file, when the jobconf file is created, it is put into the relative directory named: currentdir/tmp/hadoop..., but when hadoop tries to open the file, it looks in c:/tmp/hadoop..., and the job fails.
> Cause: while Unix has two kinds of filespecs (relative and absolute), WIndows actually has three:
> (1) relative to current directory (subdir/file)
> (2) relative to current disk (/dir/subdir/file)
> (3) absolute (c:/dir/subdir/file)
> So when a config file specifies a directory with what-is-on-unix an absolute path (/tmp/hadoop...), the makeAbsolute() method will not work correctly. Basically, File.isAbsolute() will return false for cases (1) and (2) above, but true for case (3), which is not expected by the code below. 
> The solution would be to code explicit detection of all three casses for Windows in the code below from LocalFileSystem:
>     private File makeAbsolute(File f) {
>       if (f.isAbsolute()) {
>         return f;
>       } else {
>         return new File(workingDir, f.toString());
>       }
>     }
> Im happy to explain if this explanation is confusing... 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 07:17:01 2006
Return-Path: 
 <hadoop-dev-return-750-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20865 invoked from network); 8 Apr 2006 07:17:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 07:17:01 -0000
Received: (qmail 87121 invoked by uid 500); 8 Apr 2006 07:17:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87100 invoked by uid 500); 8 Apr 2006 07:17:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87091 invoked by uid 99); 8 Apr 2006 07:17:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Apr 2006 00:17:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Apr 2006 00:17:00 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 797D1D4A00
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 08:16:39 +0100 (BST)
Message-ID: <1620493712.1144480599494.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 08:16:39 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12373714 ] 

Owen O'Malley commented on HADOOP-115:
--------------------------------------

Your patch adds {set,get}MapOutputComparatorClass(), which aren't needed, because the map outputs are the only ones that are compared. 

I don't think you are handling the combiners.

Did you need to change the interfaces to explicitly pass around the key/value types to the getRecordWriter()? Shouldn't getRecordWriter only be called for the reduce outputs?

> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Runping Qi
>  Attachments: hadoop-115_tk.patch
>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 19:16:36 2006
Return-Path: 
 <hadoop-dev-return-751-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24629 invoked from network); 8 Apr 2006 19:16:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 19:16:36 -0000
Received: (qmail 2140 invoked by uid 500); 8 Apr 2006 19:16:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2100 invoked by uid 500); 8 Apr 2006 19:16:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2090 invoked by uid 99); 8 Apr 2006 19:16:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Apr 2006 12:16:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Apr 2006 12:16:34 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4B75BD49FE
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 20:16:13 +0100 (BST)
Message-ID: <1913521136.1144523773306.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 20:16:13 +0100 (BST)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-51) per-file replication counts
In-Reply-To: <1529480135.1140561049677.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-51?page=comments#action_12373745 ] 

Bryan Pendleton commented on HADOOP-51:
---------------------------------------

Great!

A few comments from reading the patch (haven't test with it yet):
1) The <description> for dfs.replication.min is wrong
2) This is a wider concern, but on coding style - the idiom of conf.getType("config.value",defaultValue) is good for user-defined values, but shouldn't the default be skipped for things that are defined in hadoop-default.xml, in general? It takes away the value of hadoop-default, and it also means changing that value might or might not always have the desired system-wide results.
3) Wouldn't it be better to log at a severe level replications that are set below minReplication, or greater than maxReplication, and just set the replication to the nearest bound? Since replication is set per-file by the application, but min and max are probably set by the administrator of the hadoop cluster. Throwing an IOException causes failure where degraded performance would be preferable.
4) I may be dense, but I didn't see any way to specify that replication be "full", ie, a copy per datanode. I got the feeling this was something that was desired of this functionality (ie, for job.jar files, job configs, and lookup data used widely in a job) Using a short means, if we ever scale to > 32k nodes, there'd be no way to manually specify this. Just using Short.MAX_VALUE means getting a lot of errors about not being able to replicate as fully as desired.

Otherwise, this looks like a wonderful patch!

> per-file replication counts
> ---------------------------
>
>          Key: HADOOP-51
>          URL: http://issues.apache.org/jira/browse/HADOOP-51
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: Replication.patch
>
> It should be possible to specify different replication counts for different files.  Perhaps an option when creating a new file should be the desired replication count.  MapReduce should take advantage of this feature so that job.xml and job.jar files, which are frequently accessed by lots of machines, are more highly replicated than large data files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr  8 22:23:48 2006
Return-Path: 
 <hadoop-dev-return-752-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 92840 invoked from network); 8 Apr 2006 22:23:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Apr 2006 22:23:48 -0000
Received: (qmail 78967 invoked by uid 500); 8 Apr 2006 22:23:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78943 invoked by uid 500); 8 Apr 2006 22:23:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78933 invoked by uid 99); 8 Apr 2006 22:23:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Apr 2006 15:23:47 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Apr 2006 15:23:46 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id AAAE5D4A02
	for <hadoop-dev@lucene.apache.org>; Sat,  8 Apr 2006 23:23:25 +0100 (BST)
Message-ID: <1436063711.1144535005696.JavaMail.jira@ajax>
Date: Sat, 8 Apr 2006 23:23:25 +0100 (BST)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-113) Allow multiple Output Dirs to be
 specified for a job
In-Reply-To: <144372860.1143736586191.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-113?page=comments#action_12373749 ] 

paul sutter commented on HADOOP-113:
------------------------------------


Is the intention to have one mapper fork into multiple reducers, saving the file io of doing independent map passes?

mapper1 -> output a -> reducer 1
                 -> output b -> reducer 2 

instead of

mapper1 -> output a -> reducer 1
mapper 2 -> output b -> reducer 2

wherein the second example, the map input file is read twice instead of once?

that could be useful. i not sure how much it would really speed things up.

> Allow multiple Output Dirs to be specified for a job
> ----------------------------------------------------
>
>          Key: HADOOP-113
>          URL: http://issues.apache.org/jira/browse/HADOOP-113
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Rod Taylor
>  Attachments: hadoop_multisegment.patch
>
> Allow a single job to create multiple outputs. 2 additional simple functions only
> This allows for more complex branching of the process to occur either with multiple steps of the same type or allow different actions to take place on each output directory depending on the required actions.
> For my specific use, it allows me to run multiple Generate Outputs instead of a single Generate Output as submitted in NUTCH-171(http://issues.apache.org/jira/browse/NUTCH-171)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Apr  9 16:56:50 2006
Return-Path: 
 <hadoop-dev-return-753-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14367 invoked from network); 9 Apr 2006 16:56:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Apr 2006 16:56:50 -0000
Received: (qmail 21432 invoked by uid 500); 9 Apr 2006 16:56:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 21300 invoked by uid 500); 9 Apr 2006 16:56:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 21286 invoked by uid 99); 9 Apr 2006 16:56:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Apr 2006 09:56:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Apr 2006 09:56:47 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8CE5ED4A02
	for <hadoop-dev@lucene.apache.org>; Sun,  9 Apr 2006 17:56:26 +0100 (BST)
Message-ID: <1020217746.1144601786574.JavaMail.jira@ajax>
Date: Sun, 9 Apr 2006 17:56:26 +0100 (BST)
From: "Teppo Kurki (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12373780 ] 

Teppo Kurki commented on HADOOP-115:
------------------------------------

You're right about the getMapOutputComparatorClass and the needless interface change.

Automatic/deferred SequenceFile typing based on the first record doesn't seem feasible because SequenceFile.Writer.append(byte[]...) is used here and there.

I already had a second go at this with less changes, but I'll keep it to myself until I can put some unit tests together.

At least I'm learning about how things work under the hood.





> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Runping Qi
>  Attachments: hadoop-115_tk.patch
>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 02:56:22 2006
Return-Path: 
 <hadoop-dev-return-754-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1943 invoked from network); 10 Apr 2006 02:56:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 02:56:22 -0000
Received: (qmail 89973 invoked by uid 500); 10 Apr 2006 02:56:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89948 invoked by uid 500); 10 Apr 2006 02:56:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89939 invoked by uid 99); 10 Apr 2006 02:56:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Apr 2006 19:56:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Apr 2006 19:56:21 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2018BD4A00
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 03:56:00 +0100 (BST)
Message-ID: <973379996.1144637760128.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 03:56:00 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-51) per-file replication counts
In-Reply-To: <1529480135.1140561049677.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-51?page=comments#action_12373803 ] 

Doug Cutting commented on HADOOP-51:
------------------------------------

> the idiom of conf.getType("config.value",defaultValue) is good for user-defined values, but shouldn't the default be skipped for things that are defined in hadoop-default.xml, in general?

The value from hadoop-default.xml is used in preference to the defaultValue paramter.  The paramter is only used as a last resort when no value is found in hadoop-default.xml or any other config file.

> per-file replication counts
> ---------------------------
>
>          Key: HADOOP-51
>          URL: http://issues.apache.org/jira/browse/HADOOP-51
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: Replication.patch
>
> It should be possible to specify different replication counts for different files.  Perhaps an option when creating a new file should be the desired replication count.  MapReduce should take advantage of this feature so that job.xml and job.jar files, which are frequently accessed by lots of machines, are more highly replicated than large data files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 04:22:07 2006
Return-Path: 
 <hadoop-dev-return-755-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23991 invoked from network); 10 Apr 2006 04:22:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 04:22:07 -0000
Received: (qmail 31130 invoked by uid 500); 10 Apr 2006 04:21:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31111 invoked by uid 500); 10 Apr 2006 04:21:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31101 invoked by uid 99); 10 Apr 2006 04:21:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Apr 2006 21:21:57 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [137.78.160.215] (HELO nmta2.jpl.nasa.gov) (137.78.160.215)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Apr 2006 21:21:56 -0700
Received: from xmta1.jpl.nasa.gov (xmta1.jpl.nasa.gov [137.78.160.144])
	by nmta2.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3A4LYDD010938
	for <hadoop-dev@lucene.apache.org>; Sun, 9 Apr 2006 21:21:35 -0700
Received: from [192.168.1.101] (vpn-149-244-024.jpl.nasa.gov [128.149.244.24])
	by xmta1.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3A4LYxW032522
	for <hadoop-dev@lucene.apache.org>; Sun, 9 Apr 2006 21:21:34 -0700
User-Agent: Microsoft-Entourage/11.2.3.060209
Date: Sun, 09 Apr 2006 21:21:25 -0700
Subject: Problem starting hadoop
From: Chris Mattmann <chris.mattmann@jpl.nasa.gov>
To: "hadoop-dev@lucene.apache.org" <hadoop-dev@lucene.apache.org>
Message-ID: <C05F2B55.258A%chris.mattmann@jpl.nasa.gov>
Thread-Topic: Problem starting hadoop
Thread-Index: AcZcVjrLeZsAg8hJEdq+wwAUUSv9Jg==
Mime-version: 1.0
Content-type: text/plain;
	charset="US-ASCII"
Content-transfer-encoding: 7bit
X-Source-IP: vpn-149-244-024.jpl.nasa.gov [128.149.244.24]
X-Source-Sender: chris.mattmann@jpl.nasa.gov
X-AUTH: Internal IP
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Folks,

  I'm new to this list (but a familiar face on the Nutch one :-) ). I had a
newbie question. It seems that when I went to start Hadoop DFS using the
start-all.sh script in the bin directory, I note that for DFS it starts a
single namenode using hadoop-daemon.sh, then uses slaves.sh to start all the
slave datanodes. One thing I noticed is that on my linux cluster, the
additional options "-o ConnectTimeout=1 -o SendEnv=HADOOP_CONF_DIR" are not
available on my system. I tried typing "man ssh_config" and the closest
thing I see to ConnectTimeout is:


     ConnectionAttempts
             Specifies the number of tries (one per second) to make before
             exiting.  The argument must be an integer.  This may be useful
in scripts if the connection sometimes fails.  The default is 1.


Is this normal? Typing uname -a on my machine results in:

Linux <XXX> 2.4.21-37.XXX.ELsmp #1 SMP Tue Oct 18 11:43:19 PDT 2005 x86_64
x86_64 x86_64 GNU/Linux

When I remove those options from the slaves.sh script, the starting of
hadoop DFS succeeds (I commented out the part in start-all.sh that starts
MapReduce stuff, because I'm only trying to use DFS stuff).

Here is the output of ssh -V on my system:

[mattmann@XXX ~/hadoop]$ ssh -V
OpenSSH_3.6.1p2, SSH protocols 1.5/2.0, OpenSSL 0x0090701f

Any ideas? Additionally, would it make sense to put in options within the
startup script to only start DFS related daemons and slaves, and the same
goes for only starting MapRed daemons and slaves? If so, I can create a JIRA
issue about this.

Thanks!

Cheers,
  Chris



From MAILER-DAEMON Mon Apr 10 09:48:21 2006
Return-Path: 
 <hadoop-dev-return-756-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66355 invoked from network); 10 Apr 2006 09:48:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 09:48:21 -0000
Received: (qmail 22363 invoked by uid 500); 10 Apr 2006 09:48:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22261 invoked by uid 500); 10 Apr 2006 09:48:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22251 invoked by uid 99); 10 Apr 2006 09:48:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 02:48:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 02:48:19 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E2122D4A03
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 10:47:58 +0100 (BST)
Message-ID: <336798027.1144662478922.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 10:47:58 +0100 (BST)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-127) Unclear precedence of config files and
 property definitions
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Unclear precedence of config files and property definitions
-----------------------------------------------------------

         Key: HADOOP-127
         URL: http://issues.apache.org/jira/browse/HADOOP-127
     Project: Hadoop
        Type: Bug

  Components: conf  
 Environment: Hadoop 0.1.1, Nutch 0.8-dev
    Reporter: Andrzej Bialecki 


The order in which configuration resources are read is not sufficiently documented, and also there are no mechanisms preventing harmful re-definition of certain properties, if they are put in wrong config files.

>>From reading the code in Hadoop Configuration.java, JobConf.java and Nutch NutchConfiguration.java I _think_ this is what's happening.

There are two groups of resources: default resources, loaded first, and final resources, loaded at the end. All properties (re)-defined in files loaded later will override any previous definitions:

* default resources: loaded in the order as they are added. The following files are added here, in order:

    1. hadoop-default.xml (Configuration)
    2. nutch-default.xml  (NutchConfiguration)
    3. mapred-default.xml (JobConf)
    4. job_xx_xxx.xml       (JobConf, in JobConf(File config))

* final resource: which always come after default resources, i.e. if any value is defined here it will always override those set in default resources (NOTE: including per job settings!!!). The following files are added here, in reversed order:

    2. hadoop-site.xml (Configuration)
    1. nutch-site.xml    (NutchConfiguration)

(i.e. hadoop-site.xml will take precedence over anything else defined in any other config file).

I would appreciate checking that this is indeed the case, and suggestions how to ensure that you cannot so easily shoot yourself in the foot if you define wrong properties in hadoop-site or nutch-site ...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 15:41:20 2006
Return-Path: 
 <hadoop-dev-return-757-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71307 invoked from network); 10 Apr 2006 15:41:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 15:41:20 -0000
Received: (qmail 943 invoked by uid 500); 10 Apr 2006 15:41:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 916 invoked by uid 500); 10 Apr 2006 15:41:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 900 invoked by uid 99); 10 Apr 2006 15:41:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 08:41:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 08:41:13 -0700
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k3AETeZ07612;
	Mon, 10 Apr 2006 07:29:40 -0700
Message-ID: <443A7C9A.8080407@archive.org>
Date: Mon, 10 Apr 2006 08:41:14 -0700
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Problem starting hadoop
References: <C05F2B55.258A%chris.mattmann@jpl.nasa.gov>
In-Reply-To: <C05F2B55.258A%chris.mattmann@jpl.nasa.gov>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Chris Mattmann wrote:
> Hi Folks,
>
>   I'm new to this list (but a familiar face on the Nutch one :-) ). I had a
> newbie question. It seems that when I went to start Hadoop DFS using the
> start-all.sh script in the bin directory, I note that for DFS it starts a
> single namenode using hadoop-daemon.sh, then uses slaves.sh to start all the
> slave datanodes. One thing I noticed is that on my linux cluster, the
> additional options "-o ConnectTimeout=1 -o SendEnv=HADOOP_CONF_DIR" are not
> available on my system. I tried typing "man ssh_config" and the closest
> thing I see to ConnectTimeout is:
>
>
>      ConnectionAttempts
>              Specifies the number of tries (one per second) to make before
>              exiting.  The argument must be an integer.  This may be useful
> in scripts if the connection sometimes fails.  The default is 1.
>
>
> Is this normal? Typing uname -a on my machine results in:
>
> Linux <XXX> 2.4.21-37.XXX.ELsmp #1 SMP Tue Oct 18 11:43:19 PDT 2005 x86_64
> x86_64 x86_64 GNU/Linux
>
> When I remove those options from the slaves.sh script, the starting of
> hadoop DFS succeeds (I commented out the part in start-all.sh that starts
> MapReduce stuff, because I'm only trying to use DFS stuff).
>
> Here is the output of ssh -V on my system:
>
> [mattmann@XXX ~/hadoop]$ ssh -V
> OpenSSH_3.6.1p2, SSH protocols 1.5/2.0, OpenSSL 0x0090701f
>   

Yeah. On older ssh, neither option is available. "OpenSSH_3.5p1n, SSH 
protocols 1.5/2.0, OpenSSL 0x0090609f" doesn't have either option whereas
OpenSSH_4.2p1 Debian-6, OpenSSL 0.9.8a 11 Oct 2005" does. Looking over 
release notes, I note that SendEnv shows up in release 3.9. Doesn't seem 
to be a note on when ConnectTimeout was added (I didn't spend a long 
time looking).

Here's definitions from ssh_config man page:

ConnectTimeout
Specifies the timeout (in seconds) used when connecting to the
ssh server, instead of using the default system TCP timeout.
This value is used only when the target is down or really
unreachable, not when it refuses the connection.

...

SendEnv
Specifies what variables from the local environ(7) should be sent
to the server. Note that environment passing is only supported
for protocol 2, the server must also support it, and the server
must be configured to accept these environment variables. Refer
to AcceptEnv in sshd_config(5) for how to configure the server.
Variables are specified by name, which may contain the wildcard
characters ‘*’ and ‘?’. Multiple environment variables may be
separated by whitespace or spread across multiple SendEnv direc‐
tives. The default is not to send any environment variables.

If you've not noticed already, you can blank out ssh options in 
hadoop-env.sh by setting HADOOP_SSH_OPTS to the empty-string. All should 
work. You'll just not have a timeout on your ssh attempts and you won't 
be able to forward head node HADOOP_* environment variables out to slaves.

St.Ack


From MAILER-DAEMON Mon Apr 10 16:15:33 2006
Return-Path: 
 <hadoop-dev-return-758-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88811 invoked from network); 10 Apr 2006 16:15:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 16:15:33 -0000
Received: (qmail 58472 invoked by uid 500); 10 Apr 2006 16:15:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58368 invoked by uid 500); 10 Apr 2006 16:15:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58359 invoked by uid 99); 10 Apr 2006 16:15:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 09:15:32 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 09:15:30 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch1.xch.corp.yahoo.com
 [216.145.51.233])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3AGChIi083025
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 09:12:43 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=nl4wok/DRFJkTuj7lZ8ZaWTVh3woxlIhGkx3F+8ed8k4MXVOR5i8Cugc7nt3hCRr
Received: from [172.21.147.237] ([172.21.179.135]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 10 Apr 2006 09:12:43 -0700
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <1913521136.1144523773306.JavaMail.jira@ajax>
References: <1913521136.1144523773306.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <5A74BEF6-C2CD-4791-A16B-4BBE16CA48E7@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-51) per-file replication counts
Date: Mon, 10 Apr 2006 08:45:00 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 10 Apr 2006 16:12:43.0510 (UTC)
 FILETIME=[992B6160:01C65CB9]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

"Full" replication is a good idea, but I suggest we file it as a new  
bug/enhancement.

Actually placing a copy of a file on every node is probably rarely  
the right thing to do for "full" replication.  One copy per switch  
would be my preferred default on our clusters (gigabit switches) and  
for .JAR files squareroot(numNodes) is probably the right answer.

e14

On Apr 8, 2006, at 12:16 PM, Bryan Pendleton (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-51? 
> page=comments#action_12373745 ]
>
> Bryan Pendleton commented on HADOOP-51:
> ---------------------------------------
>
> Great!
>
> A few comments from reading the patch (haven't test with it yet):
> 1) The <description> for dfs.replication.min is wrong
> 2) This is a wider concern, but on coding style - the idiom of  
> conf.getType("config.value",defaultValue) is good for user-defined  
> values, but shouldn't the default be skipped for things that are  
> defined in hadoop-default.xml, in general? It takes away the value  
> of hadoop-default, and it also means changing that value might or  
> might not always have the desired system-wide results.
> 3) Wouldn't it be better to log at a severe level replications that  
> are set below minReplication, or greater than maxReplication, and  
> just set the replication to the nearest bound? Since replication is  
> set per-file by the application, but min and max are probably set  
> by the administrator of the hadoop cluster. Throwing an IOException  
> causes failure where degraded performance would be preferable.
> 4) I may be dense, but I didn't see any way to specify that  
> replication be "full", ie, a copy per datanode. I got the feeling  
> this was something that was desired of this functionality (ie, for  
> job.jar files, job configs, and lookup data used widely in a job)  
> Using a short means, if we ever scale to > 32k nodes, there'd be no  
> way to manually specify this. Just using Short.MAX_VALUE means  
> getting a lot of errors about not being able to replicate as fully  
> as desired.
>
> Otherwise, this looks like a wonderful patch!
>
>> per-file replication counts
>> ---------------------------
>>
>>          Key: HADOOP-51
>>          URL: http://issues.apache.org/jira/browse/HADOOP-51
>>      Project: Hadoop
>>         Type: New Feature
>
>>   Components: dfs
>>     Versions: 0.2
>>     Reporter: Doug Cutting
>>     Assignee: Konstantin Shvachko
>>      Fix For: 0.2
>>  Attachments: Replication.patch
>>
>> It should be possible to specify different replication counts for  
>> different files.  Perhaps an option when creating a new file  
>> should be the desired replication count.  MapReduce should take  
>> advantage of this feature so that job.xml and job.jar files, which  
>> are frequently accessed by lots of machines, are more highly  
>> replicated than large data files.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Mon Apr 10 16:20:20 2006
Return-Path: 
 <hadoop-dev-return-759-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91066 invoked from network); 10 Apr 2006 16:20:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 16:20:20 -0000
Received: (qmail 65628 invoked by uid 500); 10 Apr 2006 16:20:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65612 invoked by uid 500); 10 Apr 2006 16:20:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65603 invoked by uid 99); 10 Apr 2006 16:20:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 09:20:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 09:20:19 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A94366ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 17:19:58 +0100 (BST)
Message-ID: <1165287600.1144685998691.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 17:19:58 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-128) Failure to replicate dfs block kills
 client
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Failure to replicate dfs block kills client
-------------------------------------------

         Key: HADOOP-128
         URL: http://issues.apache.org/jira/browse/HADOOP-128
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.1.1    
 Environment: ~200 node linux cluster (kernel 2.6, redhat, 2 hyper threaded cpus)
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


When the datanode gets an exception, which is logged as:

060407 155835 13 DataXCeiver
java.io.EOFException
        at java.io.DataInputStream.readFully(DataInputStream.java:178)
        at java.io.DataInputStream.readLong(DataInputStream.java:380)
        at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:462)
        at java.lang.Thread.run(Thread.java:595)

It closes the user's connection to the data node, which causes the client to get an IOException from:

        at java.io.DataInputStream.readFully(DataInputStream.java:178)
        at java.io.DataInputStream.readLong(DataInputStream.java:380)
        at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:883)
 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 17:19:44 2006
Return-Path: 
 <hadoop-dev-return-760-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23910 invoked from network); 10 Apr 2006 17:19:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 17:19:44 -0000
Received: (qmail 67533 invoked by uid 500); 10 Apr 2006 17:19:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67482 invoked by uid 500); 10 Apr 2006 17:19:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67463 invoked by uid 99); 10 Apr 2006 17:19:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 10:19:43 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 10:19:41 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3AHJRYC025383
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 13:19:28 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k3AHJ9OW141808;
	Mon, 10 Apr 2006 13:19:12 -0400
Message-ID: <443A938C.1010201@apache.org>
Date: Mon, 10 Apr 2006 10:19:08 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Problem starting hadoop
References: <C05F2B55.258A%chris.mattmann@jpl.nasa.gov>
In-Reply-To: <C05F2B55.258A%chris.mattmann@jpl.nasa.gov>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Chris Mattmann wrote:
> One thing I noticed is that on my linux cluster, the
> additional options "-o ConnectTimeout=1 -o SendEnv=HADOOP_CONF_DIR" are not
> available on my system.

You can override this by editing conf/hadoop-env.sh.  Both are optional, 
but convenient.  Perhaps we should avoid using them until they're in 
wider distribution.

> Here is the output of ssh -V on my system:
> 
> [mattmann@XXX ~/hadoop]$ ssh -V
> OpenSSH_3.6.1p2, SSH protocols 1.5/2.0, OpenSSL 0x0090701f

I run Ubuntu Breezy and have OpenSSH 4.1.  I don't know what version of 
OpenSSH these features were added in.

> Any ideas? Additionally, would it make sense to put in options within the
> startup script to only start DFS related daemons and slaves, and the same
> goes for only starting MapRed daemons and slaves? If so, I can create a JIRA
> issue about this.

Instead of 'bin/start-all.sh' that's just 'bin/hadoop-daemon.sh start 
namenode; bin/hadoop-daemons.sh start datanode'.  Is that what you're 
after?  I guess we could add a bin/start-dfs.sh command that does this.

Doug

From MAILER-DAEMON Mon Apr 10 18:13:44 2006
Return-Path: 
 <hadoop-dev-return-761-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52369 invoked from network); 10 Apr 2006 18:13:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 18:13:44 -0000
Received: (qmail 25743 invoked by uid 500); 10 Apr 2006 18:13:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 25641 invoked by uid 500); 10 Apr 2006 18:13:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 25616 invoked by uid 99); 10 Apr 2006 18:13:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 11:13:44 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [137.78.160.214] (HELO nmta1.jpl.nasa.gov) (137.78.160.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 11:13:43 -0700
Received: from xmta2.jpl.nasa.gov (xmta2.jpl.nasa.gov [137.78.160.56])
	by nmta1.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3AIDMJX014281
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 11:13:22 -0700
Received: from SPAWN (pc04079163145.jpl.nasa.gov [137.79.16.24])
	by xmta2.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3AIDM7t030993
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 11:13:22 -0700
Message-Id: <200604101813.k3AIDM7t030993@xmta2.jpl.nasa.gov>
Reply-To: <chris.mattmann@jpl.nasa.gov>
From: "Chris Mattmann" <chris.mattmann@jpl.nasa.gov>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: Problem starting hadoop
Date: Mon, 10 Apr 2006 11:13:22 -0700
Organization: Jet Propulsion Laboratory
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_NextPart_000_0056_01C65C8F.C7866430"
X-Mailer: Microsoft Office Outlook, Build 11.0.6353
Thread-Index: AcZcwvWRkLcD4HkGS+WCiwBoZ3lg0wABEi1Q
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2527
In-Reply-To: <443A938C.1010201@apache.org>
X-Source-IP: pc04079163145.jpl.nasa.gov [137.79.16.24]
X-Source-Sender: chris.mattmann@jpl.nasa.gov
X-AUTH: Internal IP
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_NextPart_000_0056_01C65C8F.C7866430
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit

Hi Doug,

> Chris Mattmann wrote:
> > One thing I noticed is that on my linux cluster, the
> > additional options "-o ConnectTimeout=1 -o SendEnv=HADOOP_CONF_DIR" are
> not
> > available on my system.
> 
> You can override this by editing conf/hadoop-env.sh.  Both are optional,
> but convenient.  Perhaps we should avoid using them until they're in
> wider distribution.

Yeah, I think it would be nice to find a workaround to explicitly using
these options. I'm running a 16 node/32 processor Linux cluster with 64-bit,
processors, with CentOS Linux installed, along with the ROCKS toolkit. I
think it's a pretty standard cluster distribution and it doesn't come with
an SSH that uses those options. I don't want my environment to dictate what
Hadoop should do for everyone else, but I think it's something to definitely
consider...

> > Any ideas? Additionally, would it make sense to put in options within
> the
> > startup script to only start DFS related daemons and slaves, and the
> same
> > goes for only starting MapRed daemons and slaves? If so, I can create a
> JIRA
> > issue about this.
> 
> Instead of 'bin/start-all.sh' that's just 'bin/hadoop-daemon.sh start
> namenode; bin/hadoop-daemons.sh start datanode'.  Is that what you're
> after?  I guess we could add a bin/start-dfs.sh command that does this.

Yeah, that's exactly what I'm after. Some, non-technical, joe-user way of
just starting up DFS and stopping DFS, not having anything to do with
MapReduce. I'm interested in Hadoop just for its DFS capabilities for now.
We're looking into HDFS within my group at JPL as a solution for our data
movement issue that will arise on our cluster when we begin to stage large
(gigabyte) sized files between an NFS mounted RAID disk and cluster nodes
that have jobs executing on them that need non-NFS access to the files
(having thousands of jobs reading from a single NFS mounted RAID can become
a bottleneck). So right now I'm benchmarking HDFS along with PVFS (parallel
virtual file system) as potential solutions to the data movement issue
between the cluster nodes and our NFS RAIDs. Anyways, getting back to the
point, yeah, it would be great to have something to just start and stop DFS,
and start and stop MapReduce for that matter, even if it just amounts to the
simple command you mentioned above. I've attached a quick patch for Hadoop
that implements it.

Thanks, Doug!

Cheers,
  Chris

> 
> Doug

------=_NextPart_000_0056_01C65C8F.C7866430
Content-Type: text/plain;
	name="HADOOP-dfs-mapred-startstop.patch.txt"
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename="HADOOP-dfs-mapred-startstop.patch.txt"

Index: bin/start-dfs.sh
===================================================================
--- bin/start-dfs.sh	(revision 0)
+++ bin/start-dfs.sh	(revision 0)
@@ -0,0 +1,14 @@
+#!/bin/bash
+
+# Start all hadoop daemons.  Run this on master node.
+
+bin=`dirname "$0"`
+bin=`cd "$bin"; pwd`
+
+# start dfs daemons
+# start namenode after datanodes, to minimize time namenode is up w/o data
+# note: datanodes will log connection errors until namenode starts
+
+"$bin"/hadoop-daemon.sh start namenode
+"$bin"/hadoop-daemons.sh start datanode
+

Property changes on: src/hadoop/bin/start-dfs.sh
___________________________________________________________________
Name: svn:executable
   + *

Index: bin/start-mapred.sh
===================================================================
--- bin/start-mapred.sh	(revision 0)
+++ bin/start-mapred.sh	(revision 0)
@@ -0,0 +1,13 @@
+#!/bin/bash
+
+# Start hadoop map reduce daemons.  Run this on master node.
+
+bin=`dirname "$0"`
+bin=`cd "$bin"; pwd`
+
+# start mapred daemons
+# start jobtracker first to minimize connection errors at startup
+
+"$bin"/hadoop-daemon.sh start jotracker
+"$bin"/hadoop-daemons.sh start tasktracker
+

Property changes on: bin/start-mapred.sh
___________________________________________________________________
Name: svn:executable
   + *

Index: bin/stop-dfs.sh
===================================================================
--- bin/stop-dfs.sh	(revision 0)
+++ bin/stop-dfs.sh	(revision 0)
@@ -0,0 +1,10 @@
+#!/bin/bash
+
+# Stop hadoop DFS daemons.  Run this on master node.
+
+bin=`dirname "$0"`
+bin=`cd "$bin"; pwd`
+
+"$bin"/hadoop-daemon.sh stop namenode
+"$bin"/hadoop-daemons.sh stop datanode
+

Property changes on: bin/stop-dfs.sh
___________________________________________________________________
Name: svn:executable
   + *

Index: bin/stop-mapred.sh
===================================================================
--- bin/stop-mapred.sh	(revision 0)
+++ bin/stop-mapred.sh	(revision 0)
@@ -0,0 +1,10 @@
+#!/bin/bash
+
+# Stop hadoop map reduce daemons.  Run this on master node.
+
+bin=`dirname "$0"`
+bin=`cd "$bin"; pwd`
+
+"$bin"/hadoop-daemon.sh stop jobtracker
+"$bin"/hadoop-daemons.sh stop tasktracker
+

Property changes on: bin/stop-mapred.sh
___________________________________________________________________
Name: svn:executable
   + *


------=_NextPart_000_0056_01C65C8F.C7866430--


From MAILER-DAEMON Mon Apr 10 18:36:45 2006
Return-Path: 
 <hadoop-dev-return-762-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64052 invoked from network); 10 Apr 2006 18:36:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 18:36:45 -0000
Received: (qmail 40069 invoked by uid 500); 10 Apr 2006 18:36:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40046 invoked by uid 500); 10 Apr 2006 18:36:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40037 invoked by uid 99); 10 Apr 2006 18:36:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 11:36:44 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of bpendleton@gmail.com designates
 64.233.184.235 as permitted sender)
Received: from [64.233.184.235] (HELO wproxy.gmail.com) (64.233.184.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 11:36:42 -0700
Received: by wproxy.gmail.com with SMTP id i20so855086wra
        for <hadoop-dev@lucene.apache.org>;
 Mon, 10 Apr 2006 11:36:21 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:references;
        b=DgCwxgHFuNwe1jfvbg5NHPwQrBRfzlZxSlB+CpXzO8giMz4Lv+gX3SliV9RGfILwJlQvwTDmixnC0PJ1zVNuXU9G6q0N7U596vmwxB1RvokMArhUPCxFcmYgX8k3PvGQ2akUZVnsLZmop9oktckMkf5iNqtJYMeyoPE5iGr1Nr8=
Received: by 10.65.196.7 with SMTP id y7mr4435101qbp;
        Mon, 10 Apr 2006 11:36:21 -0700 (PDT)
Received: by 10.65.224.8 with HTTP; Mon, 10 Apr 2006 11:36:21 -0700 (PDT)
Message-ID: <1bf79d3e0604101136y531f1cadl9e5d9b8e4e98ce43@mail.gmail.com>
Date: Mon, 10 Apr 2006 11:36:21 -0700
From: "Bryan A. Pendleton" <bp@geekdom.net>
Sender: bpendleton@gmail.com
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-51) per-file replication counts
In-Reply-To: <973379996.1144637760128.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_7503_345592.1144694181082"
References: <1529480135.1140561049677.JavaMail.jira@ajax.apache.org>
	 <973379996.1144637760128.JavaMail.jira@ajax>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_7503_345592.1144694181082
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
Content-Disposition: inline

SSByZWFsaXplIHRoYXQgdGhlIHZhbHVlIHdpbGwgY29tZSBmcm9tIGhhZG9vcC1kZWZhdWx0Lnht
bCB3aGVuIGl0J3Mgbm90CmRlZmluZWQgZWxzZXdoZXJlLiBJIGd1ZXNzIEkgd2FzIGp1c3Qgc3Vn
Z2VzdGluZyB0aGF0IGl0IG1ha2VzIHRoZSBjb2RlCmxlc3MtY2xlYXIgdG8gaGF2ZSBhbiBleHBs
aWNpdCBkZWZhdWx0IGluIGNhc2VzIHdoZXJlIHRoZSB2YWx1ZSAqd291bGQqIGJlCnByb3ZpZGVk
IGZyb20gYSAtZGVmYXVsdCBmaWxlLCBvciB0aGUgZXF1aXZhbGVudC4KCkhhdmluZyBzcGVudCBl
bm91Z2ggdGltZSByZWFkaW5nIG90aGVycycgY29kZSBvdmVyIHRoZSB5ZWFycywgZmlndXJpbmcg
b3V0Cip3aHkqIGEgdmFsdWUgZ2V0cyBzZXQsIGVzcGVjaWFsbHkgd2l0aCBhIGZhbmN5IGNvbmZp
Z3VyYXRpb24gZW52aXJvbm1lbnQKKHllcywgaGFkb29wJ3MgY29uZmlndXJhdGlvbiBpcyBkZWZp
bml0ZWx5IGluIHRoZSAiZmFuY3kiIHJlYWxtKSBieSB3YWxraW5nCnRoZSBjb2RlIGlzIGEgdHJp
Y2t5IG9wZXJhdGlvbi4gTXkgY29tbWVudCB3YXMgbWVyZWx5IHRoYXQgd2UgbWlnaHQgd2FudCB0
bwpoYXZlIGEgYmV0dGVyIHdheSBvZiBiZWluZyBleHBsaWNpdCB3aGVuIHRoaW5ncyBhcmUgcmVh
bGx5ICJzeXN0ZW0KZGVmYXVsdHMiLiBUaGUgaWRpb20gdXNlZCBtYWtlcyBwbGVudHkgb2Ygc2Vu
c2UgZm9yIHVzZXItY3JlYXRlZCBvcgpyYXJlbHktc2V0IHZhbHVlcyB3aGljaCBoYXZlIG5vIHNw
ZWNpZmljIGRlZmF1bHRzLiBKdXN0IG15ICQwLjAyLCB0aG91Z2gsCnBlcmhhcHMgbm8gb25lIGVs
c2UgYWdyZWVzLgoKT24gNC85LzA2LCBEb3VnIEN1dHRpbmcgKEpJUkEpIDxqaXJhQGFwYWNoZS5v
cmc+IHdyb3RlOgo+Cj4gICAgIFsKPiBodHRwOi8vaXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93
c2UvSEFET09QLTUxP3BhZ2U9Y29tbWVudHMjYWN0aW9uXzEyMzczODAzXQo+Cj4gRG91ZyBDdXR0
aW5nIGNvbW1lbnRlZCBvbiBIQURPT1AtNTE6Cj4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCj4KPiA+IHRoZSBpZGlvbSBvZiBjb25mLmdldFR5cGUoImNvbmZpZy52YWx1ZSIs
ZGVmYXVsdFZhbHVlKSBpcyBnb29kIGZvcgo+IHVzZXItZGVmaW5lZCB2YWx1ZXMsIGJ1dCBzaG91
bGRuJ3QgdGhlIGRlZmF1bHQgYmUgc2tpcHBlZCBmb3IgdGhpbmdzIHRoYXQKPiBhcmUgZGVmaW5l
ZCBpbiBoYWRvb3AtZGVmYXVsdC54bWwsIGluIGdlbmVyYWw/Cj4KPiBUaGUgdmFsdWUgZnJvbSBo
YWRvb3AtZGVmYXVsdC54bWwgaXMgdXNlZCBpbiBwcmVmZXJlbmNlIHRvIHRoZQo+IGRlZmF1bHRW
YWx1ZSBwYXJhbXRlci4gIFRoZSBwYXJhbXRlciBpcyBvbmx5IHVzZWQgYXMgYSBsYXN0IHJlc29y
dCB3aGVuIG5vCj4gdmFsdWUgaXMgZm91bmQgaW4gaGFkb29wLWRlZmF1bHQueG1sIG9yIGFueSBv
dGhlciBjb25maWcgZmlsZS4KPgo+ID4gcGVyLWZpbGUgcmVwbGljYXRpb24gY291bnRzCj4gPiAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KPiA+Cj4gPiAgICAgICAgICBLZXk6IEhBRE9PUC01
MQo+ID4gICAgICAgICAgVVJMOiBodHRwOi8vaXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2Uv
SEFET09QLTUxCj4gPiAgICAgIFByb2plY3Q6IEhhZG9vcAo+ID4gICAgICAgICBUeXBlOiBOZXcg
RmVhdHVyZQo+Cj4gPiAgIENvbXBvbmVudHM6IGRmcwo+ID4gICAgIFZlcnNpb25zOiAwLjIKPiA+
ICAgICBSZXBvcnRlcjogRG91ZyBDdXR0aW5nCj4gPiAgICAgQXNzaWduZWU6IEtvbnN0YW50aW4g
U2h2YWNoa28KPiA+ICAgICAgRml4IEZvcjogMC4yCj4gPiAgQXR0YWNobWVudHM6IFJlcGxpY2F0
aW9uLnBhdGNoCj4gPgo+ID4gSXQgc2hvdWxkIGJlIHBvc3NpYmxlIHRvIHNwZWNpZnkgZGlmZmVy
ZW50IHJlcGxpY2F0aW9uIGNvdW50cyBmb3IKPiBkaWZmZXJlbnQgZmlsZXMuICBQZXJoYXBzIGFu
IG9wdGlvbiB3aGVuIGNyZWF0aW5nIGEgbmV3IGZpbGUgc2hvdWxkIGJlIHRoZQo+IGRlc2lyZWQg
cmVwbGljYXRpb24gY291bnQuICBNYXBSZWR1Y2Ugc2hvdWxkIHRha2UgYWR2YW50YWdlIG9mIHRo
aXMgZmVhdHVyZQo+IHNvIHRoYXQgam9iLnhtbCBhbmQgam9iLmphciBmaWxlcywgd2hpY2ggYXJl
IGZyZXF1ZW50bHkgYWNjZXNzZWQgYnkgbG90cwo+IG9mIG1hY2hpbmVzLCBhcmUgbW9yZSBoaWdo
bHkgcmVwbGljYXRlZCB0aGFuIGxhcmdlIGRhdGEgZmlsZXMuCj4KPiAtLQo+IFRoaXMgbWVzc2Fn
ZSBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBieSBKSVJBLgo+IC0KPiBJZiB5b3UgdGhpbmsg
aXQgd2FzIHNlbnQgaW5jb3JyZWN0bHkgY29udGFjdCBvbmUgb2YgdGhlIGFkbWluaXN0cmF0b3Jz
Ogo+ICAgIGh0dHA6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL3NlY3VyZS9BZG1pbmlzdHJhdG9y
cy5qc3BhCj4gLQo+IEZvciBtb3JlIGluZm9ybWF0aW9uIG9uIEpJUkEsIHNlZToKPiAgICBodHRw
Oi8vd3d3LmF0bGFzc2lhbi5jb20vc29mdHdhcmUvamlyYQo+Cj4KCgotLQpCcnlhbiBBLiBQZW5k
bGV0b24KUGg6ICg4NzcpIGdlZWstMS1icAo=
------=_Part_7503_345592.1144694181082--

From MAILER-DAEMON Mon Apr 10 18:58:23 2006
Return-Path: 
 <hadoop-dev-return-763-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72309 invoked from network); 10 Apr 2006 18:58:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 18:58:23 -0000
Received: (qmail 69107 invoked by uid 500); 10 Apr 2006 18:58:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69087 invoked by uid 500); 10 Apr 2006 18:58:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69078 invoked by uid 99); 10 Apr 2006 18:58:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 11:58:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 11:58:21 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D1F98D4A02
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 19:58:00 +0100 (BST)
Message-ID: <1559190256.1144695480855.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 19:58:00 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-125) LocalFileSystem.makeAbsolute bug on
 Windows
In-Reply-To: <964737569.1144449923807.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-125?page=comments#action_12373917 ] 

Doug Cutting commented on HADOOP-125:
-------------------------------------

> Doesn't your fix break on unix if the user has a directory named "\\foo"?

Perhaps.  I did not test this case.  I was just despately trying to get Nutch to work correctly standalone & pseudo-distributed on Windows and linux.  There may still be bugs.

Changing the global system directory caused strange behaviour on Windows, and also seems like a bad idea.  Isn't the point of a default directory for job and fs instances to insulate them from the global system default directory?  We do currently cache the LocalFs instance, which may be a bug, but changing the process's CWD affects other applications in the JVM (like even our own datanode & namenode) which might not expect the CWD to move under them.

> Could we extend the FileSystem interface to add makeAbsolute?

The long-term fix that I'd like to see is that we stop using java.io.File for file names.  We could use String, we could use our own FileName class, or we could perhaps use java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().  I'll log a bug for this.

> LocalFileSystem.makeAbsolute bug on Windows
> -------------------------------------------
>
>          Key: HADOOP-125
>          URL: http://issues.apache.org/jira/browse/HADOOP-125
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>  Environment: Windows
>     Reporter: paul sutter
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.1, 0.2

>
> LocalFileSystem.makeAbsolute() has a bug when running on Windows (which is very useful for the development phase of a Hadoop task on one's laptop).
> Problem:  if a pathname such as /tmp/hadoop... is given in a config file, when the jobconf file is created, it is put into the relative directory named: currentdir/tmp/hadoop..., but when hadoop tries to open the file, it looks in c:/tmp/hadoop..., and the job fails.
> Cause: while Unix has two kinds of filespecs (relative and absolute), WIndows actually has three:
> (1) relative to current directory (subdir/file)
> (2) relative to current disk (/dir/subdir/file)
> (3) absolute (c:/dir/subdir/file)
> So when a config file specifies a directory with what-is-on-unix an absolute path (/tmp/hadoop...), the makeAbsolute() method will not work correctly. Basically, File.isAbsolute() will return false for cases (1) and (2) above, but true for case (3), which is not expected by the code below. 
> The solution would be to code explicit detection of all three casses for Windows in the code below from LocalFileSystem:
>     private File makeAbsolute(File f) {
>       if (f.isAbsolute()) {
>         return f;
>       } else {
>         return new File(workingDir, f.toString());
>       }
>     }
> Im happy to explain if this explanation is confusing... 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 19:06:21 2006
Return-Path: 
 <hadoop-dev-return-764-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76280 invoked from network); 10 Apr 2006 19:06:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 19:06:21 -0000
Received: (qmail 90901 invoked by uid 500); 10 Apr 2006 19:06:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90884 invoked by uid 500); 10 Apr 2006 19:06:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90875 invoked by uid 99); 10 Apr 2006 19:06:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 12:06:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 12:06:20 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E4618D49FF
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 20:05:59 +0100 (BST)
Message-ID: <2087016237.1144695959903.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 20:05:59 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-129) FileSystem should not name files with
 java.io.File
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

FileSystem should not name files with java.io.File
--------------------------------------------------

         Key: HADOOP-129
         URL: http://issues.apache.org/jira/browse/HADOOP-129
     Project: Hadoop
        Type: Improvement

  Components: fs  
    Versions: 0.1.1, 0.1.0    
    Reporter: Doug Cutting
     Fix For: 0.2


In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.

To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().

This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 19:16:55 2006
Return-Path: 
 <hadoop-dev-return-765-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81207 invoked from network); 10 Apr 2006 19:16:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 19:16:55 -0000
Received: (qmail 5485 invoked by uid 500); 10 Apr 2006 19:16:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5465 invoked by uid 500); 10 Apr 2006 19:16:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5455 invoked by uid 99); 10 Apr 2006 19:16:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 12:16:55 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 12:16:54 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CB182D4A02
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 20:16:33 +0100 (BST)
Message-ID: <441189587.1144696593829.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 20:16:33 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-126) "hadoop dfs -cp" does not copy crc
 files
In-Reply-To: <1111450623.1144464510767.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-126?page=all ]
     
Doug Cutting resolved HADOOP-126:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Konstantin Shvachko

I just committed this patch.  Thanks, Konstantin!

> "hadoop dfs -cp" does not copy crc files
> ----------------------------------------
>
>          Key: HADOOP-126
>          URL: http://issues.apache.org/jira/browse/HADOOP-126
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: copy.patch
>
> DFSShell.copy() uses FileUtil.copyContents() which works with "Raw" files, and does not copy crc files.
> Try
> hadoop dfs -cp a b
> Then either
> hadoop dfs -cat b
> hadoop dfs -copyToLocal b c
> The last two complain about crc files
> In fact DFSShell.copy() should use the same FileSystem methods as copyToLocal and copyFromLocal do.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 19:48:43 2006
Return-Path: 
 <hadoop-dev-return-766-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4455 invoked from network); 10 Apr 2006 19:48:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 19:48:43 -0000
Received: (qmail 51149 invoked by uid 500); 10 Apr 2006 19:48:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51037 invoked by uid 500); 10 Apr 2006 19:48:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51028 invoked by uid 99); 10 Apr 2006 19:48:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 12:48:42 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 12:48:42 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 37C77D4A02
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 20:48:21 +0100 (BST)
Message-ID: <1434975343.1144698501225.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 20:48:21 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-51) per-file replication counts
In-Reply-To: <1529480135.1140561049677.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-51?page=all ]
     
Doug Cutting resolved HADOOP-51:
--------------------------------

    Resolution: Fixed

I just committed this.  I fixed the comment on dfs.replication.min.  I also added a message to CHANGES.txt.

Thanks, Konstantin!

Bryan: I think the issues you raise bear further discussion that I do not wish to stifle.  For example, we may someday want  to be able to specify more than 2^16 replications, and we may wish to handle replication requests outside of the configured limits differently.  But, for now, I think the patch fixes this bug and that those issues can be addressed though subsequent bugs as we gain experience.  So please file new bugs for any related issues that are important to you.

> per-file replication counts
> ---------------------------
>
>          Key: HADOOP-51
>          URL: http://issues.apache.org/jira/browse/HADOOP-51
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: Replication.patch
>
> It should be possible to specify different replication counts for different files.  Perhaps an option when creating a new file should be the desired replication count.  MapReduce should take advantage of this feature so that job.xml and job.jar files, which are frequently accessed by lots of machines, are more highly replicated than large data files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 20:37:28 2006
Return-Path: 
 <hadoop-dev-return-767-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29631 invoked from network); 10 Apr 2006 20:37:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 20:37:28 -0000
Received: (qmail 24910 invoked by uid 500); 10 Apr 2006 20:37:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24888 invoked by uid 500); 10 Apr 2006 20:37:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24879 invoked by uid 99); 10 Apr 2006 20:37:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 13:37:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 13:37:27 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 115E6D49FF
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 21:37:06 +0100 (BST)
Message-ID: <471451358.1144701425968.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 21:37:05 +0100 (BST)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-129) FileSystem should not name files
 with java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-129?page=comments#action_12373924 ] 

Andrzej Bialecki  commented on HADOOP-129:
------------------------------------------

I think we should change this to a Hadoop-specific class, e.g. FileName (not a simple String - too limiting). FileName-s could only be used when holding a reference to a valid instance of FileSystem - this way operations like getParent() could always consult FileSystem-specific routines to resolve DFS names to real names in case of LocalFileSystem.

I also propose that this class should be versioned, and contain some File-like metadata - for now I'm thinking specifically about creation / modification time.

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.1, 0.1.0
>     Reporter: Doug Cutting
>      Fix For: 0.2

>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 20:48:22 2006
Return-Path: 
 <hadoop-dev-return-768-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35561 invoked from network); 10 Apr 2006 20:48:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 20:48:22 -0000
Received: (qmail 41576 invoked by uid 500); 10 Apr 2006 20:48:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41555 invoked by uid 500); 10 Apr 2006 20:48:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41546 invoked by uid 99); 10 Apr 2006 20:48:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 13:48:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 13:48:20 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 09E5F6ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 21:48:00 +0100 (BST)
Message-ID: <1115698231.1144702080037.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 21:48:00 +0100 (BST)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-130) Should be able to specify "wide" or
 "full" replication
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Should be able to specify "wide" or "full" replication
------------------------------------------------------

         Key: HADOOP-130
         URL: http://issues.apache.org/jira/browse/HADOOP-130
     Project: Hadoop
        Type: Improvement

  Components: dfs  
 Environment: N/A
    Reporter: Bryan Pendleton
    Priority: Minor


Should be able to specify that a file be "fully" or "widely" replicated, rather than an explicit replication count. This would be useful for job configuration and jar files, and probably other files whose use is wide enough to necessitate reducing latency to access them.

The current implementation will also complain if you specify replication that is wider than the system's maximum replication value, and has no facility to enable "full" replication should the number of datanodes exceed the current maximum settable value of 32k.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 20:49:22 2006
Return-Path: 
 <hadoop-dev-return-769-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36873 invoked from network); 10 Apr 2006 20:49:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 20:49:22 -0000
Received: (qmail 46950 invoked by uid 500); 10 Apr 2006 20:49:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46932 invoked by uid 500); 10 Apr 2006 20:49:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46923 invoked by uid 99); 10 Apr 2006 20:49:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 13:49:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of bpendleton@gmail.com designates
 64.233.184.225 as permitted sender)
Received: from [64.233.184.225] (HELO wproxy.gmail.com) (64.233.184.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 13:49:16 -0700
Received: by wproxy.gmail.com with SMTP id i20so879003wra
        for <hadoop-dev@lucene.apache.org>;
 Mon, 10 Apr 2006 13:48:56 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:references;
        b=lLwDqYoLWaXNG489EtBoP8JoiLsXHbOPowyjGKWpJKosneJJL9/QSy9J0YOMn5QfkpUEfBubYzcrXMXcd1J00ono0/DhHpgUR8UeP/AQJbppaCa9Xuadmi3EEpBus5xVjbBr13ABGAcSveO2iOd8mCg8CFkjQItXnJjkNs2PegQ=
Received: by 10.65.196.7 with SMTP id y7mr4580053qbp;
        Mon, 10 Apr 2006 13:48:55 -0700 (PDT)
Received: by 10.65.224.8 with HTTP; Mon, 10 Apr 2006 13:48:55 -0700 (PDT)
Message-ID: <1bf79d3e0604101348j4e5600cewfb7bc827577c9888@mail.gmail.com>
Date: Mon, 10 Apr 2006 13:48:55 -0700
From: "Bryan A. Pendleton" <bp@geekdom.net>
Sender: bpendleton@gmail.com
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Resolved: (HADOOP-51) per-file replication counts
In-Reply-To: <1434975343.1144698501225.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_9641_25529153.1144702135963"
References: <1529480135.1140561049677.JavaMail.jira@ajax.apache.org>
	 <1434975343.1144698501225.JavaMail.jira@ajax>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_9641_25529153.1144702135963
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
Content-Disposition: inline

SSBhZ3JlZTogR29vZCB3b3JrIEtvbnN0YW50aW4hCgpJJ2xsIGZpbGUgbmV3IGZlYXR1cmUgcmVx
dWVzdHMgZm9yIHRoZSBzdGlja3kgYml0cyBmcm9tIHRoZSBkaXNjdXNzaW9uLgoKT24gNC8xMC8w
NiwgRG91ZyBDdXR0aW5nIChKSVJBKSA8amlyYUBhcGFjaGUub3JnPiB3cm90ZToKPgo+ICAgICAg
WyBodHRwOi8vaXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2UvSEFET09QLTUxP3BhZ2U9YWxs
IF0KPgo+IERvdWcgQ3V0dGluZyByZXNvbHZlZCBIQURPT1AtNTE6Cj4gLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KPgo+ICAgICBSZXNvbHV0aW9uOiBGaXhlZAo+Cj4gSSBqdXN0IGNv
bW1pdHRlZCB0aGlzLiAgSSBmaXhlZCB0aGUgY29tbWVudCBvbiBkZnMucmVwbGljYXRpb24ubWlu
LiAgSQo+IGFsc28gYWRkZWQgYSBtZXNzYWdlIHRvIENIQU5HRVMudHh0Lgo+Cj4gVGhhbmtzLCBL
b25zdGFudGluIQo+Cj4gQnJ5YW46IEkgdGhpbmsgdGhlIGlzc3VlcyB5b3UgcmFpc2UgYmVhciBm
dXJ0aGVyIGRpc2N1c3Npb24gdGhhdCBJIGRvIG5vdAo+IHdpc2ggdG8gc3RpZmxlLiAgRm9yIGV4
YW1wbGUsIHdlIG1heSBzb21lZGF5IHdhbnQgIHRvIGJlIGFibGUgdG8gc3BlY2lmeQo+IG1vcmUg
dGhhbiAyXjE2IHJlcGxpY2F0aW9ucywgYW5kIHdlIG1heSB3aXNoIHRvIGhhbmRsZSByZXBsaWNh
dGlvbiByZXF1ZXN0cwo+IG91dHNpZGUgb2YgdGhlIGNvbmZpZ3VyZWQgbGltaXRzIGRpZmZlcmVu
dGx5LiAgQnV0LCBmb3Igbm93LCBJIHRoaW5rIHRoZQo+IHBhdGNoIGZpeGVzIHRoaXMgYnVnIGFu
ZCB0aGF0IHRob3NlIGlzc3VlcyBjYW4gYmUgYWRkcmVzc2VkIHRob3VnaAo+IHN1YnNlcXVlbnQg
YnVncyBhcyB3ZSBnYWluIGV4cGVyaWVuY2UuICBTbyBwbGVhc2UgZmlsZSBuZXcgYnVncyBmb3Ig
YW55Cj4gcmVsYXRlZCBpc3N1ZXMgdGhhdCBhcmUgaW1wb3J0YW50IHRvIHlvdS4KPgo+ID4gcGVy
LWZpbGUgcmVwbGljYXRpb24gY291bnRzCj4gPiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
PiA+Cj4gPiAgICAgICAgICBLZXk6IEhBRE9PUC01MQo+ID4gICAgICAgICAgVVJMOiBodHRwOi8v
aXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2UvSEFET09QLTUxCj4gPiAgICAgIFByb2plY3Q6
IEhhZG9vcAo+ID4gICAgICAgICBUeXBlOiBOZXcgRmVhdHVyZQo+Cj4gPiAgIENvbXBvbmVudHM6
IGRmcwo+ID4gICAgIFZlcnNpb25zOiAwLjIKPiA+ICAgICBSZXBvcnRlcjogRG91ZyBDdXR0aW5n
Cj4gPiAgICAgQXNzaWduZWU6IEtvbnN0YW50aW4gU2h2YWNoa28KPiA+ICAgICAgRml4IEZvcjog
MC4yCj4gPiAgQXR0YWNobWVudHM6IFJlcGxpY2F0aW9uLnBhdGNoCj4gPgo+ID4gSXQgc2hvdWxk
IGJlIHBvc3NpYmxlIHRvIHNwZWNpZnkgZGlmZmVyZW50IHJlcGxpY2F0aW9uIGNvdW50cyBmb3IK
PiBkaWZmZXJlbnQgZmlsZXMuICBQZXJoYXBzIGFuIG9wdGlvbiB3aGVuIGNyZWF0aW5nIGEgbmV3
IGZpbGUgc2hvdWxkIGJlIHRoZQo+IGRlc2lyZWQgcmVwbGljYXRpb24gY291bnQuICBNYXBSZWR1
Y2Ugc2hvdWxkIHRha2UgYWR2YW50YWdlIG9mIHRoaXMgZmVhdHVyZQo+IHNvIHRoYXQgam9iLnht
bCBhbmQgam9iLmphciBmaWxlcywgd2hpY2ggYXJlIGZyZXF1ZW50bHkgYWNjZXNzZWQgYnkgbG90
cwo+IG9mIG1hY2hpbmVzLCBhcmUgbW9yZSBoaWdobHkgcmVwbGljYXRlZCB0aGFuIGxhcmdlIGRh
dGEgZmlsZXMuCj4KPiAtLQo+IFRoaXMgbWVzc2FnZSBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRl
ZCBieSBKSVJBLgo+IC0KPiBJZiB5b3UgdGhpbmsgaXQgd2FzIHNlbnQgaW5jb3JyZWN0bHkgY29u
dGFjdCBvbmUgb2YgdGhlIGFkbWluaXN0cmF0b3JzOgo+ICAgIGh0dHA6Ly9pc3N1ZXMuYXBhY2hl
Lm9yZy9qaXJhL3NlY3VyZS9BZG1pbmlzdHJhdG9ycy5qc3BhCj4gLQo+IEZvciBtb3JlIGluZm9y
bWF0aW9uIG9uIEpJUkEsIHNlZToKPiAgICBodHRwOi8vd3d3LmF0bGFzc2lhbi5jb20vc29mdHdh
cmUvamlyYQo+Cj4KCgotLQpCcnlhbiBBLiBQZW5kbGV0b24KUGg6ICg4NzcpIGdlZWstMS1icAo=
------=_Part_9641_25529153.1144702135963--

From MAILER-DAEMON Mon Apr 10 21:00:52 2006
Return-Path: 
 <hadoop-dev-return-770-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46657 invoked from network); 10 Apr 2006 21:00:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 21:00:52 -0000
Received: (qmail 70251 invoked by uid 500); 10 Apr 2006 21:00:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70230 invoked by uid 500); 10 Apr 2006 21:00:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70221 invoked by uid 99); 10 Apr 2006 21:00:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 14:00:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 14:00:51 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9C3C26ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 22:00:30 +0100 (BST)
Message-ID: <670450193.1144702830599.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 22:00:30 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-129) FileSystem should not name files
 with java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-129?page=comments#action_12373928 ] 

Doug Cutting commented on HADOOP-129:
-------------------------------------

>  I think we should change this to a Hadoop-specific class, e.g. FileName.

Why not URI?  What required methods are missing from URI?  Conversely, what URI methods do you think might cause problems?

Partially answering my own question, with URIs we'd have to check the schema host and port matched the fs when implementing each FS method.  In other words, given that we need a FileSystem instance to do anything, the schema, host and port fields of the URI are usually redundant and force us to perform error checking.  However these same fields would be useful when specifying MapReduce input and output directories, in command lines, etc., permitting one to easily specify non-default FileSystem implementations.

Note that I don't think URI buys us interoperability with other systems.  So we should only use it if we think it will make writing Hadoop easier: if it consists of code that we'd need to mostly need to write anyway.

A side-benefit of URI is that it provides standards-defined filename syntax.  We don't have to figure out how to, e.g., escape things, or how backslashes and colons should be treated, etc.  We can simply point to a standard.

> I also propose that this class should be versioned, and contain some File-like metadata - for now I'm thinking specifically about creation / modification time.

This works so long as files are write-once.  But if they can be appended to or overwritten then this information could get stale.

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.1, 0.1.0
>     Reporter: Doug Cutting
>      Fix For: 0.2

>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 21:05:41 2006
Return-Path: 
 <hadoop-dev-return-771-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49356 invoked from network); 10 Apr 2006 21:05:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 21:05:41 -0000
Received: (qmail 75780 invoked by uid 500); 10 Apr 2006 21:05:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75759 invoked by uid 500); 10 Apr 2006 21:05:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75750 invoked by uid 99); 10 Apr 2006 21:05:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 14:05:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 14:05:40 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7866D6ACAB
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 22:05:19 +0100 (BST)
Message-ID: <1659676887.1144703119490.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 22:05:19 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-124) Files still rotting in DFS of latest
 Hadoop
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]

Doug Cutting updated HADOOP-124:
--------------------------------

     Version: 0.2
    Priority: Critical  (was: Major)

This seems like something we should fix in the .2 release, no?

> Files still rotting in DFS of latest Hadoop
> -------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Priority: Critical

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 21:08:25 2006
Return-Path: 
 <hadoop-dev-return-772-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51084 invoked from network); 10 Apr 2006 21:08:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 21:08:25 -0000
Received: (qmail 80059 invoked by uid 500); 10 Apr 2006 21:08:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79941 invoked by uid 500); 10 Apr 2006 21:08:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79930 invoked by uid 99); 10 Apr 2006 21:08:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 14:08:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 14:08:24 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4BE446ACAB
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 22:08:03 +0100 (BST)
Message-ID: <463223613.1144703283308.JavaMail.jira@ajax>
Date: Mon, 10 Apr 2006 22:08:03 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-124) don't permit two datanodes to run from
 same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]

Doug Cutting updated HADOOP-124:
--------------------------------

    Summary: don't permit two datanodes to run from same dfs.data.dir  (was: Files still rotting in DFS of latest Hadoop)

Changing the summary to better describe what we intend to fix.

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Priority: Critical

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 23:19:20 2006
Return-Path: 
 <hadoop-dev-return-773-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12055 invoked from network); 10 Apr 2006 23:19:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 23:19:20 -0000
Received: (qmail 48053 invoked by uid 500); 10 Apr 2006 23:19:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48019 invoked by uid 500); 10 Apr 2006 23:19:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48010 invoked by uid 99); 10 Apr 2006 23:19:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 16:19:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=UPPERCASE_25_50
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 16:19:18 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 57970144475
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 01:05:27 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 15120-06 for <hadoop-dev@lucene.apache.org>;
	Tue, 11 Apr 2006 01:05:27 +0200 (CEST)
Received: from [10.10.16.230] (unknown [64.71.164.125])
	by mslinux.media-style.com (Postfix) with ESMTP id 0D9FF144473
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 01:05:25 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
Content-Transfer-Encoding: 7bit
Message-Id: <992D847D-70BD-45AF-9404-FCA17BE32490@media-style.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: default is: "{HADOOP_CONF_DIR}/slaves not ~/.salves
Date: Tue, 11 Apr 2006 01:18:35 +0200
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
just a very very small improvement suggestion:

the slaves.sh says in the header:
#   HADOOP_SLAVES    File naming remote hosts.  Default is ~/.slaves

But uses:
if [ "$HADOOP_SLAVES" = "" ]; then
   export HADOOP_SLAVES="${HADOOP_CONF_DIR}/slaves"
fi

Stefan 

From MAILER-DAEMON Mon Apr 10 23:28:29 2006
Return-Path: 
 <hadoop-dev-return-774-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18742 invoked from network); 10 Apr 2006 23:28:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 23:28:29 -0000
Received: (qmail 58707 invoked by uid 500); 10 Apr 2006 23:28:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58687 invoked by uid 500); 10 Apr 2006 23:28:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58678 invoked by uid 99); 10 Apr 2006 23:28:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 16:28:28 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 16:28:28 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id EF3996ACA9
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 00:28:06 +0100 (BST)
Message-ID: <125679537.1144711686973.JavaMail.jira@ajax>
Date: Tue, 11 Apr 2006 00:28:06 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-127) Unclear precedence of config files
 and property definitions
In-Reply-To: <336798027.1144662478922.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-127?page=comments#action_12373950 ] 

Doug Cutting commented on HADOOP-127:
-------------------------------------

I think you have it right.  Some guidelines:

Folks should only define things in the -site files if they want to force them for all code.

Folks should not edit the -default files.

Non-default settings that may be overridden by application code should be put in mapred-default.xml.

Application settings are set in the job.

Strictly speaking, it doesn't much matter whether you put something in a nutch- or hadoop- file, although the intent is to keep things that are specific to Hadoop in hadoop- files and things specific to Nutch in nutch- files.




> Unclear precedence of config files and property definitions
> -----------------------------------------------------------
>
>          Key: HADOOP-127
>          URL: http://issues.apache.org/jira/browse/HADOOP-127
>      Project: Hadoop
>         Type: Bug

>   Components: conf
>  Environment: Hadoop 0.1.1, Nutch 0.8-dev
>     Reporter: Andrzej Bialecki 

>
> The order in which configuration resources are read is not sufficiently documented, and also there are no mechanisms preventing harmful re-definition of certain properties, if they are put in wrong config files.
> From reading the code in Hadoop Configuration.java, JobConf.java and Nutch NutchConfiguration.java I _think_ this is what's happening.
> There are two groups of resources: default resources, loaded first, and final resources, loaded at the end. All properties (re)-defined in files loaded later will override any previous definitions:
> * default resources: loaded in the order as they are added. The following files are added here, in order:
>     1. hadoop-default.xml (Configuration)
>     2. nutch-default.xml  (NutchConfiguration)
>     3. mapred-default.xml (JobConf)
>     4. job_xx_xxx.xml       (JobConf, in JobConf(File config))
> * final resource: which always come after default resources, i.e. if any value is defined here it will always override those set in default resources (NOTE: including per job settings!!!). The following files are added here, in reversed order:
>     2. hadoop-site.xml (Configuration)
>     1. nutch-site.xml    (NutchConfiguration)
> (i.e. hadoop-site.xml will take precedence over anything else defined in any other config file).
> I would appreciate checking that this is indeed the case, and suggestions how to ensure that you cannot so easily shoot yourself in the foot if you define wrong properties in hadoop-site or nutch-site ...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 10 23:48:06 2006
Return-Path: 
 <hadoop-dev-return-775-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 25317 invoked from network); 10 Apr 2006 23:48:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Apr 2006 23:48:06 -0000
Received: (qmail 79536 invoked by uid 500); 10 Apr 2006 23:48:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79518 invoked by uid 500); 10 Apr 2006 23:48:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79509 invoked by uid 99); 10 Apr 2006 23:48:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 16:48:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 16:48:03 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3ANlWbL009440
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 19:47:32 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k3ANlc1i263740;
	Mon, 10 Apr 2006 19:47:38 -0400
Message-ID: <443AEE99.4070906@apache.org>
Date: Mon, 10 Apr 2006 16:47:37 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Problem starting hadoop
References: <200604101813.k3AIDM7t030993@xmta2.jpl.nasa.gov>
In-Reply-To: <200604101813.k3AIDM7t030993@xmta2.jpl.nasa.gov>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Chris Mattmann wrote:
>>You can override this by editing conf/hadoop-env.sh.  Both are optional,
>>but convenient.  Perhaps we should avoid using them until they're in
>>wider distribution.
> 
> Yeah, I think it would be nice to find a workaround to explicitly using
> these options.

Is adding the following line to your conf/hadoop-env.sh not good enough?

export HADOOP_SSH_OPTS=""

Or are you arguing that we should make that the default?  I'd be okay 
with that.

>>Instead of 'bin/start-all.sh' that's just 'bin/hadoop-daemon.sh start
>>namenode; bin/hadoop-daemons.sh start datanode'.  Is that what you're
>>after?  I guess we could add a bin/start-dfs.sh command that does this.
> 
> Yeah, that's exactly what I'm after. [ ... ] Anyways, getting back to the
> point, yeah, it would be great to have something to just start and stop DFS,
> and start and stop MapReduce for that matter, even if it just amounts to the
> simple command you mentioned above. I've attached a quick patch for Hadoop
> that implements it.

Can you please attach this to a bug so that we don't lose track of it?

Also, we should probably change the -all scripts to be based on the -dfs 
and -mapred scripts, no?

Doug

From MAILER-DAEMON Tue Apr 11 01:40:40 2006
Return-Path: 
 <hadoop-dev-return-776-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65586 invoked from network); 11 Apr 2006 01:40:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 01:40:40 -0000
Received: (qmail 76780 invoked by uid 500); 11 Apr 2006 01:40:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76761 invoked by uid 500); 11 Apr 2006 01:40:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76752 invoked by uid 99); 11 Apr 2006 01:40:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 18:40:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [137.78.160.108] (HELO nmta3.jpl.nasa.gov) (137.78.160.108)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 18:40:38 -0700
Received: from xmta2.jpl.nasa.gov (xmta2.jpl.nasa.gov [137.78.160.56])
	by nmta3.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3B1eHxO000535
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 18:40:17 -0700
Received: from SPAWN (vpn-149-244-061.jpl.nasa.gov [128.149.244.61])
	by xmta2.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3B1eGgi027808
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 18:40:16 -0700
Message-Id: <200604110140.k3B1eGgi027808@xmta2.jpl.nasa.gov>
Reply-To: <chris.mattmann@jpl.nasa.gov>
From: "Chris Mattmann" <chris.mattmann@jpl.nasa.gov>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: Problem starting hadoop
Date: Mon, 10 Apr 2006 18:40:16 -0700
Organization: Jet Propulsion Laboratory
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook, Build 11.0.6353
In-Reply-To: <443AEE99.4070906@apache.org>
X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2900.2527
Thread-Index: AcZc+Tc9bPuvYZmXRaqp4ZAqyQBHAwAD1tcA
X-Source-IP: vpn-149-244-061.jpl.nasa.gov [128.149.244.61]
X-Source-Sender: chris.mattmann@jpl.nasa.gov
X-AUTH: Internal IP
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hey Doug,
> 
> Is adding the following line to your conf/hadoop-env.sh not good enough?
> 
> export HADOOP_SSH_OPTS=""
> 
> Or are you arguing that we should make that the default?  I'd be okay
> with that.

Yup, that's what I'm arguing. +1

> 
> >>Instead of 'bin/start-all.sh' that's just 'bin/hadoop-daemon.sh start
> >>namenode; bin/hadoop-daemons.sh start datanode'.  Is that what you're
> >>after?  I guess we could add a bin/start-dfs.sh command that does this.
> >
> > Yeah, that's exactly what I'm after. [ ... ] Anyways, getting back to
> the
> > point, yeah, it would be great to have something to just start and stop
> DFS,
> > and start and stop MapReduce for that matter, even if it just amounts to
> the
> > simple command you mentioned above. I've attached a quick patch for
> Hadoop
> > that implements it.
> 
> Can you please attach this to a bug so that we don't lose track of it?
> 
> Also, we should probably change the -all scripts to be based on the -dfs
> and -mapred scripts, no?

Yup, agreed. I'll attach the patch in five minutes to JIRA. Thanks for the
quick turnaround on this.

Take care,
  Chris

> 
> Doug


From MAILER-DAEMON Tue Apr 11 01:50:52 2006
Return-Path: 
 <hadoop-dev-return-777-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68435 invoked from network); 11 Apr 2006 01:50:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 01:50:52 -0000
Received: (qmail 89372 invoked by uid 500); 11 Apr 2006 01:50:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89344 invoked by uid 500); 11 Apr 2006 01:50:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89327 invoked by uid 99); 11 Apr 2006 01:50:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 18:50:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 18:50:49 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CBA67D4A00
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 02:50:28 +0100 (BST)
Message-ID: <927378871.1144720228826.JavaMail.jira@ajax>
Date: Tue, 11 Apr 2006 02:50:28 +0100 (BST)
From: "Chris A. Mattmann (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-131) Separate start/stop-dfs.sh and
 start/stop-mapred.sh scripts
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Separate start/stop-dfs.sh and start/stop-mapred.sh scripts
-----------------------------------------------------------

         Key: HADOOP-131
         URL: http://issues.apache.org/jira/browse/HADOOP-131
     Project: Hadoop
        Type: Improvement

  Components: dfs  
    Versions: 0.1.1, 0.1.0    
 Environment: Pentium M, 1.4 Ghz, Dell Inspiron 8600 Laptop, Windows XP Pro SP 2, although improvement is independent of environment
    Reporter: Chris A. Mattmann
    Priority: Minor


Hadoop needs start-dfs/mapred.sh scripts, and stop-dfs/mapred.sh scripts, to independently start mapred, or independently start dfs. This way, users can use a single subsystem of the full Hadoop component library.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 11 03:04:50 2006
Return-Path: 
 <hadoop-dev-return-778-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97550 invoked from network); 11 Apr 2006 03:04:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 03:04:50 -0000
Received: (qmail 54916 invoked by uid 500); 11 Apr 2006 03:04:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54883 invoked by uid 500); 11 Apr 2006 03:04:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54873 invoked by uid 99); 11 Apr 2006 03:04:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 20:04:50 -0700
X-ASF-Spam-Status: No, hits=0.3 required=10.0
	tests=HTML_FONT_BIG,HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [137.78.160.214] (HELO nmta1.jpl.nasa.gov) (137.78.160.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 20:04:49 -0700
Received: from xmta1.jpl.nasa.gov (xmta1.jpl.nasa.gov [137.78.160.144])
	by nmta1.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3B34QKR006896
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 20:04:26 -0700
Received: from SPAWN (vpn-149-244-061.jpl.nasa.gov [128.149.244.61])
	by xmta1.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3B34ORx029821
	for <hadoop-dev@lucene.apache.org>; Mon, 10 Apr 2006 20:04:25 -0700
Message-Id: <200604110304.k3B34ORx029821@xmta1.jpl.nasa.gov>
Reply-To: <chris.mattmann@jpl.nasa.gov>
From: "Chris Mattmann" <chris.mattmann@jpl.nasa.gov>
To: <hadoop-dev@lucene.apache.org>
Subject: jira problems
Date: Mon, 10 Apr 2006 20:04:24 -0700
Organization: Jet Propulsion Laboratory
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_000B_01C65CD9.F780CD70"
X-Mailer: Microsoft Office Outlook, Build 11.0.6353
X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2900.2527
Thread-Index: AcZdFKLiiuMPPeyoR9eZQMoCWkCgbQ==
X-Source-IP: vpn-149-244-061.jpl.nasa.gov [128.149.244.61]
X-Source-Sender: chris.mattmann@jpl.nasa.gov
X-AUTH: Internal IP
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_NextPart_000_000B_01C65CD9.F780CD70
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Hi Folks,

  Due to JIRA problems, I've been unable to upload the patch for NUTCH-130
for the last hour, sigh. I will try and upload it as soon as JIRA is
working.

 

Thanks,

  Chirs

 

 

______________________________________________
Chris A. Mattmann
Chris.Mattmann@jpl.nasa.gov 
Staff Member
Modeling and Data Management Systems Section (387)

Data Management Systems and Technologies Group

_________________________________________________
Jet Propulsion Laboratory            Pasadena, CA
Office: 171-266B                        Mailstop:  171-246
Phone:  818-354-8810
_______________________________________________________

Disclaimer:  The opinions presented within are my own and do not reflect
those of either NASA, JPL, or the California Institute of Technology.

 


------=_NextPart_000_000B_01C65CD9.F780CD70--


From MAILER-DAEMON Tue Apr 11 05:00:41 2006
Return-Path: 
 <hadoop-dev-return-779-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45571 invoked from network); 11 Apr 2006 05:00:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 05:00:41 -0000
Received: (qmail 39982 invoked by uid 500); 11 Apr 2006 05:00:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39964 invoked by uid 500); 11 Apr 2006 05:00:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39955 invoked by uid 99); 11 Apr 2006 05:00:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 22:00:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Apr 2006 22:00:38 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id F1DD4D4A01
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 06:00:17 +0100 (BST)
Message-ID: <224037849.1144731617987.JavaMail.jira@ajax>
Date: Tue, 11 Apr 2006 06:00:17 +0100 (BST)
From: "Chris A. Mattmann (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-131) Separate start/stop-dfs.sh and
 start/stop-mapred.sh scripts
In-Reply-To: <927378871.1144720228826.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-131?page=all ]

Chris A. Mattmann updated HADOOP-131:
-------------------------------------

    Attachment: HADOOP-131.Mattmann.patch.060410.txt

patch that separates out start/stop-dfs.sh and start/stop-mapred.sh scripts, and makes start-all.sh and stop-all.sh call them.

> Separate start/stop-dfs.sh and start/stop-mapred.sh scripts
> -----------------------------------------------------------
>
>          Key: HADOOP-131
>          URL: http://issues.apache.org/jira/browse/HADOOP-131
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.1, 0.1.0
>  Environment: Pentium M, 1.4 Ghz, Dell Inspiron 8600 Laptop, Windows XP Pro SP 2, although improvement is independent of environment
>     Reporter: Chris A. Mattmann
>     Priority: Minor
>  Attachments: HADOOP-131.Mattmann.patch.060410.txt
>
> Hadoop needs start-dfs/mapred.sh scripts, and stop-dfs/mapred.sh scripts, to independently start mapred, or independently start dfs. This way, users can use a single subsystem of the full Hadoop component library.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 11 16:52:52 2006
Return-Path: 
 <hadoop-dev-return-780-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90008 invoked from network); 11 Apr 2006 16:52:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 16:52:52 -0000
Received: (qmail 93719 invoked by uid 500); 11 Apr 2006 16:52:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93697 invoked by uid 500); 11 Apr 2006 16:52:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93688 invoked by uid 99); 11 Apr 2006 16:52:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 09:52:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 09:52:40 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 007966ACA9
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 17:52:20 +0100 (BST)
Message-ID: <378596208.1144774339999.JavaMail.jira@ajax>
Date: Tue, 11 Apr 2006 17:52:19 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-131) Separate start/stop-dfs.sh and
 start/stop-mapred.sh scripts
In-Reply-To: <927378871.1144720228826.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-131?page=all ]
     
Doug Cutting resolved HADOOP-131:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Doug Cutting

I just committed this, fixing a typo in start-mapred.sh.  Thanks, Chris.


> Separate start/stop-dfs.sh and start/stop-mapred.sh scripts
> -----------------------------------------------------------
>
>          Key: HADOOP-131
>          URL: http://issues.apache.org/jira/browse/HADOOP-131
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.1, 0.1.0
>  Environment: Pentium M, 1.4 Ghz, Dell Inspiron 8600 Laptop, Windows XP Pro SP 2, although improvement is independent of environment
>     Reporter: Chris A. Mattmann
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: HADOOP-131.Mattmann.patch.060410.txt
>
> Hadoop needs start-dfs/mapred.sh scripts, and stop-dfs/mapred.sh scripts, to independently start mapred, or independently start dfs. This way, users can use a single subsystem of the full Hadoop component library.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 11 17:02:14 2006
Return-Path: 
 <hadoop-dev-return-781-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97341 invoked from network); 11 Apr 2006 17:02:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 17:02:14 -0000
Received: (qmail 11113 invoked by uid 500); 11 Apr 2006 17:02:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11096 invoked by uid 500); 11 Apr 2006 17:02:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11087 invoked by uid 99); 11 Apr 2006 17:02:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 10:02:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 10:02:12 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3BH14bk023093
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 13:01:07 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3BH1XxT096348;
	Tue, 11 Apr 2006 13:01:36 -0400
Message-ID: <443BE0EC.5080708@apache.org>
Date: Tue, 11 Apr 2006 10:01:32 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Problem starting hadoop
References: <200604110140.k3B1eGgi027808@xmta2.jpl.nasa.gov>
In-Reply-To: <200604110140.k3B1eGgi027808@xmta2.jpl.nasa.gov>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Chris Mattmann wrote:
>>Is adding the following line to your conf/hadoop-env.sh not good enough?
>>
>>export HADOOP_SSH_OPTS=""
>>
>>Or are you arguing that we should make that the default?  I'd be okay
>>with that.
> 
> Yup, that's what I'm arguing. +1

Done.

Doug

From MAILER-DAEMON Tue Apr 11 17:29:46 2006
Return-Path: 
 <hadoop-dev-return-782-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17779 invoked from network); 11 Apr 2006 17:29:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 17:29:46 -0000
Received: (qmail 53822 invoked by uid 500); 11 Apr 2006 17:29:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53806 invoked by uid 500); 11 Apr 2006 17:29:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53797 invoked by uid 99); 11 Apr 2006 17:29:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 10:29:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [137.78.160.215] (HELO nmta2.jpl.nasa.gov) (137.78.160.215)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 10:29:09 -0700
Received: from xmta2.jpl.nasa.gov (xmta2.jpl.nasa.gov [137.78.160.56])
	by nmta2.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3BHSkip018671
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 10:28:46 -0700
Received: from SPAWN (dhcp-79-164-229.jpl.nasa.gov [137.79.164.229])
	by xmta2.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3BHSjjq011448
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 10:28:45 -0700
Message-Id: <200604111728.k3BHSjjq011448@xmta2.jpl.nasa.gov>
Reply-To: <chris.mattmann@jpl.nasa.gov>
From: "Chris Mattmann" <chris.mattmann@jpl.nasa.gov>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: Problem starting hadoop
Date: Tue, 11 Apr 2006 10:28:45 -0700
Organization: Jet Propulsion Laboratory
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook, Build 11.0.6353
In-reply-to: <443BE0EC.5080708@apache.org>
X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2900.2527
Thread-index: AcZdia66NejBIABaR8G6kVjFKgI1KgAA6VLw
X-Source-IP: dhcp-79-164-229.jpl.nasa.gov [137.79.164.229]
X-Source-Sender: chris.mattmann@jpl.nasa.gov
X-AUTH: Internal IP
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Thanks Doug! :-)

Cheers,
  Chris


______________________________________________
Chris A. Mattmann
Chris.Mattmann@jpl.nasa.gov 
Staff Member
Modeling and Data Management Systems Section (387)
Data Management Systems and Technologies Group

_________________________________________________
Jet Propulsion Laboratory            Pasadena, CA
Office: 171-266B                        Mailstop:  171-246
_______________________________________________________

Disclaimer:  The opinions presented within are my own and do not reflect
those of either NASA, JPL, or the California Institute of Technology.

> -----Original Message-----
> From: Doug Cutting [mailto:cutting@apache.org]
> Sent: Tuesday, April 11, 2006 10:02 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: Problem starting hadoop
> 
> Chris Mattmann wrote:
> >>Is adding the following line to your conf/hadoop-env.sh not good enough?
> >>
> >>export HADOOP_SSH_OPTS=""
> >>
> >>Or are you arguing that we should make that the default?  I'd be okay
> >>with that.
> >
> > Yup, that's what I'm arguing. +1
> 
> Done.
> 
> Doug


From MAILER-DAEMON Tue Apr 11 18:23:47 2006
Return-Path: 
 <hadoop-dev-return-783-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52607 invoked from network); 11 Apr 2006 18:23:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 18:23:47 -0000
Received: (qmail 53061 invoked by uid 500); 11 Apr 2006 18:23:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52994 invoked by uid 500); 11 Apr 2006 18:23:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52964 invoked by uid 99); 11 Apr 2006 18:23:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 11:23:44 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 11:23:43 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3EF8ED49FF
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 19:23:22 +0100 (BST)
Message-ID: <644863444.1144779802212.JavaMail.jira@ajax>
Date: Tue, 11 Apr 2006 19:23:22 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-129) FileSystem should not name files
 with java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-129?page=comments#action_12374087 ] 

Doug Cutting commented on HADOOP-129:
-------------------------------------

URI actually *can* compute parent directory.  For example:

URI subDir = new URI("/foo/bar/baz/");
URI parent = subDir.resolve("..");

Parent.toString() returns "/foo/bar/".

So I think that URI has the features we want for filenames and not much else.  Am I missing something?

It might also be useful to implement a URLStreamHandler, so that one can create "hdfs:" urls and use them whereever java accepts URLs, e.g., in classloaders, etc.  But the URL class doesn't support relative path name resolution, the primary feature we require for names.

Unless there are objections, I'll start exploring replacing the uses of java.io.File with java.net.URI.

My thinking is that we remove rather than deprecate the old methods.  This makes the change incompatible, but I think we really want to get rid of the use of java.io.File.  I'm willing to update Nutch & unit tests as required, but this may break others' code.  Should we instead deprecate these in Hadoop 0.2 and then remove them in 0.3?  Thoughts?

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.1, 0.1.0
>     Reporter: Doug Cutting
>      Fix For: 0.2

>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 11 19:01:42 2006
Return-Path: 
 <hadoop-dev-return-784-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78120 invoked from network); 11 Apr 2006 19:01:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 19:01:42 -0000
Received: (qmail 11913 invoked by uid 500); 11 Apr 2006 19:01:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11897 invoked by uid 500); 11 Apr 2006 19:01:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11888 invoked by uid 99); 11 Apr 2006 19:01:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 12:01:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 12:01:41 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id EE633D4A00
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 20:01:19 +0100 (BST)
Message-ID: <1523551876.1144782079972.JavaMail.jira@ajax>
Date: Tue, 11 Apr 2006 20:01:19 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12374091 ] 

Doug Cutting commented on HADOOP-124:
-------------------------------------

I just talked with Owen, and we came up with the following plan:

(0) store a node id in each dfs.data.dir;

(1) pass the node id to the name node in all DataNodeProtocol calls;

(2) the namenode tracks datanodes by <id,host:port> pairs, only talking to one id from a given host:port at a time.  requests from an unknown host:port return a status that causes the datanode to exit and *not* restart itself.

(3) add a hello() method to DataNodeProtocol, called at datanode startup only.  this erases any entries for a datanode id, replacing them with the new entry.

Thus when a second datanode is started it causes any existing datanode running on that host to be forgotten and to exit when it next contacts the namenode.

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Priority: Critical

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 11 21:19:55 2006
Return-Path: 
 <hadoop-dev-return-785-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59924 invoked from network); 11 Apr 2006 21:19:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 21:19:55 -0000
Received: (qmail 33289 invoked by uid 500); 11 Apr 2006 21:19:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33265 invoked by uid 500); 11 Apr 2006 21:19:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33230 invoked by uid 99); 11 Apr 2006 21:19:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 14:19:52 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 14:19:51 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch1.xch.corp.yahoo.com
 [216.145.51.233])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3BLIjVA055509
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 14:18:45 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=cfy4tsl4Xbrczjnu/eqyVbGdbuIRXaON9i+tiWA8y0EWicOKkMXhhvzm0q1nRFyE
Received: from [172.21.147.237] ([172.21.179.129]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Tue, 11 Apr 2006 14:18:45 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <644863444.1144779802212.JavaMail.jira@ajax>
References: <644863444.1144779802212.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <CCAAD593-012A-4EDF-B332-233DCFB3004A@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-129) FileSystem should not name files
 with java.io.File
Date: Tue, 11 Apr 2006 14:18:43 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 11 Apr 2006 21:18:45.0147 (UTC)
 FILETIME=[83F896B0:01C65DAD]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I'm all for the change!
Of course we don't have a nutch base to upgrade.

On Apr 11, 2006, at 11:23 AM, Doug Cutting (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-129? 
> page=comments#action_12374087 ]
>
> Doug Cutting commented on HADOOP-129:
> -------------------------------------
>
> URI actually *can* compute parent directory.  For example:
>
> URI subDir = new URI("/foo/bar/baz/");
> URI parent = subDir.resolve("..");
>
> Parent.toString() returns "/foo/bar/".
>
> So I think that URI has the features we want for filenames and not  
> much else.  Am I missing something?
>
> It might also be useful to implement a URLStreamHandler, so that  
> one can create "hdfs:" urls and use them whereever java accepts  
> URLs, e.g., in classloaders, etc.  But the URL class doesn't  
> support relative path name resolution, the primary feature we  
> require for names.
>
> Unless there are objections, I'll start exploring replacing the  
> uses of java.io.File with java.net.URI.
>
> My thinking is that we remove rather than deprecate the old  
> methods.  This makes the change incompatible, but I think we really  
> want to get rid of the use of java.io.File.  I'm willing to update  
> Nutch & unit tests as required, but this may break others' code.   
> Should we instead deprecate these in Hadoop 0.2 and then remove  
> them in 0.3?  Thoughts?
>
>> FileSystem should not name files with java.io.File
>> --------------------------------------------------
>>
>>          Key: HADOOP-129
>>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>>      Project: Hadoop
>>         Type: Improvement
>
>>   Components: fs
>>     Versions: 0.1.1, 0.1.0
>>     Reporter: Doug Cutting
>>      Fix For: 0.2
>
>>
>> In Hadoop's FileSystem API, files are currently named using  
>> java.io.File.  This is confusing, as many methods on that class  
>> are inappropriate to call on Hadoop paths.  For example, calling  
>> isDirectory(), exists(), etc. on a java.io.File is not the same as  
>> calling FileSystem.isDirectory() or FileSystem.exists() passing  
>> that same file.  Using java.io.File also makes correct operation  
>> on Windows difficult, since java.io.File operates differently on  
>> Windows in order to accomodate Windows path names.  For example,  
>> new File("/foo") is not absolute on Windows, and prints its path  
>> as "\\foo", which causes confusion.
>> To fix this we could replace the uses of java.io.File in the  
>> FileSystem API with String, a new FileName class, or perhaps  
>> java.net.URI.  The advantage of URI is that it can also naturally  
>> include the namenode host and port.  The disadvantage is that URI  
>> does not support tree operations like getParent().
>> This change will cause a lot of incompatibility.  Thus it should  
>> probably be made early in a development cycle in order to maximize  
>> the time for folks to adapt to it.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Tue Apr 11 21:46:08 2006
Return-Path: 
 <hadoop-dev-return-786-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72206 invoked from network); 11 Apr 2006 21:46:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 21:46:08 -0000
Received: (qmail 71157 invoked by uid 500); 11 Apr 2006 21:46:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71137 invoked by uid 500); 11 Apr 2006 21:46:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71128 invoked by uid 99); 11 Apr 2006 21:46:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 14:46:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 14:46:06 -0700
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k3BKYVZ20200;
	Tue, 11 Apr 2006 13:34:31 -0700
Message-ID: <443C23A1.7040209@archive.org>
Date: Tue, 11 Apr 2006 14:46:09 -0700
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: I get checksum errors! Was: Re: io.skip.checksum.errors was: Re:
 Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org>
In-Reply-To: <44234989.7060906@archive.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Checksum errors seem to be a fact of life given the hardware we use.  
They'll often cause my jobs to fail so I have been trying to figure how 
to just skip the bad records and files.  At the end is a note where 
Stefan pointed me at 'io.skip.checksum.errors'.   This property, when 
set, triggers special handling of checksum errors inside 
SequenceFile$Reader: If a checksum, try to skip to next record.  Only, 
this behavior can conflict with another checksum handler that moves 
aside the problematic file whenever a checksum error is found.  Below is 
from a recent log.

060411 202203 task_r_22esh3  Moving bad file 
/2/hadoop/tmp/task_r_22esh3/task_m_e3chga.out to 
/2/bad_files/task_m_e3chga.out.1707416716
060411 202203 task_r_22esh3  Bad checksum at 3578152. Skipping entries.
060411 202203 task_r_22esh3  Error running child
060411 202203 task_r_22esh3 java.nio.channels.ClosedChannelException
060411 202203 task_r_22esh3     at 
sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:89)
060411 202203 task_r_22esh3     at 
sun.nio.ch.FileChannelImpl.position(FileChannelImpl.java:276)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.fs.LocalFileSystem$LocalFSFileInputStream.seek(LocalFileSystem.java:79)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.fs.FSDataInputStream$Checker.seek(FSDataInputStream.java:67)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.fs.FSDataInputStream$PositionCache.seek(FSDataInputStream.java:164)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.fs.FSDataInputStream$Buffer.seek(FSDataInputStream.java:193)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.fs.FSDataInputStream.seek(FSDataInputStream.java:243)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.io.SequenceFile$Reader.seek(SequenceFile.java:420)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.io.SequenceFile$Reader.sync(SequenceFile.java:431)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.io.SequenceFile$Reader.handleChecksumException(SequenceFile.java:412)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:389)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:209)
060411 202203 task_r_22esh3     at 
org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709)

(Ignore line numbers.  My code is a little different from main because 
I've other debugging code inside in SequenceFile.  Otherwise I'm running 
w/ head of hadoop).

The SequenceFile$Reader#handleChecksumException is trying to skip to 
next record but the file has been closed by the move-aside.

Seems easy enough to add a 'if (this.fs.exists(new File(this.file)))' to 
check file is still in place before we try seeking to next record. I can 
make an issue and add a patch if wanted -- I need to test it works first 
-- but are others failing jobs with checksum errors? 

Thanks,
St.Ack




Michael Stack wrote:
> Stefan Groschupf wrote:
>> Hi Stack,
>> I tried that but sorry to say it does not solve the problem - also 
>> with the very latest hadoop update to nutch.
> Thanks for the pointer Stefan (I only just saw this -- over-zealous 
> spam filters).
>
> Yeah, the property 'io.skip.checksum.errors' is of no use to the 
> HADOOP-86 issue.  'io.skip.checksum.errors' effects SequenceFile only. 
> The ChecksumException was being thrown when we had a map output file 
> view on the map product rather than a sequence file view.
>
> But 'io.skip.checksum.errors' looks like a good idea for 
> SequenceFile.  In fact, I just had a job fail because of the below 
> 'java.io.IOException: Corrupt GZIP trailer'.  It happened 4 times in a 
> row.  The 'io.skip.checksum.errors' should be generalized to allow 
> skipping of the likes of this exception too it seems like.
>
> St.Ack
>
>
>
> 060323 204819 task_r_ack5c7 0.9615162% reduce > reduce
> 060323 204820 task_r_3rjkd7  Error running child
> 060323 204820 task_r_3rjkd7 java.lang.RuntimeException: 
> java.io.IOException: Corrupt GZIP trailer
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:132) 
>
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.mapred.lib.IdentityReducer.reduce(IdentityReducer.java:41) 
>
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:283)
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:703)
> 060323 204820 task_r_3rjkd7 Caused by: java.io.IOException: Corrupt 
> GZIP trailer
> 060323 204820 task_r_3rjkd7     at 
> java.util.zip.GZIPInputStream.readTrailer(GZIPInputStream.java:175)
> 060323 204820 task_r_3rjkd7     at 
> java.util.zip.GZIPInputStream.read(GZIPInputStream.java:89)
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.io.WritableUtils.readCompressedByteArray(WritableUtils.java:35) 
>
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.io.WritableUtils.readCompressedString(WritableUtils.java:70) 
>
> 060323 204820 task_r_3rjkd7     at 
> org.apache.nutch.parse.ParseText.readFields(ParseText.java:44)
> 060323 204820 task_r_3rjkd7     at 
> org.apache.nutch.parse.ParseImpl.readFields(ParseImpl.java:59)
> 060323 204820 task_r_3rjkd7     at 
> org.apache.nutch.parse.ParseImpl.read(ParseImpl.java:69)
> 060323 204820 task_r_3rjkd7     at 
> org.apache.nutch.fetcher.FetcherOutput.readFields(FetcherOutput.java:47)
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:344)
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.getNext(ReduceTask.java:163) 
>
> 060323 204820 task_r_3rjkd7     at 
> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:129) 
>
> 060323 204820 task_r_3rjkd7     ... 3 more
>
>
>>
>> @Doug as far I understand the latest update already contains this 
>> rollback "Reverted changes from 384385"?
>>
>> To summarize I'm not able to run just one larger hadoop job e.g. 
>> nutch fetching never worked.
>> Always one tasktracker hangs in the last 10 % of doing a reduce (some 
>> times it arrived 98 % ) than the task runs into a time out and is 
>> restarted again, fails, restarted, fails ...
>> After 4 fails the task in progress crash the complete job.
>>
>> There is just nothing in the log files, that gives any hint also I 
>> configured to ignore check sum exceptions.
>>
>> Any ideas where to search for the problem? It is very sad to throw a 
>> fetched segment with several million documents just to trash,
>>  since the last 3 % of reducing of one tasktracker fail.
>>
>> Thanks for any comments.
>> Stefan
>>
>>
>> Am 12.03.2006 um 03:33 schrieb Stefan Groschupf:
>>
>>> Hi Stack,
>>>
>>> try set the io.skip.checksum.errors to true in your hadoop-site.xml
>>>
>>> <property>
>>>   <name>io.skip.checksum.errors</name>
>>>   <value>false</value>
>>>   <description>If true, when a checksum error is encountered while
>>>   reading a sequence file, entries are skipped, instead of throwing an
>>>   exception.</description>
>>> </property>
>>>
>>> This may be solve your problem but I agree that there should be a 
>>> smarter way than just ignoring it. :)
>>>
>>> Stefan
>>>
>>>
>>> Am 10.03.2006 um 20:22 schrieb stack:
>>>
>>>> On hadoop-users, I've described two recent hangs.  I'm writing here 
>>>> to dev because I'm looking for pointers on how best to conjure a 
>>>> fix with perhaps pointers to any existing facility I might exploit 
>>>> (I do not know the codebase well).
>>>>
>>>> In synopsis the problem goes as follows:
>>>>
>>>> If a reduce cannot pick up map outputs -- for example, the output 
>>>> has been moved aside because of a ChecksumException (See below 
>>>> stack trace) -- then the job gets stuck with the reduce task trying 
>>>> and failing every ten seconds or so to pick up the non-existent map 
>>>> output part.
>>>>
>>>> Somehow the reduce needs to give up and the jobtracker needs to 
>>>> rerun the map just as it would if the tasktracker had died completely.
>>>>
>>>> Thanks in advance for any pointers,
>>>> St.Ack
>>>>
>>>>
>>>> 060309 014426 Moving bad file 
>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out to
>>>> /0/bad_files/part-20.out.2002824050
>>>> 060309 014426 Server handler 0 on 50040 caught:
>>>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>>>      at
>>>> org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122) 
>>>>
>>>>      at
>>>> org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98) 
>>>>
>>>>      at
>>>> org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158) 
>>>>
>>>>      at 
>>>> java.io.BufferedInputStream.read1(BufferedInputStream.java:254)
>>>>      at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
>>>>      at java.io.DataInputStream.read(DataInputStream.java:80)
>>>>      at 
>>>> org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:110)
>>>>      at
>>>> org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117) 
>>>>
>>>>      at 
>>>> org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>>>>      at org.apache.hadoop.ipc.Server$Handler.run(Server.java:215)
>>>>
>>>>
>>>>
>>>
>>> ---------------------------------------------
>>> blog: http://www.find23.org
>>> company: http://www.media-style.com
>>>
>>>
>>>
>>
>> ---------------------------------------------
>> blog: http://www.find23.org
>> company: http://www.media-style.com
>>
>>
>>
>


From MAILER-DAEMON Tue Apr 11 22:40:49 2006
Return-Path: 
 <hadoop-dev-return-787-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6967 invoked from network); 11 Apr 2006 22:40:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 22:40:49 -0000
Received: (qmail 64211 invoked by uid 500); 11 Apr 2006 22:40:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64194 invoked by uid 500); 11 Apr 2006 22:40:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64185 invoked by uid 99); 11 Apr 2006 22:40:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 15:40:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 15:40:48 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3BMdjbk011323
	for <hadoop-dev@lucene.apache.org>; Tue, 11 Apr 2006 18:39:46 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout6-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3BMeFHC261304;
	Tue, 11 Apr 2006 18:40:20 -0400
Message-ID: <443C304E.9080807@apache.org>
Date: Tue, 11 Apr 2006 15:40:14 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
In-Reply-To: <443C23A1.7040209@archive.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I think that when io.skip.checksum.errors is true, then the file should 
not be moved aside.  I'd try adding code to disable the copying in 
LocalFileSystem.java when that flag is set.  Does that make sense?

Doug

Michael Stack wrote:
> Checksum errors seem to be a fact of life given the hardware we use.  
> They'll often cause my jobs to fail so I have been trying to figure how 
> to just skip the bad records and files.  At the end is a note where 
> Stefan pointed me at 'io.skip.checksum.errors'.   This property, when 
> set, triggers special handling of checksum errors inside 
> SequenceFile$Reader: If a checksum, try to skip to next record.  Only, 
> this behavior can conflict with another checksum handler that moves 
> aside the problematic file whenever a checksum error is found.  Below is 
> from a recent log.
> 
> 060411 202203 task_r_22esh3  Moving bad file 
> /2/hadoop/tmp/task_r_22esh3/task_m_e3chga.out to 
> /2/bad_files/task_m_e3chga.out.1707416716
> 060411 202203 task_r_22esh3  Bad checksum at 3578152. Skipping entries.
> 060411 202203 task_r_22esh3  Error running child
> 060411 202203 task_r_22esh3 java.nio.channels.ClosedChannelException
> 060411 202203 task_r_22esh3     at 
> sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:89)
> 060411 202203 task_r_22esh3     at 
> sun.nio.ch.FileChannelImpl.position(FileChannelImpl.java:276)
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.fs.LocalFileSystem$LocalFSFileInputStream.seek(LocalFileSystem.java:79) 
> 
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.fs.FSDataInputStream$Checker.seek(FSDataInputStream.java:67) 
> 
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.fs.FSDataInputStream$PositionCache.seek(FSDataInputStream.java:164) 
> 
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.fs.FSDataInputStream$Buffer.seek(FSDataInputStream.java:193) 
> 
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.fs.FSDataInputStream.seek(FSDataInputStream.java:243)
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.io.SequenceFile$Reader.seek(SequenceFile.java:420)
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.io.SequenceFile$Reader.sync(SequenceFile.java:431)
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.io.SequenceFile$Reader.handleChecksumException(SequenceFile.java:412) 
> 
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:389)
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:209)
> 060411 202203 task_r_22esh3     at 
> org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709)
> 
> (Ignore line numbers.  My code is a little different from main because 
> I've other debugging code inside in SequenceFile.  Otherwise I'm running 
> w/ head of hadoop).
> 
> The SequenceFile$Reader#handleChecksumException is trying to skip to 
> next record but the file has been closed by the move-aside.
> 
> Seems easy enough to add a 'if (this.fs.exists(new File(this.file)))' to 
> check file is still in place before we try seeking to next record. I can 
> make an issue and add a patch if wanted -- I need to test it works first 
> -- but are others failing jobs with checksum errors?
> Thanks,
> St.Ack
> 
> 
> 
> 
> Michael Stack wrote:
> 
>> Stefan Groschupf wrote:
>>
>>> Hi Stack,
>>> I tried that but sorry to say it does not solve the problem - also 
>>> with the very latest hadoop update to nutch.
>>
>> Thanks for the pointer Stefan (I only just saw this -- over-zealous 
>> spam filters).
>>
>> Yeah, the property 'io.skip.checksum.errors' is of no use to the 
>> HADOOP-86 issue.  'io.skip.checksum.errors' effects SequenceFile only. 
>> The ChecksumException was being thrown when we had a map output file 
>> view on the map product rather than a sequence file view.
>>
>> But 'io.skip.checksum.errors' looks like a good idea for 
>> SequenceFile.  In fact, I just had a job fail because of the below 
>> 'java.io.IOException: Corrupt GZIP trailer'.  It happened 4 times in a 
>> row.  The 'io.skip.checksum.errors' should be generalized to allow 
>> skipping of the likes of this exception too it seems like.
>>
>> St.Ack
>>
>>
>>
>> 060323 204819 task_r_ack5c7 0.9615162% reduce > reduce
>> 060323 204820 task_r_3rjkd7  Error running child
>> 060323 204820 task_r_3rjkd7 java.lang.RuntimeException: 
>> java.io.IOException: Corrupt GZIP trailer
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:132) 
>>
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.mapred.lib.IdentityReducer.reduce(IdentityReducer.java:41) 
>>
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:283)
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:703)
>> 060323 204820 task_r_3rjkd7 Caused by: java.io.IOException: Corrupt 
>> GZIP trailer
>> 060323 204820 task_r_3rjkd7     at 
>> java.util.zip.GZIPInputStream.readTrailer(GZIPInputStream.java:175)
>> 060323 204820 task_r_3rjkd7     at 
>> java.util.zip.GZIPInputStream.read(GZIPInputStream.java:89)
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.io.WritableUtils.readCompressedByteArray(WritableUtils.java:35) 
>>
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.io.WritableUtils.readCompressedString(WritableUtils.java:70) 
>>
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.nutch.parse.ParseText.readFields(ParseText.java:44)
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.nutch.parse.ParseImpl.readFields(ParseImpl.java:59)
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.nutch.parse.ParseImpl.read(ParseImpl.java:69)
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.nutch.fetcher.FetcherOutput.readFields(FetcherOutput.java:47)
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:344)
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.getNext(ReduceTask.java:163) 
>>
>> 060323 204820 task_r_3rjkd7     at 
>> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:129) 
>>
>> 060323 204820 task_r_3rjkd7     ... 3 more
>>
>>
>>>
>>> @Doug as far I understand the latest update already contains this 
>>> rollback "Reverted changes from 384385"?
>>>
>>> To summarize I'm not able to run just one larger hadoop job e.g. 
>>> nutch fetching never worked.
>>> Always one tasktracker hangs in the last 10 % of doing a reduce (some 
>>> times it arrived 98 % ) than the task runs into a time out and is 
>>> restarted again, fails, restarted, fails ...
>>> After 4 fails the task in progress crash the complete job.
>>>
>>> There is just nothing in the log files, that gives any hint also I 
>>> configured to ignore check sum exceptions.
>>>
>>> Any ideas where to search for the problem? It is very sad to throw a 
>>> fetched segment with several million documents just to trash,
>>>  since the last 3 % of reducing of one tasktracker fail.
>>>
>>> Thanks for any comments.
>>> Stefan
>>>
>>>
>>> Am 12.03.2006 um 03:33 schrieb Stefan Groschupf:
>>>
>>>> Hi Stack,
>>>>
>>>> try set the io.skip.checksum.errors to true in your hadoop-site.xml
>>>>
>>>> <property>
>>>>   <name>io.skip.checksum.errors</name>
>>>>   <value>false</value>
>>>>   <description>If true, when a checksum error is encountered while
>>>>   reading a sequence file, entries are skipped, instead of throwing an
>>>>   exception.</description>
>>>> </property>
>>>>
>>>> This may be solve your problem but I agree that there should be a 
>>>> smarter way than just ignoring it. :)
>>>>
>>>> Stefan
>>>>
>>>>
>>>> Am 10.03.2006 um 20:22 schrieb stack:
>>>>
>>>>> On hadoop-users, I've described two recent hangs.  I'm writing here 
>>>>> to dev because I'm looking for pointers on how best to conjure a 
>>>>> fix with perhaps pointers to any existing facility I might exploit 
>>>>> (I do not know the codebase well).
>>>>>
>>>>> In synopsis the problem goes as follows:
>>>>>
>>>>> If a reduce cannot pick up map outputs -- for example, the output 
>>>>> has been moved aside because of a ChecksumException (See below 
>>>>> stack trace) -- then the job gets stuck with the reduce task trying 
>>>>> and failing every ten seconds or so to pick up the non-existent map 
>>>>> output part.
>>>>>
>>>>> Somehow the reduce needs to give up and the jobtracker needs to 
>>>>> rerun the map just as it would if the tasktracker had died completely.
>>>>>
>>>>> Thanks in advance for any pointers,
>>>>> St.Ack
>>>>>
>>>>>
>>>>> 060309 014426 Moving bad file 
>>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out to
>>>>> /0/bad_files/part-20.out.2002824050
>>>>> 060309 014426 Server handler 0 on 50040 caught:
>>>>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>>>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>>>>      at
>>>>> org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122) 
>>>>>
>>>>>      at
>>>>> org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98) 
>>>>>
>>>>>      at
>>>>> org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158) 
>>>>>
>>>>>      at 
>>>>> java.io.BufferedInputStream.read1(BufferedInputStream.java:254)
>>>>>      at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
>>>>>      at java.io.DataInputStream.read(DataInputStream.java:80)
>>>>>      at 
>>>>> org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:110)
>>>>>      at
>>>>> org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117) 
>>>>>
>>>>>      at 
>>>>> org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>>>>>      at org.apache.hadoop.ipc.Server$Handler.run(Server.java:215)
>>>>>
>>>>>
>>>>>
>>>>
>>>> ---------------------------------------------
>>>> blog: http://www.find23.org
>>>> company: http://www.media-style.com
>>>>
>>>>
>>>>
>>>
>>> ---------------------------------------------
>>> blog: http://www.find23.org
>>> company: http://www.media-style.com
>>>
>>>
>>>
>>
> 

From MAILER-DAEMON Tue Apr 11 23:33:25 2006
Return-Path: 
 <hadoop-dev-return-788-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28379 invoked from network); 11 Apr 2006 23:33:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 23:33:25 -0000
Received: (qmail 16158 invoked by uid 500); 11 Apr 2006 23:33:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16140 invoked by uid 500); 11 Apr 2006 23:33:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16131 invoked by uid 99); 11 Apr 2006 23:33:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 16:33:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 16:33:23 -0700
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k3BMLmZ27144;
	Tue, 11 Apr 2006 15:21:48 -0700
Message-ID: <443C3CC7.3090603@archive.org>
Date: Tue, 11 Apr 2006 16:33:27 -0700
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org>
In-Reply-To: <443C304E.9080807@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> I think that when io.skip.checksum.errors is true, then the file 
> should not be moved aside.  I'd try adding code to disable the copying 
> in LocalFileSystem.java when that flag is set.  Does that make sense?
>
> Doug 
Let me try it over here on machines that manufacture the checksum 
errors.  Will file an issue and patch if it works.
Thanks,
St.Ack

From MAILER-DAEMON Tue Apr 11 23:34:47 2006
Return-Path: 
 <hadoop-dev-return-789-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28652 invoked from network); 11 Apr 2006 23:34:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 23:34:47 -0000
Received: (qmail 17670 invoked by uid 500); 11 Apr 2006 23:34:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17627 invoked by uid 500); 11 Apr 2006 23:34:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17595 invoked by uid 99); 11 Apr 2006 23:34:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 16:34:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 16:34:41 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 31096D4A00
	for <hadoop-dev@lucene.apache.org>; Wed, 12 Apr 2006 00:34:20 +0100 (BST)
Message-ID: <156689409.1144798460083.JavaMail.jira@ajax>
Date: Wed, 12 Apr 2006 00:34:20 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-129) FileSystem should not name files
 with java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-129?page=comments#action_12374115 ] 

Doug Cutting commented on HADOOP-129:
-------------------------------------

Working through this more, I'm now leaning away from URI and towards a new class.  It will be easier to replace with a new class, since the API can be made to resemble File.  For example, we have a lot of code that calls 'new File(dir, name)' to construct a file in a subdirectory.  The idiom for doing that with URI's is slightly more complicated, and would require a utility method somewhere.  Similarly for file.getParentFile(), etc.

So now I'm leaning towards a class named "Path" that's mostly a drop-in replacement for File, except it doesn't support FS operations like exists(), mkdir(), delete(), etc.

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.1, 0.1.0
>     Reporter: Doug Cutting
>      Fix For: 0.2

>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 11 23:45:20 2006
Return-Path: 
 <hadoop-dev-return-790-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33516 invoked from network); 11 Apr 2006 23:45:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Apr 2006 23:45:20 -0000
Received: (qmail 35876 invoked by uid 500); 11 Apr 2006 23:45:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35860 invoked by uid 500); 11 Apr 2006 23:45:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35848 invoked by uid 99); 11 Apr 2006 23:45:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 16:45:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 16:45:18 -0700
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k3BMXiZ27890;
	Tue, 11 Apr 2006 15:33:44 -0700
Message-ID: <443C3F93.9090404@archive.org>
Date: Tue, 11 Apr 2006 16:45:23 -0700
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org>
In-Reply-To: <443C304E.9080807@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> I think that when io.skip.checksum.errors is true, then the file 
> should not be moved aside.  I'd try adding code to disable the copying 
> in LocalFileSystem.java when that flag is set.  Does that make sense?
One question: The 'io.skip.checksum.errors' is only read in 
SequenceFile#next but the LocalFileSystem checksum error "move-aside" 
handler can be triggered by other than just a call out of 
SequenceFile#next.  If so, stopping the LocalFileSystem move-aside on 
checksum error is probably not the right thing to do.

St.Ack


>
> Doug
>
> Michael Stack wrote:
>> Checksum errors seem to be a fact of life given the hardware we use.  
>> They'll often cause my jobs to fail so I have been trying to figure 
>> how to just skip the bad records and files.  At the end is a note 
>> where Stefan pointed me at 'io.skip.checksum.errors'.   This 
>> property, when set, triggers special handling of checksum errors 
>> inside SequenceFile$Reader: If a checksum, try to skip to next 
>> record.  Only, this behavior can conflict with another checksum 
>> handler that moves aside the problematic file whenever a checksum 
>> error is found.  Below is from a recent log.
>>
>> 060411 202203 task_r_22esh3  Moving bad file 
>> /2/hadoop/tmp/task_r_22esh3/task_m_e3chga.out to 
>> /2/bad_files/task_m_e3chga.out.1707416716
>> 060411 202203 task_r_22esh3  Bad checksum at 3578152. Skipping entries.
>> 060411 202203 task_r_22esh3  Error running child
>> 060411 202203 task_r_22esh3 java.nio.channels.ClosedChannelException
>> 060411 202203 task_r_22esh3     at 
>> sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:89)
>> 060411 202203 task_r_22esh3     at 
>> sun.nio.ch.FileChannelImpl.position(FileChannelImpl.java:276)
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.fs.LocalFileSystem$LocalFSFileInputStream.seek(LocalFileSystem.java:79) 
>>
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.fs.FSDataInputStream$Checker.seek(FSDataInputStream.java:67) 
>>
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.fs.FSDataInputStream$PositionCache.seek(FSDataInputStream.java:164) 
>>
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.fs.FSDataInputStream$Buffer.seek(FSDataInputStream.java:193) 
>>
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.fs.FSDataInputStream.seek(FSDataInputStream.java:243)
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.io.SequenceFile$Reader.seek(SequenceFile.java:420)
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.io.SequenceFile$Reader.sync(SequenceFile.java:431)
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.io.SequenceFile$Reader.handleChecksumException(SequenceFile.java:412) 
>>
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:389)
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:209)
>> 060411 202203 task_r_22esh3     at 
>> org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709)
>>
>> (Ignore line numbers.  My code is a little different from main 
>> because I've other debugging code inside in SequenceFile.  Otherwise 
>> I'm running w/ head of hadoop).
>>
>> The SequenceFile$Reader#handleChecksumException is trying to skip to 
>> next record but the file has been closed by the move-aside.
>>
>> Seems easy enough to add a 'if (this.fs.exists(new File(this.file)))' 
>> to check file is still in place before we try seeking to next record. 
>> I can make an issue and add a patch if wanted -- I need to test it 
>> works first -- but are others failing jobs with checksum errors?
>> Thanks,
>> St.Ack
>>
>>
>>
>>
>> Michael Stack wrote:
>>
>>> Stefan Groschupf wrote:
>>>
>>>> Hi Stack,
>>>> I tried that but sorry to say it does not solve the problem - also 
>>>> with the very latest hadoop update to nutch.
>>>
>>> Thanks for the pointer Stefan (I only just saw this -- over-zealous 
>>> spam filters).
>>>
>>> Yeah, the property 'io.skip.checksum.errors' is of no use to the 
>>> HADOOP-86 issue.  'io.skip.checksum.errors' effects SequenceFile 
>>> only. The ChecksumException was being thrown when we had a map 
>>> output file view on the map product rather than a sequence file view.
>>>
>>> But 'io.skip.checksum.errors' looks like a good idea for 
>>> SequenceFile.  In fact, I just had a job fail because of the below 
>>> 'java.io.IOException: Corrupt GZIP trailer'.  It happened 4 times in 
>>> a row.  The 'io.skip.checksum.errors' should be generalized to allow 
>>> skipping of the likes of this exception too it seems like.
>>>
>>> St.Ack
>>>
>>>
>>>
>>> 060323 204819 task_r_ack5c7 0.9615162% reduce > reduce
>>> 060323 204820 task_r_3rjkd7  Error running child
>>> 060323 204820 task_r_3rjkd7 java.lang.RuntimeException: 
>>> java.io.IOException: Corrupt GZIP trailer
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:132) 
>>>
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.mapred.lib.IdentityReducer.reduce(IdentityReducer.java:41) 
>>>
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:283)
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:703)
>>> 060323 204820 task_r_3rjkd7 Caused by: java.io.IOException: Corrupt 
>>> GZIP trailer
>>> 060323 204820 task_r_3rjkd7     at 
>>> java.util.zip.GZIPInputStream.readTrailer(GZIPInputStream.java:175)
>>> 060323 204820 task_r_3rjkd7     at 
>>> java.util.zip.GZIPInputStream.read(GZIPInputStream.java:89)
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.io.WritableUtils.readCompressedByteArray(WritableUtils.java:35) 
>>>
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.io.WritableUtils.readCompressedString(WritableUtils.java:70) 
>>>
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.nutch.parse.ParseText.readFields(ParseText.java:44)
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.nutch.parse.ParseImpl.readFields(ParseImpl.java:59)
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.nutch.parse.ParseImpl.read(ParseImpl.java:69)
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.nutch.fetcher.FetcherOutput.readFields(FetcherOutput.java:47) 
>>>
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:344)
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.getNext(ReduceTask.java:163) 
>>>
>>> 060323 204820 task_r_3rjkd7     at 
>>> org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:129) 
>>>
>>> 060323 204820 task_r_3rjkd7     ... 3 more
>>>
>>>
>>>>
>>>> @Doug as far I understand the latest update already contains this 
>>>> rollback "Reverted changes from 384385"?
>>>>
>>>> To summarize I'm not able to run just one larger hadoop job e.g. 
>>>> nutch fetching never worked.
>>>> Always one tasktracker hangs in the last 10 % of doing a reduce 
>>>> (some times it arrived 98 % ) than the task runs into a time out 
>>>> and is restarted again, fails, restarted, fails ...
>>>> After 4 fails the task in progress crash the complete job.
>>>>
>>>> There is just nothing in the log files, that gives any hint also I 
>>>> configured to ignore check sum exceptions.
>>>>
>>>> Any ideas where to search for the problem? It is very sad to throw 
>>>> a fetched segment with several million documents just to trash,
>>>>  since the last 3 % of reducing of one tasktracker fail.
>>>>
>>>> Thanks for any comments.
>>>> Stefan
>>>>
>>>>
>>>> Am 12.03.2006 um 03:33 schrieb Stefan Groschupf:
>>>>
>>>>> Hi Stack,
>>>>>
>>>>> try set the io.skip.checksum.errors to true in your hadoop-site.xml
>>>>>
>>>>> <property>
>>>>>   <name>io.skip.checksum.errors</name>
>>>>>   <value>false</value>
>>>>>   <description>If true, when a checksum error is encountered while
>>>>>   reading a sequence file, entries are skipped, instead of 
>>>>> throwing an
>>>>>   exception.</description>
>>>>> </property>
>>>>>
>>>>> This may be solve your problem but I agree that there should be a 
>>>>> smarter way than just ignoring it. :)
>>>>>
>>>>> Stefan
>>>>>
>>>>>
>>>>> Am 10.03.2006 um 20:22 schrieb stack:
>>>>>
>>>>>> On hadoop-users, I've described two recent hangs.  I'm writing 
>>>>>> here to dev because I'm looking for pointers on how best to 
>>>>>> conjure a fix with perhaps pointers to any existing facility I 
>>>>>> might exploit (I do not know the codebase well).
>>>>>>
>>>>>> In synopsis the problem goes as follows:
>>>>>>
>>>>>> If a reduce cannot pick up map outputs -- for example, the output 
>>>>>> has been moved aside because of a ChecksumException (See below 
>>>>>> stack trace) -- then the job gets stuck with the reduce task 
>>>>>> trying and failing every ten seconds or so to pick up the 
>>>>>> non-existent map output part.
>>>>>>
>>>>>> Somehow the reduce needs to give up and the jobtracker needs to 
>>>>>> rerun the map just as it would if the tasktracker had died 
>>>>>> completely.
>>>>>>
>>>>>> Thanks in advance for any pointers,
>>>>>> St.Ack
>>>>>>
>>>>>>
>>>>>> 060309 014426 Moving bad file 
>>>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out to
>>>>>> /0/bad_files/part-20.out.2002824050
>>>>>> 060309 014426 Server handler 0 on 50040 caught:
>>>>>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>>>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>>>>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>>>>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>>>>>      at
>>>>>> org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122) 
>>>>>>
>>>>>>      at
>>>>>> org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98) 
>>>>>>
>>>>>>      at
>>>>>> org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158) 
>>>>>>
>>>>>>      at 
>>>>>> java.io.BufferedInputStream.read1(BufferedInputStream.java:254)
>>>>>>      at 
>>>>>> java.io.BufferedInputStream.read(BufferedInputStream.java:313)
>>>>>>      at java.io.DataInputStream.read(DataInputStream.java:80)
>>>>>>      at 
>>>>>> org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:110)
>>>>>>      at
>>>>>> org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117) 
>>>>>>
>>>>>>      at 
>>>>>> org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>>>>>>      at org.apache.hadoop.ipc.Server$Handler.run(Server.java:215)
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> ---------------------------------------------
>>>>> blog: http://www.find23.org
>>>>> company: http://www.media-style.com
>>>>>
>>>>>
>>>>>
>>>>
>>>> ---------------------------------------------
>>>> blog: http://www.find23.org
>>>> company: http://www.media-style.com
>>>>
>>>>
>>>>
>>>
>>


From MAILER-DAEMON Wed Apr 12 01:51:40 2006
Return-Path: 
 <hadoop-dev-return-791-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80663 invoked from network); 12 Apr 2006 01:51:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 Apr 2006 01:51:40 -0000
Received: (qmail 14493 invoked by uid 500); 12 Apr 2006 01:51:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14388 invoked by uid 500); 12 Apr 2006 01:51:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14374 invoked by uid 99); 12 Apr 2006 01:51:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 18:51:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Apr 2006 18:51:39 -0700
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k3C0e3Z02989;
	Tue, 11 Apr 2006 17:40:03 -0700
Message-ID: <443C5D2E.8040105@archive.org>
Date: Tue, 11 Apr 2006 18:51:42 -0700
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: 'Corrupt GZIP trailer' and other irrecoverable IOEs.
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I had a job fail in SequenceFile$Reader#next because a record was 
corrupt.  Every attempt at reading failed with 'Corrupt GZIP trailer' 
(See stack trace on the end).  Looks like IOEs of this type -- i.e. 
irrecoverable IOEs -- need to have their maps rescheduled somehow.  One 
mechanism is to have this type of error report as an FSError.  Then the 
tasktracker will shut itself down take itself out of the pool of 
machines.  This is a little radical but should let the job complete. 

But I suppose its kinda tough distingushing the 'irrecoverables' from 
the 'recoverables' (e.g. timeouts). 

I've started trying to keep tabs.

Another 'irrecoverable'-looking IOEs that I've seen is the following:
...
060404 220614 task_r_3dd1gh  IOException null at 1294336. Skipping entries.
060404 220614 task_r_3dd1gh java.io.EOFException
060404 220614 task_r_3dd1gh     at 
java.io.DataInputStream.readFully(DataInputStream.java:178)
060404 220614 task_r_3dd1gh     at 
org.apache.hadoop.io.DataOutputBuffer$Buffer.write(DataOutputBuffer.java:56)
060404 220614 task_r_3dd1gh     at 
org.apache.hadoop.io.DataOutputBuffer.write(DataOutputBuffer.java:94)
060404 220614 task_r_3dd1gh     at 
org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:394)
060404 220614 task_r_3dd1gh     at 
org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:209)
060404 220614 task_r_3dd1gh     at 
org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709)

I've gotten this a good few times.  

I recently added 'keep-going' code that is like the handleChecksumError 
code in SequenceFile.  It tries to just skip over problematic IOE 
records/files.  Its made it more likely jobs will complete on our 
hardware but this is less than optimal for a couple of reasons:  1. It 
will skip records w/ recoverable IOEs, and 2.) It breaks the mapreduce 
'determinate' results property. 

Thanks,
St.Ack


Here's the GZIP exception I mentioned up top:

060323 180210 task_r_ack5c7 0.853471% reduce > reduce
060323 180210 task_r_2u5g4x  Error running child
060323 180210 task_r_g6d5ir 0.78022665% reduce > reduce
060323 180210 task_r_2u5g4x java.lang.RuntimeException: 
java.io.IOException: Corrupt GZIP trailer
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:132)
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.mapred.lib.IdentityReducer.reduce(IdentityReducer.java:41)
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:283)
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:703)
060323 180210 task_r_2u5g4x Caused by: java.io.IOException: Corrupt GZIP 
trailer
060323 180210 task_r_2u5g4x     at 
java.util.zip.GZIPInputStream.readTrailer(GZIPInputStream.java:175)
060323 180210 task_r_2u5g4x     at 
java.util.zip.GZIPInputStream.read(GZIPInputStream.java:89)
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.io.WritableUtils.readCompressedByteArray(WritableUtils.java:35)
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.io.WritableUtils.readCompressedString(WritableUtils.java:70)
060323 180210 task_r_2u5g4x     at 
org.apache.nutch.parse.ParseText.readFields(ParseText.java:44)
060323 180210 task_r_2u5g4x     at 
org.apache.nutch.parse.ParseImpl.readFields(ParseImpl.java:59)
060323 180210 task_r_2u5g4x     at 
org.apache.nutch.parse.ParseImpl.read(ParseImpl.java:69)
060323 180210 task_r_2u5g4x     at 
org.apache.nutch.fetcher.FetcherOutput.readFields(FetcherOutput.java:47)
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:344)
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.mapred.ReduceTask$ValuesIterator.getNext(ReduceTask.java:163)
060323 180210 task_r_2u5g4x     at 
org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:129)
060323 180210 task_r_2u5g4x     ... 3 more

From MAILER-DAEMON Wed Apr 12 19:48:16 2006
Return-Path: 
 <hadoop-dev-return-792-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77355 invoked from network); 12 Apr 2006 19:48:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 Apr 2006 19:48:16 -0000
Received: (qmail 15510 invoked by uid 500); 12 Apr 2006 19:48:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15401 invoked by uid 500); 12 Apr 2006 19:48:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15381 invoked by uid 99); 12 Apr 2006 19:48:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 12:48:14 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 12:48:13 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3CJlgbL003797
	for <hadoop-dev@lucene.apache.org>; Wed, 12 Apr 2006 15:47:44 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3CJliZr168448;
	Wed, 12 Apr 2006 15:47:46 -0400
Message-ID: <443D595F.3040008@apache.org>
Date: Wed, 12 Apr 2006 12:47:43 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org> <443C3F93.9090404@archive.org>
In-Reply-To: <443C3F93.9090404@archive.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Michael Stack wrote:
> One question: The 'io.skip.checksum.errors' is only read in 
> SequenceFile#next but the LocalFileSystem checksum error "move-aside" 
> handler can be triggered by other than just a call out of 
> SequenceFile#next.  If so, stopping the LocalFileSystem move-aside on 
> checksum error is probably not the right thing to do.

Right, we ideally want SequenceFile to disable it when that flag is set. 
  But that would take a lot of plumbing to implement!  Perhaps we should 
instead fix this by not closing the file in 
LocalFilesystem.reportChecksumFailure.  Then it won't be able to move 
the file aside on Windows.  To fix that, we can (1) try to move it 
without closing it (since something on the stack will eventually close 
it anyway, and may still need it open) and (2) if the move fails, try 
closing it and moving it (for Windows).  The net effect is that 
io.skip.checksum.errors will then work on Unix but not on Windows.  Or 
we could skip moving it altogether, since it seems that most checksum 
errors we're seeing are not disk errors but memory errors before the 
data hits the disk.

A checksum failure on a local file currently causes the task to fail. 
But it takes multiple checksum errors per job to get a job to fail, 
right?  Is that what's happening?  Your jobs frequently get four 
checksum failures?  Yikes!

Doug

From MAILER-DAEMON Wed Apr 12 20:25:57 2006
Return-Path: 
 <hadoop-dev-return-793-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97104 invoked from network); 12 Apr 2006 20:25:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 Apr 2006 20:25:57 -0000
Received: (qmail 57223 invoked by uid 500); 12 Apr 2006 20:25:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57070 invoked by uid 500); 12 Apr 2006 20:25:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57001 invoked by uid 99); 12 Apr 2006 20:25:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 13:25:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 13:25:44 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 60DB16ACAB
	for <hadoop-dev@lucene.apache.org>; Wed, 12 Apr 2006 21:25:23 +0100 (BST)
Message-ID: <410920239.1144873523393.JavaMail.jira@ajax>
Date: Wed, 12 Apr 2006 21:25:23 +0100 (BST)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-92) Error Reporting/logging in MapReduce
In-Reply-To: <136202795.1142570952505.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-92?page=all ]

Mahadev konar updated HADOOP-92:
--------------------------------

    Attachment: patch.txt

I am including a patch that improves upon the job tracker interface. The tipid is made clickable so that it shows all the attempts for a particular task with the machine name. I found it useful, so am uplodaing it again.

> Error Reporting/logging in MapReduce
> ------------------------------------
>
>          Key: HADOOP-92
>          URL: http://issues.apache.org/jira/browse/HADOOP-92
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: interface.patch, patch.txt
>
> Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 12 21:03:43 2006
Return-Path: 
 <hadoop-dev-return-794-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19593 invoked from network); 12 Apr 2006 21:03:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 Apr 2006 21:03:43 -0000
Received: (qmail 4588 invoked by uid 500); 12 Apr 2006 21:03:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4572 invoked by uid 500); 12 Apr 2006 21:03:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4559 invoked by uid 99); 12 Apr 2006 21:03:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 14:03:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 14:03:40 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id EB4EC6ACA9
	for <hadoop-dev@lucene.apache.org>; Wed, 12 Apr 2006 22:03:19 +0100 (BST)
Message-ID: <1689153833.1144875799961.JavaMail.jira@ajax>
Date: Wed, 12 Apr 2006 22:03:19 +0100 (BST)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-92) Error Reporting/logging in MapReduce
In-Reply-To: <136202795.1142570952505.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-92?page=comments#action_12374251 ] 

stack@archive.org commented on HADOOP-92:
-----------------------------------------

I took this patch for a spin.  +1 on commit.

> Error Reporting/logging in MapReduce
> ------------------------------------
>
>          Key: HADOOP-92
>          URL: http://issues.apache.org/jira/browse/HADOOP-92
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: interface.patch, patch.txt
>
> Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 12 21:20:42 2006
Return-Path: 
 <hadoop-dev-return-795-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28440 invoked from network); 12 Apr 2006 21:20:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 Apr 2006 21:20:42 -0000
Received: (qmail 30580 invoked by uid 500); 12 Apr 2006 21:20:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30566 invoked by uid 500); 12 Apr 2006 21:20:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30555 invoked by uid 99); 12 Apr 2006 21:20:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 14:20:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 14:20:40 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id EC81A6ACA9
	for <hadoop-dev@lucene.apache.org>; Wed, 12 Apr 2006 22:20:19 +0100 (BST)
Message-ID: <1384466671.1144876819966.JavaMail.jira@ajax>
Date: Wed, 12 Apr 2006 22:20:19 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-92) Error Reporting/logging in MapReduce
In-Reply-To: <136202795.1142570952505.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-92?page=comments#action_12374256 ] 

Owen O'Malley commented on HADOOP-92:
-------------------------------------

I've been using it today too. +1 on commit.

> Error Reporting/logging in MapReduce
> ------------------------------------
>
>          Key: HADOOP-92
>          URL: http://issues.apache.org/jira/browse/HADOOP-92
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: interface.patch, patch.txt
>
> Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 12 23:05:23 2006
Return-Path: 
 <hadoop-dev-return-796-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77073 invoked from network); 12 Apr 2006 23:05:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 Apr 2006 23:05:23 -0000
Received: (qmail 36529 invoked by uid 500); 12 Apr 2006 23:05:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36506 invoked by uid 500); 12 Apr 2006 23:05:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36497 invoked by uid 99); 12 Apr 2006 23:05:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 16:05:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Apr 2006 16:05:22 -0700
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2852ED4A02
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 00:05:01 +0100 (BST)
Message-ID: <673555922.1144883101161.JavaMail.jira@ajax>
Date: Thu, 13 Apr 2006 00:05:01 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-92) Error Reporting/logging in MapReduce
In-Reply-To: <136202795.1142570952505.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-92?page=all ]
     
Doug Cutting resolved HADOOP-92:
--------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Mahadev konar

This mostly looks good.  I committed it with the following changes:

1. TaskStatus is not a public class, so a public method in another public class should not return it.  For now, I just made the method package-private, since the jsp pages are compiled in the same package.  Longer-term we should probably copy this information into the TaskReport, the public version of a TaskStatus, or something.  This information should be available to other applications through a public API, and through an RPC in the JobSubmissionProtocol.

2. I renamed JobTracker.getallTaskStatus to be getTaskStatuses, like the JobInProgress method, and also using correct camel-case.

3. Rather than add a new TaskStatus contructor, leaving an old one that is no longer called, I removed the old one.  We don't need dead code around.  This is package-private, so we can be sure that no code outside of this package uses the old constructor.

4. The patch removed some inter-method whitespace.  I restored it.


> Error Reporting/logging in MapReduce
> ------------------------------------
>
>          Key: HADOOP-92
>          URL: http://issues.apache.org/jira/browse/HADOOP-92
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: interface.patch, patch.txt
>
> Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 17:16:03 2006
Return-Path: 
 <hadoop-dev-return-797-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 2635 invoked from network); 13 Apr 2006 17:16:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 17:16:03 -0000
Received: (qmail 87016 invoked by uid 500); 13 Apr 2006 17:15:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86972 invoked by uid 500); 13 Apr 2006 17:15:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86954 invoked by uid 99); 13 Apr 2006 17:15:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:15:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.brutus.apache.org)
 (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:15:51 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.brutus.apache.org (Postfix) with ESMTP id E699A7142B6
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 17:15:00 +0000 (GMT)
Message-ID: <57023267.1144948500942.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 17:15:00 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-128) Failure to replicate dfs block kills
 client
In-Reply-To: <1165287600.1144685998691.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-128?page=all ]

Owen O'Malley updated HADOOP-128:
---------------------------------

    Attachment: datanode-mirroring.patch

This patch changes the client so that:
   1. it has replication * 1 minute timeout for the block replicas to be written.
   2. improved logging, including the filename and remote hostname when things fail
   3. 

It patches the DataNode so that:
   1. Failures downstream (from the mirror nodes) never propagate back upstream.
   2. Improved logging including filenames and remote host names.
   3. the changes involve a lot of whitespace changes because of block changes, so i'll include a separate upload that ignores whitespaces.

> Failure to replicate dfs block kills client
> -------------------------------------------
>
>          Key: HADOOP-128
>          URL: http://issues.apache.org/jira/browse/HADOOP-128
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>  Environment: ~200 node linux cluster (kernel 2.6, redhat, 2 hyper threaded cpus)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: datanode-mirroring.patch
>
> When the datanode gets an exception, which is logged as:
> 060407 155835 13 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:462)
>         at java.lang.Thread.run(Thread.java:595)
> It closes the user's connection to the data node, which causes the client to get an IOException from:
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:883)
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 17:17:57 2006
Return-Path: 
 <hadoop-dev-return-798-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4261 invoked from network); 13 Apr 2006 17:17:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 17:17:57 -0000
Received: (qmail 92286 invoked by uid 500); 13 Apr 2006 17:17:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92226 invoked by uid 500); 13 Apr 2006 17:17:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92174 invoked by uid 99); 13 Apr 2006 17:17:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:17:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.brutus.apache.org)
 (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:17:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.brutus.apache.org (Postfix) with ESMTP id B74EC7142BA
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 17:17:01 +0000 (GMT)
Message-ID: <66142668.1144948621748.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 17:17:01 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-128) Failure to replicate dfs block kills
 client
In-Reply-To: <1165287600.1144685998691.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-128?page=all ]

Owen O'Malley updated HADOOP-128:
---------------------------------

    Attachment: datanode.no-ws-diff

These are the diffs to DataNode.java ignoring whitespaces.

> Failure to replicate dfs block kills client
> -------------------------------------------
>
>          Key: HADOOP-128
>          URL: http://issues.apache.org/jira/browse/HADOOP-128
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>  Environment: ~200 node linux cluster (kernel 2.6, redhat, 2 hyper threaded cpus)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: datanode-mirroring.patch, datanode.no-ws-diff
>
> When the datanode gets an exception, which is logged as:
> 060407 155835 13 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:462)
>         at java.lang.Thread.run(Thread.java:595)
> It closes the user's connection to the data node, which causes the client to get an IOException from:
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:883)
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 17:17:57 2006
Return-Path: 
 <hadoop-dev-return-799-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4263 invoked from network); 13 Apr 2006 17:17:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 17:17:57 -0000
Received: (qmail 92543 invoked by uid 500); 13 Apr 2006 17:17:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92478 invoked by uid 500); 13 Apr 2006 17:17:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92439 invoked by uid 99); 13 Apr 2006 17:17:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:17:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.brutus.apache.org)
 (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:17:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.brutus.apache.org (Postfix) with ESMTP id 7FE1B7142BB
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 17:17:02 +0000 (GMT)
Message-ID: <66481332.1144948622521.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 17:17:02 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-128) Failure to replicate dfs block kills
 client
In-Reply-To: <1165287600.1144685998691.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-128?page=comments#action_12374375 ] 

Owen O'Malley commented on HADOOP-128:
--------------------------------------

The read and write block functionality needs to be factored out of the huge if/then/else. I'll open a new bug for that.

> Failure to replicate dfs block kills client
> -------------------------------------------
>
>          Key: HADOOP-128
>          URL: http://issues.apache.org/jira/browse/HADOOP-128
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>  Environment: ~200 node linux cluster (kernel 2.6, redhat, 2 hyper threaded cpus)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: datanode-mirroring.patch, datanode.no-ws-diff
>
> When the datanode gets an exception, which is logged as:
> 060407 155835 13 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:462)
>         at java.lang.Thread.run(Thread.java:595)
> It closes the user's connection to the data node, which causes the client to get an IOException from:
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:883)
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 17:20:53 2006
Return-Path: 
 <hadoop-dev-return-800-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6716 invoked from network); 13 Apr 2006 17:20:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 17:20:53 -0000
Received: (qmail 99485 invoked by uid 500); 13 Apr 2006 17:20:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99375 invoked by uid 500); 13 Apr 2006 17:20:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99366 invoked by uid 99); 13 Apr 2006 17:20:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:20:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.brutus.apache.org)
 (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:20:51 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.brutus.apache.org (Postfix) with ESMTP id 16B807142BA
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 17:20:01 +0000 (GMT)
Message-ID: <48202252.1144948801084.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 17:20:01 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-128) Failure to replicate dfs block kills
 client
In-Reply-To: <1165287600.1144685998691.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-128?page=all ]

Owen O'Malley updated HADOOP-128:
---------------------------------

    Attachment: conf.patch

I forgot the default value for the retries value.

> Failure to replicate dfs block kills client
> -------------------------------------------
>
>          Key: HADOOP-128
>          URL: http://issues.apache.org/jira/browse/HADOOP-128
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>  Environment: ~200 node linux cluster (kernel 2.6, redhat, 2 hyper threaded cpus)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: conf.patch, datanode-mirroring.patch, datanode.no-ws-diff
>
> When the datanode gets an exception, which is logged as:
> 060407 155835 13 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:462)
>         at java.lang.Thread.run(Thread.java:595)
> It closes the user's connection to the data node, which causes the client to get an IOException from:
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:883)
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 17:40:51 2006
Return-Path: 
 <hadoop-dev-return-801-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 22319 invoked from network); 13 Apr 2006 17:40:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 17:40:51 -0000
Received: (qmail 52878 invoked by uid 500); 13 Apr 2006 17:40:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52766 invoked by uid 500); 13 Apr 2006 17:40:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52757 invoked by uid 99); 13 Apr 2006 17:40:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:40:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:40:48 -0700
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k3DGT7Z20613;
	Thu, 13 Apr 2006 09:29:07 -0700
Message-ID: <443E8D24.7000206@archive.org>
Date: Thu, 13 Apr 2006 10:40:52 -0700
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org> <443C3F93.9090404@archive.org>
 <443D595F.3040008@apache.org>
In-Reply-To: <443D595F.3040008@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> Michael Stack wrote:
>> One question: The 'io.skip.checksum.errors' is only read in 
>> SequenceFile#next but the LocalFileSystem checksum error "move-aside" 
>> handler can be triggered by other than just a call out of 
>> SequenceFile#next.  If so, stopping the LocalFileSystem move-aside on 
>> checksum error is probably not the right thing to do.
>
> Right, we ideally want SequenceFile to disable it when that flag is 
> set.  But that would take a lot of plumbing to implement!  
Yes.
> Perhaps we should instead fix this by not closing the file in 
> LocalFilesystem.reportChecksumFailure.  Then it won't be able to move 
> the file aside on Windows.  To fix that, we can (1) try to move it 
> without closing it (since something on the stack will eventually close 
> it anyway, and may still need it open) and (2) if the move fails, try 
> closing it and moving it (for Windows).  The net effect is that 
> io.skip.checksum.errors will then work on Unix but not on Windows.  Or 
> we could skip moving it altogether, since it seems that most checksum 
> errors we're seeing are not disk errors but memory errors before the 
> data hits the disk. 
What if we did not move the file?  A checksum error would be thrown.  If 
we're inside SequenceFile#next and 'io.skip.checksum.errors' is set, 
then we'll just try to move to next record.  I do not have the 
experience with the code base to know if not-moving will manufacture 
weird scenarios elsewhere in the code base.
>
> A checksum failure on a local file currently causes the task to fail. 
> But it takes multiple checksum errors per job to get a job to fail, 
> right?  Is that what's happening?  
It is.  Jobs are long-running -- a day or more (I should probably try 
cutting them into smaller pieces).  What I usually see is a failure for 
some genuinely odd reason.  Then the task lands on a machine that has 
started to exhibit checksum errors.  After each failure, the task is 
rescheduled and it always seems to land back at the problematic machine 
(Anything I can do about randomizing the machine a task gets assigned too?).

St.Ack

From MAILER-DAEMON Thu Apr 13 17:46:53 2006
Return-Path: 
 <hadoop-dev-return-802-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26407 invoked from network); 13 Apr 2006 17:46:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 17:46:53 -0000
Received: (qmail 72968 invoked by uid 500); 13 Apr 2006 17:46:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72951 invoked by uid 500); 13 Apr 2006 17:46:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72942 invoked by uid 99); 13 Apr 2006 17:46:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:46:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.brutus.apache.org)
 (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:46:51 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.brutus.apache.org (Postfix) with ESMTP id E3B817142BA
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 17:46:00 +0000 (GMT)
Message-ID: <51356659.1144950360930.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 17:46:00 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-128) Failure to replicate dfs block kills
 client
In-Reply-To: <1165287600.1144685998691.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-128?page=all ]
     
Doug Cutting resolved HADOOP-128:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.

I note that you increased the timeout in the client, presumably to account for timeouts down the replication chain.  But shouldn't we then also increase the timeout in the datanode when it connects to the next link in the chain?  It didn't look like you added that.

+1 for refactoring this (in another patch).  The logic of this is hard to follow!


> Failure to replicate dfs block kills client
> -------------------------------------------
>
>          Key: HADOOP-128
>          URL: http://issues.apache.org/jira/browse/HADOOP-128
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>  Environment: ~200 node linux cluster (kernel 2.6, redhat, 2 hyper threaded cpus)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: conf.patch, datanode-mirroring.patch, datanode.no-ws-diff
>
> When the datanode gets an exception, which is logged as:
> 060407 155835 13 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:462)
>         at java.lang.Thread.run(Thread.java:595)
> It closes the user's connection to the data node, which causes the client to get an IOException from:
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:883)
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 17:50:11 2006
Return-Path: 
 <hadoop-dev-return-803-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29013 invoked from network); 13 Apr 2006 17:50:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 17:50:11 -0000
Received: (qmail 81863 invoked by uid 500); 13 Apr 2006 17:50:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81839 invoked by uid 500); 13 Apr 2006 17:50:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81830 invoked by uid 99); 13 Apr 2006 17:50:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:50:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:50:09 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3DHn1bk022704
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 13:49:05 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3DHnU4M141788;
	Thu, 13 Apr 2006 13:49:35 -0400
Message-ID: <443E8F29.6060309@apache.org>
Date: Thu, 13 Apr 2006 10:49:29 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org> <443C3F93.9090404@archive.org>
 <443D595F.3040008@apache.org> <443E8D24.7000206@archive.org>
In-Reply-To: <443E8D24.7000206@archive.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Michael Stack wrote:
> What if we did not move the file?  A checksum error would be thrown.  If 
> we're inside SequenceFile#next and 'io.skip.checksum.errors' is set, 
> then we'll just try to move to next record.  I do not have the 
> experience with the code base to know if not-moving will manufacture 
> weird scenarios elsewhere in the code base.

The reason for the move is that, if the file lies on a bad disk block, 
we don't want to remove it, we want to keep it around so that that block 
is not reused.  Local files are normally removed at the end of the job, 
but files in the bad_file directory are never automatically removed.

In your case I don't think moving the files is helping at all, since the 
checksum errors are not caused by bad disk blocks, but rather by memory 
errors.  So not moving is fine.  Maybe we should add a config parameter 
to disable moving on checksum error?

> Then the task lands on a machine that has 
> started to exhibit checksum errors.  After each failure, the task is 
> rescheduled and it always seems to land back at the problematic machine 
> (Anything I can do about randomizing the machine a task gets assigned 
> too?).

I think the job tracker now has logic that tries to prevent a task from 
being re-assigned to a node that it has previously failed on.  Either 
that logic is buggy, or you're running an older version.

Doug

From MAILER-DAEMON Thu Apr 13 17:59:58 2006
Return-Path: 
 <hadoop-dev-return-804-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36399 invoked from network); 13 Apr 2006 17:59:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 17:59:58 -0000
Received: (qmail 3080 invoked by uid 500); 13 Apr 2006 17:59:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3032 invoked by uid 500); 13 Apr 2006 17:59:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2990 invoked by uid 99); 13 Apr 2006 17:59:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:59:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 10:59:15 -0700
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k3DGlaZ21814;
	Thu, 13 Apr 2006 09:47:36 -0700
Message-ID: <443E9179.4020702@archive.org>
Date: Thu, 13 Apr 2006 10:59:21 -0700
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org> <443C3F93.9090404@archive.org>
 <443D595F.3040008@apache.org> <443E8D24.7000206@archive.org>
 <443E8F29.6060309@apache.org>
In-Reply-To: <443E8F29.6060309@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> ...
> The reason for the move is that, if the file lies on a bad disk block, 
> we don't want to remove it, we want to keep it around so that that 
> block is not reused.  Local files are normally removed at the end of 
> the job, but files in the bad_file directory are never automatically 
> removed.

Makes sense.
>
> In your case I don't think moving the files is helping at all, since 
> the checksum errors are not caused by bad disk blocks, but rather by 
> memory errors.  So not moving is fine.  Maybe we should add a config 
> parameter to disable moving on checksum error?
>

Let me try this.  Should probably subsume the 'io.skip.checksum.errors' 
parameter.

>> Then the task lands on a machine that has started to exhibit checksum 
>> errors.  After each failure, the task is rescheduled and it always 
>> seems to land back at the problematic machine (Anything I can do 
>> about randomizing the machine a task gets assigned too?).
>
> I think the job tracker now has logic that tries to prevent a task 
> from being re-assigned to a node that it has previously failed on.  
> Either that logic is buggy, or you're running an older version.

I'm using latest.  Will also take a look into why tasks keep going back 
to same machine.

St.Ack

From MAILER-DAEMON Thu Apr 13 18:01:54 2006
Return-Path: 
 <hadoop-dev-return-805-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37510 invoked from network); 13 Apr 2006 18:01:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 18:01:54 -0000
Received: (qmail 12497 invoked by uid 500); 13 Apr 2006 18:01:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12478 invoked by uid 500); 13 Apr 2006 18:01:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12457 invoked by uid 99); 13 Apr 2006 18:01:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 11:01:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 11:01:52 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3DI1YBf009762
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 14:01:34 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3DI1O8e059834;
	Thu, 13 Apr 2006 14:01:27 -0400
Message-ID: <443E91F3.9000807@apache.org>
Date: Thu, 13 Apr 2006 11:01:23 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: tasktracker heartbeat interval
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Currently, pseudo-distributed mode is *much* slower than "local" mode. 
It makes sense that running a trivial task on 100 nodes might take 
longer than running it standalone, but running it on one node over 
localhost should not be that much slower.  In part this is due to task 
jvm startup time, but I think the larger part of the blame is heartbeat 
intervals.

The tasktracker polls for new tasks only every heartbeat interval.  When 
running small jobs in small clusters, this interval dominates 
performance.  But in larger clusters a short heartbeat interval would 
overload the jobtracker.  Perhaps the tasktracker should instead get its 
heartbeat interval from the jobtracker.  The jobtracker could return a 
small interval when few tasktrackers are known, and a larger interval 
when lots of tasktrackers are known.  This would make small clusters 
more responsive.

One could use a similar mechanism in dfs.

This is a very low priority issue that I just wanted to get out of my head.

Doug

From MAILER-DAEMON Thu Apr 13 20:13:52 2006
Return-Path: 
 <hadoop-dev-return-806-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33952 invoked from network); 13 Apr 2006 20:13:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 20:13:52 -0000
Received: (qmail 83449 invoked by uid 500); 13 Apr 2006 20:13:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83428 invoked by uid 500); 13 Apr 2006 20:13:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83419 invoked by uid 99); 13 Apr 2006 20:13:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 13:13:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 13:13:51 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 38F46714290
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 20:13:00 +0000 (GMT)
Message-ID: <36182056.1144959180230.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 20:13:00 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-132) An API for reporting performance
 metrics
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

An API for reporting performance metrics
----------------------------------------

         Key: HADOOP-132
         URL: http://issues.apache.org/jira/browse/HADOOP-132
     Project: Hadoop
        Type: New Feature

    Reporter: David Bowen



I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.

I'd be very interested in people's thoughts about what the requirements should be for such an API.

- David Bowen


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 20:15:53 2006
Return-Path: 
 <hadoop-dev-return-807-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34781 invoked from network); 13 Apr 2006 20:15:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 20:15:53 -0000
Received: (qmail 86413 invoked by uid 500); 13 Apr 2006 20:15:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86303 invoked by uid 500); 13 Apr 2006 20:15:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86294 invoked by uid 99); 13 Apr 2006 20:15:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 13:15:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 13:15:51 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D7E1A714290
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 20:15:00 +0000 (GMT)
Message-ID: <55698623.1144959300880.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 20:15:00 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]

David Bowen updated HADOOP-132:
-------------------------------

    Attachment: javadoc.tgz

Here is the proposed javadoc.  Comments on the API are welcome also.


> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Reporter: David Bowen
>  Attachments: javadoc.tgz
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 21:10:52 2006
Return-Path: 
 <hadoop-dev-return-808-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63581 invoked from network); 13 Apr 2006 21:10:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 21:10:52 -0000
Received: (qmail 71240 invoked by uid 500); 13 Apr 2006 21:10:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71214 invoked by uid 500); 13 Apr 2006 21:10:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71205 invoked by uid 99); 13 Apr 2006 21:10:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 14:10:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 14:10:51 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3C032714294
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 21:10:00 +0000 (GMT)
Message-ID: <83642710.1144962600236.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 21:10:00 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

the TaskTracker.Child.ping thread calls exit
--------------------------------------------

         Key: HADOOP-133
         URL: http://issues.apache.org/jira/browse/HADOOP-133
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 21:41:58 2006
Return-Path: 
 <hadoop-dev-return-809-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79461 invoked from network); 13 Apr 2006 21:41:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 21:41:58 -0000
Received: (qmail 18974 invoked by uid 500); 13 Apr 2006 21:41:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18923 invoked by uid 500); 13 Apr 2006 21:41:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18765 invoked by uid 99); 13 Apr 2006 21:41:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 14:41:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 14:41:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B29E17142A5
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 21:41:01 +0000 (GMT)
Message-ID: <84183388.1144964461729.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 21:41:01 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374421 ] 

Doug Cutting commented on HADOOP-133:
-------------------------------------

We can't always rely on cleanup/finally stuff to run.  JVMs can exit unexpectedly.  We hope it doesn't happen often, but we must be able to handle that situation.  If we need to, e.g., clean up temp files, we do that on startup.

The reason this was added was to handle the case where the tasktracker has exited and the child is somehow hung.  We must not leave stray, hung, JVMs around.  Thread.interrupt() is not reliable enough.  When a thread is hung, it will not recieve an interrupt.  I've seen this frequently when fetching, where socket read()  requests hang indefinitely, despite the socket having a short read timeout.

So I'd be happy to have this first try to exit more gracefully, but, after a time, it should still call exit().  The child processes do not have a pid file.  Once their parent has died, nothing tracks them, so they must reliably exit fairly quickly when their parent dies.

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 21:47:53 2006
Return-Path: 
 <hadoop-dev-return-810-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83303 invoked from network); 13 Apr 2006 21:47:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 21:47:53 -0000
Received: (qmail 34389 invoked by uid 500); 13 Apr 2006 21:47:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34372 invoked by uid 500); 13 Apr 2006 21:47:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34363 invoked by uid 99); 13 Apr 2006 21:47:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 14:47:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 14:47:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 10804714291
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 21:47:01 +0000 (GMT)
Message-ID: <76589417.1144964821064.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 21:47:01 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-118) Namenode does not always clean up
 pendingCreates
In-Reply-To: <1720783348.1144168243567.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-118?page=all ]

Owen O'Malley updated HADOOP-118:
---------------------------------

    Attachment: release-create-locks.patch

This patch 
  1. registers DFS Clients onto a list to be close when the jvm exits. 
  2. makes closing a DFSClient call abandonFileCreate on each file that was not finished.
  3. it throws an exception if the client is used after it is closed.
  4. removes the close done by the JobClient
  5. adds the lease holder to the abandonFileInProgress message. This allows  the host's lease to be cleaned up as well as detecting attempts to abandon other clients files.

> Namenode does not always clean up pendingCreates
> ------------------------------------------------
>
>          Key: HADOOP-118
>          URL: http://issues.apache.org/jira/browse/HADOOP-118
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>  Environment: 195 node cluster running redhat linux (2.6 kernel)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: release-create-locks.patch
>
> In some failure modes, the pending creates list is not cleaned up and prevents that file from ever being created.
> When I try to create the file after the first job was killed (hours previously), I get:
> 060404 084619 Cannot start file because pendingCreates is non-null. src=/user/oom/rand/part000118
> 060404 084619 Server handler 0 on 8020 call error: java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
> java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
>         at org.apache.hadoop.dfs.NameNode.create(NameNode.java:147)
>         at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 22:12:48 2006
Return-Path: 
 <hadoop-dev-return-811-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97417 invoked from network); 13 Apr 2006 22:12:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 22:12:48 -0000
Received: (qmail 75748 invoked by uid 500); 13 Apr 2006 22:12:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75728 invoked by uid 500); 13 Apr 2006 22:12:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75719 invoked by uid 99); 13 Apr 2006 22:12:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:12:47 -0700
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=DNS_FROM_RFC_ABUSE
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.172.126.3] (HELO qmail.webpipe.net) (63.172.126.3)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:12:47 -0700
Received: (qmail 7097 invoked by uid 509); 13 Apr 2006 16:12:21 -0600
Received: from 205.244.47.55 by qmail.webpipe.net (envelope-from
 <michaelnelson@earthlink.net>, uid 507) with qmail-scanner-1.25-st-qms
 (clamdscan: 0.88/1243. perlscan: 1.25-st-qms.  
 Clear:RC:1(205.244.47.55):.
 Processed in 0.044232 secs); 13 Apr 2006 22:12:21 -0000
X-Antivirus-Webpipe-Mail-From: michaelnelson@earthlink.net via
 qmail.webpipe.net
X-Antivirus-Webpipe: 1.25-st-qms (Clear:RC:1(205.244.47.55):. Processed in
 0.044232 secs Process 7087)
Received: from web12.webpipe.net (HELO ?127.0.0.1?)
 (michaelnelson@205.244.47.55)
  by qmail.webpipe.net with SMTP; 13 Apr 2006 16:12:21 -0600
Message-ID: <443ECCC3.5080804@earthlink.net>
Date: Thu, 13 Apr 2006 16:12:19 -0600
From: Michael Nelson <michaelnelson@earthlink.net>
User-Agent: Thunderbird 1.5 (X11/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: tasktracker heartbeat interval
References: <443E91F3.9000807@apache.org>
In-Reply-To: <443E91F3.9000807@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I've been playing with a 6 node cluster to test the feasibility of using 
hadoop to deal with a large data set we have been struggling to 
comprehend (7TB). I have understood all along that I would need a much 
larger cluster if we decided to go ahead with hadoop but I must say that 
my initial reaction was that there was a lot of communication overhead. 
I suspect the change you have described would have lead to a much 
different first impression.

Doug Cutting wrote:
> Currently, pseudo-distributed mode is *much* slower than "local" mode. 
> It makes sense that running a trivial task on 100 nodes might take 
> longer than running it standalone, but running it on one node over 
> localhost should not be that much slower.  In part this is due to task 
> jvm startup time, but I think the larger part of the blame is heartbeat 
> intervals.
> 
> The tasktracker polls for new tasks only every heartbeat interval.  When 
> running small jobs in small clusters, this interval dominates 
> performance.  But in larger clusters a short heartbeat interval would 
> overload the jobtracker.  Perhaps the tasktracker should instead get its 
> heartbeat interval from the jobtracker.  The jobtracker could return a 
> small interval when few tasktrackers are known, and a larger interval 
> when lots of tasktrackers are known.  This would make small clusters 
> more responsive.
> 
> One could use a similar mechanism in dfs.
> 
> This is a very low priority issue that I just wanted to get out of my head.
> 
> Doug
> 


From MAILER-DAEMON Thu Apr 13 22:15:53 2006
Return-Path: 
 <hadoop-dev-return-812-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 539 invoked from network); 13 Apr 2006 22:15:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 22:15:53 -0000
Received: (qmail 85469 invoked by uid 500); 13 Apr 2006 22:15:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85446 invoked by uid 500); 13 Apr 2006 22:15:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85437 invoked by uid 99); 13 Apr 2006 22:15:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:15:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:15:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E267B71428F
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 22:15:00 +0000 (GMT)
Message-ID: <78441352.1144966500925.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 22:15:00 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374423 ] 

Owen O'Malley commented on HADOOP-133:
--------------------------------------

Ok, I can see wanting to try gently first and then pull out the exit sledgehammer if it doesn't work.

Checking back with the taskTracker once a second seems too frequent.

I'd also propose changing the ping message to return a boolean that means the task should exit, so that IOException can mean that there was a communication error. If there is a communication error, it would make sense to retry a few times.

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 22:22:12 2006
Return-Path: 
 <hadoop-dev-return-813-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4136 invoked from network); 13 Apr 2006 22:22:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 22:22:12 -0000
Received: (qmail 95551 invoked by uid 500); 13 Apr 2006 22:21:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 95395 invoked by uid 500); 13 Apr 2006 22:21:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 95277 invoked by uid 99); 13 Apr 2006 22:21:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:21:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:21:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 40DD671428F
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 22:21:02 +0000 (GMT)
Message-ID: <30284872.1144966862261.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 22:21:02 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-132?page=comments#action_12374426 ] 

stack@archive.org commented on HADOOP-132:
------------------------------------------

Looks good.  Would be sweet having job progress show in Ganglia.  Metrics would run on every slave?

I'd suggest that MetricsRecord and guages need descriptions (Adding to Record would be easy enough -- harder to guage going by your API so far).  Would come in handy in an admin page listing available records and their guages.  if they had descriptions, then Record could be roughly mapped to jmx MBean and gauge to jmx Attribute.

> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Reporter: David Bowen
>  Attachments: javadoc.tgz
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 22:45:59 2006
Return-Path: 
 <hadoop-dev-return-814-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15545 invoked from network); 13 Apr 2006 22:45:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 22:45:59 -0000
Received: (qmail 24393 invoked by uid 500); 13 Apr 2006 22:45:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24372 invoked by uid 500); 13 Apr 2006 22:45:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24362 invoked by uid 99); 13 Apr 2006 22:45:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:45:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:45:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E5439714291
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 22:45:00 +0000 (GMT)
Message-ID: <84758869.1144968300930.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 22:45:00 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374428 ] 

Doug Cutting commented on HADOOP-133:
-------------------------------------

Sure, that would be safer, but recall that this communication is all on the same host.  A tasktracker shouldn't have more than a handful of children, so per second pings should not be a great burden.  And communications problems to localhost seem unlikely.  I've seen nodes with loads over 100, timing out all sorts of requests from other hosts, and I've never seen "Parent died" logged when a tasktracker was really still alive.  But, still, it shouldn't hurt to try a few times.

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 22:55:54 2006
Return-Path: 
 <hadoop-dev-return-815-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24519 invoked from network); 13 Apr 2006 22:55:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 22:55:54 -0000
Received: (qmail 45419 invoked by uid 500); 13 Apr 2006 22:55:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 45200 invoked by uid 500); 13 Apr 2006 22:55:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 45147 invoked by uid 99); 13 Apr 2006 22:55:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:55:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 15:55:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 44880714290
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 22:55:01 +0000 (GMT)
Message-ID: <63946451.1144968901272.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 22:55:01 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374429 ] 

Doug Cutting commented on HADOOP-133:
-------------------------------------

That said, it's possible that the exit() somehow swallows the "Parent died" message and all that we see is the "Child died with nonzero exit status" message.  We do see those more than we'd like.  I don't see how the message could get swallowed, however.  The parent has a thread reading the standard error of the child to EOF.  The logged message should get flushed to standard error before the child process exits.  And the kernel shouldn't throw away the last buffer written when a process exits.  So I doubt that's happening.

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 23:08:22 2006
Return-Path: 
 <hadoop-dev-return-816-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30957 invoked from network); 13 Apr 2006 23:08:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 23:08:22 -0000
Received: (qmail 56544 invoked by uid 500); 13 Apr 2006 23:08:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56515 invoked by uid 500); 13 Apr 2006 23:08:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56503 invoked by uid 99); 13 Apr 2006 23:08:21 -0000
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 16:08:21 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DDBC7714291
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 23:07:00 +0000 (GMT)
Message-ID: <64794852.1144969620905.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 23:07:00 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-132?page=comments#action_12374432 ] 

Doug Cutting commented on HADOOP-132:
-------------------------------------

A nit: the code should be in package org.apache.hadoop.metrics, not org.hadoop.metrics.

> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Reporter: David Bowen
>  Attachments: javadoc.tgz
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 23:43:50 2006
Return-Path: 
 <hadoop-dev-return-817-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45543 invoked from network); 13 Apr 2006 23:43:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 23:43:50 -0000
Received: (qmail 83501 invoked by uid 500); 13 Apr 2006 23:43:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83156 invoked by uid 500); 13 Apr 2006 23:43:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83109 invoked by uid 99); 13 Apr 2006 23:43:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 16:43:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 16:18:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ED2DD714292
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 23:18:00 +0000 (GMT)
Message-ID: <32646678.1144970280969.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 23:18:00 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374433 ] 

Owen O'Malley commented on HADOOP-133:
--------------------------------------

I've been assuming that the "Child died with nonzero exit status" with no other error messages is coming from the failure of a ping. I will change that message to include the actual exit status and change the ping-failure exit code to 123 or something.

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 23:56:02 2006
Return-Path: 
 <hadoop-dev-return-818-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53377 invoked from network); 13 Apr 2006 23:56:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 23:56:02 -0000
Received: (qmail 6487 invoked by uid 500); 13 Apr 2006 23:51:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6463 invoked by uid 500); 13 Apr 2006 23:51:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6447 invoked by uid 99); 13 Apr 2006 23:51:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 16:51:56 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 16:51:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E234A71428D
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 23:51:00 +0000 (GMT)
Message-ID: <68057830.1144972260921.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 23:51:00 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374441 ] 

Doug Cutting commented on HADOOP-133:
-------------------------------------

Sounds like a good plan.

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 13 23:59:52 2006
Return-Path: 
 <hadoop-dev-return-819-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54803 invoked from network); 13 Apr 2006 23:59:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Apr 2006 23:59:52 -0000
Received: (qmail 29949 invoked by uid 500); 13 Apr 2006 23:59:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29926 invoked by uid 500); 13 Apr 2006 23:59:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29912 invoked by uid 99); 13 Apr 2006 23:59:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 16:59:52 -0700
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 16:59:51 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3960471428F
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 23:59:00 +0000 (GMT)
Message-ID: <35583916.1144972740231.JavaMail.jira@brutus>
Date: Thu, 13 Apr 2006 23:59:00 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-134) JobTracker trapped in a loop if it
 fails to localize a task
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

JobTracker trapped in a loop if it fails to localize a task
-----------------------------------------------------------

         Key: HADOOP-134
         URL: http://issues.apache.org/jira/browse/HADOOP-134
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.0    
    Reporter: Runping Qi



The symptoms:

    When I ran  jobs on a big cluster, I noticed that some jobs got stucked. Some map tasks never got started. When I look at the log of the task tracker responsible for the tasks, I saw the following exceptions:

060413 160702 Lost connection to JobTracker [kry1040/72.30.116.100:50020].  Retrying...
java.io.IOException: No valid local directories in property: mapred.local.dir
        at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:282)
        at org.apache.hadoop.mapred.JobConf.getLocalFile(JobConf.java:127)
        at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:391)
        at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.<init>(TaskTracker.java:383)
        at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:270)
        at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:336)
        at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:756)

The reason for the exception is that the directory hadoop/mapred/local has "wrong" owner, thus the task tracker cannot access to it.
This caused the task tracker stucked into the following loops:

            while (running) {
                boolean staleState = false;
                try {
                    // This while-loop attempts reconnects if we get network errors
                    while (running && ! staleState) {
                        try {
                            if (offerService() == STALE_STATE) {
                                staleState = true;
                            }
                        } catch (Exception ex) {
                            LOG.log(Level.INFO, "Lost connection to JobTracker [" + jobTrackAddr + "].  Retrying...", ex);
                            try {
                                Thread.sleep(5000);
                            } catch (InterruptedException ie) {
                            }
                        }
                    }
                } finally {
                    close();
                }
                LOG.info("Reinitializing local state");
                initialize();
            }

Issue 1:
    Method offerService() must catch and handle the exceptions that may be thrown from new TaskInProgress() call, and report back to the job tracker if it cannot run the task. This way, the task can be assigned to other task tracker.

Issue 2:
    The taskTracker should check whether it can access to the local dir at the initialization time, before taking any tasks.


Runping


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 14 00:29:55 2006
Return-Path: 
 <hadoop-dev-return-820-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65258 invoked from network); 14 Apr 2006 00:29:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Apr 2006 00:29:55 -0000
Received: (qmail 53915 invoked by uid 500); 14 Apr 2006 00:29:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53879 invoked by uid 500); 14 Apr 2006 00:29:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53865 invoked by uid 99); 14 Apr 2006 00:29:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 17:29:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 17:29:51 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 426AC71428F
	for <hadoop-dev@lucene.apache.org>; Fri, 14 Apr 2006 00:29:00 +0000 (GMT)
Message-ID: <69894223.1144974540263.JavaMail.jira@brutus>
Date: Fri, 14 Apr 2006 00:29:00 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-135) Potential deadlock in JobTracker.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Potential deadlock in JobTracker.
---------------------------------

         Key: HADOOP-135
         URL: http://issues.apache.org/jira/browse/HADOOP-135
     Project: Hadoop
        Type: Bug

    Reporter: Konstantin Shvachko


org.apache.hadoop.mapred.JobTracker.RetireJobs.run()
locks resources in this order
                synchronized (jobs) {
                    synchronized (jobInitQueue) {
                        synchronized (jobsByArrival) {

org.apache.hadoop.mapred.JobTracker.submitJob()
locks resources in a different order
        synchronized (jobs) {
            synchronized (jobsByArrival) {
                synchronized (jobInitQueue) {

This potentially can lead to a deadlock.
Unless there is common lock on top of it in which case these
three locks are redundant.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 14 02:19:45 2006
Return-Path: 
 <hadoop-dev-return-821-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28841 invoked from network); 14 Apr 2006 02:19:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Apr 2006 02:19:45 -0000
Received: (qmail 38430 invoked by uid 500); 14 Apr 2006 02:19:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38397 invoked by uid 500); 14 Apr 2006 02:19:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38388 invoked by uid 99); 14 Apr 2006 02:19:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 19:19:44 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 19:19:43 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3E2IYqH019448
	for <hadoop-dev@lucene.apache.org>; Thu, 13 Apr 2006 19:18:34 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:content-type;
	b=zhLhYANO4ZWxDdFaM52YykBix+O+23Heo94juesknYb2ANQV/ryMp6pH/A5PIJuR
Message-ID: <443F06F0.3090302@yahoo-inc.com>
Date: Thu, 13 Apr 2006 19:20:32 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Hadoop performance test
Content-Type: multipart/mixed;
 boundary="------------000705060601050209080809"
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--------------000705060601050209080809
Content-Type: text/plain; charset=windows-1251; format=flowed
Content-Transfer-Encoding: 7bit

Here are some Hadoop performance numbers.
Cluster size is ~400 nodes.
Using TestDFSIO (see HADOOP-95) I run N=1,2,4,...,512 maps.
Each map either write 320 Mb into a file or reads the same amount.
The reducer collects statistics.
Finally the following info is appended to a local file

 *    read or write test
 *    date and time the test finished  
 *    number of files
 *    total number of bytes processed
 *    throughput in mb/sec (total number of bytes / sum of processing times)
 *    average IO rate in mb/sec per file
 *    standard IO rate deviation

The resulting file is attached.

--Konstantin

--------------000705060601050209080809
Content-Type: text/plain;
 name="TestDFSIO_results.log"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="TestDFSIO_results.log"

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 16:24:36 PDT 2006
       Number of files: 1
Total MBytes processed: 320
     Throughput mb/sec: 19.07032181168057
Average IO rate mb/sec: 19.070322036743164
 Std IO rate deviation: 0.0015727370437261703
    Test exec time sec: 31.967

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 16:25:39 PDT 2006
       Number of files: 1
Total MBytes processed: 320
     Throughput mb/sec: 69.82325987344534
Average IO rate mb/sec: 69.82325744628906
 Std IO rate deviation: 0.013078064115671978
    Test exec time sec: 20.948

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:23:09 PDT 2006
       Number of files: 2
Total MBytes processed: 640
     Throughput mb/sec: 18.48535613193923
Average IO rate mb/sec: 18.531949996948242
 Std IO rate deviation: 0.929192732875584
    Test exec time sec: 30.926

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 14:23:32 PDT 2006
       Number of files: 2
Total MBytes processed: 640
     Throughput mb/sec: 58.953574060427414
Average IO rate mb/sec: 59.295188903808594
 Std IO rate deviation: 4.500651711741781
    Test exec time sec: 21.904

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:24:04 PDT 2006
       Number of files: 4
Total MBytes processed: 1280
     Throughput mb/sec: 22.703488887706417
Average IO rate mb/sec: 22.768310546875
 Std IO rate deviation: 1.2280173208385086
    Test exec time sec: 31.781

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 14:24:27 PDT 2006
       Number of files: 4
Total MBytes processed: 1280
     Throughput mb/sec: 63.5835278923054
Average IO rate mb/sec: 64.69912719726562
 Std IO rate deviation: 7.911990904209478
    Test exec time sec: 21.821

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:25:00 PDT 2006
       Number of files: 8
Total MBytes processed: 2560
     Throughput mb/sec: 21.627466882941334
Average IO rate mb/sec: 21.851144790649414
 Std IO rate deviation: 2.110482787856987
    Test exec time sec: 31.665

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 14:25:25 PDT 2006
       Number of files: 8
Total MBytes processed: 2560
     Throughput mb/sec: 58.61879465103499
Average IO rate mb/sec: 59.39845657348633
 Std IO rate deviation: 6.76130182662953
    Test exec time sec: 23.609

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:26:08 PDT 2006
       Number of files: 16
Total MBytes processed: 5120
     Throughput mb/sec: 19.421379448994223
Average IO rate mb/sec: 19.693180084228516
 Std IO rate deviation: 2.381103837424668
    Test exec time sec: 41.337

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:31:26 PDT 2006
       Number of files: 16
Total MBytes processed: 5120
     Throughput mb/sec: 21.277568372889387
Average IO rate mb/sec: 21.437524795532227
 Std IO rate deviation: 1.7922764189808216
    Test exec time sec: 35.324

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 14:31:49 PDT 2006
       Number of files: 16
Total MBytes processed: 5120
     Throughput mb/sec: 59.88654307269431
Average IO rate mb/sec: 60.19792556762695
 Std IO rate deviation: 4.267375045191151
    Test exec time sec: 21.338

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:32:35 PDT 2006
       Number of files: 32
Total MBytes processed: 10240
     Throughput mb/sec: 18.39899955439923
Average IO rate mb/sec: 18.57518196105957
 Std IO rate deviation: 1.7869543737431115
    Test exec time sec: 44.696

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 14:32:59 PDT 2006
       Number of files: 32
Total MBytes processed: 10240
     Throughput mb/sec: 50.099563096583545
Average IO rate mb/sec: 50.828125
 Std IO rate deviation: 6.2160798287586365
    Test exec time sec: 21.643

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:33:47 PDT 2006
       Number of files: 64
Total MBytes processed: 20480
     Throughput mb/sec: 16.210508652200687
Average IO rate mb/sec: 16.35537338256836
 Std IO rate deviation: 1.5369961678219703
    Test exec time sec: 44.294

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 14:34:26 PDT 2006
       Number of files: 64
Total MBytes processed: 20480
     Throughput mb/sec: 41.36479589260503
Average IO rate mb/sec: 44.26316452026367
 Std IO rate deviation: 13.409265433444565
    Test exec time sec: 35.303

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:51:18 PDT 2006
       Number of files: 128
Total MBytes processed: 40960
     Throughput mb/sec: 11.860067419387157
Average IO rate mb/sec: 12.003596305847168
 Std IO rate deviation: 1.3249770390412798
    Test exec time sec: 53.04

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 14:51:58 PDT 2006
       Number of files: 128
Total MBytes processed: 40960
     Throughput mb/sec: 27.225208841811966
Average IO rate mb/sec: 27.994953155517578
 Std IO rate deviation: 4.940460215079426
    Test exec time sec: 33.946

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 14:58:39 PDT 2006
       Number of files: 256
Total MBytes processed: 81920
     Throughput mb/sec: 7.281408853062556
Average IO rate mb/sec: 7.459658145904541
 Std IO rate deviation: 1.1710820799951336
    Test exec time sec: 84.035

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 15:27:20 PDT 2006
       Number of files: 256
Total MBytes processed: 81920
     Throughput mb/sec: 7.722600276437415
Average IO rate mb/sec: 7.908267974853516
 Std IO rate deviation: 1.242884594580421
    Test exec time sec: 95.542

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 15:41:29 PDT 2006
       Number of files: 256
Total MBytes processed: 81920
     Throughput mb/sec: 7.554659464410426
Average IO rate mb/sec: 7.828060626983643
 Std IO rate deviation: 1.4768146255330703
    Test exec time sec: 95.178

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 15:46:29 PDT 2006
       Number of files: 256
Total MBytes processed: 81920
     Throughput mb/sec: 16.31467568010012
Average IO rate mb/sec: 17.761398315429688
 Std IO rate deviation: 6.980108046975229
    Test exec time sec: 85.032

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 17:09:40 PDT 2006
       Number of files: 256
Total MBytes processed: 81920
     Throughput mb/sec: 7.86250369874556
Average IO rate mb/sec: 8.074058532714844
 Std IO rate deviation: 1.3505209414238315
    Test exec time sec: 79.276

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 17:10:59 PDT 2006
       Number of files: 256
Total MBytes processed: 81920
     Throughput mb/sec: 16.825214325339097
Average IO rate mb/sec: 18.612468719482422
 Std IO rate deviation: 8.60356441635026
    Test exec time sec: 67.858

----- TestDFSIO ----- : write
           Date & time: Thu Apr 13 17:16:55 PDT 2006
       Number of files: 512
Total MBytes processed: 163840
     Throughput mb/sec: 4.5766820507692145
Average IO rate mb/sec: 4.817268371582031
 Std IO rate deviation: 1.092707178536648
    Test exec time sec: 143.138

----- TestDFSIO ----- : read
           Date & time: Thu Apr 13 17:18:48 PDT 2006
       Number of files: 512
Total MBytes processed: 163840
     Throughput mb/sec: 10.953100220733315
Average IO rate mb/sec: 12.550874710083008
 Std IO rate deviation: 7.132357097529651
    Test exec time sec: 92.107

--------------000705060601050209080809--

From MAILER-DAEMON Fri Apr 14 04:46:54 2006
Return-Path: 
 <hadoop-dev-return-822-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83279 invoked from network); 14 Apr 2006 04:46:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Apr 2006 04:46:54 -0000
Received: (qmail 20723 invoked by uid 500); 14 Apr 2006 04:46:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20693 invoked by uid 500); 14 Apr 2006 04:46:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20684 invoked by uid 99); 14 Apr 2006 04:46:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 21:46:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Apr 2006 21:46:52 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E09FE71428F
	for <hadoop-dev@lucene.apache.org>; Fri, 14 Apr 2006 04:46:00 +0000 (GMT)
Message-ID: <84982586.1144989960912.JavaMail.jira@brutus>
Date: Fri, 14 Apr 2006 04:46:00 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374459 ] 

Owen O'Malley commented on HADOOP-133:
--------------------------------------

The results are interesting. Based on a 45 minute run (on 195 linux nodes) of my random writer, I got:

226 instaces of exit == 143
11 instances of exit == -113
  2 instances of exit == 65   // exception thrown on the ping
  0 instances of exit == 66  // task tracker not recognizing the task

So there is a lot of dying going on that I don't understand. Tomorrow, I'll make a patch for my code that  changes ping from "void ping(string)" to "boolean ping(string)" where false means that the task is unknown and exceptions get a second chance. Do you happen to recognize either 143 or -113? Doing a quick search in eclipse, I didn't see them.

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 14 16:20:00 2006
Return-Path: 
 <hadoop-dev-return-823-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17133 invoked from network); 14 Apr 2006 16:20:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Apr 2006 16:20:00 -0000
Received: (qmail 74211 invoked by uid 500); 14 Apr 2006 16:19:59 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74177 invoked by uid 500); 14 Apr 2006 16:19:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74167 invoked by uid 99); 14 Apr 2006 16:19:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 09:19:58 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 09:19:57 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3EGJeBf016416
	for <hadoop-dev@lucene.apache.org>; Fri, 14 Apr 2006 12:19:40 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout6-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3EGJTp6049946;
	Fri, 14 Apr 2006 12:19:31 -0400
Message-ID: <443FCB90.9000001@apache.org>
Date: Fri, 14 Apr 2006 09:19:28 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org> <443C3F93.9090404@archive.org>
 <443D595F.3040008@apache.org> <443E8D24.7000206@archive.org>
 <443E8F29.6060309@apache.org> <443E9179.4020702@archive.org>
In-Reply-To: <443E9179.4020702@archive.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Michael Stack wrote:
> Doug Cutting wrote:
>> In your case I don't think moving the files is helping at all, since 
>> the checksum errors are not caused by bad disk blocks, but rather by 
>> memory errors.  So not moving is fine.  Maybe we should add a config 
>> parameter to disable moving on checksum error?
> 
> Let me try this.  Should probably subsume the 'io.skip.checksum.errors' 
> parameter.

Eric Baldeschwieler tells me that most disks now automatically remap bad 
sectors (I didn't think IDE drives did this, but it seems they do now). 
  So we shouldn't need to move the files at all.

How did things work when you disabled moving of files?

Doug

From MAILER-DAEMON Fri Apr 14 16:50:16 2006
Return-Path: 
 <hadoop-dev-return-824-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34427 invoked from network); 14 Apr 2006 16:50:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Apr 2006 16:50:16 -0000
Received: (qmail 33388 invoked by uid 500); 14 Apr 2006 16:50:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33278 invoked by uid 500); 14 Apr 2006 16:50:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33257 invoked by uid 99); 14 Apr 2006 16:50:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 09:50:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 09:50:14 -0700
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k3EFcWZ05369
	for <hadoop-dev@lucene.apache.org>; Fri, 14 Apr 2006 08:38:32 -0700
Message-ID: <443FD2CC.8020704@duboce.net>
Date: Fri, 14 Apr 2006 09:50:20 -0700
From: Michael Stack <stack@duboce.net>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: NPE in FSNamesystem.internalReleaseCreate
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Anyone else seeing these:

java.rmi.RemoteException: java.io.IOException: 
java.lang.NullPointerException at 
org.apache.hadoop.dfs.FSNamesystem.internalReleaseCreate(FSNamesystem.java:776) 
at 
org.apache.hadoop.dfs.FSNamesystem.abandonFileInProgress(FSNamesystem.java:364) 
at 
org.apache.hadoop.dfs.NameNode.abandonFileInProgress(NameNode.java:212) 
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at 
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 
at 
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
at java.lang.reflect.Method.invoke(Method.java:585) at 
org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237) at 
org.apache.hadoop.ipc.Server$Handler.run(Server.java:216) at 
org.apache.hadoop.ipc.Client.call(Client.java:303) at 
org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141) at 
org.apache.hadoop.dfs.$Proxy1.abandonFileInProgress(Unknown Source) at 
org.apache.hadoop.dfs.DFSClient$DFSOutputStream.close(DFSClient.java:815) 
at java.io.FilterOutputStream.close(FilterOutputStream.java:143) at 
java.io.FilterOutputStream.close(FilterOutputStream.java:143) at 
java.io.FilterOutputStream.close(FilterOutputStream.java:143) at 
org.apache.hadoop.fs.FSDataOutputStream$Summer.close(FSDataOutputStream.java:78) 
at java.io.FilterOutputStream.close(FilterOutputStream.java:143) at 
java.io.FilterOutputStream.close(FilterOutputStream.java:143) at 
java.io.FilterOutputStream.close(FilterOutputStream.java:143) at 
org.apache.hadoop.io.SequenceFile$Writer.close(SequenceFile.java:139) at 
org.apache.hadoop.io.MapFile$Writer.close(MapFile.java:119) at 
org.apache.hadoop.mapred.MapFileOutputFormat$1.close(MapFileOutputFormat.java:52) 
at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:291) at 
org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709)

From MAILER-DAEMON Fri Apr 14 20:12:55 2006
Return-Path: 
 <hadoop-dev-return-825-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34961 invoked from network); 14 Apr 2006 20:12:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Apr 2006 20:12:55 -0000
Received: (qmail 52439 invoked by uid 500); 14 Apr 2006 20:12:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52327 invoked by uid 500); 14 Apr 2006 20:12:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52318 invoked by uid 99); 14 Apr 2006 20:12:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 13:12:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 13:12:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3467671429F
	for <hadoop-dev@lucene.apache.org>; Fri, 14 Apr 2006 20:12:00 +0000 (GMT)
Message-ID: <64235546.1145045520182.JavaMail.jira@brutus>
Date: Fri, 14 Apr 2006 20:12:00 +0000 (GMT+00:00)
From: "Dick King (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-136) Overlong UTF8's not handled well
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Overlong UTF8's not handled well
--------------------------------

         Key: HADOOP-136
         URL: http://issues.apache.org/jira/browse/HADOOP-136
     Project: Hadoop
        Type: Bug

  Components: io  
    Reporter: Dick King
    Priority: Minor


When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.

First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.

Second, the code doesn't actually handle four-byte characters.

Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.

I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.

-dk



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 14 23:42:56 2006
Return-Path: 
 <hadoop-dev-return-826-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15506 invoked from network); 14 Apr 2006 23:42:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Apr 2006 23:42:56 -0000
Received: (qmail 87266 invoked by uid 500); 14 Apr 2006 23:42:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87245 invoked by uid 500); 14 Apr 2006 23:42:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87236 invoked by uid 99); 14 Apr 2006 23:42:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 16:42:54 -0700
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 16:42:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DCAD371429D
	for <hadoop-dev@lucene.apache.org>; Fri, 14 Apr 2006 23:42:00 +0000 (GMT)
Message-ID: <76104247.1145058120901.JavaMail.jira@brutus>
Date: Fri, 14 Apr 2006 23:42:00 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-134) JobTracker trapped in a loop if it
 fails to localize a task
In-Reply-To: <35583916.1144972740231.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-134?page=all ]

Owen O'Malley updated HADOOP-134:
---------------------------------

    Attachment: task-startup-safety.patch

Ok, this patch fixes the problem. In particular,
  1. adds the hostname to the task tracker names.
  2. moves exception-raising code out of the constructor for TaskInProgress
  3. pulls the task start up code into a separate procedure so that I can make sure it doesn't throw any exceptions
  4. records failures during initialization of tasks
  5. moves the stringifyException into the utils package.

> JobTracker trapped in a loop if it fails to localize a task
> -----------------------------------------------------------
>
>          Key: HADOOP-134
>          URL: http://issues.apache.org/jira/browse/HADOOP-134
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Runping Qi
>  Attachments: task-startup-safety.patch
>
> The symptoms:
>     When I ran  jobs on a big cluster, I noticed that some jobs got stucked. Some map tasks never got started. When I look at the log of the task tracker responsible for the tasks, I saw the following exceptions:
> 060413 160702 Lost connection to JobTracker [kry1040/72.30.116.100:50020].  Retrying...
> java.io.IOException: No valid local directories in property: mapred.local.dir
>         at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:282)
>         at org.apache.hadoop.mapred.JobConf.getLocalFile(JobConf.java:127)
>         at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:391)
>         at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.<init>(TaskTracker.java:383)
>         at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:270)
>         at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:336)
>         at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:756)
> The reason for the exception is that the directory hadoop/mapred/local has "wrong" owner, thus the task tracker cannot access to it.
> This caused the task tracker stucked into the following loops:
>             while (running) {
>                 boolean staleState = false;
>                 try {
>                     // This while-loop attempts reconnects if we get network errors
>                     while (running && ! staleState) {
>                         try {
>                             if (offerService() == STALE_STATE) {
>                                 staleState = true;
>                             }
>                         } catch (Exception ex) {
>                             LOG.log(Level.INFO, "Lost connection to JobTracker [" + jobTrackAddr + "].  Retrying...", ex);
>                             try {
>                                 Thread.sleep(5000);
>                             } catch (InterruptedException ie) {
>                             }
>                         }
>                     }
>                 } finally {
>                     close();
>                 }
>                 LOG.info("Reinitializing local state");
>                 initialize();
>             }
> Issue 1:
>     Method offerService() must catch and handle the exceptions that may be thrown from new TaskInProgress() call, and report back to the job tracker if it cannot run the task. This way, the task can be assigned to other task tracker.
> Issue 2:
>     The taskTracker should check whether it can access to the local dir at the initialization time, before taking any tasks.
> Runping

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 15 00:11:54 2006
Return-Path: 
 <hadoop-dev-return-827-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21353 invoked from network); 15 Apr 2006 00:11:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Apr 2006 00:11:54 -0000
Received: (qmail 14213 invoked by uid 500); 15 Apr 2006 00:11:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14193 invoked by uid 500); 15 Apr 2006 00:11:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14179 invoked by uid 99); 15 Apr 2006 00:11:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 17:11:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 17:11:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3B4E071429F
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 00:11:00 +0000 (GMT)
Message-ID: <82889088.1145059860234.JavaMail.jira@brutus>
Date: Sat, 15 Apr 2006 00:11:00 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-137) Different TaskTrackers may get the
 same task tracker id, thus cause many problems.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Different TaskTrackers may get the same task tracker id, thus cause many problems.
----------------------------------------------------------------------------------

         Key: HADOOP-137
         URL: http://issues.apache.org/jira/browse/HADOOP-137
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Runping Qi
    Priority: Critical



In the TaskTracker#Initialize method, the following line assigns task tracker name (id):

this.taskTrackerName = "tracker_" + (Math.abs(r.nextInt()) % 100000);

For a fair size cluster, it is possible that different task trackers to get the same id, causing name conflict.
I encountered this problem with a cluster of 274 nodes. Once such conflict happens, a lot of strange things may happen.
For example, a reducer task tried to copy from a machine (task tracker) a map output file that was actually produced 
on another machine.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 15 00:27:55 2006
Return-Path: 
 <hadoop-dev-return-828-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24841 invoked from network); 15 Apr 2006 00:27:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Apr 2006 00:27:55 -0000
Received: (qmail 28214 invoked by uid 500); 15 Apr 2006 00:27:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28193 invoked by uid 500); 15 Apr 2006 00:27:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28184 invoked by uid 99); 15 Apr 2006 00:27:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 17:27:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 17:27:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DF7E871429F
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 00:27:00 +0000 (GMT)
Message-ID: <64115800.1145060820907.JavaMail.jira@brutus>
Date: Sat, 15 Apr 2006 00:27:00 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-137) Different TaskTrackers may get the
 same task tracker id, thus cause many problems.
In-Reply-To: <82889088.1145059860234.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-137?page=comments#action_12374587 ] 

Runping Qi commented on HADOOP-137:
-----------------------------------


A simple fix for the issue is to add hostname as part of task track names. 
I believe Owen has actually done this in trying to fix another issue, but the patch
is not committed yet.



> Different TaskTrackers may get the same task tracker id, thus cause many problems.
> ----------------------------------------------------------------------------------
>
>          Key: HADOOP-137
>          URL: http://issues.apache.org/jira/browse/HADOOP-137
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Runping Qi
>     Priority: Critical

>
> In the TaskTracker#Initialize method, the following line assigns task tracker name (id):
> this.taskTrackerName = "tracker_" + (Math.abs(r.nextInt()) % 100000);
> For a fair size cluster, it is possible that different task trackers to get the same id, causing name conflict.
> I encountered this problem with a cluster of 274 nodes. Once such conflict happens, a lot of strange things may happen.
> For example, a reducer task tried to copy from a machine (task tracker) a map output file that was actually produced 
> on another machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 15 02:00:54 2006
Return-Path: 
 <hadoop-dev-return-829-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52479 invoked from network); 15 Apr 2006 02:00:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Apr 2006 02:00:54 -0000
Received: (qmail 15220 invoked by uid 500); 15 Apr 2006 02:00:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15196 invoked by uid 500); 15 Apr 2006 02:00:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15187 invoked by uid 99); 15 Apr 2006 02:00:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 19:00:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 19:00:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7AB2271429F
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 02:00:00 +0000 (GMT)
Message-ID: <81187011.1145066400494.JavaMail.jira@brutus>
Date: Sat, 15 Apr 2006 02:00:00 +0000 (GMT+00:00)
From: "Stefan Groschupf (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-138) stop all tasks
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

stop all tasks 
---------------

         Key: HADOOP-138
         URL: http://issues.apache.org/jira/browse/HADOOP-138
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.1.0, 0.1.1    
    Reporter: Stefan Groschupf
    Priority: Trivial


When a tasktracker runs X tasks it require X heartbeats to stop all jobs.
Stop all tasks with one heartbeat improve the availability and free resources faster.   

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 15 02:04:55 2006
Return-Path: 
 <hadoop-dev-return-830-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52963 invoked from network); 15 Apr 2006 02:04:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Apr 2006 02:04:55 -0000
Received: (qmail 16151 invoked by uid 500); 15 Apr 2006 02:04:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16130 invoked by uid 500); 15 Apr 2006 02:04:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16121 invoked by uid 99); 15 Apr 2006 02:04:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 19:04:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 19:04:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DD17671429F
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 02:04:00 +0000 (GMT)
Message-ID: <109526125.1145066640893.JavaMail.jira@brutus>
Date: Sat, 15 Apr 2006 02:04:00 +0000 (GMT+00:00)
From: "Stefan Groschupf (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-138) stop all tasks
In-Reply-To: <81187011.1145066400494.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-138?page=all ]

Stefan Groschupf updated HADOOP-138:
------------------------------------

    Attachment: stopAllTasks.patch

May be something like that would work?

> stop all tasks
> --------------
>
>          Key: HADOOP-138
>          URL: http://issues.apache.org/jira/browse/HADOOP-138
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.0, 0.1.1
>     Reporter: Stefan Groschupf
>     Priority: Trivial
>  Attachments: stopAllTasks.patch
>
> When a tasktracker runs X tasks it require X heartbeats to stop all jobs.
> Stop all tasks with one heartbeat improve the availability and free resources faster.   

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 15 03:40:55 2006
Return-Path: 
 <hadoop-dev-return-831-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77390 invoked from network); 15 Apr 2006 03:40:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Apr 2006 03:40:55 -0000
Received: (qmail 50608 invoked by uid 500); 15 Apr 2006 03:40:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50581 invoked by uid 500); 15 Apr 2006 03:40:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50571 invoked by uid 99); 15 Apr 2006 03:40:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 20:40:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 20:40:53 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4849471429F
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 03:40:00 +0000 (GMT)
Message-ID: <96946734.1145072400288.JavaMail.jira@brutus>
Date: Sat, 15 Apr 2006 03:40:00 +0000 (GMT+00:00)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-139) Deadlock in LocalFileSystem
 lock/release
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Deadlock in LocalFileSystem lock/release 
-----------------------------------------

         Key: HADOOP-139
         URL: http://issues.apache.org/jira/browse/HADOOP-139
     Project: Hadoop
        Type: Bug

  Components: fs  
    Reporter: Igor Bolotin


LocalFileSystem lock/release methods marked synchronized and inside they lock file channel - this produces deadlock situation. Let's see how it happens: 
1. First thread locks the file and starts some long-running process.
2. Second thread tries to lock the file and it blocks inside channel lock method. It  keeps LocalFileSystem instance "locked" as well. 
3. First thread finished it's processing and tries to release lock - it blocks because LocalFileSystem instance is "locked" by second thread - both threads are waiting to each other. 


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 15 05:42:55 2006
Return-Path: 
 <hadoop-dev-return-832-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 830 invoked from network); 15 Apr 2006 05:42:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Apr 2006 05:42:55 -0000
Received: (qmail 84269 invoked by uid 500); 15 Apr 2006 05:42:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84249 invoked by uid 500); 15 Apr 2006 05:42:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84234 invoked by uid 99); 15 Apr 2006 05:42:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 22:42:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Apr 2006 22:42:54 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2D57471429F
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 05:42:01 +0000 (GMT)
Message-ID: <99378934.1145079721183.JavaMail.jira@brutus>
Date: Sat, 15 Apr 2006 05:42:01 +0000 (GMT+00:00)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-139) Deadlock in LocalFileSystem
 lock/release
In-Reply-To: <96946734.1145072400288.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-139?page=all ]

Igor Bolotin updated HADOOP-139:
--------------------------------

    Attachment: deadlock.patch

Attached is proposed patch. I removed entire lock/release method synchronization and replaced it with critical section synchronization for sets accesses - leaving channel lock/release calls outside of synchronized statement. 

> Deadlock in LocalFileSystem lock/release
> ----------------------------------------
>
>          Key: HADOOP-139
>          URL: http://issues.apache.org/jira/browse/HADOOP-139
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>     Reporter: Igor Bolotin
>  Attachments: deadlock.patch
>
> LocalFileSystem lock/release methods marked synchronized and inside they lock file channel - this produces deadlock situation. Let's see how it happens: 
> 1. First thread locks the file and starts some long-running process.
> 2. Second thread tries to lock the file and it blocks inside channel lock method. It  keeps LocalFileSystem instance "locked" as well. 
> 3. First thread finished it's processing and tries to release lock - it blocks because LocalFileSystem instance is "locked" by second thread - both threads are waiting to each other. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 15 07:00:56 2006
Return-Path: 
 <hadoop-dev-return-833-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18667 invoked from network); 15 Apr 2006 07:00:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Apr 2006 07:00:56 -0000
Received: (qmail 7416 invoked by uid 500); 15 Apr 2006 07:00:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7388 invoked by uid 500); 15 Apr 2006 07:00:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7378 invoked by uid 99); 15 Apr 2006 07:00:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 00:00:55 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 00:00:54 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2939271429F
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 07:00:01 +0000 (GMT)
Message-ID: <87551851.1145084401166.JavaMail.jira@brutus>
Date: Sat, 15 Apr 2006 07:00:01 +0000 (GMT+00:00)
From: "Teppo Kurki (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-140) General documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

General documentation
---------------------

         Key: HADOOP-140
         URL: http://issues.apache.org/jira/browse/HADOOP-140
     Project: Hadoop
        Type: Wish

    Reporter: Teppo Kurki
    Priority: Minor


Getting a grasp of how Hadoop works is a little hard, because one first has to get a grip on the whole MapReduce thing and then figure out how it is carried out in Hadoop. Judging from the mailing list a little more general documentation would help a lot.



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 15 07:07:55 2006
Return-Path: 
 <hadoop-dev-return-834-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19862 invoked from network); 15 Apr 2006 07:07:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Apr 2006 07:07:55 -0000
Received: (qmail 11269 invoked by uid 500); 15 Apr 2006 07:07:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11244 invoked by uid 500); 15 Apr 2006 07:07:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11235 invoked by uid 99); 15 Apr 2006 07:07:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 00:07:55 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 00:07:54 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2854C71429F
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 07:07:01 +0000 (GMT)
Message-ID: <52414763.1145084821157.JavaMail.jira@brutus>
Date: Sat, 15 Apr 2006 07:07:01 +0000 (GMT+00:00)
From: "Teppo Kurki (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-140) General documentation
In-Reply-To: <87551851.1145084401166.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-140?page=all ]

Teppo Kurki updated HADOOP-140:
-------------------------------

    Attachment: mapred.xml

Xdoc document that describes how Hadoop carries out MapReduce that I came up with trying to understand everything. 

Maybe someone could read it and see that it is not completely off the mark?





> General documentation
> ---------------------
>
>          Key: HADOOP-140
>          URL: http://issues.apache.org/jira/browse/HADOOP-140
>      Project: Hadoop
>         Type: Wish

>     Reporter: Teppo Kurki
>     Priority: Minor
>  Attachments: mapred.xml
>
> Getting a grasp of how Hadoop works is a little hard, because one first has to get a grip on the whole MapReduce thing and then figure out how it is carried out in Hadoop. Judging from the mailing list a little more general documentation would help a lot.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Apr 16 05:34:43 2006
Return-Path: 
 <hadoop-dev-return-835-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18129 invoked from network); 16 Apr 2006 05:34:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Apr 2006 05:34:43 -0000
Received: (qmail 30494 invoked by uid 500); 16 Apr 2006 05:34:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30458 invoked by uid 500); 16 Apr 2006 05:34:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30448 invoked by uid 99); 16 Apr 2006 05:34:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 22:34:42 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 22:34:41 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch1.xch.corp.yahoo.com
 [216.145.51.233])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3G5Wrr7031236
	for <hadoop-dev@lucene.apache.org>; Sat, 15 Apr 2006 22:32:53 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=zENyQpqqrySLu8Sx8zlYg53yGBsA8GauP45ZVLceGNjEWT3HqYoQxIuwjh4TEpGQ
Received: from [10.0.1.3] ([10.72.77.63]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Sat, 15 Apr 2006 22:32:53 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <443FCB90.9000001@apache.org>
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org> <443C3F93.9090404@archive.org>
 <443D595F.3040008@apache.org> <443E8D24.7000206@archive.org>
 <443E8F29.6060309@apache.org> <443E9179.4020702@archive.org>
 <443FCB90.9000001@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <6A7BF6CE-ECBA-46CC-B8E5-2EA6B1044B48@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was: Re:
 Hung job
Date: Sat, 15 Apr 2006 22:32:54 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 16 Apr 2006 05:32:53.0532 (UTC)
 FILETIME=[35701DC0:01C66117]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

"Tells" is a bit strong!  I just asked if this might not be so.  I'm  
asking folks I know who know more.  If anyone on this list does,  
please educate me!

e14

On Apr 14, 2006, at 9:19 AM, Doug Cutting wrote:

> Michael Stack wrote:
>> Doug Cutting wrote:
>>> In your case I don't think moving the files is helping at all,  
>>> since the checksum errors are not caused by bad disk blocks, but  
>>> rather by memory errors.  So not moving is fine.  Maybe we should  
>>> add a config parameter to disable moving on checksum error?
>> Let me try this.  Should probably subsume the  
>> 'io.skip.checksum.errors' parameter.
>
> Eric Baldeschwieler tells me that most disks now automatically  
> remap bad sectors (I didn't think IDE drives did this, but it seems  
> they do now).  So we shouldn't need to move the files at all.
>
> How did things work when you disabled moving of files?
>
> Doug


From MAILER-DAEMON Sun Apr 16 05:43:58 2006
Return-Path: 
 <hadoop-dev-return-836-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 22412 invoked from network); 16 Apr 2006 05:43:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Apr 2006 05:43:58 -0000
Received: (qmail 31436 invoked by uid 500); 16 Apr 2006 05:43:57 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31413 invoked by uid 500); 16 Apr 2006 05:43:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31404 invoked by uid 99); 16 Apr 2006 05:43:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 22:43:57 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 22:43:56 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9B25F7141B8
	for <hadoop-dev@lucene.apache.org>; Sun, 16 Apr 2006 05:43:01 +0000 (GMT)
Message-ID: <113189456.1145166181607.JavaMail.jira@brutus>
Date: Sun, 16 Apr 2006 05:43:01 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-129) FileSystem should not name files
 with java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-129?page=comments#action_12374671 ] 

eric baldeschwieler commented on HADOOP-129:
--------------------------------------------

It could contain a URI... 

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Doug Cutting
>      Fix For: 0.2

>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Apr 16 05:50:56 2006
Return-Path: 
 <hadoop-dev-return-837-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23290 invoked from network); 16 Apr 2006 05:50:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Apr 2006 05:50:56 -0000
Received: (qmail 33292 invoked by uid 500); 16 Apr 2006 05:50:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33265 invoked by uid 500); 16 Apr 2006 05:50:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33256 invoked by uid 99); 16 Apr 2006 05:50:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 22:50:56 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Apr 2006 22:50:55 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7F055714292
	for <hadoop-dev@lucene.apache.org>; Sun, 16 Apr 2006 05:50:00 +0000 (GMT)
Message-ID: <75718381.1145166600492.JavaMail.jira@brutus>
Date: Sun, 16 Apr 2006 05:50:00 +0000 (GMT+00:00)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-129) FileSystem should not name files
 with java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-129?page=comments#action_12374672 ] 

Igor Bolotin commented on HADOOP-129:
-------------------------------------

Does it make sense to create class that would extend File and override unsupported operations to throw UnsupportedOperationException?

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Doug Cutting
>      Fix For: 0.2

>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 17 10:59:53 2006
Return-Path: 
 <hadoop-dev-return-838-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79834 invoked from network); 17 Apr 2006 10:59:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Apr 2006 10:59:53 -0000
Received: (qmail 55622 invoked by uid 500); 17 Apr 2006 10:59:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55589 invoked by uid 500); 17 Apr 2006 10:59:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55579 invoked by uid 99); 17 Apr 2006 10:59:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 03:59:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 03:59:51 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 78F8414450A
	for <hadoop-dev@lucene.apache.org>; Mon, 17 Apr 2006 12:44:55 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 01338-08 for <hadoop-dev@lucene.apache.org>;
	Mon, 17 Apr 2006 12:44:55 +0200 (CEST)
Received: from [192.168.200.39] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id 547541443E4
	for <hadoop-dev@lucene.apache.org>; Mon, 17 Apr 2006 12:44:55 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
Content-Transfer-Encoding: 7bit
Message-Id: <579105BD-4157-4E70-986F-A1F23B6AD180@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: IdentityMapper
Date: Mon, 17 Apr 2006 12:59:24 +0200
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

what is the reason that each job that has no mapper defined runs the  
IdentityMapper?
Handling different formats (as discussed) between mapping and  
reducing is difficult.
Having one job that just map in the one format and having another job  
that just reduce
in a other format would be a nice workaround of the format problem  
but the IdentityMapper makes this workaround impossible.

Thanks any clarification.
Stefan


From MAILER-DAEMON Mon Apr 17 22:22:21 2006
Return-Path: 
 <hadoop-dev-return-839-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20461 invoked from network); 17 Apr 2006 22:22:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Apr 2006 22:22:21 -0000
Received: (qmail 39930 invoked by uid 500); 17 Apr 2006 22:22:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39902 invoked by uid 500); 17 Apr 2006 22:22:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39893 invoked by uid 99); 17 Apr 2006 22:22:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 15:22:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 15:22:19 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0D8D97142C7
	for <hadoop-dev@lucene.apache.org>; Mon, 17 Apr 2006 22:21:22 +0000 (GMT)
Message-ID: <9808210.1145312482052.JavaMail.jira@brutus>
Date: Mon, 17 Apr 2006 22:21:22 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-141) Disk thrashing / task timeouts during
 map output copy phase
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Disk thrashing / task timeouts during map output copy phase
-----------------------------------------------------------

         Key: HADOOP-141
         URL: http://issues.apache.org/jira/browse/HADOOP-141
     Project: Hadoop
        Type: Bug

  Components: mapred  
 Environment: linux
    Reporter: paul sutter



MapOutputProtocol connections cause timeouts because of system thrashing and transferring the same file over and over again, ultimately leading to making no forward progress(medium sized job, 500GB input file, map output about as large as the input, 10 node cluster).

There are several bugs behind this, but the following two changes improved matters considerably.

(1) 

The buffersize in MapOutputFile is currently hardcoded to 8192 bytes (for both reads and writes). By changing this buffer size to 256KB, the number of disk seeks are reduced and the problem went away. 

Ideally there would be a buffer size parameter for this that is separate from the DFS io buffer size.

(2)

I also added the following code to the socket configuration in both Server.java and Client.java. No linger is a minor good idea in an enivronment with some packet loss (and you will have that when all the nodes get busy at once), but 256KB buffers is probably excessive, especially on a LAN, but it takes me two hours to test changes so I havent experimented.

socket.setSendBufferSize(256*1024);
socket.setReceiveBufferSize(256*1024);
socket.setSoLinger(false, 0);
socket.setKeepAlive(true);


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 17 22:27:16 2006
Return-Path: 
 <hadoop-dev-return-840-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 25312 invoked from network); 17 Apr 2006 22:27:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Apr 2006 22:27:16 -0000
Received: (qmail 48704 invoked by uid 500); 17 Apr 2006 22:27:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48679 invoked by uid 500); 17 Apr 2006 22:27:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48667 invoked by uid 99); 17 Apr 2006 22:27:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 15:27:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 15:27:14 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 613BD7142C5
	for <hadoop-dev@lucene.apache.org>; Mon, 17 Apr 2006 22:26:17 +0000 (GMT)
Message-ID: <30085808.1145312777394.JavaMail.jira@brutus>
Date: Mon, 17 Apr 2006 22:26:17 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-142) failed tasks should be rescheduled on
 different hosts after other jobs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

failed tasks should be rescheduled on different hosts after other jobs
----------------------------------------------------------------------

         Key: HADOOP-142
         URL: http://issues.apache.org/jira/browse/HADOOP-142
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


Currently when tasks fail, they are usually rerun immediately on the same host. This causes problems in a couple of ways. 
  1.The task is more likely to fail on the same host. 
  2.If there is cleanup code (such as clearing pendingCreates) it does not always run immediately, leading to cascading failures.

For a first pass, I propose that when a task fails, we start the scan for new tasks to launch at the following task of the same type (within that job). So if maps[99] fails, when we are looking to assign new map tasks from this job, we scan like maps[100]...maps[N], maps[0]..,maps[99].

A more involved change would avoid running tasks on nodes where it has failed before. This is a little tricky, because you don't want to prevent re-excution of tasks on 1 node clusters and the job tracker needs to schedule one task tracker at a time.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 17 22:29:17 2006
Return-Path: 
 <hadoop-dev-return-841-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 25916 invoked from network); 17 Apr 2006 22:29:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Apr 2006 22:29:17 -0000
Received: (qmail 50626 invoked by uid 500); 17 Apr 2006 22:29:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50611 invoked by uid 500); 17 Apr 2006 22:29:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50600 invoked by uid 99); 17 Apr 2006 22:29:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 15:29:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 15:29:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 373817142C5
	for <hadoop-dev@lucene.apache.org>; Mon, 17 Apr 2006 22:28:18 +0000 (GMT)
Message-ID: <3923802.1145312898188.JavaMail.jira@brutus>
Date: Mon, 17 Apr 2006 22:28:18 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-141) Disk thrashing / task timeouts
 during map output copy phase
In-Reply-To: <9808210.1145312482052.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-141?page=comments#action_12374822 ] 

paul sutter commented on HADOOP-141:
------------------------------------

reword that first sentance: 

Reduce progress grinds to a halt with lots of MapOutputProtocol timeouts and transferring the same file over and over again because of system thrashing.


> Disk thrashing / task timeouts during map output copy phase
> -----------------------------------------------------------
>
>          Key: HADOOP-141
>          URL: http://issues.apache.org/jira/browse/HADOOP-141
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>  Environment: linux
>     Reporter: paul sutter

>
> MapOutputProtocol connections cause timeouts because of system thrashing and transferring the same file over and over again, ultimately leading to making no forward progress(medium sized job, 500GB input file, map output about as large as the input, 10 node cluster).
> There are several bugs behind this, but the following two changes improved matters considerably.
> (1) 
> The buffersize in MapOutputFile is currently hardcoded to 8192 bytes (for both reads and writes). By changing this buffer size to 256KB, the number of disk seeks are reduced and the problem went away. 
> Ideally there would be a buffer size parameter for this that is separate from the DFS io buffer size.
> (2)
> I also added the following code to the socket configuration in both Server.java and Client.java. No linger is a minor good idea in an enivronment with some packet loss (and you will have that when all the nodes get busy at once), but 256KB buffers is probably excessive, especially on a LAN, but it takes me two hours to test changes so I havent experimented.
> socket.setSendBufferSize(256*1024);
> socket.setReceiveBufferSize(256*1024);
> socket.setSoLinger(false, 0);
> socket.setKeepAlive(true);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 17 22:35:16 2006
Return-Path: 
 <hadoop-dev-return-842-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28578 invoked from network); 17 Apr 2006 22:35:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Apr 2006 22:35:16 -0000
Received: (qmail 57276 invoked by uid 500); 17 Apr 2006 22:35:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57227 invoked by uid 500); 17 Apr 2006 22:35:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57218 invoked by uid 99); 17 Apr 2006 22:35:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 15:35:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 15:35:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A2ECD7142C4
	for <hadoop-dev@lucene.apache.org>; Mon, 17 Apr 2006 22:34:17 +0000 (GMT)
Message-ID: <32352238.1145313257649.JavaMail.jira@brutus>
Date: Mon, 17 Apr 2006 22:34:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-129) FileSystem should not name files
 with java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-129?page=comments#action_12374824 ] 

Doug Cutting commented on HADOOP-129:
-------------------------------------

> Does it make sense to create class that would extend File and override unsupported operations to throw UnsupportedOperationException?

I'm not sure what advantages that would have.  Is the idea to detect errors at runtime rather than at compile time?  I've just about finished a patch adding a new class.  I'll post it later today.

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Doug Cutting
>      Fix For: 0.2

>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 17 23:16:16 2006
Return-Path: 
 <hadoop-dev-return-843-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48050 invoked from network); 17 Apr 2006 23:16:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Apr 2006 23:16:16 -0000
Received: (qmail 16087 invoked by uid 500); 17 Apr 2006 23:16:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16069 invoked by uid 500); 17 Apr 2006 23:16:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16060 invoked by uid 99); 17 Apr 2006 23:16:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 16:16:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 16:16:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9FD47410005
	for <hadoop-dev@lucene.apache.org>; Mon, 17 Apr 2006 23:15:17 +0000 (GMT)
Message-ID: <23365320.1145315717651.JavaMail.jira@brutus>
Date: Mon, 17 Apr 2006 23:15:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-129) FileSystem should not name files with
 java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-129?page=all ]

Doug Cutting updated HADOOP-129:
--------------------------------

    Attachment: path.patch

Here's a patch that replaces uses of java.io.File in Hadoop's FileSystem and MapReduce API's with a new class named Path.  I left some existing File-based methods, now deprecated, sufficient for Nutch to run w/o alteration.  I'd like to remove the deprecated methods after the 0.2 release.

I believe that the only incompatible change is that dfs.data.dir and mapred.local.dir, when lists of directories, must now be comma-separated and may no longer be space-separated.  This is in order to make things work better on Windows.

I have tested this in standalone and pseudo-distributed operation on both Linux and Windows, with unit tests and with the Nutch crawler.

Barring objections, I will apply this tomorrow.

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Doug Cutting
>      Fix For: 0.2
>  Attachments: path.patch
>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 00:14:18 2006
Return-Path: 
 <hadoop-dev-return-844-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66260 invoked from network); 18 Apr 2006 00:14:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 00:14:18 -0000
Received: (qmail 59426 invoked by uid 500); 18 Apr 2006 00:14:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59392 invoked by uid 500); 18 Apr 2006 00:14:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59383 invoked by uid 99); 18 Apr 2006 00:14:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 17:14:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Apr 2006 17:14:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 529A87142C1
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 00:13:19 +0000 (GMT)
Message-ID: <11527294.1145319199286.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 00:13:19 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-142) failed tasks should be rescheduled
 on different hosts after other jobs
In-Reply-To: <30085808.1145312777394.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-142?page=comments#action_12374831 ] 

Runping Qi commented on HADOOP-142:
-----------------------------------


Ideally, it will be the best if the tasktracker can diagnose whether the failure was task specific or is a general case. 
If it is a general case, the tasktracker should generate some alter and stop polling for tasks before the problem is corrected.

Here is a case I encountered. For some reason, the tmp dir of the DFS was not writable:

060417 144314 task_r_3e1f4h  Error running child
060417 144314 task_r_3e1f4h java.io.FileNotFoundException: /export/crawlspace2/k
ryptonite/hadoop/dfs/data/tmp/client-5535743708351505322 (Read-only file system)
060417 144314 task_r_3e1f4h     at java.io.FileOutputStream.open(Native Method)
060417 144314 task_r_3e1f4h     at java.io.FileOutputStream.<init>(FileOutputStr
eam.java:179)
060417 144314 task_r_3e1f4h     at java.io.FileOutputStream.<init>(FileOutputStr
eam.java:131)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.dfs.DFSClient$DFSOutputStre
am.<init>(DFSClient.java:576)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.dfs.DFSClient.create(DFSCli
ent.java:127)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.dfs.DistributedFileSystem.c
reateRaw(DistributedFileSystem.java:83)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.fs.FSDataOutputStream$Summe
r.<init>(FSDataOutputStream.java:43)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.fs.FSDataOutputStream.<init
>(FSDataOutputStream.java:132)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.fs.FileSystem.create(FileSy
stem.java:201)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.fs.FileSystem.create(FileSy
stem.java:168)
060417 144314 task_r_3e1f4h     at com.yahoo.yst.crawl.aggregation.CrawledDocOut
putFormat.getRecordWriter(CrawledDocOutputFormat.java:39)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.mapred.ReduceTask.run(Reduc
eTask.java:265)
060417 144314 task_r_3e1f4h     at org.apache.hadoop.mapred.TaskTracker$Child.ma
in(TaskTracker.java:709)

In this case,  all reduce tasks will fail. Thus, it does not make sense to get any new reduce tasks.

In some other case, if the map.local.dir is not writable, then both map tasks and reduce rasks will fail. 
In this case, it should stop polling for new tasks.


> failed tasks should be rescheduled on different hosts after other jobs
> ----------------------------------------------------------------------
>
>          Key: HADOOP-142
>          URL: http://issues.apache.org/jira/browse/HADOOP-142
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2

>
> Currently when tasks fail, they are usually rerun immediately on the same host. This causes problems in a couple of ways. 
>   1.The task is more likely to fail on the same host. 
>   2.If there is cleanup code (such as clearing pendingCreates) it does not always run immediately, leading to cascading failures.
> For a first pass, I propose that when a task fails, we start the scan for new tasks to launch at the following task of the same type (within that job). So if maps[99] fails, when we are looking to assign new map tasks from this job, we scan like maps[100]...maps[N], maps[0]..,maps[99].
> A more involved change would avoid running tasks on nodes where it has failed before. This is a little tricky, because you don't want to prevent re-excution of tasks on 1 node clusters and the job tracker needs to schedule one task tracker at a time.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 16:09:10 2006
Return-Path: 
 <hadoop-dev-return-850-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40084 invoked from network); 18 Apr 2006 16:09:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 16:09:10 -0000
Received: (qmail 37088 invoked by uid 500); 18 Apr 2006 16:09:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36977 invoked by uid 500); 18 Apr 2006 16:09:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36968 invoked by uid 99); 18 Apr 2006 16:09:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 09:09:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [207.241.227.188] (HELO mail.archive.org) (207.241.227.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 09:09:08 -0700
Received: from localhost (localhost [127.0.0.1])
	by mail.archive.org (Postfix) with ESMTP id CDABC14156713;
	Tue, 18 Apr 2006 09:08:47 -0700 (PDT)
Received: from mail.archive.org ([127.0.0.1])
	by localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)
	with LMTP id 25765-01-16; Tue, 18 Apr 2006 09:08:47 -0700 (PDT)
Received: from [192.168.1.19] (unknown [63.203.238.114])
	by mail.archive.org (Postfix) with ESMTP id 4F2CC14156710;
	Tue, 18 Apr 2006 09:08:47 -0700 (PDT)
Message-ID: <44450151.8050003@archive.org>
Date: Tue, 18 Apr 2006 08:10:09 -0700
From: "stack@archive.org" <stack@archive.org>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US;
 rv:1.8.0.1) Gecko/20060130 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: I get checksum errors! Was: Re: io.skip.checksum.errors was:
 Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
 <44234989.7060906@archive.org> <443C23A1.7040209@archive.org>
 <443C304E.9080807@apache.org> <443C3F93.9090404@archive.org>
 <443D595F.3040008@apache.org> <443E8D24.7000206@archive.org>
 <443E8F29.6060309@apache.org> <443E9179.4020702@archive.org>
 <443FCB90.9000001@apache.org>
 <6A7BF6CE-ECBA-46CC-B8E5-2EA6B1044B48@yahoo-inc.com>
In-Reply-To: <6A7BF6CE-ECBA-46CC-B8E5-2EA6B1044B48@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: Debian amavisd-new at archive.org
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
> "Tells" is a bit strong!  I just asked if this might not be so.  I'm 
> asking folks I know who know more.  If anyone on this list does, 
> please educate me!

I'm trying to get our ops-head Joerg to chime in.  He has experience in 
this regard.

Regards the broader picture, I've not had checksum errors over the last 
3 to 4 days so have not had a chance to see what happens if the bad file 
is left in place (I've been running of late on what remains of my rack 
after a burnin using http://sourceforge.net/projects/va-ctcs/.  It found 
a bunch of issues -- particularly with RAM -- with our 
less-than-top-of-the-line "commodity PCs".  The rack has temporarily 
been reduced to half-strength.  But now I'm making progress on jobs -- 
no more ChecksumErrors, at least for the time being).

Thanks,
St.Ack



>
> e14
>
> On Apr 14, 2006, at 9:19 AM, Doug Cutting wrote:
>
>> Michael Stack wrote:
>>> Doug Cutting wrote:
>>>> In your case I don't think moving the files is helping at all, 
>>>> since the checksum errors are not caused by bad disk blocks, but 
>>>> rather by memory errors.  So not moving is fine.  Maybe we should 
>>>> add a config parameter to disable moving on checksum error?
>>> Let me try this.  Should probably subsume the 
>>> 'io.skip.checksum.errors' parameter.
>>
>> Eric Baldeschwieler tells me that most disks now automatically remap 
>> bad sectors (I didn't think IDE drives did this, but it seems they do 
>> now).  So we shouldn't need to move the files at all.
>>
>> How did things work when you disabled moving of files?
>>
>> Doug
>


From MAILER-DAEMON Tue Apr 18 15:23:23 2006
Return-Path: 
 <hadoop-dev-return-845-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9250 invoked from network); 18 Apr 2006 15:23:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 15:23:23 -0000
Received: (qmail 43115 invoked by uid 500); 18 Apr 2006 15:23:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43003 invoked by uid 500); 18 Apr 2006 15:23:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42993 invoked by uid 99); 18 Apr 2006 15:23:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:23:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:23:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 924B07142D1
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 15:22:17 +0000 (GMT)
Message-ID: <15238317.1145373737596.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 15:22:17 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-143) exception call stacks are word wrapped
 in webapp
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

exception call stacks are word wrapped in webapp
------------------------------------------------

         Key: HADOOP-143
         URL: http://issues.apache.org/jira/browse/HADOOP-143
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


The exception call stacks in the webapp word wrap, which makes them much harder to read. It is particularly unfortunate in the remote exceptions, which use a blank line to separate the local from the remote call stacks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 15:25:18 2006
Return-Path: 
 <hadoop-dev-return-846-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12546 invoked from network); 18 Apr 2006 15:25:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 15:25:18 -0000
Received: (qmail 47205 invoked by uid 500); 18 Apr 2006 15:25:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47155 invoked by uid 500); 18 Apr 2006 15:25:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47136 invoked by uid 99); 18 Apr 2006 15:25:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:25:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:25:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 419587142D1
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 15:24:18 +0000 (GMT)
Message-ID: <6223794.1145373858257.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 15:24:18 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-143) exception call stacks are word wrapped
 in webapp
In-Reply-To: <15238317.1145373737596.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-143?page=all ]

Owen O'Malley updated HADOOP-143:
---------------------------------

    Attachment: add-pre-for-exceptions.patch

Here is a patch that adds a "<pre>" and "</pre>" around the diagnostic info from the tasks.

> exception call stacks are word wrapped in webapp
> ------------------------------------------------
>
>          Key: HADOOP-143
>          URL: http://issues.apache.org/jira/browse/HADOOP-143
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: add-pre-for-exceptions.patch
>
> The exception call stacks in the webapp word wrap, which makes them much harder to read. It is particularly unfortunate in the remote exceptions, which use a blank line to separate the local from the remote call stacks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 15:51:31 2006
Return-Path: 
 <hadoop-dev-return-847-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30402 invoked from network); 18 Apr 2006 15:51:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 15:51:31 -0000
Received: (qmail 10267 invoked by uid 500); 18 Apr 2006 15:51:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10247 invoked by uid 500); 18 Apr 2006 15:51:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10235 invoked by uid 99); 18 Apr 2006 15:51:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:51:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:51:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7DF437142D1
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 15:50:17 +0000 (GMT)
Message-ID: <28728944.1145375417512.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 15:50:17 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-144) the dfs client id isn't relatable to
 the map/reduce task ids
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

the dfs client id isn't relatable to the map/reduce task ids
------------------------------------------------------------

         Key: HADOOP-144
         URL: http://issues.apache.org/jira/browse/HADOOP-144
     Project: Hadoop
        Type: Improvement

  Components: dfs  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


>>From the dfs logs you can't tell which map/reduce tasks where involved, which makes debugging harder.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 15:53:20 2006
Return-Path: 
 <hadoop-dev-return-848-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31897 invoked from network); 18 Apr 2006 15:53:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 15:53:20 -0000
Received: (qmail 14254 invoked by uid 500); 18 Apr 2006 15:53:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14234 invoked by uid 500); 18 Apr 2006 15:53:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14223 invoked by uid 99); 18 Apr 2006 15:53:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:53:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:53:19 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 286387142D1
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 15:52:20 +0000 (GMT)
Message-ID: <18986431.1145375540162.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 15:52:20 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-144) the dfs client id isn't relatable to
 the map/reduce task ids
In-Reply-To: <28728944.1145375417512.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-144?page=all ]

Owen O'Malley updated HADOOP-144:
---------------------------------

    Attachment: dfs-client-name.patch

This patch sets the task id in the task's local job conf and the dfs client will use the "mapred.task.id" from the Configuration, if it is defined.

> the dfs client id isn't relatable to the map/reduce task ids
> ------------------------------------------------------------
>
>          Key: HADOOP-144
>          URL: http://issues.apache.org/jira/browse/HADOOP-144
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: dfs-client-name.patch
>
> From the dfs logs you can't tell which map/reduce tasks where involved, which makes debugging harder.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 15:56:18 2006
Return-Path: 
 <hadoop-dev-return-849-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33803 invoked from network); 18 Apr 2006 15:56:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 15:56:18 -0000
Received: (qmail 22047 invoked by uid 500); 18 Apr 2006 15:56:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22024 invoked by uid 500); 18 Apr 2006 15:56:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22012 invoked by uid 99); 18 Apr 2006 15:56:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:56:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 08:56:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 13BFD7142D1
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 15:55:18 +0000 (GMT)
Message-ID: <31514535.1145375718072.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 15:55:18 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-144) the dfs client id isn't relatable to
 the map/reduce task ids
In-Reply-To: <28728944.1145375417512.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-144?page=comments#action_12374960 ] 

Owen O'Malley commented on HADOOP-144:
--------------------------------------

So instead of DFS client names like: DFSClient_2114239722
For map/reduce tasks, I get client names like: DFSClient_task_r_dgi5u

They are still random strings, but at least they are tied to the map/reduce logs.

> the dfs client id isn't relatable to the map/reduce task ids
> ------------------------------------------------------------
>
>          Key: HADOOP-144
>          URL: http://issues.apache.org/jira/browse/HADOOP-144
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: dfs-client-name.patch
>
> From the dfs logs you can't tell which map/reduce tasks where involved, which makes debugging harder.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 16:19:17 2006
Return-Path: 
 <hadoop-dev-return-851-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46295 invoked from network); 18 Apr 2006 16:19:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 16:19:17 -0000
Received: (qmail 63171 invoked by uid 500); 18 Apr 2006 16:19:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63151 invoked by uid 500); 18 Apr 2006 16:19:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63141 invoked by uid 99); 18 Apr 2006 16:19:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 09:19:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 09:19:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 544087142CE
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 16:18:17 +0000 (GMT)
Message-ID: <32797337.1145377097341.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 16:18:17 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-145) io.skip.checksum.errors property
 clashes with LocalFileSystem#reportChecksumFailure
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

io.skip.checksum.errors property clashes with LocalFileSystem#reportChecksumFailure
-----------------------------------------------------------------------------------

         Key: HADOOP-145
         URL: http://issues.apache.org/jira/browse/HADOOP-145
     Project: Hadoop
        Type: Bug

  Components: io  
    Reporter: stack@archive.org


Below is from email to the dev list on Tue, 11 Apr 2006 14:46:09 -0700.

Checksum errors seem to be a fact of life given the hardware we use.  They'll often cause my jobs to fail so I have been trying to figure how to just skip the bad records and files.  At the end is a note where Stefan pointed me at 'io.skip.checksum.errors'.   This property, when set, triggers special handling of checksum errors inside SequenceFile$Reader: If a checksum, try to skip to next record.  Only, this behavior can conflict with another checksum handler that moves aside the problematic file whenever a checksum error is found.  Below is from a recent log.

060411 202203 task_r_22esh3  Moving bad file /2/hadoop/tmp/task_r_22esh3/task_m_e3chga.out to /2/bad_files/task_m_e3chga.out.1707416716
060411 202203 task_r_22esh3  Bad checksum at 3578152. Skipping entries.
060411 202203 task_r_22esh3  Error running child
060411 202203 task_r_22esh3 java.nio.channels.ClosedChannelException
060411 202203 task_r_22esh3     at sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:89)
060411 202203 task_r_22esh3     at sun.nio.ch.FileChannelImpl.position(FileChannelImpl.java:276)
060411 202203 task_r_22esh3     at org.apache.hadoop.fs.LocalFileSystem$LocalFSFileInputStream.seek(LocalFileSystem.java:79)
060411 202203 task_r_22esh3     at org.apache.hadoop.fs.FSDataInputStream$Checker.seek(FSDataInputStream.java:67)
060411 202203 task_r_22esh3     at org.apache.hadoop.fs.FSDataInputStream$PositionCache.seek(FSDataInputStream.java:164)
060411 202203 task_r_22esh3     at org.apache.hadoop.fs.FSDataInputStream$Buffer.seek(FSDataInputStream.java:193)
060411 202203 task_r_22esh3     at org.apache.hadoop.fs.FSDataInputStream.seek(FSDataInputStream.java:243)
060411 202203 task_r_22esh3     at org.apache.hadoop.io.SequenceFile$Reader.seek(SequenceFile.java:420)
060411 202203 task_r_22esh3     at org.apache.hadoop.io.SequenceFile$Reader.sync(SequenceFile.java:431)
060411 202203 task_r_22esh3     at org.apache.hadoop.io.SequenceFile$Reader.handleChecksumException(SequenceFile.java:412)
060411 202203 task_r_22esh3     at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:389)
060411 202203 task_r_22esh3     at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:209)
060411 202203 task_r_22esh3     at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709)

(Ignore line numbers.  My code is a little different from main because I've other debugging code inside in SequenceFile.  Otherwise I'm running w/ head of hadoop).

The SequenceFile$Reader#handleChecksumException is trying to skip to next record but the file has been closed by the move-aside.


On the list there is some discussion on merit of moving aside file when bad checksum found.  I've trying to test what happens if we leave the file in place but haven't had a checksum error in a while.  

Opening this issue so place to fill in experience as we go.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 17:08:20 2006
Return-Path: 
 <hadoop-dev-return-852-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74443 invoked from network); 18 Apr 2006 17:08:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 17:08:20 -0000
Received: (qmail 64257 invoked by uid 500); 18 Apr 2006 17:08:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64236 invoked by uid 500); 18 Apr 2006 17:08:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64227 invoked by uid 99); 18 Apr 2006 17:08:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 10:08:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 10:08:19 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0E0E17142CE
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 17:07:19 +0000 (GMT)
Message-ID: <8309871.1145380039752.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 17:07:19 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-129) FileSystem should not name files with
 java.io.File
In-Reply-To: <2087016237.1144695959903.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-129?page=all ]
     
Doug Cutting resolved HADOOP-129:
---------------------------------

    Resolution: Fixed
     Assign To: Doug Cutting

I just committed this.  It was a big change.  I hope I haven't broken anything!

> FileSystem should not name files with java.io.File
> --------------------------------------------------
>
>          Key: HADOOP-129
>          URL: http://issues.apache.org/jira/browse/HADOOP-129
>      Project: Hadoop
>         Type: Improvement

>   Components: fs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: path.patch
>
> In Hadoop's FileSystem API, files are currently named using java.io.File.  This is confusing, as many methods on that class are inappropriate to call on Hadoop paths.  For example, calling isDirectory(), exists(), etc. on a java.io.File is not the same as calling FileSystem.isDirectory() or FileSystem.exists() passing that same file.  Using java.io.File also makes correct operation on Windows difficult, since java.io.File operates differently on Windows in order to accomodate Windows path names.  For example, new File("/foo") is not absolute on Windows, and prints its path as "\\foo", which causes confusion.
> To fix this we could replace the uses of java.io.File in the FileSystem API with String, a new FileName class, or perhaps java.net.URI.  The advantage of URI is that it can also naturally include the namenode host and port.  The disadvantage is that URI does not support tree operations like getParent().
> This change will cause a lot of incompatibility.  Thus it should probably be made early in a development cycle in order to maximize the time for folks to adapt to it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 17:24:18 2006
Return-Path: 
 <hadoop-dev-return-853-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83412 invoked from network); 18 Apr 2006 17:24:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 17:24:18 -0000
Received: (qmail 885 invoked by uid 500); 18 Apr 2006 17:24:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 861 invoked by uid 500); 18 Apr 2006 17:24:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 851 invoked by uid 99); 18 Apr 2006 17:24:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 10:24:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 10:24:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1297A7142CD
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 17:23:18 +0000 (GMT)
Message-ID: <2052690.1145380998067.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 17:23:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-144) the dfs client id isn't relatable to
 the map/reduce task ids
In-Reply-To: <28728944.1145375417512.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-144?page=all ]
     
Doug Cutting resolved HADOOP-144:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> the dfs client id isn't relatable to the map/reduce task ids
> ------------------------------------------------------------
>
>          Key: HADOOP-144
>          URL: http://issues.apache.org/jira/browse/HADOOP-144
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: dfs-client-name.patch
>
> From the dfs logs you can't tell which map/reduce tasks where involved, which makes debugging harder.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 17:47:18 2006
Return-Path: 
 <hadoop-dev-return-854-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93077 invoked from network); 18 Apr 2006 17:47:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 17:47:18 -0000
Received: (qmail 34711 invoked by uid 500); 18 Apr 2006 17:47:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34688 invoked by uid 500); 18 Apr 2006 17:47:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34679 invoked by uid 99); 18 Apr 2006 17:47:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 10:47:18 -0700
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 10:47:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 87260410005
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 17:46:18 +0000 (GMT)
Message-ID: <26176614.1145382378550.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 17:46:18 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-134) JobTracker trapped in a loop if it
 fails to localize a task
In-Reply-To: <35583916.1144972740231.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-134?page=all ]

Owen O'Malley reassigned HADOOP-134:
------------------------------------

    Assign To: Owen O'Malley

> JobTracker trapped in a loop if it fails to localize a task
> -----------------------------------------------------------
>
>          Key: HADOOP-134
>          URL: http://issues.apache.org/jira/browse/HADOOP-134
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Runping Qi
>     Assignee: Owen O'Malley
>  Attachments: task-startup-safety.patch
>
> The symptoms:
>     When I ran  jobs on a big cluster, I noticed that some jobs got stucked. Some map tasks never got started. When I look at the log of the task tracker responsible for the tasks, I saw the following exceptions:
> 060413 160702 Lost connection to JobTracker [kry1040/72.30.116.100:50020].  Retrying...
> java.io.IOException: No valid local directories in property: mapred.local.dir
>         at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:282)
>         at org.apache.hadoop.mapred.JobConf.getLocalFile(JobConf.java:127)
>         at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:391)
>         at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.<init>(TaskTracker.java:383)
>         at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:270)
>         at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:336)
>         at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:756)
> The reason for the exception is that the directory hadoop/mapred/local has "wrong" owner, thus the task tracker cannot access to it.
> This caused the task tracker stucked into the following loops:
>             while (running) {
>                 boolean staleState = false;
>                 try {
>                     // This while-loop attempts reconnects if we get network errors
>                     while (running && ! staleState) {
>                         try {
>                             if (offerService() == STALE_STATE) {
>                                 staleState = true;
>                             }
>                         } catch (Exception ex) {
>                             LOG.log(Level.INFO, "Lost connection to JobTracker [" + jobTrackAddr + "].  Retrying...", ex);
>                             try {
>                                 Thread.sleep(5000);
>                             } catch (InterruptedException ie) {
>                             }
>                         }
>                     }
>                 } finally {
>                     close();
>                 }
>                 LOG.info("Reinitializing local state");
>                 initialize();
>             }
> Issue 1:
>     Method offerService() must catch and handle the exceptions that may be thrown from new TaskInProgress() call, and report back to the job tracker if it cannot run the task. This way, the task can be assigned to other task tracker.
> Issue 2:
>     The taskTracker should check whether it can access to the local dir at the initialization time, before taking any tasks.
> Runping

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 18:33:19 2006
Return-Path: 
 <hadoop-dev-return-855-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17181 invoked from network); 18 Apr 2006 18:33:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 18:33:19 -0000
Received: (qmail 20675 invoked by uid 500); 18 Apr 2006 18:33:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20655 invoked by uid 500); 18 Apr 2006 18:33:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20645 invoked by uid 99); 18 Apr 2006 18:33:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 11:33:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 11:33:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 382DB7142CD
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 18:32:18 +0000 (GMT)
Message-ID: <26319688.1145385138227.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 18:32:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374976 ] 

Doug Cutting commented on HADOOP-133:
-------------------------------------

Searching around a bit, I found a few folks who suggest using -Xrs if you're seeing exit code 143, since this can be caused by signals.  So you might try adding -Xrs to mapred.child.java.opts and see if that helps any.

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 18:43:23 2006
Return-Path: 
 <hadoop-dev-return-856-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27231 invoked from network); 18 Apr 2006 18:43:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 18:43:23 -0000
Received: (qmail 39847 invoked by uid 500); 18 Apr 2006 18:43:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39828 invoked by uid 500); 18 Apr 2006 18:43:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39815 invoked by uid 99); 18 Apr 2006 18:43:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 11:43:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 11:43:20 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8FF207142CD
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 18:42:21 +0000 (GMT)
Message-ID: <23502121.1145385741586.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 18:42:21 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-133?page=comments#action_12374977 ] 

Doug Cutting commented on HADOOP-133:
-------------------------------------

The 143's could be normal.  We call process.destroy() to stop a task. This probably sends a SIGTERM, and SIGTERM causes an exit 143, according to http://scv.bu.edu/SCV/FAQ/batchcode.txt.



> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 19:00:22 2006
Return-Path: 
 <hadoop-dev-return-857-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35263 invoked from network); 18 Apr 2006 19:00:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 19:00:22 -0000
Received: (qmail 69675 invoked by uid 500); 18 Apr 2006 19:00:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69563 invoked by uid 500); 18 Apr 2006 19:00:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69541 invoked by uid 99); 18 Apr 2006 19:00:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:00:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:00:21 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4CAEF7142D1
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 18:59:22 +0000 (GMT)
Message-ID: <19174116.1145386762310.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 18:59:22 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-118) Namenode does not always clean up
 pendingCreates
In-Reply-To: <1720783348.1144168243567.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-118?page=all ]
     
Doug Cutting resolved HADOOP-118:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> Namenode does not always clean up pendingCreates
> ------------------------------------------------
>
>          Key: HADOOP-118
>          URL: http://issues.apache.org/jira/browse/HADOOP-118
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>  Environment: 195 node cluster running redhat linux (2.6 kernel)
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: release-create-locks.patch
>
> In some failure modes, the pending creates list is not cleaned up and prevents that file from ever being created.
> When I try to create the file after the first job was killed (hours previously), I get:
> 060404 084619 Cannot start file because pendingCreates is non-null. src=/user/oom/rand/part000118
> 060404 084619 Server handler 0 on 8020 call error: java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
> java.io.IOException: Cannot create file /user/oom/rand/part000118 on client DFSClient_-1656137458
>         at org.apache.hadoop.dfs.NameNode.create(NameNode.java:147)
>         at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 19:06:18 2006
Return-Path: 
 <hadoop-dev-return-858-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39590 invoked from network); 18 Apr 2006 19:06:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 19:06:18 -0000
Received: (qmail 87391 invoked by uid 500); 18 Apr 2006 19:06:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87373 invoked by uid 500); 18 Apr 2006 19:06:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87363 invoked by uid 99); 18 Apr 2006 19:06:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:06:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:06:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1977E410005
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 19:05:18 +0000 (GMT)
Message-ID: <20759541.1145387118050.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 19:05:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-138) stop all tasks
In-Reply-To: <81187011.1145066400494.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-138?page=comments#action_12374982 ] 

Doug Cutting commented on HADOOP-138:
-------------------------------------

I just committed this.  Thanks, Stefan!

> stop all tasks
> --------------
>
>          Key: HADOOP-138
>          URL: http://issues.apache.org/jira/browse/HADOOP-138
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.0, 0.1.1
>     Reporter: Stefan Groschupf
>     Priority: Trivial
>  Attachments: stopAllTasks.patch
>
> When a tasktracker runs X tasks it require X heartbeats to stop all jobs.
> Stop all tasks with one heartbeat improve the availability and free resources faster.   

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 19:21:33 2006
Return-Path: 
 <hadoop-dev-return-859-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51909 invoked from network); 18 Apr 2006 19:21:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 19:21:33 -0000
Received: (qmail 6368 invoked by uid 500); 18 Apr 2006 19:21:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5514 invoked by uid 500); 18 Apr 2006 19:21:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5492 invoked by uid 99); 18 Apr 2006 19:21:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:21:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:21:21 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A38A4410005
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 19:20:22 +0000 (GMT)
Message-ID: <33379463.1145388022666.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 19:20:22 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-139) Deadlock in LocalFileSystem
 lock/release
In-Reply-To: <96946734.1145072400288.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-139?page=comments#action_12374983 ] 

Doug Cutting commented on HADOOP-139:
-------------------------------------

I just committed this.  Thanks, Igor!

The patch did not apply directly, due to other changes made to Hadoop since you contributed it.  So I had to apply parts of it manually.  Please check that it still looks correct.  Thanks!

> Deadlock in LocalFileSystem lock/release
> ----------------------------------------
>
>          Key: HADOOP-139
>          URL: http://issues.apache.org/jira/browse/HADOOP-139
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>     Reporter: Igor Bolotin
>  Attachments: deadlock.patch
>
> LocalFileSystem lock/release methods marked synchronized and inside they lock file channel - this produces deadlock situation. Let's see how it happens: 
> 1. First thread locks the file and starts some long-running process.
> 2. Second thread tries to lock the file and it blocks inside channel lock method. It  keeps LocalFileSystem instance "locked" as well. 
> 3. First thread finished it's processing and tries to release lock - it blocks because LocalFileSystem instance is "locked" by second thread - both threads are waiting to each other. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 19:25:19 2006
Return-Path: 
 <hadoop-dev-return-860-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55972 invoked from network); 18 Apr 2006 19:25:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 19:25:19 -0000
Received: (qmail 15055 invoked by uid 500); 18 Apr 2006 19:25:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15038 invoked by uid 500); 18 Apr 2006 19:25:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15029 invoked by uid 99); 18 Apr 2006 19:25:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:25:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:25:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E0641410005
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 19:24:18 +0000 (GMT)
Message-ID: <7077165.1145388258907.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 19:24:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-140) General documentation
In-Reply-To: <87551851.1145084401166.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-140?page=comments#action_12374984 ] 

Doug Cutting commented on HADOOP-140:
-------------------------------------

This looks mostly correct and is a very useful introduction.

Can you please post it to the wiki: http://wiki.apache.org/lucene-hadoop/

Thanks!

> General documentation
> ---------------------
>
>          Key: HADOOP-140
>          URL: http://issues.apache.org/jira/browse/HADOOP-140
>      Project: Hadoop
>         Type: Wish

>     Reporter: Teppo Kurki
>     Priority: Minor
>  Attachments: mapred.xml
>
> Getting a grasp of how Hadoop works is a little hard, because one first has to get a grip on the whole MapReduce thing and then figure out how it is carried out in Hadoop. Judging from the mailing list a little more general documentation would help a lot.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 19:29:19 2006
Return-Path: 
 <hadoop-dev-return-861-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58283 invoked from network); 18 Apr 2006 19:29:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 19:29:19 -0000
Received: (qmail 24715 invoked by uid 500); 18 Apr 2006 19:29:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24665 invoked by uid 500); 18 Apr 2006 19:29:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24635 invoked by uid 99); 18 Apr 2006 19:29:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:29:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:29:11 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3IJSfbL020191
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 15:28:42 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3IJSLxv140380;
	Tue, 18 Apr 2006 15:28:34 -0400
Message-ID: <44453DD2.8080208@apache.org>
Date: Tue, 18 Apr 2006 12:28:18 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: IdentityMapper
References: <579105BD-4157-4E70-986F-A1F23B6AD180@media-style.com>
In-Reply-To: <579105BD-4157-4E70-986F-A1F23B6AD180@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Stefan Groschupf wrote:
> what is the reason that each job that has no mapper defined runs the  
> IdentityMapper?
> Handling different formats (as discussed) between mapping and  reducing 
> is difficult.
> Having one job that just map in the one format and having another job  
> that just reduce
> in a other format would be a nice workaround of the format problem  but 
> the IdentityMapper makes this workaround impossible.

Stefan,

I don't understand the problem here.  Some map function is required for 
any data to make it to reduce.  IdentityMapper simply copies all map 
input without altering it.  How does this cause you problems?  Would you 
prefer a NullMapper by default, that does nothing?  That would result in 
no output sent to reduce.

Thanks,

Doug

From MAILER-DAEMON Tue Apr 18 19:38:19 2006
Return-Path: 
 <hadoop-dev-return-862-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66142 invoked from network); 18 Apr 2006 19:38:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 19:38:19 -0000
Received: (qmail 41982 invoked by uid 500); 18 Apr 2006 19:38:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41808 invoked by uid 500); 18 Apr 2006 19:38:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41798 invoked by uid 99); 18 Apr 2006 19:38:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:38:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:38:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1EFFA7142C7
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 19:37:18 +0000 (GMT)
Message-ID: <5859238.1145389038118.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 19:37:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-139) Deadlock in LocalFileSystem
 lock/release
In-Reply-To: <96946734.1145072400288.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-139?page=all ]
     
Doug Cutting resolved HADOOP-139:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Doug Cutting

> Deadlock in LocalFileSystem lock/release
> ----------------------------------------
>
>          Key: HADOOP-139
>          URL: http://issues.apache.org/jira/browse/HADOOP-139
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>     Reporter: Igor Bolotin
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: deadlock.patch
>
> LocalFileSystem lock/release methods marked synchronized and inside they lock file channel - this produces deadlock situation. Let's see how it happens: 
> 1. First thread locks the file and starts some long-running process.
> 2. Second thread tries to lock the file and it blocks inside channel lock method. It  keeps LocalFileSystem instance "locked" as well. 
> 3. First thread finished it's processing and tries to release lock - it blocks because LocalFileSystem instance is "locked" by second thread - both threads are waiting to each other. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 19:50:27 2006
Return-Path: 
 <hadoop-dev-return-863-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70957 invoked from network); 18 Apr 2006 19:50:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 19:50:27 -0000
Received: (qmail 57882 invoked by uid 500); 18 Apr 2006 19:50:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57854 invoked by uid 500); 18 Apr 2006 19:50:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57844 invoked by uid 99); 18 Apr 2006 19:50:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:50:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:50:26 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0DF6F7142C9
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 19:49:27 +0000 (GMT)
Message-ID: <29890549.1145389767048.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 19:49:27 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-135) Potential deadlock in JobTracker.
In-Reply-To: <69894223.1144974540263.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-135?page=all ]

Doug Cutting updated HADOOP-135:
--------------------------------

    Component: mapred

> Potential deadlock in JobTracker.
> ---------------------------------
>
>          Key: HADOOP-135
>          URL: http://issues.apache.org/jira/browse/HADOOP-135
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Konstantin Shvachko

>
> org.apache.hadoop.mapred.JobTracker.RetireJobs.run()
> locks resources in this order
>                 synchronized (jobs) {
>                     synchronized (jobInitQueue) {
>                         synchronized (jobsByArrival) {
> org.apache.hadoop.mapred.JobTracker.submitJob()
> locks resources in a different order
>         synchronized (jobs) {
>             synchronized (jobsByArrival) {
>                 synchronized (jobInitQueue) {
> This potentially can lead to a deadlock.
> Unless there is common lock on top of it in which case these
> three locks are redundant.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 19:52:20 2006
Return-Path: 
 <hadoop-dev-return-864-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71797 invoked from network); 18 Apr 2006 19:52:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 19:52:20 -0000
Received: (qmail 60515 invoked by uid 500); 18 Apr 2006 19:52:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60428 invoked by uid 500); 18 Apr 2006 19:52:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60412 invoked by uid 99); 18 Apr 2006 19:52:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:52:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 12:52:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 16A767142C9
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 19:51:18 +0000 (GMT)
Message-ID: <7643331.1145389878084.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 19:51:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-114) Non-informative error message
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-114?page=all ]
     
Doug Cutting resolved HADOOP-114:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Michael!

> Non-informative error message
> -----------------------------
>
>          Key: HADOOP-114
>          URL: http://issues.apache.org/jira/browse/HADOOP-114
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Rod Taylor
>     Assignee: Doug Cutting
>     Priority: Trivial
>      Fix For: 0.2
>  Attachments: nutch241-tasktracker-warning-correction.patch
>
> 060330 105006 mapred.child.heap.size is deprecated. Use mapred.child.heap.size instead. Meantime, interpolated child.heap.size into child.java.opt: -Xmx200m
> The instructions inform you to use the deprecated option.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 21:18:53 2006
Return-Path: 
 <hadoop-dev-return-865-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14616 invoked from network); 18 Apr 2006 21:18:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 21:18:53 -0000
Received: (qmail 86664 invoked by uid 500); 18 Apr 2006 21:18:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86649 invoked by uid 500); 18 Apr 2006 21:18:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86640 invoked by uid 99); 18 Apr 2006 21:18:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:18:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [65.60.70.164] (HELO mail.interchangeusa.com) (65.60.70.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:18:51 -0700
Received: from exchange01.eliberation.com ([10.1.1.40]) by
 mail.interchangeusa.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 18 Apr 2006 14:18:30 -0700
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: quoted-printable
Subject: RE: [jira] Commented: (HADOOP-140) General documentation
Date: Tue, 18 Apr 2006 14:18:30 -0700
Message-ID: 
 <7A58834E16A27B43B032FEB5B6C4A4D703EFC1E6@exchange01.eLiberation.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: [jira] Commented: (HADOOP-140) General documentation
thread-index: AcZjHesV6DCZtlAyRtCCxCT641DqkAAD28Sg
From: "Scott Simpson" <ssimpson@InterchangeUSA.com>
To: <hadoop-dev@lucene.apache.org>
X-OriginalArrivalTime: 18 Apr 2006 21:18:30.0611 (UTC)
 FILETIME=[A432D230:01C6632D]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

=20
> Doug Cutting commented on HADOOP-140:
> -------------------------------------
>
> This looks mostly correct and is a very useful introduction.
>=20
> Can you please post it to the wiki:
http://wiki.apache.org/lucene-hadoop/
>=20
> Thanks!
>=20
>> General documentation
>> ---------------------
>>
>>          Key: HADOOP-140
>>          URL: http://issues.apache.org/jira/browse/HADOOP-140
>>      Project: Hadoop
>>         Type: Wish
>>
>>     Reporter: Teppo Kurki
>>     Priority: Minor
>>  Attachments: mapred.xml
>>
>> Getting a grasp of how Hadoop works is a little hard, because one
first has to get a grip on the whole MapReduce thing and then figure out
how it is carried out in Hadoop. Judging from the mailing list a little
more general documentation would help a lot.

Amen brother. The quicker I can get a look at this the better. Thanks.
	Scott

From MAILER-DAEMON Tue Apr 18 21:44:24 2006
Return-Path: 
 <hadoop-dev-return-866-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30308 invoked from network); 18 Apr 2006 21:44:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 21:44:24 -0000
Received: (qmail 35305 invoked by uid 500); 18 Apr 2006 21:44:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35284 invoked by uid 500); 18 Apr 2006 21:44:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35275 invoked by uid 99); 18 Apr 2006 21:44:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:44:24 -0700
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:44:23 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 419AC7142C5
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 21:43:24 +0000 (GMT)
Message-ID: <22364658.1145396604265.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 21:43:24 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-134) JobTracker trapped in a loop if it
 fails to localize a task
In-Reply-To: <35583916.1144972740231.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-134?page=all ]

Owen O'Malley updated HADOOP-134:
---------------------------------

    Attachment: task-startup-safety-2.patch

This is the previous patch updated to reflect the Path changes that went in today.

> JobTracker trapped in a loop if it fails to localize a task
> -----------------------------------------------------------
>
>          Key: HADOOP-134
>          URL: http://issues.apache.org/jira/browse/HADOOP-134
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Runping Qi
>     Assignee: Owen O'Malley
>  Attachments: task-startup-safety-2.patch, task-startup-safety.patch
>
> The symptoms:
>     When I ran  jobs on a big cluster, I noticed that some jobs got stucked. Some map tasks never got started. When I look at the log of the task tracker responsible for the tasks, I saw the following exceptions:
> 060413 160702 Lost connection to JobTracker [kry1040/72.30.116.100:50020].  Retrying...
> java.io.IOException: No valid local directories in property: mapred.local.dir
>         at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:282)
>         at org.apache.hadoop.mapred.JobConf.getLocalFile(JobConf.java:127)
>         at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:391)
>         at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.<init>(TaskTracker.java:383)
>         at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:270)
>         at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:336)
>         at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:756)
> The reason for the exception is that the directory hadoop/mapred/local has "wrong" owner, thus the task tracker cannot access to it.
> This caused the task tracker stucked into the following loops:
>             while (running) {
>                 boolean staleState = false;
>                 try {
>                     // This while-loop attempts reconnects if we get network errors
>                     while (running && ! staleState) {
>                         try {
>                             if (offerService() == STALE_STATE) {
>                                 staleState = true;
>                             }
>                         } catch (Exception ex) {
>                             LOG.log(Level.INFO, "Lost connection to JobTracker [" + jobTrackAddr + "].  Retrying...", ex);
>                             try {
>                                 Thread.sleep(5000);
>                             } catch (InterruptedException ie) {
>                             }
>                         }
>                     }
>                 } finally {
>                     close();
>                 }
>                 LOG.info("Reinitializing local state");
>                 initialize();
>             }
> Issue 1:
>     Method offerService() must catch and handle the exceptions that may be thrown from new TaskInProgress() call, and report back to the job tracker if it cannot run the task. This way, the task can be assigned to other task tracker.
> Issue 2:
>     The taskTracker should check whether it can access to the local dir at the initialization time, before taking any tasks.
> Runping

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 21:48:18 2006
Return-Path: 
 <hadoop-dev-return-867-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32414 invoked from network); 18 Apr 2006 21:48:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 21:48:18 -0000
Received: (qmail 41594 invoked by uid 500); 18 Apr 2006 21:48:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41576 invoked by uid 500); 18 Apr 2006 21:48:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41566 invoked by uid 99); 18 Apr 2006 21:48:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:48:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:48:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 148C37142C5
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 21:47:18 +0000 (GMT)
Message-ID: <5011285.1145396838080.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 21:47:18 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-133?page=all ]

Owen O'Malley updated HADOOP-133:
---------------------------------

    Attachment: ping-stability.patch

Here is a patch that allows retries for communication problems on the ping from the Task to the TaskTracker. It changes the interface of ping from returning nothing to returning a boolean. A false return value means the child should immediately go away. Exceptions are treated as temporary problems and given 3 chances. This patch also changes the exit code to be either 65 (asked to kill self) or 66 (ping exception).

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: ping-stability.patch
>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 21:52:19 2006
Return-Path: 
 <hadoop-dev-return-868-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34500 invoked from network); 18 Apr 2006 21:52:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 21:52:19 -0000
Received: (qmail 49813 invoked by uid 500); 18 Apr 2006 21:52:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49765 invoked by uid 500); 18 Apr 2006 21:52:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49756 invoked by uid 99); 18 Apr 2006 21:52:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:52:18 -0700
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:52:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 96028410005
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 21:51:18 +0000 (GMT)
Message-ID: <21842580.1145397078598.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 21:51:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-134) JobTracker trapped in a loop if it
 fails to localize a task
In-Reply-To: <35583916.1144972740231.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-134?page=all ]
     
Doug Cutting resolved HADOOP-134:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Owen!

> JobTracker trapped in a loop if it fails to localize a task
> -----------------------------------------------------------
>
>          Key: HADOOP-134
>          URL: http://issues.apache.org/jira/browse/HADOOP-134
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Runping Qi
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: task-startup-safety-2.patch, task-startup-safety.patch
>
> The symptoms:
>     When I ran  jobs on a big cluster, I noticed that some jobs got stucked. Some map tasks never got started. When I look at the log of the task tracker responsible for the tasks, I saw the following exceptions:
> 060413 160702 Lost connection to JobTracker [kry1040/72.30.116.100:50020].  Retrying...
> java.io.IOException: No valid local directories in property: mapred.local.dir
>         at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:282)
>         at org.apache.hadoop.mapred.JobConf.getLocalFile(JobConf.java:127)
>         at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:391)
>         at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.<init>(TaskTracker.java:383)
>         at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:270)
>         at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:336)
>         at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:756)
> The reason for the exception is that the directory hadoop/mapred/local has "wrong" owner, thus the task tracker cannot access to it.
> This caused the task tracker stucked into the following loops:
>             while (running) {
>                 boolean staleState = false;
>                 try {
>                     // This while-loop attempts reconnects if we get network errors
>                     while (running && ! staleState) {
>                         try {
>                             if (offerService() == STALE_STATE) {
>                                 staleState = true;
>                             }
>                         } catch (Exception ex) {
>                             LOG.log(Level.INFO, "Lost connection to JobTracker [" + jobTrackAddr + "].  Retrying...", ex);
>                             try {
>                                 Thread.sleep(5000);
>                             } catch (InterruptedException ie) {
>                             }
>                         }
>                     }
>                 } finally {
>                     close();
>                 }
>                 LOG.info("Reinitializing local state");
>                 initialize();
>             }
> Issue 1:
>     Method offerService() must catch and handle the exceptions that may be thrown from new TaskInProgress() call, and report back to the job tracker if it cannot run the task. This way, the task can be assigned to other task tracker.
> Issue 2:
>     The taskTracker should check whether it can access to the local dir at the initialization time, before taking any tasks.
> Runping

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 21:57:34 2006
Return-Path: 
 <hadoop-dev-return-869-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36082 invoked from network); 18 Apr 2006 21:57:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 21:57:34 -0000
Received: (qmail 55598 invoked by uid 500); 18 Apr 2006 21:57:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55568 invoked by uid 500); 18 Apr 2006 21:57:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55551 invoked by uid 99); 18 Apr 2006 21:57:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:57:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 14:57:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B101F7142C5
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 21:56:19 +0000 (GMT)
Message-ID: <11128425.1145397379721.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 21:56:19 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-142) failed tasks should be rescheduled on
 different hosts after other jobs
In-Reply-To: <30085808.1145312777394.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-142?page=all ]

Owen O'Malley updated HADOOP-142:
---------------------------------

    Attachment: no-repeat-failures.patch

This patch does three things:
   1. When a task fails, it sets the following task to be the first to be checked for assignment to a TaskTracker.
   2. Tasks prefer not to run on TaskTrackers where they have failed before.
   3.  Speculative tasks will not run on TaskTrackers where they have failed.

> failed tasks should be rescheduled on different hosts after other jobs
> ----------------------------------------------------------------------
>
>          Key: HADOOP-142
>          URL: http://issues.apache.org/jira/browse/HADOOP-142
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: no-repeat-failures.patch
>
> Currently when tasks fail, they are usually rerun immediately on the same host. This causes problems in a couple of ways. 
>   1.The task is more likely to fail on the same host. 
>   2.If there is cleanup code (such as clearing pendingCreates) it does not always run immediately, leading to cascading failures.
> For a first pass, I propose that when a task fails, we start the scan for new tasks to launch at the following task of the same type (within that job). So if maps[99] fails, when we are looking to assign new map tasks from this job, we scan like maps[100]...maps[N], maps[0]..,maps[99].
> A more involved change would avoid running tasks on nodes where it has failed before. This is a little tricky, because you don't want to prevent re-excution of tasks on 1 node clusters and the job tracker needs to schedule one task tracker at a time.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 22:06:18 2006
Return-Path: 
 <hadoop-dev-return-870-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39507 invoked from network); 18 Apr 2006 22:06:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 22:06:18 -0000
Received: (qmail 69472 invoked by uid 500); 18 Apr 2006 22:06:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69448 invoked by uid 500); 18 Apr 2006 22:06:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69439 invoked by uid 99); 18 Apr 2006 22:06:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 15:06:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 15:06:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7E8F17142C5
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 22:05:18 +0000 (GMT)
Message-ID: <18431425.1145397918515.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 22:05:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-133) the TaskTracker.Child.ping thread
 calls exit
In-Reply-To: <83642710.1144962600236.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-133?page=all ]
     
Doug Cutting resolved HADOOP-133:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Owen!

> the TaskTracker.Child.ping thread calls exit
> --------------------------------------------
>
>          Key: HADOOP-133
>          URL: http://issues.apache.org/jira/browse/HADOOP-133
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: ping-stability.patch
>
> The TaskTracker.Child.startPinging thread calls exit if the TaskTracker doesn't respond. Calling exit in a mutli-threaded program is really problematic. In particular, it prevents cleanup/finally clauses from running. We need to move to a model where it uses Thread.interrupt(), which means we need to check the interrupt flag in place in the map loop and reduce loop and stop masking the InterruptExceptions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 22:08:17 2006
Return-Path: 
 <hadoop-dev-return-871-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40319 invoked from network); 18 Apr 2006 22:08:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 22:08:17 -0000
Received: (qmail 71712 invoked by uid 500); 18 Apr 2006 22:08:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71600 invoked by uid 500); 18 Apr 2006 22:08:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71591 invoked by uid 99); 18 Apr 2006 22:08:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 15:08:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 15:08:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 743827142C2
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 22:07:17 +0000 (GMT)
Message-ID: <2179039.1145398037471.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 22:07:17 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-146) potential conflict in block id's,
 leading to data corruption
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

potential conflict in block id's, leading to data corruption
------------------------------------------------------------

         Key: HADOOP-146
         URL: http://issues.apache.org/jira/browse/HADOOP-146
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.1.0, 0.1.1    
    Reporter: Yoram Arnon
 Assigned to: Konstantin Shvachko 
     Fix For: 0.3


currently, block id's are generated randomly, and are not tested for collisions with existing id's.
while ids are 64 bits, given enough time and a large enough FS, collisions are expected.
when a collision occurs, a random subset of blocks with that id will be removed as extra replicas, and the contents of that portion of the containing file are one random version of the block.
to solve this one could check for id collision when creating a new block, getting a new id in case of conflict. This approach requires the name node to keep track of all existing block id's (rather than just the ones who have reported in), and to identify old versions of a block id as in valid (in case a data node dies, a file is deleted, then a block id is reused for a new file).
Alternatively, one could simply use sequential block id's. Here the downsides are: 
1. migration from an existing file system is hard, requiring compaction of the entire FS
2. once you cycle through 64 bits of id's (quite a few years at full blast), you're in trouble again (or run occasional/background compaction)
3. you must never lose the high watermark block id.


synchronized Block allocateBlock(UTF8 src) {
        Block b = new Block();
        FileUnderConstruction v = (FileUnderConstruction) pendingCreates.get(src);
        v.add(b);
        pendingCreateBlocks.add(b);
        return b;
    }


static Random r = new Random();

    /**
     */
    public Block() {
        this.blkid = r.nextLong();
        this.len = 0;
    }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 22:10:25 2006
Return-Path: 
 <hadoop-dev-return-872-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41005 invoked from network); 18 Apr 2006 22:10:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 22:10:25 -0000
Received: (qmail 75522 invoked by uid 500); 18 Apr 2006 22:10:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75498 invoked by uid 500); 18 Apr 2006 22:10:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75488 invoked by uid 99); 18 Apr 2006 22:10:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 15:10:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 15:10:24 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CD9C67142C5
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 22:09:24 +0000 (GMT)
Message-ID: <29344569.1145398164838.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 22:09:24 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-142) failed tasks should be rescheduled on
 different hosts after other jobs
In-Reply-To: <30085808.1145312777394.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-142?page=all ]
     
Doug Cutting resolved HADOOP-142:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> failed tasks should be rescheduled on different hosts after other jobs
> ----------------------------------------------------------------------
>
>          Key: HADOOP-142
>          URL: http://issues.apache.org/jira/browse/HADOOP-142
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: no-repeat-failures.patch
>
> Currently when tasks fail, they are usually rerun immediately on the same host. This causes problems in a couple of ways. 
>   1.The task is more likely to fail on the same host. 
>   2.If there is cleanup code (such as clearing pendingCreates) it does not always run immediately, leading to cascading failures.
> For a first pass, I propose that when a task fails, we start the scan for new tasks to launch at the following task of the same type (within that job). So if maps[99] fails, when we are looking to assign new map tasks from this job, we scan like maps[100]...maps[N], maps[0]..,maps[99].
> A more involved change would avoid running tasks on nodes where it has failed before. This is a little tricky, because you don't want to prevent re-excution of tasks on 1 node clusters and the job tracker needs to schedule one task tracker at a time.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 18 23:40:20 2006
Return-Path: 
 <hadoop-dev-return-873-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81397 invoked from network); 18 Apr 2006 23:40:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Apr 2006 23:40:20 -0000
Received: (qmail 72368 invoked by uid 500); 18 Apr 2006 23:40:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72348 invoked by uid 500); 18 Apr 2006 23:40:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72338 invoked by uid 99); 18 Apr 2006 23:40:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 16:40:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 16:40:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 46AC77142C5
	for <hadoop-dev@lucene.apache.org>; Tue, 18 Apr 2006 23:39:19 +0000 (GMT)
Message-ID: <18073387.1145403559286.JavaMail.jira@brutus>
Date: Tue, 18 Apr 2006 23:39:19 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-146) potential conflict in block id's,
 leading to data corruption
In-Reply-To: <2179039.1145398037471.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-146?page=comments#action_12375011 ] 

Doug Cutting commented on HADOOP-146:
-------------------------------------

I'd vote for sequential allocation.  It will take a *really* long time to cycle through all ids.  Migration should not be expensive, since it just requires renaming block files, not copying them.  The high-watermark block id can be logged with the block->name table.

Here's one way to migrate: initially the high-water-mark id is zero.  So all blocks in the name table are out-of-range, and hence need renaming.  Renaming can be handled like other blockwork: the namenode can give datanodes rename commands.  While a block is being renamed it must be kept in side tables, so that, e.g., requests to read files whose blocks are partially renamed can still be handled.


> potential conflict in block id's, leading to data corruption
> ------------------------------------------------------------
>
>          Key: HADOOP-146
>          URL: http://issues.apache.org/jira/browse/HADOOP-146
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>      Fix For: 0.3

>
> currently, block id's are generated randomly, and are not tested for collisions with existing id's.
> while ids are 64 bits, given enough time and a large enough FS, collisions are expected.
> when a collision occurs, a random subset of blocks with that id will be removed as extra replicas, and the contents of that portion of the containing file are one random version of the block.
> to solve this one could check for id collision when creating a new block, getting a new id in case of conflict. This approach requires the name node to keep track of all existing block id's (rather than just the ones who have reported in), and to identify old versions of a block id as in valid (in case a data node dies, a file is deleted, then a block id is reused for a new file).
> Alternatively, one could simply use sequential block id's. Here the downsides are: 
> 1. migration from an existing file system is hard, requiring compaction of the entire FS
> 2. once you cycle through 64 bits of id's (quite a few years at full blast), you're in trouble again (or run occasional/background compaction)
> 3. you must never lose the high watermark block id.
> synchronized Block allocateBlock(UTF8 src) {
>         Block b = new Block();
>         FileUnderConstruction v = (FileUnderConstruction) pendingCreates.get(src);
>         v.add(b);
>         pendingCreateBlocks.add(b);
>         return b;
>     }
> static Random r = new Random();
>     /**
>      */
>     public Block() {
>         this.blkid = r.nextLong();
>         this.len = 0;
>     }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 00:55:18 2006
Return-Path: 
 <hadoop-dev-return-874-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6079 invoked from network); 19 Apr 2006 00:55:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 00:55:18 -0000
Received: (qmail 39754 invoked by uid 500); 19 Apr 2006 00:55:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39730 invoked by uid 500); 19 Apr 2006 00:55:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39717 invoked by uid 99); 19 Apr 2006 00:55:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 17:55:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 17:55:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 668417142C5
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 00:54:17 +0000 (GMT)
Message-ID: <27888818.1145408057411.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 00:54:17 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-147) MapTask removed mapout files before
 the reduce tasks copy them
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

MapTask removed mapout files before the reduce tasks copy them 
---------------------------------------------------------------

         Key: HADOOP-147
         URL: http://issues.apache.org/jira/browse/HADOOP-147
     Project: Hadoop
        Type: Bug

    Reporter: Runping Qi




I was running a job on a cluster of 138 nodes. The job had 1050 map tasks and 128 reduce tasks. It stucked at the reduce stage.
All the reduce tasks were trying to copy file from a map task with the following status show on the web interface:

reduce > copy > task_m_ehz5q1@kry1262.inktomisearch.com:60040

However, the log on the machine kry1262 (where the map task task_m_ehz5q1 ran) showed that the map task finished even before the 
reduce tasks copied the map output files:

060417 103554 Server connection on port 60050 from 72.30.117.220: starting
060417 103554 task_m_ehz5q1  Client connection to 0.0.0.0:60050: starting
060417 103554 task_m_ehz5q1 1.0% /user/runping/runping/docs_store/stage_51/inverted_link_docs/part-00039:0+71
060417 103554 Task task_m_ehz5q1 is done.
060417 103554 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-default.xml

......................

060417 103613 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-site.xml
060417 103623 task_m_ehz5q1 done; removing files.
060417 103633 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-default.xml
060417 103633 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/mapred-default.xml
060417 103633 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-site.xml

...........................................

060417 190241 SEVERE Can't open map output:/export/crawlspace/kryptonite/hadoop/mapred/local/task_m_ehz5q1/part-32.out
java.io.FileNotFoundException: /export/crawlspace/kryptonite/hadoop/mapred/local/task_m_ehz5q1/part-32.out
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
060417 190241 Unknown child with bad map output: task_m_ehz5q1. Ignored.
060417 190241 Server handler 2 on 60040 caught: java.io.FileNotFoundException: /export/crawlspace/kryptonite/hadoop/mapred/local/task_m_ehz5q1/part-32.out
java.io.FileNotFoundException: /export/crawlspace/kryptonite/hadoop/mapred/local/task_m_ehz5q1/part-32.out
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
060417 190241 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-default.xml
060417 190241 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/mapred-default.xml

And the above exceptions repeated for many (not sure whether it is tru for all the reduce task) other reduce tasks.

Another strange thing noticed from the logs.

On another machine's log, I saw:

060417 190528 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-site.xml
060417 190528 task_r_24d8k4 copy failed: task_m_ehz5q1 from kry1262.inktomisearch.com/72.30.117.220:60040
java.io.IOException: timed out waiting for response
        at org.apache.hadoop.ipc.Client.call(Client.java:305)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141)
        at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
        at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:110)
        at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:66)
060417 190528 task_r_24d8k4 0.11523809% reduce > copy > task_m_ehz5q1@kry1262.inktomisearch.com:60040
060417 190528 task_r_24d8k4 Copying task_m_epatk8 output from kry1387.inktomisearch.com.
                               
which is expected. However, before this line, 
I saw another copy activity in the log:

060417 103608 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-site.xml
060417 103608 task_r_a4yl3t Copying task_m_ehz5q1 output from kry1262.inktomisearch.com.
060417 103608 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-default.xml

And the task task_r_a4yl3t does not belong to the concerned job, 
according to the Web interface. That is strange.

And I checked a few other machines where some reduce tasks ran, 
and I saw the same thing.

I suspect there was a conflict in job ID. If two jobs had the same ID, 
when one closes, it may also mark the other as "closed" too, thus trggering map tasks
to clean up prematurely.

A simple way to avoid potential jobid conflict is to use sequential numbers.





-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 05:06:18 2006
Return-Path: 
 <hadoop-dev-return-875-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 231 invoked from network); 19 Apr 2006 05:06:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 05:06:18 -0000
Received: (qmail 34954 invoked by uid 500); 19 Apr 2006 05:06:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34931 invoked by uid 500); 19 Apr 2006 05:06:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34921 invoked by uid 99); 19 Apr 2006 05:06:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 22:06:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 22:06:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9631F7142CE
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 05:05:17 +0000 (GMT)
Message-ID: <5099012.1145423117606.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 05:05:17 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-148) add a failure count to task trackers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

add a failure count to task trackers
------------------------------------

         Key: HADOOP-148
         URL: http://issues.apache.org/jira/browse/HADOOP-148
     Project: Hadoop
        Type: New Feature

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


Adds a count of failures that have occurred on each TaskTracker in the TaskTrackerStatus. The webapp displays the list of failures for each TaskTracker. In addition, the TaskTracker that has the most failures is listed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 05:08:19 2006
Return-Path: 
 <hadoop-dev-return-876-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1675 invoked from network); 19 Apr 2006 05:08:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 05:08:19 -0000
Received: (qmail 36112 invoked by uid 500); 19 Apr 2006 05:08:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36090 invoked by uid 500); 19 Apr 2006 05:08:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36081 invoked by uid 99); 19 Apr 2006 05:08:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 22:08:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 22:08:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6EF177142D3
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 05:07:18 +0000 (GMT)
Message-ID: <16099761.1145423238451.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 05:07:18 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-148) add a failure count to task trackers
In-Reply-To: <5099012.1145423117606.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-148?page=all ]

Owen O'Malley updated HADOOP-148:
---------------------------------

    Attachment: failure-count.patch

This patch adds the failure counts to the TaskTrackerStatus and the webapp.

> add a failure count to task trackers
> ------------------------------------
>
>          Key: HADOOP-148
>          URL: http://issues.apache.org/jira/browse/HADOOP-148
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: failure-count.patch
>
> Adds a count of failures that have occurred on each TaskTracker in the TaskTrackerStatus. The webapp displays the list of failures for each TaskTracker. In addition, the TaskTracker that has the most failures is listed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 05:24:21 2006
Return-Path: 
 <hadoop-dev-return-877-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10953 invoked from network); 19 Apr 2006 05:24:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 05:24:21 -0000
Received: (qmail 44526 invoked by uid 500); 19 Apr 2006 05:24:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44502 invoked by uid 500); 19 Apr 2006 05:24:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44493 invoked by uid 99); 19 Apr 2006 05:24:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 22:24:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Apr 2006 22:24:20 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A93317142D3
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 05:23:20 +0000 (GMT)
Message-ID: <21989573.1145424200689.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 05:23:20 +0000 (GMT+00:00)
From: "Teppo Kurki (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-140) General documentation
In-Reply-To: <87551851.1145084401166.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-140?page=comments#action_12375035 ] 

Teppo Kurki commented on HADOOP-140:
------------------------------------

http://wiki.apache.org/lucene-hadoop/HadoopMapReduce

This really doesn't solve the issue, but unless someone is picking this task up maybe  this should be closed for now?

> General documentation
> ---------------------
>
>          Key: HADOOP-140
>          URL: http://issues.apache.org/jira/browse/HADOOP-140
>      Project: Hadoop
>         Type: Wish

>     Reporter: Teppo Kurki
>     Priority: Minor
>  Attachments: mapred.xml
>
> Getting a grasp of how Hadoop works is a little hard, because one first has to get a grip on the whole MapReduce thing and then figure out how it is carried out in Hadoop. Judging from the mailing list a little more general documentation would help a lot.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 15:38:37 2006
Return-Path: 
 <hadoop-dev-return-878-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 92442 invoked from network); 19 Apr 2006 15:38:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 15:38:37 -0000
Received: (qmail 81122 invoked by uid 500); 19 Apr 2006 15:38:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81090 invoked by uid 500); 19 Apr 2006 15:38:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81073 invoked by uid 99); 19 Apr 2006 15:38:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 08:38:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 08:38:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 360D47142D6
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 15:37:35 +0000 (GMT)
Message-ID: <16816725.1145461055218.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 15:37:35 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-140) General documentation
In-Reply-To: <87551851.1145084401166.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-140?page=all ]
     
Doug Cutting resolved HADOOP-140:
---------------------------------

    Resolution: Fixed

Thanks for adding this to the wiki!

> General documentation
> ---------------------
>
>          Key: HADOOP-140
>          URL: http://issues.apache.org/jira/browse/HADOOP-140
>      Project: Hadoop
>         Type: Wish

>     Reporter: Teppo Kurki
>     Priority: Minor
>  Attachments: mapred.xml
>
> Getting a grasp of how Hadoop works is a little hard, because one first has to get a grip on the whole MapReduce thing and then figure out how it is carried out in Hadoop. Judging from the mailing list a little more general documentation would help a lot.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 16:14:42 2006
Return-Path: 
 <hadoop-dev-return-881-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14865 invoked from network); 19 Apr 2006 16:14:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 16:14:42 -0000
Received: (qmail 66915 invoked by uid 500); 19 Apr 2006 16:14:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66893 invoked by uid 500); 19 Apr 2006 16:14:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66883 invoked by uid 99); 19 Apr 2006 16:14:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 09:14:35 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 09:14:34 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch1.xch.corp.yahoo.com
 [216.145.51.233])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3JGCG66015328
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 09:12:16 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=WRvcuQmOL8E5mYu4NfrNvnLamQH85L8FGNZL5sMDZrIO1i/MbG2wu9rHFBBQKlbR
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 19 Apr 2006 09:12:16 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <18073387.1145403559286.JavaMail.jira@brutus>
References: <18073387.1145403559286.JavaMail.jira@brutus>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <5F47F2BF-FB61-44A0-A6CE-C25E4F5DCE4F@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-146) potential conflict in block id's,
 leading to data corruption
Date: Wed, 19 Apr 2006 08:59:21 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 19 Apr 2006 16:12:16.0270 (UTC)
 FILETIME=[06A6A2E0:01C663CC]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

we might want to do something generic to support future migrations,  
where you boot a new version of the FS next to the old one and then  
just move files across.  If we can manage to use hardlinks to migrate  
data block files, it should go fast...

On Apr 18, 2006, at 4:39 PM, Doug Cutting (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-146? 
> page=comments#action_12375011 ]
>
> Doug Cutting commented on HADOOP-146:
> -------------------------------------
>
> I'd vote for sequential allocation.  It will take a *really* long  
> time to cycle through all ids.  Migration should not be expensive,  
> since it just requires renaming block files, not copying them.  The  
> high-watermark block id can be logged with the block->name table.
>
> Here's one way to migrate: initially the high-water-mark id is  
> zero.  So all blocks in the name table are out-of-range, and hence  
> need renaming.  Renaming can be handled like other blockwork: the  
> namenode can give datanodes rename commands.  While a block is  
> being renamed it must be kept in side tables, so that, e.g.,  
> requests to read files whose blocks are partially renamed can still  
> be handled.
>
>
>> potential conflict in block id's, leading to data corruption
>> ------------------------------------------------------------
>>
>>          Key: HADOOP-146
>>          URL: http://issues.apache.org/jira/browse/HADOOP-146
>>      Project: Hadoop
>>         Type: Bug
>
>>   Components: dfs
>>     Versions: 0.1.0, 0.1.1
>>     Reporter: Yoram Arnon
>>     Assignee: Konstantin Shvachko
>>      Fix For: 0.3
>
>>
>> currently, block id's are generated randomly, and are not tested  
>> for collisions with existing id's.
>> while ids are 64 bits, given enough time and a large enough FS,  
>> collisions are expected.
>> when a collision occurs, a random subset of blocks with that id  
>> will be removed as extra replicas, and the contents of that  
>> portion of the containing file are one random version of the block.
>> to solve this one could check for id collision when creating a new  
>> block, getting a new id in case of conflict. This approach  
>> requires the name node to keep track of all existing block id's  
>> (rather than just the ones who have reported in), and to identify  
>> old versions of a block id as in valid (in case a data node dies,  
>> a file is deleted, then a block id is reused for a new file).
>> Alternatively, one could simply use sequential block id's. Here  
>> the downsides are:
>> 1. migration from an existing file system is hard, requiring  
>> compaction of the entire FS
>> 2. once you cycle through 64 bits of id's (quite a few years at  
>> full blast), you're in trouble again (or run occasional/background  
>> compaction)
>> 3. you must never lose the high watermark block id.
>> synchronized Block allocateBlock(UTF8 src) {
>>         Block b = new Block();
>>         FileUnderConstruction v = (FileUnderConstruction)  
>> pendingCreates.get(src);
>>         v.add(b);
>>         pendingCreateBlocks.add(b);
>>         return b;
>>     }
>> static Random r = new Random();
>>     /**
>>      */
>>     public Block() {
>>         this.blkid = r.nextLong();
>>         this.len = 0;
>>     }
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Wed Apr 19 16:10:39 2006
Return-Path: 
 <hadoop-dev-return-879-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12059 invoked from network); 19 Apr 2006 16:10:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 16:10:39 -0000
Received: (qmail 61315 invoked by uid 500); 19 Apr 2006 16:10:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61291 invoked by uid 500); 19 Apr 2006 16:10:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61282 invoked by uid 99); 19 Apr 2006 16:10:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 09:10:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 09:10:38 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E104C7142D6
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 16:09:36 +0000 (GMT)
Message-ID: <6744012.1145462976918.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 16:09:36 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-148) add a failure count to task trackers
In-Reply-To: <5099012.1145423117606.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-148?page=all ]
     
Doug Cutting resolved HADOOP-148:
---------------------------------

    Resolution: Fixed

I have applied this patch.  Thanks, Owen.

> add a failure count to task trackers
> ------------------------------------
>
>          Key: HADOOP-148
>          URL: http://issues.apache.org/jira/browse/HADOOP-148
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: failure-count.patch
>
> Adds a count of failures that have occurred on each TaskTracker in the TaskTrackerStatus. The webapp displays the list of failures for each TaskTracker. In addition, the TaskTracker that has the most failures is listed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 16:12:37 2006
Return-Path: 
 <hadoop-dev-return-880-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13381 invoked from network); 19 Apr 2006 16:12:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 16:12:37 -0000
Received: (qmail 63896 invoked by uid 500); 19 Apr 2006 16:12:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63880 invoked by uid 500); 19 Apr 2006 16:12:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63871 invoked by uid 99); 19 Apr 2006 16:12:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 09:12:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 09:12:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0EE557142D6
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 16:11:35 +0000 (GMT)
Message-ID: <27147490.1145463095057.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 16:11:35 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-147) MapTask removed mapout files before
 the reduce tasks copy them
In-Reply-To: <27888818.1145408057411.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-147?page=all ]

Owen O'Malley updated HADOOP-147:
---------------------------------

    Description: 
I was running a job on a cluster of 138 nodes. The job had 1050 map tasks and 128 reduce tasks. It stucked at the reduce stage.
All the reduce tasks were trying to copy file from a map task with the following status show on the web interface:

reduce > copy > task_m_ehz5q1@node1262.foo.com:60040

However, the log on the machine node1262 (where the map task task_m_ehz5q1 ran) showed that the map task finished even before the 
reduce tasks copied the map output files:

060417 103554 Server connection on port 60050 from 72.30.117.220: starting
060417 103554 task_m_ehz5q1  Client connection to 0.0.0.0:60050: starting
060417 103554 task_m_ehz5q1 1.0% /user/runping/runping/proj/part-00039:0+71
060417 103554 Task task_m_ehz5q1 is done.
060417 103554 parsing file:/local/hadoop/conf2/hadoop-default.xml

......................

060417 103613 parsing file:/local/hadoop/conf2/hadoop-site.xml
060417 103623 task_m_ehz5q1 done; removing files.
060417 103633 parsing file:/local/hadoop/conf2/hadoop-default.xml
060417 103633 parsing file:/local/hadoop/conf2/mapred-default.xml
060417 103633 parsing file:/local/hadoop/conf2/hadoop-site.xml

...........................................

060417 190241 SEVERE Can't open map output:/local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
060417 190241 Unknown child with bad map output: task_m_ehz5q1. Ignored.
060417 190241 Server handler 2 on 60040 caught: java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
060417 190241 parsing file:/local/hadoop/conf2/hadoop-default.xml
060417 190241 parsing file:/local/hadoop/conf2/mapred-default.xml

And the above exceptions repeated for many (not sure whether it is tru for all the reduce task) other reduce tasks.

Another strange thing noticed from the logs.

On another machine's log, I saw:

060417 190528 parsing file:/local/hadoop/conf2/hadoop-site.xml
060417 190528 task_r_24d8k4 copy failed: task_m_ehz5q1 from node1262.foo.com/72.30.117.220:60040
java.io.IOException: timed out waiting for response
        at org.apache.hadoop.ipc.Client.call(Client.java:305)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141)
        at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
        at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:110)
        at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:66)
060417 190528 task_r_24d8k4 0.11523809% reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
060417 190528 task_r_24d8k4 Copying task_m_epatk8 output from node1387.foo.com.
                               
which is expected. However, before this line, 
I saw another copy activity in the log:

060417 103608 parsing file:/local/hadoop/conf2/hadoop-site.xml
060417 103608 task_r_a4yl3t Copying task_m_ehz5q1 output from node1262.foo.com.
060417 103608 parsing file:/local/hadoop/conf2/hadoop-default.xml

And the task task_r_a4yl3t does not belong to the concerned job, 
according to the Web interface. That is strange.

And I checked a few other machines where some reduce tasks ran, 
and I saw the same thing.

I suspect there was a conflict in job ID. If two jobs had the same ID, 
when one closes, it may also mark the other as "closed" too, thus trggering map tasks
to clean up prematurely.

A simple way to avoid potential jobid conflict is to use sequential numbers.





  was:


I was running a job on a cluster of 138 nodes. The job had 1050 map tasks and 128 reduce tasks. It stucked at the reduce stage.
All the reduce tasks were trying to copy file from a map task with the following status show on the web interface:

reduce > copy > task_m_ehz5q1@kry1262.inktomisearch.com:60040

However, the log on the machine kry1262 (where the map task task_m_ehz5q1 ran) showed that the map task finished even before the 
reduce tasks copied the map output files:

060417 103554 Server connection on port 60050 from 72.30.117.220: starting
060417 103554 task_m_ehz5q1  Client connection to 0.0.0.0:60050: starting
060417 103554 task_m_ehz5q1 1.0% /user/runping/runping/docs_store/stage_51/inverted_link_docs/part-00039:0+71
060417 103554 Task task_m_ehz5q1 is done.
060417 103554 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-default.xml

......................

060417 103613 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-site.xml
060417 103623 task_m_ehz5q1 done; removing files.
060417 103633 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-default.xml
060417 103633 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/mapred-default.xml
060417 103633 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-site.xml

...........................................

060417 190241 SEVERE Can't open map output:/export/crawlspace/kryptonite/hadoop/mapred/local/task_m_ehz5q1/part-32.out
java.io.FileNotFoundException: /export/crawlspace/kryptonite/hadoop/mapred/local/task_m_ehz5q1/part-32.out
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
060417 190241 Unknown child with bad map output: task_m_ehz5q1. Ignored.
060417 190241 Server handler 2 on 60040 caught: java.io.FileNotFoundException: /export/crawlspace/kryptonite/hadoop/mapred/local/task_m_ehz5q1/part-32.out
java.io.FileNotFoundException: /export/crawlspace/kryptonite/hadoop/mapred/local/task_m_ehz5q1/part-32.out
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
060417 190241 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-default.xml
060417 190241 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/mapred-default.xml

And the above exceptions repeated for many (not sure whether it is tru for all the reduce task) other reduce tasks.

Another strange thing noticed from the logs.

On another machine's log, I saw:

060417 190528 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-site.xml
060417 190528 task_r_24d8k4 copy failed: task_m_ehz5q1 from kry1262.inktomisearch.com/72.30.117.220:60040
java.io.IOException: timed out waiting for response
        at org.apache.hadoop.ipc.Client.call(Client.java:305)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141)
        at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
        at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:110)
        at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:66)
060417 190528 task_r_24d8k4 0.11523809% reduce > copy > task_m_ehz5q1@kry1262.inktomisearch.com:60040
060417 190528 task_r_24d8k4 Copying task_m_epatk8 output from kry1387.inktomisearch.com.
                               
which is expected. However, before this line, 
I saw another copy activity in the log:

060417 103608 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-site.xml
060417 103608 task_r_a4yl3t Copying task_m_ehz5q1 output from kry1262.inktomisearch.com.
060417 103608 parsing file:/export/crawlspace/kryptonite/hadoop/conf2/hadoop-default.xml

And the task task_r_a4yl3t does not belong to the concerned job, 
according to the Web interface. That is strange.

And I checked a few other machines where some reduce tasks ran, 
and I saw the same thing.

I suspect there was a conflict in job ID. If two jobs had the same ID, 
when one closes, it may also mark the other as "closed" too, thus trggering map tasks
to clean up prematurely.

A simple way to avoid potential jobid conflict is to use sequential numbers.






> MapTask removed mapout files before the reduce tasks copy them
> --------------------------------------------------------------
>
>          Key: HADOOP-147
>          URL: http://issues.apache.org/jira/browse/HADOOP-147
>      Project: Hadoop
>         Type: Bug

>     Reporter: Runping Qi

>
> I was running a job on a cluster of 138 nodes. The job had 1050 map tasks and 128 reduce tasks. It stucked at the reduce stage.
> All the reduce tasks were trying to copy file from a map task with the following status show on the web interface:
> reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
> However, the log on the machine node1262 (where the map task task_m_ehz5q1 ran) showed that the map task finished even before the 
> reduce tasks copied the map output files:
> 060417 103554 Server connection on port 60050 from 72.30.117.220: starting
> 060417 103554 task_m_ehz5q1  Client connection to 0.0.0.0:60050: starting
> 060417 103554 task_m_ehz5q1 1.0% /user/runping/runping/proj/part-00039:0+71
> 060417 103554 Task task_m_ehz5q1 is done.
> 060417 103554 parsing file:/local/hadoop/conf2/hadoop-default.xml
> ......................
> 060417 103613 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 103623 task_m_ehz5q1 done; removing files.
> 060417 103633 parsing file:/local/hadoop/conf2/hadoop-default.xml
> 060417 103633 parsing file:/local/hadoop/conf2/mapred-default.xml
> 060417 103633 parsing file:/local/hadoop/conf2/hadoop-site.xml
> ...........................................
> 060417 190241 SEVERE Can't open map output:/local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
> java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
> 060417 190241 Unknown child with bad map output: task_m_ehz5q1. Ignored.
> 060417 190241 Server handler 2 on 60040 caught: java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
> java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
> 060417 190241 parsing file:/local/hadoop/conf2/hadoop-default.xml
> 060417 190241 parsing file:/local/hadoop/conf2/mapred-default.xml
> And the above exceptions repeated for many (not sure whether it is tru for all the reduce task) other reduce tasks.
> Another strange thing noticed from the logs.
> On another machine's log, I saw:
> 060417 190528 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 190528 task_r_24d8k4 copy failed: task_m_ehz5q1 from node1262.foo.com/72.30.117.220:60040
> java.io.IOException: timed out waiting for response
>         at org.apache.hadoop.ipc.Client.call(Client.java:305)
>         at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141)
>         at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
>         at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:110)
>         at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:66)
> 060417 190528 task_r_24d8k4 0.11523809% reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
> 060417 190528 task_r_24d8k4 Copying task_m_epatk8 output from node1387.foo.com.
>                                
> which is expected. However, before this line, 
> I saw another copy activity in the log:
> 060417 103608 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 103608 task_r_a4yl3t Copying task_m_ehz5q1 output from node1262.foo.com.
> 060417 103608 parsing file:/local/hadoop/conf2/hadoop-default.xml
> And the task task_r_a4yl3t does not belong to the concerned job, 
> according to the Web interface. That is strange.
> And I checked a few other machines where some reduce tasks ran, 
> and I saw the same thing.
> I suspect there was a conflict in job ID. If two jobs had the same ID, 
> when one closes, it may also mark the other as "closed" too, thus trggering map tasks
> to clean up prematurely.
> A simple way to avoid potential jobid conflict is to use sequential numbers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 17:17:39 2006
Return-Path: 
 <hadoop-dev-return-882-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55521 invoked from network); 19 Apr 2006 17:17:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 17:17:39 -0000
Received: (qmail 9667 invoked by uid 500); 19 Apr 2006 17:17:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9642 invoked by uid 500); 19 Apr 2006 17:17:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9628 invoked by uid 99); 19 Apr 2006 17:17:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 10:17:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 10:17:38 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3ADF57142C5
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 17:16:37 +0000 (GMT)
Message-ID: <804059.1145466997235.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 17:16:37 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-138) stop all tasks
In-Reply-To: <81187011.1145066400494.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-138?page=all ]
     
Doug Cutting resolved HADOOP-138:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Doug Cutting

> stop all tasks
> --------------
>
>          Key: HADOOP-138
>          URL: http://issues.apache.org/jira/browse/HADOOP-138
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.0, 0.1.1
>     Reporter: Stefan Groschupf
>     Assignee: Doug Cutting
>     Priority: Trivial
>      Fix For: 0.2
>  Attachments: stopAllTasks.patch
>
> When a tasktracker runs X tasks it require X heartbeats to stop all jobs.
> Stop all tasks with one heartbeat improve the availability and free resources faster.   

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 17:19:37 2006
Return-Path: 
 <hadoop-dev-return-883-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56854 invoked from network); 19 Apr 2006 17:19:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 17:19:37 -0000
Received: (qmail 14132 invoked by uid 500); 19 Apr 2006 17:19:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14114 invoked by uid 500); 19 Apr 2006 17:19:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14103 invoked by uid 99); 19 Apr 2006 17:19:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 10:19:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 10:19:36 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EB57E7142C5
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 17:18:35 +0000 (GMT)
Message-ID: <2420366.1145467115960.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 17:18:35 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-143) exception call stacks are word
 wrapped in webapp
In-Reply-To: <15238317.1145373737596.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-143?page=all ]
     
Owen O'Malley resolved HADOOP-143:
----------------------------------

    Resolution: Fixed

This was commited by Doug as Revision 394988.

> exception call stacks are word wrapped in webapp
> ------------------------------------------------
>
>          Key: HADOOP-143
>          URL: http://issues.apache.org/jira/browse/HADOOP-143
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: add-pre-for-exceptions.patch
>
> The exception call stacks in the webapp word wrap, which makes them much harder to read. It is particularly unfortunate in the remote exceptions, which use a blank line to separate the local from the remote call stacks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 17:34:40 2006
Return-Path: 
 <hadoop-dev-return-884-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67605 invoked from network); 19 Apr 2006 17:34:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 17:34:40 -0000
Received: (qmail 49296 invoked by uid 500); 19 Apr 2006 17:34:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49276 invoked by uid 500); 19 Apr 2006 17:34:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49267 invoked by uid 99); 19 Apr 2006 17:34:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 10:34:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 10:34:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 497E47142D1
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 17:33:35 +0000 (GMT)
Message-ID: <7146774.1145468015297.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 17:33:35 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-141) Disk thrashing / task timeouts
 during map output copy phase
In-Reply-To: <9808210.1145312482052.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-141?page=comments#action_12375167 ] 

Doug Cutting commented on HADOOP-141:
-------------------------------------

It would be good to find which of these changes actually made the difference for you.  Each TaskTracker's map output server only accepts up to mapred.tasktracker.tasks.maximum connections at once.  Since this is typically around 2, I would be surprised if a small buffer size results in lots of seeks, since the OS should perform readaheads in its buffer cache.

What OS are you using?  What do you have mapred.tasktracker.tasks.maximum set to?

If on linux, what does 'iostat -x 1 10' show when things are slow?  How about 'sar -n DEV 1 10'?


> Disk thrashing / task timeouts during map output copy phase
> -----------------------------------------------------------
>
>          Key: HADOOP-141
>          URL: http://issues.apache.org/jira/browse/HADOOP-141
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>  Environment: linux
>     Reporter: paul sutter

>
> MapOutputProtocol connections cause timeouts because of system thrashing and transferring the same file over and over again, ultimately leading to making no forward progress(medium sized job, 500GB input file, map output about as large as the input, 10 node cluster).
> There are several bugs behind this, but the following two changes improved matters considerably.
> (1) 
> The buffersize in MapOutputFile is currently hardcoded to 8192 bytes (for both reads and writes). By changing this buffer size to 256KB, the number of disk seeks are reduced and the problem went away. 
> Ideally there would be a buffer size parameter for this that is separate from the DFS io buffer size.
> (2)
> I also added the following code to the socket configuration in both Server.java and Client.java. No linger is a minor good idea in an enivronment with some packet loss (and you will have that when all the nodes get busy at once), but 256KB buffers is probably excessive, especially on a LAN, but it takes me two hours to test changes so I havent experimented.
> socket.setSendBufferSize(256*1024);
> socket.setReceiveBufferSize(256*1024);
> socket.setSoLinger(false, 0);
> socket.setKeepAlive(true);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 17:45:41 2006
Return-Path: 
 <hadoop-dev-return-885-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72572 invoked from network); 19 Apr 2006 17:45:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 17:45:41 -0000
Received: (qmail 72601 invoked by uid 500); 19 Apr 2006 17:45:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72580 invoked by uid 500); 19 Apr 2006 17:45:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72571 invoked by uid 99); 19 Apr 2006 17:45:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 10:45:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 10:45:40 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 516487142CA
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 17:44:39 +0000 (GMT)
Message-ID: <20777916.1145468679084.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 17:44:39 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-136?page=comments#action_12375169 ] 

Doug Cutting commented on HADOOP-136:
-------------------------------------

The UTF8 class was originally written to be compatible with Sun's DataOutput.writeUTF:

http://java.sun.com/j2se/1.4.2/docs/api/java/io/DataOutput.html#writeUTF(java.lang.String)

Long-term it would be good to support strings with more than 2^16 characters and to support 4-byte UTF8 characters, but this will be hard to do back-compatibly.

Short term, would you or someone else like to submit a patch improving UTF8's handling of long strings?  Some unit tests demonstrating these problems would also be welcome.  Thanks!



> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor

>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 18:00:49 2006
Return-Path: 
 <hadoop-dev-return-886-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80732 invoked from network); 19 Apr 2006 18:00:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 18:00:49 -0000
Received: (qmail 98390 invoked by uid 500); 19 Apr 2006 18:00:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98353 invoked by uid 500); 19 Apr 2006 18:00:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98257 invoked by uid 99); 19 Apr 2006 18:00:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 11:00:47 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 11:00:46 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 59E3B7142D5
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 17:59:44 +0000 (GMT)
Message-ID: <16976737.1145469584365.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 17:59:44 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-149) TaskTracker#unJar trashes file modes
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

TaskTracker#unJar trashes file modes
------------------------------------

         Key: HADOOP-149
         URL: http://issues.apache.org/jira/browse/HADOOP-149
     Project: Hadoop
        Type: Bug

    Versions: 0.2    
 Environment: linux
    Reporter: stack@archive.org
    Priority: Minor


Last Changed Rev: 395069

The unJar'ing of the job 'jar', trashes any file modes I've lovingly set at zip time.  This is a bit of a pain when my job wants to run external scripts and I want to bundle the scripts up in the jar itself for distribution out to slaves.

I ain't sure how to address the issue though. Nought about unix file modes in JarEntry nor ZipEntry.  I tried the ant 1.6.5 task unjar and unzip tasks thinking they'd respect file modes but they do same as TaskTracker#unJar (Commons zip makes mention of unix file modes but I haven't tried it).  Perhaps support for jobs as tar(.gz) bundles?  (But again, couldn't use ant to untar. It does same as unzip/unjar trashing file permissions).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 18:13:48 2006
Return-Path: 
 <hadoop-dev-return-887-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89440 invoked from network); 19 Apr 2006 18:13:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 18:13:48 -0000
Received: (qmail 23608 invoked by uid 500); 19 Apr 2006 18:13:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23589 invoked by uid 500); 19 Apr 2006 18:13:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23579 invoked by uid 99); 19 Apr 2006 18:13:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 11:13:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 11:13:40 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 993117142CA
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 18:12:34 +0000 (GMT)
Message-ID: <25422179.1145470354568.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 18:12:34 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-149) TaskTracker#unJar trashes file modes
In-Reply-To: <16976737.1145469584365.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-149?page=comments#action_12375173 ] 

Doug Cutting commented on HADOOP-149:
-------------------------------------

Yes, this is a pain.  I think the root of the problem is that file modes are not cross-platform, so Java doesn't have an API to access them.

As a work-around, can you, instead of directly invoking your scripts, invoke '/bin/bash myScript.sh'?  That way you don't require things to be executable.

> TaskTracker#unJar trashes file modes
> ------------------------------------
>
>          Key: HADOOP-149
>          URL: http://issues.apache.org/jira/browse/HADOOP-149
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>  Environment: linux
>     Reporter: stack@archive.org
>     Priority: Minor

>
> Last Changed Rev: 395069
> The unJar'ing of the job 'jar', trashes any file modes I've lovingly set at zip time.  This is a bit of a pain when my job wants to run external scripts and I want to bundle the scripts up in the jar itself for distribution out to slaves.
> I ain't sure how to address the issue though. Nought about unix file modes in JarEntry nor ZipEntry.  I tried the ant 1.6.5 task unjar and unzip tasks thinking they'd respect file modes but they do same as TaskTracker#unJar (Commons zip makes mention of unix file modes but I haven't tried it).  Perhaps support for jobs as tar(.gz) bundles?  (But again, couldn't use ant to untar. It does same as unzip/unjar trashing file permissions).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 18:36:36 2006
Return-Path: 
 <hadoop-dev-return-888-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7830 invoked from network); 19 Apr 2006 18:36:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 18:36:36 -0000
Received: (qmail 66773 invoked by uid 500); 19 Apr 2006 18:36:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66745 invoked by uid 500); 19 Apr 2006 18:36:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66732 invoked by uid 99); 19 Apr 2006 18:36:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 11:36:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 11:36:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 877897142D1
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 18:35:34 +0000 (GMT)
Message-ID: <2834666.1145471734551.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 18:35:34 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-150) tip and task names should reflect the
 job name
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

tip and task names should reflect the job name
----------------------------------------------

         Key: HADOOP-150
         URL: http://issues.apache.org/jira/browse/HADOOP-150
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


The tip and task names should be related to the job id. I'd propose:

job name: job_<random 32bit/base36>
tip: tip_<job id>_[mr]_<fragment #>
task: task_<tip id>_<attempt #>

so examples would be:
job_abc123
tip_abc123_m_00034
task_abc123_m_00034_1
 


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 18:52:50 2006
Return-Path: 
 <hadoop-dev-return-889-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18577 invoked from network); 19 Apr 2006 18:52:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 18:52:50 -0000
Received: (qmail 91501 invoked by uid 500); 19 Apr 2006 18:52:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91484 invoked by uid 500); 19 Apr 2006 18:52:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91475 invoked by uid 99); 19 Apr 2006 18:52:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 11:52:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 11:52:48 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ABC317142D6
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 18:51:47 +0000 (GMT)
Message-ID: <3400875.1145472707700.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 18:51:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-150) tip and task names should reflect
 the job name
In-Reply-To: <2834666.1145471734551.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-150?page=comments#action_12375183 ] 

Doug Cutting commented on HADOOP-150:
-------------------------------------

+1

Does the job name need to be random, even?  Could we allocate these sequentially too?

Also, we don't even need to name the taskTracker's with a random number.  We can use hostname:port, where the port is one used by one of the tasktracker's daemons (map output or umbilical).  That would make these more meaningful too.

Another random note: the umbilical and map output RPC servers could actually be run on the same port.  The way RPC is currently implemented, all public methods on the object served are available to be called remotely.  This is perhaps unsafe.  Perhaps RPC should be changed so that a server names the interface whose methods calls should be restricted to...

> tip and task names should reflect the job name
> ----------------------------------------------
>
>          Key: HADOOP-150
>          URL: http://issues.apache.org/jira/browse/HADOOP-150
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> The tip and task names should be related to the job id. I'd propose:
> job name: job_<random 32bit/base36>
> tip: tip_<job id>_[mr]_<fragment #>
> task: task_<tip id>_<attempt #>
> so examples would be:
> job_abc123
> tip_abc123_m_00034
> task_abc123_m_00034_1
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 19:12:42 2006
Return-Path: 
 <hadoop-dev-return-890-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31522 invoked from network); 19 Apr 2006 19:12:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 19:12:42 -0000
Received: (qmail 29618 invoked by uid 500); 19 Apr 2006 19:12:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29504 invoked by uid 500); 19 Apr 2006 19:12:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29493 invoked by uid 99); 19 Apr 2006 19:12:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 12:12:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 12:12:37 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A85E37142D9
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 19:11:36 +0000 (GMT)
Message-ID: <25140401.1145473896686.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 19:11:36 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-149) TaskTracker#unJar trashes file modes
In-Reply-To: <16976737.1145469584365.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-149?page=comments#action_12375187 ] 

stack@archive.org commented on HADOOP-149:
------------------------------------------

That'll do.  Thanks.

I'd suggest that you can close this issue.  The suggested workaround -- a /bin/bash or /usr/bin/env prefix -- will likely work for most.

> TaskTracker#unJar trashes file modes
> ------------------------------------
>
>          Key: HADOOP-149
>          URL: http://issues.apache.org/jira/browse/HADOOP-149
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>  Environment: linux
>     Reporter: stack@archive.org
>     Priority: Minor

>
> Last Changed Rev: 395069
> The unJar'ing of the job 'jar', trashes any file modes I've lovingly set at zip time.  This is a bit of a pain when my job wants to run external scripts and I want to bundle the scripts up in the jar itself for distribution out to slaves.
> I ain't sure how to address the issue though. Nought about unix file modes in JarEntry nor ZipEntry.  I tried the ant 1.6.5 task unjar and unzip tasks thinking they'd respect file modes but they do same as TaskTracker#unJar (Commons zip makes mention of unix file modes but I haven't tried it).  Perhaps support for jobs as tar(.gz) bundles?  (But again, couldn't use ant to untar. It does same as unzip/unjar trashing file permissions).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 19:33:36 2006
Return-Path: 
 <hadoop-dev-return-891-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52236 invoked from network); 19 Apr 2006 19:33:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 19:33:36 -0000
Received: (qmail 80938 invoked by uid 500); 19 Apr 2006 19:33:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80921 invoked by uid 500); 19 Apr 2006 19:33:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80912 invoked by uid 99); 19 Apr 2006 19:33:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 12:33:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 12:33:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7153C7142C5
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 19:32:34 +0000 (GMT)
Message-ID: <14833243.1145475154445.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 19:32:34 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-149) TaskTracker#unJar trashes file modes
In-Reply-To: <16976737.1145469584365.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-149?page=all ]
     
Doug Cutting closed HADOOP-149:
-------------------------------

    Resolution: Won't Fix

> TaskTracker#unJar trashes file modes
> ------------------------------------
>
>          Key: HADOOP-149
>          URL: http://issues.apache.org/jira/browse/HADOOP-149
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>  Environment: linux
>     Reporter: stack@archive.org
>     Priority: Minor

>
> Last Changed Rev: 395069
> The unJar'ing of the job 'jar', trashes any file modes I've lovingly set at zip time.  This is a bit of a pain when my job wants to run external scripts and I want to bundle the scripts up in the jar itself for distribution out to slaves.
> I ain't sure how to address the issue though. Nought about unix file modes in JarEntry nor ZipEntry.  I tried the ant 1.6.5 task unjar and unzip tasks thinking they'd respect file modes but they do same as TaskTracker#unJar (Commons zip makes mention of unix file modes but I haven't tried it).  Perhaps support for jobs as tar(.gz) bundles?  (But again, couldn't use ant to untar. It does same as unzip/unjar trashing file permissions).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 22:16:39 2006
Return-Path: 
 <hadoop-dev-return-892-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44754 invoked from network); 19 Apr 2006 22:16:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 22:16:39 -0000
Received: (qmail 83292 invoked by uid 500); 19 Apr 2006 22:16:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83116 invoked by uid 500); 19 Apr 2006 22:16:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83031 invoked by uid 99); 19 Apr 2006 22:16:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 15:16:28 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 15:16:28 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 593DD7142D8
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 22:15:27 +0000 (GMT)
Message-ID: <22206763.1145484927355.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 22:15:27 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-141) Disk thrashing / task timeouts
 during map output copy phase
In-Reply-To: <9808210.1145312482052.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-141?page=comments#action_12375204 ] 

paul sutter commented on HADOOP-141:
------------------------------------


As it turns out, my changes did not fix the problem, just changed the timing.

The thrashing was occucring because one reducer was in the merge phase, and the other reducer was in the file copy phase.  The particular file that was failing, was being copied from the local system.  I have the concurrent merges set to 24 and the task count set to 4.

I added logging statements, and the file was clearly being received in full by MapOutputFile, yet ReduceTaskRunner was getting a timeout on that file about 1 minute and 20 seconds later, request it again and again, and each time receive the file yet get a timeout just over a minute later.

I did find two interesting bug in RPC.java while trying to track this down (which im filing separately), but for now I am completely stumped.

At the moment the cluster is otherwise busy, so I cant do any more experiments until perhaps tomororw. Any suggestions would be very welcome. We are using Linux, and I'll try the commands you suggested when Im able to recreate it, but for now this does not look like a disk or TCP problem, it really looks like an RPC scheduling problem. 

> Disk thrashing / task timeouts during map output copy phase
> -----------------------------------------------------------
>
>          Key: HADOOP-141
>          URL: http://issues.apache.org/jira/browse/HADOOP-141
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>  Environment: linux
>     Reporter: paul sutter

>
> MapOutputProtocol connections cause timeouts because of system thrashing and transferring the same file over and over again, ultimately leading to making no forward progress(medium sized job, 500GB input file, map output about as large as the input, 10 node cluster).
> There are several bugs behind this, but the following two changes improved matters considerably.
> (1) 
> The buffersize in MapOutputFile is currently hardcoded to 8192 bytes (for both reads and writes). By changing this buffer size to 256KB, the number of disk seeks are reduced and the problem went away. 
> Ideally there would be a buffer size parameter for this that is separate from the DFS io buffer size.
> (2)
> I also added the following code to the socket configuration in both Server.java and Client.java. No linger is a minor good idea in an enivronment with some packet loss (and you will have that when all the nodes get busy at once), but 256KB buffers is probably excessive, especially on a LAN, but it takes me two hours to test changes so I havent experimented.
> socket.setSendBufferSize(256*1024);
> socket.setReceiveBufferSize(256*1024);
> socket.setSoLinger(false, 0);
> socket.setKeepAlive(true);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 22:19:36 2006
Return-Path: 
 <hadoop-dev-return-893-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45778 invoked from network); 19 Apr 2006 22:19:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 22:19:36 -0000
Received: (qmail 90002 invoked by uid 500); 19 Apr 2006 22:19:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89983 invoked by uid 500); 19 Apr 2006 22:19:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89974 invoked by uid 99); 19 Apr 2006 22:19:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 15:19:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 15:19:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3DF7F7142CD
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 22:18:34 +0000 (GMT)
Message-ID: <2901359.1145485114241.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 22:18:34 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-151) Misdeclared field in RPC.class
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Misdeclared field in RPC.class
------------------------------

         Key: HADOOP-151
         URL: http://issues.apache.org/jira/browse/HADOOP-151
     Project: Hadoop
        Type: Bug

    Reporter: paul sutter



In RPC.java, the field named CLIENT should be neither static, nor a field of RPC. It should be (a) a private nonstatic field of InvocationHandler(),and (just further down), (b) a local variable in the RPC.call() method below.  The comment above the declaration was a bit of giveaway: 

   //TODO mb@media-style.com: static client or non-static client?
  private static Client CLIENT;	

  private static class Invoker implements InvocationHandler {
    private InetSocketAddress address;

    public Invoker(InetSocketAddress address, Configuration conf) {
      this.address = address;
      CLIENT = (Client) conf.getObject(Client.class.getName());
      if(CLIENT == null) {
          CLIENT = new Client(ObjectWritable.class, conf);
          conf.setObject(Client.class.getName(), CLIENT);
      }
    }

    public Object invoke(Object proxy, Method method, Object[] args)
      throws Throwable {
      ObjectWritable value = (ObjectWritable)
        CLIENT.call(new Invocation(method, args), address);
      return value.get();
    }
  }

  /** Construct a client-side proxy object that implements the named protocol,
   * talking to a server at the named address. */
  public static Object getProxy(Class protocol, InetSocketAddress addr, Configuration conf) {
    return Proxy.newProxyInstance(protocol.getClassLoader(),
                                  new Class[] { protocol },
                                  new Invoker(addr, conf));
  }

  /** Expert: Make multiple, parallel calls to a set of servers. */
  public static Object[] call(Method method, Object[][] params,
                              InetSocketAddress[] addrs, Configuration conf)
    throws IOException {

    Invocation[] invocations = new Invocation[params.length];
    for (int i = 0; i < params.length; i++)
      invocations[i] = new Invocation(method, params[i]);
    CLIENT = (Client) conf.getObject(Client.class.getName());
    if(CLIENT == null) {
        CLIENT = new Client(ObjectWritable.class, conf);
        conf.setObject(Client.class.getName(), CLIENT);
    }
    Writable[] wrappedValues = CLIENT.call(invocations, addrs);
    
    if (method.getReturnType() == Void.TYPE) {
      return null;
    }

    Object[] values =
      (Object[])Array.newInstance(method.getReturnType(),wrappedValues.length);
    for (int i = 0; i < values.length; i++)
      if (wrappedValues[i] != null)
        values[i] = ((ObjectWritable)wrappedValues[i]).get();
    
    return values;
  }. 


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 22:28:42 2006
Return-Path: 
 <hadoop-dev-return-894-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52038 invoked from network); 19 Apr 2006 22:28:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 22:28:42 -0000
Received: (qmail 12076 invoked by uid 500); 19 Apr 2006 22:28:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12056 invoked by uid 500); 19 Apr 2006 22:28:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12047 invoked by uid 99); 19 Apr 2006 22:28:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 15:28:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 15:28:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 199557142CD
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 22:27:35 +0000 (GMT)
Message-ID: <13152091.1145485655101.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 22:27:35 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-151) Misdeclared field in RPC.class
In-Reply-To: <2901359.1145485114241.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-151?page=comments#action_12375205 ] 

Doug Cutting commented on HADOOP-151:
-------------------------------------

What's the problem with a static CLIENT?  What problems does this cause?  The client has the connection pool, so one potential problem is that, a large request or response will delay other requests or responses to/from the same host.  Is that the issue you're seeing?  If so, can you provide more details about the circumstances where this occurs?


> Misdeclared field in RPC.class
> ------------------------------
>
>          Key: HADOOP-151
>          URL: http://issues.apache.org/jira/browse/HADOOP-151
>      Project: Hadoop
>         Type: Bug

>     Reporter: paul sutter

>
> In RPC.java, the field named CLIENT should be neither static, nor a field of RPC. It should be (a) a private nonstatic field of InvocationHandler(),and (just further down), (b) a local variable in the RPC.call() method below.  The comment above the declaration was a bit of giveaway: 
>    //TODO mb@media-style.com: static client or non-static client?
>   private static Client CLIENT;	
>   private static class Invoker implements InvocationHandler {
>     private InetSocketAddress address;
>     public Invoker(InetSocketAddress address, Configuration conf) {
>       this.address = address;
>       CLIENT = (Client) conf.getObject(Client.class.getName());
>       if(CLIENT == null) {
>           CLIENT = new Client(ObjectWritable.class, conf);
>           conf.setObject(Client.class.getName(), CLIENT);
>       }
>     }
>     public Object invoke(Object proxy, Method method, Object[] args)
>       throws Throwable {
>       ObjectWritable value = (ObjectWritable)
>         CLIENT.call(new Invocation(method, args), address);
>       return value.get();
>     }
>   }
>   /** Construct a client-side proxy object that implements the named protocol,
>    * talking to a server at the named address. */
>   public static Object getProxy(Class protocol, InetSocketAddress addr, Configuration conf) {
>     return Proxy.newProxyInstance(protocol.getClassLoader(),
>                                   new Class[] { protocol },
>                                   new Invoker(addr, conf));
>   }
>   /** Expert: Make multiple, parallel calls to a set of servers. */
>   public static Object[] call(Method method, Object[][] params,
>                               InetSocketAddress[] addrs, Configuration conf)
>     throws IOException {
>     Invocation[] invocations = new Invocation[params.length];
>     for (int i = 0; i < params.length; i++)
>       invocations[i] = new Invocation(method, params[i]);
>     CLIENT = (Client) conf.getObject(Client.class.getName());
>     if(CLIENT == null) {
>         CLIENT = new Client(ObjectWritable.class, conf);
>         conf.setObject(Client.class.getName(), CLIENT);
>     }
>     Writable[] wrappedValues = CLIENT.call(invocations, addrs);
>     
>     if (method.getReturnType() == Void.TYPE) {
>       return null;
>     }
>     Object[] values =
>       (Object[])Array.newInstance(method.getReturnType(),wrappedValues.length);
>     for (int i = 0; i < values.length; i++)
>       if (wrappedValues[i] != null)
>         values[i] = ((ObjectWritable)wrappedValues[i]).get();
>     
>     return values;
>   }. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 22:52:38 2006
Return-Path: 
 <hadoop-dev-return-895-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65926 invoked from network); 19 Apr 2006 22:52:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 22:52:38 -0000
Received: (qmail 51298 invoked by uid 500); 19 Apr 2006 22:52:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51279 invoked by uid 500); 19 Apr 2006 22:52:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51262 invoked by uid 99); 19 Apr 2006 22:52:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 15:52:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 15:52:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D6CF6410005
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 22:51:34 +0000 (GMT)
Message-ID: <19877711.1145487094860.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 22:51:34 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-151) Misdeclared field in RPC.class
In-Reply-To: <2901359.1145485114241.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-151?page=comments#action_12375209 ] 

paul sutter commented on HADOOP-151:
------------------------------------


If thre is only one Client object, then you're right, its OK that its static. 

The fact that the object is also stored in the conf - combined with the comment - made it look like a coding error (since its not accessed by anything but those parts of the code).



> Misdeclared field in RPC.class
> ------------------------------
>
>          Key: HADOOP-151
>          URL: http://issues.apache.org/jira/browse/HADOOP-151
>      Project: Hadoop
>         Type: Bug

>     Reporter: paul sutter

>
> In RPC.java, the field named CLIENT should be neither static, nor a field of RPC. It should be (a) a private nonstatic field of InvocationHandler(),and (just further down), (b) a local variable in the RPC.call() method below.  The comment above the declaration was a bit of giveaway: 
>    //TODO mb@media-style.com: static client or non-static client?
>   private static Client CLIENT;	
>   private static class Invoker implements InvocationHandler {
>     private InetSocketAddress address;
>     public Invoker(InetSocketAddress address, Configuration conf) {
>       this.address = address;
>       CLIENT = (Client) conf.getObject(Client.class.getName());
>       if(CLIENT == null) {
>           CLIENT = new Client(ObjectWritable.class, conf);
>           conf.setObject(Client.class.getName(), CLIENT);
>       }
>     }
>     public Object invoke(Object proxy, Method method, Object[] args)
>       throws Throwable {
>       ObjectWritable value = (ObjectWritable)
>         CLIENT.call(new Invocation(method, args), address);
>       return value.get();
>     }
>   }
>   /** Construct a client-side proxy object that implements the named protocol,
>    * talking to a server at the named address. */
>   public static Object getProxy(Class protocol, InetSocketAddress addr, Configuration conf) {
>     return Proxy.newProxyInstance(protocol.getClassLoader(),
>                                   new Class[] { protocol },
>                                   new Invoker(addr, conf));
>   }
>   /** Expert: Make multiple, parallel calls to a set of servers. */
>   public static Object[] call(Method method, Object[][] params,
>                               InetSocketAddress[] addrs, Configuration conf)
>     throws IOException {
>     Invocation[] invocations = new Invocation[params.length];
>     for (int i = 0; i < params.length; i++)
>       invocations[i] = new Invocation(method, params[i]);
>     CLIENT = (Client) conf.getObject(Client.class.getName());
>     if(CLIENT == null) {
>         CLIENT = new Client(ObjectWritable.class, conf);
>         conf.setObject(Client.class.getName(), CLIENT);
>     }
>     Writable[] wrappedValues = CLIENT.call(invocations, addrs);
>     
>     if (method.getReturnType() == Void.TYPE) {
>       return null;
>     }
>     Object[] values =
>       (Object[])Array.newInstance(method.getReturnType(),wrappedValues.length);
>     for (int i = 0; i < values.length; i++)
>       if (wrappedValues[i] != null)
>         values[i] = ((ObjectWritable)wrappedValues[i]).get();
>     
>     return values;
>   }. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 23:14:37 2006
Return-Path: 
 <hadoop-dev-return-896-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76821 invoked from network); 19 Apr 2006 23:14:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 23:14:37 -0000
Received: (qmail 76568 invoked by uid 500); 19 Apr 2006 23:14:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76545 invoked by uid 500); 19 Apr 2006 23:14:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76536 invoked by uid 99); 19 Apr 2006 23:14:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 16:14:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 16:14:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F42387142CD
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 23:13:34 +0000 (GMT)
Message-ID: <3977160.1145488414996.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 23:13:34 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-151) Misdeclared field in RPC.class
In-Reply-To: <2901359.1145485114241.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-151?page=comments#action_12375212 ] 

Doug Cutting commented on HADOOP-151:
-------------------------------------

You're right, that code got uglified by the configuration stuff.  There should only need to be a single Client for RPC.  Each Client keeps a cache of TCP connections to other host:port pairs expecting the same Writable class for requests and responses.  All RPCs use Invocation as the request class and ObjectWritable as the response class, so they can generally share connections.

The problem is that there's no longer a global configuration.  So a global client could be lazily constructed the first time a call is made with the invoker's configuration.  Or we could create a new client for each configuration.  But, you're right, we shouldn't do both, as the current code does.  Changing the global CLIENT shouldn't break anything, but it's also silly and wasteful.  The only thing the client reads from the configuration is the RPC timeout.  It might almost be better to remove the configuration from Client altogether and always explicitly pass the timeout as a parameter to call().

I wonder if this could even be leading to socket leaks?  Hmm.  A client doesn't close it's connections until it's either explicitly closed (which these are not) or until the remote server dies.  So we should probably fix this somehow.

> Misdeclared field in RPC.class
> ------------------------------
>
>          Key: HADOOP-151
>          URL: http://issues.apache.org/jira/browse/HADOOP-151
>      Project: Hadoop
>         Type: Bug

>   Components: ipc
>     Versions: 0.1.0, 0.2, 0.1.1
>     Reporter: paul sutter
>      Fix For: 0.2

>
> In RPC.java, the field named CLIENT should be neither static, nor a field of RPC. It should be (a) a private nonstatic field of InvocationHandler(),and (just further down), (b) a local variable in the RPC.call() method below.  The comment above the declaration was a bit of giveaway: 
>    //TODO mb@media-style.com: static client or non-static client?
>   private static Client CLIENT;	
>   private static class Invoker implements InvocationHandler {
>     private InetSocketAddress address;
>     public Invoker(InetSocketAddress address, Configuration conf) {
>       this.address = address;
>       CLIENT = (Client) conf.getObject(Client.class.getName());
>       if(CLIENT == null) {
>           CLIENT = new Client(ObjectWritable.class, conf);
>           conf.setObject(Client.class.getName(), CLIENT);
>       }
>     }
>     public Object invoke(Object proxy, Method method, Object[] args)
>       throws Throwable {
>       ObjectWritable value = (ObjectWritable)
>         CLIENT.call(new Invocation(method, args), address);
>       return value.get();
>     }
>   }
>   /** Construct a client-side proxy object that implements the named protocol,
>    * talking to a server at the named address. */
>   public static Object getProxy(Class protocol, InetSocketAddress addr, Configuration conf) {
>     return Proxy.newProxyInstance(protocol.getClassLoader(),
>                                   new Class[] { protocol },
>                                   new Invoker(addr, conf));
>   }
>   /** Expert: Make multiple, parallel calls to a set of servers. */
>   public static Object[] call(Method method, Object[][] params,
>                               InetSocketAddress[] addrs, Configuration conf)
>     throws IOException {
>     Invocation[] invocations = new Invocation[params.length];
>     for (int i = 0; i < params.length; i++)
>       invocations[i] = new Invocation(method, params[i]);
>     CLIENT = (Client) conf.getObject(Client.class.getName());
>     if(CLIENT == null) {
>         CLIENT = new Client(ObjectWritable.class, conf);
>         conf.setObject(Client.class.getName(), CLIENT);
>     }
>     Writable[] wrappedValues = CLIENT.call(invocations, addrs);
>     
>     if (method.getReturnType() == Void.TYPE) {
>       return null;
>     }
>     Object[] values =
>       (Object[])Array.newInstance(method.getReturnType(),wrappedValues.length);
>     for (int i = 0; i < values.length; i++)
>       if (wrappedValues[i] != null)
>         values[i] = ((ObjectWritable)wrappedValues[i]).get();
>     
>     return values;
>   }. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 23:14:38 2006
Return-Path: 
 <hadoop-dev-return-897-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76853 invoked from network); 19 Apr 2006 23:14:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 23:14:38 -0000
Received: (qmail 76789 invoked by uid 500); 19 Apr 2006 23:14:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76677 invoked by uid 500); 19 Apr 2006 23:14:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76668 invoked by uid 99); 19 Apr 2006 23:14:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 16:14:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 16:14:37 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 313307142D6
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 23:13:36 +0000 (GMT)
Message-ID: <31584092.1145488416193.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 23:13:36 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-151) RPC code has socket leak?
In-Reply-To: <2901359.1145485114241.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-151?page=all ]

Doug Cutting updated HADOOP-151:
--------------------------------

        Summary: RPC code has socket leak?  (was: Misdeclared field in RPC.class)
      Component: ipc
    Fix Version: 0.2
        Version: 0.1.1
                 0.1.0
                 0.2
    Description: 
In RPC.java, the field named CLIENT should be neither static, nor a field of RPC. It should be (a) a private nonstatic field of InvocationHandler(),and (just further down), (b) a local variable in the RPC.call() method below.  The comment above the declaration was a bit of giveaway: 

   //TODO mb@media-style.com: static client or non-static client?
  private static Client CLIENT;	

  private static class Invoker implements InvocationHandler {
    private InetSocketAddress address;

    public Invoker(InetSocketAddress address, Configuration conf) {
      this.address = address;
      CLIENT = (Client) conf.getObject(Client.class.getName());
      if(CLIENT == null) {
          CLIENT = new Client(ObjectWritable.class, conf);
          conf.setObject(Client.class.getName(), CLIENT);
      }
    }

    public Object invoke(Object proxy, Method method, Object[] args)
      throws Throwable {
      ObjectWritable value = (ObjectWritable)
        CLIENT.call(new Invocation(method, args), address);
      return value.get();
    }
  }

  /** Construct a client-side proxy object that implements the named protocol,
   * talking to a server at the named address. */
  public static Object getProxy(Class protocol, InetSocketAddress addr, Configuration conf) {
    return Proxy.newProxyInstance(protocol.getClassLoader(),
                                  new Class[] { protocol },
                                  new Invoker(addr, conf));
  }

  /** Expert: Make multiple, parallel calls to a set of servers. */
  public static Object[] call(Method method, Object[][] params,
                              InetSocketAddress[] addrs, Configuration conf)
    throws IOException {

    Invocation[] invocations = new Invocation[params.length];
    for (int i = 0; i < params.length; i++)
      invocations[i] = new Invocation(method, params[i]);
    CLIENT = (Client) conf.getObject(Client.class.getName());
    if(CLIENT == null) {
        CLIENT = new Client(ObjectWritable.class, conf);
        conf.setObject(Client.class.getName(), CLIENT);
    }
    Writable[] wrappedValues = CLIENT.call(invocations, addrs);
    
    if (method.getReturnType() == Void.TYPE) {
      return null;
    }

    Object[] values =
      (Object[])Array.newInstance(method.getReturnType(),wrappedValues.length);
    for (int i = 0; i < values.length; i++)
      if (wrappedValues[i] != null)
        values[i] = ((ObjectWritable)wrappedValues[i]).get();
    
    return values;
  }. 


  was:

In RPC.java, the field named CLIENT should be neither static, nor a field of RPC. It should be (a) a private nonstatic field of InvocationHandler(),and (just further down), (b) a local variable in the RPC.call() method below.  The comment above the declaration was a bit of giveaway: 

   //TODO mb@media-style.com: static client or non-static client?
  private static Client CLIENT;	

  private static class Invoker implements InvocationHandler {
    private InetSocketAddress address;

    public Invoker(InetSocketAddress address, Configuration conf) {
      this.address = address;
      CLIENT = (Client) conf.getObject(Client.class.getName());
      if(CLIENT == null) {
          CLIENT = new Client(ObjectWritable.class, conf);
          conf.setObject(Client.class.getName(), CLIENT);
      }
    }

    public Object invoke(Object proxy, Method method, Object[] args)
      throws Throwable {
      ObjectWritable value = (ObjectWritable)
        CLIENT.call(new Invocation(method, args), address);
      return value.get();
    }
  }

  /** Construct a client-side proxy object that implements the named protocol,
   * talking to a server at the named address. */
  public static Object getProxy(Class protocol, InetSocketAddress addr, Configuration conf) {
    return Proxy.newProxyInstance(protocol.getClassLoader(),
                                  new Class[] { protocol },
                                  new Invoker(addr, conf));
  }

  /** Expert: Make multiple, parallel calls to a set of servers. */
  public static Object[] call(Method method, Object[][] params,
                              InetSocketAddress[] addrs, Configuration conf)
    throws IOException {

    Invocation[] invocations = new Invocation[params.length];
    for (int i = 0; i < params.length; i++)
      invocations[i] = new Invocation(method, params[i]);
    CLIENT = (Client) conf.getObject(Client.class.getName());
    if(CLIENT == null) {
        CLIENT = new Client(ObjectWritable.class, conf);
        conf.setObject(Client.class.getName(), CLIENT);
    }
    Writable[] wrappedValues = CLIENT.call(invocations, addrs);
    
    if (method.getReturnType() == Void.TYPE) {
      return null;
    }

    Object[] values =
      (Object[])Array.newInstance(method.getReturnType(),wrappedValues.length);
    for (int i = 0; i < values.length; i++)
      if (wrappedValues[i] != null)
        values[i] = ((ObjectWritable)wrappedValues[i]).get();
    
    return values;
  }. 


      Assign To: Doug Cutting

> RPC code has socket leak?
> -------------------------
>
>          Key: HADOOP-151
>          URL: http://issues.apache.org/jira/browse/HADOOP-151
>      Project: Hadoop
>         Type: Bug

>   Components: ipc
>     Versions: 0.1.0, 0.2, 0.1.1
>     Reporter: paul sutter
>     Assignee: Doug Cutting
>      Fix For: 0.2

>
> In RPC.java, the field named CLIENT should be neither static, nor a field of RPC. It should be (a) a private nonstatic field of InvocationHandler(),and (just further down), (b) a local variable in the RPC.call() method below.  The comment above the declaration was a bit of giveaway: 
>    //TODO mb@media-style.com: static client or non-static client?
>   private static Client CLIENT;	
>   private static class Invoker implements InvocationHandler {
>     private InetSocketAddress address;
>     public Invoker(InetSocketAddress address, Configuration conf) {
>       this.address = address;
>       CLIENT = (Client) conf.getObject(Client.class.getName());
>       if(CLIENT == null) {
>           CLIENT = new Client(ObjectWritable.class, conf);
>           conf.setObject(Client.class.getName(), CLIENT);
>       }
>     }
>     public Object invoke(Object proxy, Method method, Object[] args)
>       throws Throwable {
>       ObjectWritable value = (ObjectWritable)
>         CLIENT.call(new Invocation(method, args), address);
>       return value.get();
>     }
>   }
>   /** Construct a client-side proxy object that implements the named protocol,
>    * talking to a server at the named address. */
>   public static Object getProxy(Class protocol, InetSocketAddress addr, Configuration conf) {
>     return Proxy.newProxyInstance(protocol.getClassLoader(),
>                                   new Class[] { protocol },
>                                   new Invoker(addr, conf));
>   }
>   /** Expert: Make multiple, parallel calls to a set of servers. */
>   public static Object[] call(Method method, Object[][] params,
>                               InetSocketAddress[] addrs, Configuration conf)
>     throws IOException {
>     Invocation[] invocations = new Invocation[params.length];
>     for (int i = 0; i < params.length; i++)
>       invocations[i] = new Invocation(method, params[i]);
>     CLIENT = (Client) conf.getObject(Client.class.getName());
>     if(CLIENT == null) {
>         CLIENT = new Client(ObjectWritable.class, conf);
>         conf.setObject(Client.class.getName(), CLIENT);
>     }
>     Writable[] wrappedValues = CLIENT.call(invocations, addrs);
>     
>     if (method.getReturnType() == Void.TYPE) {
>       return null;
>     }
>     Object[] values =
>       (Object[])Array.newInstance(method.getReturnType(),wrappedValues.length);
>     for (int i = 0; i < values.length; i++)
>       if (wrappedValues[i] != null)
>         values[i] = ((ObjectWritable)wrappedValues[i]).get();
>     
>     return values;
>   }. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 19 23:59:37 2006
Return-Path: 
 <hadoop-dev-return-898-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 98621 invoked from network); 19 Apr 2006 23:59:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 Apr 2006 23:59:37 -0000
Received: (qmail 16319 invoked by uid 500); 19 Apr 2006 23:59:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16291 invoked by uid 500); 19 Apr 2006 23:59:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16280 invoked by uid 99); 19 Apr 2006 23:59:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 16:59:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 16:59:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E1E037142CD
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 23:58:34 +0000 (GMT)
Message-ID: <15474766.1145491114915.JavaMail.jira@brutus>
Date: Wed, 19 Apr 2006 23:58:34 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-151) RPC code has socket leak?
In-Reply-To: <2901359.1145485114241.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-151?page=all ]
     
Doug Cutting resolved HADOOP-151:
---------------------------------

    Resolution: Fixed

I just fixed this.  I restored the original behaviour, where a single client is used for all calls, regardless of the configuration.  This results in the use of a single connection pool for all RPC calls, and hence closes a potential socket leak.  Long-term we might consider other approaches to pooling connections.  Today it seemed more important to close the leak than to, e.g., permit different ipc timeouts for different jobs.

> RPC code has socket leak?
> -------------------------
>
>          Key: HADOOP-151
>          URL: http://issues.apache.org/jira/browse/HADOOP-151
>      Project: Hadoop
>         Type: Bug

>   Components: ipc
>     Versions: 0.1.0, 0.2, 0.1.1
>     Reporter: paul sutter
>     Assignee: Doug Cutting
>      Fix For: 0.2

>
> In RPC.java, the field named CLIENT should be neither static, nor a field of RPC. It should be (a) a private nonstatic field of InvocationHandler(),and (just further down), (b) a local variable in the RPC.call() method below.  The comment above the declaration was a bit of giveaway: 
>    //TODO mb@media-style.com: static client or non-static client?
>   private static Client CLIENT;	
>   private static class Invoker implements InvocationHandler {
>     private InetSocketAddress address;
>     public Invoker(InetSocketAddress address, Configuration conf) {
>       this.address = address;
>       CLIENT = (Client) conf.getObject(Client.class.getName());
>       if(CLIENT == null) {
>           CLIENT = new Client(ObjectWritable.class, conf);
>           conf.setObject(Client.class.getName(), CLIENT);
>       }
>     }
>     public Object invoke(Object proxy, Method method, Object[] args)
>       throws Throwable {
>       ObjectWritable value = (ObjectWritable)
>         CLIENT.call(new Invocation(method, args), address);
>       return value.get();
>     }
>   }
>   /** Construct a client-side proxy object that implements the named protocol,
>    * talking to a server at the named address. */
>   public static Object getProxy(Class protocol, InetSocketAddress addr, Configuration conf) {
>     return Proxy.newProxyInstance(protocol.getClassLoader(),
>                                   new Class[] { protocol },
>                                   new Invoker(addr, conf));
>   }
>   /** Expert: Make multiple, parallel calls to a set of servers. */
>   public static Object[] call(Method method, Object[][] params,
>                               InetSocketAddress[] addrs, Configuration conf)
>     throws IOException {
>     Invocation[] invocations = new Invocation[params.length];
>     for (int i = 0; i < params.length; i++)
>       invocations[i] = new Invocation(method, params[i]);
>     CLIENT = (Client) conf.getObject(Client.class.getName());
>     if(CLIENT == null) {
>         CLIENT = new Client(ObjectWritable.class, conf);
>         conf.setObject(Client.class.getName(), CLIENT);
>     }
>     Writable[] wrappedValues = CLIENT.call(invocations, addrs);
>     
>     if (method.getReturnType() == Void.TYPE) {
>       return null;
>     }
>     Object[] values =
>       (Object[])Array.newInstance(method.getReturnType(),wrappedValues.length);
>     for (int i = 0; i < values.length; i++)
>       if (wrappedValues[i] != null)
>         values[i] = ((ObjectWritable)wrappedValues[i]).get();
>     
>     return values;
>   }. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 01:35:42 2006
Return-Path: 
 <hadoop-dev-return-899-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38717 invoked from network); 20 Apr 2006 01:35:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 01:35:42 -0000
Received: (qmail 85670 invoked by uid 500); 20 Apr 2006 01:35:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85559 invoked by uid 500); 20 Apr 2006 01:35:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85545 invoked by uid 99); 20 Apr 2006 01:35:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 18:35:41 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 18:35:40 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch1.xch.corp.yahoo.com
 [216.145.51.233])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3K1WiA4022541
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 18:32:44 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=qlnEbelCmTbbddvsSlE1A4QAPNfKzg7EJFS/7ViRRToRn5Ezux4nV/0JhS982VMm
Received: from [10.0.1.5] ([10.72.76.34]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 19 Apr 2006 18:32:43 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <44453DD2.8080208@apache.org>
References: <579105BD-4157-4E70-986F-A1F23B6AD180@media-style.com>
 <44453DD2.8080208@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <A65F7248-10D7-4B41-8468-7624F05E5F3E@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: IdentityMapper
Date: Wed, 19 Apr 2006 17:34:00 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 20 Apr 2006 01:32:43.0850 (UTC)
 FILETIME=[524022A0:01C6641A]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

might be cool to special case a reduce on sorted input.

On Apr 18, 2006, at 12:28 PM, Doug Cutting wrote:

> Stefan Groschupf wrote:
>> what is the reason that each job that has no mapper defined runs  
>> the  IdentityMapper?
>> Handling different formats (as discussed) between mapping and   
>> reducing is difficult.
>> Having one job that just map in the one format and having another  
>> job  that just reduce
>> in a other format would be a nice workaround of the format  
>> problem  but the IdentityMapper makes this workaround impossible.
>
> Stefan,
>
> I don't understand the problem here.  Some map function is required  
> for any data to make it to reduce.  IdentityMapper simply copies  
> all map input without altering it.  How does this cause you  
> problems?  Would you prefer a NullMapper by default, that does  
> nothing?  That would result in no output sent to reduce.
>
> Thanks,
>
> Doug


From MAILER-DAEMON Thu Apr 20 04:33:58 2006
Return-Path: 
 <hadoop-dev-return-900-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6970 invoked from network); 20 Apr 2006 04:33:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 04:33:58 -0000
Received: (qmail 5064 invoked by uid 500); 20 Apr 2006 04:33:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5031 invoked by uid 500); 20 Apr 2006 04:33:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5022 invoked by uid 99); 20 Apr 2006 04:33:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 21:33:57 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [66.228.160.55] (HELO mercury2.inktomi.com) (66.228.160.55)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Apr 2006 21:33:56 -0700
Received: from inbox1.inktomi.com (inbox1.inktomi.com [66.228.160.102])
	by mercury2.inktomi.com (8.13.4/8.13.4) with ESMTP id k3K4XPeo014880
	for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr 2006 21:33:28 -0700 (PDT)
Received: from [192.168.1.66] ([172.21.179.13]) by
          inbox1.inktomi.com (Netscape Messaging Server 4.1) with ESMTP id
          IY07BP00.6U5 for <hadoop-dev@lucene.apache.org>; Wed, 19 Apr
          2006 21:33:25 -0700
Mime-Version: 1.0 (Apple Message framework v623)
In-Reply-To: <A65F7248-10D7-4B41-8468-7624F05E5F3E@yahoo-inc.com>
References: <579105BD-4157-4E70-986F-A1F23B6AD180@media-style.com>
 <44453DD2.8080208@apache.org>
 <A65F7248-10D7-4B41-8468-7624F05E5F3E@yahoo-inc.com>
Content-Type: multipart/alternative; boundary=Apple-Mail-21--303321109
Message-Id: <30f55282400672ecf430882f670f0b2a@inktomi.com>
From: "Arkady Borkovsky" <arkady@inktomi.com>
Subject: Re: IdentityMapper
Date: Wed, 19 Apr 2006 21:33:23 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-21--303321109
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	format=flowed

Eric has a great point.

It is pretty common to produce a set of records in map step, group them 
by key in reduce step and store for future use.
Whenever this data is used, it is already grouped by key and 
essentially ready for reduce.
Special casing for this may be a useful optimization.

-- ab

On Apr 19, 2006, at 5:34 PM, Eric Baldeschwieler wrote:

> might be cool to special case a reduce on sorted input.
>
> On Apr 18, 2006, at 12:28 PM, Doug Cutting wrote:
>
>> Stefan Groschupf wrote:
>>> what is the reason that each job that has no mapper defined runs the 
>>>  IdentityMapper?
>>> Handling different formats (as discussed) between mapping and  
>>> reducing is difficult.
>>> Having one job that just map in the one format and having another 
>>> job  that just reduce
>>> in a other format would be a nice workaround of the format problem  
>>> but the IdentityMapper makes this workaround impossible.
>>
>> Stefan,
>>
>> I don't understand the problem here.  Some map function is required 
>> for any data to make it to reduce.  IdentityMapper simply copies all 
>> map input without altering it.  How does this cause you problems?  
>> Would you prefer a NullMapper by default, that does nothing?  That 
>> would result in no output sent to reduce.
>>
>> Thanks,
>>
>> Doug
>

--Apple-Mail-21--303321109--


From MAILER-DAEMON Thu Apr 20 13:53:06 2006
Return-Path: 
 <hadoop-dev-return-901-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9515 invoked from network); 20 Apr 2006 13:53:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 13:53:06 -0000
Received: (qmail 56610 invoked by uid 500); 20 Apr 2006 13:53:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56586 invoked by uid 500); 20 Apr 2006 13:53:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56570 invoked by uid 99); 20 Apr 2006 13:53:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 06:53:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 06:53:02 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id CFEBE14453D
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 15:37:33 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 28327-08 for <hadoop-dev@lucene.apache.org>;
	Thu, 20 Apr 2006 15:37:33 +0200 (CEST)
Received: from [192.168.200.39] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id A7F1614453C
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 15:37:33 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <44453DD2.8080208@apache.org>
References: <579105BD-4157-4E70-986F-A1F23B6AD180@media-style.com>
 <44453DD2.8080208@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <03EA3BBC-FD17-4697-BC19-928AB782737C@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: IdentityMapper
Date: Thu, 20 Apr 2006 15:52:37 +0200
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Doug,

> I don't understand the problem here.

There is no really problem, just a question to better understand hadoop.
My real problem is that the map  and reduce task have to have the  
same key and value class.
Since changing this is a little bit more work as far I can say that,  
I was thinking having one job that do my map task with these key -  
value classes and having another job doing my reduce job with a  
different key - value class would be a good workaround.



> Some map function is required for any data to make it to reduce.   
> IdentityMapper simply copies all map input without altering it.
But required to have the same key - value classes.
If you take a look to my Black White List patch for nutch, you will  
find a FormatConverter that is only required since the problem with  
key value classes.
In case no Mapping at all would be required and the input is just  
copied without sending it to any writer again.
The reducing can be done on the input of a job.

Sorry I hope this makes more sense and  I could clarify my question.

Stefan

From MAILER-DAEMON Thu Apr 20 17:05:10 2006
Return-Path: 
 <hadoop-dev-return-902-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29437 invoked from network); 20 Apr 2006 17:05:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 17:05:10 -0000
Received: (qmail 26535 invoked by uid 500); 20 Apr 2006 17:05:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26510 invoked by uid 500); 20 Apr 2006 17:05:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26501 invoked by uid 99); 20 Apr 2006 17:05:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:05:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:05:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DDAAA7142E0
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 17:04:06 +0000 (GMT)
Message-ID: <8418976.1145552646904.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 17:04:06 +0000 (GMT+00:00)
From: "Teppo Kurki (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-115?page=all ]

Teppo Kurki updated HADOOP-115:
-------------------------------

    Attachment: hadoop-115_ReduceTask.patch

Patch including

TestReduceTask
- generates a bunch of SequenceFiles and reduces them by running a single ReduceTask
- two test methods, one where input is just copied to output and one where the Reducer swaps keys and values
- Reducer checks that all generated key-value pairs are reduced by key
- checks that the resulting output file contains what it's supposed to

JobConf
- the necessary set/getMapOutputKey/ValueClass methods
- getOutputComparator uses MapKeyClass if one is specified

ReduceTask
- append and sort phases get the classes from getMapOutput.. methods

This should take care of the Reduce part of the problem. MapTask should be also adjusted accordingly, but since I haven'twritten  a test for that I haven't done it yet.

Owen, I didn't get your comment on handling the combiners - doesn't the combiner just use the map OutputCollector underneath and as you put it 

map: k1,v1 -> seq(k2,v2)
combine: k2,seq(v2) -> seq(k2,v2) 

the outputs are exactly the same, even if the combiner is technically a Reducer?







> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Runping Qi
>  Attachments: hadoop-115_ReduceTask.patch, hadoop-115_tk.patch
>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 17:26:10 2006
Return-Path: 
 <hadoop-dev-return-903-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41551 invoked from network); 20 Apr 2006 17:26:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 17:26:10 -0000
Received: (qmail 67154 invoked by uid 500); 20 Apr 2006 17:26:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67116 invoked by uid 500); 20 Apr 2006 17:26:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67076 invoked by uid 99); 20 Apr 2006 17:26:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:26:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:26:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 82D027142DF
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 17:25:06 +0000 (GMT)
Message-ID: <13974434.1145553906527.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 17:25:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-141) Disk thrashing / task timeouts
 during map output copy phase
In-Reply-To: <9808210.1145312482052.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-141?page=comments#action_12375401 ] 

Doug Cutting commented on HADOOP-141:
-------------------------------------

Some timeouts during the copy phase may not be bad.  If too many nodes are transferring from a given node, then it may time out additional requests.  And if a one node is already transferring from a another node for one task, then attempts by a second task to transfer may timeout (due to the shared connection pool).  These should not affect overall performance too much, especially if the timeout is relatively short.

> Disk thrashing / task timeouts during map output copy phase
> -----------------------------------------------------------
>
>          Key: HADOOP-141
>          URL: http://issues.apache.org/jira/browse/HADOOP-141
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>  Environment: linux
>     Reporter: paul sutter

>
> MapOutputProtocol connections cause timeouts because of system thrashing and transferring the same file over and over again, ultimately leading to making no forward progress(medium sized job, 500GB input file, map output about as large as the input, 10 node cluster).
> There are several bugs behind this, but the following two changes improved matters considerably.
> (1) 
> The buffersize in MapOutputFile is currently hardcoded to 8192 bytes (for both reads and writes). By changing this buffer size to 256KB, the number of disk seeks are reduced and the problem went away. 
> Ideally there would be a buffer size parameter for this that is separate from the DFS io buffer size.
> (2)
> I also added the following code to the socket configuration in both Server.java and Client.java. No linger is a minor good idea in an enivronment with some packet loss (and you will have that when all the nodes get busy at once), but 256KB buffers is probably excessive, especially on a LAN, but it takes me two hours to test changes so I havent experimented.
> socket.setSendBufferSize(256*1024);
> socket.setReceiveBufferSize(256*1024);
> socket.setSoLinger(false, 0);
> socket.setKeepAlive(true);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 17:34:09 2006
Return-Path: 
 <hadoop-dev-return-904-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44964 invoked from network); 20 Apr 2006 17:34:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 17:34:09 -0000
Received: (qmail 75592 invoked by uid 500); 20 Apr 2006 17:34:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75567 invoked by uid 500); 20 Apr 2006 17:34:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75558 invoked by uid 99); 20 Apr 2006 17:34:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:34:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:34:07 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BD49A7142DF
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 17:33:05 +0000 (GMT)
Message-ID: <14064096.1145554385768.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 17:33:05 +0000 (GMT+00:00)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-152) Speculative tasks not being scheduled
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Speculative tasks not being scheduled
-------------------------------------

         Key: HADOOP-152
         URL: http://issues.apache.org/jira/browse/HADOOP-152
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2    
 Environment: ~30 node Opteron cluster
    Reporter: Bryan Pendleton
    Priority: Minor


The criteria for starting up a speculative task includes a check that the "average progress"-"progress" > the speculative gap, currently 0.2.

I don't know if this is the right metric, but it doesn't seem to be correctly calculated. I've regularly seen the "average progress" with values of less than 0.01, while the "progress" value is showing in the range .90-1.0, and yet, still no speculative tasks are started up. This has caused at least one long-running task to run about 10% longer while overloaded hosts catch up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 17:36:10 2006
Return-Path: 
 <hadoop-dev-return-905-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45553 invoked from network); 20 Apr 2006 17:36:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 17:36:10 -0000
Received: (qmail 76636 invoked by uid 500); 20 Apr 2006 17:36:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76605 invoked by uid 500); 20 Apr 2006 17:36:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76591 invoked by uid 99); 20 Apr 2006 17:36:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:36:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:36:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8EC327142DE
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 17:35:06 +0000 (GMT)
Message-ID: <32673862.1145554506576.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 17:35:06 +0000 (GMT+00:00)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-69) Unchecked lookup value causes NPE in
 FSNamesystemgetDatanodeHints
In-Reply-To: <619464289.1141779100144.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-69?page=comments#action_12375403 ] 

Bryan Pendleton commented on HADOOP-69:
---------------------------------------

Bump: Any reason this patch hasn't been applied? It looks like it's still possible for non-found blocks to return null, causing an NPE in this function, rather than a more graceful recovery.

> Unchecked lookup value causes NPE in FSNamesystemgetDatanodeHints
> -----------------------------------------------------------------
>
>          Key: HADOOP-69
>          URL: http://issues.apache.org/jira/browse/HADOOP-69
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Bryan Pendleton
>  Attachments: patch.txt
>


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 17:42:13 2006
Return-Path: 
 <hadoop-dev-return-906-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48243 invoked from network); 20 Apr 2006 17:42:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 17:42:13 -0000
Received: (qmail 86391 invoked by uid 500); 20 Apr 2006 17:42:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86373 invoked by uid 500); 20 Apr 2006 17:42:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86363 invoked by uid 99); 20 Apr 2006 17:42:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:42:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:42:12 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A84F97142DE
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 17:41:05 +0000 (GMT)
Message-ID: <25993970.1145554865659.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 17:41:05 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-153) skip records that throw exceptions
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

skip records that throw exceptions
----------------------------------

         Key: HADOOP-153
         URL: http://issues.apache.org/jira/browse/HADOOP-153
     Project: Hadoop
        Type: New Feature

  Components: mapred  
    Reporter: Doug Cutting


MapReduce should skip records that throw exceptions.

If the exception is thrown under RecordReader.next() then RecordReader implementations should automatically skip to the start of a subsequent record.

Exceptions in map and reduce implementations can simply be logged, unless they happen under RecordWriter.write().  Cancelling partial output could be hard.  So such output errors will still result in task failure.

This behaviour should be optional, but enabled by default.  A count of errors per task and job should be maintained and displayed in the web ui.  Perhaps if some percentage of records (>50%?) result in exceptions then the task should fail.  This would stop jobs early that are misconfigured or have buggy code.

Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 17:59:09 2006
Return-Path: 
 <hadoop-dev-return-907-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56117 invoked from network); 20 Apr 2006 17:59:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 17:59:09 -0000
Received: (qmail 15768 invoked by uid 500); 20 Apr 2006 17:59:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15752 invoked by uid 500); 20 Apr 2006 17:59:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15743 invoked by uid 99); 20 Apr 2006 17:59:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:59:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 10:59:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 058097142DE
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 17:58:06 +0000 (GMT)
Message-ID: <7608779.1145555886003.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 17:58:06 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-153) skip records that throw exceptions
In-Reply-To: <25993970.1145554865659.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-153?page=comments#action_12375405 ] 

Sameer Paranjpye commented on HADOOP-153:
-----------------------------------------

+1

This would be a cool feature to have. Perhaps the exceptions should also be made visible at the jobtracker. An extension to manage exceptions in RecordWriter.write() could record the offending key(s) and skip them the next time the task is run.

> skip records that throw exceptions
> ----------------------------------
>
>          Key: HADOOP-153
>          URL: http://issues.apache.org/jira/browse/HADOOP-153
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Doug Cutting

>
> MapReduce should skip records that throw exceptions.
> If the exception is thrown under RecordReader.next() then RecordReader implementations should automatically skip to the start of a subsequent record.
> Exceptions in map and reduce implementations can simply be logged, unless they happen under RecordWriter.write().  Cancelling partial output could be hard.  So such output errors will still result in task failure.
> This behaviour should be optional, but enabled by default.  A count of errors per task and job should be maintained and displayed in the web ui.  Perhaps if some percentage of records (>50%?) result in exceptions then the task should fail.  This would stop jobs early that are misconfigured or have buggy code.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 18:20:10 2006
Return-Path: 
 <hadoop-dev-return-908-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63487 invoked from network); 20 Apr 2006 18:20:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 18:20:10 -0000
Received: (qmail 43531 invoked by uid 500); 20 Apr 2006 18:20:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43502 invoked by uid 500); 20 Apr 2006 18:20:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43493 invoked by uid 99); 20 Apr 2006 18:20:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:20:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:20:09 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 212FA7142DE
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 18:19:07 +0000 (GMT)
Message-ID: <9207606.1145557147131.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 18:19:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-69) Unchecked lookup value causes NPE in
 FSNamesystemgetDatanodeHints
In-Reply-To: <619464289.1141779100144.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-69?page=all ]
     
Doug Cutting resolved HADOOP-69:
--------------------------------

    Fix Version: 0.2
     Resolution: Fixed

Committed.  Sorry, this fell off my radar.  Thanks for the reminder.  I fixed something related in:

http://svn.apache.org/viewcvs.cgi/lucene/hadoop/trunk/src/java/org/apache/hadoop/dfs/FSNamesystem.java?rev=382545&r1=377317&r2=382545

so I hadn't seen this problem.


> Unchecked lookup value causes NPE in FSNamesystemgetDatanodeHints
> -----------------------------------------------------------------
>
>          Key: HADOOP-69
>          URL: http://issues.apache.org/jira/browse/HADOOP-69
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Bryan Pendleton
>      Fix For: 0.2
>  Attachments: patch.txt
>


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 18:20:11 2006
Return-Path: 
 <hadoop-dev-return-909-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63514 invoked from network); 20 Apr 2006 18:20:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 18:20:11 -0000
Received: (qmail 43653 invoked by uid 500); 20 Apr 2006 18:20:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43636 invoked by uid 500); 20 Apr 2006 18:20:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43627 invoked by uid 99); 20 Apr 2006 18:20:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:20:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:20:09 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BF36E7142DF
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 18:19:07 +0000 (GMT)
Message-ID: <4918806.1145557147778.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 18:19:07 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-153) skip records that throw exceptions
In-Reply-To: <25993970.1145554865659.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-153?page=comments#action_12375408 ] 

stack@archive.org commented on HADOOP-153:
------------------------------------------

+1

This would be a generalization of the checksum handler that tries to skip records when 'io.skip.checksum.errors' is set.  In a recent note on the list, I speculate that there are a class of IOExceptions that should be treatable in the same manner -- skipped if a flag is set (Search subject line ''Corrupt GZIP trailer' and other irrecoverable IOEs.').

> skip records that throw exceptions
> ----------------------------------
>
>          Key: HADOOP-153
>          URL: http://issues.apache.org/jira/browse/HADOOP-153
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Doug Cutting

>
> MapReduce should skip records that throw exceptions.
> If the exception is thrown under RecordReader.next() then RecordReader implementations should automatically skip to the start of a subsequent record.
> Exceptions in map and reduce implementations can simply be logged, unless they happen under RecordWriter.write().  Cancelling partial output could be hard.  So such output errors will still result in task failure.
> This behaviour should be optional, but enabled by default.  A count of errors per task and job should be maintained and displayed in the web ui.  Perhaps if some percentage of records (>50%?) result in exceptions then the task should fail.  This would stop jobs early that are misconfigured or have buggy code.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 18:25:14 2006
Return-Path: 
 <hadoop-dev-return-910-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68742 invoked from network); 20 Apr 2006 18:25:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 18:25:14 -0000
Received: (qmail 55112 invoked by uid 500); 20 Apr 2006 18:25:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55033 invoked by uid 500); 20 Apr 2006 18:25:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54880 invoked by uid 99); 20 Apr 2006 18:25:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:25:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:25:09 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ADE817142E3
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 18:24:07 +0000 (GMT)
Message-ID: <13822204.1145557447709.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 18:24:07 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-141) Disk thrashing / task timeouts
 during map output copy phase
In-Reply-To: <9808210.1145312482052.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-141?page=comments#action_12375411 ] 

paul sutter commented on HADOOP-141:
------------------------------------


A few timeouts would be fine. The problem is when the same files timeout over and over again, and progress ceases completely. 

I was able to make the problem go away by increasing the number of mappers by 6X, making the map output files 1/6th as large, so I have given up on finding the problem.

So here is the summary:

- with 700MB map output files (18 mappers), original code: the job would never progress past reduce progress of  17% or 18%.
- with 700MB map output files (18 mappers), large buffers: the job completed in 27 hours
- with 120MB map output files (106 mappers), and large buffers: the job completed in 6 hours

Im happy to share logs that include the timeouts and extended logging information on MapOutputFile.java if anyone is interested, but i wont post them here because they are several hundred megabytes.

Otherwise I will continue to use the workaround of smaller map output files.

> Disk thrashing / task timeouts during map output copy phase
> -----------------------------------------------------------
>
>          Key: HADOOP-141
>          URL: http://issues.apache.org/jira/browse/HADOOP-141
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>  Environment: linux
>     Reporter: paul sutter

>
> MapOutputProtocol connections cause timeouts because of system thrashing and transferring the same file over and over again, ultimately leading to making no forward progress(medium sized job, 500GB input file, map output about as large as the input, 10 node cluster).
> There are several bugs behind this, but the following two changes improved matters considerably.
> (1) 
> The buffersize in MapOutputFile is currently hardcoded to 8192 bytes (for both reads and writes). By changing this buffer size to 256KB, the number of disk seeks are reduced and the problem went away. 
> Ideally there would be a buffer size parameter for this that is separate from the DFS io buffer size.
> (2)
> I also added the following code to the socket configuration in both Server.java and Client.java. No linger is a minor good idea in an enivronment with some packet loss (and you will have that when all the nodes get busy at once), but 256KB buffers is probably excessive, especially on a LAN, but it takes me two hours to test changes so I havent experimented.
> socket.setSendBufferSize(256*1024);
> socket.setReceiveBufferSize(256*1024);
> socket.setSoLinger(false, 0);
> socket.setKeepAlive(true);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 18:52:09 2006
Return-Path: 
 <hadoop-dev-return-911-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84118 invoked from network); 20 Apr 2006 18:52:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 18:52:09 -0000
Received: (qmail 87082 invoked by uid 500); 20 Apr 2006 18:52:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87058 invoked by uid 500); 20 Apr 2006 18:52:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87049 invoked by uid 99); 20 Apr 2006 18:52:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:52:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:52:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0859D7142DE
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 18:51:06 +0000 (GMT)
Message-ID: <12064781.1145559066015.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 18:51:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-153) skip records that throw exceptions
In-Reply-To: <25993970.1145554865659.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-153?page=all ]

Doug Cutting updated HADOOP-153:
--------------------------------

      Version: 0.2
    Assign To: Doug Cutting

> skip records that throw exceptions
> ----------------------------------
>
>          Key: HADOOP-153
>          URL: http://issues.apache.org/jira/browse/HADOOP-153
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting

>
> MapReduce should skip records that throw exceptions.
> If the exception is thrown under RecordReader.next() then RecordReader implementations should automatically skip to the start of a subsequent record.
> Exceptions in map and reduce implementations can simply be logged, unless they happen under RecordWriter.write().  Cancelling partial output could be hard.  So such output errors will still result in task failure.
> This behaviour should be optional, but enabled by default.  A count of errors per task and job should be maintained and displayed in the web ui.  Perhaps if some percentage of records (>50%?) result in exceptions then the task should fail.  This would stop jobs early that are misconfigured or have buggy code.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 18:54:15 2006
Return-Path: 
 <hadoop-dev-return-912-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84841 invoked from network); 20 Apr 2006 18:54:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 18:54:15 -0000
Received: (qmail 88907 invoked by uid 500); 20 Apr 2006 18:54:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88786 invoked by uid 500); 20 Apr 2006 18:54:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88686 invoked by uid 99); 20 Apr 2006 18:54:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:54:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 11:54:12 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3D0297142DE
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 18:53:10 +0000 (GMT)
Message-ID: <31292353.1145559190176.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 18:53:10 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-153) skip records that throw exceptions
In-Reply-To: <25993970.1145554865659.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-153?page=all ]

Doug Cutting updated HADOOP-153:
--------------------------------

    Fix Version: 0.2

> skip records that throw exceptions
> ----------------------------------
>
>          Key: HADOOP-153
>          URL: http://issues.apache.org/jira/browse/HADOOP-153
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.2

>
> MapReduce should skip records that throw exceptions.
> If the exception is thrown under RecordReader.next() then RecordReader implementations should automatically skip to the start of a subsequent record.
> Exceptions in map and reduce implementations can simply be logged, unless they happen under RecordWriter.write().  Cancelling partial output could be hard.  So such output errors will still result in task failure.
> This behaviour should be optional, but enabled by default.  A count of errors per task and job should be maintained and displayed in the web ui.  Perhaps if some percentage of records (>50%?) result in exceptions then the task should fail.  This would stop jobs early that are misconfigured or have buggy code.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 19:05:08 2006
Return-Path: 
 <hadoop-dev-return-913-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89492 invoked from network); 20 Apr 2006 19:05:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 19:05:08 -0000
Received: (qmail 887 invoked by uid 500); 20 Apr 2006 19:05:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 837 invoked by uid 500); 20 Apr 2006 19:05:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 745 invoked by uid 99); 20 Apr 2006 19:05:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 12:05:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 12:05:05 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 5EA06144463
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 20:49:36 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 29947-05 for <hadoop-dev@lucene.apache.org>;
	Thu, 20 Apr 2006 20:49:36 +0200 (CEST)
Received: from [192.168.8.2] (dslb-088-073-194-136.pools.arcor-ip.net
 [88.73.194.136])
	by mslinux.media-style.com (Postfix) with ESMTP id 86AB61443BB
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 20:49:35 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
To: hadoop-dev@lucene.apache.org
Message-Id: <B7160B00-FD6D-40AE-9B16-91A03F8AB86A@media-style.com>
Content-Type: multipart/alternative; boundary=Apple-Mail-1--251059582
From: Stefan Groschupf <sg@media-style.com>
Subject: unsorted keys in Map File
Date: Thu, 20 Apr 2006 21:04:24 +0200
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-1--251059582
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed

Hi hadoop developers,

I'm looking for a hint or inspiration for a problem I would love to  
solve with the hadoop platform but it is not map reduce related.
My data structure is builded from rows and each row has a set of  
columns and column values.
For example row key: cnn.com column keys: user1, user2 ... values: 2,  
1...  etc.
I plan to realize the structure using writable's to be able storing  
my data in dfs.

My problem is now that I would love to read very fast one rowkey- 
columnKey- (may be timestamp) value.

My first idea was to have a row writable that contains all column- 
value tuples. This can be written into a mapfile and find using a row  
key.
However it require me to load all column-values into the memory to  
find a given column value by column key. In case the I have  to many   
columns this would not be very fast and memory consuming.

The second idea was to write the rowkey and some meta data to the map  
file followed by a set of column key column value tuples.
The problem here is that a map file only accepts sorted keys, means  
my column -key required to build form a row key - column key tuple.
This solution would blow up my data very much since I have to write  
the row key as many times I have columns.  :-/

Any hints how I can reuse the existing writers and readers to solve  
me problem or should I implement my own reader and writer?

Thank you very much for any hints.

Stefan 
--Apple-Mail-1--251059582--

From MAILER-DAEMON Thu Apr 20 19:10:14 2006
Return-Path: 
 <hadoop-dev-return-914-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91652 invoked from network); 20 Apr 2006 19:10:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 19:10:14 -0000
Received: (qmail 6443 invoked by uid 500); 20 Apr 2006 19:10:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6314 invoked by uid 500); 20 Apr 2006 19:10:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6300 invoked by uid 99); 20 Apr 2006 19:10:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 12:10:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 12:10:11 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A77AB7142E2
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 19:09:09 +0000 (GMT)
Message-ID: <32388760.1145560149668.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 19:09:09 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]

David Bowen updated HADOOP-132:
-------------------------------

    Attachment: javadoc.tgz

Here is an updated API, incorporating the feedback I've received so far.  The main
changes are 

   (1) Ganglia support is included - this doesn't really affect the API, but the javadoc describes the configuration options which might be of interest.

   (2) The SPI (service provider interface) is now in a separate package, and it does most of the implementation work so that implementation packages (like the file and ganglia sub-packages) can be quite small.

  (3) The unbuffered option has been removed.  This means that developers can use the API freely in inner-loops without the concern that metric reporting might be configured to emit data on every update.  The data will just be stored in an internal table, and the table will only be sent periodically to the metrics server.



> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Reporter: David Bowen
>  Attachments: javadoc.tgz, javadoc.tgz
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 20:13:09 2006
Return-Path: 
 <hadoop-dev-return-915-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27160 invoked from network); 20 Apr 2006 20:13:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 20:13:09 -0000
Received: (qmail 88667 invoked by uid 500); 20 Apr 2006 20:13:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88629 invoked by uid 500); 20 Apr 2006 20:13:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88610 invoked by uid 99); 20 Apr 2006 20:13:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 13:13:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 13:13:07 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AC4127142E0
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 20:12:05 +0000 (GMT)
Message-ID: <10284142.1145563925675.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 20:12:05 +0000 (GMT+00:00)
From: "Lei Chen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-154) fsck fails when there is no file in
 dfs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

fsck fails when there is no file in dfs
---------------------------------------

         Key: HADOOP-154
         URL: http://issues.apache.org/jira/browse/HADOOP-154
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.1.1    
    Reporter: Lei Chen
    Priority: Trivial


First type in command
    
     hadoop namenode -format

Then 

     hadoop fsck /

Then is the following exception:

Exception in thread "main" java.lang.ArithmeticException: / by zero
        at org.apache.hadoop.dfs.DFSck$Result.toString(DFSck.java:563)
        at java.lang.String.valueOf(String.java:2577)
        at java.io.PrintStream.print(PrintStream.java:616)
        at java.io.PrintStream.println(PrintStream.java:753)
        at org.apache.hadoop.dfs.DFSck.main(DFSck.java:435)

Possible Solution: Check whether totalBlocks equal to 0 in line 563 of DFSck.java

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 20:22:11 2006
Return-Path: 
 <hadoop-dev-return-916-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30527 invoked from network); 20 Apr 2006 20:22:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 20:22:11 -0000
Received: (qmail 8402 invoked by uid 500); 20 Apr 2006 20:22:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8377 invoked by uid 500); 20 Apr 2006 20:22:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8368 invoked by uid 99); 20 Apr 2006 20:22:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 13:22:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 13:22:07 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AF23A7142E2
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 20:21:05 +0000 (GMT)
Message-ID: <15786097.1145564465714.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 20:21:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-155) Add a conf dir parameter to the
 scripts
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Add a conf dir parameter to the scripts
---------------------------------------

         Key: HADOOP-155
         URL: http://issues.apache.org/jira/browse/HADOOP-155
     Project: Hadoop
        Type: Improvement

  Components: conf  
    Reporter: Owen O'Malley


We'd like a conf_dir parameter on the startup scripts (ie. "-c <confdif>"). In particular, it would be nice if it propagated down from hadoop-daemons.sh to slaves.sh to hadoop-daemon.sh using the command line rather than using the ssh -o SendEnv=HADOOP_CONF_DIR, which is not supported in many environments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 21:12:10 2006
Return-Path: 
 <hadoop-dev-return-917-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51633 invoked from network); 20 Apr 2006 21:12:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 21:12:10 -0000
Received: (qmail 89411 invoked by uid 500); 20 Apr 2006 21:12:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89310 invoked by uid 500); 20 Apr 2006 21:12:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89270 invoked by uid 99); 20 Apr 2006 21:12:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 14:12:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 14:12:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B7BA77142E3
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 21:11:05 +0000 (GMT)
Message-ID: <6737684.1145567465749.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 21:11:05 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-156) Reducer  threw IOEOFException
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Reducer  threw IOEOFException
-----------------------------

         Key: HADOOP-156
         URL: http://issues.apache.org/jira/browse/HADOOP-156
     Project: Hadoop
        Type: Bug

    Reporter: Runping Qi



A job was running with all the map tasks completed.
The reducers were appending the intermediate files into the large intermediate file.
java.io.EOFException was thrown when the record reader tried to read the version number
during initialization. Here is the stack trace:

java.io.EOFException 
    at java.io.DataInputStream.readFully(DataInputStream.java:178) 
    at java.io.DataInputStream.readFully(DataInputStream.java:152) 
    at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:251) 
    at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:236) 
    at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:226) 
    at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:205) 
    at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709) 

Appearantly, the intermediate file was empty. I suspect that one map task
generated empty intermidiate files for all the reducers, since all the reducers
failed at the same place, and failed at the same place during retries.

Unfortunately, we cannot know which map task generated the empty files,
since the exception does not offer any clue.

One simple enhancement is that the record reader should catch IOException and re-throw it with additional 
information, such as the file name.



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 21:37:10 2006
Return-Path: 
 <hadoop-dev-return-918-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63960 invoked from network); 20 Apr 2006 21:37:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 21:37:10 -0000
Received: (qmail 25403 invoked by uid 500); 20 Apr 2006 21:37:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 25370 invoked by uid 500); 20 Apr 2006 21:37:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 25361 invoked by uid 99); 20 Apr 2006 21:37:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 14:37:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 14:37:09 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D1D607142E2
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 21:36:06 +0000 (GMT)
Message-ID: <32953762.1145568966856.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 21:36:06 +0000 (GMT+00:00)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-108) EOFException in
 DataNode$DataXceiver.run
In-Reply-To: <252030003.1143587841245.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-108?page=comments#action_12375436 ] 

Igor Bolotin commented on HADOOP-108:
-------------------------------------

This problem didn't happen to us anymore after upgrading Hadoop. 
Also, based on the description - this one looks like duplicate of HADOOP-128, so I'd like to suggest to close it.


> EOFException in DataNode$DataXceiver.run
> ----------------------------------------
>
>          Key: HADOOP-108
>          URL: http://issues.apache.org/jira/browse/HADOOP-108
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Igor Bolotin

>
> This morning - after upgrade of the system - something got wrong and we started to get lot of exceptions.
> Situation didn't change after removing everything and creating new file system. 
> Multiple exceptions on all data nodes:
> 060328 145922 108 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:448)
>         at java.lang.Thread.run(Thread.java:595)
> No errors on the name node.
> DFS clients report following:
> 060328 150923 task_r_2twzsl  Error while writing.
> 060328 150923 task_r_2twzsl java.net.SocketTimeoutException: Read timed out
> 060328 150923 task_r_2twzsl     at java.net.SocketInputStream.socketRead0(Native Method)
> 060328 150923 task_r_2twzsl     at java.net.SocketInputStream.read(SocketInputStream.java:129)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
> 060328 150923 task_r_2twzsl     at java.io.DataInputStream.readFully(DataInputStream.java:176)
> 060328 150923 task_r_2twzsl     at java.io.DataInputStream.readLong(DataInputStream.java:380)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:776)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.endBlock(DFSClient.java:751)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.close(DFSClient.java:814)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.fs.FileSystem.createNewFile(FileSystem.java:202)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 21:54:09 2006
Return-Path: 
 <hadoop-dev-return-919-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71448 invoked from network); 20 Apr 2006 21:54:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 21:54:09 -0000
Received: (qmail 48671 invoked by uid 500); 20 Apr 2006 21:54:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48651 invoked by uid 500); 20 Apr 2006 21:54:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48642 invoked by uid 99); 20 Apr 2006 21:54:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 14:54:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 14:54:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6B0477142E2
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 21:53:06 +0000 (GMT)
Message-ID: <22241933.1145569986429.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 21:53:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-132?page=comments#action_12375438 ] 

Doug Cutting commented on HADOOP-132:
-------------------------------------

+1 Looks good to me!

I think there's a typo in the overview, where you should have setMetric() you instead have setGauge().



> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Reporter: David Bowen
>  Attachments: javadoc.tgz, javadoc.tgz
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 22:55:13 2006
Return-Path: 
 <hadoop-dev-return-920-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 977 invoked from network); 20 Apr 2006 22:55:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 22:55:13 -0000
Received: (qmail 31289 invoked by uid 500); 20 Apr 2006 22:55:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31169 invoked by uid 500); 20 Apr 2006 22:55:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31158 invoked by uid 99); 20 Apr 2006 22:55:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 15:55:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 15:55:12 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 455C37142E2
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 22:54:09 +0000 (GMT)
Message-ID: <17914984.1145573649270.JavaMail.jira@brutus>
Date: Thu, 20 Apr 2006 22:54:09 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]

Sameer Paranjpye updated HADOOP-132:
------------------------------------

    Fix Version: 0.2
        Version: 0.2
    Description: 
I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.

I'd be very interested in people's thoughts about what the requirements should be for such an API.

- David Bowen


  was:

I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.

I'd be very interested in people's thoughts about what the requirements should be for such an API.

- David Bowen



> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Versions: 0.2
>     Reporter: David Bowen
>      Fix For: 0.2
>  Attachments: javadoc.tgz, javadoc.tgz
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 20 23:14:51 2006
Return-Path: 
 <hadoop-dev-return-921-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7964 invoked from network); 20 Apr 2006 23:14:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 23:14:51 -0000
Received: (qmail 52657 invoked by uid 500); 20 Apr 2006 23:14:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52628 invoked by uid 500); 20 Apr 2006 23:14:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52605 invoked by uid 99); 20 Apr 2006 23:14:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 16:14:47 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 16:14:47 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 2E4FA144463;
	Fri, 21 Apr 2006 00:59:16 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 31057-07; Fri, 21 Apr 2006 00:59:16 +0200 (CEST)
Received: from [10.10.16.231] (unknown [64.71.164.125])
	by mslinux.media-style.com (Postfix) with ESMTP id E2A4B1443BB;
	Fri, 21 Apr 2006 00:59:13 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <0DB226AB-DC28-4BBD-AE66-16A580D2305F@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: nutch user meeting in San Francisco: May 18th
Date: Fri, 21 Apr 2006 01:14:13 +0200
To: nutch-user@lucene.apache.org, nutch-dev@lucene.apache.org,
	hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

(with apologies for multiple postings)

Dear Nutch users, Dear Nutch developers, Dear Hadoop developers,

we would love to invite you to the Nutch user meeting in San Francisco.

Date:  Thursday, May 18th, 2006
Time: 7 PM.
Location:  Cafe Du Soleil, 200 Fillmore St, San Francisco, CA 94117.   
(Thanks to Michael Stack helping to find this location)

http://sanfrancisco.citysearch.com/profile/41734267/san_francisco_ca/ 
cafe_du_soleil.html
http://maps.yahoo.com/beta/#maxp=search&q1bizid=29996598&q1=200 
+Fillmore+St+San 
+Francisco&mvt=m&trf=0&lon=-122.430074214935&lat=37.7713763317352&mag=3

Talks or something like that are not planed, the location is a cafe,  
so the idea is to meet each other, have dinner and some drinks.
It would be nice to get an idea how many people will join this  
meeting, so we can switch the location if necessary.
Please post to the nutch user list in case you plan to join the  
meeting, however a registration is not required.

Looking forward to meeting you.

Stefan

From MAILER-DAEMON Thu Apr 20 23:41:34 2006
Return-Path: 
 <hadoop-dev-return-922-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18413 invoked from network); 20 Apr 2006 23:41:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Apr 2006 23:41:34 -0000
Received: (qmail 86840 invoked by uid 500); 20 Apr 2006 23:41:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86737 invoked by uid 500); 20 Apr 2006 23:41:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86663 invoked by uid 99); 20 Apr 2006 23:41:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 16:41:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 16:41:29 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3KNf5ak011754;
	Thu, 20 Apr 2006 19:41:05 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3KNf12k075798;
	Thu, 20 Apr 2006 19:41:04 -0400
Message-ID: <44481C0D.4050109@apache.org>
Date: Thu, 20 Apr 2006 16:41:01 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: nutch-dev@lucene.apache.org
Subject: Re: nutch user meeting in San Francisco: May 18th
References: <0DB226AB-DC28-4BBD-AE66-16A580D2305F@media-style.com>
In-Reply-To: <0DB226AB-DC28-4BBD-AE66-16A580D2305F@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Folks can say whether they'll attend at:

http://www.evite.com/app/publicUrl/evite@lucene.com/nutch-1

Doug

From MAILER-DAEMON Fri Apr 21 00:52:29 2006
Return-Path: 
 <hadoop-dev-return-923-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37265 invoked from network); 21 Apr 2006 00:52:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 00:52:29 -0000
Received: (qmail 47579 invoked by uid 500); 21 Apr 2006 00:52:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47559 invoked by uid 500); 21 Apr 2006 00:52:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47550 invoked by uid 99); 21 Apr 2006 00:52:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 17:52:28 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 17:52:26 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch1.xch.corp.yahoo.com
 [216.145.51.233])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3L0orp1098678
	for <hadoop-dev@lucene.apache.org>; Thu, 20 Apr 2006 17:50:54 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=lXCI19NCI/UjI5ibLS3EjtfpyFGYRjuEBjJmxLIrUC0DUIsGyMtUhUY9OeXvw2c2
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Thu, 20 Apr 2006 17:50:53 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <13822204.1145557447709.JavaMail.jira@brutus>
References: <13822204.1145557447709.JavaMail.jira@brutus>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <B0D0E99A-2E72-4E4C-AAB5-099F09C3FC09@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-141) Disk thrashing / task timeouts
 during map output copy phase
Date: Thu, 20 Apr 2006 17:50:56 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 21 Apr 2006 00:50:53.0834 (UTC)
 FILETIME=[A493D6A0:01C664DD]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

humm,

The client is timing out when it is getting data?  Maybe as long as  
it is getting data, it should reset its timer?  Maybe the server  
should fail a client if it is busy?  This would let you make informed  
decision.

On Apr 20, 2006, at 11:24 AM, paul sutter (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-141? 
> page=comments#action_12375411 ]
>
> paul sutter commented on HADOOP-141:
> ------------------------------------
>
>
> A few timeouts would be fine. The problem is when the same files  
> timeout over and over again, and progress ceases completely.
>
> I was able to make the problem go away by increasing the number of  
> mappers by 6X, making the map output files 1/6th as large, so I  
> have given up on finding the problem.
>
> So here is the summary:
>
> - with 700MB map output files (18 mappers), original code: the job  
> would never progress past reduce progress of  17% or 18%.
> - with 700MB map output files (18 mappers), large buffers: the job  
> completed in 27 hours
> - with 120MB map output files (106 mappers), and large buffers: the  
> job completed in 6 hours
>
> Im happy to share logs that include the timeouts and extended  
> logging information on MapOutputFile.java if anyone is interested,  
> but i wont post them here because they are several hundred megabytes.
>
> Otherwise I will continue to use the workaround of smaller map  
> output files.
>
>> Disk thrashing / task timeouts during map output copy phase
>> -----------------------------------------------------------
>>
>>          Key: HADOOP-141
>>          URL: http://issues.apache.org/jira/browse/HADOOP-141
>>      Project: Hadoop
>>         Type: Bug
>
>>   Components: mapred
>>  Environment: linux
>>     Reporter: paul sutter
>
>>
>> MapOutputProtocol connections cause timeouts because of system  
>> thrashing and transferring the same file over and over again,  
>> ultimately leading to making no forward progress(medium sized job,  
>> 500GB input file, map output about as large as the input, 10 node  
>> cluster).
>> There are several bugs behind this, but the following two changes  
>> improved matters considerably.
>> (1)
>> The buffersize in MapOutputFile is currently hardcoded to 8192  
>> bytes (for both reads and writes). By changing this buffer size to  
>> 256KB, the number of disk seeks are reduced and the problem went  
>> away.
>> Ideally there would be a buffer size parameter for this that is  
>> separate from the DFS io buffer size.
>> (2)
>> I also added the following code to the socket configuration in  
>> both Server.java and Client.java. No linger is a minor good idea  
>> in an enivronment with some packet loss (and you will have that  
>> when all the nodes get busy at once), but 256KB buffers is  
>> probably excessive, especially on a LAN, but it takes me two hours  
>> to test changes so I havent experimented.
>> socket.setSendBufferSize(256*1024);
>> socket.setReceiveBufferSize(256*1024);
>> socket.setSoLinger(false, 0);
>> socket.setKeepAlive(true);
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Fri Apr 21 01:06:10 2006
Return-Path: 
 <hadoop-dev-return-924-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43456 invoked from network); 21 Apr 2006 01:06:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 01:06:10 -0000
Received: (qmail 64591 invoked by uid 500); 21 Apr 2006 01:06:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64575 invoked by uid 500); 21 Apr 2006 01:06:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64566 invoked by uid 99); 21 Apr 2006 01:06:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 18:06:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 18:06:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0AC4F7142E0
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 01:05:06 +0000 (GMT)
Message-ID: <24007173.1145581506019.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 01:05:06 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-153) skip records that throw exceptions
In-Reply-To: <25993970.1145554865659.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-153?page=comments#action_12375455 ] 

eric baldeschwieler commented on HADOOP-153:
--------------------------------------------

sounds good.  The acceptable % should probably be configurable.  I'd be inclined to use something more like 1%.  You could turn the feature off by configuring 0%, which should arguably be the default.


> skip records that throw exceptions
> ----------------------------------
>
>          Key: HADOOP-153
>          URL: http://issues.apache.org/jira/browse/HADOOP-153
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.2

>
> MapReduce should skip records that throw exceptions.
> If the exception is thrown under RecordReader.next() then RecordReader implementations should automatically skip to the start of a subsequent record.
> Exceptions in map and reduce implementations can simply be logged, unless they happen under RecordWriter.write().  Cancelling partial output could be hard.  So such output errors will still result in task failure.
> This behaviour should be optional, but enabled by default.  A count of errors per task and job should be maintained and displayed in the web ui.  Perhaps if some percentage of records (>50%?) result in exceptions then the task should fail.  This would stop jobs early that are misconfigured or have buggy code.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 01:23:10 2006
Return-Path: 
 <hadoop-dev-return-925-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54047 invoked from network); 21 Apr 2006 01:23:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 01:23:10 -0000
Received: (qmail 76941 invoked by uid 500); 21 Apr 2006 01:23:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76829 invoked by uid 500); 21 Apr 2006 01:23:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76820 invoked by uid 99); 21 Apr 2006 01:23:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 18:23:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Apr 2006 18:23:08 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 054997142E0
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 01:22:06 +0000 (GMT)
Message-ID: <13175945.1145582525991.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 01:22:05 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-153) skip records that throw exceptions
In-Reply-To: <25993970.1145554865659.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-153?page=comments#action_12375457 ] 

Runping Qi commented on HADOOP-153:
-----------------------------------


+1

Exceptions in the map and reduce functions that are implemented by the user should be handled by the user within the functions.
In the current implementation of sequencial file record reader, it is hard to skip to the next record if exception happens during record reading.



> skip records that throw exceptions
> ----------------------------------
>
>          Key: HADOOP-153
>          URL: http://issues.apache.org/jira/browse/HADOOP-153
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.2

>
> MapReduce should skip records that throw exceptions.
> If the exception is thrown under RecordReader.next() then RecordReader implementations should automatically skip to the start of a subsequent record.
> Exceptions in map and reduce implementations can simply be logged, unless they happen under RecordWriter.write().  Cancelling partial output could be hard.  So such output errors will still result in task failure.
> This behaviour should be optional, but enabled by default.  A count of errors per task and job should be maintained and displayed in the web ui.  Perhaps if some percentage of records (>50%?) result in exceptions then the task should fail.  This would stop jobs early that are misconfigured or have buggy code.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 15:09:52 2006
Return-Path: 
 <hadoop-dev-return-926-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60317 invoked from network); 21 Apr 2006 15:09:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 15:09:52 -0000
Received: (qmail 48050 invoked by uid 500); 21 Apr 2006 15:09:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48016 invoked by uid 500); 21 Apr 2006 15:09:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48007 invoked by uid 99); 21 Apr 2006 15:09:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 08:09:51 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 08:09:50 -0700
Received: from [10.1.1.100] (snvvpn2-10-72-76-c182.corp.yahoo.com
 [10.72.76.182])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k3LF9GHW018222
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 08:09:17 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:content-transfer-encoding:message-id:
	content-type:to:from:subject:date:x-mailer;
	b=s30CrI9ZfEhK7DxjqWJ0K/pRd2iUBWtOmFuVFKMp0QbwSZTJc2XCIeqXon3HuK5h
Mime-Version: 1.0 (Apple Message framework v623)
Content-Transfer-Encoding: 7bit
Message-Id: <2a581d5b89b5259b61a863b48b053673@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
To: hadoop-dev@lucene.apache.org
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: map/reduce writing benchmark
Date: Fri, 21 Apr 2006 08:09:16 -0700
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Ok, with my last change I've run the writer benchmark twice with no 
(fatal) problems. But the difference is interesting... On the same 189  
node cluster, the first time I had 30 some "ghost" task trackers. (eg. 
JobTracker started, taskTracker stopped and restarted so you get two 
tracker _node1100_<id> with different ids. One of which never delivers 
a heartbeat and does not request any tasks). The ghost trackers tricked 
the scheduler into thinking that the cluster wasn't very busy and so it 
never scheduled more than one task on any node. The results are:

run1 (1 task/node; 189 nodes; 1890 maps writing 1 gig of dfs data):
    time: 5405 seconds
    task failures: 0

run1 (4 task/node; 189 nodes; 1890 maps writing 1 gig of dfs data):
    time: 5785 seconds
    task failures: 173

That is still a lot of failures, but at least none of them cascaded 
into killing the entire job.

We need to time out TaskTrackers sooner (10 minutes? 30 minutes?)

We should probably use pending tasks rather than "current load" for 
determining when to give out new tasks.

2 cpu intel boxes are getting overloaded at 4 tasks/node, i should 
probably back off to at least 3 (or the Hadoop default of 2).

-- Owen


From MAILER-DAEMON Fri Apr 21 15:30:01 2006
Return-Path: 
 <hadoop-dev-return-927-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72690 invoked from network); 21 Apr 2006 15:30:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 15:30:01 -0000
Received: (qmail 15339 invoked by uid 500); 21 Apr 2006 15:29:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15293 invoked by uid 500); 21 Apr 2006 15:29:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15262 invoked by uid 99); 21 Apr 2006 15:29:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 08:29:57 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 08:29:57 -0700
Received: from explainfloorlx (snvvpn2-10-72-76-c184.corp.yahoo.com
 [10.72.76.184])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k3LFTKfB020114
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 08:29:21 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:x-mimeole:thread-index:in-reply-to;
	b=avOeedKXwSl0Gg58Had+1cJfsjEz7FAsZf9sNMwhdqSoM9pYIitbB5WxuGL7kzIj
From: "Runping Qi" <runping@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: map/reduce writing benchmark
Date: Fri, 21 Apr 2006 08:29:17 -0700
Message-ID: <001801c66558$5b0af510$b84c480a@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZlVapGGV1qxOrLTTGnX16LG/aY2wAAjesQ
In-Reply-To: <2a581d5b89b5259b61a863b48b053673@yahoo-inc.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


Interesting.

If we use host/port as the task tracker id, that effectively ensures the
uniqueness, thus the "ghost" trackers will disappear.

Runping


-----Original Message-----
From: Owen O'Malley [mailto:owen@yahoo-inc.com] 
Sent: Friday, April 21, 2006 8:09 AM
To: hadoop-dev@lucene.apache.org
Subject: map/reduce writing benchmark

Ok, with my last change I've run the writer benchmark twice with no 
(fatal) problems. But the difference is interesting... On the same 189  
node cluster, the first time I had 30 some "ghost" task trackers. (eg. 
JobTracker started, taskTracker stopped and restarted so you get two 
tracker _node1100_<id> with different ids. One of which never delivers 
a heartbeat and does not request any tasks). The ghost trackers tricked 
the scheduler into thinking that the cluster wasn't very busy and so it 
never scheduled more than one task on any node. The results are:

run1 (1 task/node; 189 nodes; 1890 maps writing 1 gig of dfs data):
    time: 5405 seconds
    task failures: 0

run1 (4 task/node; 189 nodes; 1890 maps writing 1 gig of dfs data):
    time: 5785 seconds
    task failures: 173

That is still a lot of failures, but at least none of them cascaded 
into killing the entire job.

We need to time out TaskTrackers sooner (10 minutes? 30 minutes?)

We should probably use pending tasks rather than "current load" for 
determining when to give out new tasks.

2 cpu intel boxes are getting overloaded at 4 tasks/node, i should 
probably back off to at least 3 (or the Hadoop default of 2).

-- Owen



From MAILER-DAEMON Fri Apr 21 16:06:10 2006
Return-Path: 
 <hadoop-dev-return-928-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89716 invoked from network); 21 Apr 2006 16:06:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 16:06:10 -0000
Received: (qmail 13918 invoked by uid 500); 21 Apr 2006 16:06:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13895 invoked by uid 500); 21 Apr 2006 16:06:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13880 invoked by uid 99); 21 Apr 2006 16:06:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 09:06:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 09:06:09 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C525741000C
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 16:05:05 +0000 (GMT)
Message-ID: <1807560.1145635505804.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 16:05:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-157) job fails because pendingCreates is
 not cleaned up after a task fails
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

job fails because pendingCreates is not cleaned up after a task fails
---------------------------------------------------------------------

         Key: HADOOP-157
         URL: http://issues.apache.org/jira/browse/HADOOP-157
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


When a task fails under map/reduce, if the client doesn't abandon the files in progress (usually because it was killed), the lease on the name node lasts 1 minute. During that minute, I see 3 backup copies of the task fail because pendingCreates is non-null.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 16:21:11 2006
Return-Path: 
 <hadoop-dev-return-929-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99303 invoked from network); 21 Apr 2006 16:21:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 16:21:11 -0000
Received: (qmail 44436 invoked by uid 500); 21 Apr 2006 16:21:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44410 invoked by uid 500); 21 Apr 2006 16:21:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44401 invoked by uid 99); 21 Apr 2006 16:21:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 09:21:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 09:21:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7AEDF7142D9
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 16:20:06 +0000 (GMT)
Message-ID: <27014286.1145636406485.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 16:20:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-157) job fails because pendingCreates is
 not cleaned up after a task fails
In-Reply-To: <1807560.1145635505804.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-157?page=all ]

Owen O'Malley updated HADOOP-157:
---------------------------------

    Attachment: pending-creates-wait.patch

This patch improves the failures reporting.

1. I created org.apache.hadoop.ipc.RemoteException class that includes the class name of the exception that was the cause.
2. The ipc client throws this RemoteException rather than java.rmi.RemoteException.
3. The DFSClient.create waits and retries if the file is already being created.
4. Killed tasks do not complain when they have non-zero exit codes from their process.
5. Improved the error message when tasks are killed for not updating their progress.
6. Dfs' ClientProtocol.addBlock now takes the client name rather than the client machine.
7. Problems renewing dfs leases are now logged.
8. More details in the exception messages when DfsClient.create fails.
9. addBlock now checks to make sure it is the same client that owns the lease who is adding to the file.
10. FileUnderConstruction now records who is creating the file.
11. Some new exception classes defined for problems that DFSClient wants to catch

> job fails because pendingCreates is not cleaned up after a task fails
> ---------------------------------------------------------------------
>
>          Key: HADOOP-157
>          URL: http://issues.apache.org/jira/browse/HADOOP-157
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: pending-creates-wait.patch
>
> When a task fails under map/reduce, if the client doesn't abandon the files in progress (usually because it was killed), the lease on the name node lasts 1 minute. During that minute, I see 3 backup copies of the task fail because pendingCreates is non-null.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 16:57:11 2006
Return-Path: 
 <hadoop-dev-return-930-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17818 invoked from network); 21 Apr 2006 16:57:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 16:57:11 -0000
Received: (qmail 1583 invoked by uid 500); 21 Apr 2006 16:57:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1560 invoked by uid 500); 21 Apr 2006 16:57:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1545 invoked by uid 99); 21 Apr 2006 16:57:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 09:57:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 09:57:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 07C82714294
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 16:56:06 +0000 (GMT)
Message-ID: <14456526.1145638566001.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 16:56:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-53) MapReduce log files should be storable
 in dfs.
In-Reply-To: <13654009.1140640359390.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-53?page=all ]

Doug Cutting updated HADOOP-53:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> MapReduce log files should be storable in dfs.
> ----------------------------------------------
>
>          Key: HADOOP-53
>          URL: http://issues.apache.org/jira/browse/HADOOP-53
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Sameer Paranjpye
>      Fix For: 0.3

>
> It should be possible to cause a job's log output to be stored in dfs.  The jobtracker's log output and (optionally) all tasktracker log output related to a job should be storable in a job-specified dfs directory.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:09:24 2006
Return-Path: 
 <hadoop-dev-return-931-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23350 invoked from network); 21 Apr 2006 17:09:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:09:24 -0000
Received: (qmail 26496 invoked by uid 500); 21 Apr 2006 17:09:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26444 invoked by uid 500); 21 Apr 2006 17:09:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26409 invoked by uid 99); 21 Apr 2006 17:09:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:09:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:09:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D5505714294
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:08:05 +0000 (GMT)
Message-ID: <886043.1145639285840.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:08:05 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-158) dfs block ids sometimes collide
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

dfs block ids sometimes collide
-------------------------------

         Key: HADOOP-158
         URL: http://issues.apache.org/jira/browse/HADOOP-158
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Reporter: Doug Cutting
     Fix For: 0.2


A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.

A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:15:18 2006
Return-Path: 
 <hadoop-dev-return-932-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26704 invoked from network); 21 Apr 2006 17:15:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:15:18 -0000
Received: (qmail 36846 invoked by uid 500); 21 Apr 2006 17:15:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36727 invoked by uid 500); 21 Apr 2006 17:15:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36709 invoked by uid 99); 21 Apr 2006 17:15:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1212F7142DA
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:13 +0000 (GMT)
Message-ID: <12618565.1145639653071.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:13 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-47) include records/second and bytes/second
 in  task reports
In-Reply-To: <579254540.1140560374384.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-47?page=all ]

Doug Cutting updated HADOOP-47:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> include records/second and bytes/second in  task reports
> --------------------------------------------------------
>
>          Key: HADOOP-47
>          URL: http://issues.apache.org/jira/browse/HADOOP-47
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> TaskReport should include fields for total records processed, total bytes processed and total seconds of task execution.  These should also be reported in the web ui, as bytes/second and records/second.  The job display could sum these to report total bytes/second and records/second for map and reduce.  Better yet would be a graph displaying the total rates over the course of the job...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:15:20 2006
Return-Path: 
 <hadoop-dev-return-933-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26728 invoked from network); 21 Apr 2006 17:15:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:15:20 -0000
Received: (qmail 37022 invoked by uid 500); 21 Apr 2006 17:15:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36911 invoked by uid 500); 21 Apr 2006 17:15:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36902 invoked by uid 99); 21 Apr 2006 17:15:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D538A7142E2
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:14 +0000 (GMT)
Message-ID: <2679643.1145639654870.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:14 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-75) dfs should check full file availability
 only at close
In-Reply-To: <873621841.1142030138809.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-75?page=all ]

Doug Cutting updated HADOOP-75:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> dfs should check full file availability only at close
> -----------------------------------------------------
>
>          Key: HADOOP-75
>          URL: http://issues.apache.org/jira/browse/HADOOP-75
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.3

>
> Currently it appears that dfs checks that the namenode knows about all blocks in a file as each block is written.  It would be more efficient to only check that all blocks are stored somewhere when the file is closed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:15:21 2006
Return-Path: 
 <hadoop-dev-return-934-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26745 invoked from network); 21 Apr 2006 17:15:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:15:21 -0000
Received: (qmail 37067 invoked by uid 500); 21 Apr 2006 17:15:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37040 invoked by uid 500); 21 Apr 2006 17:15:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37031 invoked by uid 99); 21 Apr 2006 17:15:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:19 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1F9F07142E3
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:16 +0000 (GMT)
Message-ID: <1565254.1145639656127.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:16 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-59) support generic command-line options
In-Reply-To: <321463887.1140733957324.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-59?page=all ]

Doug Cutting updated HADOOP-59:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> support generic command-line options
> ------------------------------------
>
>          Key: HADOOP-59
>          URL: http://issues.apache.org/jira/browse/HADOOP-59
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Michel Tourn
>      Fix For: 0.3
>  Attachments: Tool.java, ToolBase.java, bashfile.patch, toolbase.patch
>
> Hadoop commands should all support some common options.  For example, it should be possible to specify the namenode, datanode, and, for that matter, any config option, in a generic way.
> This could be implemented with code like:
> public interface Tool extends Configurable {
>   void run(String[] args) throws Exception;
> }
> public class ToolBase implements Tool extends Configured {
>   public final void main(String[] args) throws Exception {
>     Configuration conf = new Configuration();
>     ... parse config options from args into conf ...
>     this.configure(conf);
>     this.run();
>   }
> }
> public MyTool extends ExcecutableBase {
>   public static void main(String[] args) throws Exception {
>     new MyTool().main(args);
>   }
> }
> The general command line syntax could be:
> bin/hadoop [generalOptions] command [commandOptions]
> Where generalOptions are things that ToolBase handles, and only the commandOptions are passed to Tool.run().  The most important generalOption would be '-D', which would define name/value pairs that are set in the configuration.  This alone would permit folks to set the namenode, datanode, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:15:23 2006
Return-Path: 
 <hadoop-dev-return-935-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26784 invoked from network); 21 Apr 2006 17:15:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:15:23 -0000
Received: (qmail 37204 invoked by uid 500); 21 Apr 2006 17:15:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37174 invoked by uid 500); 21 Apr 2006 17:15:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37165 invoked by uid 99); 21 Apr 2006 17:15:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:21 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 52C557142E0
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:17 +0000 (GMT)
Message-ID: <3544655.1145639657336.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-76) reduce output should first be written
 to a temporary file name, then moved into place
In-Reply-To: <1176204687.1142031469402.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-76?page=all ]

Doug Cutting updated HADOOP-76:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> reduce output should first be written to a temporary file name, then moved into place
> -------------------------------------------------------------------------------------
>
>          Key: HADOOP-76
>          URL: http://issues.apache.org/jira/browse/HADOOP-76
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.3

>
> This would permit speculative execution of reduce tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:15:36 2006
Return-Path: 
 <hadoop-dev-return-936-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26837 invoked from network); 21 Apr 2006 17:15:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:15:36 -0000
Received: (qmail 37330 invoked by uid 500); 21 Apr 2006 17:15:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37308 invoked by uid 500); 21 Apr 2006 17:15:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37293 invoked by uid 99); 21 Apr 2006 17:15:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:22 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 87CD67142E1
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:18 +0000 (GMT)
Message-ID: <25157713.1145639658553.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-88) Configuration: separate client config
 from server config (and from other-server config)
In-Reply-To: <1512399529.1142558161467.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-88?page=all ]

Doug Cutting updated HADOOP-88:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> Configuration: separate client config from server config (and from other-server config)
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-88
>          URL: http://issues.apache.org/jira/browse/HADOOP-88
>      Project: Hadoop
>         Type: Wish

>   Components: conf
>     Reporter: Michel Tourn
>     Priority: Minor
>      Fix For: 0.3

>
> servers = JobTracker, NameNode, TaskTracker, DataNode
> clients =  runs JobClient (to submit MapReduce jobs), or runs DFSShell (to browse )
> Server machines are administered together.
> So it is OK to have all server config together (esp file paths and network ports).
> This is stored in hadoop-default.xml or hadoop-mycluster.xml
> Client machines:
> there may be as many client machines as there are MapRed developers.
> the temp space for DFS needs to be writable by the active user.
> So it should be possible to select the client temp space directory for the machine and for the user.
> (The global /tmp is not an option as discussed elsewhere: partition may be full)
> Current situation: 
> Both the server and the clients have a copy of the server config: hadoop-default.xml
> But the XML property  "dfs.data.dir" is being used as a LOCAL directory path 
> on both the server machines (Data nodes) and the client machines.
> Effect:
> Exception in thread "main" java.io.IOException: No valid local directories in property: dfs.data.dir
>  at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:286)
>  at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.newBackupFile(DFSClient.java:560)
>  ...
>  at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:267)
> Current Workaround:
> On the client use hadoop-site.xml to override dfs.data.dir
> One proposed solution:
> For the purpose of JobClient operations, use a different property in place of dfs.data.dir.
> (Ex: dfs.client.data.dir) 
> On the client, set this property in hadoop-site.xml so that it will override hadoop-default.xml 
> Another proposed solution:
> Handle the fact that the world is made of a federation of independant Hadoop systems.
> They can talk to each other (as peers) but they are administered separately.
> Each Hadoop system should have its own separate XML config file.
> Clients should be able to specify the Hadoop system they want to talk to.
> An advantage is that clients can then easily sync their local copy of a given Hadoop system config:
>  just pull its config file
> In this view of the world, a Job client is also a kind of independant (serverless) Hadoop system
> In this case the client config file may have its own dfs.data.dir, which is 
> separate from the dfs.data.dir in the server config file.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:16:05 2006
Return-Path: 
 <hadoop-dev-return-938-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26994 invoked from network); 21 Apr 2006 17:16:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:16:05 -0000
Received: (qmail 38109 invoked by uid 500); 21 Apr 2006 17:15:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37883 invoked by uid 500); 21 Apr 2006 17:15:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37863 invoked by uid 99); 21 Apr 2006 17:15:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:37 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ED2A67142E4
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:18 +0000 (GMT)
Message-ID: <25872381.1145639658959.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-50) dfs datanode should store blocks in
 multiple directories
In-Reply-To: <133992549.1140560804844.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-50?page=all ]

Doug Cutting updated HADOOP-50:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> dfs datanode should store blocks in multiple directories
> --------------------------------------------------------
>
>          Key: HADOOP-50
>          URL: http://issues.apache.org/jira/browse/HADOOP-50
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Mike Cafarella
>      Fix For: 0.3

>
> The datanode currently stores all file blocks in a single directory.  With 32MB blocks and terabyte filesystems, this will create too many files in a single directory for many filesystems.  Thus blocks should be stored in multiple directories, perhaps even a shallow hierarchy.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:15:57 2006
Return-Path: 
 <hadoop-dev-return-937-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26974 invoked from network); 21 Apr 2006 17:15:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:15:57 -0000
Received: (qmail 37993 invoked by uid 500); 21 Apr 2006 17:15:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37873 invoked by uid 500); 21 Apr 2006 17:15:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37864 invoked by uid 99); 21 Apr 2006 17:15:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:37 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A53CD7142E8
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:20 +0000 (GMT)
Message-ID: <11033183.1145639660673.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:20 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-48) add user data to task reports
In-Reply-To: <642884722.1140560655919.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-48?page=all ]

Doug Cutting updated HADOOP-48:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> add user data to task reports
> -----------------------------
>
>          Key: HADOOP-48
>          URL: http://issues.apache.org/jira/browse/HADOOP-48
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>      Fix For: 0.3

>
> The Reporter interface should permit tasks to set user-data for a task, either as a String or, better-yet, as a Writable.  This should be returned with each TaskReport.  This would facilitate programmatic instrumentation of tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:15:56 2006
Return-Path: 
 <hadoop-dev-return-939-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26968 invoked from network); 21 Apr 2006 17:15:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:15:56 -0000
Received: (qmail 38160 invoked by uid 500); 21 Apr 2006 17:15:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38129 invoked by uid 500); 21 Apr 2006 17:15:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38119 invoked by uid 99); 21 Apr 2006 17:15:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:38 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 22D257142E5
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:22 +0000 (GMT)
Message-ID: <9308033.1145639662140.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:22 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-64) DataNode should be capable of managing
 multiple volumes
In-Reply-To: <96561968.1141686362086.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-64?page=all ]

Doug Cutting updated HADOOP-64:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> DataNode should be capable of managing multiple volumes
> -------------------------------------------------------
>
>          Key: HADOOP-64
>          URL: http://issues.apache.org/jira/browse/HADOOP-64
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.3

>
> The dfs Datanode can only store data on a single filesystem volume. When a node runs its disks JBOD this means running a Datanode per disk on the machine. While the scheme works reasonably well on small clusters, on larger installations (several 100 nodes) it implies a very large number of Datanodes with associated management overhead in the Namenode.
> The Datanod should be enhanced to be able to handle multiple volumes on a single machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:15:59 2006
Return-Path: 
 <hadoop-dev-return-940-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26978 invoked from network); 21 Apr 2006 17:16:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:15:59 -0000
Received: (qmail 38222 invoked by uid 500); 21 Apr 2006 17:15:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38139 invoked by uid 500); 21 Apr 2006 17:15:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38120 invoked by uid 99); 21 Apr 2006 17:15:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:15:38 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 53E147142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:14:23 +0000 (GMT)
Message-ID: <29184133.1145639663340.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:14:23 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-54) SequenceFile should compress blocks,
 not individual entries
In-Reply-To: <442955632.1140640880483.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-54?page=all ]

Doug Cutting updated HADOOP-54:
-------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> SequenceFile should compress blocks, not individual entries
> -----------------------------------------------------------
>
>          Key: HADOOP-54
>          URL: http://issues.apache.org/jira/browse/HADOOP-54
>      Project: Hadoop
>         Type: Improvement

>   Components: io
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Michel Tourn
>      Fix For: 0.3

>
> SequenceFile will optionally compress individual values.  But both compression and performance would be much better if sequences of keys and values are compressed together.  Sync marks should only be placed between blocks.  This will require some changes to MapFile too, so that all file positions stored there are the positions of blocks, not entries within blocks.  Probably this can be accomplished by adding a getBlockStartPosition() method to SequenceFile.Writer.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:26:11 2006
Return-Path: 
 <hadoop-dev-return-941-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33761 invoked from network); 21 Apr 2006 17:26:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:26:11 -0000
Received: (qmail 56365 invoked by uid 500); 21 Apr 2006 17:26:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56347 invoked by uid 500); 21 Apr 2006 17:26:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56334 invoked by uid 99); 21 Apr 2006 17:26:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:26:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:26:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6FE927142DD
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:25:06 +0000 (GMT)
Message-ID: <15894914.1145640306449.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:25:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-68) "Cannot abandon block during write to
 <file>" and "Cannot obtain additional block for file <file>" errors during
 dfs write test
In-Reply-To: <1706495279.1141776699080.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-68?page=all ]
     
Doug Cutting resolved HADOOP-68:
--------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Owen O'Malley

This has been fixed when fixing other bugs.

> "Cannot abandon block during write to <file>" and "Cannot obtain additional block for file <file>" errors during dfs write test
> -------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-68
>          URL: http://issues.apache.org/jira/browse/HADOOP-68
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>  Environment: linux 2.6, redhat, 180 machines
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2

>
> In the namenode's log file, when trying to run my writer benchmark, I get a bunch of messages like:
> 060307 112402 Server handler 2 on 9020 call error: java.io.IOException: Cannot a
> bandon block during write to /user/oom/random/.part001389.crc
> java.io.IOException: Cannot abandon block during write to /user/oom/random/.part
> 001389.crc
>         at org.apache.hadoop.dfs.NameNode.abandonBlock(NameNode.java:188)
>         at sun.reflect.GeneratedMethodAccessor14.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
> sorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$1.call(RPC.java:208)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:200)
> and 
> 060307 112402 Server handler 1 on 9020 call error: java.io.IOException: Cannot a
> bandon block during write to /user/oom/random/part001695
> java.io.IOException: Cannot abandon block during write to /user/oom/random/part0
> 01695
>         at org.apache.hadoop.dfs.NameNode.abandonBlock(NameNode.java:188)
>         at sun.reflect.GeneratedMethodAccessor14.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
> sorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$1.call(RPC.java:208)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:200)
> and
> 060307 112402 Server handler 2 on 9020 call error: java.io.IOException: Cannot obtain additional block for file /user/oom/random/part001274
> java.io.IOException: Cannot obtain additional block for file /user/oom/random/pa
> rt001274
>         at org.apache.hadoop.dfs.NameNode.addBlock(NameNode.java:160)
>         at sun.reflect.GeneratedMethodAccessor13.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
> sorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$1.call(RPC.java:208)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:200)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:26:12 2006
Return-Path: 
 <hadoop-dev-return-942-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33785 invoked from network); 21 Apr 2006 17:26:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:26:12 -0000
Received: (qmail 56507 invoked by uid 500); 21 Apr 2006 17:26:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56478 invoked by uid 500); 21 Apr 2006 17:26:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56468 invoked by uid 99); 21 Apr 2006 17:26:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:26:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:26:11 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A5CA67142E0
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:25:07 +0000 (GMT)
Message-ID: <10708288.1145640307676.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:25:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-96?page=all ]

Doug Cutting updated HADOOP-96:
-------------------------------

    Fix Version: 0.2

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2

>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:28:11 2006
Return-Path: 
 <hadoop-dev-return-943-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34538 invoked from network); 21 Apr 2006 17:28:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:28:11 -0000
Received: (qmail 59387 invoked by uid 500); 21 Apr 2006 17:28:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59369 invoked by uid 500); 21 Apr 2006 17:28:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59360 invoked by uid 99); 21 Apr 2006 17:28:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:28:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:28:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CA6157142E2
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:27:06 +0000 (GMT)
Message-ID: <20088748.1145640426825.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:27:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-124) don't permit two datanodes to run from
 same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]

Doug Cutting updated HADOOP-124:
--------------------------------

    Fix Version: 0.3
      Assign To: Konstantin Shvachko

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:30:11 2006
Return-Path: 
 <hadoop-dev-return-944-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35318 invoked from network); 21 Apr 2006 17:30:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:30:11 -0000
Received: (qmail 62265 invoked by uid 500); 21 Apr 2006 17:30:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62154 invoked by uid 500); 21 Apr 2006 17:30:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62145 invoked by uid 99); 21 Apr 2006 17:30:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:30:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:30:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6C4117142E2
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:29:06 +0000 (GMT)
Message-ID: <13160562.1145640546440.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:29:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-72) hadoop doesn't take advatage of
 distributed compiting in TestDFSIO
In-Reply-To: <1258597127.1141936843493.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-72?page=all ]
     
Doug Cutting resolved HADOOP-72:
--------------------------------

    Fix Version: 0.2
     Resolution: Won't Fix

This was caused by a misunderstanding.

> hadoop doesn't take advatage of distributed compiting in TestDFSIO
> ------------------------------------------------------------------
>
>          Key: HADOOP-72
>          URL: http://issues.apache.org/jira/browse/HADOOP-72
>      Project: Hadoop
>         Type: Test

>   Components: dfs, fs, mapred
>  Environment: 200 node cluster
>     Reporter: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: TestDFSIO.java, TestDFSIO_results.log, TestDFSIO_results_200_node_cluster.log, TestDFSIO_results_sequential.log
>
> TestDFSIO runs N map jobs, each either writing to or reading from a separate file of the same size, 
> and collects statistical information on its performance. 
> The reducer further calculates the overall statistics for all maps. 
> It outputs the following data:
> - read or write test
> - date and time the test finished   
> - number of files
> - total number of bytes processed
> - overall throughput in mb/sec
> - average IO rate in mb/sec per file
> __Results__
> I run 7 iterations of the test one after another on a cluster of ~200 nodes. 
> The file size is the same in all cases 320Mb. 
> The number of files tried is 1,2,4,8,16,32,64.
> The log file with statistics is attached.
> It looks like we don't have any distributed computing here at all.
> The total execution time increases proportionally to the total size of data both for writes and reads.
> Another thing is that the io ratio for read is higher than the write rate just gradually.
> For comparison I attach time measuring for the same ios performed on the same cluster but sequentially in a simple loop.
> This is the summary:
> Files	map/red time	sequential time
>  1		49			  34 
>  2		86			  69
>  4		158			131
>  8		299			266
> 16		569			532
> 32		1131
> 64		2218
> This doesn't look good, unless there is something wrong with my test (attached) or the cluster settings.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 17:30:12 2006
Return-Path: 
 <hadoop-dev-return-945-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35347 invoked from network); 21 Apr 2006 17:30:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 17:30:12 -0000
Received: (qmail 62311 invoked by uid 500); 21 Apr 2006 17:30:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62282 invoked by uid 500); 21 Apr 2006 17:30:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62273 invoked by uid 99); 21 Apr 2006 17:30:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:30:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 10:30:11 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8F14E7142E0
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 17:29:07 +0000 (GMT)
Message-ID: <18637466.1145640547582.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 17:29:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-85) a single client stuck in a loop blocks
 all clients on same machine
In-Reply-To: <1854913738.1142459099064.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-85?page=all ]

Doug Cutting updated HADOOP-85:
-------------------------------

    Fix Version: 0.2
      Assign To: Sameer Paranjpye

> a single client stuck in a loop blocks all clients on same machine
> ------------------------------------------------------------------
>
>          Key: HADOOP-85
>          URL: http://issues.apache.org/jira/browse/HADOOP-85
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>      Fix For: 0.2

>
> I was running a set of clients, running cp from one dfs to another dfs using fuse, one file per cp process.
> One client got stuck in a loop because of a bad block in one of the files (separate bug filed).
> The other clients, running in parallel in the background, all stopped making progress on their respective files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 19:26:11 2006
Return-Path: 
 <hadoop-dev-return-946-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9652 invoked from network); 21 Apr 2006 19:26:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 19:26:11 -0000
Received: (qmail 85002 invoked by uid 500); 21 Apr 2006 19:26:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84966 invoked by uid 500); 21 Apr 2006 19:26:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84954 invoked by uid 99); 21 Apr 2006 19:26:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 12:26:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 12:26:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6D8C17142E1
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 19:25:06 +0000 (GMT)
Message-ID: <32283448.1145647506439.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 19:25:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-150) tip and task names should reflect the
 job name
In-Reply-To: <2834666.1145471734551.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-150?page=all ]

Owen O'Malley updated HADOOP-150:
---------------------------------

    Attachment: task_id.patch

Here is a patch that changes the names to match the given pattern.

> tip and task names should reflect the job name
> ----------------------------------------------
>
>          Key: HADOOP-150
>          URL: http://issues.apache.org/jira/browse/HADOOP-150
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: task_id.patch
>
> The tip and task names should be related to the job id. I'd propose:
> job name: job_<random 32bit/base36>
> tip: tip_<job id>_[mr]_<fragment #>
> task: task_<tip id>_<attempt #>
> so examples would be:
> job_abc123
> tip_abc123_m_00034
> task_abc123_m_00034_1
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 20:44:12 2006
Return-Path: 
 <hadoop-dev-return-947-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48604 invoked from network); 21 Apr 2006 20:44:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 20:44:12 -0000
Received: (qmail 88169 invoked by uid 500); 21 Apr 2006 20:44:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88056 invoked by uid 500); 21 Apr 2006 20:44:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88041 invoked by uid 99); 21 Apr 2006 20:44:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 13:44:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 13:44:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7058641000C
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 20:43:06 +0000 (GMT)
Message-ID: <24565330.1145652186451.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 20:43:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-150) tip and task names should reflect the
 job name
In-Reply-To: <2834666.1145471734551.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-150?page=all ]

Owen O'Malley updated HADOOP-150:
---------------------------------

    Attachment: task-id-2.patch

Ok, I forgot the "task_" in the prefix and I changed the job ids from random to sequential within a job tracker.

> tip and task names should reflect the job name
> ----------------------------------------------
>
>          Key: HADOOP-150
>          URL: http://issues.apache.org/jira/browse/HADOOP-150
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: task-id-2.patch, task_id.patch
>
> The tip and task names should be related to the job id. I'd propose:
> job name: job_<random 32bit/base36>
> tip: tip_<job id>_[mr]_<fragment #>
> task: task_<tip id>_<attempt #>
> so examples would be:
> job_abc123
> tip_abc123_m_00034
> task_abc123_m_00034_1
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 21:19:11 2006
Return-Path: 
 <hadoop-dev-return-948-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58455 invoked from network); 21 Apr 2006 21:19:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 21:19:11 -0000
Received: (qmail 34030 invoked by uid 500); 21 Apr 2006 21:19:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34009 invoked by uid 500); 21 Apr 2006 21:19:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34000 invoked by uid 99); 21 Apr 2006 21:19:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 14:19:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 14:19:10 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 61DC541000C
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 21:18:06 +0000 (GMT)
Message-ID: <2752771.1145654286391.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 21:18:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-150) tip and task names should reflect the
 job name
In-Reply-To: <2834666.1145471734551.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-150?page=all ]

Owen O'Malley updated HADOOP-150:
---------------------------------

    Attachment:     (was: task-id-2.patch)

> tip and task names should reflect the job name
> ----------------------------------------------
>
>          Key: HADOOP-150
>          URL: http://issues.apache.org/jira/browse/HADOOP-150
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: task-id-3.patch, task_id.patch
>
> The tip and task names should be related to the job id. I'd propose:
> job name: job_<random 32bit/base36>
> tip: tip_<job id>_[mr]_<fragment #>
> task: task_<tip id>_<attempt #>
> so examples would be:
> job_abc123
> tip_abc123_m_00034
> task_abc123_m_00034_1
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 21:19:14 2006
Return-Path: 
 <hadoop-dev-return-949-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58485 invoked from network); 21 Apr 2006 21:19:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 21:19:14 -0000
Received: (qmail 34174 invoked by uid 500); 21 Apr 2006 21:19:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34153 invoked by uid 500); 21 Apr 2006 21:19:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34144 invoked by uid 99); 21 Apr 2006 21:19:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 14:19:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 14:19:11 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6FFE941000E
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 21:18:07 +0000 (GMT)
Message-ID: <22378988.1145654287451.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 21:18:07 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-150) tip and task names should reflect the
 job name
In-Reply-To: <2834666.1145471734551.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-150?page=all ]

Owen O'Malley updated HADOOP-150:
---------------------------------

    Attachment: task-id-3.patch

A minor correction...

> tip and task names should reflect the job name
> ----------------------------------------------
>
>          Key: HADOOP-150
>          URL: http://issues.apache.org/jira/browse/HADOOP-150
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: task-id-3.patch, task_id.patch
>
> The tip and task names should be related to the job id. I'd propose:
> job name: job_<random 32bit/base36>
> tip: tip_<job id>_[mr]_<fragment #>
> task: task_<tip id>_<attempt #>
> so examples would be:
> job_abc123
> tip_abc123_m_00034
> task_abc123_m_00034_1
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 22:59:11 2006
Return-Path: 
 <hadoop-dev-return-950-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1729 invoked from network); 21 Apr 2006 22:59:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 22:59:11 -0000
Received: (qmail 44595 invoked by uid 500); 21 Apr 2006 22:59:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44567 invoked by uid 500); 21 Apr 2006 22:59:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44551 invoked by uid 99); 21 Apr 2006 22:59:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 15:59:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 15:59:09 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BC70F7142E1
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 22:58:05 +0000 (GMT)
Message-ID: <929695.1145660285762.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 22:58:05 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-159) name node at 100% cpu, making
 redundant replications
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

name node at 100% cpu, making redundant replications
----------------------------------------------------

         Key: HADOOP-159
         URL: http://issues.apache.org/jira/browse/HADOOP-159
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.1.1    
    Reporter: Yoram Arnon
 Assigned to: Sameer Paranjpye 
    Priority: Blocker
     Fix For: 0.2


some hours after adding some new nodes to the cluster, the name node went into a state where it's consuming 100% cpu.
The log file keeps logging messages of the forms
060421 155049 Obsoleting block blk_8093115169359854355
060421 155049 Pending transfer (block blk_-6965677235456960523) from node1383:50010 to 2 destinations
060421 155049 Block report from node1283:50010: 2140 blocks.
060421 155049 Redundant addStoredBlock request received for block blk_-6836937139917042917 on node node1143:50010

many DFS operations time out, making useful work impossible.

restarting dfs solved the problem for a while, but it came back within an hour.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 21 23:40:13 2006
Return-Path: 
 <hadoop-dev-return-951-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13486 invoked from network); 21 Apr 2006 23:40:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Apr 2006 23:40:13 -0000
Received: (qmail 68830 invoked by uid 500); 21 Apr 2006 23:40:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68713 invoked by uid 500); 21 Apr 2006 23:40:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68704 invoked by uid 99); 21 Apr 2006 23:40:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 16:40:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Apr 2006 16:40:11 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 980327142E3
	for <hadoop-dev@lucene.apache.org>; Fri, 21 Apr 2006 23:39:07 +0000 (GMT)
Message-ID: <3925616.1145662747618.JavaMail.jira@brutus>
Date: Fri, 21 Apr 2006 23:39:07 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]

David Bowen updated HADOOP-132:
-------------------------------

    Attachment: metrics.patch


OK, here is the source code, in the form of a patch.

NOTE: this requires javac.version 1.5.  I.e. you currently have to say "ant -Djavac.version=1.5".  Is this acceptable in general for Hadoop development? 
The 1.5 (or 5.0 as they call it) for-loop syntax is very convenient.

A couple of changes since yesterday's javadoc: 

(1) there is now a NullContext which is used by default and does nothing; formerly the FileContext was used by default and it wrote to stdout if a file was not specified.

(2) there is now an Updater interface for the callbacks, instead of using Runnable.  This is so that the MetricsContext can be passed as an argument to the callback.



> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Versions: 0.2
>     Reporter: David Bowen
>      Fix For: 0.2
>  Attachments: javadoc.tgz, javadoc.tgz, metrics.patch
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 22 14:51:51 2006
Return-Path: 
 <hadoop-dev-return-952-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14220 invoked from network); 22 Apr 2006 14:51:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Apr 2006 14:51:51 -0000
Received: (qmail 10695 invoked by uid 500); 22 Apr 2006 14:51:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10678 invoked by uid 500); 22 Apr 2006 14:51:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10668 invoked by uid 99); 22 Apr 2006 14:51:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 07:51:50 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [137.78.160.108] (HELO nmta3.jpl.nasa.gov) (137.78.160.108)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 07:51:49 -0700
Received: from xmta1.jpl.nasa.gov (xmta1.jpl.nasa.gov [137.78.160.144])
	by nmta3.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3MEpS1n002931
	for <hadoop-dev@lucene.apache.org>; Sat, 22 Apr 2006 07:51:28 -0700
Received: from [192.168.1.101] (vpn-149-240-047.jpl.nasa.gov [128.149.240.47])
	by xmta1.jpl.nasa.gov (Switch-3.1.8/Switch-3.1.7) with ESMTP id
 k3MEpRdC032655
	for <hadoop-dev@lucene.apache.org>; Sat, 22 Apr 2006 07:51:28 -0700
User-Agent: Microsoft-Entourage/11.2.3.060209
Date: Sat, 22 Apr 2006 07:51:09 -0700
Subject: Hadoop vs. PVFS?
From: Chris Mattmann <chris.mattmann@jpl.nasa.gov>
To: "hadoop-dev@lucene.apache.org" <hadoop-dev@lucene.apache.org>
Message-ID: <C06F90ED.2C90%chris.mattmann@jpl.nasa.gov>
Thread-Topic: Hadoop vs. PVFS?
Thread-Index: AcZmHDDFbxelM9IPEdqnOQAUUSv9Jg==
Mime-version: 1.0
Content-type: text/plain;
	charset="US-ASCII"
Content-transfer-encoding: 7bit
X-Source-IP: vpn-149-240-047.jpl.nasa.gov [128.149.240.47]
X-Source-Sender: chris.mattmann@jpl.nasa.gov
X-AUTH: Internal IP
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Folks,

  Does anyone have any comparisons to Hadoop and PVFS? Even if they aren't
empirical, any advice on what the advantages/disadvantages of one versus the
other would be great. We're evaluating Hadoop right now at my job, and I
think it's really great, and easy to understand, however I'm not an OS guy,
so I don't know much about distributed file systems, other than the 30,000
ft. picture. I'm also getting a lot of push at my job to look at PVFS (since
they have many releases, are at version 2.0, etc.).

  Any ideas?

Thanks!

Cheers,
   Chris





From MAILER-DAEMON Sun Apr 23 00:03:13 2006
Return-Path: 
 <hadoop-dev-return-953-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48974 invoked from network); 23 Apr 2006 00:03:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Apr 2006 00:03:13 -0000
Received: (qmail 48177 invoked by uid 500); 23 Apr 2006 00:03:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48152 invoked by uid 500); 23 Apr 2006 00:03:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48139 invoked by uid 99); 23 Apr 2006 00:03:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 17:03:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 17:03:11 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CFDAF7142BE
	for <hadoop-dev@lucene.apache.org>; Sun, 23 Apr 2006 00:02:05 +0000 (GMT)
Message-ID: <11498027.1145750525845.JavaMail.jira@brutus>
Date: Sun, 23 Apr 2006 00:02:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-160) sleeping with locks held
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

sleeping with locks held
------------------------

         Key: HADOOP-160
         URL: http://issues.apache.org/jira/browse/HADOOP-160
     Project: Hadoop
        Type: Bug

    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


I ran findbugs and it reported 7 cases of sleeping with locks held. Part of what is killing jobs is unreasonably slow responses from the servers (and task tracker in particular), and this may be contributing to that.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Apr 23 00:05:14 2006
Return-Path: 
 <hadoop-dev-return-954-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49763 invoked from network); 23 Apr 2006 00:05:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Apr 2006 00:05:14 -0000
Received: (qmail 51340 invoked by uid 500); 23 Apr 2006 00:05:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51225 invoked by uid 500); 23 Apr 2006 00:05:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50698 invoked by uid 99); 23 Apr 2006 00:05:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 17:05:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 17:05:11 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CCE7B7142BE
	for <hadoop-dev@lucene.apache.org>; Sun, 23 Apr 2006 00:04:05 +0000 (GMT)
Message-ID: <2765023.1145750645831.JavaMail.jira@brutus>
Date: Sun, 23 Apr 2006 00:04:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-161) dfs blocks define equal, but not
 hashcode
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

dfs blocks define equal, but not hashcode
-----------------------------------------

         Key: HADOOP-161
         URL: http://issues.apache.org/jira/browse/HADOOP-161
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Sameer Paranjpye 


Findbugs reports that dfs.Block defines equals but not hashcode, which is problematic if it is ever put into a hash table.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Apr 23 00:49:48 2006
Return-Path: 
 <hadoop-dev-return-955-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62818 invoked from network); 23 Apr 2006 00:49:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Apr 2006 00:49:48 -0000
Received: (qmail 75211 invoked by uid 500); 23 Apr 2006 00:49:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75096 invoked by uid 500); 23 Apr 2006 00:49:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75080 invoked by uid 99); 23 Apr 2006 00:49:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 17:49:48 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 17:49:47 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3N0nJh1055935
	for <hadoop-dev@lucene.apache.org>; Sat, 22 Apr 2006 17:49:19 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=RUy2q/ntXwLchEKdpGdMWBgkcJ//RNe5ZV1RJT4WnAQbKWZWVvNUsttmzjoPqJ+D
Received: from [10.0.1.5] ([10.72.76.62]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Sat, 22 Apr 2006 17:49:19 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <C06F90ED.2C90%chris.mattmann@jpl.nasa.gov>
References: <C06F90ED.2C90%chris.mattmann@jpl.nasa.gov>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <1EFE2020-74F8-4495-8DA2-5BC40E3FDF28@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: Hadoop vs. PVFS?
Date: Sat, 22 Apr 2006 17:49:18 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 23 Apr 2006 00:49:19.0320 (UTC)
 FILETIME=[C111A580:01C6666F]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

PVFS is going to be a lot more stable, performant and mature.  Hadoop  
is pretty young and growing fast.

PVFS's design point is really more of a caching layer than a  
permanent file system.  It does not really have the mechanisms to  
deal with the kind of regular hardware failure we are aiming at  
handling with Hadoop.  So if you are using a large number of  
inexpensive machines, data durability will be a problem with PVFS.   
That said, today it is hard to argue that HDFS can provide any  
reliable data durability either.  In a few months I think it will  
have a serious advantage in this regard.  Right now we think of it  
more as a caching layer as well.

One thing to point out is that we use a lot of nodes (600+).  On  
small clusters, these concerns are minor.



On Apr 22, 2006, at 7:51 AM, Chris Mattmann wrote:

> Hi Folks,
>
>   Does anyone have any comparisons to Hadoop and PVFS? Even if they  
> aren't
> empirical, any advice on what the advantages/disadvantages of one  
> versus the
> other would be great. We're evaluating Hadoop right now at my job,  
> and I
> think it's really great, and easy to understand, however I'm not an  
> OS guy,
> so I don't know much about distributed file systems, other than the  
> 30,000
> ft. picture. I'm also getting a lot of push at my job to look at  
> PVFS (since
> they have many releases, are at version 2.0, etc.).
>
>   Any ideas?
>
> Thanks!
>
> Cheers,
>    Chris
>
>
>
>


From MAILER-DAEMON Sun Apr 23 05:19:16 2006
Return-Path: 
 <hadoop-dev-return-956-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28135 invoked from network); 23 Apr 2006 05:19:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Apr 2006 05:19:16 -0000
Received: (qmail 96843 invoked by uid 500); 23 Apr 2006 05:19:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96721 invoked by uid 500); 23 Apr 2006 05:19:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96702 invoked by uid 99); 23 Apr 2006 05:19:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 22:19:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Apr 2006 22:19:14 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 464347142BC
	for <hadoop-dev@lucene.apache.org>; Sun, 23 Apr 2006 05:18:08 +0000 (GMT)
Message-ID: <18160970.1145769488285.JavaMail.jira@brutus>
Date: Sun, 23 Apr 2006 05:18:08 +0000 (GMT+00:00)
From: "Mike Cafarella (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-50) dfs datanode should store blocks in
 multiple directories
In-Reply-To: <133992549.1140560804844.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-50?page=all ]

Mike Cafarella updated HADOOP-50:
---------------------------------

    Attachment: hadoop.50.patch.1


This fixes the multiple-directory storage problem.  It
lazily creates a single level of 512 subdirectories, into which
the blocks are allocated according to the lower 9 bits of the
block id.  If mankind ever needs more blocks than this, it is easy
to add an additional subdir layer and select on the lowest-but-9
bits of the blockid.

This change is backwards-compatible with the previous block
layout.  Old blocks in the single-layer dir will always be kept in
that format; we don't migrate them.  New blocks will always be added 
to the new hierarchy.

If both versions of the storage system are present, we always test
the new one first.  If that fails, we test the old one.  (The new test
should be faster, so we do it first.)

Please let me know if this patch works for you.

> dfs datanode should store blocks in multiple directories
> --------------------------------------------------------
>
>          Key: HADOOP-50
>          URL: http://issues.apache.org/jira/browse/HADOOP-50
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Mike Cafarella
>      Fix For: 0.3
>  Attachments: hadoop.50.patch.1
>
> The datanode currently stores all file blocks in a single directory.  With 32MB blocks and terabyte filesystems, this will create too many files in a single directory for many filesystems.  Thus blocks should be stored in multiple directories, perhaps even a shallow hierarchy.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 07:15:07 2006
Return-Path: 
 <hadoop-dev-return-957-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23217 invoked from network); 24 Apr 2006 07:15:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 07:15:07 -0000
Received: (qmail 71463 invoked by uid 500); 24 Apr 2006 07:15:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71413 invoked by uid 500); 24 Apr 2006 07:15:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71404 invoked by uid 99); 24 Apr 2006 07:15:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 00:15:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [193.203.240.6] (HELO psa2.houxou.com) (193.203.240.6)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 00:15:05 -0700
Received: (qmail 31245 invoked from network); 24 Apr 2006 08:14:40 +0100
Received: from adsl-193.203.244.247.access.houxou.com (HELO monufujitsu)
 (193.203.244.247)
  by psa2.houxou.com with SMTP; 24 Apr 2006 08:14:40 +0100
Message-ID: <007901c6676e$c1dbf880$561ea8c0@uk.houxou.com>
From: "Monu Ogbe" <monu.ogbe@richmondinformatics.com>
To: <hadoop-dev@lucene.apache.org>
References: <2a581d5b89b5259b61a863b48b053673@yahoo-inc.com>
Subject: Re: map/reduce writing benchmark
Date: Mon, 24 Apr 2006 08:14:42 +0100
Organization: Richmond Informatics
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="iso-8859-1";
	reply-type=response
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.2869
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Thank you, thank you, THANK YOU.

Jobs are completing fine!

Monu Ogbe

----- Original Message ----- 
From: "Owen O'Malley" <owen@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Sent: Friday, April 21, 2006 4:09 PM
Subject: map/reduce writing benchmark


> Ok, with my last change I've run the writer benchmark twice with no 
> (fatal) problems. But the difference is interesting... On the same 189  
> node cluster, the first time I had 30 some "ghost" task trackers. (eg. 
> JobTracker started, taskTracker stopped and restarted so you get two 
> tracker _node1100_<id> with different ids. One of which never delivers 
> a heartbeat and does not request any tasks). The ghost trackers tricked 
> the scheduler into thinking that the cluster wasn't very busy and so it 
> never scheduled more than one task on any node. The results are:
> 
> run1 (1 task/node; 189 nodes; 1890 maps writing 1 gig of dfs data):
>    time: 5405 seconds
>    task failures: 0
> 
> run1 (4 task/node; 189 nodes; 1890 maps writing 1 gig of dfs data):
>    time: 5785 seconds
>    task failures: 173
> 
> That is still a lot of failures, but at least none of them cascaded 
> into killing the entire job.
> 
> We need to time out TaskTrackers sooner (10 minutes? 30 minutes?)
> 
> We should probably use pending tasks rather than "current load" for 
> determining when to give out new tasks.
> 
> 2 cpu intel boxes are getting overloaded at 4 tasks/node, i should 
> probably back off to at least 3 (or the Hadoop default of 2).
> 
> -- Owen
> 
>

From MAILER-DAEMON Mon Apr 24 17:04:20 2006
Return-Path: 
 <hadoop-dev-return-958-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72128 invoked from network); 24 Apr 2006 17:04:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 17:04:20 -0000
Received: (qmail 58053 invoked by uid 500); 24 Apr 2006 17:04:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57937 invoked by uid 500); 24 Apr 2006 17:04:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57921 invoked by uid 99); 24 Apr 2006 17:04:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 10:04:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 10:04:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E644D7142C2
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 17:03:09 +0000 (GMT)
Message-ID: <27055452.1145898189939.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 17:03:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-157) job fails because pendingCreates is
 not cleaned up after a task fails
In-Reply-To: <1807560.1145635505804.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-157?page=all ]
     
Doug Cutting resolved HADOOP-157:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> job fails because pendingCreates is not cleaned up after a task fails
> ---------------------------------------------------------------------
>
>          Key: HADOOP-157
>          URL: http://issues.apache.org/jira/browse/HADOOP-157
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: pending-creates-wait.patch
>
> When a task fails under map/reduce, if the client doesn't abandon the files in progress (usually because it was killed), the lease on the name node lasts 1 minute. During that minute, I see 3 backup copies of the task fail because pendingCreates is non-null.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 18:03:34 2006
Return-Path: 
 <hadoop-dev-return-959-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7947 invoked from network); 24 Apr 2006 18:03:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 18:03:34 -0000
Received: (qmail 49851 invoked by uid 500); 24 Apr 2006 18:03:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49737 invoked by uid 500); 24 Apr 2006 18:03:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49728 invoked by uid 99); 24 Apr 2006 18:03:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 11:03:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 11:03:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 775167142C0
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 18:02:06 +0000 (GMT)
Message-ID: <9833522.1145901726486.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 18:02:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-150) tip and task names should reflect the
 job name
In-Reply-To: <2834666.1145471734551.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-150?page=all ]
     
Doug Cutting resolved HADOOP-150:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Owen!

> tip and task names should reflect the job name
> ----------------------------------------------
>
>          Key: HADOOP-150
>          URL: http://issues.apache.org/jira/browse/HADOOP-150
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: task-id-3.patch, task_id.patch
>
> The tip and task names should be related to the job id. I'd propose:
> job name: job_<random 32bit/base36>
> tip: tip_<job id>_[mr]_<fragment #>
> task: task_<tip id>_<attempt #>
> so examples would be:
> job_abc123
> tip_abc123_m_00034
> task_abc123_m_00034_1
>  

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 18:07:12 2006
Return-Path: 
 <hadoop-dev-return-960-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10027 invoked from network); 24 Apr 2006 18:07:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 18:07:12 -0000
Received: (qmail 54540 invoked by uid 500); 24 Apr 2006 18:06:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54479 invoked by uid 500); 24 Apr 2006 18:06:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54393 invoked by uid 99); 24 Apr 2006 18:06:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 11:06:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 11:06:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6B6DC7142C0
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 18:05:06 +0000 (GMT)
Message-ID: <19209683.1145901906437.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 18:05:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-132?page=comments#action_12376069 ] 

Doug Cutting commented on HADOOP-132:
-------------------------------------

We should still stick with JDK 1.4.  Most developers are now using JDK 1.5, but many folks still use JDK 1.4 in production.  So, if it's not too much pain, please back-port this to 1.4.  Thanks!

> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Versions: 0.2
>     Reporter: David Bowen
>      Fix For: 0.2
>  Attachments: javadoc.tgz, javadoc.tgz, metrics.patch
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 19:56:21 2006
Return-Path: 
 <hadoop-dev-return-961-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81757 invoked from network); 24 Apr 2006 19:56:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 19:56:21 -0000
Received: (qmail 86598 invoked by uid 500); 24 Apr 2006 19:56:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86396 invoked by uid 500); 24 Apr 2006 19:56:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86380 invoked by uid 99); 24 Apr 2006 19:56:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 12:56:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 12:56:14 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C921B714294
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 19:55:05 +0000 (GMT)
Message-ID: <8417678.1145908505815.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 19:55:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-162) concurrent modification exception in
 FSNamesystem.Lease.releaseLocks
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

concurrent modification exception in FSNamesystem.Lease.releaseLocks
--------------------------------------------------------------------

         Key: HADOOP-162
         URL: http://issues.apache.org/jira/browse/HADOOP-162
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


FSNameSystem.Lease.releaseLocks iterates through the creates set, calling InternalReleaseCreate on each element, which changes the creates set in the Lease. This causes a ConcurrentModificationException if you have more than two files that are owned by the lease that times out.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 20:00:20 2006
Return-Path: 
 <hadoop-dev-return-962-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83164 invoked from network); 24 Apr 2006 20:00:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 20:00:20 -0000
Received: (qmail 92567 invoked by uid 500); 24 Apr 2006 20:00:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92544 invoked by uid 500); 24 Apr 2006 20:00:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92533 invoked by uid 99); 24 Apr 2006 20:00:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 13:00:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 13:00:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 30ED6714295
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 19:59:08 +0000 (GMT)
Message-ID: <22392941.1145908748191.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 19:59:08 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-162) concurrent modification exception in
 FSNamesystem.Lease.releaseLocks
In-Reply-To: <8417678.1145908505815.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-162?page=all ]

Owen O'Malley updated HADOOP-162:
---------------------------------

    Attachment: concurrent-mod-lease.patch

This patch moves the lease finding/updating code out of internalReleaseCreate and into abandonFileInProgress. releaseLocks clears the set itself.

> concurrent modification exception in FSNamesystem.Lease.releaseLocks
> --------------------------------------------------------------------
>
>          Key: HADOOP-162
>          URL: http://issues.apache.org/jira/browse/HADOOP-162
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: concurrent-mod-lease.patch
>
> FSNameSystem.Lease.releaseLocks iterates through the creates set, calling InternalReleaseCreate on each element, which changes the creates set in the Lease. This causes a ConcurrentModificationException if you have more than two files that are owned by the lease that times out.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 21:53:36 2006
Return-Path: 
 <hadoop-dev-return-963-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46740 invoked from network); 24 Apr 2006 21:53:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 21:53:36 -0000
Received: (qmail 7893 invoked by uid 500); 24 Apr 2006 21:53:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7865 invoked by uid 500); 24 Apr 2006 21:53:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7856 invoked by uid 99); 24 Apr 2006 21:53:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 14:53:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 14:53:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A9EB37142B6
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 21:52:22 +0000 (GMT)
Message-ID: <12688000.1145915542692.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 21:52:22 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
-----------------------------------------------------------------------------------------------------------------

         Key: HADOOP-163
         URL: http://issues.apache.org/jira/browse/HADOOP-163
     Project: Hadoop
        Type: Bug

    Reporter: Runping Qi



I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 21:59:37 2006
Return-Path: 
 <hadoop-dev-return-964-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48882 invoked from network); 24 Apr 2006 21:59:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 21:59:37 -0000
Received: (qmail 12884 invoked by uid 500); 24 Apr 2006 21:59:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12860 invoked by uid 500); 24 Apr 2006 21:59:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12849 invoked by uid 99); 24 Apr 2006 21:59:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 14:59:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 14:59:35 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 312D67142B6
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 21:58:26 +0000 (GMT)
Message-ID: <32962903.1145915906197.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 21:58:26 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12376118 ] 

Doug Cutting commented on HADOOP-163:
-------------------------------------

Alternately, the datanode daemon should simply exit if it cannot write to its configured data directories.

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>     Reporter: Runping Qi

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 22:03:23 2006
Return-Path: 
 <hadoop-dev-return-965-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49981 invoked from network); 24 Apr 2006 22:03:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 22:03:23 -0000
Received: (qmail 19721 invoked by uid 500); 24 Apr 2006 22:03:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19581 invoked by uid 500); 24 Apr 2006 22:03:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19521 invoked by uid 99); 24 Apr 2006 22:03:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 15:03:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 15:03:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E5BAF7142C0
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 22:02:06 +0000 (GMT)
Message-ID: <19308330.1145916126931.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 22:02:06 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-164) Getting errors in reading the output
 files of a map/reduce job immediately after the job is complete
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Getting errors in reading the output files of a map/reduce job immediately =
after the job is complete
---------------------------------------------------------------------------=
-------------------------

         Key: HADOOP-164
         URL: http://issues.apache.org/jira/browse/HADOOP-164
     Project: Hadoop
        Type: Bug

    Reporter: Runping Qi



I have an app that fire up map/reduce jobs sequentially. The output of one =
job if the input of the next.
I observe that many map tasks failed due to file read errors:

java.rmi.RemoteException: java.io.IOException: Cannot open filename /user/r=
unping/runping/docs_store/stage_2/base_docs/part-00186 at org.apache.hadoop=
.dfs.NameNode.open(NameNode.java:130) at sun.reflect.GeneratedMethodAccesso=
r8.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invok=
e(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(=
Method.java:585) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237) at =
org.apache.hadoop.ipc.Server$Handler.run(Server.java:216) at org.apache.had=
oop.ipc.Client.call(Client.java:303) at org.apache.hadoop.ipc.RPC$Invoker.i=
nvoke(RPC.java:141) at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source) a=
t org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:31=
5) at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:302) a=
t org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:95) at org.apache.had=
oop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78) at org=
.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46) at =
org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:220) at org.=
apache.hadoop.fs.FileSystem.open(FileSystem.java:146) at org.apache.hadoop.=
io.SequenceFile$Reader.(SequenceFile.java:234) at org.apache.hadoop.io.Sequ=
enceFile$Reader.(SequenceFile.java:226) at org.apache.hadoop.mapred.Sequenc=
eFileRecordReader.(SequenceFileRecordReader.java:36) at org.apache.hadoop.m=
apred.SequenceFileInputFormat.getRecordReader(SequenceFileInputFormat.java:=
53) at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105) at org.apache=
.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709)=20

Those tasks succeeded in the second or third try.

After interting 10 seconds sleep between consecutive jobs, the problem disa=
ppear.

Here is my code to detect whether a job is completed:

      try {
        running =3D jc.submitJob(job);
        String jobId =3D running.getJobID();
        System.out.println("start job:\t" + jobId);
        while (!running.isComplete()) {
          try {
            Thread.sleep(1000);
          } catch (InterruptedException e) {}
          running =3D jc.getJob(jobId);
        }
        sucess =3D running.isSuccessful();
      } finally {
        if (!sucess && (running !=3D null)) {
          running.killJob();
        }
        jc.close();
      }



--=20
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 22:21:17 2006
Return-Path: 
 <hadoop-dev-return-966-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58676 invoked from network); 24 Apr 2006 22:21:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 22:21:17 -0000
Received: (qmail 44234 invoked by uid 500); 24 Apr 2006 22:21:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44215 invoked by uid 500); 24 Apr 2006 22:21:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44206 invoked by uid 99); 24 Apr 2006 22:21:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 15:21:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 15:21:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8A3F67142B8
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 22:20:06 +0000 (GMT)
Message-ID: <30731622.1145917206557.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 22:20:06 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12376120 ] 

Runping Qi commented on HADOOP-163:
-----------------------------------


Exiting is an option. However, the datanode may still be able to read, thus to serve the existing blocks.


> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>     Reporter: Runping Qi

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 22:48:18 2006
Return-Path: 
 <hadoop-dev-return-967-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74467 invoked from network); 24 Apr 2006 22:48:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 22:48:18 -0000
Received: (qmail 89551 invoked by uid 500); 24 Apr 2006 22:48:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89532 invoked by uid 500); 24 Apr 2006 22:48:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89523 invoked by uid 99); 24 Apr 2006 22:48:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 15:48:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 15:48:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 79D1C7142B6
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 22:47:08 +0000 (GMT)
Message-ID: <24879872.1145918826736.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 22:47:06 +0000 (GMT+00:00)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-154) fsck fails when there is no file in dfs
In-Reply-To: <10284142.1145563925675.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-154?page=all ]
     
Andrzej Bialecki  closed HADOOP-154:
------------------------------------

    Resolution: Fixed

Fixed. Thank you!

> fsck fails when there is no file in dfs
> ---------------------------------------
>
>          Key: HADOOP-154
>          URL: http://issues.apache.org/jira/browse/HADOOP-154
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Lei Chen
>     Priority: Trivial

>
> First type in command
>     
>      hadoop namenode -format
> Then 
>      hadoop fsck /
> Then is the following exception:
> Exception in thread "main" java.lang.ArithmeticException: / by zero
>         at org.apache.hadoop.dfs.DFSck$Result.toString(DFSck.java:563)
>         at java.lang.String.valueOf(String.java:2577)
>         at java.io.PrintStream.print(PrintStream.java:616)
>         at java.io.PrintStream.println(PrintStream.java:753)
>         at org.apache.hadoop.dfs.DFSck.main(DFSck.java:435)
> Possible Solution: Check whether totalBlocks equal to 0 in line 563 of DFSck.java

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 22:55:16 2006
Return-Path: 
 <hadoop-dev-return-968-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77693 invoked from network); 24 Apr 2006 22:55:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 22:55:16 -0000
Received: (qmail 2273 invoked by uid 500); 24 Apr 2006 22:55:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2156 invoked by uid 500); 24 Apr 2006 22:55:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2147 invoked by uid 99); 24 Apr 2006 22:55:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 15:55:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 15:55:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5F85E7142B6
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 22:54:06 +0000 (GMT)
Message-ID: <16339718.1145919246388.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 22:54:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12376124 ] 

Doug Cutting commented on HADOOP-163:
-------------------------------------

Good point.  So perhaps a read-only node should report itself at 100% of capacity?  Then the namenode should never allocate blocks to it.

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>     Reporter: Runping Qi

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:17 2006
Return-Path: 
 <hadoop-dev-return-969-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84074 invoked from network); 24 Apr 2006 23:11:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:17 -0000
Received: (qmail 31954 invoked by uid 500); 24 Apr 2006 23:11:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31936 invoked by uid 500); 24 Apr 2006 23:11:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31926 invoked by uid 99); 24 Apr 2006 23:11:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DEDDB71429E
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:06 +0000 (GMT)
Message-ID: <16947962.1145920206904.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-22) remove unused imports
In-Reply-To: <1779983253.1139254446079.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-22?page=all ]

Doug Cutting updated HADOOP-22:
-------------------------------

    Fix Version: 0.1.0

> remove unused imports
> ---------------------
>
>          Key: HADOOP-22
>          URL: http://issues.apache.org/jira/browse/HADOOP-22
>      Project: Hadoop
>         Type: Bug

>     Reporter: Sami Siren
>     Priority: Trivial
>      Fix For: 0.1.0
>  Attachments: hadoop-remove-imports.txt
>
> Following patch will remove unused imports from java source files

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:18 2006
Return-Path: 
 <hadoop-dev-return-970-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84101 invoked from network); 24 Apr 2006 23:11:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:18 -0000
Received: (qmail 32088 invoked by uid 500); 24 Apr 2006 23:11:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32068 invoked by uid 500); 24 Apr 2006 23:11:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32059 invoked by uid 99); 24 Apr 2006 23:11:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B6157410009
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:07 +0000 (GMT)
Message-ID: <32078684.1145920207742.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-12) InputFormat used in job must be in
 JobTracker classpath (not loaded from job JAR)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-12?page=all ]

Doug Cutting updated HADOOP-12:
-------------------------------

    Fix Version: 0.1.0

> InputFormat used in job must be in JobTracker classpath (not loaded from job JAR)
> ---------------------------------------------------------------------------------
>
>          Key: HADOOP-12
>          URL: http://issues.apache.org/jira/browse/HADOOP-12
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>  Environment: ~20 node nutch mapreduce environment, running SVN trunk, on Linux
>     Reporter: Bryan Pendleton
>     Priority: Minor
>      Fix For: 0.1.0

>
> During development, I've been creating/tweaking custom InputFormat implementations. However, when you try to run a job against a running cluster, you get:
>   Exception in thread "main" java.io.IOException: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.ClassNotFoundException: my.custom.InputFormat
>           at org.apache.nutch.ipc.Client.call(Client.java:294)
>           at org.apache.nutch.ipc.RPC$Invoker.invoke(RPC.java:127)
>           at $Proxy0.submitJob(Unknown Source)
>           at org.apache.nutch.mapred.JobClient.submitJob(JobClient.java:259)
>           at org.apache.nutch.mapred.JobClient.runJob(JobClient.java:288)
>           at com.parc.uir.wikipedia.WikipediaJob.main(WikipediaJob.java:85)
> This error goes away if I restart the TaskTrackers/JobTracker with a classpath which includes the needed code. Other classes (Mapper, Reducer) appear to be available out of the jar file specified in the JobConf, but not the InputFormat. Obviously, it's less than idea to have to restart the JobTracker whenever there's a change to a job-specific class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:19 2006
Return-Path: 
 <hadoop-dev-return-971-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84132 invoked from network); 24 Apr 2006 23:11:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:19 -0000
Received: (qmail 32246 invoked by uid 500); 24 Apr 2006 23:11:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32214 invoked by uid 500); 24 Apr 2006 23:11:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32205 invoked by uid 99); 24 Apr 2006 23:11:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D4A2F714295
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:08 +0000 (GMT)
Message-ID: <30543988.1145920208849.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:08 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-97) DFSShell.cat returns
 NullPointerException if file does not exist
In-Reply-To: <280002880.1142972879134.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-97?page=all ]

Doug Cutting updated HADOOP-97:
-------------------------------

    Fix Version: 0.1.0

> DFSShell.cat returns NullPointerException if file does not exist
> ----------------------------------------------------------------
>
>          Key: HADOOP-97
>          URL: http://issues.apache.org/jira/browse/HADOOP-97
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.1.0
>  Attachments: DFSShell.patch
>
> DFSShell.cat crashes with a NullPointerException if file to be displayed does not exist.
> The bug is fixed in the attached patch, and the general exception handling in main() is added.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:20 2006
Return-Path: 
 <hadoop-dev-return-972-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84156 invoked from network); 24 Apr 2006 23:11:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:20 -0000
Received: (qmail 32377 invoked by uid 500); 24 Apr 2006 23:11:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32352 invoked by uid 500); 24 Apr 2006 23:11:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32342 invoked by uid 99); 24 Apr 2006 23:11:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:19 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1BD797142BB
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:10 +0000 (GMT)
Message-ID: <15777483.1145920210110.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:10 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-30) DFS shell: support for ls -r and cat
In-Reply-To: <1717747145.1139526955947.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-30?page=all ]

Doug Cutting updated HADOOP-30:
-------------------------------

    Fix Version: 0.1.0

> DFS shell: support for ls -r and cat
> ------------------------------------
>
>          Key: HADOOP-30
>          URL: http://issues.apache.org/jira/browse/HADOOP-30
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Michel Tourn
>      Fix For: 0.1.0
>  Attachments: lsrcat.patch
>
> patch attached

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:26 2006
Return-Path: 
 <hadoop-dev-return-973-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84215 invoked from network); 24 Apr 2006 23:11:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:26 -0000
Received: (qmail 32563 invoked by uid 500); 24 Apr 2006 23:11:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32528 invoked by uid 500); 24 Apr 2006 23:11:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32518 invoked by uid 99); 24 Apr 2006 23:11:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:25 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CF7F5410006
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:13 +0000 (GMT)
Message-ID: <25983987.1145920211360.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:11 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-25) a new map/reduce example and moving the
 examples from src/java to src/examples
In-Reply-To: <187621972.1139267817333.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-25?page=all ]

Doug Cutting updated HADOOP-25:
-------------------------------

    Fix Version: 0.1.0

> a new map/reduce example and moving the examples from src/java to src/examples
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-25
>          URL: http://issues.apache.org/jira/browse/HADOOP-25
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Owen O'Malley
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.0
>  Attachments: examples-2.patch, examples-3.patch, examples.patch, find-jar.patch, tar-name-fix.patch
>
> The new example is the word count example from Google's paper. I moved the examples into a separate jar file to demonstrate how to run stand-alone application code.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:37 2006
Return-Path: 
 <hadoop-dev-return-974-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84313 invoked from network); 24 Apr 2006 23:11:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:37 -0000
Received: (qmail 32782 invoked by uid 500); 24 Apr 2006 23:11:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32754 invoked by uid 500); 24 Apr 2006 23:11:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32744 invoked by uid 99); 24 Apr 2006 23:11:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:36 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A7E6F41000C
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:16 +0000 (GMT)
Message-ID: <17531482.1145920216685.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:16 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-38) default splitter should incorporate fs
 block size
In-Reply-To: <1089400937.1139945203207.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-38?page=all ]

Doug Cutting updated HADOOP-38:
-------------------------------

    Fix Version: 0.1.0

> default splitter should incorporate fs block size
> -------------------------------------------------
>
>          Key: HADOOP-38
>          URL: http://issues.apache.org/jira/browse/HADOOP-38
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Doug Cutting
>      Fix For: 0.1.0

>
> By default, the file splitting code should operate as follows.
>   inputs are <file>*, numMapTasks, minSplitSize, fsBlockSize
>   output is <file,start,length>*
>   totalSize = sum of all file sizes;
>   desiredSplitSize = totalSize / numMapTasks;
>   if (desiredSplitSize > fsBlockSize)             /* new */
>     desiredSplitSize = fsBlockSize;
>   if (desiredSplitSize < minSplitSize)
>     desiredSplitSize = minSplitSize;
>   chop input files into desiredSplitSize chunks & return them
> In other words, the numMapTasks is a desired minimum.  We'll try to chop input into at least numMapTasks chunks, each ideally a single fs block.
> If there's not enough input data to create numMapTasks tasks, each with an entire block, then we'll permit tasks whose input is smaller than a filesystem block, down to a minimum split size.
> This handles cases where:
>   - each input record takes a lot of time to process.  In this case we want to make sure we use all of the cluster.  Thus it is important to permit splits smaller than the fs block size.
>   - input i/o dominates.  In this case we want to permit the placement of tasks on hosts where their data is local.  This is only possible if splits are fs block size or smaller.
> Are there other common cases that this algorithm does not handle well?
> The part marked 'new' above is not currently implemented, but I'd like to add it.
> Does this sound reasonble?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:38 2006
Return-Path: 
 <hadoop-dev-return-976-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84360 invoked from network); 24 Apr 2006 23:11:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:38 -0000
Received: (qmail 33041 invoked by uid 500); 24 Apr 2006 23:11:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33018 invoked by uid 500); 24 Apr 2006 23:11:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32907 invoked by uid 99); 24 Apr 2006 23:11:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:37 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CF5E441000F
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:18 +0000 (GMT)
Message-ID: <15856176.1145920218847.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-10) ndfs.replication is not documented
 within the nutch-default.xml configuration file.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-10?page=all ]

Doug Cutting updated HADOOP-10:
-------------------------------

    Fix Version: 0.1.0

> ndfs.replication is not documented within the nutch-default.xml configuration file.
> -----------------------------------------------------------------------------------
>
>          Key: HADOOP-10
>          URL: http://issues.apache.org/jira/browse/HADOOP-10
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Rod Taylor
>     Priority: Trivial
>      Fix For: 0.1.0

>
> ndfs.replication is not documented within the nutch-default.xml configuration file.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:38 2006
Return-Path: 
 <hadoop-dev-return-975-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84314 invoked from network); 24 Apr 2006 23:11:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:38 -0000
Received: (qmail 32852 invoked by uid 500); 24 Apr 2006 23:11:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32764 invoked by uid 500); 24 Apr 2006 23:11:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32745 invoked by uid 99); 24 Apr 2006 23:11:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:36 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0245441000D
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:18 +0000 (GMT)
Message-ID: <20810481.1145920218006.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-37) A way to determine the size and overall
 activity of the cluster
In-Reply-To: <836056018.1139904729007.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-37?page=all ]

Doug Cutting updated HADOOP-37:
-------------------------------

    Fix Version: 0.1.0

> A way to determine the size and overall activity of the cluster
> ---------------------------------------------------------------
>
>          Key: HADOOP-37
>          URL: http://issues.apache.org/jira/browse/HADOOP-37
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Owen O'Malley
>      Fix For: 0.1.0
>  Attachments: cluster-status.patch
>
> There is currently no way for an application to determine the size or activity of the cluster.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:40 2006
Return-Path: 
 <hadoop-dev-return-977-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84389 invoked from network); 24 Apr 2006 23:11:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:40 -0000
Received: (qmail 33194 invoked by uid 500); 24 Apr 2006 23:11:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33074 invoked by uid 500); 24 Apr 2006 23:11:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33019 invoked by uid 99); 24 Apr 2006 23:11:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:37 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E06F9410011
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:19 +0000 (GMT)
Message-ID: <33195389.1145920219916.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:19 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-49) JobClient cannot use a non-default
 server (unlike DFSShell)
In-Reply-To: <475642315.1140560804678.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-49?page=all ]

Doug Cutting updated HADOOP-49:
-------------------------------

    Fix Version: 0.1.0

> JobClient cannot use a non-default server (unlike DFSShell)
> -----------------------------------------------------------
>
>          Key: HADOOP-49
>          URL: http://issues.apache.org/jira/browse/HADOOP-49
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Michel Tourn
>     Assignee: Michel Tourn
>      Fix For: 0.1.0
>  Attachments: jcjt.patch
>
> JobClient cannot use a non-default Job Tracker server:
> It will use the Job Tracker specified in conf/hadoop-default.xml or conf/hadoop-site.xml
> For users with multiple Hadoop systems, it is useful to be able to specify the Job Tracker.
> Other hadoop command-line tools like DFSShell already have:
> >bin/hadoop dfs
> Usage: java DFSShell [-local | -dfs <namenode:port>]  ...
> Similarly I propose to add a -jt parameter:
> >bin/hadoop job
> JobClient -submit <job> | -status <id> | -kill <id> [-jt <jobtracker:port>|<config>]
> Where: -jt <jobtracker:port> is similar to -dfs <namenode:port>
> And:  -jt <config> will load as a final resource: hadoop-<config>.xml
> The latter syntax is discoverable by users because on failure the tool will say:
> >bin/hadoop job -kill m7n6pi -jt unknown
> Exception in thread "main" java.lang.RuntimeException: hadoop-unknown.xml not found on CLASSPATH
> Or in case of success:
> >bin/hadoop job -kill job_m7n6pi -jt myconfig
> 060221 221911 parsing file:/trunk/conf/hadoop-default.xml
> 060221 221911 parsing file:/trunk/conf/hadoop-myconfig.xml
> 060221 221911 parsing file:/trunk/conf/hadoop-site.xml
> 060221 221911 Client connection to 66.196.91.10:7020: starting
> And with a machine:port spec:
> >bin/hadoop job -kill job_m7n6pi -jt machine:8020
> 060221 222109 parsing file:/trunk/conf/hadoop-default.xml
> 060221 222109 parsing file:/trunk/conf/hadoop-site.xml
> 060221 222109 Client connection to 66.196.91.10:8020: starting
> Patch attached.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:43 2006
Return-Path: 
 <hadoop-dev-return-978-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84436 invoked from network); 24 Apr 2006 23:11:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:43 -0000
Received: (qmail 33750 invoked by uid 500); 24 Apr 2006 23:11:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33668 invoked by uid 500); 24 Apr 2006 23:11:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33546 invoked by uid 99); 24 Apr 2006 23:11:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:38 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AE5F4410012
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:20 +0000 (GMT)
Message-ID: <22457510.1145920220711.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:20 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-21) the webapps need to be updated for the
 move from nutch
In-Reply-To: <1903777814.1139253238270.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-21?page=all ]

Doug Cutting updated HADOOP-21:
-------------------------------

    Fix Version: 0.1.0

> the webapps need to be updated for the move from nutch
> ------------------------------------------------------
>
>          Key: HADOOP-21
>          URL: http://issues.apache.org/jira/browse/HADOOP-21
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1.0
>  Attachments: webapps-move-2.patch, webapps-move.patch
>
> The webapp files need to be updated so that the reference the new packages. I'll include a patch to fix it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:44 2006
Return-Path: 
 <hadoop-dev-return-979-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84478 invoked from network); 24 Apr 2006 23:11:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:44 -0000
Received: (qmail 33976 invoked by uid 500); 24 Apr 2006 23:11:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33699 invoked by uid 500); 24 Apr 2006 23:11:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33612 invoked by uid 99); 24 Apr 2006 23:11:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:38 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7EE77410014
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:21 +0000 (GMT)
Message-ID: <31322948.1145920221517.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:21 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-34) Build Paths Relative to PWD in
 build.xml
In-Reply-To: <441910403.1139850086186.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-34?page=all ]

Doug Cutting updated HADOOP-34:
-------------------------------

    Fix Version: 0.1.0

> Build Paths Relative to PWD in build.xml
> ----------------------------------------
>
>          Key: HADOOP-34
>          URL: http://issues.apache.org/jira/browse/HADOOP-34
>      Project: Hadoop
>         Type: Bug

>  Environment: Fedora Core 4
>     Reporter: Jeremy Bensley
>     Priority: Trivial
>      Fix For: 0.1.0
>  Attachments: hadoop.build.xml.patch
>
> In the build.xml file, many paths are defined in terms of the present working directory (PWD) instead of relative to the location of the build.xml. Thus, whenever trying to compile from a directory other than the hadoop root, errors such as this appear:
> BUILD FAILED
> /home/jeremy/cvs/hadoop/build.xml:109: org.apache.jasper.JasperException: The -uriroot option must specify a pre-existing directory
> I have scripts / vim parameters that connect to other machines for compiling using ssh, and am not necessarily always in the root whenever I compile.
> I am attaching a patch which sets all paths relative to ${basedir}, and removes the override of ${basedir} to the PWD. Please let me know if there are reasons why the build environment must be relative to the working directory.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:44 2006
Return-Path: 
 <hadoop-dev-return-981-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84481 invoked from network); 24 Apr 2006 23:11:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:44 -0000
Received: (qmail 33993 invoked by uid 500); 24 Apr 2006 23:11:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33871 invoked by uid 500); 24 Apr 2006 23:11:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33700 invoked by uid 99); 24 Apr 2006 23:11:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:39 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4EFA741000E
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:22 +0000 (GMT)
Message-ID: <22069325.1145920222321.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:22 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-36) Adding some uniformity/convenience to
 environment management
In-Reply-To: <630345415.1139861112665.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-36?page=all ]

Doug Cutting updated HADOOP-36:
-------------------------------

    Fix Version: 0.1.0

> Adding some uniformity/convenience to environment management
> ------------------------------------------------------------
>
>          Key: HADOOP-36
>          URL: http://issues.apache.org/jira/browse/HADOOP-36
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Bryan Pendleton
>      Fix For: 0.1.0

>
> Currently, "slaves" are loaded from ~/.slaves. What would be better would be to default from something like conf/hadoop-slaves
> Perhaps split slaves, having a different set for "datanodes" vs. "tasktracker" nodes. ie, conf/hadoop-slaves-tasktracker, conf/hadoop-slaves-datanodes, or some similar split. There's the possibility it's worth building in the assumption that tasktracker is a superset, and thus implicitly includes datanodes, but this might be a bad assumption.
> Also, make sure all scripts source something like conf/hadoop-env.sh. Thus, the user can edit hadoop-env.sh to specify JAVA_HOME, or an alternate HADOOP_SLAVES location. It would also be desirable to have a seed CLASSPATH here. Possibly name it HADOOP_CLASSPATH, to make it explicit and not make hadoop scripts possibly interact with an otherwise-set system CLASSPATH variable.
> These changes would probably be useful to the nutch project, too.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:47 2006
Return-Path: 
 <hadoop-dev-return-983-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84579 invoked from network); 24 Apr 2006 23:11:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:47 -0000
Received: (qmail 34685 invoked by uid 500); 24 Apr 2006 23:11:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34656 invoked by uid 500); 24 Apr 2006 23:11:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34625 invoked by uid 99); 24 Apr 2006 23:11:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:46 -0700
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:45 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E3E2A410018
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:23 +0000 (GMT)
Message-ID: <3058284.1145920223930.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:23 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-20) Mapper, Reducer need an occasion to
 cleanup after the last record is processed.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-20?page=all ]

Doug Cutting updated HADOOP-20:
-------------------------------

    Fix Version: 0.1.0

> Mapper, Reducer need an occasion to cleanup after the last record is processed.
> -------------------------------------------------------------------------------
>
>          Key: HADOOP-20
>          URL: http://issues.apache.org/jira/browse/HADOOP-20
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>  Environment: Linux
>     Reporter: Michel Tourn
>      Fix For: 0.1.0
>  Attachments: mapredfinished.log, mrclose.patch
>
> Mapper, Reducer need an occasion to do some cleanup after the last record is processed.
> Proposal (patch attached)
> in interface Mapper:
>  add method void finished();
> in interface Reducer:
>  add method void finished();
> finished() methods are called from MapTask, CombiningCollector, ReduceTask.
> ------------
> Known limitation: Fetcher (a multithreaded MapRunnable) does not call finished().
> This is not currently a problem bec. fetcher Map/Reduce modules do not do anything in finished().
> The right way to add finished() support to Fetcher would be to wait for all threads to finish, 
> then do:
>      if (collector instanceof CombiningCollector) ((CombiningCollector)collector).finished();
> ------------
> patch begins: (svn trunk)
> Index: src/test/org/apache/nutch/mapred/MapredLoadTest.java
> ===================================================================
> --- src/test/org/apache/nutch/mapred/MapredLoadTest.java	(revision 374781)
> +++ src/test/org/apache/nutch/mapred/MapredLoadTest.java	(working copy)
> @@ -69,6 +69,8 @@
>                  out.collect(new IntWritable(Math.abs(r.nextInt())), new IntWritable(randomVal));
>              }
>          }
> +        public void finished() {
> +        }
>      }
>      static class RandomGenReducer implements Reducer {
>          public void configure(JobConf job) {
> @@ -81,6 +83,8 @@
>                  out.collect(new UTF8("" + val), new UTF8(""));
>              }
>          }
> +        public void finished() {
> +        }
>      }
>      static class RandomCheckMapper implements Mapper {
>          public void configure(JobConf job) {
> @@ -92,6 +96,8 @@
>  
>              out.collect(new IntWritable(Integer.parseInt(str.toString().trim())), new IntWritable(1));
>          }
> +        public void finished() {
> +        }
>      }
>      static class RandomCheckReducer implements Reducer {
>          public void configure(JobConf job) {
> @@ -106,6 +112,8 @@
>              }
>              out.collect(new IntWritable(keyint), new IntWritable(count));
>          }
> +        public void finished() {
> +        }
>      }
>  
>      int range;
> Index: src/test/org/apache/nutch/fs/TestNutchFileSystem.java
> ===================================================================
> --- src/test/org/apache/nutch/fs/TestNutchFileSystem.java	(revision 374783)
> +++ src/test/org/apache/nutch/fs/TestNutchFileSystem.java	(working copy)
> @@ -155,6 +155,8 @@
>  
>        reporter.setStatus("wrote " + name);
>      }
> +    
> +    public void finished() {}
>    }
>  
>    public static void writeTest(NutchFileSystem fs, boolean fastCheck)
> @@ -247,6 +249,9 @@
>  
>        reporter.setStatus("read " + name);
>      }
> +    
> +    public void finished() {}
> +    
>    }
>  
>    public static void readTest(NutchFileSystem fs, boolean fastCheck)
> @@ -339,6 +344,9 @@
>          in.close();
>        }
>      }
> +    
> +    public void finished() {}
> +    
>    }
>  
>    public static void seekTest(NutchFileSystem fs, boolean fastCheck)
> Index: src/java/org/apache/nutch/indexer/DeleteDuplicates.java
> ===================================================================
> --- src/java/org/apache/nutch/indexer/DeleteDuplicates.java	(revision 374776)
> +++ src/java/org/apache/nutch/indexer/DeleteDuplicates.java	(working copy)
> @@ -225,6 +225,7 @@
>          }
>        }
>      }
> +    public void finished() {}
>    }
>      
>    private NutchFileSystem fs;
> @@ -265,6 +266,8 @@
>        reader.close();
>      }
>    }
> +  
> +  public void finished() {}
>  
>    /** Write nothing. */
>    public RecordWriter getRecordWriter(final NutchFileSystem fs,
> Index: src/java/org/apache/nutch/indexer/Indexer.java
> ===================================================================
> --- src/java/org/apache/nutch/indexer/Indexer.java	(revision 374778)
> +++ src/java/org/apache/nutch/indexer/Indexer.java	(working copy)
> @@ -227,6 +227,8 @@
>  
>      output.collect(key, new ObjectWritable(doc));
>    }
> +  
> +  public void finished() {}
>  
>    public void index(File indexDir, File crawlDb, File linkDb, File[] segments)
>      throws IOException {
> Index: src/java/org/apache/nutch/segment/SegmentReader.java
> ===================================================================
> --- src/java/org/apache/nutch/segment/SegmentReader.java	(revision 374778)
> +++ src/java/org/apache/nutch/segment/SegmentReader.java	(working copy)
> @@ -143,7 +143,9 @@
>      }
>      output.collect(key, new ObjectWritable(dump.toString()));
>    }
> -
> +  
> +  public void finished() {}
> +  
>    public void reader(File segment) throws IOException {
>      LOG.info("Reader: segment: " + segment);
>  
> Index: src/java/org/apache/nutch/mapred/Mapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/Mapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/Mapper.java	(working copy)
> @@ -39,4 +39,9 @@
>    void map(WritableComparable key, Writable value,
>             OutputCollector output, Reporter reporter)
>      throws IOException;
> +
> +  /** Called after the last {@link #map} call on this Mapper object.
> +      Typical implementations do nothing.
> +  */
> +  void finished();
>  }
> Index: src/java/org/apache/nutch/mapred/lib/RegexMapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/RegexMapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/RegexMapper.java	(working copy)
> @@ -53,4 +53,5 @@
>        output.collect(new UTF8(matcher.group(group)), new LongWritable(1));
>      }
>    }
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/InverseMapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/InverseMapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/InverseMapper.java	(working copy)
> @@ -38,4 +38,6 @@
>      throws IOException {
>      output.collect((WritableComparable)value, key);
>    }
> +
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/IdentityReducer.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/IdentityReducer.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/IdentityReducer.java	(working copy)
> @@ -42,4 +42,5 @@
>      }
>    }
>  
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/IdentityMapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/IdentityMapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/IdentityMapper.java	(working copy)
> @@ -39,4 +39,5 @@
>      output.collect(key, val);
>    }
>  
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/LongSumReducer.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/LongSumReducer.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/LongSumReducer.java	(working copy)
> @@ -47,4 +47,6 @@
>      // output sum
>      output.collect(key, new LongWritable(sum));
>    }
> +
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/TokenCountMapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/TokenCountMapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/TokenCountMapper.java	(working copy)
> @@ -50,4 +50,6 @@
>        output.collect(new UTF8(st.nextToken()), new LongWritable(1));
>      }
>    }
> +
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/ReduceTask.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/ReduceTask.java	(revision 374781)
> +++ src/java/org/apache/nutch/mapred/ReduceTask.java	(working copy)
> @@ -275,6 +275,7 @@
>        }
>  
>      } finally {
> +      reducer.finished();
>        in.close();
>        lfs.delete(new File(sortedFile));           // remove sorted
>        out.close(reporter);
> Index: src/java/org/apache/nutch/mapred/MapTask.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/MapTask.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/MapTask.java	(working copy)
> @@ -50,7 +50,7 @@
>    public void write(DataOutput out) throws IOException {
>      super.write(out);
>      split.write(out);
> -    
> +
>    }
>    public void readFields(DataInput in) throws IOException {
>      super.readFields(in);
> @@ -126,6 +126,10 @@
>          }
>  
>        } finally {
> +        if (combining) {
> +          ((CombiningCollector)collector).finished();
> +        }
> +
>          in.close();                               // close input
>        }
>      } finally {
> @@ -147,5 +151,5 @@
>    public NutchConf getConf() {
>      return this.nutchConf;
>    }
> -  
> +
>  }
> Index: src/java/org/apache/nutch/mapred/MapRunner.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/MapRunner.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/MapRunner.java	(working copy)
> @@ -38,18 +38,22 @@
>    public void run(RecordReader input, OutputCollector output,
>                    Reporter reporter)
>      throws IOException {
> -    while (true) {
> -      // allocate new key & value instances
> -      WritableComparable key =
> -        (WritableComparable)job.newInstance(inputKeyClass);
> -      Writable value = (Writable)job.newInstance(inputValueClass);
> +    try {
> +      while (true) {
> +        // allocate new key & value instances
> +        WritableComparable key =
> +          (WritableComparable)job.newInstance(inputKeyClass);
> +        Writable value = (Writable)job.newInstance(inputValueClass);
>  
> -      // read next key & value
> -      if (!input.next(key, value))
> -        return;
> +        // read next key & value
> +        if (!input.next(key, value))
> +          return;
>  
> -      // map pair to output
> -      mapper.map(key, value, output, reporter);
> +        // map pair to output
> +        mapper.map(key, value, output, reporter);
> +      }
> +    } finally {
> +        mapper.finished();
>      }
>    }
>  
> Index: src/java/org/apache/nutch/mapred/CombiningCollector.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/CombiningCollector.java	(revision 374780)
> +++ src/java/org/apache/nutch/mapred/CombiningCollector.java	(working copy)
> @@ -78,4 +78,9 @@
>      count = 0;
>    }
>  
> +  public synchronized void finished()
> +  {
> +    combiner.finished();
> +  }
> +
>  }
> Index: src/java/org/apache/nutch/mapred/Reducer.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/Reducer.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/Reducer.java	(working copy)
> @@ -38,4 +38,10 @@
>    void reduce(WritableComparable key, Iterator values,
>                OutputCollector output, Reporter reporter)
>      throws IOException;
> +
> +  /** Called after the last {@link #reduce} call on this Reducer object.
> +      Typical implementations do nothing.
> +  */
> +  void finished();
> +
>  }
> Index: src/java/org/apache/nutch/crawl/CrawlDbReader.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/CrawlDbReader.java	(revision 374737)
> +++ src/java/org/apache/nutch/crawl/CrawlDbReader.java	(working copy)
> @@ -50,9 +50,9 @@
>  
>  /**
>   * Read utility for the CrawlDB.
> - * 
> + *
>   * @author Andrzej Bialecki
> - * 
> + *
>   */
>  public class CrawlDbReader {
>  
> @@ -68,6 +68,7 @@
>        output.collect(new UTF8("retry"), new LongWritable(cd.getRetriesSinceFetch()));
>        output.collect(new UTF8("score"), new LongWritable((long) (cd.getScore() * 1000.0)));
>      }
> +    public void finished() {}
>    }
>  
>    public static class CrawlDbStatReducer implements Reducer {
> @@ -121,6 +122,7 @@
>          output.collect(new UTF8("avg score"), new LongWritable(total / cnt));
>        }
>      }
> +    public void finished() {}
>    }
>  
>    public static class CrawlDbDumpReducer implements Reducer {
> @@ -133,8 +135,11 @@
>  
>      public void configure(JobConf job) {
>      }
> +
> +    public void finished() {
> +    }
>    }
> -  
> +
>    public void processStatJob(String crawlDb, NutchConf config) throws IOException {
>      LOG.info("CrawlDb statistics start: " + crawlDb);
>      File tmpFolder = new File(crawlDb, "stat_tmp" + System.currentTimeMillis());
> @@ -219,7 +224,7 @@
>        System.out.println("not found");
>      }
>    }
> -  
> +
>    public void processDumpJob(String crawlDb, String output, NutchConf config) throws IOException {
>  
>      LOG.info("CrawlDb dump: starting");
> @@ -270,4 +275,5 @@
>      }
>      return;
>    }
> +
>  }
> Index: src/java/org/apache/nutch/crawl/LinkDb.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/LinkDb.java	(revision 374779)
> +++ src/java/org/apache/nutch/crawl/LinkDb.java	(working copy)
> @@ -118,7 +118,8 @@
>      output.collect(key, result);
>    }
>  
> -
> +  public void finished() {}
> +	
>    public void invert(File linkDb, File segmentsDir) throws IOException {
>      LOG.info("LinkDb: starting");
>      LOG.info("LinkDb: linkdb: " + linkDb);
> Index: src/java/org/apache/nutch/crawl/Injector.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/Injector.java	(revision 374779)
> +++ src/java/org/apache/nutch/crawl/Injector.java	(working copy)
> @@ -65,6 +65,8 @@
>                                               interval));
>        }
>      }
> +    
> +    public void finished() {}
>    }
>  
>    /** Combine multiple new entries for a url. */
> @@ -76,6 +78,7 @@
>        throws IOException {
>        output.collect(key, (Writable)values.next()); // just collect first value
>      }
> +    public void finished() {}
>    }
>  
>    /** Construct an Injector. */
> Index: src/java/org/apache/nutch/crawl/Generator.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/Generator.java	(revision 374779)
> +++ src/java/org/apache/nutch/crawl/Generator.java	(working copy)
> @@ -63,6 +63,8 @@
>        output.collect(crawlDatum, key);          // invert for sort by score
>      }
>  
> +    public void finished() {}
> +    
>      /** Partition by host (value). */
>      public int getPartition(WritableComparable key, Writable value,
>                              int numReduceTasks) {
> Index: src/java/org/apache/nutch/crawl/CrawlDbReducer.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/CrawlDbReducer.java	(revision 374781)
> +++ src/java/org/apache/nutch/crawl/CrawlDbReducer.java	(working copy)
> @@ -115,4 +115,5 @@
>      }
>    }
>  
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/parse/ParseSegment.java
> ===================================================================
> --- src/java/org/apache/nutch/parse/ParseSegment.java	(revision 374776)
> +++ src/java/org/apache/nutch/parse/ParseSegment.java	(working copy)
> @@ -78,6 +78,8 @@
>      throws IOException {
>      output.collect(key, (Writable)values.next()); // collect first value
>    }
> +  
> +  public void finished() {}
>  
>    public void parse(File segment) throws IOException {
>      LOG.info("Parse: starting");

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:44 2006
Return-Path: 
 <hadoop-dev-return-980-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84476 invoked from network); 24 Apr 2006 23:11:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:44 -0000
Received: (qmail 33935 invoked by uid 500); 24 Apr 2006 23:11:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33803 invoked by uid 500); 24 Apr 2006 23:11:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33696 invoked by uid 99); 24 Apr 2006 23:11:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:39 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1E527410016
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:23 +0000 (GMT)
Message-ID: <6605250.1145920223121.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:23 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-28) webapps broken
In-Reply-To: <2105821548.1139420592025.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-28?page=all ]

Doug Cutting updated HADOOP-28:
-------------------------------

    Fix Version: 0.1.0

> webapps broken
> --------------
>
>          Key: HADOOP-28
>          URL: http://issues.apache.org/jira/browse/HADOOP-28
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Owen O'Malley
>      Fix For: 0.1.0
>  Attachments: jspc.patch
>
> Changing the classes to private broke the webapps. 
> The required public classes are:
> org.apache.hadoop.mapred.JobInProgress
> org.apache.hadoop.mapred.JobProfile
> org.apache.hadoop.mapred.JobStatus
> org.apache.hadoop.mapred.TaskTrackerStatus
> To fix, we need one of:
>   1. The classes need to be made public again
>   2. The functionality needs to be made available through the classes that are public
>   3. The webapps need to move into the mapred package.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:46 2006
Return-Path: 
 <hadoop-dev-return-982-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84554 invoked from network); 24 Apr 2006 23:11:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:46 -0000
Received: (qmail 34543 invoked by uid 500); 24 Apr 2006 23:11:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34525 invoked by uid 500); 24 Apr 2006 23:11:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34515 invoked by uid 99); 24 Apr 2006 23:11:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:45 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BD59E410017
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:24 +0000 (GMT)
Message-ID: <20452373.1145920224773.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:24 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-6) missing build directory in classpath
In-Reply-To: <189115709.1139250003132.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-6?page=all ]

Doug Cutting updated HADOOP-6:
------------------------------

    Fix Version: 0.1.0

> missing build directory in classpath
> ------------------------------------
>
>          Key: HADOOP-6
>          URL: http://issues.apache.org/jira/browse/HADOOP-6
>      Project: Hadoop
>         Type: Bug

>     Reporter: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1.0
>  Attachments: build-in-path.patch
>
> When running a developer build, the hadoop script needs the build directory on the classpath so that the job tracker can find the webapps directory.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:59 2006
Return-Path: 
 <hadoop-dev-return-985-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84673 invoked from network); 24 Apr 2006 23:11:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:59 -0000
Received: (qmail 35011 invoked by uid 500); 24 Apr 2006 23:11:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34974 invoked by uid 500); 24 Apr 2006 23:11:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34833 invoked by uid 99); 24 Apr 2006 23:11:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:57 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:56 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8A11341001A
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:25 +0000 (GMT)
Message-ID: <18725280.1145920225563.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:25 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-5) need commons-logging-api jar file
In-Reply-To: <383609575.1139249112261.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-5?page=all ]

Doug Cutting updated HADOOP-5:
------------------------------

    Fix Version: 0.1.0

> need commons-logging-api jar file
> ---------------------------------
>
>          Key: HADOOP-5
>          URL: http://issues.apache.org/jira/browse/HADOOP-5
>      Project: Hadoop
>         Type: Bug

>     Reporter: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1.0

>
> The hadoop lib directory needs a copy of the commons-logging-api jar file from nutch's lib directory.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:57 2006
Return-Path: 
 <hadoop-dev-return-984-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84647 invoked from network); 24 Apr 2006 23:11:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:57 -0000
Received: (qmail 34954 invoked by uid 500); 24 Apr 2006 23:11:57 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34832 invoked by uid 500); 24 Apr 2006 23:11:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34823 invoked by uid 99); 24 Apr 2006 23:11:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:56 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:56 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EB3C041001B
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:25 +0000 (GMT)
Message-ID: <20493172.1145920225960.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:25 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-1) initial import of code from Nutch
In-Reply-To: <973704829.1138730132730.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-1?page=all ]

Doug Cutting updated HADOOP-1:
------------------------------

    Fix Version: 0.1.0

> initial import of code from Nutch
> ---------------------------------
>
>          Key: HADOOP-1
>          URL: http://issues.apache.org/jira/browse/HADOOP-1
>      Project: Hadoop
>         Type: Task

>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.1.0

>
> The initial code for Hadoop will be copied from Nutch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:59 2006
Return-Path: 
 <hadoop-dev-return-987-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84689 invoked from network); 24 Apr 2006 23:11:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:59 -0000
Received: (qmail 35136 invoked by uid 500); 24 Apr 2006 23:11:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34991 invoked by uid 500); 24 Apr 2006 23:11:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34839 invoked by uid 99); 24 Apr 2006 23:11:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:57 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:56 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B933341001D
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:26 +0000 (GMT)
Message-ID: <6058583.1145920226756.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:26 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-7) MapReduce has a series of problems
 concerning task-allocation to worker nodes
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-7?page=all ]

Doug Cutting updated HADOOP-7:
------------------------------

    Fix Version: 0.1.0

> MapReduce has a series of problems concerning task-allocation to worker nodes
> -----------------------------------------------------------------------------
>
>          Key: HADOOP-7
>          URL: http://issues.apache.org/jira/browse/HADOOP-7
>      Project: Hadoop
>         Type: Bug

>  Environment: All
>     Reporter: Mike Cafarella
>      Fix For: 0.1.0
>  Attachments: jobtracker.patch
>
> The MapReduce JobTracker is not great at allocating tasks to TaskTracker worker nodes.
> Here are the problems:
> 1) There is no speculative execution of tasks
> 2) Reduce tasks must wait until all map tasks are completed before doing any work
> 3) TaskTrackers don't distinguish between Map and Reduce jobs.  Also, the number of
> tasks at a single node is limited to some constant.  That means you can get weird deadlock
> problems upon machine failure.  The reduces take up all the available execution slots, but they
> don't do productive work, because they're waiting for a map task to complete.  Of course, that
> map task won't even be started until the reduce tasks finish, so you can see the problem...
> 4) The JobTracker is so complicated that it's hard to fix any of these.
> The right solution is a rewrite of the JobTracker to be a lot more flexible in task handling.
> It has to be a lot simpler.  One way to make it simpler is to add an abstraction I'll call
> "TaskInProgress".  Jobs are broken into chunks called TasksInProgress.  All the TaskInProgress
> objects must be complete, somehow, before the Job is complete.
> A single TaskInProgress can be executed by one or more Tasks.  TaskTrackers are assigned Tasks.
> If a Task fails, we report it back to the JobTracker, where the TaskInProgress lives.  The TIP can then
> decide whether to launch additional  Tasks or not.
> Speculative execution is handled within the TIP.  It simply launches multiple Tasks in parallel.  The
> TaskTrackers have no idea that these Tasks are actually doing the same chunk of work.  The TIP
> is complete when any one of its Tasks are complete.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:11:59 2006
Return-Path: 
 <hadoop-dev-return-986-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84687 invoked from network); 24 Apr 2006 23:11:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:11:59 -0000
Received: (qmail 35065 invoked by uid 500); 24 Apr 2006 23:11:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34981 invoked by uid 500); 24 Apr 2006 23:11:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34843 invoked by uid 99); 24 Apr 2006 23:11:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:57 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:11:56 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 61ED5410009
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:10:28 +0000 (GMT)
Message-ID: <32011117.1145920228398.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:10:28 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-83) infinite retries accessing a missing
 block
In-Reply-To: <671256830.1142449198957.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-83?page=all ]

Doug Cutting updated HADOOP-83:
-------------------------------

    Fix Version: 0.1.0

> infinite retries accessing a missing block
> ------------------------------------------
>
>          Key: HADOOP-83
>          URL: http://issues.apache.org/jira/browse/HADOOP-83
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>      Fix For: 0.1.0

>
> A file in the DFS got corrupted - the reason for that is unknown, but might be justified.
> when accessing the file, I get an infinite stream of error messages from the client - attached below.
> The client aparently increments an error counter, but never checks it.
> Correct behaviour is for the client to retry a few times, then abort.
> 060315 105436 No node available for block blk_2690692619196463439
> 060315 105436 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105446 No node available for block blk_2690692619196463439
> 060315 105446 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105456 No node available for block blk_2690692619196463439
> 060315 105456 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105506 No node available for block blk_2690692619196463439
> 060315 105506 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105516 No node available for block blk_2690692619196463439
> 060315 105516 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105526 No node available for block blk_2690692619196463439
> 060315 105526 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105536 No node available for block blk_2690692619196463439
> 060315 105536 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105546 No node available for block blk_2690692619196463439
> 060315 105546 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105556 No node available for block blk_2690692619196463439
> 060315 105556 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105606 No node available for block blk_2690692619196463439
> 060315 105606 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105616 No node available for block blk_2690692619196463439
> 060315 105616 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105626 No node available for block blk_2690692619196463439
> 060315 105626 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105636 No node available for block blk_2690692619196463439
> 060315 105636 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105646 No node available for block blk_2690692619196463439
> 060315 105646 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105657 No node available for block blk_2690692619196463439
> 060315 105657 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105707 No node available for block blk_2690692619196463439
> 060315 105707 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105717 No node available for block blk_2690692619196463439
> 060315 105717 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105727 No node available for block blk_2690692619196463439
> 060315 105727 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105737 No node available for block blk_2690692619196463439
> 060315 105737 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105747 No node available for block blk_2690692619196463439
> 060315 105747 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105757 No node available for block blk_2690692619196463439
> 060315 105757 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105807 No node available for block blk_2690692619196463439
> 060315 105807 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105817 No node available for block blk_2690692619196463439

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:18 2006
Return-Path: 
 <hadoop-dev-return-988-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85215 invoked from network); 24 Apr 2006 23:13:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:18 -0000
Received: (qmail 36780 invoked by uid 500); 24 Apr 2006 23:13:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36713 invoked by uid 500); 24 Apr 2006 23:13:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36669 invoked by uid 99); 24 Apr 2006 23:13:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4463F7142C0
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:07 +0000 (GMT)
Message-ID: <3155036.1145920327277.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-1) initial import of code from Nutch
In-Reply-To: <973704829.1138730132730.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-1?page=all ]
     
Doug Cutting closed HADOOP-1:
-----------------------------


> initial import of code from Nutch
> ---------------------------------
>
>          Key: HADOOP-1
>          URL: http://issues.apache.org/jira/browse/HADOOP-1
>      Project: Hadoop
>         Type: Task

>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.1.0

>
> The initial code for Hadoop will be copied from Nutch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:19 2006
Return-Path: 
 <hadoop-dev-return-989-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85248 invoked from network); 24 Apr 2006 23:13:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:19 -0000
Received: (qmail 37094 invoked by uid 500); 24 Apr 2006 23:13:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37067 invoked by uid 500); 24 Apr 2006 23:13:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37058 invoked by uid 99); 24 Apr 2006 23:13:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DD5497142BB
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:08 +0000 (GMT)
Message-ID: <1204285.1145920328904.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:08 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-5) need commons-logging-api jar file
In-Reply-To: <383609575.1139249112261.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-5?page=all ]
     
Doug Cutting closed HADOOP-5:
-----------------------------


> need commons-logging-api jar file
> ---------------------------------
>
>          Key: HADOOP-5
>          URL: http://issues.apache.org/jira/browse/HADOOP-5
>      Project: Hadoop
>         Type: Bug

>     Reporter: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1.0

>
> The hadoop lib directory needs a copy of the commons-logging-api jar file from nutch's lib directory.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:20 2006
Return-Path: 
 <hadoop-dev-return-990-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85284 invoked from network); 24 Apr 2006 23:13:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:20 -0000
Received: (qmail 37230 invoked by uid 500); 24 Apr 2006 23:13:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37208 invoked by uid 500); 24 Apr 2006 23:13:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37195 invoked by uid 99); 24 Apr 2006 23:13:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:19 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6032D7142C3
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:10 +0000 (GMT)
Message-ID: <31631245.1145920330391.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:10 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-6) missing build directory in classpath
In-Reply-To: <189115709.1139250003132.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-6?page=all ]
     
Doug Cutting closed HADOOP-6:
-----------------------------


> missing build directory in classpath
> ------------------------------------
>
>          Key: HADOOP-6
>          URL: http://issues.apache.org/jira/browse/HADOOP-6
>      Project: Hadoop
>         Type: Bug

>     Reporter: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1.0
>  Attachments: build-in-path.patch
>
> When running a developer build, the hadoop script needs the build directory on the classpath so that the job tracker can find the webapps directory.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:21 2006
Return-Path: 
 <hadoop-dev-return-991-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85310 invoked from network); 24 Apr 2006 23:13:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:21 -0000
Received: (qmail 37366 invoked by uid 500); 24 Apr 2006 23:13:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37338 invoked by uid 500); 24 Apr 2006 23:13:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37326 invoked by uid 99); 24 Apr 2006 23:13:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:19 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EFA08410009
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:10 +0000 (GMT)
Message-ID: <24318176.1145920330979.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:10 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-7) MapReduce has a series of problems
 concerning task-allocation to worker nodes
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-7?page=all ]
     
Doug Cutting closed HADOOP-7:
-----------------------------


> MapReduce has a series of problems concerning task-allocation to worker nodes
> -----------------------------------------------------------------------------
>
>          Key: HADOOP-7
>          URL: http://issues.apache.org/jira/browse/HADOOP-7
>      Project: Hadoop
>         Type: Bug

>  Environment: All
>     Reporter: Mike Cafarella
>      Fix For: 0.1.0
>  Attachments: jobtracker.patch
>
> The MapReduce JobTracker is not great at allocating tasks to TaskTracker worker nodes.
> Here are the problems:
> 1) There is no speculative execution of tasks
> 2) Reduce tasks must wait until all map tasks are completed before doing any work
> 3) TaskTrackers don't distinguish between Map and Reduce jobs.  Also, the number of
> tasks at a single node is limited to some constant.  That means you can get weird deadlock
> problems upon machine failure.  The reduces take up all the available execution slots, but they
> don't do productive work, because they're waiting for a map task to complete.  Of course, that
> map task won't even be started until the reduce tasks finish, so you can see the problem...
> 4) The JobTracker is so complicated that it's hard to fix any of these.
> The right solution is a rewrite of the JobTracker to be a lot more flexible in task handling.
> It has to be a lot simpler.  One way to make it simpler is to add an abstraction I'll call
> "TaskInProgress".  Jobs are broken into chunks called TasksInProgress.  All the TaskInProgress
> objects must be complete, somehow, before the Job is complete.
> A single TaskInProgress can be executed by one or more Tasks.  TaskTrackers are assigned Tasks.
> If a Task fails, we report it back to the JobTracker, where the TaskInProgress lives.  The TIP can then
> decide whether to launch additional  Tasks or not.
> Speculative execution is handled within the TIP.  It simply launches multiple Tasks in parallel.  The
> TaskTrackers have no idea that these Tasks are actually doing the same chunk of work.  The TIP
> is complete when any one of its Tasks are complete.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:22 2006
Return-Path: 
 <hadoop-dev-return-992-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85336 invoked from network); 24 Apr 2006 23:13:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:22 -0000
Received: (qmail 37493 invoked by uid 500); 24 Apr 2006 23:13:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37470 invoked by uid 500); 24 Apr 2006 23:13:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37461 invoked by uid 99); 24 Apr 2006 23:13:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:21 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3DA8841000C
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:12 +0000 (GMT)
Message-ID: <32191359.1145920332250.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:12 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-10) ndfs.replication is not documented
 within the nutch-default.xml configuration file.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-10?page=all ]
     
Doug Cutting closed HADOOP-10:
------------------------------


> ndfs.replication is not documented within the nutch-default.xml configuration file.
> -----------------------------------------------------------------------------------
>
>          Key: HADOOP-10
>          URL: http://issues.apache.org/jira/browse/HADOOP-10
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Rod Taylor
>     Priority: Trivial
>      Fix For: 0.1.0

>
> ndfs.replication is not documented within the nutch-default.xml configuration file.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:44 2006
Return-Path: 
 <hadoop-dev-return-993-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85491 invoked from network); 24 Apr 2006 23:13:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:44 -0000
Received: (qmail 38161 invoked by uid 500); 24 Apr 2006 23:13:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38079 invoked by uid 500); 24 Apr 2006 23:13:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37802 invoked by uid 99); 24 Apr 2006 23:13:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:36 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 43C9341000D
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:14 +0000 (GMT)
Message-ID: <24344473.1145920334275.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:14 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-12) InputFormat used in job must be in
 JobTracker classpath (not loaded from job JAR)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-12?page=all ]
     
Doug Cutting closed HADOOP-12:
------------------------------


> InputFormat used in job must be in JobTracker classpath (not loaded from job JAR)
> ---------------------------------------------------------------------------------
>
>          Key: HADOOP-12
>          URL: http://issues.apache.org/jira/browse/HADOOP-12
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>  Environment: ~20 node nutch mapreduce environment, running SVN trunk, on Linux
>     Reporter: Bryan Pendleton
>     Priority: Minor
>      Fix For: 0.1.0

>
> During development, I've been creating/tweaking custom InputFormat implementations. However, when you try to run a job against a running cluster, you get:
>   Exception in thread "main" java.io.IOException: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.ClassNotFoundException: my.custom.InputFormat
>           at org.apache.nutch.ipc.Client.call(Client.java:294)
>           at org.apache.nutch.ipc.RPC$Invoker.invoke(RPC.java:127)
>           at $Proxy0.submitJob(Unknown Source)
>           at org.apache.nutch.mapred.JobClient.submitJob(JobClient.java:259)
>           at org.apache.nutch.mapred.JobClient.runJob(JobClient.java:288)
>           at com.parc.uir.wikipedia.WikipediaJob.main(WikipediaJob.java:85)
> This error goes away if I restart the TaskTrackers/JobTracker with a classpath which includes the needed code. Other classes (Mapper, Reducer) appear to be available out of the jar file specified in the JobConf, but not the InputFormat. Obviously, it's less than idea to have to restart the JobTracker whenever there's a change to a job-specific class.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:45 2006
Return-Path: 
 <hadoop-dev-return-994-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85503 invoked from network); 24 Apr 2006 23:13:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:45 -0000
Received: (qmail 38283 invoked by uid 500); 24 Apr 2006 23:13:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38187 invoked by uid 500); 24 Apr 2006 23:13:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37997 invoked by uid 99); 24 Apr 2006 23:13:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:37 -0700
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:36 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2F2C941000F
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:15 +0000 (GMT)
Message-ID: <30556372.1145920335187.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:15 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-20) Mapper, Reducer need an occasion to
 cleanup after the last record is processed.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-20?page=all ]
     
Doug Cutting closed HADOOP-20:
------------------------------


> Mapper, Reducer need an occasion to cleanup after the last record is processed.
> -------------------------------------------------------------------------------
>
>          Key: HADOOP-20
>          URL: http://issues.apache.org/jira/browse/HADOOP-20
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>  Environment: Linux
>     Reporter: Michel Tourn
>      Fix For: 0.1.0
>  Attachments: mapredfinished.log, mrclose.patch
>
> Mapper, Reducer need an occasion to do some cleanup after the last record is processed.
> Proposal (patch attached)
> in interface Mapper:
>  add method void finished();
> in interface Reducer:
>  add method void finished();
> finished() methods are called from MapTask, CombiningCollector, ReduceTask.
> ------------
> Known limitation: Fetcher (a multithreaded MapRunnable) does not call finished().
> This is not currently a problem bec. fetcher Map/Reduce modules do not do anything in finished().
> The right way to add finished() support to Fetcher would be to wait for all threads to finish, 
> then do:
>      if (collector instanceof CombiningCollector) ((CombiningCollector)collector).finished();
> ------------
> patch begins: (svn trunk)
> Index: src/test/org/apache/nutch/mapred/MapredLoadTest.java
> ===================================================================
> --- src/test/org/apache/nutch/mapred/MapredLoadTest.java	(revision 374781)
> +++ src/test/org/apache/nutch/mapred/MapredLoadTest.java	(working copy)
> @@ -69,6 +69,8 @@
>                  out.collect(new IntWritable(Math.abs(r.nextInt())), new IntWritable(randomVal));
>              }
>          }
> +        public void finished() {
> +        }
>      }
>      static class RandomGenReducer implements Reducer {
>          public void configure(JobConf job) {
> @@ -81,6 +83,8 @@
>                  out.collect(new UTF8("" + val), new UTF8(""));
>              }
>          }
> +        public void finished() {
> +        }
>      }
>      static class RandomCheckMapper implements Mapper {
>          public void configure(JobConf job) {
> @@ -92,6 +96,8 @@
>  
>              out.collect(new IntWritable(Integer.parseInt(str.toString().trim())), new IntWritable(1));
>          }
> +        public void finished() {
> +        }
>      }
>      static class RandomCheckReducer implements Reducer {
>          public void configure(JobConf job) {
> @@ -106,6 +112,8 @@
>              }
>              out.collect(new IntWritable(keyint), new IntWritable(count));
>          }
> +        public void finished() {
> +        }
>      }
>  
>      int range;
> Index: src/test/org/apache/nutch/fs/TestNutchFileSystem.java
> ===================================================================
> --- src/test/org/apache/nutch/fs/TestNutchFileSystem.java	(revision 374783)
> +++ src/test/org/apache/nutch/fs/TestNutchFileSystem.java	(working copy)
> @@ -155,6 +155,8 @@
>  
>        reporter.setStatus("wrote " + name);
>      }
> +    
> +    public void finished() {}
>    }
>  
>    public static void writeTest(NutchFileSystem fs, boolean fastCheck)
> @@ -247,6 +249,9 @@
>  
>        reporter.setStatus("read " + name);
>      }
> +    
> +    public void finished() {}
> +    
>    }
>  
>    public static void readTest(NutchFileSystem fs, boolean fastCheck)
> @@ -339,6 +344,9 @@
>          in.close();
>        }
>      }
> +    
> +    public void finished() {}
> +    
>    }
>  
>    public static void seekTest(NutchFileSystem fs, boolean fastCheck)
> Index: src/java/org/apache/nutch/indexer/DeleteDuplicates.java
> ===================================================================
> --- src/java/org/apache/nutch/indexer/DeleteDuplicates.java	(revision 374776)
> +++ src/java/org/apache/nutch/indexer/DeleteDuplicates.java	(working copy)
> @@ -225,6 +225,7 @@
>          }
>        }
>      }
> +    public void finished() {}
>    }
>      
>    private NutchFileSystem fs;
> @@ -265,6 +266,8 @@
>        reader.close();
>      }
>    }
> +  
> +  public void finished() {}
>  
>    /** Write nothing. */
>    public RecordWriter getRecordWriter(final NutchFileSystem fs,
> Index: src/java/org/apache/nutch/indexer/Indexer.java
> ===================================================================
> --- src/java/org/apache/nutch/indexer/Indexer.java	(revision 374778)
> +++ src/java/org/apache/nutch/indexer/Indexer.java	(working copy)
> @@ -227,6 +227,8 @@
>  
>      output.collect(key, new ObjectWritable(doc));
>    }
> +  
> +  public void finished() {}
>  
>    public void index(File indexDir, File crawlDb, File linkDb, File[] segments)
>      throws IOException {
> Index: src/java/org/apache/nutch/segment/SegmentReader.java
> ===================================================================
> --- src/java/org/apache/nutch/segment/SegmentReader.java	(revision 374778)
> +++ src/java/org/apache/nutch/segment/SegmentReader.java	(working copy)
> @@ -143,7 +143,9 @@
>      }
>      output.collect(key, new ObjectWritable(dump.toString()));
>    }
> -
> +  
> +  public void finished() {}
> +  
>    public void reader(File segment) throws IOException {
>      LOG.info("Reader: segment: " + segment);
>  
> Index: src/java/org/apache/nutch/mapred/Mapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/Mapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/Mapper.java	(working copy)
> @@ -39,4 +39,9 @@
>    void map(WritableComparable key, Writable value,
>             OutputCollector output, Reporter reporter)
>      throws IOException;
> +
> +  /** Called after the last {@link #map} call on this Mapper object.
> +      Typical implementations do nothing.
> +  */
> +  void finished();
>  }
> Index: src/java/org/apache/nutch/mapred/lib/RegexMapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/RegexMapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/RegexMapper.java	(working copy)
> @@ -53,4 +53,5 @@
>        output.collect(new UTF8(matcher.group(group)), new LongWritable(1));
>      }
>    }
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/InverseMapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/InverseMapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/InverseMapper.java	(working copy)
> @@ -38,4 +38,6 @@
>      throws IOException {
>      output.collect((WritableComparable)value, key);
>    }
> +
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/IdentityReducer.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/IdentityReducer.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/IdentityReducer.java	(working copy)
> @@ -42,4 +42,5 @@
>      }
>    }
>  
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/IdentityMapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/IdentityMapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/IdentityMapper.java	(working copy)
> @@ -39,4 +39,5 @@
>      output.collect(key, val);
>    }
>  
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/LongSumReducer.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/LongSumReducer.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/LongSumReducer.java	(working copy)
> @@ -47,4 +47,6 @@
>      // output sum
>      output.collect(key, new LongWritable(sum));
>    }
> +
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/lib/TokenCountMapper.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/lib/TokenCountMapper.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/lib/TokenCountMapper.java	(working copy)
> @@ -50,4 +50,6 @@
>        output.collect(new UTF8(st.nextToken()), new LongWritable(1));
>      }
>    }
> +
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/mapred/ReduceTask.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/ReduceTask.java	(revision 374781)
> +++ src/java/org/apache/nutch/mapred/ReduceTask.java	(working copy)
> @@ -275,6 +275,7 @@
>        }
>  
>      } finally {
> +      reducer.finished();
>        in.close();
>        lfs.delete(new File(sortedFile));           // remove sorted
>        out.close(reporter);
> Index: src/java/org/apache/nutch/mapred/MapTask.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/MapTask.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/MapTask.java	(working copy)
> @@ -50,7 +50,7 @@
>    public void write(DataOutput out) throws IOException {
>      super.write(out);
>      split.write(out);
> -    
> +
>    }
>    public void readFields(DataInput in) throws IOException {
>      super.readFields(in);
> @@ -126,6 +126,10 @@
>          }
>  
>        } finally {
> +        if (combining) {
> +          ((CombiningCollector)collector).finished();
> +        }
> +
>          in.close();                               // close input
>        }
>      } finally {
> @@ -147,5 +151,5 @@
>    public NutchConf getConf() {
>      return this.nutchConf;
>    }
> -  
> +
>  }
> Index: src/java/org/apache/nutch/mapred/MapRunner.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/MapRunner.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/MapRunner.java	(working copy)
> @@ -38,18 +38,22 @@
>    public void run(RecordReader input, OutputCollector output,
>                    Reporter reporter)
>      throws IOException {
> -    while (true) {
> -      // allocate new key & value instances
> -      WritableComparable key =
> -        (WritableComparable)job.newInstance(inputKeyClass);
> -      Writable value = (Writable)job.newInstance(inputValueClass);
> +    try {
> +      while (true) {
> +        // allocate new key & value instances
> +        WritableComparable key =
> +          (WritableComparable)job.newInstance(inputKeyClass);
> +        Writable value = (Writable)job.newInstance(inputValueClass);
>  
> -      // read next key & value
> -      if (!input.next(key, value))
> -        return;
> +        // read next key & value
> +        if (!input.next(key, value))
> +          return;
>  
> -      // map pair to output
> -      mapper.map(key, value, output, reporter);
> +        // map pair to output
> +        mapper.map(key, value, output, reporter);
> +      }
> +    } finally {
> +        mapper.finished();
>      }
>    }
>  
> Index: src/java/org/apache/nutch/mapred/CombiningCollector.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/CombiningCollector.java	(revision 374780)
> +++ src/java/org/apache/nutch/mapred/CombiningCollector.java	(working copy)
> @@ -78,4 +78,9 @@
>      count = 0;
>    }
>  
> +  public synchronized void finished()
> +  {
> +    combiner.finished();
> +  }
> +
>  }
> Index: src/java/org/apache/nutch/mapred/Reducer.java
> ===================================================================
> --- src/java/org/apache/nutch/mapred/Reducer.java	(revision 374737)
> +++ src/java/org/apache/nutch/mapred/Reducer.java	(working copy)
> @@ -38,4 +38,10 @@
>    void reduce(WritableComparable key, Iterator values,
>                OutputCollector output, Reporter reporter)
>      throws IOException;
> +
> +  /** Called after the last {@link #reduce} call on this Reducer object.
> +      Typical implementations do nothing.
> +  */
> +  void finished();
> +
>  }
> Index: src/java/org/apache/nutch/crawl/CrawlDbReader.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/CrawlDbReader.java	(revision 374737)
> +++ src/java/org/apache/nutch/crawl/CrawlDbReader.java	(working copy)
> @@ -50,9 +50,9 @@
>  
>  /**
>   * Read utility for the CrawlDB.
> - * 
> + *
>   * @author Andrzej Bialecki
> - * 
> + *
>   */
>  public class CrawlDbReader {
>  
> @@ -68,6 +68,7 @@
>        output.collect(new UTF8("retry"), new LongWritable(cd.getRetriesSinceFetch()));
>        output.collect(new UTF8("score"), new LongWritable((long) (cd.getScore() * 1000.0)));
>      }
> +    public void finished() {}
>    }
>  
>    public static class CrawlDbStatReducer implements Reducer {
> @@ -121,6 +122,7 @@
>          output.collect(new UTF8("avg score"), new LongWritable(total / cnt));
>        }
>      }
> +    public void finished() {}
>    }
>  
>    public static class CrawlDbDumpReducer implements Reducer {
> @@ -133,8 +135,11 @@
>  
>      public void configure(JobConf job) {
>      }
> +
> +    public void finished() {
> +    }
>    }
> -  
> +
>    public void processStatJob(String crawlDb, NutchConf config) throws IOException {
>      LOG.info("CrawlDb statistics start: " + crawlDb);
>      File tmpFolder = new File(crawlDb, "stat_tmp" + System.currentTimeMillis());
> @@ -219,7 +224,7 @@
>        System.out.println("not found");
>      }
>    }
> -  
> +
>    public void processDumpJob(String crawlDb, String output, NutchConf config) throws IOException {
>  
>      LOG.info("CrawlDb dump: starting");
> @@ -270,4 +275,5 @@
>      }
>      return;
>    }
> +
>  }
> Index: src/java/org/apache/nutch/crawl/LinkDb.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/LinkDb.java	(revision 374779)
> +++ src/java/org/apache/nutch/crawl/LinkDb.java	(working copy)
> @@ -118,7 +118,8 @@
>      output.collect(key, result);
>    }
>  
> -
> +  public void finished() {}
> +	
>    public void invert(File linkDb, File segmentsDir) throws IOException {
>      LOG.info("LinkDb: starting");
>      LOG.info("LinkDb: linkdb: " + linkDb);
> Index: src/java/org/apache/nutch/crawl/Injector.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/Injector.java	(revision 374779)
> +++ src/java/org/apache/nutch/crawl/Injector.java	(working copy)
> @@ -65,6 +65,8 @@
>                                               interval));
>        }
>      }
> +    
> +    public void finished() {}
>    }
>  
>    /** Combine multiple new entries for a url. */
> @@ -76,6 +78,7 @@
>        throws IOException {
>        output.collect(key, (Writable)values.next()); // just collect first value
>      }
> +    public void finished() {}
>    }
>  
>    /** Construct an Injector. */
> Index: src/java/org/apache/nutch/crawl/Generator.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/Generator.java	(revision 374779)
> +++ src/java/org/apache/nutch/crawl/Generator.java	(working copy)
> @@ -63,6 +63,8 @@
>        output.collect(crawlDatum, key);          // invert for sort by score
>      }
>  
> +    public void finished() {}
> +    
>      /** Partition by host (value). */
>      public int getPartition(WritableComparable key, Writable value,
>                              int numReduceTasks) {
> Index: src/java/org/apache/nutch/crawl/CrawlDbReducer.java
> ===================================================================
> --- src/java/org/apache/nutch/crawl/CrawlDbReducer.java	(revision 374781)
> +++ src/java/org/apache/nutch/crawl/CrawlDbReducer.java	(working copy)
> @@ -115,4 +115,5 @@
>      }
>    }
>  
> +  public void finished() {}
>  }
> Index: src/java/org/apache/nutch/parse/ParseSegment.java
> ===================================================================
> --- src/java/org/apache/nutch/parse/ParseSegment.java	(revision 374776)
> +++ src/java/org/apache/nutch/parse/ParseSegment.java	(working copy)
> @@ -78,6 +78,8 @@
>      throws IOException {
>      output.collect(key, (Writable)values.next()); // collect first value
>    }
> +  
> +  public void finished() {}
>  
>    public void parse(File segment) throws IOException {
>      LOG.info("Parse: starting");

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:46 2006
Return-Path: 
 <hadoop-dev-return-995-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85655 invoked from network); 24 Apr 2006 23:13:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:46 -0000
Received: (qmail 38605 invoked by uid 500); 24 Apr 2006 23:13:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38497 invoked by uid 500); 24 Apr 2006 23:13:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38452 invoked by uid 99); 24 Apr 2006 23:13:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:38 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1B60741000B
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:16 +0000 (GMT)
Message-ID: <22533841.1145920336087.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:16 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-21) the webapps need to be updated for the
 move from nutch
In-Reply-To: <1903777814.1139253238270.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-21?page=all ]
     
Doug Cutting closed HADOOP-21:
------------------------------


> the webapps need to be updated for the move from nutch
> ------------------------------------------------------
>
>          Key: HADOOP-21
>          URL: http://issues.apache.org/jira/browse/HADOOP-21
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1.0
>  Attachments: webapps-move-2.patch, webapps-move.patch
>
> The webapp files need to be updated so that the reference the new packages. I'll include a patch to fix it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:49 2006
Return-Path: 
 <hadoop-dev-return-998-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85771 invoked from network); 24 Apr 2006 23:13:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:49 -0000
Received: (qmail 39135 invoked by uid 500); 24 Apr 2006 23:13:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38937 invoked by uid 500); 24 Apr 2006 23:13:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38865 invoked by uid 99); 24 Apr 2006 23:13:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:39 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D0E13410012
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:17 +0000 (GMT)
Message-ID: <8278359.1145920337852.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-25) a new map/reduce example and moving the
 examples from src/java to src/examples
In-Reply-To: <187621972.1139267817333.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-25?page=all ]
     
Doug Cutting closed HADOOP-25:
------------------------------


> a new map/reduce example and moving the examples from src/java to src/examples
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-25
>          URL: http://issues.apache.org/jira/browse/HADOOP-25
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Owen O'Malley
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1.0
>  Attachments: examples-2.patch, examples-3.patch, examples.patch, find-jar.patch, tar-name-fix.patch
>
> The new example is the word count example from Google's paper. I moved the examples into a separate jar file to demonstrate how to run stand-alone application code.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:46 2006
Return-Path: 
 <hadoop-dev-return-996-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85646 invoked from network); 24 Apr 2006 23:13:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:46 -0000
Received: (qmail 38658 invoked by uid 500); 24 Apr 2006 23:13:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38563 invoked by uid 500); 24 Apr 2006 23:13:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38470 invoked by uid 99); 24 Apr 2006 23:13:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:38 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 07212410011
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:17 +0000 (GMT)
Message-ID: <9566971.1145920337026.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-22) remove unused imports
In-Reply-To: <1779983253.1139254446079.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-22?page=all ]
     
Doug Cutting closed HADOOP-22:
------------------------------


> remove unused imports
> ---------------------
>
>          Key: HADOOP-22
>          URL: http://issues.apache.org/jira/browse/HADOOP-22
>      Project: Hadoop
>         Type: Bug

>     Reporter: Sami Siren
>     Priority: Trivial
>      Fix For: 0.1.0
>  Attachments: hadoop-remove-imports.txt
>
> Following patch will remove unused imports from java source files

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:47 2006
Return-Path: 
 <hadoop-dev-return-997-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85673 invoked from network); 24 Apr 2006 23:13:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:47 -0000
Received: (qmail 38988 invoked by uid 500); 24 Apr 2006 23:13:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38906 invoked by uid 500); 24 Apr 2006 23:13:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38860 invoked by uid 99); 24 Apr 2006 23:13:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:39 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6D7E7410013
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:19 +0000 (GMT)
Message-ID: <5534903.1145920339436.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:19 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-28) webapps broken
In-Reply-To: <2105821548.1139420592025.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-28?page=all ]
     
Doug Cutting closed HADOOP-28:
------------------------------


> webapps broken
> --------------
>
>          Key: HADOOP-28
>          URL: http://issues.apache.org/jira/browse/HADOOP-28
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Owen O'Malley
>      Fix For: 0.1.0
>  Attachments: jspc.patch
>
> Changing the classes to private broke the webapps. 
> The required public classes are:
> org.apache.hadoop.mapred.JobInProgress
> org.apache.hadoop.mapred.JobProfile
> org.apache.hadoop.mapred.JobStatus
> org.apache.hadoop.mapred.TaskTrackerStatus
> To fix, we need one of:
>   1. The classes need to be made public again
>   2. The functionality needs to be made available through the classes that are public
>   3. The webapps need to move into the mapred package.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:49 2006
Return-Path: 
 <hadoop-dev-return-999-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85770 invoked from network); 24 Apr 2006 23:13:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:49 -0000
Received: (qmail 39174 invoked by uid 500); 24 Apr 2006 23:13:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39045 invoked by uid 500); 24 Apr 2006 23:13:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38921 invoked by uid 99); 24 Apr 2006 23:13:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:40 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C3094410015
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:20 +0000 (GMT)
Message-ID: <25124374.1145920340796.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:20 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-30) DFS shell: support for ls -r and cat
In-Reply-To: <1717747145.1139526955947.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-30?page=all ]
     
Doug Cutting closed HADOOP-30:
------------------------------


> DFS shell: support for ls -r and cat
> ------------------------------------
>
>          Key: HADOOP-30
>          URL: http://issues.apache.org/jira/browse/HADOOP-30
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Michel Tourn
>      Fix For: 0.1.0
>  Attachments: lsrcat.patch
>
> patch attached

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:47 2006
Return-Path: 
 <hadoop-dev-return-1000-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85675 invoked from network); 24 Apr 2006 23:13:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:47 -0000
Received: (qmail 39211 invoked by uid 500); 24 Apr 2006 23:13:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39093 invoked by uid 500); 24 Apr 2006 23:13:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38933 invoked by uid 99); 24 Apr 2006 23:13:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:42 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:40 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B47E5410017
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:21 +0000 (GMT)
Message-ID: <26961114.1145920341736.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:21 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-34) Build Paths Relative to PWD in build.xml
In-Reply-To: <441910403.1139850086186.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-34?page=all ]
     
Doug Cutting closed HADOOP-34:
------------------------------


> Build Paths Relative to PWD in build.xml
> ----------------------------------------
>
>          Key: HADOOP-34
>          URL: http://issues.apache.org/jira/browse/HADOOP-34
>      Project: Hadoop
>         Type: Bug

>  Environment: Fedora Core 4
>     Reporter: Jeremy Bensley
>     Priority: Trivial
>      Fix For: 0.1.0
>  Attachments: hadoop.build.xml.patch
>
> In the build.xml file, many paths are defined in terms of the present working directory (PWD) instead of relative to the location of the build.xml. Thus, whenever trying to compile from a directory other than the hadoop root, errors such as this appear:
> BUILD FAILED
> /home/jeremy/cvs/hadoop/build.xml:109: org.apache.jasper.JasperException: The -uriroot option must specify a pre-existing directory
> I have scripts / vim parameters that connect to other machines for compiling using ssh, and am not necessarily always in the root whenever I compile.
> I am attaching a patch which sets all paths relative to ${basedir}, and removes the override of ${basedir} to the PWD. Please let me know if there are reasons why the build environment must be relative to the working directory.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:13:49 2006
Return-Path: 
 <hadoop-dev-return-1001-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85775 invoked from network); 24 Apr 2006 23:13:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:13:49 -0000
Received: (qmail 39442 invoked by uid 500); 24 Apr 2006 23:13:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39393 invoked by uid 500); 24 Apr 2006 23:13:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39306 invoked by uid 99); 24 Apr 2006 23:13:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:43 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:13:41 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8D647410016
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:12:22 +0000 (GMT)
Message-ID: <32555569.1145920342576.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:12:22 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-36) Adding some uniformity/convenience to
 environment management
In-Reply-To: <630345415.1139861112665.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-36?page=all ]
     
Doug Cutting closed HADOOP-36:
------------------------------


> Adding some uniformity/convenience to environment management
> ------------------------------------------------------------
>
>          Key: HADOOP-36
>          URL: http://issues.apache.org/jira/browse/HADOOP-36
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Bryan Pendleton
>      Fix For: 0.1.0

>
> Currently, "slaves" are loaded from ~/.slaves. What would be better would be to default from something like conf/hadoop-slaves
> Perhaps split slaves, having a different set for "datanodes" vs. "tasktracker" nodes. ie, conf/hadoop-slaves-tasktracker, conf/hadoop-slaves-datanodes, or some similar split. There's the possibility it's worth building in the assumption that tasktracker is a superset, and thus implicitly includes datanodes, but this might be a bad assumption.
> Also, make sure all scripts source something like conf/hadoop-env.sh. Thus, the user can edit hadoop-env.sh to specify JAVA_HOME, or an alternate HADOOP_SLAVES location. It would also be desirable to have a seed CLASSPATH here. Possibly name it HADOOP_CLASSPATH, to make it explicit and not make hadoop scripts possibly interact with an otherwise-set system CLASSPATH variable.
> These changes would probably be useful to the nutch project, too.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:15:16 2006
Return-Path: 
 <hadoop-dev-return-1002-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86277 invoked from network); 24 Apr 2006 23:15:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:15:16 -0000
Received: (qmail 41033 invoked by uid 500); 24 Apr 2006 23:15:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40916 invoked by uid 500); 24 Apr 2006 23:15:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40906 invoked by uid 99); 24 Apr 2006 23:15:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 713627142BF
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:14:06 +0000 (GMT)
Message-ID: <3395995.1145920446461.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:14:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-37) A way to determine the size and overall
 activity of the cluster
In-Reply-To: <836056018.1139904729007.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-37?page=all ]
     
Doug Cutting closed HADOOP-37:
------------------------------


> A way to determine the size and overall activity of the cluster
> ---------------------------------------------------------------
>
>          Key: HADOOP-37
>          URL: http://issues.apache.org/jira/browse/HADOOP-37
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Owen O'Malley
>      Fix For: 0.1.0
>  Attachments: cluster-status.patch
>
> There is currently no way for an application to determine the size or activity of the cluster.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:15:17 2006
Return-Path: 
 <hadoop-dev-return-1003-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86293 invoked from network); 24 Apr 2006 23:15:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:15:17 -0000
Received: (qmail 41073 invoked by uid 500); 24 Apr 2006 23:15:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41043 invoked by uid 500); 24 Apr 2006 23:15:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40989 invoked by uid 99); 24 Apr 2006 23:15:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D2B967142C0
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:14:06 +0000 (GMT)
Message-ID: <5164097.1145920446860.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:14:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-38) default splitter should incorporate fs
 block size
In-Reply-To: <1089400937.1139945203207.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-38?page=all ]
     
Doug Cutting closed HADOOP-38:
------------------------------


> default splitter should incorporate fs block size
> -------------------------------------------------
>
>          Key: HADOOP-38
>          URL: http://issues.apache.org/jira/browse/HADOOP-38
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Doug Cutting
>      Fix For: 0.1.0

>
> By default, the file splitting code should operate as follows.
>   inputs are <file>*, numMapTasks, minSplitSize, fsBlockSize
>   output is <file,start,length>*
>   totalSize = sum of all file sizes;
>   desiredSplitSize = totalSize / numMapTasks;
>   if (desiredSplitSize > fsBlockSize)             /* new */
>     desiredSplitSize = fsBlockSize;
>   if (desiredSplitSize < minSplitSize)
>     desiredSplitSize = minSplitSize;
>   chop input files into desiredSplitSize chunks & return them
> In other words, the numMapTasks is a desired minimum.  We'll try to chop input into at least numMapTasks chunks, each ideally a single fs block.
> If there's not enough input data to create numMapTasks tasks, each with an entire block, then we'll permit tasks whose input is smaller than a filesystem block, down to a minimum split size.
> This handles cases where:
>   - each input record takes a lot of time to process.  In this case we want to make sure we use all of the cluster.  Thus it is important to permit splits smaller than the fs block size.
>   - input i/o dominates.  In this case we want to permit the placement of tasks on hosts where their data is local.  This is only possible if splits are fs block size or smaller.
> Are there other common cases that this algorithm does not handle well?
> The part marked 'new' above is not currently implemented, but I'd like to add it.
> Does this sound reasonble?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:15:18 2006
Return-Path: 
 <hadoop-dev-return-1004-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86325 invoked from network); 24 Apr 2006 23:15:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:15:18 -0000
Received: (qmail 41197 invoked by uid 500); 24 Apr 2006 23:15:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41177 invoked by uid 500); 24 Apr 2006 23:15:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41168 invoked by uid 99); 24 Apr 2006 23:15:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 12BB4410006
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:14:08 +0000 (GMT)
Message-ID: <25341089.1145920448074.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:14:08 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-49) JobClient cannot use a non-default
 server (unlike DFSShell)
In-Reply-To: <475642315.1140560804678.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-49?page=all ]
     
Doug Cutting closed HADOOP-49:
------------------------------


> JobClient cannot use a non-default server (unlike DFSShell)
> -----------------------------------------------------------
>
>          Key: HADOOP-49
>          URL: http://issues.apache.org/jira/browse/HADOOP-49
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Michel Tourn
>     Assignee: Michel Tourn
>      Fix For: 0.1.0
>  Attachments: jcjt.patch
>
> JobClient cannot use a non-default Job Tracker server:
> It will use the Job Tracker specified in conf/hadoop-default.xml or conf/hadoop-site.xml
> For users with multiple Hadoop systems, it is useful to be able to specify the Job Tracker.
> Other hadoop command-line tools like DFSShell already have:
> >bin/hadoop dfs
> Usage: java DFSShell [-local | -dfs <namenode:port>]  ...
> Similarly I propose to add a -jt parameter:
> >bin/hadoop job
> JobClient -submit <job> | -status <id> | -kill <id> [-jt <jobtracker:port>|<config>]
> Where: -jt <jobtracker:port> is similar to -dfs <namenode:port>
> And:  -jt <config> will load as a final resource: hadoop-<config>.xml
> The latter syntax is discoverable by users because on failure the tool will say:
> >bin/hadoop job -kill m7n6pi -jt unknown
> Exception in thread "main" java.lang.RuntimeException: hadoop-unknown.xml not found on CLASSPATH
> Or in case of success:
> >bin/hadoop job -kill job_m7n6pi -jt myconfig
> 060221 221911 parsing file:/trunk/conf/hadoop-default.xml
> 060221 221911 parsing file:/trunk/conf/hadoop-myconfig.xml
> 060221 221911 parsing file:/trunk/conf/hadoop-site.xml
> 060221 221911 Client connection to 66.196.91.10:7020: starting
> And with a machine:port spec:
> >bin/hadoop job -kill job_m7n6pi -jt machine:8020
> 060221 222109 parsing file:/trunk/conf/hadoop-default.xml
> 060221 222109 parsing file:/trunk/conf/hadoop-site.xml
> 060221 222109 Client connection to 66.196.91.10:8020: starting
> Patch attached.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:15:19 2006
Return-Path: 
 <hadoop-dev-return-1005-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86353 invoked from network); 24 Apr 2006 23:15:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:15:19 -0000
Received: (qmail 41344 invoked by uid 500); 24 Apr 2006 23:15:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41309 invoked by uid 500); 24 Apr 2006 23:15:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41300 invoked by uid 99); 24 Apr 2006 23:15:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 48B4C410009
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:14:09 +0000 (GMT)
Message-ID: <27144398.1145920449295.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:14:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-83) infinite retries accessing a missing
 block
In-Reply-To: <671256830.1142449198957.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-83?page=all ]
     
Doug Cutting closed HADOOP-83:
------------------------------


> infinite retries accessing a missing block
> ------------------------------------------
>
>          Key: HADOOP-83
>          URL: http://issues.apache.org/jira/browse/HADOOP-83
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>      Fix For: 0.1.0

>
> A file in the DFS got corrupted - the reason for that is unknown, but might be justified.
> when accessing the file, I get an infinite stream of error messages from the client - attached below.
> The client aparently increments an error counter, but never checks it.
> Correct behaviour is for the client to retry a few times, then abort.
> 060315 105436 No node available for block blk_2690692619196463439
> 060315 105436 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105446 No node available for block blk_2690692619196463439
> 060315 105446 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105456 No node available for block blk_2690692619196463439
> 060315 105456 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105506 No node available for block blk_2690692619196463439
> 060315 105506 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105516 No node available for block blk_2690692619196463439
> 060315 105516 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105526 No node available for block blk_2690692619196463439
> 060315 105526 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105536 No node available for block blk_2690692619196463439
> 060315 105536 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105546 No node available for block blk_2690692619196463439
> 060315 105546 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105556 No node available for block blk_2690692619196463439
> 060315 105556 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105606 No node available for block blk_2690692619196463439
> 060315 105606 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105616 No node available for block blk_2690692619196463439
> 060315 105616 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105626 No node available for block blk_2690692619196463439
> 060315 105626 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105636 No node available for block blk_2690692619196463439
> 060315 105636 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105646 No node available for block blk_2690692619196463439
> 060315 105646 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105657 No node available for block blk_2690692619196463439
> 060315 105657 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105707 No node available for block blk_2690692619196463439
> 060315 105707 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105717 No node available for block blk_2690692619196463439
> 060315 105717 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105727 No node available for block blk_2690692619196463439
> 060315 105727 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105737 No node available for block blk_2690692619196463439
> 060315 105737 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105747 No node available for block blk_2690692619196463439
> 060315 105747 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105757 No node available for block blk_2690692619196463439
> 060315 105757 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105807 No node available for block blk_2690692619196463439
> 060315 105807 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105817 No node available for block blk_2690692619196463439

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:15:20 2006
Return-Path: 
 <hadoop-dev-return-1006-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86377 invoked from network); 24 Apr 2006 23:15:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:15:20 -0000
Received: (qmail 41472 invoked by uid 500); 24 Apr 2006 23:15:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41452 invoked by uid 500); 24 Apr 2006 23:15:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41443 invoked by uid 99); 24 Apr 2006 23:15:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:15:19 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2B39541000C
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:14:10 +0000 (GMT)
Message-ID: <19229541.1145920450174.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:14:10 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-97) DFSShell.cat returns
 NullPointerException if file does not exist
In-Reply-To: <280002880.1142972879134.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-97?page=all ]
     
Doug Cutting closed HADOOP-97:
------------------------------


> DFSShell.cat returns NullPointerException if file does not exist
> ----------------------------------------------------------------
>
>          Key: HADOOP-97
>          URL: http://issues.apache.org/jira/browse/HADOOP-97
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.1.0
>  Attachments: DFSShell.patch
>
> DFSShell.cat crashes with a NullPointerException if file to be displayed does not exist.
> The bug is fixed in the attached patch, and the general exception handling in main() is added.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Apr 24 23:19:41 2006
Return-Path: 
 <hadoop-dev-return-1007-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87481 invoked from network); 24 Apr 2006 23:19:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:19:41 -0000
Received: (qmail 44992 invoked by uid 500); 24 Apr 2006 23:19:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44969 invoked by uid 500); 24 Apr 2006 23:19:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44960 invoked by uid 99); 24 Apr 2006 23:19:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:19:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:19:39 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3ONJEZL016219
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 19:19:15 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3ONJ8TR169642;
	Mon, 24 Apr 2006 19:19:13 -0400
Message-ID: <444D5CEB.6000401@apache.org>
Date: Mon, 24 Apr 2006 16:19:07 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: sorry for jira spam!
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Sorry for the jira spam.  I was cleaning out old bugs, things that had 
been fixed in the 0.1 release but never closed.  The next version of 
Jira will let one turn off notifications for bulk changes like this. 
Right now you need to (quickly) turn them off for the whole project, 
make the bulk change, then turn notifications back on.  I forgot to do 
that.  Again, sorry!

Doug

From MAILER-DAEMON Mon Apr 24 23:25:16 2006
Return-Path: 
 <hadoop-dev-return-1008-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91085 invoked from network); 24 Apr 2006 23:25:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Apr 2006 23:25:16 -0000
Received: (qmail 53637 invoked by uid 500); 24 Apr 2006 23:25:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53619 invoked by uid 500); 24 Apr 2006 23:25:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53607 invoked by uid 99); 24 Apr 2006 23:25:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:25:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 16:25:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 697937142BF
	for <hadoop-dev@lucene.apache.org>; Mon, 24 Apr 2006 23:24:06 +0000 (GMT)
Message-ID: <7088333.1145921046429.JavaMail.jira@brutus>
Date: Mon, 24 Apr 2006 23:24:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-162) concurrent modification exception in
 FSNamesystem.Lease.releaseLocks
In-Reply-To: <8417678.1145908505815.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-162?page=all ]
     
Doug Cutting resolved HADOOP-162:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Owen.

> concurrent modification exception in FSNamesystem.Lease.releaseLocks
> --------------------------------------------------------------------
>
>          Key: HADOOP-162
>          URL: http://issues.apache.org/jira/browse/HADOOP-162
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: concurrent-mod-lease.patch
>
> FSNameSystem.Lease.releaseLocks iterates through the creates set, calling InternalReleaseCreate on each element, which changes the creates set in the Lease. This causes a ConcurrentModificationException if you have more than two files that are owned by the lease that times out.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 01:38:17 2006
Return-Path: 
 <hadoop-dev-return-1009-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43953 invoked from network); 25 Apr 2006 01:38:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 01:38:17 -0000
Received: (qmail 97066 invoked by uid 500); 25 Apr 2006 01:38:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97040 invoked by uid 500); 25 Apr 2006 01:38:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97030 invoked by uid 99); 25 Apr 2006 01:38:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 18:38:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 18:38:15 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 78E457142BF
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 01:37:06 +0000 (GMT)
Message-ID: <11912258.1145929026486.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 01:37:06 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]

David Bowen updated HADOOP-132:
-------------------------------

    Attachment: metrics.patch

OK, here is an updated version of the patch with the code made uglier and less robust so as to accommodate people who perversely insist on running with JDK 1.4.  Also, I added a note to CHANGES.txt.


> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Versions: 0.2
>     Reporter: David Bowen
>      Fix For: 0.2
>  Attachments: javadoc.tgz, javadoc.tgz, metrics.patch, metrics.patch
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 01:41:18 2006
Return-Path: 
 <hadoop-dev-return-1010-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45316 invoked from network); 25 Apr 2006 01:41:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 01:41:18 -0000
Received: (qmail 1569 invoked by uid 500); 25 Apr 2006 01:41:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1508 invoked by uid 500); 25 Apr 2006 01:41:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1475 invoked by uid 99); 25 Apr 2006 01:41:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 18:41:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 18:41:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7ECB27142C0
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 01:40:07 +0000 (GMT)
Message-ID: <24897141.1145929207516.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 01:40:07 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]

David Bowen updated HADOOP-132:
-------------------------------

    Attachment:     (was: metrics.patch)

> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Versions: 0.2
>     Reporter: David Bowen
>      Fix For: 0.2
>  Attachments: javadoc.tgz, javadoc.tgz, metrics.patch
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 01:41:19 2006
Return-Path: 
 <hadoop-dev-return-1011-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45397 invoked from network); 25 Apr 2006 01:41:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 01:41:19 -0000
Received: (qmail 1764 invoked by uid 500); 25 Apr 2006 01:41:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1740 invoked by uid 500); 25 Apr 2006 01:41:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1717 invoked by uid 99); 25 Apr 2006 01:41:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 18:41:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 18:41:17 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C5E7D7142BF
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 01:40:08 +0000 (GMT)
Message-ID: <395732.1145929208808.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 01:40:08 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]

David Bowen updated HADOOP-132:
-------------------------------

    Attachment:     (was: metrics.patch)

> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Versions: 0.2
>     Reporter: David Bowen
>      Fix For: 0.2
>  Attachments: javadoc.tgz, javadoc.tgz
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 01:43:17 2006
Return-Path: 
 <hadoop-dev-return-1012-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45855 invoked from network); 25 Apr 2006 01:43:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 01:43:17 -0000
Received: (qmail 2485 invoked by uid 500); 25 Apr 2006 01:43:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2369 invoked by uid 500); 25 Apr 2006 01:43:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2360 invoked by uid 99); 25 Apr 2006 01:43:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 18:43:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 18:43:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4B4137142A6
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 01:42:07 +0000 (GMT)
Message-ID: <10333868.1145929327305.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 01:42:07 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]

David Bowen updated HADOOP-132:
-------------------------------

    Attachment: metrics.patch

Woops, forgot to update CHANGES.txt before modifying it. 

> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Versions: 0.2
>     Reporter: David Bowen
>      Fix For: 0.2
>  Attachments: javadoc.tgz, javadoc.tgz, metrics.patch
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 02:27:23 2006
Return-Path: 
 <hadoop-dev-return-1013-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63559 invoked from network); 25 Apr 2006 02:27:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 02:27:23 -0000
Received: (qmail 37373 invoked by uid 500); 25 Apr 2006 02:27:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36921 invoked by uid 500); 25 Apr 2006 02:27:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36904 invoked by uid 99); 25 Apr 2006 02:27:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 19:27:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Apr 2006 19:27:21 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 24E8B7142A6
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 02:26:12 +0000 (GMT)
Message-ID: <28250876.1145931972148.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 02:26:12 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-132) An API for reporting performance
 metrics
In-Reply-To: <36182056.1144959180230.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-132?page=all ]
     
Doug Cutting resolved HADOOP-132:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, David!

> An API for reporting performance metrics
> ----------------------------------------
>
>          Key: HADOOP-132
>          URL: http://issues.apache.org/jira/browse/HADOOP-132
>      Project: Hadoop
>         Type: New Feature

>     Versions: 0.2
>     Reporter: David Bowen
>      Fix For: 0.2
>  Attachments: javadoc.tgz, javadoc.tgz, metrics.patch
>
> I'd like to propose adding an API for reporting performance metrics.  I will post some javadoc as soon as I figure out how to do so.  The idea is for the API to be sufficiently abstract that various different implementations can be plugged in.  In particular, there would be one that just writes the metric data to a file, and another that sends metrics to Ganglia.  It would also be possible to plug in an implementation that can support high-frequency (say, per-second) sending of fairly large amounts of data (up to hundreds of metrics) across the network.
> I'd be very interested in people's thoughts about what the requirements should be for such an API.
> - David Bowen

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 16:35:29 2006
Return-Path: 
 <hadoop-dev-return-1014-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16664 invoked from network); 25 Apr 2006 16:35:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 16:35:29 -0000
Received: (qmail 66876 invoked by uid 500); 25 Apr 2006 16:35:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66851 invoked by uid 500); 25 Apr 2006 16:35:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66838 invoked by uid 99); 25 Apr 2006 16:35:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 09:35:28 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 09:35:27 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A6B547142BF
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 16:34:17 +0000 (GMT)
Message-ID: <28414302.1145982857680.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 16:34:17 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-165) long response times from task trackers
 under load
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

long response times from task trackers under load
-------------------------------------------------

         Key: HADOOP-165
         URL: http://issues.apache.org/jira/browse/HADOOP-165
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2    
 Environment: 190 redhat linux boxes, each with 2 hyperthreaded cpus, 2gb memory
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


we are seeing very slow response times from the task tracker. I put in some instrumentation to measure how long each call took for the RPC.Sever code to run the method (so it does not include serialization/deserialization time). The top of the list (in ms) looks like:

7581 progress node1192
7022 ping node1192
5393 ping node1162
4854 progress node1162
4749 progress node1194
4709 ping node1194
3813 ping node1100
3486 ping node1190
3266 progress node1190
3187 progress node1265
3078 ping node1203
2972 progress node1203
2947 progress node1240
2889 progress node1100
2875 ping node1116
2843 ping node1189
2772 ping node1183
2737 ping node1110
2727 progress node1183
2710 ping node1123
2563 ping node1304
2527 progress node1144
2479 ping node1137
2476 progress node1304
2430 ping node1240
2416 ping node1144
2377 progress node1176
2339 ping node1109
2321 progress node1114
2311 ping node1157
2185 ping node1265
2185 ping node1109
2172 ping node1114
2145 progress node1109
2127 ping node1176
2083 progress node1189
2076 ping node1229
2073 progress node1188
2072 progress node1123
2048 ping node1161
2003 progress node1110
1989 ping node1180
1963 ping node1114


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 16:49:26 2006
Return-Path: 
 <hadoop-dev-return-1015-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23132 invoked from network); 25 Apr 2006 16:49:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 16:49:26 -0000
Received: (qmail 87157 invoked by uid 500); 25 Apr 2006 16:49:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87042 invoked by uid 500); 25 Apr 2006 16:49:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87026 invoked by uid 99); 25 Apr 2006 16:49:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 09:49:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 09:49:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BFF227142BB
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 16:48:08 +0000 (GMT)
Message-ID: <4456205.1145983688783.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 16:48:08 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-165) long response times from task
 trackers under load
In-Reply-To: <28414302.1145982857680.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-165?page=comments#action_12376291 ] 

Doug Cutting commented on HADOOP-165:
-------------------------------------

Can you please try placing 'Server.LOG.setLevel(Level.FINE);' in the tasktracker and 'Client.LOG.setLevel(Level.FINE);' in the child.  That should provide some details about where the delay(s) are.


> long response times from task trackers under load
> -------------------------------------------------
>
>          Key: HADOOP-165
>          URL: http://issues.apache.org/jira/browse/HADOOP-165
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>  Environment: 190 redhat linux boxes, each with 2 hyperthreaded cpus, 2gb memory
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> we are seeing very slow response times from the task tracker. I put in some instrumentation to measure how long each call took for the RPC.Sever code to run the method (so it does not include serialization/deserialization time). The top of the list (in ms) looks like:
> 7581 progress node1192
> 7022 ping node1192
> 5393 ping node1162
> 4854 progress node1162
> 4749 progress node1194
> 4709 ping node1194
> 3813 ping node1100
> 3486 ping node1190
> 3266 progress node1190
> 3187 progress node1265
> 3078 ping node1203
> 2972 progress node1203
> 2947 progress node1240
> 2889 progress node1100
> 2875 ping node1116
> 2843 ping node1189
> 2772 ping node1183
> 2737 ping node1110
> 2727 progress node1183
> 2710 ping node1123
> 2563 ping node1304
> 2527 progress node1144
> 2479 ping node1137
> 2476 progress node1304
> 2430 ping node1240
> 2416 ping node1144
> 2377 progress node1176
> 2339 ping node1109
> 2321 progress node1114
> 2311 ping node1157
> 2185 ping node1265
> 2185 ping node1109
> 2172 ping node1114
> 2145 progress node1109
> 2127 ping node1176
> 2083 progress node1189
> 2076 ping node1229
> 2073 progress node1188
> 2072 progress node1123
> 2048 ping node1161
> 2003 progress node1110
> 1989 ping node1180
> 1963 ping node1114

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 16:54:22 2006
Return-Path: 
 <hadoop-dev-return-1016-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24662 invoked from network); 25 Apr 2006 16:54:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 16:54:22 -0000
Received: (qmail 90367 invoked by uid 500); 25 Apr 2006 16:54:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90253 invoked by uid 500); 25 Apr 2006 16:54:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90242 invoked by uid 99); 25 Apr 2006 16:54:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 09:54:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 09:54:16 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7D4D67142BB
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 16:53:06 +0000 (GMT)
Message-ID: <24186037.1145983986504.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 16:53:06 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12376292 ] 

Yoram Arnon commented on HADOOP-163:
------------------------------------

I envision 24x7 systems where the datanode is automatically restarted upon failure by init or another HA component. When a partition/FS fails, it will likely remain in a failed state after restart, so reporting up and stopping to serve would be better than simply exitting, which would lead to thrashing. At the end of the day, outside intervention would be required, so the most important part is diagnosing the error and reporting it as such. reporting 100% full would not generate the same kind of attention by a correction system/person.

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>     Reporter: Runping Qi

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 17:14:22 2006
Return-Path: 
 <hadoop-dev-return-1017-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32786 invoked from network); 25 Apr 2006 17:14:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 17:14:22 -0000
Received: (qmail 12403 invoked by uid 500); 25 Apr 2006 17:14:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12287 invoked by uid 500); 25 Apr 2006 17:14:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12278 invoked by uid 99); 25 Apr 2006 17:14:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 10:14:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 10:14:18 -0700
Received: from brutus (localhost.localdomain [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 337C67142C4
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 17:13:08 +0000 (GMT)
Message-ID: <20616081.1145985188208.JavaMail.jira@brutus>
Date: Tue, 25 Apr 2006 17:13:08 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-165) long response times from task
 trackers under load
In-Reply-To: <28414302.1145982857680.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-165?page=comments#action_12376295 ] 

Owen O'Malley commented on HADOOP-165:
--------------------------------------

I guess I should have made it clear that most of the times aren't this bad. This is the head of a long list. For example, the tail of the ping times look like (count, time):

      2 134
      1 123
      1 116
      1 108
      1 101
      1 79
      1 62
      1 56
      1 55
      1 37
      1 30
      1 15
      1 12
      2 4
     11 3
     90 2
    312 1
   9836 0

so by far most of the pings take 0 or 1 ms to execute.

> long response times from task trackers under load
> -------------------------------------------------
>
>          Key: HADOOP-165
>          URL: http://issues.apache.org/jira/browse/HADOOP-165
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>  Environment: 190 redhat linux boxes, each with 2 hyperthreaded cpus, 2gb memory
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> we are seeing very slow response times from the task tracker. I put in some instrumentation to measure how long each call took for the RPC.Sever code to run the method (so it does not include serialization/deserialization time). The top of the list (in ms) looks like:
> 7581 progress node1192
> 7022 ping node1192
> 5393 ping node1162
> 4854 progress node1162
> 4749 progress node1194
> 4709 ping node1194
> 3813 ping node1100
> 3486 ping node1190
> 3266 progress node1190
> 3187 progress node1265
> 3078 ping node1203
> 2972 progress node1203
> 2947 progress node1240
> 2889 progress node1100
> 2875 ping node1116
> 2843 ping node1189
> 2772 ping node1183
> 2737 ping node1110
> 2727 progress node1183
> 2710 ping node1123
> 2563 ping node1304
> 2527 progress node1144
> 2479 ping node1137
> 2476 progress node1304
> 2430 ping node1240
> 2416 ping node1144
> 2377 progress node1176
> 2339 ping node1109
> 2321 progress node1114
> 2311 ping node1157
> 2185 ping node1265
> 2185 ping node1109
> 2172 ping node1114
> 2145 progress node1109
> 2127 ping node1176
> 2083 progress node1189
> 2076 ping node1229
> 2073 progress node1188
> 2072 progress node1123
> 2048 ping node1161
> 2003 progress node1110
> 1989 ping node1180
> 1963 ping node1114

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 18:25:28 2006
Return-Path: 
 <hadoop-dev-return-1018-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72461 invoked from network); 25 Apr 2006 18:25:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 18:25:28 -0000
Received: (qmail 44683 invoked by uid 500); 25 Apr 2006 18:25:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44660 invoked by uid 500); 25 Apr 2006 18:25:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44570 invoked by uid 99); 25 Apr 2006 18:25:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 11:25:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 11:25:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E4FFD71428C
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 18:25:04 +0000 (GMT)
Message-ID: <41238835.1145989504936.JavaMail.root@brutus>
Date: Tue, 25 Apr 2006 18:25:04 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-160) sleeping with locks held
In-Reply-To: <11498027.1145750525845.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-160?page=all ]

Owen O'Malley updated HADOOP-160:
---------------------------------

    Attachment: task-tracker-unlocked-finish.patch

This patch removes the locking of the TaskTracker while the thread sleeps to wait for completion of the task in TaskTracker.taskFinished. It also moves startNewTask to just lock the tip instead of the TaskTracker while the new task is launched.

> sleeping with locks held
> ------------------------
>
>          Key: HADOOP-160
>          URL: http://issues.apache.org/jira/browse/HADOOP-160
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: task-tracker-unlocked-finish.patch
>
> I ran findbugs and it reported 7 cases of sleeping with locks held. Part of what is killing jobs is unreasonably slow responses from the servers (and task tracker in particular), and this may be contributing to that.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 19:09:48 2006
Return-Path: 
 <hadoop-dev-return-1019-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6213 invoked from network); 25 Apr 2006 19:09:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 19:09:48 -0000
Received: (qmail 92307 invoked by uid 500); 25 Apr 2006 19:09:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92286 invoked by uid 500); 25 Apr 2006 19:09:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92277 invoked by uid 99); 25 Apr 2006 19:09:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 12:09:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 12:09:44 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 23AEA144578
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 20:53:12 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 31596-02 for <hadoop-dev@lucene.apache.org>;
	Tue, 25 Apr 2006 20:53:12 +0200 (CEST)
Received: from [192.168.0.164] (unknown [212.122.41.253])
	by mslinux.media-style.com (Postfix) with ESMTP id 80B94144575
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 20:53:09 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
Content-Transfer-Encoding: 7bit
Message-Id: <BC46CDF3-B72C-42C3-B2F6-39390641E2F0@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: AbstractMetricsContext & MetricsRecordImpl not java 1.4 compatible
Date: Tue, 25 Apr 2006 21:09:03 +0200
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
was a decision to only use java 1.5 already done? I just remember  
there was a discussion.
I note that AbstractMetricsContext and MetricsRecordImpl are not java  
1.4 compatible.

Stefan


From MAILER-DAEMON Tue Apr 25 19:27:30 2006
Return-Path: 
 <hadoop-dev-return-1020-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27826 invoked from network); 25 Apr 2006 19:27:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 19:27:30 -0000
Received: (qmail 67086 invoked by uid 500); 25 Apr 2006 19:27:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67068 invoked by uid 500); 25 Apr 2006 19:27:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67059 invoked by uid 99); 25 Apr 2006 19:27:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 12:27:29 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 12:27:28 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A96647142BF
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 19:27:03 +0000 (GMT)
Message-ID: <41059209.1145993223691.JavaMail.root@brutus>
Date: Tue, 25 Apr 2006 19:27:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-160) sleeping with locks held
In-Reply-To: <11498027.1145750525845.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-160?page=all ]
     
Doug Cutting resolved HADOOP-160:
---------------------------------

    Resolution: Fixed

I just committed this patch.  Thanks, Owen.

> sleeping with locks held
> ------------------------
>
>          Key: HADOOP-160
>          URL: http://issues.apache.org/jira/browse/HADOOP-160
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: task-tracker-unlocked-finish.patch
>
> I ran findbugs and it reported 7 cases of sleeping with locks held. Part of what is killing jobs is unreasonably slow responses from the servers (and task tracker in particular), and this may be contributing to that.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 22:16:18 2006
Return-Path: 
 <hadoop-dev-return-1021-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8871 invoked from network); 25 Apr 2006 22:16:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 22:16:18 -0000
Received: (qmail 24321 invoked by uid 500); 25 Apr 2006 22:16:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24299 invoked by uid 500); 25 Apr 2006 22:16:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24290 invoked by uid 99); 25 Apr 2006 22:16:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:16:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:16:14 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id B5116144579
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 23:59:52 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 32706-01 for <hadoop-dev@lucene.apache.org>;
	Tue, 25 Apr 2006 23:59:52 +0200 (CEST)
Received: from [192.168.0.164] (unknown [212.122.41.253])
	by mslinux.media-style.com (Postfix) with ESMTP id 4B4E8144575
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 23:59:52 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
Content-Transfer-Encoding: 7bit
Message-Id: <F835EFC8-006C-4C03-98EC-427D18264257@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: interfaces: NoSuchMethodException in RPC$Server.call
Date: Wed, 26 Apr 2006 00:15:40 +0200
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
I would love to use the RPC.getProxy but my Server uses Interfaces as  
parameter.
When I now invoke my proxy client with concrete implementation the  
server throws a java.io.IOException: java.lang.NoSuchMethodException,
at java.lang.Class.getMethod(Class.java:1581)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:218)
since call.getParameterClasses() returns the concrete classes and not  
the interfaces the classes implements.
Any idea how to workaround the problem?

Thanks.
Stefan




From MAILER-DAEMON Tue Apr 25 22:20:29 2006
Return-Path: 
 <hadoop-dev-return-1022-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10011 invoked from network); 25 Apr 2006 22:20:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 22:20:29 -0000
Received: (qmail 28977 invoked by uid 500); 25 Apr 2006 22:20:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28957 invoked by uid 500); 25 Apr 2006 22:20:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28943 invoked by uid 99); 25 Apr 2006 22:20:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:20:29 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:20:28 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3PMJJbk032012
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 18:19:20 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3PMK3Ld184850;
	Tue, 25 Apr 2006 18:20:03 -0400
Message-ID: <444EA092.2010703@apache.org>
Date: Tue, 25 Apr 2006 15:20:02 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: interfaces: NoSuchMethodException in RPC$Server.call
References: <F835EFC8-006C-4C03-98EC-427D18264257@media-style.com>
In-Reply-To: <F835EFC8-006C-4C03-98EC-427D18264257@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Can you supply a simple test case?

Thanks,

Doug

Stefan Groschupf wrote:
> Hi,
> I would love to use the RPC.getProxy but my Server uses Interfaces as  
> parameter.
> When I now invoke my proxy client with concrete implementation the  
> server throws a java.io.IOException: java.lang.NoSuchMethodException,
> at java.lang.Class.getMethod(Class.java:1581)
>     at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>     at org.apache.hadoop.ipc.Server$Handler.run(Server.java:218)
> since call.getParameterClasses() returns the concrete classes and not  
> the interfaces the classes implements.
> Any idea how to workaround the problem?
> 
> Thanks.
> Stefan
> 
> 
> 

From MAILER-DAEMON Tue Apr 25 22:43:53 2006
Return-Path: 
 <hadoop-dev-return-1023-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19023 invoked from network); 25 Apr 2006 22:43:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 22:43:53 -0000
Received: (qmail 57546 invoked by uid 500); 25 Apr 2006 22:43:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57524 invoked by uid 500); 25 Apr 2006 22:43:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57512 invoked by uid 99); 25 Apr 2006 22:43:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:43:52 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:43:52 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3PMhdci029125
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 18:43:41 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout6-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3PMhRaM270934;
	Tue, 25 Apr 2006 18:43:28 -0400
Message-ID: <444EA60F.90602@apache.org>
Date: Tue, 25 Apr 2006 15:43:27 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: AbstractMetricsContext & MetricsRecordImpl not java 1.4
 compatible
References: <BC46CDF3-B72C-42C3-B2F6-39390641E2F0@media-style.com>
In-Reply-To: <BC46CDF3-B72C-42C3-B2F6-39390641E2F0@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Stefan Groschupf wrote:
> was a decision to only use java 1.5 already done? I just remember  there 
> was a discussion.

No, I think the conclusion was to stick with 1.4 a bit longer.

> I note that AbstractMetricsContext and MetricsRecordImpl are not java  
> 1.4 compatible.

This is a bug.

Doug

From MAILER-DAEMON Tue Apr 25 22:52:26 2006
Return-Path: 
 <hadoop-dev-return-1024-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21811 invoked from network); 25 Apr 2006 22:52:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 22:52:26 -0000
Received: (qmail 63843 invoked by uid 500); 25 Apr 2006 22:52:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63726 invoked by uid 500); 25 Apr 2006 22:52:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63717 invoked by uid 99); 25 Apr 2006 22:52:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:52:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:52:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 984BD71429B
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 22:52:03 +0000 (GMT)
Message-ID: <57784325.1146005523621.JavaMail.root@brutus>
Date: Tue, 25 Apr 2006 22:52:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12376353 ] 

Doug Cutting commented on HADOOP-163:
-------------------------------------

But should a datanode with no disk or a read-only disk still send heartbeats to the namenode?  I think not.  So it should exit the datanode daemon loop.  I think more than that is hard to specify at this point.  You're talking about what we should do when we have a system that automatically restarts, and a system that monitors, etc.  We don't have those systems in Hadoop today, so they're hard to code to!  In the meantime, do you think it would be better to enter some zombie state, not sending heartbeats or otherwise participating in namenode network protocols, but looping sending out SOS over channels TBD?

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>     Reporter: Runping Qi

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 22:53:15 2006
Return-Path: 
 <hadoop-dev-return-1025-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 22120 invoked from network); 25 Apr 2006 22:53:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 22:53:15 -0000
Received: (qmail 65061 invoked by uid 500); 25 Apr 2006 22:53:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65044 invoked by uid 500); 25 Apr 2006 22:53:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65033 invoked by uid 99); 25 Apr 2006 22:53:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:53:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:53:10 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id CE7C0144579
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 00:36:31 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 00369-06 for <hadoop-dev@lucene.apache.org>;
	Wed, 26 Apr 2006 00:36:31 +0200 (CEST)
Received: from [192.168.0.164] (unknown [212.122.41.253])
	by mslinux.media-style.com (Postfix) with ESMTP id 383D4144575
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 00:36:27 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <444EA092.2010703@apache.org>
References: <F835EFC8-006C-4C03-98EC-427D18264257@media-style.com>
 <444EA092.2010703@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <4074CF63-A15D-468A-9B17-D4F3BEDBCA99@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: interfaces: NoSuchMethodException in RPC$Server.call
Date: Wed, 26 Apr 2006 00:52:15 +0200
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
yes I can but I already have a patch that at least solve me problem. :-)
What you think about this solution?
If you like me and it make sense I can file a bug report with test  
and patch.


Index: src/java/org/apache/hadoop/ipc/RPC.java
===================================================================
--- src/java/org/apache/hadoop/ipc/RPC.java	(revision 396952)
+++ src/java/org/apache/hadoop/ipc/RPC.java	(working copy)
@@ -233,9 +233,7 @@
          Invocation call = (Invocation)param;
          if (verbose) log("Call: " + call);

-        Method method =
-          implementation.getMethod(call.getMethodName(),
-                                   call.getParameterClasses());
+        Method method = findMethod(call);
          Object value = method.invoke(instance, call.getParameters());
          if (verbose) log("Return: "+value);
@@ -257,6 +255,30 @@
          throw ioe;
        }
      }
+
+    private Method findMethod(Invocation call) throws  
NoSuchMethodException {
+      Method[] methods = implementation.getMethods();
+      for (int i = 0; i < methods.length; i++) {
+        if (methods[i].getName().equals(call.getMethodName())) {
+          Class[] parameterTypes = methods[i].getParameterTypes();
+          Class[] parameterClasses = call.getParameterClasses();
+          if (parameterTypes.length == parameterClasses.length) {
+            boolean match = true;
+            for (int j = 0; j < parameterTypes.length; j++) {
+              if (!parameterTypes[j].isAssignableFrom 
(parameterClasses[j])) {
+                match = false;
+                break;
+              }
+            }
+            if (match) {
+              return methods[i];
+            }
+          }
+        }
+      }
+      throw new NoSuchMethodException();
+    }
+
    }
    private static void log(String value) {


On 26.04.2006, at 00:20, Doug Cutting wrote:

> Can you supply a simple test case?
>
> Thanks,
>
> Doug
>
> Stefan Groschupf wrote:
>> Hi,
>> I would love to use the RPC.getProxy but my Server uses Interfaces  
>> as  parameter.
>> When I now invoke my proxy client with concrete implementation  
>> the  server throws a java.io.IOException:  
>> java.lang.NoSuchMethodException,
>> at java.lang.Class.getMethod(Class.java:1581)
>>     at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>>     at org.apache.hadoop.ipc.Server$Handler.run(Server.java:218)
>> since call.getParameterClasses() returns the concrete classes and  
>> not  the interfaces the classes implements.
>> Any idea how to workaround the problem?
>> Thanks.
>> Stefan
>


From MAILER-DAEMON Tue Apr 25 22:59:03 2006
Return-Path: 
 <hadoop-dev-return-1026-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24157 invoked from network); 25 Apr 2006 22:59:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 22:59:03 -0000
Received: (qmail 72985 invoked by uid 500); 25 Apr 2006 22:59:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72965 invoked by uid 500); 25 Apr 2006 22:59:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72956 invoked by uid 99); 25 Apr 2006 22:59:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:59:00 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 15:59:00 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3PMwbng006366
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 18:58:37 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3PMwZq5143246;
	Tue, 25 Apr 2006 18:58:36 -0400
Message-ID: <444EA99B.2090203@apache.org>
Date: Tue, 25 Apr 2006 15:58:35 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: interfaces: NoSuchMethodException in RPC$Server.call
References: <F835EFC8-006C-4C03-98EC-427D18264257@media-style.com>
 <444EA092.2010703@apache.org>
 <4074CF63-A15D-468A-9B17-D4F3BEDBCA99@media-style.com>
In-Reply-To: <4074CF63-A15D-468A-9B17-D4F3BEDBCA99@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Stefan Groschupf wrote:
> If you like me and it make sense I can file a bug report with test  and 
> patch.

Yes, please.

Doug

From MAILER-DAEMON Tue Apr 25 23:14:31 2006
Return-Path: 
 <hadoop-dev-return-1027-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30970 invoked from network); 25 Apr 2006 23:14:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 23:14:31 -0000
Received: (qmail 92228 invoked by uid 500); 25 Apr 2006 23:14:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92106 invoked by uid 500); 25 Apr 2006 23:14:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92088 invoked by uid 99); 25 Apr 2006 23:14:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 16:14:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 16:14:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E8E1B7142A2
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 23:14:02 +0000 (GMT)
Message-ID: <43761887.1146006842951.JavaMail.root@brutus>
Date: Tue, 25 Apr 2006 23:14:02 +0000 (GMT+00:00)
From: "Stefan Groschupf (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-166) IPC is unable to invoke methods that
 use interfaces as parameter
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

IPC is unable to invoke methods that use interfaces as parameter
----------------------------------------------------------------

         Key: HADOOP-166
         URL: http://issues.apache.org/jira/browse/HADOOP-166
     Project: Hadoop
        Type: Improvement

  Components: ipc  
    Reporter: Stefan Groschupf
    Priority: Minor
 Attachments: RPC_interface_supportV1.patch

Methods of the implementation class are searched via method name and call parameters that can be implementations of the interfaces defined in the method signature.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Apr 25 23:14:32 2006
Return-Path: 
 <hadoop-dev-return-1028-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30986 invoked from network); 25 Apr 2006 23:14:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Apr 2006 23:14:32 -0000
Received: (qmail 92378 invoked by uid 500); 25 Apr 2006 23:14:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92274 invoked by uid 500); 25 Apr 2006 23:14:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92254 invoked by uid 99); 25 Apr 2006 23:14:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 16:14:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 16:14:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6FFE07142B7
	for <hadoop-dev@lucene.apache.org>; Tue, 25 Apr 2006 23:14:04 +0000 (GMT)
Message-ID: <43072216.1146006844456.JavaMail.root@brutus>
Date: Tue, 25 Apr 2006 23:14:04 +0000 (GMT+00:00)
From: "Stefan Groschupf (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-166) IPC is unable to invoke methods that
 use interfaces as parameter
In-Reply-To: <43761887.1146006842951.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-166?page=all ]

Stefan Groschupf updated HADOOP-166:
------------------------------------

    Attachment: RPC_interface_supportV1.patch

A test that shows the problem and a patch suggestion.

> IPC is unable to invoke methods that use interfaces as parameter
> ----------------------------------------------------------------
>
>          Key: HADOOP-166
>          URL: http://issues.apache.org/jira/browse/HADOOP-166
>      Project: Hadoop
>         Type: Improvement

>   Components: ipc
>     Reporter: Stefan Groschupf
>     Priority: Minor
>  Attachments: RPC_interface_supportV1.patch
>
> Methods of the implementation class are searched via method name and call parameters that can be implementations of the interfaces defined in the method signature.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 00:51:30 2006
Return-Path: 
 <hadoop-dev-return-1029-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64648 invoked from network); 26 Apr 2006 00:51:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 00:51:30 -0000
Received: (qmail 85128 invoked by uid 500); 26 Apr 2006 00:51:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85103 invoked by uid 500); 26 Apr 2006 00:51:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85094 invoked by uid 99); 26 Apr 2006 00:51:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 17:51:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 17:51:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 970967142A2
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 00:51:03 +0000 (GMT)
Message-ID: <95002707.1146012663616.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 00:51:03 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12376374 ] 

Yoram Arnon commented on HADOOP-163:
------------------------------------

what I'm suggesting is close to your suggestion:
if you're read-only, behave as though you're 100% full, serve only read requests, but don't mislead: report you're read-only, not that you're 100% full. Namenode will avoid new block allocations to the node, but its log will contain an error that could trigger external corrective action.


> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>     Reporter: Runping Qi

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 03:53:25 2006
Return-Path: 
 <hadoop-dev-return-1030-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34622 invoked from network); 26 Apr 2006 03:53:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 03:53:25 -0000
Received: (qmail 10111 invoked by uid 500); 26 Apr 2006 03:53:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10088 invoked by uid 500); 26 Apr 2006 03:53:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10075 invoked by uid 99); 26 Apr 2006 03:53:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 20:53:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 20:53:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E62C871429E
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 03:53:02 +0000 (GMT)
Message-ID: <41048512.1146023582940.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 03:53:02 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-167) reducing the number of Configuration &
 JobConf objects created
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

reducing the number of Configuration & JobConf objects created
--------------------------------------------------------------

         Key: HADOOP-167
         URL: http://issues.apache.org/jira/browse/HADOOP-167
     Project: Hadoop
        Type: Improvement

  Components: conf  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


Currently, Configuration and JobConf objects are created many times during executing a job. In particular, the Task Tracker creates a lot of them. They both clutter up the logs and parse the xml config files over and over again.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 03:55:26 2006
Return-Path: 
 <hadoop-dev-return-1031-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35509 invoked from network); 26 Apr 2006 03:55:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 03:55:26 -0000
Received: (qmail 12285 invoked by uid 500); 26 Apr 2006 03:55:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12221 invoked by uid 500); 26 Apr 2006 03:55:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12161 invoked by uid 99); 26 Apr 2006 03:55:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 20:55:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 20:55:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9877771429E
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 03:55:03 +0000 (GMT)
Message-ID: <55068001.1146023703622.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 03:55:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-166) IPC is unable to invoke methods that
 use interfaces as parameter
In-Reply-To: <43761887.1146006842951.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-166?page=comments#action_12376385 ] 

Doug Cutting commented on HADOOP-166:
-------------------------------------

The problem isn't that the parameter is an interface, but rather that the declared class in the implementation is not exactly the same class as the instance passed.  One way to fix this would be to add the list of parameter types of the client method when writing the invocation, since those should match the server implementation, but that would make each RPC call bigger.  Alternately one could, as your patch suggests, search for an appropriate method.  However, your search code is not  quite correct.  The search should be ordered from the implementation class through its superclasses, to find the most specific implementing method.  And searching adds a cost to each RPC, so we'd probably want to cache the results of searches.

So I think I probably prefer adding the parameter types to the invocation.  This can be easily fixed in ObjectWritable by having it write two class names for Writable parameters: both the declared parameter type and the instance type.

> IPC is unable to invoke methods that use interfaces as parameter
> ----------------------------------------------------------------
>
>          Key: HADOOP-166
>          URL: http://issues.apache.org/jira/browse/HADOOP-166
>      Project: Hadoop
>         Type: Improvement

>   Components: ipc
>     Reporter: Stefan Groschupf
>     Priority: Minor
>  Attachments: RPC_interface_supportV1.patch
>
> Methods of the implementation class are searched via method name and call parameters that can be implementations of the interfaces defined in the method signature.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 03:59:25 2006
Return-Path: 
 <hadoop-dev-return-1032-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36997 invoked from network); 26 Apr 2006 03:59:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 03:59:25 -0000
Received: (qmail 16276 invoked by uid 500); 26 Apr 2006 03:59:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16250 invoked by uid 500); 26 Apr 2006 03:59:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16241 invoked by uid 99); 26 Apr 2006 03:59:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 20:59:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 20:59:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9793C71429E
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 03:59:03 +0000 (GMT)
Message-ID: <101257723.1146023943618.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 03:59:03 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-167) reducing the number of Configuration &
 JobConf objects created
In-Reply-To: <41048512.1146023582940.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-167?page=all ]

Owen O'Malley updated HADOOP-167:
---------------------------------

    Attachment: remove-confs.patch

This patch removes a lot of the extra JobConfs from the TaskTracker. In particular, it does not read the config files for each map output as it is transfered to a reduce. It also adds a new constructor for JobConf(Class) and makes the old JobConf() constructor read the mapred-defaults.xml. Unless Nutch makes heavy use of the JobConf(Configuration) and JobConf(Configuration,Class) constructors, I think we should depriciate them. There really isn't any advantage to having a separate Configuration object.

> reducing the number of Configuration & JobConf objects created
> --------------------------------------------------------------
>
>          Key: HADOOP-167
>          URL: http://issues.apache.org/jira/browse/HADOOP-167
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: remove-confs.patch
>
> Currently, Configuration and JobConf objects are created many times during executing a job. In particular, the Task Tracker creates a lot of them. They both clutter up the logs and parse the xml config files over and over again.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 05:14:26 2006
Return-Path: 
 <hadoop-dev-return-1033-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78726 invoked from network); 26 Apr 2006 05:14:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 05:14:26 -0000
Received: (qmail 26300 invoked by uid 500); 26 Apr 2006 05:14:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26181 invoked by uid 500); 26 Apr 2006 05:14:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26168 invoked by uid 99); 26 Apr 2006 05:14:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 22:14:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 22:14:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3E71C7142B6
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 05:14:04 +0000 (GMT)
Message-ID: <48446520.1146028444253.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 05:14:04 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-168) JobSubmissionProtocol and
 InterTrackerProtocol don't include "throws IOException" on all methods
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

JobSubmissionProtocol and InterTrackerProtocol don't include "throws IOException" on all methods
------------------------------------------------------------------------------------------------

         Key: HADOOP-168
         URL: http://issues.apache.org/jira/browse/HADOOP-168
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Minor
     Fix For: 0.2


Timeouts for RPC's are thrown as IOExceptions so unless the method is declared as throwing IOException in the Procotol interface, the Java library wraps the exception in an UndeclaredThrowableException.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 05:16:25 2006
Return-Path: 
 <hadoop-dev-return-1034-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79697 invoked from network); 26 Apr 2006 05:16:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 05:16:25 -0000
Received: (qmail 31049 invoked by uid 500); 26 Apr 2006 05:16:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30932 invoked by uid 500); 26 Apr 2006 05:16:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30923 invoked by uid 99); 26 Apr 2006 05:16:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 22:16:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 22:16:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 97CD67142A6
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 05:16:03 +0000 (GMT)
Message-ID: <63040154.1146028563620.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 05:16:03 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-168) JobSubmissionProtocol and
 InterTrackerProtocol don't include "throws IOException" on all methods
In-Reply-To: <48446520.1146028444253.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-168?page=all ]

Owen O'Malley updated HADOOP-168:
---------------------------------

    Attachment: protocols-throw.patch

This patch adds "throws IOException" to the RPC protocol methods that didn't have it.

> JobSubmissionProtocol and InterTrackerProtocol don't include "throws IOException" on all methods
> ------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-168
>          URL: http://issues.apache.org/jira/browse/HADOOP-168
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: protocols-throw.patch
>
> Timeouts for RPC's are thrown as IOExceptions so unless the method is declared as throwing IOException in the Procotol interface, the Java library wraps the exception in an UndeclaredThrowableException.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 05:26:28 2006
Return-Path: 
 <hadoop-dev-return-1035-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86457 invoked from network); 26 Apr 2006 05:26:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 05:26:28 -0000
Received: (qmail 51810 invoked by uid 500); 26 Apr 2006 05:26:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51785 invoked by uid 500); 26 Apr 2006 05:26:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51773 invoked by uid 99); 26 Apr 2006 05:26:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 22:26:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 22:26:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E746D7142A6
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 05:26:02 +0000 (GMT)
Message-ID: <36762128.1146029162945.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 05:26:02 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-169) a single failure from locateMapOutputs
 kills the entire job
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

a single failure from locateMapOutputs kills the entire job
-----------------------------------------------------------

         Key: HADOOP-169
         URL: http://issues.apache.org/jira/browse/HADOOP-169
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Critical
     Fix For: 0.2


Any communication failure in locateMapOutputs kills both the reduce task and the entire job.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 05:28:27 2006
Return-Path: 
 <hadoop-dev-return-1036-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87790 invoked from network); 26 Apr 2006 05:28:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 05:28:27 -0000
Received: (qmail 53505 invoked by uid 500); 26 Apr 2006 05:28:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53420 invoked by uid 500); 26 Apr 2006 05:28:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53405 invoked by uid 99); 26 Apr 2006 05:28:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 22:28:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Apr 2006 22:28:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 71C237142B6
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 05:28:04 +0000 (GMT)
Message-ID: <49868067.1146029284463.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 05:28:04 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-169) a single failure from locateMapOutputs
 kills the entire job
In-Reply-To: <36762128.1146029162945.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-169?page=all ]

Owen O'Malley updated HADOOP-169:
---------------------------------

    Attachment: retry-fetch.patch

This patch just catches the exception, logs it, and ignores it. This patch depends on the patch for hadoop-168. (Otherwise, you'd need to catch UndeclaredThrowableException instead of IOException.)

> a single failure from locateMapOutputs kills the entire job
> -----------------------------------------------------------
>
>          Key: HADOOP-169
>          URL: http://issues.apache.org/jira/browse/HADOOP-169
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: retry-fetch.patch
>
> Any communication failure in locateMapOutputs kills both the reduce task and the entire job.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 08:13:59 2006
Return-Path: 
 <hadoop-dev-return-1037-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29961 invoked from network); 26 Apr 2006 08:13:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 08:13:59 -0000
Received: (qmail 88701 invoked by uid 500); 26 Apr 2006 08:13:59 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88675 invoked by uid 500); 26 Apr 2006 08:13:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88666 invoked by uid 99); 26 Apr 2006 08:13:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 01:13:58 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.91] (HELO mailsrv.bangalore.corp.yahoo.com)
 (202.46.19.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 01:13:56 -0700
Received: from ddaslaptop (UNKNOWN-172-24-91-251.yahoo.com [172.24.91.251]
 (may be forged))
	by mailsrv.bangalore.corp.yahoo.com (8.13.6/8.13.4/pop-in) with ESMTP id
 k3Q8DRbg059685
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 13:43:28 +0530 (IST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=reply-to:from:to:subject:date:organization:message-id:
	mime-version:content-type:x-mailer:x-mimeole:thread-index:in-reply-to;
	b=PINSQROn5jIysaTABW3XOnwkvCePaQYUzfrHfqUXCCebFLyUX0wQ9h/iWPFEB804
Reply-To: <ddas@yahoo-inc.com>
From: "Devaraj Das" <ddas@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: C API for Hadoop DFS
Date: Wed, 26 Apr 2006 13:44:31 +0530
Organization: Yahoo India
Message-ID: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_NextPart_000_01D0_01C66937.8C7F0450"
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZo8k2aAAyV0mzUTcCiaUflmzEsQwAFpNHA
In-Reply-To: <49868067.1146029284463.JavaMail.root@brutus>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_NextPart_000_01D0_01C66937.8C7F0450
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit


Hi All,
Attached is a draft of the C API specification that some of us (in Yahoo)
have been thinking about. The specification is closely tied to the API
exported by Hadoop's FileSystem class. 
Will really appreciate any comments, etc. on the specification.
Thanks,
Devaraj.

------=_NextPart_000_01D0_01C66937.8C7F0450
Content-Type: text/plain;
	name="dfs.txt"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename="dfs.txt"

#ifndef DFS_H
#define DFS_H

#include <stdio.h>
#include <stdint.h>
#include <time.h>
#include <errno.h>

/** All APIs set errno to meaningful values */

extern  "C"
{

  typedef int32_t   tSize; /// size of data for read/write io ops=20
  typedef time_t    tTime; /// time type
  typedef int64_t   tOffset;/// offset within the file
  typedef uint16_t  tPort; /// port
  typedef enum tObjectKind {
    kObjectKindFile =3D 'F',
    kObjectKindDirectory =3D 'D'
  };


  typedef void *dfsFile;
  typedef void *dfsFS;

  /** dfsConnect - connect to a dfs file system
  * host is a string containing either a host name, or an ip adderss
  * of the namenode of a dfs cluster.
  * port is the port on which the server is listening.
  * host must be passed as null if you want to connect to the=20
  * local file system. host must be passed as "default" and port as 0
  * if the configured file system (in hadoop-site/hadoop-default.xml)
  * is to be used
  */
  dfsFS dfsConnect(char *host, tPort port);
 =20
  /** dfsOpenFile - open a dfs file.
  * path is a full path to the file.
  * flags is either O_RDONLY or O_WRONLY, for read-only or write-only
  * options is an XML'ized string containing options like buffersize,
  * replication level, etc.=20
  * e.g. options: =
<replication>2</replication><buffersize>8192</buffersize>
  */
  dfsFile dfsOpenFile(dfsFS fs, char *path, int flags, char *options);

  /** close a file */
  void dfsCloseFile(dfsFS fs, dfsFile file);

  /** seek to given offset in file. This works only for files
  * opened in read-only mode
  */
  void dfsSeek(dfsFs fs, dfsFile f, tOffset offset, int whence);

  /** get the current offset in the file, in bytes */
  tOffset dfsTell(dfsFs fs, dfsFile f);

  /** read returns the number of bytes actually read, possibly less than
  * the number of bytes requested.=20
  */
  tSize dfsRead(dfsFs fs, dfsFile f, void* buffer, tSize length);

  /** write length bytes of buffer to f */
  tSize dfsWrite(dfsFs fs, dfsFile f, const void* buffer, tSize length);

  /** flush the data */
  void dfsFlush(dfsFs fs, dfsFile f);
 =20
  /** check whether the file pointer is at end-of-file */
  bool dfsIsEof(dfsFs fs, dfsFile f);


  /** delete a file. */
  void dfsDelete(dfsFS fs, char *name);

  /** rename a file
  * old_name and new_name could be absolute or relative to the current
  * working directory
  */
  void dfsRename(dfsFS fs, char *old_name, char *new_name);
=20
  /** Make the given file and all non-existent parents into directories =
*/
  void dfsCreateDirectory(dfsFS fs, char *name);

  /**=20
  * dfsFileLocationInfo
  * used to get the mapping between file blocks and the hostnames where
  * they are stored. Due to replication, a file block could be stored on
  * multiple hosts.
  */
  typedef struct  {
    char **hostname;
    int numHosts;
  } dfsFileLocationInfo;

  /**=20
  * dfsStat
  * used for getting information about a file/directory
  */
  typedef struct  {
    tObjectKind mKind;	/** file or directory */
    char *mName; /* the name of the file */
    tTime mCreationTime;
    dfsFileLocationInfo *fileLocationInfo; /*the last element=20
                                       in the array is NULL*/
    long  mSize; /*the size of the file in bytes */
    bool replicated; /*whether this file is replicated */
  } dfsFileInfo;

  /** return information about a path as a (dynamically allocated) array =

  * of dfsFileInfo.
  * numEntries is set to the number of elements in the array.
  * If the path happens to be a file, the array will have just one =
element.
  * If the path happens to be a directory, the dfsFileInfo elements in =
the
  * array will contain information about the files/sub-dirs within the =
path.
  * NULL is returned if the path does not exist or some other error is=20
  * encountered. freeDfsFileInfo should be called passing the array and=20
  * numEntries when it is no longer needed.
  */
  dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path, int *numEntries);

  /** free up the dfsFileInfo array (including the fields */
  void freeDfsFileInfo(dfsFileInfo *dfsFileInfo, int numEntries);

  /** Obtain a lock on the file. Return -1 on error*/
  int dfsLock(dfsFs fs, char *path, int shared);
 =20
  /** Release the lock. Return -1 on error*/
  int dfsReleaseLock(dfsFs fs, char *path);
 =20
  /** Set the working directory. All relative paths will be resolved =
relative to it */
  void dfsSetWorkingDirectory(dfsFs fs, char *path);

  /** Get the current working directory for the given file system*/
  char *dfsGetWorkingDirectory(dfsFs fs);
 =20
  /** The src file is on the local disk.
  * Add it to FS at the given dst name and the source is kept
  * intact afterwards. Returns -1 on error.
  */
  int dfsCopyFromLocalFile(dfsFs fs, char *src, char *dst);

  /** The src file is under DFS, and the dst is on the local disk.
   * Copy it from FS control to the local dst name. Returns -1 on error.
   */
  int dfsCopyToLocalFile(dfsFs fs, char *src, char *dst);

  /** The src file is on the local disk. Add it to FS at the given dst =
name,
   * removing the source afterwards. Returns -1 on error.
   */
  int dfsMoveFromLocalFile(dfsFs fs, char *src, char *dst);
 =20
  /** Return the raw capacity of the filesystem */
  long dfsGetCapacity(dfsFs fs);

  /** Return the total raw size of all files in the filesystem.*/
  long dfsGetUsed(dfsFs fs);

}

#endif /*DFS_H*/


------=_NextPart_000_01D0_01C66937.8C7F0450--


From MAILER-DAEMON Wed Apr 26 14:19:38 2006
Return-Path: 
 <hadoop-dev-return-1038-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58341 invoked from network); 26 Apr 2006 14:19:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 14:19:38 -0000
Received: (qmail 90778 invoked by uid 500); 26 Apr 2006 14:19:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90658 invoked by uid 500); 26 Apr 2006 14:19:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90581 invoked by uid 99); 26 Apr 2006 14:19:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 07:19:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 07:19:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A923B7142C4
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 14:19:03 +0000 (GMT)
Message-ID: <37695732.1146061143690.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 14:19:03 +0000 (GMT+00:00)
From: "Stefan Groschupf (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-166) IPC is unable to invoke methods that
 use interfaces as parameter
In-Reply-To: <43761887.1146006842951.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-166?page=all ]

Stefan Groschupf updated HADOOP-166:
------------------------------------

    Attachment: RPC_interface_supportV2.patch

Make sense.
Here an update as you suggested.
I renamed the declaredClass into instanceClass in the readObject method, so the change looks much larger as it is, but I found using two variables with the same name not that senseful. 

Looks that overall better?


> IPC is unable to invoke methods that use interfaces as parameter
> ----------------------------------------------------------------
>
>          Key: HADOOP-166
>          URL: http://issues.apache.org/jira/browse/HADOOP-166
>      Project: Hadoop
>         Type: Improvement

>   Components: ipc
>     Reporter: Stefan Groschupf
>     Priority: Minor
>  Attachments: RPC_interface_supportV1.patch, RPC_interface_supportV2.patch
>
> Methods of the implementation class are searched via method name and call parameters that can be implementations of the interfaces defined in the method signature.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 16:20:25 2006
Return-Path: 
 <hadoop-dev-return-1039-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47849 invoked from network); 26 Apr 2006 16:20:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 16:20:25 -0000
Received: (qmail 26905 invoked by uid 500); 26 Apr 2006 16:20:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26754 invoked by uid 500); 26 Apr 2006 16:20:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26744 invoked by uid 99); 26 Apr 2006 16:20:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 09:20:22 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of toelen@gmail.com designates
 64.233.182.189 as permitted sender)
Received: from [64.233.182.189] (HELO nproxy.gmail.com) (64.233.182.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 09:20:21 -0700
Received: by nproxy.gmail.com with SMTP id c29so1183859nfb
        for <hadoop-dev@lucene.apache.org>;
 Wed, 26 Apr 2006 09:20:00 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=WhxXubzlu5TsCP1LjP/G3AiXqqqRL4X9XREzlkZlMspfxC5ksWviFb2uuxqffN8xOba8ENtnc8oHOglVuCcZhveRX+p2w5INt5fJBPBCgQExWy2yrRBGU+m8UeDtuwM6SAWyBpQO1dvpTGfIFcBUUvwACY6Mwn9yLp042mwObcw=
Received: by 10.48.208.12 with SMTP id f12mr1583613nfg;
        Wed, 26 Apr 2006 09:20:00 -0700 (PDT)
Received: by 10.49.60.20 with HTTP; Wed, 26 Apr 2006 09:20:00 -0700 (PDT)
Message-ID: <a494a0bc0604260920o13425ad7xde8f8bed724107ad@mail.gmail.com>
Date: Wed, 26 Apr 2006 18:20:00 +0200
From: "Leen Toelen" <toelen@gmail.com>
To: hadoop-dev@lucene.apache.org, ddas@yahoo-inc.com
Subject: Re: C API for Hadoop DFS
In-Reply-To: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <49868067.1146029284463.JavaMail.root@brutus>
	 <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

to make deployment easier, it would also be handy to prepare a binary
compiled to native code with gcj. This way nodes don't actually need
java installed for hadoop to work.

Regards,
Leen

On 4/26/06, Devaraj Das <ddas@yahoo-inc.com> wrote:
>
> Hi All,
> Attached is a draft of the C API specification that some of us (in Yahoo)
> have been thinking about. The specification is closely tied to the API
> exported by Hadoop's FileSystem class.
> Will really appreciate any comments, etc. on the specification.
> Thanks,
> Devaraj.
>
>
>

From MAILER-DAEMON Wed Apr 26 16:57:05 2006
Return-Path: 
 <hadoop-dev-return-1040-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71477 invoked from network); 26 Apr 2006 16:57:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 16:57:05 -0000
Received: (qmail 2759 invoked by uid 500); 26 Apr 2006 16:57:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2638 invoked by uid 500); 26 Apr 2006 16:57:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2629 invoked by uid 99); 26 Apr 2006 16:57:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 09:57:04 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 09:57:04 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3QGubFm024578
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 12:56:39 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3QGuSdf036982;
	Wed, 26 Apr 2006 12:56:33 -0400
Message-ID: <444FA63C.7020709@apache.org>
Date: Wed, 26 Apr 2006 09:56:28 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
In-Reply-To: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Devaraj Das wrote:
> Attached is a draft of the C API specification that some of us (in Yahoo)
> have been thinking about. The specification is closely tied to the API
> exported by Hadoop's FileSystem class. 
> Will really appreciate any comments, etc. on the specification.

Overall, this looks great!  Thanks for working on this!

>   /** 
>   * dfsFileLocationInfo
>   * used to get the mapping between file blocks and the hostnames where
>   * they are stored. Due to replication, a file block could be stored on
>   * multiple hosts.
>   */
>   typedef struct  {
>     char **hostname;
>     int numHosts;
>   } dfsFileLocationInfo;
> 
>   /** 
>   * dfsStat
>   * used for getting information about a file/directory
>   */
>   typedef struct  {
>     tObjectKind mKind;	/** file or directory */
>     char *mName; /* the name of the file */
>     tTime mCreationTime;
>     dfsFileLocationInfo *fileLocationInfo; /*the last element 
>                                        in the array is NULL*/
>     long  mSize; /*the size of the file in bytes */
>     bool replicated; /*whether this file is replicated */
>   } dfsFileInfo;
> 
>   /** return information about a path as a (dynamically allocated) array 
>   * of dfsFileInfo.
>   * numEntries is set to the number of elements in the array.
>   * If the path happens to be a file, the array will have just one element.
>   * If the path happens to be a directory, the dfsFileInfo elements in the
>   * array will contain information about the files/sub-dirs within the path.
>   * NULL is returned if the path does not exist or some other error is 
>   * encountered. freeDfsFileInfo should be called passing the array and 
>   * numEntries when it is no longer needed.
>   */
>   dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path, int *numEntries);

I'm a little confused about the dfsFileLocationInfo.  It exposes too 
much of the filesystem internals, that applications don't require.  It's 
also expensive to return full block lists with directory listings.

Instead, I think we need the following two functions:

tOffset getBlockSize(dfsFs fs);

char** geHosts(dfsFs fs, char* file, tOffset pos);

This would return an array of hosts that contain the specified position 
in a file.  Does that make sense?

>   int dfsCopyFromLocalFile(dfsFs fs, char *src, char *dst);
>   int dfsCopyToLocalFile(dfsFs fs, char *src, char *dst);
>   int dfsMoveFromLocalFile(dfsFs fs, char *src, char *dst);

These are utility methods, that could be implemented by user code, i.e., 
not core methods.  That's fine.  But perhaps we should add another:

int dfsCopy(dfsFs fs, char* src, char* dst);

Otherwise lots of applications will end up writing this themselves.

Thanks again,

Doug

From MAILER-DAEMON Wed Apr 26 17:12:20 2006
Return-Path: 
 <hadoop-dev-return-1041-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79920 invoked from network); 26 Apr 2006 17:12:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 17:12:20 -0000
Received: (qmail 33241 invoked by uid 500); 26 Apr 2006 17:12:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33221 invoked by uid 500); 26 Apr 2006 17:12:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33212 invoked by uid 99); 26 Apr 2006 17:12:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:12:19 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:12:18 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3QHAhTe059863
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 10:10:43 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=TbbenKWBIw+H4wOm+uHtUQL5/nOe3lw7F+wkMUDNVy9C/DMCSViOrTdcfc/TT1Ci
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 26 Apr 2006 10:10:42 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <444FA63C.7020709@apache.org>
References: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
 <444FA63C.7020709@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <9A26E42A-E005-4AB5-82E4-DF369BE4812E@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: C API for Hadoop DFS
Date: Wed, 26 Apr 2006 10:10:41 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 26 Apr 2006 17:10:42.0960 (UTC)
 FILETIME=[59B15100:01C66954]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

a couple of thoughts:

> Instead, I think we need the following two functions:
>
> tOffset getBlockSize(dfsFs fs);
>
> char** geHosts(dfsFs fs, char* file, tOffset pos);

** Think your suggestion is good.  An addition... I'd rather not  
assume that block size is global.  Why not require a file name in the  
getBlockSize call?  This may prove more future proof.

** Why not wait on the dfsCopy/Move type commands?  These can be  
implemented via a systems call to a commandline tool already, right?

On Apr 26, 2006, at 9:56 AM, Doug Cutting wrote:

> Devaraj Das wrote:
>> Attached is a draft of the C API specification that some of us (in  
>> Yahoo)
>> have been thinking about. The specification is closely tied to the  
>> API
>> exported by Hadoop's FileSystem class. Will really appreciate any  
>> comments, etc. on the specification.
>
> Overall, this looks great!  Thanks for working on this!
>
>>   /**   * dfsFileLocationInfo
>>   * used to get the mapping between file blocks and the hostnames  
>> where
>>   * they are stored. Due to replication, a file block could be  
>> stored on
>>   * multiple hosts.
>>   */
>>   typedef struct  {
>>     char **hostname;
>>     int numHosts;
>>   } dfsFileLocationInfo;
>>   /**   * dfsStat
>>   * used for getting information about a file/directory
>>   */
>>   typedef struct  {
>>     tObjectKind mKind;	/** file or directory */
>>     char *mName; /* the name of the file */
>>     tTime mCreationTime;
>>     dfsFileLocationInfo *fileLocationInfo; /*the last  
>> element                                        in the array is NULL*/
>>     long  mSize; /*the size of the file in bytes */
>>     bool replicated; /*whether this file is replicated */
>>   } dfsFileInfo;
>>   /** return information about a path as a (dynamically allocated)  
>> array   * of dfsFileInfo.
>>   * numEntries is set to the number of elements in the array.
>>   * If the path happens to be a file, the array will have just one  
>> element.
>>   * If the path happens to be a directory, the dfsFileInfo  
>> elements in the
>>   * array will contain information about the files/sub-dirs within  
>> the path.
>>   * NULL is returned if the path does not exist or some other  
>> error is   * encountered. freeDfsFileInfo should be called passing  
>> the array and   * numEntries when it is no longer needed.
>>   */
>>   dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path, int *numEntries);
>
> I'm a little confused about the dfsFileLocationInfo.  It exposes  
> too much of the filesystem internals, that applications don't  
> require.  It's also expensive to return full block lists with  
> directory listings.
>
> Instead, I think we need the following two functions:
>
> tOffset getBlockSize(dfsFs fs);
>
> char** geHosts(dfsFs fs, char* file, tOffset pos);
>
> This would return an array of hosts that contain the specified  
> position in a file.  Does that make sense?
>
>>   int dfsCopyFromLocalFile(dfsFs fs, char *src, char *dst);
>>   int dfsCopyToLocalFile(dfsFs fs, char *src, char *dst);
>>   int dfsMoveFromLocalFile(dfsFs fs, char *src, char *dst);
>
> These are utility methods, that could be implemented by user code,  
> i.e., not core methods.  That's fine.  But perhaps we should add  
> another:
>
> int dfsCopy(dfsFs fs, char* src, char* dst);
>
> Otherwise lots of applications will end up writing this themselves.
>
> Thanks again,
>
> Doug


From MAILER-DAEMON Wed Apr 26 17:17:26 2006
Return-Path: 
 <hadoop-dev-return-1042-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83172 invoked from network); 26 Apr 2006 17:17:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 17:17:26 -0000
Received: (qmail 43128 invoked by uid 500); 26 Apr 2006 17:17:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43110 invoked by uid 500); 26 Apr 2006 17:17:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43099 invoked by uid 99); 26 Apr 2006 17:17:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:17:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:17:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 90F81410008
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 17:17:03 +0000 (GMT)
Message-ID: <76750827.1146071823591.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 17:17:03 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-167) reducing the number of Configuration
 & JobConf objects created
In-Reply-To: <41048512.1146023582940.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-167?page=comments#action_12376516 ] 

Michel Tourn commented on HADOOP-167:
-------------------------------------

Avoiding the multiple config-loading messages is a good thing.
This could also be controlled with a verbosity  / logging level setting.

Please don't remove the JobConf(Configuration) constructor.

This is the only mechanism available to programatically change your Configuration.
We rely on this in two ways: 
1. to select from multiple XML config files that correspond to multiple Hadoop systems.
2. to make some properties (paths) user-dependant.

Ex for 1.
    config_ = new Configuration();
    config_.addFinalResource(getHadoopAliasConfFile());
    jobConf_ = new JobConf(config_);

In fact, it is important for Hadoop to maintain this property:
 ALL uses of a JobConf must be configurable at the outset by the caller by passing in a Configuration object.
 Common examples of such top-level Hadoop entry points: 
     Job submission, MapRed in local mode, DFS client calls.

In general we should make sure that we don't FORCE 
a long lifetime for a 'cached' JobConf object:
There are applications that need to use new JobConf-s along the way:
1. bec. they must first discover properties of the Hadoop cluster (list files, then submit job)
2. bec. they talk to multiple Hadoop systems (import / export files)


> reducing the number of Configuration & JobConf objects created
> --------------------------------------------------------------
>
>          Key: HADOOP-167
>          URL: http://issues.apache.org/jira/browse/HADOOP-167
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: remove-confs.patch
>
> Currently, Configuration and JobConf objects are created many times during executing a job. In particular, the Task Tracker creates a lot of them. They both clutter up the logs and parse the xml config files over and over again.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 17:27:29 2006
Return-Path: 
 <hadoop-dev-return-1043-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90019 invoked from network); 26 Apr 2006 17:27:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 17:27:29 -0000
Received: (qmail 65975 invoked by uid 500); 26 Apr 2006 17:27:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65947 invoked by uid 500); 26 Apr 2006 17:27:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65935 invoked by uid 99); 26 Apr 2006 17:27:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:27:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:27:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A7ED4410006
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 17:27:03 +0000 (GMT)
Message-ID: <66149102.1146072423685.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 17:27:03 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-167) reducing the number of Configuration
 & JobConf objects created
In-Reply-To: <41048512.1146023582940.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-167?page=comments#action_12376517 ] 

Owen O'Malley commented on HADOOP-167:
--------------------------------------

Your example is exactly the same as:

jobConf = new JobConf();
jobConf.addFinalResource(getHadoopAliasConfFile());

just without reading the xml files an extra time.

> reducing the number of Configuration & JobConf objects created
> --------------------------------------------------------------
>
>          Key: HADOOP-167
>          URL: http://issues.apache.org/jira/browse/HADOOP-167
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: remove-confs.patch
>
> Currently, Configuration and JobConf objects are created many times during executing a job. In particular, the Task Tracker creates a lot of them. They both clutter up the logs and parse the xml config files over and over again.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 17:34:29 2006
Return-Path: 
 <hadoop-dev-return-1044-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94980 invoked from network); 26 Apr 2006 17:34:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 17:34:29 -0000
Received: (qmail 83876 invoked by uid 500); 26 Apr 2006 17:34:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83857 invoked by uid 500); 26 Apr 2006 17:34:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83848 invoked by uid 99); 26 Apr 2006 17:34:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:34:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:34:27 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3QHXobL011518
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 13:33:55 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3QHXwMV246986;
	Wed, 26 Apr 2006 13:33:59 -0400
Message-ID: <444FAF05.9080500@apache.org>
Date: Wed, 26 Apr 2006 10:33:57 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
 <444FA63C.7020709@apache.org>
 <9A26E42A-E005-4AB5-82E4-DF369BE4812E@yahoo-inc.com>
In-Reply-To: <9A26E42A-E005-4AB5-82E4-DF369BE4812E@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
>> Instead, I think we need the following two functions:
>>
>> tOffset getBlockSize(dfsFs fs);
>>
>> char** geHosts(dfsFs fs, char* file, tOffset pos);
> 
> ** Think your suggestion is good.  An addition... I'd rather not  assume 
> that block size is global.  Why not require a file name in the  
> getBlockSize call?  This may prove more future proof.

Good idea.  To be fully future-proof, this could even become:

tOffset* getBlockStarts(dfsFs fs, char* file);

That would permit variable sized-blocks, which could happen, e.g., if we 
someday support appending to files.  Is that overkill?

> ** Why not wait on the dfsCopy/Move type commands?  These can be  
> implemented via a systems call to a commandline tool already, right?

Sure, but applications frequently call these too, so it's nice to make 
them easily available to C applications.  At some point they'll get 
written in C: better to have them in one place than in every 
application.  But, you're right, they're not essential.

Doug

From MAILER-DAEMON Wed Apr 26 17:45:41 2006
Return-Path: 
 <hadoop-dev-return-1046-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1355 invoked from network); 26 Apr 2006 17:45:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 17:45:41 -0000
Received: (qmail 9578 invoked by uid 500); 26 Apr 2006 17:45:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9550 invoked by uid 500); 26 Apr 2006 17:45:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9538 invoked by uid 99); 26 Apr 2006 17:45:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:45:40 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:45:40 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3QHiUPM070402
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 10:44:30 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=Wa6Ypp6MQdnlm1PYC1vBqPaY4fEciAkXC5geGiWSnhR+R/8+LA8B6f4DmpXpetjC
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 26 Apr 2006 10:44:30 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <444FAF05.9080500@apache.org>
References: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
 <444FA63C.7020709@apache.org>
 <9A26E42A-E005-4AB5-82E4-DF369BE4812E@yahoo-inc.com>
 <444FAF05.9080500@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <22D8A416-DEDA-4CFC-8352-9E0F5DD8AD76@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: C API for Hadoop DFS
Date: Wed, 26 Apr 2006 10:44:29 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 26 Apr 2006 17:44:30.0726 (UTC)
 FILETIME=[1255DA60:01C66959]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I'd vote against supporting variable block sizes, this way.  Let's  
keep it simpler until we have more use cases.  fair enough.

we can go forward with the copy APIs.  I appear to be out voted.  ;-)

On Apr 26, 2006, at 10:33 AM, Doug Cutting wrote:

> Eric Baldeschwieler wrote:
>>> Instead, I think we need the following two functions:
>>>
>>> tOffset getBlockSize(dfsFs fs);
>>>
>>> char** geHosts(dfsFs fs, char* file, tOffset pos);
>> ** Think your suggestion is good.  An addition... I'd rather not   
>> assume that block size is global.  Why not require a file name in  
>> the  getBlockSize call?  This may prove more future proof.
>
> Good idea.  To be fully future-proof, this could even become:
>
> tOffset* getBlockStarts(dfsFs fs, char* file);
>
> That would permit variable sized-blocks, which could happen, e.g.,  
> if we someday support appending to files.  Is that overkill?
>
>> ** Why not wait on the dfsCopy/Move type commands?  These can be   
>> implemented via a systems call to a commandline tool already, right?
>
> Sure, but applications frequently call these too, so it's nice to  
> make them easily available to C applications.  At some point  
> they'll get written in C: better to have them in one place than in  
> every application.  But, you're right, they're not essential.
>
> Doug


From MAILER-DAEMON Wed Apr 26 17:44:07 2006
Return-Path: 
 <hadoop-dev-return-1045-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 971 invoked from network); 26 Apr 2006 17:44:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 17:44:07 -0000
Received: (qmail 8711 invoked by uid 500); 26 Apr 2006 17:44:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8577 invoked by uid 500); 26 Apr 2006 17:44:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8568 invoked by uid 99); 26 Apr 2006 17:44:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:44:06 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.91] (HELO mailsrv.bangalore.corp.yahoo.com)
 (202.46.19.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:44:05 -0700
Received: from ddaslaptop (vpn-client133.bangalore.corp.yahoo.com
 [172.24.96.133])
	by mailsrv.bangalore.corp.yahoo.com (8.13.6/8.13.4/pop-in) with ESMTP id
 k3QHhXFE087620
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:13:33 +0530 (IST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=reply-to:from:to:subject:date:organization:message-id:
	mime-version:content-type:content-transfer-encoding:x-mailer:x-mimeole:
	thread-index:in-reply-to;
	b=cf7E0kfD7e+fio1wQKhUfeDvDfN0wPcohc9SS9um+Xem26VoMNUlIomuTB/1f8et
Reply-To: <ddas@yahoo-inc.com>
From: "Devaraj Das" <ddas@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: C API for Hadoop DFS
Date: Wed, 26 Apr 2006 23:14:37 +0530
Organization: Yahoo India
Message-ID: <020401c66959$172cb6d0$2201a8c0@ddaslaptop>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZpUqALXQn5EcvLRhSvtxNCNjhTbAABGbMQ
In-Reply-To: <444FA63C.7020709@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Doug, thanks for the positive feedback!
I agree with you and Eric on the getBlockSize/getHosts/dfsCopy suggestions.
Will revise the spec accordingly.
Thanks,
Devaraj.

-----Original Message-----
From: Doug Cutting [mailto:cutting@apache.org] 
Sent: Wednesday, April 26, 2006 10:26 PM
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS

Devaraj Das wrote:
> Attached is a draft of the C API specification that some of us (in Yahoo)
> have been thinking about. The specification is closely tied to the API
> exported by Hadoop's FileSystem class. 
> Will really appreciate any comments, etc. on the specification.

Overall, this looks great!  Thanks for working on this!

>   /** 
>   * dfsFileLocationInfo
>   * used to get the mapping between file blocks and the hostnames where
>   * they are stored. Due to replication, a file block could be stored on
>   * multiple hosts.
>   */
>   typedef struct  {
>     char **hostname;
>     int numHosts;
>   } dfsFileLocationInfo;
> 
>   /** 
>   * dfsStat
>   * used for getting information about a file/directory
>   */
>   typedef struct  {
>     tObjectKind mKind;	/** file or directory */
>     char *mName; /* the name of the file */
>     tTime mCreationTime;
>     dfsFileLocationInfo *fileLocationInfo; /*the last element 
>                                        in the array is NULL*/
>     long  mSize; /*the size of the file in bytes */
>     bool replicated; /*whether this file is replicated */
>   } dfsFileInfo;
> 
>   /** return information about a path as a (dynamically allocated) array 
>   * of dfsFileInfo.
>   * numEntries is set to the number of elements in the array.
>   * If the path happens to be a file, the array will have just one
element.
>   * If the path happens to be a directory, the dfsFileInfo elements in the
>   * array will contain information about the files/sub-dirs within the
path.
>   * NULL is returned if the path does not exist or some other error is 
>   * encountered. freeDfsFileInfo should be called passing the array and 
>   * numEntries when it is no longer needed.
>   */
>   dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path, int *numEntries);

I'm a little confused about the dfsFileLocationInfo.  It exposes too 
much of the filesystem internals, that applications don't require.  It's 
also expensive to return full block lists with directory listings.

Instead, I think we need the following two functions:

tOffset getBlockSize(dfsFs fs);

char** geHosts(dfsFs fs, char* file, tOffset pos);

This would return an array of hosts that contain the specified position 
in a file.  Does that make sense?

>   int dfsCopyFromLocalFile(dfsFs fs, char *src, char *dst);
>   int dfsCopyToLocalFile(dfsFs fs, char *src, char *dst);
>   int dfsMoveFromLocalFile(dfsFs fs, char *src, char *dst);

These are utility methods, that could be implemented by user code, i.e., 
not core methods.  That's fine.  But perhaps we should add another:

int dfsCopy(dfsFs fs, char* src, char* dst);

Otherwise lots of applications will end up writing this themselves.

Thanks again,

Doug



From MAILER-DAEMON Wed Apr 26 17:53:27 2006
Return-Path: 
 <hadoop-dev-return-1047-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 5004 invoked from network); 26 Apr 2006 17:53:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 17:53:27 -0000
Received: (qmail 28618 invoked by uid 500); 26 Apr 2006 17:53:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28600 invoked by uid 500); 26 Apr 2006 17:53:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28587 invoked by uid 99); 26 Apr 2006 17:53:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:53:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 10:53:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C8B4C7142C8
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 17:53:03 +0000 (GMT)
Message-ID: <53936882.1146073983819.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 17:53:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-167) reducing the number of Configuration
 & JobConf objects created
In-Reply-To: <41048512.1146023582940.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-167?page=comments#action_12376520 ] 

Doug Cutting commented on HADOOP-167:
-------------------------------------

Can we stop the extra reads caused by addFinalResource() and 'new JobConf(Configuration)' by re-using the hash table instead of re-reading the files?  addFinalResource could simply read that single file, rather than re-read everything.  And 'new JobConf(Configuration)' could clone the contents of the configuration rather than re-reading it, no?  Or even use nested Properties...

One feature that's currently supported is that Configuration.write() only writes things that differ from the defaults.  This isn't essential, but it's nice.  The way it distinguishes is that defaults are always in a nested properties and non-defaults are always in the top-level properties.

> reducing the number of Configuration & JobConf objects created
> --------------------------------------------------------------
>
>          Key: HADOOP-167
>          URL: http://issues.apache.org/jira/browse/HADOOP-167
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: remove-confs.patch
>
> Currently, Configuration and JobConf objects are created many times during executing a job. In particular, the Task Tracker creates a lot of them. They both clutter up the logs and parse the xml config files over and over again.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 20:28:27 2006
Return-Path: 
 <hadoop-dev-return-1048-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8967 invoked from network); 26 Apr 2006 20:28:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 20:28:27 -0000
Received: (qmail 82335 invoked by uid 500); 26 Apr 2006 20:28:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82313 invoked by uid 500); 26 Apr 2006 20:28:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82304 invoked by uid 99); 26 Apr 2006 20:28:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 13:28:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 13:28:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C9132410005
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 20:28:03 +0000 (GMT)
Message-ID: <53103826.1146083283821.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 20:28:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-166) IPC is unable to invoke methods that
 use interfaces as parameter
In-Reply-To: <43761887.1146006842951.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-166?page=all ]
     
Doug Cutting resolved HADOOP-166:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Doug Cutting

I just committed a fix for this.  Thanks for your help, Stefan!

> IPC is unable to invoke methods that use interfaces as parameter
> ----------------------------------------------------------------
>
>          Key: HADOOP-166
>          URL: http://issues.apache.org/jira/browse/HADOOP-166
>      Project: Hadoop
>         Type: Improvement

>   Components: ipc
>     Reporter: Stefan Groschupf
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: RPC_interface_supportV1.patch, RPC_interface_supportV2.patch
>
> Methods of the implementation class are searched via method name and call parameters that can be implementations of the interfaces defined in the method signature.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 20:44:50 2006
Return-Path: 
 <hadoop-dev-return-1049-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15552 invoked from network); 26 Apr 2006 20:44:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 20:44:50 -0000
Received: (qmail 2206 invoked by uid 500); 26 Apr 2006 20:44:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2189 invoked by uid 500); 26 Apr 2006 20:44:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2180 invoked by uid 99); 26 Apr 2006 20:44:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 13:44:49 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 13:44:48 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3QKhR7j093487
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 13:43:27 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=F06d5N1Xw1wZ+tOBdCWGtVx03Khdas/kCXEVGDtgKcFTZ0+HYbPlGXDRzCnVLxsX
Message-ID: <444FDB6F.3000600@yahoo-inc.com>
Date: Wed, 26 Apr 2006 13:43:27 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
 <444FA63C.7020709@apache.org>
In-Reply-To: <444FA63C.7020709@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


>
> These are utility methods, that could be implemented by user code, 
> i.e., not core methods.  That's fine.  But perhaps we should add another:
>
> int dfsCopy(dfsFs fs, char* src, char* dst);
>
> Otherwise lots of applications will end up writing this themselves.


If we want a copy function I'd propose a slightly generalized version

int dfsCopy(dfsFs srcFs, char* src, dfsFs dstFs, char* dst);

That way we can copy from/to local using the same function.

--Konstantin

From MAILER-DAEMON Wed Apr 26 20:55:13 2006
Return-Path: 
 <hadoop-dev-return-1050-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19717 invoked from network); 26 Apr 2006 20:55:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 20:55:13 -0000
Received: (qmail 21000 invoked by uid 500); 26 Apr 2006 20:55:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20883 invoked by uid 500); 26 Apr 2006 20:55:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20874 invoked by uid 99); 26 Apr 2006 20:55:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 13:55:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 13:55:12 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3QKsebL021617
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 16:54:41 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout6-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3QKsnN6106452;
	Wed, 26 Apr 2006 16:54:50 -0400
Message-ID: <444FDE19.3090908@apache.org>
Date: Wed, 26 Apr 2006 13:54:49 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
 <444FA63C.7020709@apache.org> <444FDB6F.3000600@yahoo-inc.com>
In-Reply-To: <444FDB6F.3000600@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Konstantin Shvachko wrote:
> If we want a copy function I'd propose a slightly generalized version
> 
> int dfsCopy(dfsFs srcFs, char* src, dfsFs dstFs, char* dst);
> 
> That way we can copy from/to local using the same function.

+1

Doug

From MAILER-DAEMON Wed Apr 26 21:26:28 2006
Return-Path: 
 <hadoop-dev-return-1051-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38490 invoked from network); 26 Apr 2006 21:26:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 21:26:28 -0000
Received: (qmail 34221 invoked by uid 500); 26 Apr 2006 21:26:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34198 invoked by uid 500); 26 Apr 2006 21:26:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34188 invoked by uid 99); 26 Apr 2006 21:26:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:26:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:26:26 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E406A41000A
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 21:26:04 +0000 (GMT)
Message-ID: <55474515.1146086764931.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 21:26:04 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-170) setReplication and related bug fixes
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

setReplication and related bug fixes
------------------------------------

         Key: HADOOP-170
         URL: http://issues.apache.org/jira/browse/HADOOP-170
     Project: Hadoop
        Type: Improvement

  Components: fs, dfs  
    Versions: 0.1.1    
    Reporter: Konstantin Shvachko
 Assigned to: Konstantin Shvachko 


Having variable replication (HADOOP-51) it is natural to be able to
change replication for existing files. This patch introduces the functionality.
Here is a detailed list of issues addressed by the patch.

1) setReplication() and getReplication() methods are implemented.
2) DFSShell prints file replication for any listed file.
3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
4) Bug fix. This is a distributed bug.
Suppose that file replication is 3, and a client reduces it to 1.
Two data nodes will be chosen to remove their copies, and will do that.
After a while they will report to the name node that the copies have been actually deleted.
Until they report the name node assumes the copies still exist.
Now the client decides to increase replication back to 3 BEFORE the data nodes
reported the copies are deleted. Then the name node can choose one of the data nodes,
which it thinks have a block copy, to replicate the block to new data nodes.
This setting is quite unusual but possible even without variable replications.
5) Logging for name and data nodes is improved in several cases.
E.g. data nodes never logged that they deleted a block.



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 21:28:28 2006
Return-Path: 
 <hadoop-dev-return-1052-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39268 invoked from network); 26 Apr 2006 21:28:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 21:28:28 -0000
Received: (qmail 47376 invoked by uid 500); 26 Apr 2006 21:28:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47317 invoked by uid 500); 26 Apr 2006 21:28:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47306 invoked by uid 99); 26 Apr 2006 21:28:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:28:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:28:26 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0ACA7410005
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 21:28:04 +0000 (GMT)
Message-ID: <61998408.1146086884042.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 21:28:04 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-170?page=all ]

Konstantin Shvachko updated HADOOP-170:
---------------------------------------

    Attachment: setReplication.patch

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 21:31:27 2006
Return-Path: 
 <hadoop-dev-return-1053-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40316 invoked from network); 26 Apr 2006 21:31:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 21:31:27 -0000
Received: (qmail 63800 invoked by uid 500); 26 Apr 2006 21:31:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63783 invoked by uid 500); 26 Apr 2006 21:31:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63774 invoked by uid 99); 26 Apr 2006 21:31:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:31:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:31:26 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2666B410006
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 21:31:04 +0000 (GMT)
Message-ID: <74077978.1146087064154.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 21:31:04 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376558 ] 

Doug Cutting commented on HADOOP-170:
-------------------------------------

We should start setting a high replication count in MapReduce for submitted job files, that are read by every node.  But how should we use this?  Can we simply do something like setReplication(Integer.MAX_VALUE) and have a file replicated as high as the fs thinks is useful (once per node, once per rack, once per nodes/10, whichever it chooses).

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 21:46:36 2006
Return-Path: 
 <hadoop-dev-return-1054-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46482 invoked from network); 26 Apr 2006 21:46:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 21:46:36 -0000
Received: (qmail 32872 invoked by uid 500); 26 Apr 2006 21:46:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32759 invoked by uid 500); 26 Apr 2006 21:46:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32533 invoked by uid 99); 26 Apr 2006 21:46:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:46:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:46:26 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0BBC2410005
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 21:46:04 +0000 (GMT)
Message-ID: <49935195.1146087964045.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 21:46:04 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-168) JobSubmissionProtocol and
 InterTrackerProtocol don't include "throws IOException" on all methods
In-Reply-To: <48446520.1146028444253.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-168?page=all ]
     
Doug Cutting resolved HADOOP-168:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> JobSubmissionProtocol and InterTrackerProtocol don't include "throws IOException" on all methods
> ------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-168
>          URL: http://issues.apache.org/jira/browse/HADOOP-168
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: protocols-throw.patch
>
> Timeouts for RPC's are thrown as IOExceptions so unless the method is declared as throwing IOException in the Procotol interface, the Java library wraps the exception in an UndeclaredThrowableException.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 21:53:45 2006
Return-Path: 
 <hadoop-dev-return-1055-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50471 invoked from network); 26 Apr 2006 21:53:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 21:53:45 -0000
Received: (qmail 3257 invoked by uid 500); 26 Apr 2006 21:53:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3129 invoked by uid 500); 26 Apr 2006 21:53:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3120 invoked by uid 99); 26 Apr 2006 21:53:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:53:44 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 14:53:43 -0700
Received: from [172.21.39.56] (finishship-lm.corp.yahoo.com [172.21.39.56])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3QLpJB4002678
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 14:51:19 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:in-reply-to:references:content-type:message-id:
	content-transfer-encoding:from:subject:date:to:x-mailer;
	b=z24/s5rNrGjyfQr7M7ybSnsEqv0Po8fHkid1RtE6VsAEN7vzZKilO4/BBLNWL88K
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <444FAF05.9080500@apache.org>
References: <01cf01c66909$72c6c850$2201a8c0@ddaslaptop>
 <444FA63C.7020709@apache.org>
 <9A26E42A-E005-4AB5-82E4-DF369BE4812E@yahoo-inc.com>
 <444FAF05.9080500@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <3D1D6CA8-1648-4ADA-8AA4-035CD3CA46C7@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Ben Reed <breed@yahoo-inc.com>
Subject: Re: C API for Hadoop DFS
Date: Wed, 26 Apr 2006 14:52:54 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

>
> Good idea.  To be fully future-proof, this could even become:
>
> tOffset* getBlockStarts(dfsFs fs, char* file);
>
> That would permit variable sized-blocks, which could happen, e.g.,  
> if we someday support appending to files.  Is that overkill?

I like it a lot! (I'm really hoping for record aligned variable sized- 
blocks :) You need to get a count for the offset array though:

tOffset* getBlockStarts(dfsFS fs, const char *file, int *count);

As far as future-proofing goes, it may be good enough for the near(?)  
future when we first get variable sized blocks. But longer term if  
you have variable sized-blocks, you are really talking about extents  
more than blocks, so you can start talking about sparse files, extent  
compacting for deleted records and the like. If the future DFS has  
those features, not only would you need offset and length for a  
block, but you would probably have an API that supports manipulating  
blocks.

ben

From MAILER-DAEMON Wed Apr 26 22:04:28 2006
Return-Path: 
 <hadoop-dev-return-1056-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55229 invoked from network); 26 Apr 2006 22:04:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 22:04:28 -0000
Received: (qmail 14120 invoked by uid 500); 26 Apr 2006 22:04:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14003 invoked by uid 500); 26 Apr 2006 22:04:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13994 invoked by uid 99); 26 Apr 2006 22:04:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:04:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:04:27 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1F4707142C9
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 22:04:05 +0000 (GMT)
Message-ID: <74800569.1146089045126.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 22:04:05 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376574 ] 

Konstantin Shvachko commented on HADOOP-170:
--------------------------------------------

This probably has to be called smartReplication().

Right now even if we the data blocks are placed "smart" by the namenode
we will still not see the desired locality because of the crc files, which are
completely independent on the data files.

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 22:08:27 2006
Return-Path: 
 <hadoop-dev-return-1057-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56666 invoked from network); 26 Apr 2006 22:08:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 22:08:27 -0000
Received: (qmail 18070 invoked by uid 500); 26 Apr 2006 22:08:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18046 invoked by uid 500); 26 Apr 2006 22:08:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18032 invoked by uid 99); 26 Apr 2006 22:08:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:08:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:08:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 98AA57142C8
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 22:08:03 +0000 (GMT)
Message-ID: <57255072.1146089283623.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 22:08:03 +0000 (GMT+00:00)
From: "Benjamin Reed (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376576 ] 

Benjamin Reed commented on HADOOP-170:
--------------------------------------

It's really JobTracker, not the fs, that knows how high to set the replication count since the JobTracker will know the number of mapper tasks. The JobTracker also knows when the job has finished and can set the replication count back to the original number. I guess in most cases the job files will just get deleted anyway at the end of the job.

When you say "submitted job files", you are just talking about the job conf and jar file that correspond to a job, correct?

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 22:22:27 2006
Return-Path: 
 <hadoop-dev-return-1058-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61824 invoked from network); 26 Apr 2006 22:22:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 22:22:27 -0000
Received: (qmail 31791 invoked by uid 500); 26 Apr 2006 22:22:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31775 invoked by uid 500); 26 Apr 2006 22:22:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31700 invoked by uid 99); 26 Apr 2006 22:22:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:22:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:22:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A32DD7142C9
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 22:22:03 +0000 (GMT)
Message-ID: <75666040.1146090123666.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 22:22:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376581 ] 

Doug Cutting commented on HADOOP-170:
-------------------------------------

>  This probably has to be called smartReplication(). 

What's the matter with Integer.MAX_VALUE?

This is one of the most important applications for variable replications counts.  We have them now, but they're not yet easy to use in the most obvious and needed application.  That's why I'm asking about this.

> we will still not see the desired locality because of the crc files

The .crc files are very tiny, much less than 1%.  If all of the data is read locally but .crc files, then throughput will be much faster, switches will not be the bottleneck.


> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 22:29:27 2006
Return-Path: 
 <hadoop-dev-return-1059-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66371 invoked from network); 26 Apr 2006 22:29:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 22:29:27 -0000
Received: (qmail 7150 invoked by uid 500); 26 Apr 2006 22:29:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7130 invoked by uid 500); 26 Apr 2006 22:29:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7120 invoked by uid 99); 26 Apr 2006 22:29:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:29:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:29:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9CBF07142C9
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 22:29:03 +0000 (GMT)
Message-ID: <38153095.1146090543639.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 22:29:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-169) a single failure from
 locateMapOutputs kills the entire job
In-Reply-To: <36762128.1146029162945.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-169?page=all ]
     
Doug Cutting resolved HADOOP-169:
---------------------------------

    Resolution: Fixed

I just committed this patch.  Thanks, Owen.

> a single failure from locateMapOutputs kills the entire job
> -----------------------------------------------------------
>
>          Key: HADOOP-169
>          URL: http://issues.apache.org/jira/browse/HADOOP-169
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: retry-fetch.patch
>
> Any communication failure in locateMapOutputs kills both the reduce task and the entire job.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 22:46:27 2006
Return-Path: 
 <hadoop-dev-return-1060-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71986 invoked from network); 26 Apr 2006 22:46:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 22:46:27 -0000
Received: (qmail 27495 invoked by uid 500); 26 Apr 2006 22:46:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27377 invoked by uid 500); 26 Apr 2006 22:46:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27368 invoked by uid 99); 26 Apr 2006 22:46:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:46:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 15:46:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9CF3F7142CA
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 22:46:03 +0000 (GMT)
Message-ID: <75224701.1146091563640.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 22:46:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376587 ] 

Doug Cutting commented on HADOOP-170:
-------------------------------------

Can you please add proper javadoc to the new public methods in FileSystem.java?  Thanks.

Also, as mentioned above, an easy way to indicate wide replication would be a welcome addition.  I'll certainly commit this without that, but I'd really like to be able to use this feature, and cannot yet.

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:03:27 2006
Return-Path: 
 <hadoop-dev-return-1061-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76335 invoked from network); 26 Apr 2006 23:03:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:03:27 -0000
Received: (qmail 40764 invoked by uid 500); 26 Apr 2006 23:03:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40740 invoked by uid 500); 26 Apr 2006 23:03:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40731 invoked by uid 99); 26 Apr 2006 23:03:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:03:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:03:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A04647142CC
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:03:03 +0000 (GMT)
Message-ID: <29101100.1146092583654.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:03:03 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376593 ] 

Yoram Arnon commented on HADOOP-170:
------------------------------------

the optimal replication factor for distributing a file in 2 hops is sqrt(cluster size). The worst case delivery time is 2*sqrt(n) times a single transfer time.

replicating to all the nodes of the dfs cluster has two disadvantages:
1. it's slower than replicating to sqrt(n), with a worst case of n.
2. if the dfs cluster is large, but multiple smaller map-reduce clusters are using it concurrently, there's little value in over-replication to every node of the cluster when it's required by a subset.

+1 on asking the job tracker for the size of the cluster and replicating based on that size.

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:09:26 2006
Return-Path: 
 <hadoop-dev-return-1062-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77709 invoked from network); 26 Apr 2006 23:09:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:09:26 -0000
Received: (qmail 43400 invoked by uid 500); 26 Apr 2006 23:09:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43281 invoked by uid 500); 26 Apr 2006 23:09:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43272 invoked by uid 99); 26 Apr 2006 23:09:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:09:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:09:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A2B8B7142CB
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:09:03 +0000 (GMT)
Message-ID: <64180371.1146092943664.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:09:03 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-170?page=all ]

Konstantin Shvachko updated HADOOP-170:
---------------------------------------

    Attachment:     (was: setReplication.patch)

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:09:28 2006
Return-Path: 
 <hadoop-dev-return-1063-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77734 invoked from network); 26 Apr 2006 23:09:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:09:28 -0000
Received: (qmail 43536 invoked by uid 500); 26 Apr 2006 23:09:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43417 invoked by uid 500); 26 Apr 2006 23:09:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43408 invoked by uid 99); 26 Apr 2006 23:09:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:09:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:09:26 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6EB7E7142CD
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:09:04 +0000 (GMT)
Message-ID: <63767448.1146092944451.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:09:04 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-170?page=all ]

Konstantin Shvachko updated HADOOP-170:
---------------------------------------

    Attachment: setReplication.patch

Java documentation is added for new public methods.


> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:09:28 2006
Return-Path: 
 <hadoop-dev-return-1064-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77763 invoked from network); 26 Apr 2006 23:09:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:09:28 -0000
Received: (qmail 43609 invoked by uid 500); 26 Apr 2006 23:09:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43551 invoked by uid 500); 26 Apr 2006 23:09:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43542 invoked by uid 99); 26 Apr 2006 23:09:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:09:28 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:09:27 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 408AF7142CE
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:09:05 +0000 (GMT)
Message-ID: <63254447.1146092945262.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:09:05 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376596 ] 

Doug Cutting commented on HADOOP-170:
-------------------------------------

> +1 on asking the job tracker for the size of the cluster and replicating based on that size.

I think you mean "namenode", not "job tracker".  Is that right?  If so, this sounds fine.  I don't care that we get it exactly right the first time, just that the API have some standard way to say "replicate highly": we can improve the implementation later, but we should only have to change client applications once.

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:18:27 2006
Return-Path: 
 <hadoop-dev-return-1065-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79820 invoked from network); 26 Apr 2006 23:18:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:18:27 -0000
Received: (qmail 49029 invoked by uid 500); 26 Apr 2006 23:18:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49003 invoked by uid 500); 26 Apr 2006 23:18:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48994 invoked by uid 99); 26 Apr 2006 23:18:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:18:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:18:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 982F27142AE
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:18:03 +0000 (GMT)
Message-ID: <70428466.1146093483621.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:18:03 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376598 ] 

Konstantin Shvachko commented on HADOOP-170:
--------------------------------------------

- Replication can be set to maximum if the number of nodes is available.
That is block will replicated on all almost all nodes.
- Replication can be set to n/10, whatever n you choose.
- Currently cannot achieve replication one per rack, since there is no notion of racks, which well known.
How exactly do you want to use  Integer.MAX_VALUE?

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:18:28 2006
Return-Path: 
 <hadoop-dev-return-1066-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79843 invoked from network); 26 Apr 2006 23:18:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:18:28 -0000
Received: (qmail 49271 invoked by uid 500); 26 Apr 2006 23:18:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49148 invoked by uid 500); 26 Apr 2006 23:18:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49138 invoked by uid 99); 26 Apr 2006 23:18:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:18:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:18:26 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6A0637142C5
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:18:04 +0000 (GMT)
Message-ID: <70220889.1146093484432.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:18:04 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-170?page=all ]
     
Doug Cutting resolved HADOOP-170:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Konstantin!

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:26:26 2006
Return-Path: 
 <hadoop-dev-return-1067-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85790 invoked from network); 26 Apr 2006 23:26:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:26:26 -0000
Received: (qmail 56945 invoked by uid 500); 26 Apr 2006 23:26:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56928 invoked by uid 500); 26 Apr 2006 23:26:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56919 invoked by uid 99); 26 Apr 2006 23:26:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:26:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:26:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EE9727142C5
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:26:02 +0000 (GMT)
Message-ID: <96548862.1146093962975.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:26:02 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-171) need standard API to set dfs
 replication = high
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

need standard API to set dfs replication = high
-----------------------------------------------

         Key: HADOOP-171
         URL: http://issues.apache.org/jira/browse/HADOOP-171
     Project: Hadoop
        Type: New Feature

  Components: dfs  
    Versions: 0.2    
    Reporter: Doug Cutting
 Assigned to: Konstantin Shvachko 


There should be a standard way to indicate that files should be highly replicated, appropriate for files that all nodes will read.  This should be settable both on file creation and for already-existing files.  Perhaps specifying a particular replication value, like Short.MAX_VALUE, or zero, can be used to signal this.  The level should not be constant, but should be relative to the cluster size and network topography.  If more nodes are added or if nodes are deleted, the actual replication count should increase or decrease.

Initially, all that is needed is an API to specify this.  It could initially be implemented with a constant (e.g., 10) or with something related to the number of datanodes (sqrt?), and needn't auto-adjust as the cluster size changes  That is only  the long-term goal.

When JobClient copies job files (job.xml & job.jar) into the job's filesystem, it should specify this replication level.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:32:27 2006
Return-Path: 
 <hadoop-dev-return-1068-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88979 invoked from network); 26 Apr 2006 23:32:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:32:27 -0000
Received: (qmail 61648 invoked by uid 500); 26 Apr 2006 23:32:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61626 invoked by uid 500); 26 Apr 2006 23:32:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61615 invoked by uid 99); 26 Apr 2006 23:32:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:32:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:32:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A64DA7142C5
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:32:03 +0000 (GMT)
Message-ID: <81419283.1146094323679.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:32:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-171) need standard API to set dfs
 replication = high
In-Reply-To: <96548862.1146093962975.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-171?page=comments#action_12376604 ] 

Doug Cutting commented on HADOOP-171:
-------------------------------------

So my concrete question is: how should I change JobClient?  It currently uses fs.copyFromLocalFile() to copy the job.jar and fs.create() to write the job.xml.  Both of these files should be replicated highly.  This code should not have to explicitly query the FileSystem to ask how many nodes it has, etc.

If my Short.MAX_VALUE suggestion were implemented, then these calls might become something like:

fs.create("job.xml", Short.MAX_VALUE);

and

fs.copyFromLocalFile(localJobJar, remoteJobJar, Short.MAX_VALUE);

Do someone have another proposal for how we should achieve this?

> need standard API to set dfs replication = high
> -----------------------------------------------
>
>          Key: HADOOP-171
>          URL: http://issues.apache.org/jira/browse/HADOOP-171
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko

>
> There should be a standard way to indicate that files should be highly replicated, appropriate for files that all nodes will read.  This should be settable both on file creation and for already-existing files.  Perhaps specifying a particular replication value, like Short.MAX_VALUE, or zero, can be used to signal this.  The level should not be constant, but should be relative to the cluster size and network topography.  If more nodes are added or if nodes are deleted, the actual replication count should increase or decrease.
> Initially, all that is needed is an API to specify this.  It could initially be implemented with a constant (e.g., 10) or with something related to the number of datanodes (sqrt?), and needn't auto-adjust as the cluster size changes  That is only  the long-term goal.
> When JobClient copies job files (job.xml & job.jar) into the job's filesystem, it should specify this replication level.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Apr 26 23:36:27 2006
Return-Path: 
 <hadoop-dev-return-1069-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90501 invoked from network); 26 Apr 2006 23:36:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Apr 2006 23:36:27 -0000
Received: (qmail 63858 invoked by uid 500); 26 Apr 2006 23:36:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63740 invoked by uid 500); 26 Apr 2006 23:36:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63731 invoked by uid 99); 26 Apr 2006 23:36:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:36:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 16:36:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 95ADF7142BA
	for <hadoop-dev@lucene.apache.org>; Wed, 26 Apr 2006 23:36:03 +0000 (GMT)
Message-ID: <93549777.1146094563611.JavaMail.root@brutus>
Date: Wed, 26 Apr 2006 23:36:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-171) need standard API to set dfs
 replication = high
In-Reply-To: <96548862.1146093962975.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-171?page=comments#action_12376605 ] 

Doug Cutting commented on HADOOP-171:
-------------------------------------

One alternative to 'fs.copyFromLocalFile(localJobJar, remoteJobJar, Short.MAX_VALUE)' might be:

fs.copyFromLocalFile(localJobJar, remoteJobJar);
fs.setReplicatoin(remoteJobJar, Short.MAX_VALUE);

In other words, we indicate this after file creation.  Or if folks don't like using Short.MAX_VALUE this way, then this could be something like:

fs.create("job.xml"); 
fs.setReplicateHighly("job.xml");
fs.copyFromLocalFile(localJobJar, remoteJobJar);
fs.setReplicateHighly(remoteJobJar);

One issue with this is, what would getReplication() return for these?  And would setReplication(f, getReplication(f)) be a no-op?  An advantage of using a sentinel value like Short.MAX_VALUE is that it doesn't add a lot of special cases to the existing, numeric API.

> need standard API to set dfs replication = high
> -----------------------------------------------
>
>          Key: HADOOP-171
>          URL: http://issues.apache.org/jira/browse/HADOOP-171
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko

>
> There should be a standard way to indicate that files should be highly replicated, appropriate for files that all nodes will read.  This should be settable both on file creation and for already-existing files.  Perhaps specifying a particular replication value, like Short.MAX_VALUE, or zero, can be used to signal this.  The level should not be constant, but should be relative to the cluster size and network topography.  If more nodes are added or if nodes are deleted, the actual replication count should increase or decrease.
> Initially, all that is needed is an API to specify this.  It could initially be implemented with a constant (e.g., 10) or with something related to the number of datanodes (sqrt?), and needn't auto-adjust as the cluster size changes  That is only  the long-term goal.
> When JobClient copies job files (job.xml & job.jar) into the job's filesystem, it should specify this replication level.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 00:25:37 2006
Return-Path: 
 <hadoop-dev-return-1070-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13068 invoked from network); 27 Apr 2006 00:25:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 00:25:37 -0000
Received: (qmail 6451 invoked by uid 500); 27 Apr 2006 00:25:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6325 invoked by uid 500); 27 Apr 2006 00:25:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6316 invoked by uid 99); 27 Apr 2006 00:25:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 17:25:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 17:25:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9C7BD7142C9
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 00:25:03 +0000 (GMT)
Message-ID: <95663686.1146097503638.JavaMail.root@brutus>
Date: Thu, 27 Apr 2006 00:25:03 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-170) setReplication and related bug fixes
In-Reply-To: <55474515.1146086764931.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-170?page=comments#action_12376614 ] 

Runping Qi commented on HADOOP-170:
-----------------------------------


It will be more effective if after assigning a map task to a specific jobtracker node, the jobtrackercan request the name node to replicate the blocks of the split for the maptask on to the jobtracker node.

> setReplication and related bug fixes
> ------------------------------------
>
>          Key: HADOOP-170
>          URL: http://issues.apache.org/jira/browse/HADOOP-170
>      Project: Hadoop
>         Type: Improvement

>   Components: fs, dfs
>     Versions: 0.1.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: setReplication.patch
>
> Having variable replication (HADOOP-51) it is natural to be able to
> change replication for existing files. This patch introduces the functionality.
> Here is a detailed list of issues addressed by the patch.
> 1) setReplication() and getReplication() methods are implemented.
> 2) DFSShell prints file replication for any listed file.
> 3) Bug fix. FSDirectory.delete() logs delete operation even if it is not successful.
> 4) Bug fix. This is a distributed bug.
> Suppose that file replication is 3, and a client reduces it to 1.
> Two data nodes will be chosen to remove their copies, and will do that.
> After a while they will report to the name node that the copies have been actually deleted.
> Until they report the name node assumes the copies still exist.
> Now the client decides to increase replication back to 3 BEFORE the data nodes
> reported the copies are deleted. Then the name node can choose one of the data nodes,
> which it thinks have a block copy, to replicate the block to new data nodes.
> This setting is quite unusual but possible even without variable replications.
> 5) Logging for name and data nodes is improved in several cases.
> E.g. data nodes never logged that they deleted a block.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 00:29:27 2006
Return-Path: 
 <hadoop-dev-return-1071-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16864 invoked from network); 27 Apr 2006 00:29:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 00:29:27 -0000
Received: (qmail 9018 invoked by uid 500); 27 Apr 2006 00:29:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8987 invoked by uid 500); 27 Apr 2006 00:29:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8978 invoked by uid 99); 27 Apr 2006 00:29:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 17:29:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 17:29:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9A9F17142C9
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 00:29:03 +0000 (GMT)
Message-ID: <57387903.1146097743631.JavaMail.root@brutus>
Date: Thu, 27 Apr 2006 00:29:03 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-171) need standard API to set dfs
 replication = high
In-Reply-To: <96548862.1146093962975.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-171?page=all ]
     
eric baldeschwieler resolved HADOOP-171:
----------------------------------------

    Resolution: Duplicate

> need standard API to set dfs replication = high
> -----------------------------------------------
>
>          Key: HADOOP-171
>          URL: http://issues.apache.org/jira/browse/HADOOP-171
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko

>
> There should be a standard way to indicate that files should be highly replicated, appropriate for files that all nodes will read.  This should be settable both on file creation and for already-existing files.  Perhaps specifying a particular replication value, like Short.MAX_VALUE, or zero, can be used to signal this.  The level should not be constant, but should be relative to the cluster size and network topography.  If more nodes are added or if nodes are deleted, the actual replication count should increase or decrease.
> Initially, all that is needed is an API to specify this.  It could initially be implemented with a constant (e.g., 10) or with something related to the number of datanodes (sqrt?), and needn't auto-adjust as the cluster size changes  That is only  the long-term goal.
> When JobClient copies job files (job.xml & job.jar) into the job's filesystem, it should specify this replication level.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 00:31:27 2006
Return-Path: 
 <hadoop-dev-return-1072-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17331 invoked from network); 27 Apr 2006 00:31:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 00:31:27 -0000
Received: (qmail 9629 invoked by uid 500); 27 Apr 2006 00:31:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9606 invoked by uid 500); 27 Apr 2006 00:31:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9597 invoked by uid 99); 27 Apr 2006 00:31:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 17:31:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 17:31:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A19257142C5
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 00:31:03 +0000 (GMT)
Message-ID: <70898540.1146097863659.JavaMail.root@brutus>
Date: Thu, 27 Apr 2006 00:31:03 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-171) need standard API to set dfs
 replication = high
In-Reply-To: <96548862.1146093962975.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-171?page=comments#action_12376616 ] 

Konstantin Shvachko commented on HADOOP-171:
--------------------------------------------

We can implement
short highReplicationHint()
which would ask namenode before anything what it thinks an appropriate
replication for highly accessed files would be.
Then copyFromLocalFile() would use that value to create files.
The size of the cluster does not vary often. 10% variation due to node
failure and come back is not a big deal with respect to sqrt or /10.

> need standard API to set dfs replication = high
> -----------------------------------------------
>
>          Key: HADOOP-171
>          URL: http://issues.apache.org/jira/browse/HADOOP-171
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko

>
> There should be a standard way to indicate that files should be highly replicated, appropriate for files that all nodes will read.  This should be settable both on file creation and for already-existing files.  Perhaps specifying a particular replication value, like Short.MAX_VALUE, or zero, can be used to signal this.  The level should not be constant, but should be relative to the cluster size and network topography.  If more nodes are added or if nodes are deleted, the actual replication count should increase or decrease.
> Initially, all that is needed is an API to specify this.  It could initially be implemented with a constant (e.g., 10) or with something related to the number of datanodes (sqrt?), and needn't auto-adjust as the cluster size changes  That is only  the long-term goal.
> When JobClient copies job files (job.xml & job.jar) into the job's filesystem, it should specify this replication level.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 02:47:33 2006
Return-Path: 
 <hadoop-dev-return-1073-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71447 invoked from network); 27 Apr 2006 02:47:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 02:47:33 -0000
Received: (qmail 38959 invoked by uid 500); 27 Apr 2006 02:47:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38628 invoked by uid 500); 27 Apr 2006 02:47:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38467 invoked by uid 99); 27 Apr 2006 02:47:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 19:47:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 19:47:26 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A4307410005
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 02:47:03 +0000 (GMT)
Message-ID: <110360992.1146106023670.JavaMail.root@brutus>
Date: Thu, 27 Apr 2006 02:47:03 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-171) need standard API to set dfs
 replication = high
In-Reply-To: <96548862.1146093962975.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-171?page=comments#action_12376622 ] 

Doug Cutting commented on HADOOP-171:
-------------------------------------

>  We can implement short highReplicationHint()

That would work, but it doesn't seem like the simplest API.  But if folks feel strongly I can live with it.

> Then copyFromLocalFile() would use that value to create files.

I don't think we want copyFromLocal to always do that.  I think we'd end up with something like:

fs.setReplication(fs.highReplicationHint());

That's okay.  If the filesystem grows or shrinks a lot then it might become inadequate.  But whatever, if most folks prefer this, I'd be willing to go along.

Perhaps we need to distingush in the API between the requested replication count and the actual replication count.  Then one can set the requested level to Small.MAX_VALUE and query the actual value to see how the fs interprets this.


> need standard API to set dfs replication = high
> -----------------------------------------------
>
>          Key: HADOOP-171
>          URL: http://issues.apache.org/jira/browse/HADOOP-171
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko

>
> There should be a standard way to indicate that files should be highly replicated, appropriate for files that all nodes will read.  This should be settable both on file creation and for already-existing files.  Perhaps specifying a particular replication value, like Short.MAX_VALUE, or zero, can be used to signal this.  The level should not be constant, but should be relative to the cluster size and network topography.  If more nodes are added or if nodes are deleted, the actual replication count should increase or decrease.
> Initially, all that is needed is an API to specify this.  It could initially be implemented with a constant (e.g., 10) or with something related to the number of datanodes (sqrt?), and needn't auto-adjust as the cluster size changes  That is only  the long-term goal.
> When JobClient copies job files (job.xml & job.jar) into the job's filesystem, it should specify this replication level.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 05:20:30 2006
Return-Path: 
 <hadoop-dev-return-1074-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49805 invoked from network); 27 Apr 2006 05:20:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 05:20:30 -0000
Received: (qmail 21917 invoked by uid 500); 27 Apr 2006 05:20:30 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 21864 invoked by uid 500); 27 Apr 2006 05:20:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 21847 invoked by uid 99); 27 Apr 2006 05:20:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 22:20:28 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Apr 2006 22:20:27 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 920387142A4
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 05:20:04 +0000 (GMT)
Message-ID: <71558864.1146115204596.JavaMail.root@brutus>
Date: Thu, 27 Apr 2006 05:20:04 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-171) need standard API to set dfs
 replication = high
In-Reply-To: <96548862.1146093962975.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-171?page=comments#action_12376639 ] 

eric baldeschwieler commented on HADOOP-171:
--------------------------------------------

highReplicationHint is not the right description IMO.  One goal is to optimize on distribution.  Call it distributionHint().

Another might be everyRackHint().  Different semantics, different effect.

> need standard API to set dfs replication = high
> -----------------------------------------------
>
>          Key: HADOOP-171
>          URL: http://issues.apache.org/jira/browse/HADOOP-171
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko

>
> There should be a standard way to indicate that files should be highly replicated, appropriate for files that all nodes will read.  This should be settable both on file creation and for already-existing files.  Perhaps specifying a particular replication value, like Short.MAX_VALUE, or zero, can be used to signal this.  The level should not be constant, but should be relative to the cluster size and network topography.  If more nodes are added or if nodes are deleted, the actual replication count should increase or decrease.
> Initially, all that is needed is an API to specify this.  It could initially be implemented with a constant (e.g., 10) or with something related to the number of datanodes (sqrt?), and needn't auto-adjust as the cluster size changes  That is only  the long-term goal.
> When JobClient copies job files (job.xml & job.jar) into the job's filesystem, it should specify this replication level.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 11:39:53 2006
Return-Path: 
 <hadoop-dev-return-1075-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55318 invoked from network); 27 Apr 2006 11:39:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 11:39:53 -0000
Received: (qmail 43410 invoked by uid 500); 27 Apr 2006 11:39:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43294 invoked by uid 500); 27 Apr 2006 11:39:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43216 invoked by uid 99); 27 Apr 2006 11:39:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 04:39:51 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.91] (HELO mailsrv.bangalore.corp.yahoo.com)
 (202.46.19.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 04:39:49 -0700
Received: from ddaslaptop (UNKNOWN-172-24-91-126.yahoo.com [172.24.91.126]
 (may be forged))
	by mailsrv.bangalore.corp.yahoo.com (8.13.6/8.13.4/pop-in) with ESMTP id
 k3RBdPrT062048
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 17:09:26 +0530 (IST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=reply-to:from:to:subject:date:organization:message-id:
	mime-version:content-type:x-mailer:x-mimeole:thread-index:in-reply-to;
	b=Ks88xaGrwM9rFchqIH78KNGgkdyGz3NlfNcmtUPi2IaeXvP6V14uiGDE/3cTOdVo
Reply-To: <ddas@yahoo-inc.com>
From: "Devaraj Das" <ddas@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: C API for Hadoop DFS
Date: Thu, 27 Apr 2006 17:10:30 +0530
Organization: Yahoo India
Message-ID: <024001c669ef$63660b50$2201a8c0@ddaslaptop>
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_NextPart_000_0241_01C66A1D.7D1E4750"
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZpc8TEiQHMyEISRLyFpN25vL2OugAeyiWA
In-Reply-To: <444FDE19.3090908@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_NextPart_000_0241_01C66A1D.7D1E4750
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Thanks all for the feedback. I have incorporated most of them. Attached is
the revised C API.
Thanks
Devaraj.

------=_NextPart_000_0241_01C66A1D.7D1E4750
Content-Type: text/plain;
	name="dfs.txt"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename="dfs.txt"

#ifndef DFS_H
#define DFS_H

#include <stdio.h>
#include <stdint.h>
#include <time.h>
#include <errno.h>

/** All APIs set errno to meaningful values */

extern  "C"
{

  typedef int32_t   tSize; /// size of data for read/write io ops=20
  typedef time_t    tTime; /// time type
  typedef int64_t   tOffset;/// offset within the file
  typedef uint16_t  tPort; /// port
  typedef enum tObjectKind {
    kObjectKindFile =3D 'F',
    kObjectKindDirectory =3D 'D'
  };


  typedef void *dfsFile;
  typedef void *dfsFS;

  /** dfsConnect - connect to a dfs file system
  * host is a string containing either a host name, or an ip adderss
  * of the namenode of a dfs cluster.
  * port is the port on which the server is listening.
  * host must be passed as null if you want to connect to the=20
  * local file system. host must be passed as "default" and port as 0
  * if the configured file system (in hadoop-site/hadoop-default.xml)
  * is to be used
  */
  dfsFS dfsConnect(char *host, tPort port);
 =20
  /** dfsOpenFile - open a dfs file.
  * path is a full path to the file.
  * flags is either O_RDONLY or O_WRONLY, for read-only or write-only
  * options is an XML'ized string containing options like buffersize,
  * replication level, etc.=20
  * e.g. options: =
<replication>2</replication><buffersize>8192</buffersize>
  */
  dfsFile dfsOpenFile(dfsFS fs, char *path, int flags, char *options);

  /** close a file */
  void dfsCloseFile(dfsFS fs, dfsFile file);

  /** seek to given offset in file. This works only for files
  * opened in read-only mode
  */
  void dfsSeek(dfsFS fs, dfsFile f, tOffset offset, int whence);

  /** get the current offset in the file, in bytes */
  tOffset dfsTell(dfsFS fs, dfsFile f);

  /** read returns the number of bytes actually read, possibly less than
  * the number of bytes requested.=20
  */
  tSize dfsRead(dfsFS fs, dfsFile f, void* buffer, tSize length);

  /** write length bytes of buffer to f */
  tSize dfsWrite(dfsFS fs, dfsFile f, const void* buffer, tSize length);

  /** flush the data */
  void dfsFlush(dfsFS fs, dfsFile f);
 =20
  /** check whether the file pointer is at end-of-file */
  bool dfsIsEof(dfsFS fs, dfsFile f);


  /** delete a file. */
  void dfsDelete(dfsFS fs, char *name);

  /** rename a file
  * old_name and new_name could be absolute or relative to the current
  * working directory
  */
  void dfsRename(dfsFS fs, char *old_name, char *new_name);
=20
  /** Make the given file and all non-existent parents into directories =
*/
  void dfsCreateDirectory(dfsFS fs, char *name);

  /**=20
  * dfsStat
  * used for getting information about a file/directory
  */
  typedef struct  {
    tObjectKind mKind;	/** file or directory */
    char *mName; /* the name of the file */
    tTime mCreationTime;
    long  mSize; /*the size of the file in bytes */
    bool replicated; /*whether this file is replicated */
  } dfsFileInfo;

  /** return information about a path as a (dynamically allocated) array =

  * of dfsFileInfo.
  * numEntries is set to the number of elements in the array.
  * If the path happens to be a file, the array will have just one =
element.
  * If the path happens to be a directory, the dfsFileInfo elements in =
the
  * array will contain information about the files/sub-dirs within the =
path.
  * NULL is returned if the path does not exist or some other error is=20
  * encountered. freeDfsFileInfo should be called passing the array and=20
  * numEntries when it is no longer needed.
  */
  dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path, int *numEntries);

  /** free up the dfsFileInfo array (including the fields */
  void freeDfsFileInfo(dfsFileInfo *dfsFileInfo, int numEntries);

  /** get the blocksize for a file */
  tOffset getBlockSize(dfsFS fs, char *name);

  /** Returns an array of hostnames where a particular block=20
  * (determined by pos & blocksize) of a file is stored. The last =
element in=20
  * the array is NULL. Due to replication, a single block could be =
present on=20
  * multiple hosts.
  */
  char** getHosts(dfsFS fs, char* file, tOffset pos);

  /** Obtain a lock on the file. Return -1 on error*/
  int dfsLock(dfsFS fs, char *path, int shared);
 =20
  /** Release the lock. Return -1 on error*/
  int dfsReleaseLock(dfsFS fs, char *path);
 =20
  /** Set the working directory. All relative paths will be resolved =
relative to it */
  void dfsSetWorkingDirectory(dfsFS fs, char *path);

  /** Get the current working directory for the given file system*/
  char *dfsGetWorkingDirectory(dfsFS fs);
 =20
  /** Copy a file from the control of one FS to another. The src remains =
intact */
  int dfsCopy(dfsFS srcFs, char* src, dfsFS dstFs, char* dst);

  /** The src file is on the local disk. Add it to FS at the given dst =
name,
   * removing the source afterwards. Returns -1 on error.
   */
  int dfsMove(dfsFS srcFs, char* src, dfsFS dstFs, char* dst);
 =20
  /** Return the raw capacity of the filesystem */
  long dfsGetCapacity(dfsFS fs);

  /** Return the total raw size of all files in the filesystem.*/
  long dfsGetUsed(dfsFS fs);

}

#endif /*DFS_H*/


------=_NextPart_000_0241_01C66A1D.7D1E4750--


From MAILER-DAEMON Thu Apr 27 16:05:01 2006
Return-Path: 
 <hadoop-dev-return-1076-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34677 invoked from network); 27 Apr 2006 16:05:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 16:05:01 -0000
Received: (qmail 24907 invoked by uid 500); 27 Apr 2006 16:05:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24876 invoked by uid 500); 27 Apr 2006 16:05:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24867 invoked by uid 99); 27 Apr 2006 16:05:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 09:05:00 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 09:04:58 -0700
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3RG3cm6085910;
	Thu, 27 Apr 2006 09:03:38 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:thread-index:x-mimeole;
	b=a56ikMXRD9RSbQtXZFfBA7zQ5st3+2mIMYMqwXNrMeYOGCt4rHcER7ZtmHxL+SSS
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>, <ddas@yahoo-inc.com>
Subject: RE: C API for Hadoop DFS
Date: Thu, 27 Apr 2006 09:03:38 -0700
Message-ID: <00db01c66a14$251dd4c0$496715ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <024001c669ef$63660b50$2201a8c0@ddaslaptop>
Thread-Index: AcZpc8TEiQHMyEISRLyFpN25vL2OugAeyiWAAAj58RA=
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

One more comment:
dfsGetPathInfo serves two purposes: fstat and readdir.
It's hard to get the status of a single directory - you'd need to call
dfsGetPathInfo for the parent directory and filter out everything but the
directory you want.

Perhaps the more common approach of separate calls is better. getFileStat
would return more information per file, possibly everything fstat returns,
future proofing it for a time HDFS supports things like modification time,
and will not return a file name, allowing the memory for dfsFileInfo to be
allocated by the client, while dfsReadDir would return a list of just names
and types.

Yoram

-----Original Message-----
From: Devaraj Das [mailto:ddas@yahoo-inc.com] 
Sent: Thursday, April 27, 2006 4:41 AM
To: hadoop-dev@lucene.apache.org
Subject: RE: C API for Hadoop DFS

Thanks all for the feedback. I have incorporated most of them. Attached is
the revised C API.
Thanks
Devaraj.


From MAILER-DAEMON Thu Apr 27 16:23:21 2006
Return-Path: 
 <hadoop-dev-return-1077-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49018 invoked from network); 27 Apr 2006 16:23:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 16:23:21 -0000
Received: (qmail 95330 invoked by uid 500); 27 Apr 2006 16:22:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 95212 invoked by uid 500); 27 Apr 2006 16:22:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 95202 invoked by uid 99); 27 Apr 2006 16:22:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 09:22:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 09:22:20 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3RGM9ci027531
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 12:22:10 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3RGLuNJ239806;
	Thu, 27 Apr 2006 12:21:57 -0400
Message-ID: <4450EFA3.9060207@apache.org>
Date: Thu, 27 Apr 2006 09:21:55 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <00db01c66a14$251dd4c0$496715ac@ds.corp.yahoo.com>
In-Reply-To: <00db01c66a14$251dd4c0$496715ac@ds.corp.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Yoram Arnon wrote:
> Perhaps the more common approach of separate calls is better. getFileStat
> would return more information per file, possibly everything fstat returns,
> future proofing it for a time HDFS supports things like modification time,
> and will not return a file name, allowing the memory for dfsFileInfo to be
> allocated by the client, while dfsReadDir would return a list of just names
> and types.

I agree that this is a more elegant API, but it could place considerably 
more stress on the namenode for computations like 'du', which walks the 
directory tree, summing file sizes.  I don't think we want to bloat each 
stat with full block lists, but including stat information in directory 
listings saves a lot of RPCs.

So perhaps instead we should have separate calls to list a directory and 
to stat an individual name.  The directory listing could still consist 
of stat structs, but when you stat a directory you get only a single 
stat struct.  Does that work?

Doug

From MAILER-DAEMON Thu Apr 27 16:27:55 2006
Return-Path: 
 <hadoop-dev-return-1078-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52129 invoked from network); 27 Apr 2006 16:27:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 16:27:55 -0000
Received: (qmail 3714 invoked by uid 500); 27 Apr 2006 16:27:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3590 invoked by uid 500); 27 Apr 2006 16:27:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3581 invoked by uid 99); 27 Apr 2006 16:27:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 09:27:38 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 09:27:37 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3RGQPbk020417
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 12:26:30 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3RGR7P7064754;
	Thu, 27 Apr 2006 12:27:10 -0400
Message-ID: <4450F0DB.6060206@apache.org>
Date: Thu, 27 Apr 2006 09:27:07 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <024001c669ef$63660b50$2201a8c0@ddaslaptop>
In-Reply-To: <024001c669ef$63660b50$2201a8c0@ddaslaptop>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Devaraj Das wrote:
> Thanks all for the feedback. I have incorporated most of them. Attached is
> the revised C API.

Thanks for revising this so quickly!

>   /** 
>   * dfsStat
>   * used for getting information about a file/directory
>   */
>   typedef struct  {
>     tObjectKind mKind;	/** file or directory */
>     char *mName; /* the name of the file */
>     tTime mCreationTime;
>     long  mSize; /*the size of the file in bytes */
>     bool replicated; /*whether this file is replicated */
>   } dfsFileInfo;

Should 'bool replicated' instead be a replication count?

>   /** return information about a path as a (dynamically allocated) array 
>   * of dfsFileInfo.
>   * numEntries is set to the number of elements in the array.
>   * If the path happens to be a file, the array will have just one element.
>   * If the path happens to be a directory, the dfsFileInfo elements in the
>   * array will contain information about the files/sub-dirs within the path.
>   * NULL is returned if the path does not exist or some other error is 
>   * encountered. freeDfsFileInfo should be called passing the array and 
>   * numEntries when it is no longer needed.
>   */
>   dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path, int *numEntries);

As mentioned in my previous message, perhaps this should be split into 
two functions:

dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path);
dfsFileInfo *dfsListDirectory(dfsFS fs, char *path, int *numEntries);

Doug

From MAILER-DAEMON Thu Apr 27 16:47:23 2006
Return-Path: 
 <hadoop-dev-return-1079-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63685 invoked from network); 27 Apr 2006 16:47:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 16:47:23 -0000
Received: (qmail 46726 invoked by uid 500); 27 Apr 2006 16:47:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46702 invoked by uid 500); 27 Apr 2006 16:47:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46693 invoked by uid 99); 27 Apr 2006 16:47:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 09:47:22 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 09:47:22 -0700
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3RGhQXX097160
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 09:43:26 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:thread-index:x-mimeole;
	b=iunc9r7Vp0afns+aJfNQYsT3aZ1oP5KIfB3PfwSMXr9l8iQick1HzC/W/xhsaeLU
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: C API for Hadoop DFS
Date: Thu, 27 Apr 2006 09:43:26 -0700
Message-ID: <00df01c66a19$b48d17b0$496715ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4450EFA3.9060207@apache.org>
Thread-Index: AcZqFs5SnxHiavRmSeOzU9nTI54UPQAAfjLA
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

 
> 
> Yoram Arnon wrote:
> > Perhaps the more common approach of separate calls is better. 
> > getFileStat would return more information per file, possibly 
> > everything fstat returns, future proofing it for a time 
> HDFS supports 
> > things like modification time, and will not return a file name, 
> > allowing the memory for dfsFileInfo to be allocated by the client, 
> > while dfsReadDir would return a list of just names and types.
> 
> I agree that this is a more elegant API, but it could place 
> considerably more stress on the namenode for computations 
> like 'du', which walks the directory tree, summing file 
> sizes.  I don't think we want to bloat each stat with full 
> block lists, but including stat information in directory 
> listings saves a lot of RPCs.

Good point. So the information returned when listing a directory should
include sizes, and perhaps a bit more info too - whatever is necessary to be
efficient.

> 
> So perhaps instead we should have separate calls to list a 
> directory and to stat an individual name.  The directory 
> listing could still consist of stat structs, but when you 
> stat a directory you get only a single stat struct.  Does that work?

Yes.
Ideally, a single stat returnes a lot of information, but not a name (you
already know the name), making memory allocation trivial, while a list
returns names, but less info. Lists may be long, so they should contain what
we need, but no more. Stat is just one, so size matters less, but it may be
called often, so simplicity matters.

> 
> Doug
> 
> 


From MAILER-DAEMON Thu Apr 27 17:02:08 2006
Return-Path: 
 <hadoop-dev-return-1080-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72864 invoked from network); 27 Apr 2006 17:02:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 17:02:08 -0000
Received: (qmail 78559 invoked by uid 500); 27 Apr 2006 17:01:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78541 invoked by uid 500); 27 Apr 2006 17:01:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78532 invoked by uid 99); 27 Apr 2006 17:01:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 10:01:40 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 10:01:39 -0700
Received: from [207.126.231.161] (oom-mac.corp.yahoo.com [207.126.231.161])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3RGxne1001900
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 09:59:49 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:content-transfer-encoding:message-id:
	content-type:to:from:subject:date:x-mailer;
	b=riZqsAF3ChSeL9TMpx8h+yUBuCXh0pYhno2uM/p17i/hkUfjd+vT54da5cfbKwWD
Mime-Version: 1.0 (Apple Message framework v623)
Content-Transfer-Encoding: 7bit
Message-Id: <00756dba8baf0b4d15ddfb621f61d97d@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
To: hadoop-dev@lucene.apache.org
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: hadoop svn head is broken
Date: Thu, 27 Apr 2006 09:59:50 -0700
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I don't know what is up, but hadoop is broken this morning with the job 
tracker getting:

> 1. in jobtracker log:
> 060427 044020 Server handler 0 on 7020 caught:
> java.lang.IllegalArgumentException: Argument is not an array
> java.lang.IllegalArgumentException: Argument is not an array
>         at java.lang.reflect.Array.getLength(Native Method)
>         at
> org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:92)
>         at
> org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
>

I suspect it was the change to handle 
http://issues.apache.org/jira/browse/HADOOP-166.

I am working on tracking down what is going on.

-- Owen


From MAILER-DAEMON Thu Apr 27 17:14:09 2006
Return-Path: 
 <hadoop-dev-return-1081-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80345 invoked from network); 27 Apr 2006 17:14:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 17:14:09 -0000
Received: (qmail 3614 invoked by uid 500); 27 Apr 2006 17:14:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3597 invoked by uid 500); 27 Apr 2006 17:14:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3588 invoked by uid 99); 27 Apr 2006 17:14:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 10:14:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 10:14:08 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3RHDtci029869
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 13:13:55 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3RHDgYt180330;
	Thu, 27 Apr 2006 13:13:42 -0400
Message-ID: <4450FBC5.7010209@apache.org>
Date: Thu, 27 Apr 2006 10:13:41 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: hadoop svn head is broken
References: <00756dba8baf0b4d15ddfb621f61d97d@yahoo-inc.com>
In-Reply-To: <00756dba8baf0b4d15ddfb621f61d97d@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

My bad.  I'm fixing it right now.  I've already added unit tests which 
will catch this one next time!

Doug

Owen O'Malley wrote:
> I don't know what is up, but hadoop is broken this morning with the job 
> tracker getting:
> 
>> 1. in jobtracker log:
>> 060427 044020 Server handler 0 on 7020 caught:
>> java.lang.IllegalArgumentException: Argument is not an array
>> java.lang.IllegalArgumentException: Argument is not an array
>>         at java.lang.reflect.Array.getLength(Native Method)
>>         at
>> org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:92)
>>         at
>> org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
>>
> 
> I suspect it was the change to handle 
> http://issues.apache.org/jira/browse/HADOOP-166.
> 
> I am working on tracking down what is going on.
> 
> -- Owen
> 

From MAILER-DAEMON Thu Apr 27 17:17:02 2006
Return-Path: 
 <hadoop-dev-return-1082-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81389 invoked from network); 27 Apr 2006 17:17:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 17:17:02 -0000
Received: (qmail 8104 invoked by uid 500); 27 Apr 2006 17:17:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8077 invoked by uid 500); 27 Apr 2006 17:17:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8064 invoked by uid 99); 27 Apr 2006 17:17:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 10:17:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 10:17:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AA2B37142CF
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 17:16:37 +0000 (GMT)
Message-ID: <7167260.1146158197694.JavaMail.jira@brutus>
Date: Thu, 27 Apr 2006 17:16:37 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-172) rpc doesn't handle returning null for
 a String[]
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

rpc doesn't handle returning null for a String[]
------------------------------------------------

         Key: HADOOP-172
         URL: http://issues.apache.org/jira/browse/HADOOP-172
     Project: Hadoop
        Type: Bug

  Components: ipc  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Blocker
     Fix For: 0.2


The job tracker gets errors in returning the result from pollForTaskWithClosedJob

060427 100434 Served: pollForTaskWithClosedJob 0
declaredClass = [Ljava.lang.String;
instance class = org.apache.hadoop.io.NullWritable
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:95)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:65)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 17:24:25 2006
Return-Path: 
 <hadoop-dev-return-1083-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85123 invoked from network); 27 Apr 2006 17:24:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 17:24:25 -0000
Received: (qmail 20103 invoked by uid 500); 27 Apr 2006 17:24:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20081 invoked by uid 500); 27 Apr 2006 17:24:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20072 invoked by uid 99); 27 Apr 2006 17:24:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 10:24:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 10:24:23 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3RHNFbk031161
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 13:23:15 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3RHO0Sc270104;
	Thu, 27 Apr 2006 13:24:00 -0400
Message-ID: <4450FE2F.7020601@apache.org>
Date: Thu, 27 Apr 2006 10:23:59 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: hadoop svn head is broken
References: <00756dba8baf0b4d15ddfb621f61d97d@yahoo-inc.com>
In-Reply-To: <00756dba8baf0b4d15ddfb621f61d97d@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Fixed now.  Sorry for the inconvenience!

Doug

Owen O'Malley wrote:
> I don't know what is up, but hadoop is broken this morning with the job 
> tracker getting:
> 
>> 1. in jobtracker log:
>> 060427 044020 Server handler 0 on 7020 caught:
>> java.lang.IllegalArgumentException: Argument is not an array
>> java.lang.IllegalArgumentException: Argument is not an array
>>         at java.lang.reflect.Array.getLength(Native Method)
>>         at
>> org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:92)
>>         at
>> org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
>>
> 
> I suspect it was the change to handle 
> http://issues.apache.org/jira/browse/HADOOP-166.
> 
> I am working on tracking down what is going on.
> 
> -- Owen
> 

From MAILER-DAEMON Thu Apr 27 19:27:04 2006
Return-Path: 
 <hadoop-dev-return-1084-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63035 invoked from network); 27 Apr 2006 19:27:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 19:27:04 -0000
Received: (qmail 5805 invoked by uid 500); 27 Apr 2006 19:27:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5685 invoked by uid 500); 27 Apr 2006 19:27:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5676 invoked by uid 99); 27 Apr 2006 19:27:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 12:27:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 12:27:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7662D410013
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 19:26:39 +0000 (GMT)
Message-ID: <24263734.1146165999482.JavaMail.jira@brutus>
Date: Thu, 27 Apr 2006 19:26:39 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-171) need standard API to set dfs
 replication = high
In-Reply-To: <96548862.1146093962975.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-171?page=comments#action_12376786 ] 

Konstantin Shvachko commented on HADOOP-171:
--------------------------------------------

There are two different issues here, I think
1) asking for a replication hint.
This is what highReplicationHint() is for.
We can provide a parameter (strategy) making it look like
    short highReplicationHint( enum strategy )
This one is easy since it just returns a number based on the number of registered data nodes.
But it works for the problem of choosing replication for submitted job files (.jar, .xml).
2) dynamically maintaining replication of a file based on a chosen strategy and cluster size.
This is hard. 
Do we really need that now? 
Are submitted job files removed after the job is done?

> need standard API to set dfs replication = high
> -----------------------------------------------
>
>          Key: HADOOP-171
>          URL: http://issues.apache.org/jira/browse/HADOOP-171
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko

>
> There should be a standard way to indicate that files should be highly replicated, appropriate for files that all nodes will read.  This should be settable both on file creation and for already-existing files.  Perhaps specifying a particular replication value, like Short.MAX_VALUE, or zero, can be used to signal this.  The level should not be constant, but should be relative to the cluster size and network topography.  If more nodes are added or if nodes are deleted, the actual replication count should increase or decrease.
> Initially, all that is needed is an API to specify this.  It could initially be implemented with a constant (e.g., 10) or with something related to the number of datanodes (sqrt?), and needn't auto-adjust as the cluster size changes  That is only  the long-term goal.
> When JobClient copies job files (job.xml & job.jar) into the job's filesystem, it should specify this replication level.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 20:54:06 2006
Return-Path: 
 <hadoop-dev-return-1085-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8796 invoked from network); 27 Apr 2006 20:54:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 20:54:06 -0000
Received: (qmail 57515 invoked by uid 500); 27 Apr 2006 20:54:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57400 invoked by uid 500); 27 Apr 2006 20:54:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57248 invoked by uid 99); 27 Apr 2006 20:54:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 13:54:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 13:54:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3CE96410010
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 20:53:39 +0000 (GMT)
Message-ID: <32033198.1146171219247.JavaMail.jira@brutus>
Date: Thu, 27 Apr 2006 20:53:39 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-96?page=all ]

Hairong Kuang updated HADOOP-96:
--------------------------------

    Attachment: namenodeLogging.patch

This patch adds the following features
1. NameNode adds a static field "stateChangeLog" that keeps tracks of all the namenode state changes
2. Various logging statements are added to NameNode, FSNamesystem, FSDirectory. Basically namesapce (dir) changes are logged at the fine level and block changes are logged at the finer level
3. initFileHandler is added to LogFormatter. All logs are directed to a log file instead of stdout. All logs are rolled and capped in size. Log file names end with .log.
4. In hadoop-daemon.sh, stdout is redirected to a .out file.
5. namenode logging levels, log file max size, and number of generations are configurable.
6. A JUnit test program is added to test the correctness of namespace change logging.

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 21:00:02 2006
Return-Path: 
 <hadoop-dev-return-1086-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12311 invoked from network); 27 Apr 2006 21:00:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 21:00:02 -0000
Received: (qmail 70217 invoked by uid 500); 27 Apr 2006 21:00:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70112 invoked by uid 500); 27 Apr 2006 21:00:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70103 invoked by uid 99); 27 Apr 2006 21:00:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 14:00:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 14:00:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9067C41000D
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 20:59:37 +0000 (GMT)
Message-ID: <24825887.1146171577573.JavaMail.jira@brutus>
Date: Thu, 27 Apr 2006 20:59:37 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-173) optimize allocation of tasks w/ local
 data
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

optimize allocation of tasks w/ local data
------------------------------------------

         Key: HADOOP-173
         URL: http://issues.apache.org/jira/browse/HADOOP-173
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2    
    Reporter: Doug Cutting
 Assigned to: Doug Cutting 


When a job first starts, all task trackers ask the job tracker for jobs at once.  With lots of task trackers, the job tracker gets very slow.  The first type of task that the job tracker attempts to find is one with some of its input data stored on the same node as the task tracker.  This case currently loops through tasks blindly, which, on average, requires numHosts/(replication*2) iterations to find a match (I think).  This could be optimized by adding a table mapping from host to task.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 21:00:03 2006
Return-Path: 
 <hadoop-dev-return-1087-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12346 invoked from network); 27 Apr 2006 21:00:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 21:00:03 -0000
Received: (qmail 70288 invoked by uid 500); 27 Apr 2006 21:00:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70264 invoked by uid 500); 27 Apr 2006 21:00:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70250 invoked by uid 99); 27 Apr 2006 21:00:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 14:00:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 14:00:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8894B410014
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 20:59:38 +0000 (GMT)
Message-ID: <31107761.1146171578557.JavaMail.jira@brutus>
Date: Thu, 27 Apr 2006 20:59:38 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-172) rpc doesn't handle returning null for a
 String[]
In-Reply-To: <7167260.1146158197694.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-172?page=all ]
     
Owen O'Malley closed HADOOP-172:
--------------------------------

    Resolution: Fixed

Doug fixed this this morning.

> rpc doesn't handle returning null for a String[]
> ------------------------------------------------
>
>          Key: HADOOP-172
>          URL: http://issues.apache.org/jira/browse/HADOOP-172
>      Project: Hadoop
>         Type: Bug

>   Components: ipc
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Blocker
>      Fix For: 0.2

>
> The job tracker gets errors in returning the result from pollForTaskWithClosedJob
> 060427 100434 Served: pollForTaskWithClosedJob 0
> declaredClass = [Ljava.lang.String;
> instance class = org.apache.hadoop.io.NullWritable
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:95)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:65)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Apr 27 21:00:08 2006
Return-Path: 
 <hadoop-dev-return-1088-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12401 invoked from network); 27 Apr 2006 21:00:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Apr 2006 21:00:08 -0000
Received: (qmail 70454 invoked by uid 500); 27 Apr 2006 21:00:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70437 invoked by uid 500); 27 Apr 2006 21:00:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70428 invoked by uid 99); 27 Apr 2006 21:00:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 14:00:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Apr 2006 14:00:07 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0CEDF410015
	for <hadoop-dev@lucene.apache.org>; Thu, 27 Apr 2006 20:59:39 +0000 (GMT)
Message-ID: <1373357.1146171579050.JavaMail.jira@brutus>
Date: Thu, 27 Apr 2006 20:59:39 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-173) optimize allocation of tasks w/ local
 data
In-Reply-To: <24825887.1146171577573.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-173?page=all ]

Doug Cutting updated HADOOP-173:
--------------------------------

    Attachment: fast-local-task.patch

This patch optimizes the jobtracker's allocation of tasks to nodes that have local data.  I have tested it, but not yet on a large cluster.

> optimize allocation of tasks w/ local data
> ------------------------------------------
>
>          Key: HADOOP-173
>          URL: http://issues.apache.org/jira/browse/HADOOP-173
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>  Attachments: fast-local-task.patch
>
> When a job first starts, all task trackers ask the job tracker for jobs at once.  With lots of task trackers, the job tracker gets very slow.  The first type of task that the job tracker attempts to find is one with some of its input data stored on the same node as the task tracker.  This case currently loops through tasks blindly, which, on average, requires numHosts/(replication*2) iterations to find a match (I think).  This could be optimized by adding a table mapping from host to task.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 11:02:54 2006
Return-Path: 
 <hadoop-dev-return-1089-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78511 invoked from network); 28 Apr 2006 11:02:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 11:02:54 -0000
Received: (qmail 13978 invoked by uid 500); 28 Apr 2006 11:02:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13958 invoked by uid 500); 28 Apr 2006 11:02:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13949 invoked by uid 99); 28 Apr 2006 11:02:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 04:02:51 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.91] (HELO mailsrv.bangalore.corp.yahoo.com)
 (202.46.19.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 04:02:50 -0700
Received: from ddaslaptop (UNKNOWN-172-24-91-187.yahoo.com [172.24.91.187]
 (may be forged))
	by mailsrv.bangalore.corp.yahoo.com (8.13.6/8.13.4/pop-in) with ESMTP id
 k3SB2M8Q019227
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 16:32:23 +0530 (IST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=reply-to:from:to:subject:date:organization:message-id:
	mime-version:content-type:content-transfer-encoding:x-mailer:x-mimeole:
	thread-index:in-reply-to;
	b=mAg/BCtA4EkkDvmfz1zzzS+tiddAlBoCusMUBXcMmQcsWA6grw+1MJq0n7av3UQB
Reply-To: <ddas@yahoo-inc.com>
From: "Devaraj Das" <ddas@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: C API for Hadoop DFS
Date: Fri, 28 Apr 2006 16:33:28 +0530
Organization: Yahoo India
Message-ID: <029601c66ab3$615b2010$2201a8c0@ddaslaptop>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZqF5CiUdvuDqeSS6e9JSqgkQgKzQAmUTTw
In-Reply-To: <4450F0DB.6060206@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I was thinking that we really don't require the mCreationTime field in the
dfsFileInfo struct and instead have mModificationTime. For now,
mModificationTime is really the time at which the file got created. In the
future, this will hold the time the file was last updated at. 
Also, as part of future-proofing, should we have these fields too (as they
appear in the regular Unix stat structure) - mAccessTime,
mLastStatusChangeTime, st_uid (userid of owner), st_gid (gid of owner)? 
We can have mBlockSize too in the dfsFileInfo struct. This is the value
returned by the getBlockSize API considering the current impl of DFS. But I
observed from the mail exchanges that blocksize could be variable in the
future.

-----Original Message-----
From: Doug Cutting [mailto:cutting@apache.org] 
Sent: Thursday, April 27, 2006 9:57 PM
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS

Devaraj Das wrote:
> Thanks all for the feedback. I have incorporated most of them. Attached is
> the revised C API.

Thanks for revising this so quickly!

>   /** 
>   * dfsStat
>   * used for getting information about a file/directory
>   */
>   typedef struct  {
>     tObjectKind mKind;	/** file or directory */
>     char *mName; /* the name of the file */
>     tTime mCreationTime;
>     long  mSize; /*the size of the file in bytes */
>     bool replicated; /*whether this file is replicated */
>   } dfsFileInfo;

Should 'bool replicated' instead be a replication count?

>   /** return information about a path as a (dynamically allocated) array 
>   * of dfsFileInfo.
>   * numEntries is set to the number of elements in the array.
>   * If the path happens to be a file, the array will have just one
element.
>   * If the path happens to be a directory, the dfsFileInfo elements in the
>   * array will contain information about the files/sub-dirs within the
path.
>   * NULL is returned if the path does not exist or some other error is 
>   * encountered. freeDfsFileInfo should be called passing the array and 
>   * numEntries when it is no longer needed.
>   */
>   dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path, int *numEntries);

As mentioned in my previous message, perhaps this should be split into 
two functions:

dfsFileInfo *dfsGetPathInfo(dfsFS fs, char *path);
dfsFileInfo *dfsListDirectory(dfsFS fs, char *path, int *numEntries);

Doug



From MAILER-DAEMON Fri Apr 28 15:52:19 2006
Return-Path: 
 <hadoop-dev-return-1090-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49998 invoked from network); 28 Apr 2006 15:52:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 15:52:19 -0000
Received: (qmail 55732 invoked by uid 500); 28 Apr 2006 15:52:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55710 invoked by uid 500); 28 Apr 2006 15:52:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55701 invoked by uid 99); 28 Apr 2006 15:52:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 08:52:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 08:52:17 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3SFpung006045
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 11:51:57 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3SFpsmg271262;
	Fri, 28 Apr 2006 11:51:55 -0400
Message-ID: <44523A1A.7080009@apache.org>
Date: Fri, 28 Apr 2006 08:51:54 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <029601c66ab3$615b2010$2201a8c0@ddaslaptop>
In-Reply-To: <029601c66ab3$615b2010$2201a8c0@ddaslaptop>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Devaraj Das wrote:
> I was thinking that we really don't require the mCreationTime field in the
> dfsFileInfo struct and instead have mModificationTime. For now,
> mModificationTime is really the time at which the file got created.

We can always grow the API later, but it's hard to ever shrink it.  So 
I'd go with the minimum for now and only include a single time.  I'd 
suspect application code more often requires a modification time, so 
let's call it mModificationTime for now.  Does that make sense?

> We can have mBlockSize too in the dfsFileInfo struct. This is the value
> returned by the getBlockSize API considering the current impl of DFS. But I
> observed from the mail exchanges that blocksize could be variable in the
> future.

The current implementation internally supports variable block sizes 
within a file, but, for performance, we'll probably move towards a fixed 
block size for an entire file system.  Again, I think we should aim for 
the minimal API.  So I'd be happy with just a global per-FS blocksize in 
the API.  We can always later add per-file blocksizes if we need these, 
and then interpret the FS blocksize as a default.  Application uses of 
blocksize will be to optimize computations, so if, e.g., a legacy 
application someday uses the global FS blocksize when per-file 
blocksizes are supported, then it will still run, just perhaps more 
slowly when operating on files of non-default block size.

Doug

From MAILER-DAEMON Fri Apr 28 16:23:26 2006
Return-Path: 
 <hadoop-dev-return-1091-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69771 invoked from network); 28 Apr 2006 16:23:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 16:23:26 -0000
Received: (qmail 30898 invoked by uid 500); 28 Apr 2006 16:23:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30779 invoked by uid 500); 28 Apr 2006 16:23:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30770 invoked by uid 99); 28 Apr 2006 16:23:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 09:23:25 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 09:23:24 -0700
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3SGLtSu077107
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 09:21:55 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:thread-index:x-mimeole;
	b=Tb13Judgd4WUMs6HEclZsdewE1nbF7A5+YnMqOQ0HxfNz5Hm+EdXqJ2kW/ceLlDp
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: C API for Hadoop DFS
Date: Fri, 28 Apr 2006 09:21:55 -0700
Message-ID: <015801c66adf$dd85c2e0$496715ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <44523A1A.7080009@apache.org>
Thread-Index: AcZq27+CPzdW1WhoTNKasr5SyNg/zgAA4Cvw
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

 
> 
> Devaraj Das wrote:
> > I was thinking that we really don't require the 
> mCreationTime field in 
> > the dfsFileInfo struct and instead have mModificationTime. For now, 
> > mModificationTime is really the time at which the file got created.
> 
> We can always grow the API later, but it's hard to ever 
> shrink it.  So I'd go with the minimum for now and only 
> include a single time.  I'd suspect application code more 
> often requires a modification time, so let's call it 
> mModificationTime for now.  Does that make sense?

Modifying a structure in an API requires recompilation of the apps that use
it, so growing it is also undesirable. Having a couple extra values that are
set to some default value before they're fully supported is common enough,
and imposes minimal overhead.
I'd add anything that's remotele relevant from 'stat' to dfsFileInfo.
Directory listings however should contain then minimum required information.


From MAILER-DAEMON Fri Apr 28 16:51:56 2006
Return-Path: 
 <hadoop-dev-return-1092-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86079 invoked from network); 28 Apr 2006 16:51:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 16:51:56 -0000
Received: (qmail 85361 invoked by uid 500); 28 Apr 2006 16:51:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85343 invoked by uid 500); 28 Apr 2006 16:51:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85334 invoked by uid 99); 28 Apr 2006 16:51:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 09:51:55 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 09:51:55 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3SGokbk005884
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 12:50:47 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3SGpVvd108884;
	Fri, 28 Apr 2006 12:51:31 -0400
Message-ID: <44524813.4000403@apache.org>
Date: Fri, 28 Apr 2006 09:51:31 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <015801c66adf$dd85c2e0$496715ac@ds.corp.yahoo.com>
In-Reply-To: <015801c66adf$dd85c2e0$496715ac@ds.corp.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Yoram Arnon wrote:
> Modifying a structure in an API requires recompilation of the apps that use
> it, so growing it is also undesirable.

Recompiling should not be difficult.  If that is truly a concern, then 
we should not use a struct, but instead a void* and a set of functions 
to access it, or perhaps somehow version-stamp the API, so that the 
server/library can operate back-compatibly.

> Having a couple extra values that are
> set to some default value before they're fully supported is common enough,
> and imposes minimal overhead.

Regardless of what we have there today, chances are we will someday need 
to be able to add things to the stat.  We don't want to forever be 
saddled with unused fields.  If nothing else, we'll end up wasting time 
explaining to folks that they don't work.

> I'd add anything that's remotele relevant from 'stat' to dfsFileInfo.

-1  We are not building a unix FS.  For example, the file mode, uid, and 
gid are remotely relevant, but, until we design a permission scheme, 
these should not appear in dfsFileInfo.  We are unlikely to ever support 
access-time, but it is remotely relevant, and we may someday.

Doug

From MAILER-DAEMON Fri Apr 28 17:07:04 2006
Return-Path: 
 <hadoop-dev-return-1093-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91243 invoked from network); 28 Apr 2006 17:07:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 17:07:04 -0000
Received: (qmail 4269 invoked by uid 500); 28 Apr 2006 17:07:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4250 invoked by uid 500); 28 Apr 2006 17:07:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4241 invoked by uid 99); 28 Apr 2006 17:07:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 10:07:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 10:07:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 00B567142E6
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 17:06:37 +0000 (GMT)
Message-ID: <28452803.1146243997973.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 17:06:37 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-173) optimize allocation of tasks w/ local
 data
In-Reply-To: <24825887.1146171577573.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-173?page=all ]
     
Doug Cutting resolved HADOOP-173:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I committed this.

> optimize allocation of tasks w/ local data
> ------------------------------------------
>
>          Key: HADOOP-173
>          URL: http://issues.apache.org/jira/browse/HADOOP-173
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: fast-local-task.patch
>
> When a job first starts, all task trackers ask the job tracker for jobs at once.  With lots of task trackers, the job tracker gets very slow.  The first type of task that the job tracker attempts to find is one with some of its input data stored on the same node as the task tracker.  This case currently loops through tasks blindly, which, on average, requires numHosts/(replication*2) iterations to find a match (I think).  This could be optimized by adding a table mapping from host to task.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 17:10:40 2006
Return-Path: 
 <hadoop-dev-return-1094-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 92200 invoked from network); 28 Apr 2006 17:10:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 17:10:40 -0000
Received: (qmail 8574 invoked by uid 500); 28 Apr 2006 17:10:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8557 invoked by uid 500); 28 Apr 2006 17:10:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8547 invoked by uid 99); 28 Apr 2006 17:10:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 10:10:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 10:10:39 -0700
Received: from [192.168.0.253] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k3SHATQ16310
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 12:10:29 -0500
Message-ID: <44524C7B.6000003@getopt.org>
Date: Fri, 28 Apr 2006 19:10:19 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <015801c66adf$dd85c2e0$496715ac@ds.corp.yahoo.com>
 <44524813.4000403@apache.org>
In-Reply-To: <44524813.4000403@apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> -1  We are not building a unix FS.  For example, the file mode, uid, 
> and gid are remotely relevant, but, until we design a permission 
> scheme, these should not appear in dfsFileInfo.  We are unlikely to 
> ever support access-time, but it is remotely relevant, and we may 
> someday.

Slightly off-topic: access-time is perhaps an overkill, but creation and 
modification time would be great to have, there are many situations 
where it would be very useful to know when a file was created or 
modified ...

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Fri Apr 28 17:36:04 2006
Return-Path: 
 <hadoop-dev-return-1095-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4388 invoked from network); 28 Apr 2006 17:36:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 17:36:04 -0000
Received: (qmail 44514 invoked by uid 500); 28 Apr 2006 17:36:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44497 invoked by uid 500); 28 Apr 2006 17:36:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44488 invoked by uid 99); 28 Apr 2006 17:36:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 10:36:03 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.28] (HELO mrout2-b.corp.dcn.yahoo.com)
 (216.109.112.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 10:36:02 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout2-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k3SHZKCA024426
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 10:35:21 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=XFXIRBZ35TC0yAnCt15BvJFd80HK8SqiUWFT1AX+oZ1J1rEIYH1no9RcXV+fL3B1
Message-ID: <44525258.5080606@yahoo-inc.com>
Date: Fri, 28 Apr 2006 10:35:20 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <029601c66ab3$615b2010$2201a8c0@ddaslaptop>
 <44523A1A.7080009@apache.org>
In-Reply-To: <44523A1A.7080009@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


>> I was thinking that we really don't require the mCreationTime field 
>> in the
>> dfsFileInfo struct and instead have mModificationTime. For now,
>> mModificationTime is really the time at which the file got created.
>
>
> We can always grow the API later, but it's hard to ever shrink it.  So 
> I'd go with the minimum for now and only include a single time.  I'd 
> suspect application code more often requires a modification time, so 
> let's call it mModificationTime for now.  Does that make sense?
>
-1 on replacing mCreationTime with mModificationTime.
Supporting modification and access times is hard. Each time a file is 
modified in a directory the
directory's (and all parents') mod/access time should be modified, which 
becomes a bottleneck
whith concurrent access to the namespace.
There should be a very good reason for supporting modification times.
I do not see one.

>> We can have mBlockSize too in the dfsFileInfo struct. This is the value
>> returned by the getBlockSize API considering the current impl of DFS. 
>> But I
>> observed from the mail exchanges that blocksize could be variable in the
>> future.
>
>
> The current implementation internally supports variable block sizes 
> within a file, but, for performance, we'll probably move towards a 
> fixed block size for an entire file system.  Again, I think we should 
> aim for the minimal API.  So I'd be happy with just a global per-FS 
> blocksize in the API.  We can always later add per-file blocksizes if 
> we need these, and then interpret the FS blocksize as a default.  
> Application uses of blocksize will be to optimize computations, so if, 
> e.g., a legacy application someday uses the global FS blocksize when 
> per-file blocksizes are supported, then it will still run, just 
> perhaps more slowly when operating on files of non-default block size.

Yes


From MAILER-DAEMON Fri Apr 28 18:32:03 2006
Return-Path: 
 <hadoop-dev-return-1096-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29177 invoked from network); 28 Apr 2006 18:32:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 18:32:03 -0000
Received: (qmail 24955 invoked by uid 500); 28 Apr 2006 18:32:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24924 invoked by uid 500); 28 Apr 2006 18:32:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24915 invoked by uid 99); 28 Apr 2006 18:32:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 11:32:02 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [66.228.160.55] (HELO mercury2.inktomi.com) (66.228.160.55)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 11:32:01 -0700
Received: from inbox2.inktomi.com (inbox2.inktomi.com [66.228.160.112])
	by mercury2.inktomi.com (8.13.4/8.13.4) with ESMTP id k3SIVVFB002985
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 11:31:31 -0700 (PDT)
Received: from [207.126.231.126] ([207.126.231.126]) by
          inbox2.inktomi.com (Netscape Messaging Server 4.1) with ESMTP id
          IYG3GI00.PX4 for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr
          2006 11:31:30 -0700
Message-ID: <44525F81.8000708@yahoo-inc.com>
Date: Fri, 28 Apr 2006 11:31:29 -0700
From: Sameer Paranjpye <sameerp@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 0.7.1 (Windows/20040626)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <015801c66adf$dd85c2e0$496715ac@ds.corp.yahoo.com>
 <44524813.4000403@apache.org>
In-Reply-To: <44524813.4000403@apache.org>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I tend to agree with Doug. Having meaningless unused fields in a struct 
increases the danger of bugs and imposes the burden of making it clear 
that they don't work.

On the subject of modification vs creation time. Modification time is 
difficult to support with this kind of architecture. Every write to the 
FS would need an update to be made in the namenode which could quickly 
become prohibitive. Also, creation time can easily be used to emulate 
modification time at the application level when needed, an application 
can drop a completion stamp file when it finishes writing a data file 
(or any other activity).


Doug Cutting wrote:
> Yoram Arnon wrote:
> 
>> Modifying a structure in an API requires recompilation of the apps 
>> that use
>> it, so growing it is also undesirable.
> 
> 
> Recompiling should not be difficult.  If that is truly a concern, then 
> we should not use a struct, but instead a void* and a set of functions 
> to access it, or perhaps somehow version-stamp the API, so that the 
> server/library can operate back-compatibly.
> 
>> Having a couple extra values that are
>> set to some default value before they're fully supported is common 
>> enough,
>> and imposes minimal overhead.
> 
> 
> Regardless of what we have there today, chances are we will someday need 
> to be able to add things to the stat.  We don't want to forever be 
> saddled with unused fields.  If nothing else, we'll end up wasting time 
> explaining to folks that they don't work.
> 
>> I'd add anything that's remotele relevant from 'stat' to dfsFileInfo.
> 
> 
> -1  We are not building a unix FS.  For example, the file mode, uid, and 
> gid are remotely relevant, but, until we design a permission scheme, 
> these should not appear in dfsFileInfo.  We are unlikely to ever support 
> access-time, but it is remotely relevant, and we may someday.
> 
> Doug
> 

From MAILER-DAEMON Fri Apr 28 18:44:06 2006
Return-Path: 
 <hadoop-dev-return-1097-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33459 invoked from network); 28 Apr 2006 18:44:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 18:44:06 -0000
Received: (qmail 36581 invoked by uid 500); 28 Apr 2006 18:44:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36560 invoked by uid 500); 28 Apr 2006 18:44:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36551 invoked by uid 99); 28 Apr 2006 18:44:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 11:44:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 11:44:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CFE997142E5
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 18:43:39 +0000 (GMT)
Message-ID: <13360158.1146249819849.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 18:43:39 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-167) reducing the number of Configuration
 & JobConf objects created
In-Reply-To: <41048512.1146023582940.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-167?page=all ]
     
Doug Cutting resolved HADOOP-167:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> reducing the number of Configuration & JobConf objects created
> --------------------------------------------------------------
>
>          Key: HADOOP-167
>          URL: http://issues.apache.org/jira/browse/HADOOP-167
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: remove-confs.patch
>
> Currently, Configuration and JobConf objects are created many times during executing a job. In particular, the Task Tracker creates a lot of them. They both clutter up the logs and parse the xml config files over and over again.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 19:02:40 2006
Return-Path: 
 <hadoop-dev-return-1098-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40450 invoked from network); 28 Apr 2006 19:02:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 19:02:40 -0000
Received: (qmail 60722 invoked by uid 500); 28 Apr 2006 19:02:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60707 invoked by uid 500); 28 Apr 2006 19:02:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60698 invoked by uid 99); 28 Apr 2006 19:02:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 12:02:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 12:02:38 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k3SJ1Ubk011748
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 15:01:31 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout6-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k3SJ2E3u245632;
	Fri, 28 Apr 2006 15:02:15 -0400
Message-ID: <445266B6.1080109@apache.org>
Date: Fri, 28 Apr 2006 12:02:14 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <015801c66adf$dd85c2e0$496715ac@ds.corp.yahoo.com>
 <44524813.4000403@apache.org> <44525F81.8000708@yahoo-inc.com>
In-Reply-To: <44525F81.8000708@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Sameer Paranjpye wrote:
> On the subject of modification vs creation time. Modification time is 
> difficult to support with this kind of architecture. Every write to the 
> FS would need an update to be made in the namenode which could quickly 
> become prohibitive.

Right, I forgot about directories, that their mod time changes whenever 
a file within changes.  So let's stick with just created for now.

Doug

From MAILER-DAEMON Fri Apr 28 21:02:09 2006
Return-Path: 
 <hadoop-dev-return-1099-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 518 invoked from network); 28 Apr 2006 21:02:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 21:02:09 -0000
Received: (qmail 41761 invoked by uid 500); 28 Apr 2006 21:02:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41738 invoked by uid 500); 28 Apr 2006 21:02:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41729 invoked by uid 99); 28 Apr 2006 21:02:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:02:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:02:07 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B42927142E7
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 21:01:37 +0000 (GMT)
Message-ID: <27491623.1146258097733.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 21:01:37 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-174) jobclient kills job for one timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

jobclient kills job for one timeout
-----------------------------------

         Key: HADOOP-174
         URL: http://issues.apache.org/jira/browse/HADOOP-174
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


The launching application (via JobClient) checks the status once a second. If any timeouts or errors occur, the user's job is killed. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 21:04:05 2006
Return-Path: 
 <hadoop-dev-return-1100-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1275 invoked from network); 28 Apr 2006 21:04:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 21:04:05 -0000
Received: (qmail 44150 invoked by uid 500); 28 Apr 2006 21:04:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44134 invoked by uid 500); 28 Apr 2006 21:04:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44116 invoked by uid 99); 28 Apr 2006 21:04:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:04:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:04:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 647137142E6
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 21:03:38 +0000 (GMT)
Message-ID: <4927410.1146258218408.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 21:03:38 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-174) jobclient kills job for one timeout
In-Reply-To: <27491623.1146258097733.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-174?page=all ]

Owen O'Malley updated HADOOP-174:
---------------------------------

    Attachment: jobclient-retry.patch

This patch puts a retry loop in to the JobClient.

It also changes the type of the exception thrown for rpc timeouts to SocketTimeoutException.

> jobclient kills job for one timeout
> -----------------------------------
>
>          Key: HADOOP-174
>          URL: http://issues.apache.org/jira/browse/HADOOP-174
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: jobclient-retry.patch
>
> The launching application (via JobClient) checks the status once a second. If any timeouts or errors occur, the user's job is killed. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 21:26:38 2006
Return-Path: 
 <hadoop-dev-return-1102-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14346 invoked from network); 28 Apr 2006 21:26:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 21:26:38 -0000
Received: (qmail 72679 invoked by uid 500); 28 Apr 2006 21:26:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72654 invoked by uid 500); 28 Apr 2006 21:26:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72645 invoked by uid 99); 28 Apr 2006 21:26:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:26:37 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:26:35 -0700
Received: from [207.126.231.161] (oom-mac.corp.yahoo.com [207.126.231.161])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k3SLOiMe019132
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 14:24:44 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:content-transfer-encoding:message-id:
	content-type:to:from:subject:date:x-mailer;
	b=JsPcp9QLVSwX8fIKniYLSDPjYeT3PFo11R1AOs8BryFSFa8w4PoHX2bkFQObvcsw
Mime-Version: 1.0 (Apple Message framework v623)
Content-Transfer-Encoding: 7bit
Message-Id: <8280d1c7a2bea07b410d7ac4807bf035@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
To: hadoop-dev@lucene.apache.org
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: don't include hadoop-default.xml in external HADOOP_CONF_DIR
Date: Fri, 28 Apr 2006 14:24:47 -0700
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi all,
    I just wanted to point out a mis-configuration that just bit me 
today so that others can avoid the problem. My setup looks like:

HADOOP_HOME=<prefix>/hadoop-0.2-dev
HADOOP_CONF_DIR=<prefix>/conf

HADOOP_CONF_DIR had:
configuration.xsl*
hadoop-default.xml
hadoop-env.sh*
hadoop-site.xml*
mapred-default.xml*
slaves*

And when I upgrade, I only update HADOOP_HOME. The problem was that one 
of the recent changes added some properties into hadoop-default.xml 
that were different from their defaults in the code. Since the property 
wasn't in my hadoop-default.xml, it used the compiled default value. 
*crash* *bang*

After discussing it with Doug, the proper setup is to get 
hadoop-default.xml out of the jar file, so that it always current with 
respect to your distribution. After I deleted hadoop-default.xml out of 
my conf directory, it worked great.

-- Owen


From MAILER-DAEMON Fri Apr 28 21:26:05 2006
Return-Path: 
 <hadoop-dev-return-1101-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13744 invoked from network); 28 Apr 2006 21:26:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 21:26:05 -0000
Received: (qmail 71358 invoked by uid 500); 28 Apr 2006 21:26:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71231 invoked by uid 500); 28 Apr 2006 21:26:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71212 invoked by uid 99); 28 Apr 2006 21:26:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:26:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:26:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7EAB27142DF
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 21:25:38 +0000 (GMT)
Message-ID: <13824872.1146259538516.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 21:25:38 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-174) jobclient kills job for one timeout
In-Reply-To: <27491623.1146258097733.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-174?page=all ]
     
Doug Cutting resolved HADOOP-174:
---------------------------------

    Resolution: Invalid

I just committed this.  Thanks, Owen!

> jobclient kills job for one timeout
> -----------------------------------
>
>          Key: HADOOP-174
>          URL: http://issues.apache.org/jira/browse/HADOOP-174
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: jobclient-retry.patch
>
> The launching application (via JobClient) checks the status once a second. If any timeouts or errors occur, the user's job is killed. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 21:58:04 2006
Return-Path: 
 <hadoop-dev-return-1103-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29542 invoked from network); 28 Apr 2006 21:58:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 21:58:04 -0000
Received: (qmail 32164 invoked by uid 500); 28 Apr 2006 21:58:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32139 invoked by uid 500); 28 Apr 2006 21:58:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32124 invoked by uid 99); 28 Apr 2006 21:58:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:58:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 14:58:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 981C37142E6
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 21:57:37 +0000 (GMT)
Message-ID: <5632493.1146261457620.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 21:57:37 +0000 (GMT+00:00)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-175) Utilities for reading SequenceFile and
 MapFile
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Utilities for reading SequenceFile and MapFile
----------------------------------------------

         Key: HADOOP-175
         URL: http://issues.apache.org/jira/browse/HADOOP-175
     Project: Hadoop
        Type: Improvement

  Components: io  
    Reporter: Andrzej Bialecki 
    Priority: Minor


Most data in Hadoop is stored in SequenceFile-s and MapFile-s. Sometimes there is a need to examine such files, but no specialized utilities exist ro read them.

These two classes provide a functionality to examine individual records in such files, and also to dump the content of such files to a plain text output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 22:00:04 2006
Return-Path: 
 <hadoop-dev-return-1104-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30343 invoked from network); 28 Apr 2006 22:00:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 22:00:04 -0000
Received: (qmail 34496 invoked by uid 500); 28 Apr 2006 22:00:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34480 invoked by uid 500); 28 Apr 2006 22:00:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34471 invoked by uid 99); 28 Apr 2006 22:00:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:00:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:00:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8B3027142E6
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 21:59:38 +0000 (GMT)
Message-ID: <12685268.1146261578566.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 21:59:38 +0000 (GMT+00:00)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-175) Utilities for reading SequenceFile and
 MapFile
In-Reply-To: <5632493.1146261457620.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-175?page=all ]

Andrzej Bialecki  updated HADOOP-175:
-------------------------------------

    Attachment: patch.txt

> Utilities for reading SequenceFile and MapFile
> ----------------------------------------------
>
>          Key: HADOOP-175
>          URL: http://issues.apache.org/jira/browse/HADOOP-175
>      Project: Hadoop
>         Type: Improvement

>   Components: io
>     Reporter: Andrzej Bialecki 
>     Priority: Minor
>  Attachments: patch.txt
>
> Most data in Hadoop is stored in SequenceFile-s and MapFile-s. Sometimes there is a need to examine such files, but no specialized utilities exist ro read them.
> These two classes provide a functionality to examine individual records in such files, and also to dump the content of such files to a plain text output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 22:17:04 2006
Return-Path: 
 <hadoop-dev-return-1105-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36759 invoked from network); 28 Apr 2006 22:17:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 22:17:04 -0000
Received: (qmail 50791 invoked by uid 500); 28 Apr 2006 22:17:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50774 invoked by uid 500); 28 Apr 2006 22:17:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50764 invoked by uid 99); 28 Apr 2006 22:17:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:17:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:17:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 58FA27142E2
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 22:16:38 +0000 (GMT)
Message-ID: <33311668.1146262598362.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 22:16:38 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Reopened: (HADOOP-174) jobclient kills job for one timeout
In-Reply-To: <27491623.1146258097733.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-174?page=all ]
     
Owen O'Malley reopened HADOOP-174:
----------------------------------


> jobclient kills job for one timeout
> -----------------------------------
>
>          Key: HADOOP-174
>          URL: http://issues.apache.org/jira/browse/HADOOP-174
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: jobclient-retry.patch
>
> The launching application (via JobClient) checks the status once a second. If any timeouts or errors occur, the user's job is killed. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 22:17:05 2006
Return-Path: 
 <hadoop-dev-return-1106-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36794 invoked from network); 28 Apr 2006 22:17:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 22:17:05 -0000
Received: (qmail 50934 invoked by uid 500); 28 Apr 2006 22:17:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50916 invoked by uid 500); 28 Apr 2006 22:17:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50907 invoked by uid 99); 28 Apr 2006 22:17:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:17:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:17:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 38CD97142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 22:16:39 +0000 (GMT)
Message-ID: <14872313.1146262599230.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 22:16:39 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-174) jobclient kills job for one timeout
In-Reply-To: <27491623.1146258097733.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-174?page=all ]
     
Owen O'Malley closed HADOOP-174:
--------------------------------

    Resolution: Fixed

> jobclient kills job for one timeout
> -----------------------------------
>
>          Key: HADOOP-174
>          URL: http://issues.apache.org/jira/browse/HADOOP-174
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: jobclient-retry.patch
>
> The launching application (via JobClient) checks the status once a second. If any timeouts or errors occur, the user's job is killed. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 22:23:09 2006
Return-Path: 
 <hadoop-dev-return-1107-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38959 invoked from network); 28 Apr 2006 22:23:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 22:23:09 -0000
Received: (qmail 57039 invoked by uid 500); 28 Apr 2006 22:23:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56968 invoked by uid 500); 28 Apr 2006 22:23:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56924 invoked by uid 99); 28 Apr 2006 22:23:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:23:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:23:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C9F637142EA
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 22:22:40 +0000 (GMT)
Message-ID: <675338.1146262960824.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 22:22:40 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-175) Utilities for reading SequenceFile
 and MapFile
In-Reply-To: <5632493.1146261457620.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-175?page=comments#action_12377022 ] 

Doug Cutting commented on HADOOP-175:
-------------------------------------

+1

Instead of putting these in in util, why not have them as the main() for MapFile and SequenceFile?

Also, it might be good to integrate these into bin/hadoop.

> Utilities for reading SequenceFile and MapFile
> ----------------------------------------------
>
>          Key: HADOOP-175
>          URL: http://issues.apache.org/jira/browse/HADOOP-175
>      Project: Hadoop
>         Type: Improvement

>   Components: io
>     Reporter: Andrzej Bialecki 
>     Priority: Minor
>  Attachments: patch.txt
>
> Most data in Hadoop is stored in SequenceFile-s and MapFile-s. Sometimes there is a need to examine such files, but no specialized utilities exist ro read them.
> These two classes provide a functionality to examine individual records in such files, and also to dump the content of such files to a plain text output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 22:27:04 2006
Return-Path: 
 <hadoop-dev-return-1108-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41123 invoked from network); 28 Apr 2006 22:27:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 22:27:04 -0000
Received: (qmail 60871 invoked by uid 500); 28 Apr 2006 22:27:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60849 invoked by uid 500); 28 Apr 2006 22:27:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60840 invoked by uid 99); 28 Apr 2006 22:27:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:27:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:27:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 483867142E6
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 22:26:38 +0000 (GMT)
Message-ID: <10355648.1146263198293.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 22:26:38 +0000 (GMT+00:00)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-175) Utilities for reading SequenceFile
 and MapFile
In-Reply-To: <5632493.1146261457620.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-175?page=comments#action_12377026 ] 

Andrzej Bialecki  commented on HADOOP-175:
------------------------------------------

Ok, I'll rework the patch along these lines.

> Utilities for reading SequenceFile and MapFile
> ----------------------------------------------
>
>          Key: HADOOP-175
>          URL: http://issues.apache.org/jira/browse/HADOOP-175
>      Project: Hadoop
>         Type: Improvement

>   Components: io
>     Reporter: Andrzej Bialecki 
>     Priority: Minor
>  Attachments: patch.txt
>
> Most data in Hadoop is stored in SequenceFile-s and MapFile-s. Sometimes there is a need to examine such files, but no specialized utilities exist ro read them.
> These two classes provide a functionality to examine individual records in such files, and also to dump the content of such files to a plain text output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 22:29:07 2006
Return-Path: 
 <hadoop-dev-return-1109-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41459 invoked from network); 28 Apr 2006 22:29:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 22:29:07 -0000
Received: (qmail 61548 invoked by uid 500); 28 Apr 2006 22:29:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61522 invoked by uid 500); 28 Apr 2006 22:29:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61513 invoked by uid 99); 28 Apr 2006 22:29:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:29:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 15:29:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 59AE07142E6
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 22:28:38 +0000 (GMT)
Message-ID: <19988518.1146263318364.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 22:28:38 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-175) Utilities for reading SequenceFile
 and MapFile
In-Reply-To: <5632493.1146261457620.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-175?page=comments#action_12377027 ] 

Doug Cutting commented on HADOOP-175:
-------------------------------------

Also, we could add a generic dumper that sniffs the magic number of a file and dumps it accordingly.  If it's a file that begins with {'S', 'E', 'Q' , 3} then it's a sequence file, if its a directory with sequence files named "index" and "data", then its a map file, if none of the first 100 bytes are less than 32, then its text, etc.

> Utilities for reading SequenceFile and MapFile
> ----------------------------------------------
>
>          Key: HADOOP-175
>          URL: http://issues.apache.org/jira/browse/HADOOP-175
>      Project: Hadoop
>         Type: Improvement

>   Components: io
>     Reporter: Andrzej Bialecki 
>     Priority: Minor
>  Attachments: patch.txt
>
> Most data in Hadoop is stored in SequenceFile-s and MapFile-s. Sometimes there is a need to examine such files, but no specialized utilities exist ro read them.
> These two classes provide a functionality to examine individual records in such files, and also to dump the content of such files to a plain text output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Apr 28 23:26:09 2006
Return-Path: 
 <hadoop-dev-return-1110-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54303 invoked from network); 28 Apr 2006 23:26:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Apr 2006 23:26:09 -0000
Received: (qmail 1388 invoked by uid 500); 28 Apr 2006 23:26:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1292 invoked by uid 500); 28 Apr 2006 23:26:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1273 invoked by uid 99); 28 Apr 2006 23:26:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 16:26:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 16:26:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 450AA7142EA
	for <hadoop-dev@lucene.apache.org>; Fri, 28 Apr 2006 23:25:41 +0000 (GMT)
Message-ID: <32718830.1146266741279.JavaMail.jira@brutus>
Date: Fri, 28 Apr 2006 23:25:41 +0000 (GMT+00:00)
From: "Dick King (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-176) comparators of integral writable types
 are not transitive for inequalities
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

comparators of integral writable types are not transitive for inequalities
--------------------------------------------------------------------------

         Key: HADOOP-176
         URL: http://issues.apache.org/jira/browse/HADOOP-176
     Project: Hadoop
        Type: Bug

  Components: io  
 Environment: red hat
    Reporter: Dick King


Consider the following code from IntWritable.java :

    public int compare(byte[] b1, int s1, int l1,
                       byte[] b2, int s2, int l2) {
      int thisValue = readInt(b1, s1);
      int thatValue = readInt(b2, s2);
      return thisValue - thatValue;
    }

If a Java Runtime subtracts 20 from -(2^31 - 10) it gets a huge positive number, not the negative value that the comparator should return.

LongWritable does this right, of course.

That last line should be

       return (thisValue<thatValue ? -1 : (thisValue==thatValue ? 0 : 1));

-dk


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 29 02:28:24 2006
Return-Path: 
 <hadoop-dev-return-1111-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6453 invoked from network); 29 Apr 2006 02:28:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Apr 2006 02:28:24 -0000
Received: (qmail 36740 invoked by uid 500); 29 Apr 2006 02:28:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36614 invoked by uid 500); 29 Apr 2006 02:28:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36601 invoked by uid 99); 29 Apr 2006 02:28:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 19:28:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [207.241.227.188] (HELO mail.archive.org) (207.241.227.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Apr 2006 19:28:19 -0700
Received: from localhost (localhost [127.0.0.1])
	by mail.archive.org (Postfix) with ESMTP id D0F08141566C2;
	Fri, 28 Apr 2006 19:27:58 -0700 (PDT)
Received: from mail.archive.org ([127.0.0.1])
	by localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)
	with LMTP id 25770-05-18; Fri, 28 Apr 2006 19:27:58 -0700 (PDT)
Received: from [192.168.1.19] (unknown [63.203.238.114])
	by mail.archive.org (Postfix) with ESMTP id 3E51C14156642;
	Fri, 28 Apr 2006 19:27:58 -0700 (PDT)
Message-ID: <4452C171.7090709@archive.org>
Date: Fri, 28 Apr 2006 18:29:21 -0700
From: "stack@archive.org" <stack@archive.org>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US;
 rv:1.8.0.1) Gecko/20060130 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: CrawlDbReducer and the lone STATUS_SIGNATURE record
Content-Type: multipart/mixed;
 boundary="------------060604090607000507060109"
X-Virus-Scanned: Debian amavisd-new at archive.org
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--------------060604090607000507060109
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

CrawlDbReducer#reduce doesn't have a switch case for 
CrawlDatum.STATUS-SIGNATURE so we fall into the default (line #121) 
block which throws a RuntimeException.   This causes my update db job to 
never succeed.

This has just recently started happening.

Enabling logging I see that what usually happens is that a CrawlDatum 
with a STATUS_SIGNATURE status comes through first and is set to be 
'highest' (line #49) but then the next record through takes over the 
'highest' role because its status is higher, usually 'fetch_success' or 
'linked' in my case.

But for reasons not clear to me, I'll sometimes have a lone CrawlDatum 
with a status of STATUS_SIGNATURE (A mapout lost a record?) with no 
following 'fetch_success' or 'linked' CrawlDatum.  

This probably shouldn't fail the job.

Attached is a patch that logs a warning and keeps going but probably not 
the right soln.

Thanks,
St.Ack



--------------060604090607000507060109
Content-Type: text/plain;
 name="CrawlDbReducer.STATUS_SIGNATURE.patch"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="CrawlDbReducer.STATUS_SIGNATURE.patch"

Index: src/java/org/apache/nutch/crawl/CrawlDbReducer.java
===================================================================
--- src/java/org/apache/nutch/crawl/CrawlDbReducer.java	(revision 397664)
+++ src/java/org/apache/nutch/crawl/CrawlDbReducer.java	(working copy)
@@ -19,11 +19,16 @@
 import java.util.Iterator;
 import java.io.IOException;
 
+import java.util.logging.*;
+
 import org.apache.hadoop.io.*;
 import org.apache.hadoop.mapred.*;
+import org.apache.hadoop.util.LogFormatter;
 
 /** Merge new page entries with existing entries. */
 public class CrawlDbReducer implements Reducer {
+  public static final Logger LOG =
+    LogFormatter.getLogger("org.apache.nutch.crawl.CrawlDbReducer");
   private int retryMax;
   private CrawlDatum result = new CrawlDatum();
 
@@ -102,6 +107,8 @@
       result.setNextFetchTime();
       break;
 
+    case CrawlDatum.STATUS_SIGNATURE:
+      LOG.warning("Lone CrawlDatum.STATUS_SIGNATURE: " + key);      
     case CrawlDatum.STATUS_FETCH_RETRY:           // temporary failure
       if (old != null)
         result.setSignature(old.getSignature());  // use old signature
@@ -119,7 +126,7 @@
       break;
 
     default:
-      throw new RuntimeException("Unknown status: "+highest.getStatus());
+      throw new RuntimeException("Unknown status: "+highest.getStatus() + " " + key);
     }
     
     result.setScore(result.getScore() + scoreIncrement);

--------------060604090607000507060109--

From MAILER-DAEMON Sat Apr 29 15:29:11 2006
Return-Path: 
 <hadoop-dev-return-1112-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27912 invoked from network); 29 Apr 2006 15:29:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Apr 2006 15:29:11 -0000
Received: (qmail 62887 invoked by uid 500); 29 Apr 2006 15:29:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62627 invoked by uid 500); 29 Apr 2006 15:29:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62296 invoked by uid 99); 29 Apr 2006 15:29:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 29 Apr 2006 08:29:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 29 Apr 2006 08:29:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 246957142D7
	for <hadoop-dev@lucene.apache.org>; Sat, 29 Apr 2006 15:28:40 +0000 (GMT)
Message-ID: <30237121.1146324520146.JavaMail.jira@brutus>
Date: Sat, 29 Apr 2006 15:28:40 +0000 (GMT+00:00)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-175) Utilities for reading SequenceFile
 and MapFile
In-Reply-To: <5632493.1146261457620.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-175?page=comments#action_12377089 ] 

Andrzej Bialecki  commented on HADOOP-175:
------------------------------------------

Actually, I may have misled you by the poor choice of class names ... come to think of that, the subject is not too clear either. These two utilities started as readers of SequenceFile and MapFile, but now they read SequenceFileOutputFormat and MapFileOutputFormat ... so if anything I think their place is in the main methods of these classes.

I could add similar main() methods to SequenceFile.Reader and MapFile.Reader while I'm here ...

> Utilities for reading SequenceFile and MapFile
> ----------------------------------------------
>
>          Key: HADOOP-175
>          URL: http://issues.apache.org/jira/browse/HADOOP-175
>      Project: Hadoop
>         Type: Improvement

>   Components: io
>     Reporter: Andrzej Bialecki 
>     Priority: Minor
>  Attachments: patch.txt
>
> Most data in Hadoop is stored in SequenceFile-s and MapFile-s. Sometimes there is a need to examine such files, but no specialized utilities exist ro read them.
> These two classes provide a functionality to examine individual records in such files, and also to dump the content of such files to a plain text output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Apr 29 21:06:06 2006
Return-Path: 
 <hadoop-dev-return-1113-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39501 invoked from network); 29 Apr 2006 21:06:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Apr 2006 21:06:06 -0000
Received: (qmail 867 invoked by uid 500); 29 Apr 2006 21:06:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 745 invoked by uid 500); 29 Apr 2006 21:06:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 736 invoked by uid 99); 29 Apr 2006 21:06:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 29 Apr 2006 14:06:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 29 Apr 2006 14:06:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4C9DB7142D7
	for <hadoop-dev@lucene.apache.org>; Sat, 29 Apr 2006 21:05:38 +0000 (GMT)
Message-ID: <9623234.1146344738311.JavaMail.jira@brutus>
Date: Sat, 29 Apr 2006 21:05:38 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-175) Utilities for reading SequenceFile
 and MapFile
In-Reply-To: <5632493.1146261457620.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-175?page=comments#action_12377125 ] 

Doug Cutting commented on HADOOP-175:
-------------------------------------

> I could add similar main() methods to SequenceFile.Reader and MapFile.Reader  ...

Yes, please!  Also, the OutputFormat versions could call routines from these, no?  They would mostly be directory iterators, right, but could use the primitive MapFile & SequenceFile to dump records.

> Utilities for reading SequenceFile and MapFile
> ----------------------------------------------
>
>          Key: HADOOP-175
>          URL: http://issues.apache.org/jira/browse/HADOOP-175
>      Project: Hadoop
>         Type: Improvement

>   Components: io
>     Reporter: Andrzej Bialecki 
>     Priority: Minor
>  Attachments: patch.txt
>
> Most data in Hadoop is stored in SequenceFile-s and MapFile-s. Sometimes there is a need to examine such files, but no specialized utilities exist ro read them.
> These two classes provide a functionality to examine individual records in such files, and also to dump the content of such files to a plain text output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


