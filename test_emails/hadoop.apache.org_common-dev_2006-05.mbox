From MAILER-DAEMON Sun Apr 30 22:17:07 2006
Return-Path: 
 <hadoop-dev-return-1114-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18752 invoked from network); 30 Apr 2006 22:17:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Apr 2006 22:17:07 -0000
Received: (qmail 5903 invoked by uid 500); 30 Apr 2006 22:17:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5828 invoked by uid 500); 30 Apr 2006 22:17:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5819 invoked by uid 99); 30 Apr 2006 22:17:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Apr 2006 15:17:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Apr 2006 15:17:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A8DB77142C6
	for <hadoop-dev@lucene.apache.org>; Sun, 30 Apr 2006 22:16:37 +0000 (GMT)
Message-ID: <9747441.1146435397688.JavaMail.jira@brutus>
Date: Sun, 30 Apr 2006 22:16:37 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-177) improvement to browse through the
 map/reduce tasks
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

improvement to browse through the map/reduce tasks 
---------------------------------------------------

         Key: HADOOP-177
         URL: http://issues.apache.org/jira/browse/HADOOP-177
     Project: Hadoop
        Type: Improvement

    Reporter: Mahadev konar
    Priority: Minor


The Jobtracker webbapp currently shows all the maps and reduce tasks on a single page. This sometimes causes the browser to crash with 1000's of maps/recudes running.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Apr 30 22:21:07 2006
Return-Path: 
 <hadoop-dev-return-1115-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19519 invoked from network); 30 Apr 2006 22:21:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Apr 2006 22:21:07 -0000
Received: (qmail 7471 invoked by uid 500); 30 Apr 2006 22:21:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7452 invoked by uid 500); 30 Apr 2006 22:21:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7443 invoked by uid 99); 30 Apr 2006 22:21:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Apr 2006 15:21:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Apr 2006 15:21:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 51F0C7142C4
	for <hadoop-dev@lucene.apache.org>; Sun, 30 Apr 2006 22:20:38 +0000 (GMT)
Message-ID: <10023248.1146435638333.JavaMail.jira@brutus>
Date: Sun, 30 Apr 2006 22:20:38 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-177) improvement to browse through the
 map/reduce tasks
In-Reply-To: <9747441.1146435397688.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-177?page=all ]

Mahadev konar updated HADOOP-177:
---------------------------------

    Attachment: webapp.patch

This patch allows to browse through the map/reduce tasks with a maximum of 2000 tasks been shown on a single page. 

> improvement to browse through the map/reduce tasks
> --------------------------------------------------
>
>          Key: HADOOP-177
>          URL: http://issues.apache.org/jira/browse/HADOOP-177
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: webapp.patch
>
> The Jobtracker webbapp currently shows all the maps and reduce tasks on a single page. This sometimes causes the browser to crash with 1000's of maps/recudes running.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 02:42:18 2006
Return-Path: 
 <hadoop-dev-return-1116-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 98830 invoked from network); 1 May 2006 02:42:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 02:42:18 -0000
Received: (qmail 70850 invoked by uid 500); 1 May 2006 02:42:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70819 invoked by uid 500); 1 May 2006 02:42:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70810 invoked by uid 99); 1 May 2006 02:42:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Apr 2006 19:42:17 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.126.228.149] (HELO rsmtp1.corp.yahoo.com)
 (207.126.228.149)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Apr 2006 19:42:15 -0700
Received: from [192.168.123.132] (S010600062589378a.vn.shawcable.net
 [24.82.143.46])
	(authenticated bits=0)
	by rsmtp1.corp.yahoo.com (8.13.6/8.13.6/y.rout) with ESMTP id k412fW0X079991
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <hadoop-dev@lucene.apache.org>; Sun, 30 Apr 2006 19:41:33 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:organization:user-agent:mime-version:to:
	subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=ra537g/6x0STdA69PglkhXSv25m1GuV7jtng4Ymmz3lfYoCi4N2/+xdCyycgTXZy
Message-ID: <445575BE.6050409@yahoo-inc.com>
Date: Sun, 30 Apr 2006 19:43:10 -0700
From: David Bowen <dbowen@yahoo-inc.com>
Organization: Yahoo! Inc.
User-Agent: Thunderbird 1.5 (X11/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <024001c669ef$63660b50$2201a8c0@ddaslaptop>
In-Reply-To: <024001c669ef$63660b50$2201a8c0@ddaslaptop>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


I'm curious about error handling. 

Do dfsConnect and dfsOpenFile return NULL on failure?

Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
dfsSetWorkingDirectory each have a return value to indicate success or 
failure?  Or are they assumed to never fail?

- David



From MAILER-DAEMON Mon May  1 14:04:15 2006
Return-Path: 
 <hadoop-dev-return-1117-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27706 invoked from network); 1 May 2006 14:04:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 14:04:15 -0000
Received: (qmail 64631 invoked by uid 500); 1 May 2006 14:04:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64509 invoked by uid 500); 1 May 2006 14:04:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64500 invoked by uid 99); 1 May 2006 14:04:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 07:04:14 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.126.228.149] (HELO rsmtp1.corp.yahoo.com)
 (207.126.228.149)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 07:04:14 -0700
Received: from [192.168.123.132] (S010600062589378a.vn.shawcable.net
 [24.82.143.46])
	(authenticated bits=0)
	by rsmtp1.corp.yahoo.com (8.13.6/8.13.6/y.rout) with ESMTP id k41E3dMg094524
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <hadoop-dev@lucene.apache.org>; Mon, 1 May 2006 07:03:40 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:organization:user-agent:mime-version:to:
	subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=nx+fjUPPtZ4U/B7nozdLAZE7fq/wE8un2qkjVpXR+N91PnC52zmshcKUoVJQa/Qh
Message-ID: <4456159D.4070908@yahoo-inc.com>
Date: Mon, 01 May 2006 07:05:17 -0700
From: David Bowen <dbowen@yahoo-inc.com>
Organization: Yahoo! Inc.
User-Agent: Thunderbird 1.5 (X11/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: svn commit: r397269 - in
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi:
 AbstractMetricsContext.java MetricsRecordImpl.java
References: <20060426184322.33359.qmail@minotaur.apache.org>
In-Reply-To: <20060426184322.33359.qmail@minotaur.apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


Doug,

Thanks for making those fixes.  I will take care to test properly with 
1.4 in future.

- David

cutting@apache.org wrote:
> Author: cutting
> Date: Wed Apr 26 11:43:20 2006
> New Revision: 397269
>
> URL: http://svn.apache.org/viewcvs?rev=397269&view=rev
> Log:
> Remove some Java 1.5 dependencies from the new metrics code.
>
> Modified:
>     lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/AbstractMetricsContext.java
>     lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/MetricsRecordImpl.java
>
> Modified: lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/AbstractMetricsContext.java
> URL: http://svn.apache.org/viewcvs/lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/AbstractMetricsContext.java?rev=397269&r1=397268&r2=397269&view=diff
> ==============================================================================
> --- lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/AbstractMetricsContext.java (original)
> +++ lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/AbstractMetricsContext.java Wed Apr 26 11:43:20 2006
> @@ -339,16 +339,16 @@
>       */
>      private Number sum(Number a, Number b) {
>          if (a instanceof Integer) {
> -            return Integer.valueOf(a.intValue() + b.intValue());
> +            return new Integer(a.intValue() + b.intValue());
>          }
>          else if (a instanceof Float) {
> -            return Float.valueOf(a.floatValue() + b.floatValue());
> +            return new Float(a.floatValue() + b.floatValue());
>          }
>          else if (a instanceof Short) {
> -            return Short.valueOf((short)(a.shortValue() + b.shortValue()));
> +            return new Short((short)(a.shortValue() + b.shortValue()));
>          }
>          else if (a instanceof Byte) {
> -            return Byte.valueOf((byte)(a.byteValue() + b.byteValue()));
> +            return new Byte((byte)(a.byteValue() + b.byteValue()));
>          }
>          else {
>              // should never happen
>
> Modified: lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/MetricsRecordImpl.java
> URL: http://svn.apache.org/viewcvs/lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/MetricsRecordImpl.java?rev=397269&r1=397268&r2=397269&view=diff
> ==============================================================================
> --- lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/MetricsRecordImpl.java (original)
> +++ lucene/hadoop/trunk/src/java/org/apache/hadoop/metrics/spi/MetricsRecordImpl.java Wed Apr 26 11:43:20 2006
> @@ -73,7 +73,7 @@
>       * @throws MetricsException if the tagName conflicts with the configuration
>       */
>      public void setTag(String tagName, int tagValue) {
> -        tagTable.put(tagName, Integer.valueOf(tagValue));
> +        tagTable.put(tagName, new Integer(tagValue));
>      }
>      
>      /**
> @@ -84,7 +84,7 @@
>       * @throws MetricsException if the tagName conflicts with the configuration
>       */
>      public void setTag(String tagName, short tagValue) {
> -        tagTable.put(tagName, Short.valueOf(tagValue));
> +        tagTable.put(tagName, new Short(tagValue));
>      }
>      
>      /**
> @@ -95,7 +95,7 @@
>       * @throws MetricsException if the tagName conflicts with the configuration
>       */
>      public void setTag(String tagName, byte tagValue) {
> -        tagTable.put(tagName, Byte.valueOf(tagValue));
> +        tagTable.put(tagName, new Byte(tagValue));
>      }
>      
>      /**
> @@ -107,7 +107,7 @@
>       * conflicts with the configuration
>       */
>      public void setMetric(String metricName, int metricValue) {
> -        setAbsolute(metricName, Integer.valueOf(metricValue));
> +        setAbsolute(metricName, new Integer(metricValue));
>      }
>      
>      /**
> @@ -119,7 +119,7 @@
>       * conflicts with the configuration
>       */
>      public void setMetric(String metricName, short metricValue) {
> -        setAbsolute(metricName, Short.valueOf(metricValue));
> +        setAbsolute(metricName, new Short(metricValue));
>      }
>      
>      /**
> @@ -131,7 +131,7 @@
>       * conflicts with the configuration
>       */
>      public void setMetric(String metricName, byte metricValue) {
> -        setAbsolute(metricName, Byte.valueOf(metricValue));
> +        setAbsolute(metricName, new Byte(metricValue));
>      }
>      
>      /**
> @@ -143,7 +143,7 @@
>       * conflicts with the configuration
>       */
>      public void setMetric(String metricName, float metricValue) {
> -        setAbsolute(metricName, Float.valueOf(metricValue));
> +        setAbsolute(metricName, new Float(metricValue));
>      }
>      
>      /**
> @@ -155,7 +155,7 @@
>       * conflicts with the configuration
>       */
>      public void incrMetric(String metricName, int metricValue) {
> -        setIncrement(metricName, Integer.valueOf(metricValue));
> +        setIncrement(metricName, new Integer(metricValue));
>      }
>      
>      /**
> @@ -167,7 +167,7 @@
>       * conflicts with the configuration
>       */
>      public void incrMetric(String metricName, short metricValue) {
> -        setIncrement(metricName, Short.valueOf(metricValue));
> +        setIncrement(metricName, new Short(metricValue));
>      }
>      
>      /**
> @@ -179,7 +179,7 @@
>       * conflicts with the configuration
>       */
>      public void incrMetric(String metricName, byte metricValue) {
> -        setIncrement(metricName, Byte.valueOf(metricValue));
> +        setIncrement(metricName, new Byte(metricValue));
>      }
>      
>      /**
> @@ -191,7 +191,7 @@
>       * conflicts with the configuration
>       */
>      public void incrMetric(String metricName, float metricValue) {
> -        setIncrement(metricName, Float.valueOf(metricValue));
> +        setIncrement(metricName, new Float(metricValue));
>      }
>      
>      private void setAbsolute(String metricName, Number metricValue) {
>
>
>   


From MAILER-DAEMON Mon May  1 17:44:18 2006
Return-Path: 
 <hadoop-dev-return-1118-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30169 invoked from network); 1 May 2006 17:44:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 17:44:18 -0000
Received: (qmail 98103 invoked by uid 500); 1 May 2006 17:44:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98080 invoked by uid 500); 1 May 2006 17:44:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98071 invoked by uid 99); 1 May 2006 17:44:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:44:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:44:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2BB737142AE
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 17:43:47 +0000 (GMT)
Message-ID: <1366318.1146505427176.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 17:43:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-147) MapTask removed mapout files before
 the reduce tasks copy them
In-Reply-To: <27888818.1145408057411.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-147?page=all ]

Doug Cutting updated HADOOP-147:
--------------------------------

    Component: mapred

> MapTask removed mapout files before the reduce tasks copy them
> --------------------------------------------------------------
>
>          Key: HADOOP-147
>          URL: http://issues.apache.org/jira/browse/HADOOP-147
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Runping Qi

>
> I was running a job on a cluster of 138 nodes. The job had 1050 map tasks and 128 reduce tasks. It stucked at the reduce stage.
> All the reduce tasks were trying to copy file from a map task with the following status show on the web interface:
> reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
> However, the log on the machine node1262 (where the map task task_m_ehz5q1 ran) showed that the map task finished even before the 
> reduce tasks copied the map output files:
> 060417 103554 Server connection on port 60050 from 72.30.117.220: starting
> 060417 103554 task_m_ehz5q1  Client connection to 0.0.0.0:60050: starting
> 060417 103554 task_m_ehz5q1 1.0% /user/runping/runping/proj/part-00039:0+71
> 060417 103554 Task task_m_ehz5q1 is done.
> 060417 103554 parsing file:/local/hadoop/conf2/hadoop-default.xml
> ......................
> 060417 103613 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 103623 task_m_ehz5q1 done; removing files.
> 060417 103633 parsing file:/local/hadoop/conf2/hadoop-default.xml
> 060417 103633 parsing file:/local/hadoop/conf2/mapred-default.xml
> 060417 103633 parsing file:/local/hadoop/conf2/hadoop-site.xml
> ...........................................
> 060417 190241 SEVERE Can't open map output:/local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
> java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
> 060417 190241 Unknown child with bad map output: task_m_ehz5q1. Ignored.
> 060417 190241 Server handler 2 on 60040 caught: java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
> java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
> 060417 190241 parsing file:/local/hadoop/conf2/hadoop-default.xml
> 060417 190241 parsing file:/local/hadoop/conf2/mapred-default.xml
> And the above exceptions repeated for many (not sure whether it is tru for all the reduce task) other reduce tasks.
> Another strange thing noticed from the logs.
> On another machine's log, I saw:
> 060417 190528 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 190528 task_r_24d8k4 copy failed: task_m_ehz5q1 from node1262.foo.com/72.30.117.220:60040
> java.io.IOException: timed out waiting for response
>         at org.apache.hadoop.ipc.Client.call(Client.java:305)
>         at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141)
>         at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
>         at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:110)
>         at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:66)
> 060417 190528 task_r_24d8k4 0.11523809% reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
> 060417 190528 task_r_24d8k4 Copying task_m_epatk8 output from node1387.foo.com.
>                                
> which is expected. However, before this line, 
> I saw another copy activity in the log:
> 060417 103608 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 103608 task_r_a4yl3t Copying task_m_ehz5q1 output from node1262.foo.com.
> 060417 103608 parsing file:/local/hadoop/conf2/hadoop-default.xml
> And the task task_r_a4yl3t does not belong to the concerned job, 
> according to the Web interface. That is strange.
> And I checked a few other machines where some reduce tasks ran, 
> and I saw the same thing.
> I suspect there was a conflict in job ID. If two jobs had the same ID, 
> when one closes, it may also mark the other as "closed" too, thus trggering map tasks
> to clean up prematurely.
> A simple way to avoid potential jobid conflict is to use sequential numbers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 17:44:19 2006
Return-Path: 
 <hadoop-dev-return-1119-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30198 invoked from network); 1 May 2006 17:44:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 17:44:19 -0000
Received: (qmail 98239 invoked by uid 500); 1 May 2006 17:44:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98216 invoked by uid 500); 1 May 2006 17:44:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98196 invoked by uid 99); 1 May 2006 17:44:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:44:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:44:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F28B97142AD
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 17:43:47 +0000 (GMT)
Message-ID: <16218742.1146505427991.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 17:43:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-164) Getting errors in reading the output
 files of a map/reduce job immediately after the job is complete
In-Reply-To: <19308330.1145916126931.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-164?page=3Dall ]

Doug Cutting updated HADOOP-164:
--------------------------------

    Component: mapred

> Getting errors in reading the output files of a map/reduce job immediatel=
y after the job is complete
> -------------------------------------------------------------------------=
---------------------------
>
>          Key: HADOOP-164
>          URL: http://issues.apache.org/jira/browse/HADOOP-164
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Runping Qi

>
> I have an app that fire up map/reduce jobs sequentially. The output of on=
e job if the input of the next.
> I observe that many map tasks failed due to file read errors:
> java.rmi.RemoteException: java.io.IOException: Cannot open filename /user=
/runping/runping/docs_store/stage_2/base_docs/part-00186 at org.apache.hado=
op.dfs.NameNode.open(NameNode.java:130) at sun.reflect.GeneratedMethodAcces=
sor8.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.inv=
oke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invok=
e(Method.java:585) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237) a=
t org.apache.hadoop.ipc.Server$Handler.run(Server.java:216) at org.apache.h=
adoop.ipc.Client.call(Client.java:303) at org.apache.hadoop.ipc.RPC$Invoker=
.invoke(RPC.java:141) at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)=
 at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:=
315) at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:302)=
 at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:95) at org.apache.h=
adoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78) at o=
rg.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46) a=
t org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:220) at or=
g.apache.hadoop.fs.FileSystem.open(FileSystem.java:146) at org.apache.hadoo=
p.io.SequenceFile$Reader.(SequenceFile.java:234) at org.apache.hadoop.io.Se=
quenceFile$Reader.(SequenceFile.java:226) at org.apache.hadoop.mapred.Seque=
nceFileRecordReader.(SequenceFileRecordReader.java:36) at org.apache.hadoop=
.mapred.SequenceFileInputFormat.getRecordReader(SequenceFileInputFormat.jav=
a:53) at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105) at org.apac=
he.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709)=20
> Those tasks succeeded in the second or third try.
> After interting 10 seconds sleep between consecutive jobs, the problem di=
sappear.
> Here is my code to detect whether a job is completed:
>       try {
>         running =3D jc.submitJob(job);
>         String jobId =3D running.getJobID();
>         System.out.println("start job:\t" + jobId);
>         while (!running.isComplete()) {
>           try {
>             Thread.sleep(1000);
>           } catch (InterruptedException e) {}
>           running =3D jc.getJob(jobId);
>         }
>         sucess =3D running.isSuccessful();
>       } finally {
>         if (!sucess && (running !=3D null)) {
>           running.killJob();
>         }
>         jc.close();
>       }

--=20
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 17:44:20 2006
Return-Path: 
 <hadoop-dev-return-1120-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30230 invoked from network); 1 May 2006 17:44:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 17:44:20 -0000
Received: (qmail 98389 invoked by uid 500); 1 May 2006 17:44:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98369 invoked by uid 500); 1 May 2006 17:44:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98353 invoked by uid 99); 1 May 2006 17:44:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:44:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:44:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D24787142B6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 17:43:48 +0000 (GMT)
Message-ID: <27229264.1146505428858.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 17:43:48 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-156) Reducer  threw IOEOFException
In-Reply-To: <6737684.1145567465749.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-156?page=all ]

Doug Cutting updated HADOOP-156:
--------------------------------

    Component: mapred

> Reducer  threw IOEOFException
> -----------------------------
>
>          Key: HADOOP-156
>          URL: http://issues.apache.org/jira/browse/HADOOP-156
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Runping Qi

>
> A job was running with all the map tasks completed.
> The reducers were appending the intermediate files into the large intermediate file.
> java.io.EOFException was thrown when the record reader tried to read the version number
> during initialization. Here is the stack trace:
> java.io.EOFException 
>     at java.io.DataInputStream.readFully(DataInputStream.java:178) 
>     at java.io.DataInputStream.readFully(DataInputStream.java:152) 
>     at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:251) 
>     at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:236) 
>     at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:226) 
>     at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:205) 
>     at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709) 
> Appearantly, the intermediate file was empty. I suspect that one map task
> generated empty intermidiate files for all the reducers, since all the reducers
> failed at the same place, and failed at the same place during retries.
> Unfortunately, we cannot know which map task generated the empty files,
> since the exception does not offer any clue.
> One simple enhancement is that the record reader should catch IOException and re-throw it with additional 
> information, such as the file name.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 17:44:21 2006
Return-Path: 
 <hadoop-dev-return-1121-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30256 invoked from network); 1 May 2006 17:44:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 17:44:21 -0000
Received: (qmail 98535 invoked by uid 500); 1 May 2006 17:44:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98511 invoked by uid 500); 1 May 2006 17:44:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98502 invoked by uid 99); 1 May 2006 17:44:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:44:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:44:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B29877142B7
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 17:43:49 +0000 (GMT)
Message-ID: <19157554.1146505429727.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 17:43:49 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-177) improvement to browse through the
 map/reduce tasks
In-Reply-To: <9747441.1146435397688.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-177?page=all ]

Doug Cutting updated HADOOP-177:
--------------------------------

    Component: mapred

> improvement to browse through the map/reduce tasks
> --------------------------------------------------
>
>          Key: HADOOP-177
>          URL: http://issues.apache.org/jira/browse/HADOOP-177
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: webapp.patch
>
> The Jobtracker webbapp currently shows all the maps and reduce tasks on a single page. This sometimes causes the browser to crash with 1000's of maps/recudes running.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 17:46:18 2006
Return-Path: 
 <hadoop-dev-return-1122-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31975 invoked from network); 1 May 2006 17:46:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 17:46:18 -0000
Received: (qmail 1375 invoked by uid 500); 1 May 2006 17:46:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1348 invoked by uid 500); 1 May 2006 17:46:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1338 invoked by uid 99); 1 May 2006 17:46:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:46:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:46:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 13B5E7142AD
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 17:45:47 +0000 (GMT)
Message-ID: <6583860.1146505547077.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 17:45:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-163?page=all ]

Doug Cutting updated HADOOP-163:
--------------------------------

      Component: dfs
    Fix Version: 0.3
        Version: 0.2
    Description: 
I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.



  was:

I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.




> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Runping Qi
>      Fix For: 0.3

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 17:52:20 2006
Return-Path: 
 <hadoop-dev-return-1123-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36561 invoked from network); 1 May 2006 17:52:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 17:52:20 -0000
Received: (qmail 15691 invoked by uid 500); 1 May 2006 17:52:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15644 invoked by uid 500); 1 May 2006 17:52:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15615 invoked by uid 99); 1 May 2006 17:52:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:52:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 10:52:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 18A947142A2
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 17:51:47 +0000 (GMT)
Message-ID: <23002070.1146505907098.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 17:51:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-177) improvement to browse through the
 map/reduce tasks
In-Reply-To: <9747441.1146435397688.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-177?page=all ]
     
Doug Cutting resolved HADOOP-177:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Mahadev konar

This is great!  I just committed it.  Thanks!

> improvement to browse through the map/reduce tasks
> --------------------------------------------------
>
>          Key: HADOOP-177
>          URL: http://issues.apache.org/jira/browse/HADOOP-177
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: webapp.patch
>
> The Jobtracker webbapp currently shows all the maps and reduce tasks on a single page. This sometimes causes the browser to crash with 1000's of maps/recudes running.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:11:22 2006
Return-Path: 
 <hadoop-dev-return-1124-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45787 invoked from network); 1 May 2006 18:11:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:11:22 -0000
Received: (qmail 47856 invoked by uid 500); 1 May 2006 18:11:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47753 invoked by uid 500); 1 May 2006 18:11:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47539 invoked by uid 99); 1 May 2006 18:11:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:11:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:11:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 69C077142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:10:46 +0000 (GMT)
Message-ID: <15869272.1146507046430.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:10:46 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-178) piggyback block work requests to
 heartbeats and move block replication/deletion startup delay from datanodes
 to namenode
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

piggyback block work requests to heartbeats and move block replication/deletion startup delay from datanodes to namenode
------------------------------------------------------------------------------------------------------------------------

         Key: HADOOP-178
         URL: http://issues.apache.org/jira/browse/HADOOP-178
     Project: Hadoop
        Type: Improvement

  Components: dfs  
    Reporter: Hairong Kuang
 Assigned to: Hairong Kuang 


Currently each datanode sends at least two messages to namenode within a heartbeat interval. One is a heartbeat message and another is block work request. By piggybacking the block work request to a heartbeat can greatly cut the number of messages between a datanode and the namenode.

Secondly each datanode waits for a configurable "StartupPeriod" before it sends a block work request in order to avoid uneccessary block replication at startup time. But if the namenode starts much later than datanodes, this scheme does not work. Furthermore, the namenode has more information to decide when to send block work to datanodes. For example, all datanodes send block reports etc. It is more resonable to move the startup delay from datanodes to the namenode 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:16:31 2006
Return-Path: 
 <hadoop-dev-return-1125-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48334 invoked from network); 1 May 2006 18:16:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:16:31 -0000
Received: (qmail 55564 invoked by uid 500); 1 May 2006 18:16:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55498 invoked by uid 500); 1 May 2006 18:16:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55371 invoked by uid 99); 1 May 2006 18:16:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:16:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:16:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6CE4C7142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:15:47 +0000 (GMT)
Message-ID: <9146362.1146507347443.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:15:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12377255 ] 

Doug Cutting commented on HADOOP-96:
------------------------------------

Overall I like this.  A few nits, however:

1. It would be nice if, before it switches logging to a file, the name of that file were logged.  That way, when folks upgrade they can figure out where there logs are written.  This will also help in debugging configuration issues.

2. When I run bin/start-all.sh on my Linux box, the log files end up in my connected directory, in HADOOP_HOME, not in HADOOP_HOME/logs.  When I add a print statement, it shows the correct directory for logDir, but that's not where the files are written.  I have not tested this on Windows, but it would be good to check that it with a simple configuration (i.e., a hadoop-site.xml that only specifies localhost for the jobtracker and namenode) that, on Windows and Linux, the files are written where expected.  Perhaps we could even add a unit test for this.

Thanks!

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:18:18 2006
Return-Path: 
 <hadoop-dev-return-1126-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49314 invoked from network); 1 May 2006 18:18:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:18:18 -0000
Received: (qmail 57318 invoked by uid 500); 1 May 2006 18:18:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57297 invoked by uid 500); 1 May 2006 18:18:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57288 invoked by uid 99); 1 May 2006 18:18:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:18:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:18:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 713867142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:17:47 +0000 (GMT)
Message-ID: <8062428.1146507467461.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:17:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12377257 ] 

Doug Cutting commented on HADOOP-96:
------------------------------------

Also, one of Owen's patches has made applying this patch require manual steps.  So if you make a new patch, please first update your tree and merge with Owen's changes.  Thanks!

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:35:18 2006
Return-Path: 
 <hadoop-dev-return-1127-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56483 invoked from network); 1 May 2006 18:35:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:35:18 -0000
Received: (qmail 86177 invoked by uid 500); 1 May 2006 18:35:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86159 invoked by uid 500); 1 May 2006 18:35:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86150 invoked by uid 99); 1 May 2006 18:35:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:35:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:35:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 133497142A2
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:34:47 +0000 (GMT)
Message-ID: <13208621.1146508487076.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:34:47 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-178) piggyback block work requests to
 heartbeats and move block replication/deletion startup delay from datanodes
 to namenode
In-Reply-To: <15869272.1146507046430.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-178?page=all ]

Hairong Kuang updated HADOOP-178:
---------------------------------

    Attachment: startupDelay.patch

I made the changes described in the issue report. In addition, I made the granularity of locking on receivedBlockList to be smaller, i.e. the code synchronizes on receivedBlockList only when reading/writing to the list. Also there seemed to be a bug on line 174 in the patch when calculating waittime. So I changed "now" to be System.currentTimeMillis().

> piggyback block work requests to heartbeats and move block replication/deletion startup delay from datanodes to namenode
> ------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-178
>          URL: http://issues.apache.org/jira/browse/HADOOP-178
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>  Attachments: startupDelay.patch
>
> Currently each datanode sends at least two messages to namenode within a heartbeat interval. One is a heartbeat message and another is block work request. By piggybacking the block work request to a heartbeat can greatly cut the number of messages between a datanode and the namenode.
> Secondly each datanode waits for a configurable "StartupPeriod" before it sends a block work request in order to avoid uneccessary block replication at startup time. But if the namenode starts much later than datanodes, this scheme does not work. Furthermore, the namenode has more information to decide when to send block work to datanodes. For example, all datanodes send block reports etc. It is more resonable to move the startup delay from datanodes to the namenode 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:41:17 2006
Return-Path: 
 <hadoop-dev-return-1128-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59315 invoked from network); 1 May 2006 18:41:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:41:17 -0000
Received: (qmail 1875 invoked by uid 500); 1 May 2006 18:41:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1747 invoked by uid 500); 1 May 2006 18:41:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1735 invoked by uid 99); 1 May 2006 18:41:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:41:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:41:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 647FE7142A2
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:40:46 +0000 (GMT)
Message-ID: <1916800.1146508846408.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:40:46 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-179) task tracker ghosts remain after 10
 minutes
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

task tracker ghosts remain after 10 minutes
-------------------------------------------

         Key: HADOOP-179
         URL: http://issues.apache.org/jira/browse/HADOOP-179
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


I had a bunch of TaskTrackers time out because they were in the middle of job cleanup and the JobTracker restarted them by responding to emitHeartbeat with UNKNOWN_TASKTRACKER. Afterwards, I ended up with both the new and the restarted TaskTrackers on the list:

node1100_1234, 0-10 seconds since heartbeat
node1100_4321,  >10,000 seconds since heartbeat

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:43:17 2006
Return-Path: 
 <hadoop-dev-return-1129-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59879 invoked from network); 1 May 2006 18:43:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:43:17 -0000
Received: (qmail 2603 invoked by uid 500); 1 May 2006 18:43:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2581 invoked by uid 500); 1 May 2006 18:43:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2567 invoked by uid 99); 1 May 2006 18:43:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:43:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:43:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 774F97142A2
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:42:46 +0000 (GMT)
Message-ID: <24018329.1146508966485.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:42:46 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-180) task tracker times out cleaning big
 job
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

task tracker times out cleaning big job
---------------------------------------

         Key: HADOOP-180
         URL: http://issues.apache.org/jira/browse/HADOOP-180
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


After completing a big job (63,920 maps, 1880 reduces, 188 nodes), lots of the TaskTrackers timed out because the task cleanup is handled by the same thread as the heartbeats.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:45:18 2006
Return-Path: 
 <hadoop-dev-return-1130-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60746 invoked from network); 1 May 2006 18:45:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:45:18 -0000
Received: (qmail 6154 invoked by uid 500); 1 May 2006 18:45:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6134 invoked by uid 500); 1 May 2006 18:45:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6125 invoked by uid 99); 1 May 2006 18:45:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:45:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:45:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7F41A7142A2
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:44:47 +0000 (GMT)
Message-ID: <1584394.1146509087518.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:44:47 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12377261 ] 

Hairong Kuang commented on HADOOP-96:
-------------------------------------

Yes, it makes sense to log the log file name. I will make the change. If HADOOP_LOG_DIR is set, the log directory is set to be HADOOP_LOG_DIR. Otherwise, if HADOOP_HOME is set,  the log directory is set to be HADOOP_HOME/logs. Otherwise, it is set to be the user's home directory. I do not know why you saw log files in HADOOP_HOME. I will take a look.

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:47:17 2006
Return-Path: 
 <hadoop-dev-return-1131-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61466 invoked from network); 1 May 2006 18:47:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:47:17 -0000
Received: (qmail 8561 invoked by uid 500); 1 May 2006 18:47:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8541 invoked by uid 500); 1 May 2006 18:47:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8529 invoked by uid 99); 1 May 2006 18:47:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:47:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:47:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5D3897142A2
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:46:46 +0000 (GMT)
Message-ID: <701484.1146509206378.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:46:46 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-181) task trackers should not restart for
 having a late heartbeat
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

task trackers should not restart for having a late heartbeat
------------------------------------------------------------

         Key: HADOOP-181
         URL: http://issues.apache.org/jira/browse/HADOOP-181
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


TaskTrackers should not close and restart themselves for having a late heartbeat. The JobTracker should just accept their current status.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 18:49:18 2006
Return-Path: 
 <hadoop-dev-return-1132-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62502 invoked from network); 1 May 2006 18:49:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 18:49:18 -0000
Received: (qmail 12746 invoked by uid 500); 1 May 2006 18:49:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12691 invoked by uid 500); 1 May 2006 18:49:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12659 invoked by uid 99); 1 May 2006 18:49:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:49:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 11:49:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5DC117142A2
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 18:48:46 +0000 (GMT)
Message-ID: <18534471.1146509326381.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 18:48:46 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-182) lost task trackers should not update
 status of completed jobs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

lost task trackers should not update status of completed jobs
-------------------------------------------------------------

         Key: HADOOP-182
         URL: http://issues.apache.org/jira/browse/HADOOP-182
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Minor


When a Task Tracker is lost (by not sending a heartbeat for 10 minutes), the JobTracker marks the tasks that were active on that node as failed. There are two issues:
   1. No task from a completed or failed job should be modified.
   2. No reduces should be marked as failed, since their output is in dfs and therefore not only on the dead node.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 19:13:17 2006
Return-Path: 
 <hadoop-dev-return-1133-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73715 invoked from network); 1 May 2006 19:13:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 19:13:17 -0000
Received: (qmail 48400 invoked by uid 500); 1 May 2006 19:13:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48377 invoked by uid 500); 1 May 2006 19:13:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48368 invoked by uid 99); 1 May 2006 19:13:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:13:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:13:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5FED67142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 19:12:46 +0000 (GMT)
Message-ID: <7776821.1146510766390.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 19:12:46 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-183) adjust file replication factor when
 loading image and edits according to replication.min and replication.max
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

adjust file replication factor when loading image and edits according to replication.min and replication.max
------------------------------------------------------------------------------------------------------------

         Key: HADOOP-183
         URL: http://issues.apache.org/jira/browse/HADOOP-183
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Reporter: Hairong Kuang
 Assigned to: Hairong Kuang 
    Priority: Minor


Currently in dfs, when namenode starts, a file's replication factor is loaded either from image or edits. The replication factor may be smaller than replication.min or greater than replication.max.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 19:15:56 2006
Return-Path: 
 <hadoop-dev-return-1134-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 75452 invoked from network); 1 May 2006 19:15:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 19:15:56 -0000
Received: (qmail 53211 invoked by uid 500); 1 May 2006 19:15:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53116 invoked by uid 500); 1 May 2006 19:15:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53079 invoked by uid 99); 1 May 2006 19:15:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:15:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:15:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3A9797142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 19:14:47 +0000 (GMT)
Message-ID: <5195954.1146510887237.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 19:14:47 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-183) adjust file replication factor when
 loading image and edits according to replication.min and replication.max
In-Reply-To: <7776821.1146510766390.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-183?page=all ]

Hairong Kuang updated HADOOP-183:
---------------------------------

    Attachment: directory.patch

The patch adjusts a file's replication factor when loaded from dfs image or edits. If the replication factor is smaller than replication.min, it is set to be replication.min. If it is bigger than replication.max, it is set to be replication.max.

> adjust file replication factor when loading image and edits according to replication.min and replication.max
> ------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-183
>          URL: http://issues.apache.org/jira/browse/HADOOP-183
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor
>  Attachments: directory.patch
>
> Currently in dfs, when namenode starts, a file's replication factor is loaded either from image or edits. The replication factor may be smaller than replication.min or greater than replication.max.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 19:45:18 2006
Return-Path: 
 <hadoop-dev-return-1135-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 272 invoked from network); 1 May 2006 19:45:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 19:45:18 -0000
Received: (qmail 2912 invoked by uid 500); 1 May 2006 19:45:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2870 invoked by uid 500); 1 May 2006 19:45:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2860 invoked by uid 99); 1 May 2006 19:45:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:45:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:45:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3274B7142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 19:44:47 +0000 (GMT)
Message-ID: <11415469.1146512687204.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 19:44:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-159) name node at 100% cpu, making
 redundant replications
In-Reply-To: <929695.1145660285762.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-159?page=comments#action_12377265 ] 

Sameer Paranjpye commented on HADOOP-159:
-----------------------------------------

Is this problem still seen? Some of the committed patches appear to have resolved this issue, no?

> name node at 100% cpu, making redundant replications
> ----------------------------------------------------
>
>          Key: HADOOP-159
>          URL: http://issues.apache.org/jira/browse/HADOOP-159
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>     Priority: Blocker
>      Fix For: 0.2

>
> some hours after adding some new nodes to the cluster, the name node went into a state where it's consuming 100% cpu.
> The log file keeps logging messages of the forms
> 060421 155049 Obsoleting block blk_8093115169359854355
> 060421 155049 Pending transfer (block blk_-6965677235456960523) from node1383:50010 to 2 destinations
> 060421 155049 Block report from node1283:50010: 2140 blocks.
> 060421 155049 Redundant addStoredBlock request received for block blk_-6836937139917042917 on node node1143:50010
> many DFS operations time out, making useful work impossible.
> restarting dfs solved the problem for a while, but it came back within an hour.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 19:47:19 2006
Return-Path: 
 <hadoop-dev-return-1136-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1577 invoked from network); 1 May 2006 19:47:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 19:47:19 -0000
Received: (qmail 7274 invoked by uid 500); 1 May 2006 19:47:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7247 invoked by uid 500); 1 May 2006 19:47:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7238 invoked by uid 99); 1 May 2006 19:47:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:47:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:47:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2E3827142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 19:46:47 +0000 (GMT)
Message-ID: <7317012.1146512807186.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 19:46:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-158) dfs block ids sometimes collide
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-158?page=all ]

Sameer Paranjpye reassigned HADOOP-158:
---------------------------------------

    Assign To: Konstantin Shvachko

> dfs block ids sometimes collide
> -------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 19:47:20 2006
Return-Path: 
 <hadoop-dev-return-1137-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1601 invoked from network); 1 May 2006 19:47:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 19:47:20 -0000
Received: (qmail 7431 invoked by uid 500); 1 May 2006 19:47:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7396 invoked by uid 500); 1 May 2006 19:47:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7387 invoked by uid 99); 1 May 2006 19:47:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:47:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:47:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 79F717142A7
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 19:46:48 +0000 (GMT)
Message-ID: <17547441.1146512808496.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 19:46:48 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-178) piggyback block work requests to
 heartbeats and move block replication/deletion startup delay from datanodes
 to namenode
In-Reply-To: <15869272.1146507046430.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-178?page=all ]
     
Doug Cutting resolved HADOOP-178:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Hairong!

> piggyback block work requests to heartbeats and move block replication/deletion startup delay from datanodes to namenode
> ------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-178
>          URL: http://issues.apache.org/jira/browse/HADOOP-178
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>      Fix For: 0.2
>  Attachments: startupDelay.patch
>
> Currently each datanode sends at least two messages to namenode within a heartbeat interval. One is a heartbeat message and another is block work request. By piggybacking the block work request to a heartbeat can greatly cut the number of messages between a datanode and the namenode.
> Secondly each datanode waits for a configurable "StartupPeriod" before it sends a block work request in order to avoid uneccessary block replication at startup time. But if the namenode starts much later than datanodes, this scheme does not work. Furthermore, the namenode has more information to decide when to send block work to datanodes. For example, all datanodes send block reports etc. It is more resonable to move the startup delay from datanodes to the namenode 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 19:52:18 2006
Return-Path: 
 <hadoop-dev-return-1138-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4575 invoked from network); 1 May 2006 19:52:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 19:52:18 -0000
Received: (qmail 17581 invoked by uid 500); 1 May 2006 19:52:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17561 invoked by uid 500); 1 May 2006 19:52:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17552 invoked by uid 99); 1 May 2006 19:52:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:52:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 12:52:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 137097142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 19:51:47 +0000 (GMT)
Message-ID: <19725524.1146513107077.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 19:51:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-85) a single client stuck in a loop blocks
 all clients on same machine
In-Reply-To: <1854913738.1142459099064.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-85?page=all ]
     
Sameer Paranjpye resolved HADOOP-85:
------------------------------------

    Resolution: Duplicate

Fixing HADOOP-83 resolves this issue.

> a single client stuck in a loop blocks all clients on same machine
> ------------------------------------------------------------------
>
>          Key: HADOOP-85
>          URL: http://issues.apache.org/jira/browse/HADOOP-85
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>      Fix For: 0.2

>
> I was running a set of clients, running cp from one dfs to another dfs using fuse, one file per cp process.
> One client got stuck in a loop because of a bad block in one of the files (separate bug filed).
> The other clients, running in parallel in the background, all stopped making progress on their respective files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:02:18 2006
Return-Path: 
 <hadoop-dev-return-1139-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10676 invoked from network); 1 May 2006 20:02:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:02:18 -0000
Received: (qmail 33321 invoked by uid 500); 1 May 2006 20:02:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33300 invoked by uid 500); 1 May 2006 20:02:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33290 invoked by uid 99); 1 May 2006 20:02:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:02:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:02:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 120F67142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:01:47 +0000 (GMT)
Message-ID: <28319015.1146513707071.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:01:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-183) adjust file replication factor when
 loading image and edits according to replication.min and replication.max
In-Reply-To: <7776821.1146510766390.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-183?page=all ]
     
Doug Cutting resolved HADOOP-183:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Hairong!

> adjust file replication factor when loading image and edits according to replication.min and replication.max
> ------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-183
>          URL: http://issues.apache.org/jira/browse/HADOOP-183
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: directory.patch
>
> Currently in dfs, when namenode starts, a file's replication factor is loaded either from image or edits. The replication factor may be smaller than replication.min or greater than replication.max.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:05:18 2006
Return-Path: 
 <hadoop-dev-return-1140-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12185 invoked from network); 1 May 2006 20:05:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:05:18 -0000
Received: (qmail 39272 invoked by uid 500); 1 May 2006 20:05:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39250 invoked by uid 500); 1 May 2006 20:05:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39241 invoked by uid 99); 1 May 2006 20:05:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:05:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:05:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 74EE97142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:04:47 +0000 (GMT)
Message-ID: <10185334.1146513887476.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:04:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-137) Different TaskTrackers may get the
 same task tracker id, thus cause many problems.
In-Reply-To: <82889088.1145059860234.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-137?page=all ]

Sameer Paranjpye updated HADOOP-137:
------------------------------------

    Fix Version: 0.2
        Version: 0.2
    Description: 
In the TaskTracker#Initialize method, the following line assigns task tracker name (id):

this.taskTrackerName = "tracker_" + (Math.abs(r.nextInt()) % 100000);

For a fair size cluster, it is possible that different task trackers to get the same id, causing name conflict.
I encountered this problem with a cluster of 274 nodes. Once such conflict happens, a lot of strange things may happen.
For example, a reducer task tried to copy from a machine (task tracker) a map output file that was actually produced 
on another machine.


  was:

In the TaskTracker#Initialize method, the following line assigns task tracker name (id):

this.taskTrackerName = "tracker_" + (Math.abs(r.nextInt()) % 100000);

For a fair size cluster, it is possible that different task trackers to get the same id, causing name conflict.
I encountered this problem with a cluster of 274 nodes. Once such conflict happens, a lot of strange things may happen.
For example, a reducer task tried to copy from a machine (task tracker) a map output file that was actually produced 
on another machine.


      Assign To: Owen O'Malley

This was fixed in the patch submitted for HADOOP-134

> Different TaskTrackers may get the same task tracker id, thus cause many problems.
> ----------------------------------------------------------------------------------
>
>          Key: HADOOP-137
>          URL: http://issues.apache.org/jira/browse/HADOOP-137
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Runping Qi
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2

>
> In the TaskTracker#Initialize method, the following line assigns task tracker name (id):
> this.taskTrackerName = "tracker_" + (Math.abs(r.nextInt()) % 100000);
> For a fair size cluster, it is possible that different task trackers to get the same id, causing name conflict.
> I encountered this problem with a cluster of 274 nodes. Once such conflict happens, a lot of strange things may happen.
> For example, a reducer task tried to copy from a machine (task tracker) a map output file that was actually produced 
> on another machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:07:18 2006
Return-Path: 
 <hadoop-dev-return-1141-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12690 invoked from network); 1 May 2006 20:07:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:07:18 -0000
Received: (qmail 40052 invoked by uid 500); 1 May 2006 20:07:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40016 invoked by uid 500); 1 May 2006 20:07:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40007 invoked by uid 99); 1 May 2006 20:07:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:07:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:07:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8A3F57142A7
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:06:47 +0000 (GMT)
Message-ID: <27554241.1146514007563.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:06:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-137) Different TaskTrackers may get the
 same task tracker id, thus cause many problems.
In-Reply-To: <82889088.1145059860234.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-137?page=all ]
     
Sameer Paranjpye resolved HADOOP-137:
-------------------------------------

    Resolution: Fixed

Fixed with patch for HADOOP-134

> Different TaskTrackers may get the same task tracker id, thus cause many problems.
> ----------------------------------------------------------------------------------
>
>          Key: HADOOP-137
>          URL: http://issues.apache.org/jira/browse/HADOOP-137
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Runping Qi
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2

>
> In the TaskTracker#Initialize method, the following line assigns task tracker name (id):
> this.taskTrackerName = "tracker_" + (Math.abs(r.nextInt()) % 100000);
> For a fair size cluster, it is possible that different task trackers to get the same id, causing name conflict.
> I encountered this problem with a cluster of 274 nodes. Once such conflict happens, a lot of strange things may happen.
> For example, a reducer task tried to copy from a machine (task tracker) a map output file that was actually produced 
> on another machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:09:20 2006
Return-Path: 
 <hadoop-dev-return-1142-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13306 invoked from network); 1 May 2006 20:09:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:09:20 -0000
Received: (qmail 43668 invoked by uid 500); 1 May 2006 20:09:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43642 invoked by uid 500); 1 May 2006 20:09:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43624 invoked by uid 99); 1 May 2006 20:09:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:09:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:09:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 810C37142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:08:49 +0000 (GMT)
Message-ID: <29335689.1146514129525.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:08:49 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-158) dfs block ids sometimes collide
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-158?page=comments#action_12377273 ] 

Doug Cutting commented on HADOOP-158:
-------------------------------------

Using the formulas in:

http://en.wikipedia.org/wiki/Birthday_paradox#Generalisation

I think it is actually very unlikely that, with 64-bit block ids and a decent random number generator, we are actually seeing collisions.  It seems more likely that the symptoms ascribed to duplicate block id allocations are actually the result of other bugs.  Still, it would be more comfortable to not rely on random block id allocation long-term.

> dfs block ids sometimes collide
> -------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:13:18 2006
Return-Path: 
 <hadoop-dev-return-1143-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14735 invoked from network); 1 May 2006 20:13:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:13:18 -0000
Received: (qmail 48024 invoked by uid 500); 1 May 2006 20:13:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48003 invoked by uid 500); 1 May 2006 20:13:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47994 invoked by uid 99); 1 May 2006 20:13:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:13:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:13:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0B4C97142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:12:47 +0000 (GMT)
Message-ID: <11266999.1146514367043.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:12:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-63) problem with webapp when start a
 jobtracker
In-Reply-To: <1306920605.1141349984316.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-63?page=all ]

Sameer Paranjpye reassigned HADOOP-63:
--------------------------------------

    Assign To: Hairong Kuang

Is this still an issue? Can this be closed?

> problem with webapp when start a jobtracker
> -------------------------------------------
>
>          Key: HADOOP-63
>          URL: http://issues.apache.org/jira/browse/HADOOP-63
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>  Environment: RHL4
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor

>
> there exist two issues with starting up webapp
> 1. webapp is not be able to be loaded from a jar file.
> 2. web.xml can not be parsed properly using java 1.4

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:15:18 2006
Return-Path: 
 <hadoop-dev-return-1144-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15450 invoked from network); 1 May 2006 20:15:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:15:18 -0000
Received: (qmail 50390 invoked by uid 500); 1 May 2006 20:15:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50368 invoked by uid 500); 1 May 2006 20:15:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50359 invoked by uid 99); 1 May 2006 20:15:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:15:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:15:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 134BB7142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:14:47 +0000 (GMT)
Message-ID: <24546448.1146514487076.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:14:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-94) disallow more than one datanode running
 on one computing sharing the same data directory
In-Reply-To: <1264551394.1142645179057.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-94?page=all ]

Sameer Paranjpye updated HADOOP-94:
-----------------------------------

    Fix Version: 0.3
        Version: 0.2
                     (was: 0.1.0)

> disallow more than one datanode running on one computing sharing the same data directory
> ----------------------------------------------------------------------------------------
>
>          Key: HADOOP-94
>          URL: http://issues.apache.org/jira/browse/HADOOP-94
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Hairong Kuang
>      Fix For: 0.3

>
> Currently dfs disallows more one datanode to run on the same computer if they are started up using the same hadoop conf dir. However, this does not prevent more than one data node gets started, each using a different conf dir (strickly speaking, a different pid file). If every machine has two such datanodes running, namenode will be busy on deleting and replicating blocks or eventually lead to block loss.
> Suggested solution: put pid file in  the data directory and disallow configuration.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:15:19 2006
Return-Path: 
 <hadoop-dev-return-1145-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15478 invoked from network); 1 May 2006 20:15:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:15:19 -0000
Received: (qmail 50526 invoked by uid 500); 1 May 2006 20:15:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50507 invoked by uid 500); 1 May 2006 20:15:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50498 invoked by uid 99); 1 May 2006 20:15:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:15:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:15:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DAC7C7142A7
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:14:47 +0000 (GMT)
Message-ID: <14854692.1146514487893.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:14:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-147) MapTask removed mapout files before
 the reduce tasks copy them
In-Reply-To: <27888818.1145408057411.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-147?page=all ]

Sameer Paranjpye updated HADOOP-147:
------------------------------------

    Fix Version: 0.3
        Version: 0.2

> MapTask removed mapout files before the reduce tasks copy them
> --------------------------------------------------------------
>
>          Key: HADOOP-147
>          URL: http://issues.apache.org/jira/browse/HADOOP-147
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Runping Qi
>      Fix For: 0.3

>
> I was running a job on a cluster of 138 nodes. The job had 1050 map tasks and 128 reduce tasks. It stucked at the reduce stage.
> All the reduce tasks were trying to copy file from a map task with the following status show on the web interface:
> reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
> However, the log on the machine node1262 (where the map task task_m_ehz5q1 ran) showed that the map task finished even before the 
> reduce tasks copied the map output files:
> 060417 103554 Server connection on port 60050 from 72.30.117.220: starting
> 060417 103554 task_m_ehz5q1  Client connection to 0.0.0.0:60050: starting
> 060417 103554 task_m_ehz5q1 1.0% /user/runping/runping/proj/part-00039:0+71
> 060417 103554 Task task_m_ehz5q1 is done.
> 060417 103554 parsing file:/local/hadoop/conf2/hadoop-default.xml
> ......................
> 060417 103613 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 103623 task_m_ehz5q1 done; removing files.
> 060417 103633 parsing file:/local/hadoop/conf2/hadoop-default.xml
> 060417 103633 parsing file:/local/hadoop/conf2/mapred-default.xml
> 060417 103633 parsing file:/local/hadoop/conf2/hadoop-site.xml
> ...........................................
> 060417 190241 SEVERE Can't open map output:/local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
> java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
> 060417 190241 Unknown child with bad map output: task_m_ehz5q1. Ignored.
> 060417 190241 Server handler 2 on 60040 caught: java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
> java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
> 060417 190241 parsing file:/local/hadoop/conf2/hadoop-default.xml
> 060417 190241 parsing file:/local/hadoop/conf2/mapred-default.xml
> And the above exceptions repeated for many (not sure whether it is tru for all the reduce task) other reduce tasks.
> Another strange thing noticed from the logs.
> On another machine's log, I saw:
> 060417 190528 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 190528 task_r_24d8k4 copy failed: task_m_ehz5q1 from node1262.foo.com/72.30.117.220:60040
> java.io.IOException: timed out waiting for response
>         at org.apache.hadoop.ipc.Client.call(Client.java:305)
>         at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141)
>         at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
>         at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:110)
>         at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:66)
> 060417 190528 task_r_24d8k4 0.11523809% reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
> 060417 190528 task_r_24d8k4 Copying task_m_epatk8 output from node1387.foo.com.
>                                
> which is expected. However, before this line, 
> I saw another copy activity in the log:
> 060417 103608 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 103608 task_r_a4yl3t Copying task_m_ehz5q1 output from node1262.foo.com.
> 060417 103608 parsing file:/local/hadoop/conf2/hadoop-default.xml
> And the task task_r_a4yl3t does not belong to the concerned job, 
> according to the Web interface. That is strange.
> And I checked a few other machines where some reduce tasks ran, 
> and I saw the same thing.
> I suspect there was a conflict in job ID. If two jobs had the same ID, 
> when one closes, it may also mark the other as "closed" too, thus trggering map tasks
> to clean up prematurely.
> A simple way to avoid potential jobid conflict is to use sequential numbers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:21:18 2006
Return-Path: 
 <hadoop-dev-return-1146-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18858 invoked from network); 1 May 2006 20:21:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:21:18 -0000
Received: (qmail 60986 invoked by uid 500); 1 May 2006 20:21:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60863 invoked by uid 500); 1 May 2006 20:21:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60854 invoked by uid 99); 1 May 2006 20:21:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:21:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:21:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 18EC37142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:20:47 +0000 (GMT)
Message-ID: <27644531.1146514847099.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:20:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-94) disallow more than one datanode
 running on one computing sharing the same data directory
In-Reply-To: <1264551394.1142645179057.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-94?page=comments#action_12377277 ] 

Doug Cutting commented on HADOOP-94:
------------------------------------

I agree that we should put some sort of a lock file in the data directory, but I don't think we should move the existing pid file, since that is managed by the generic daemon start/stop code.  Rather we could use the nio file locking code to create an exclusive lock on a file.  This will automatically be unlocked by the kernel if/when the jvm exits.

> disallow more than one datanode running on one computing sharing the same data directory
> ----------------------------------------------------------------------------------------
>
>          Key: HADOOP-94
>          URL: http://issues.apache.org/jira/browse/HADOOP-94
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Hairong Kuang
>      Fix For: 0.3

>
> Currently dfs disallows more one datanode to run on the same computer if they are started up using the same hadoop conf dir. However, this does not prevent more than one data node gets started, each using a different conf dir (strickly speaking, a different pid file). If every machine has two such datanodes running, namenode will be busy on deleting and replicating blocks or eventually lead to block loss.
> Suggested solution: put pid file in  the data directory and disallow configuration.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:21:19 2006
Return-Path: 
 <hadoop-dev-return-1147-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18882 invoked from network); 1 May 2006 20:21:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:21:19 -0000
Received: (qmail 61089 invoked by uid 500); 1 May 2006 20:21:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61000 invoked by uid 500); 1 May 2006 20:21:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60991 invoked by uid 99); 1 May 2006 20:21:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:21:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:21:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E5FD47142A7
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:20:47 +0000 (GMT)
Message-ID: <33225378.1146514847939.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:20:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-122) Failed to execute fsck with -move
 option
In-Reply-To: <1204783379.1144281644496.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-122?page=all ]

Sameer Paranjpye updated HADOOP-122:
------------------------------------

      Version: 0.1.0
    Assign To: Hairong Kuang

Does the fsck utility need to write to the dfs data directory? Perhaps it could point someplace else by default. Is this behavior actually unreasonable? Perhaps fsck should be hard to run if you don't have the right set of permissions.

> Failed to execute fsck with -move option
> ----------------------------------------
>
>          Key: HADOOP-122
>          URL: http://issues.apache.org/jira/browse/HADOOP-122
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang

>
> I received the following error when running fsck with -move option. The dfs was started by a user while the fsck was ran by a different user that does not have the write access to the hadoop dfs data directory.
> - moving to /lost+found: /data.txt
> java.io.FileNotFoundException: hadoop-dfs-data-dir/tmp/client-8234960199756230677 (Permission denied)
> at java.io.FileOutputStream.open(Native Method)
> at java.io.FileOutputStream.<init>(FileOutputStream.java:179)
> at java.io.FileOutputStream.<init>(FileOutputStream.java:131)
> at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.<init>(DFSClient.java:546)
> at org.apache.hadoop.dfs.DFSClient.create(DFSClient.java:99)
> at org.apache.hadoop.dfs.DFSck.lostFoundMove(DFSck.java:222)
> at org.apache.hadoop.dfs.DFSck.check(DFSck.java:178)
> at org.apache.hadoop.dfs.DFSck.check(DFSck.java:124)
> at org.apache.hadoop.dfs.DFSck.fsck(DFSck.java:112)
> at org.apache.hadoop.dfs.DFSck.main(DFSck.java:433)
> Failed to move /data.txt to /lost+found: hadoop-dfs-data-dir/tmp/client-8234960199756230677 (Permission denied)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:23:18 2006
Return-Path: 
 <hadoop-dev-return-1148-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20134 invoked from network); 1 May 2006 20:23:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:23:18 -0000
Received: (qmail 68712 invoked by uid 500); 1 May 2006 20:23:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68686 invoked by uid 500); 1 May 2006 20:23:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68677 invoked by uid 99); 1 May 2006 20:23:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:23:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:23:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 201AC7142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:22:47 +0000 (GMT)
Message-ID: <13370649.1146514967128.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:22:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-109) Blocks are not replicated when...
In-Reply-To: <985692887.1143603799440.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-109?page=all ]

Sameer Paranjpye updated HADOOP-109:
------------------------------------

      Version: 0.1.0
    Assign To: Konstantin Shvachko

> Blocks are not replicated when...
> ---------------------------------
>
>          Key: HADOOP-109
>          URL: http://issues.apache.org/jira/browse/HADOOP-109
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.3

>
> When the block is under-replicated the namenode places it into
> FSNamesystem.neededReplications list.
> When a datanode D1 sends getBlockwork() request to the namenode, the namenode
> selects another node D2 (which it thinks is up and running) where the new replica of the
> under-replicated block will be stored.
> Then namenode removes the block from the neededReplications list and places it to
> the pendingReplications list, and then asks D1 to replicate the block to D2.
> If D2 is in fact down, then replication will fail and will never be retried later, because
> the block is not in the neededReplications list, but rather in the pendingReplications list,
> which namenode never checks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:23:21 2006
Return-Path: 
 <hadoop-dev-return-1149-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20166 invoked from network); 1 May 2006 20:23:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:23:21 -0000
Received: (qmail 68856 invoked by uid 500); 1 May 2006 20:23:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68834 invoked by uid 500); 1 May 2006 20:23:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68825 invoked by uid 99); 1 May 2006 20:23:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:23:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:23:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F0CF67142A1
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:22:47 +0000 (GMT)
Message-ID: <3326823.1146514967983.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:22:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-109) Blocks are not replicated when...
In-Reply-To: <985692887.1143603799440.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-109?page=all ]

Sameer Paranjpye updated HADOOP-109:
------------------------------------

    Fix Version: 0.3

> Blocks are not replicated when...
> ---------------------------------
>
>          Key: HADOOP-109
>          URL: http://issues.apache.org/jira/browse/HADOOP-109
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.3

>
> When the block is under-replicated the namenode places it into
> FSNamesystem.neededReplications list.
> When a datanode D1 sends getBlockwork() request to the namenode, the namenode
> selects another node D2 (which it thinks is up and running) where the new replica of the
> under-replicated block will be stored.
> Then namenode removes the block from the neededReplications list and places it to
> the pendingReplications list, and then asks D1 to replicate the block to D2.
> If D2 is in fact down, then replication will fail and will never be retried later, because
> the block is not in the neededReplications list, but rather in the pendingReplications list,
> which namenode never checks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:23:25 2006
Return-Path: 
 <hadoop-dev-return-1150-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20243 invoked from network); 1 May 2006 20:23:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:23:25 -0000
Received: (qmail 69007 invoked by uid 500); 1 May 2006 20:23:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68979 invoked by uid 500); 1 May 2006 20:23:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68970 invoked by uid 99); 1 May 2006 20:23:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:23:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:23:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CC5FB7142AD
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:22:48 +0000 (GMT)
Message-ID: <3465311.1146514968834.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:22:48 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-99) task trackers can only be assigned one
 task every heartbeat
In-Reply-To: <1017503414.1143102720520.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-99?page=all ]

Sameer Paranjpye updated HADOOP-99:
-----------------------------------

    Fix Version: 0.3
      Assign To: Owen O'Malley

> task trackers can only be assigned one task every heartbeat
> -----------------------------------------------------------
>
>          Key: HADOOP-99
>          URL: http://issues.apache.org/jira/browse/HADOOP-99
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> Task trackers only call pollForNewTask once per a heartbeat (10 seconds) rather than when a task finishes. Especially for quick maps this means that the cluster is under utilized, because each map finishes in a cycle and the task tracker never gets a second, third or fourth task to run.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:25:18 2006
Return-Path: 
 <hadoop-dev-return-1151-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21075 invoked from network); 1 May 2006 20:25:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:25:18 -0000
Received: (qmail 70778 invoked by uid 500); 1 May 2006 20:25:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70658 invoked by uid 500); 1 May 2006 20:25:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70647 invoked by uid 99); 1 May 2006 20:25:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:25:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:25:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 745327142A7
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:24:47 +0000 (GMT)
Message-ID: <22271676.1146515087473.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:24:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-135) Potential deadlock in JobTracker.
In-Reply-To: <69894223.1144974540263.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-135?page=all ]

Sameer Paranjpye updated HADOOP-135:
------------------------------------

    Fix Version: 0.3
        Version: 0.1.0
      Assign To: Owen O'Malley

> Potential deadlock in JobTracker.
> ---------------------------------
>
>          Key: HADOOP-135
>          URL: http://issues.apache.org/jira/browse/HADOOP-135
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Konstantin Shvachko
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> org.apache.hadoop.mapred.JobTracker.RetireJobs.run()
> locks resources in this order
>                 synchronized (jobs) {
>                     synchronized (jobInitQueue) {
>                         synchronized (jobsByArrival) {
> org.apache.hadoop.mapred.JobTracker.submitJob()
> locks resources in a different order
>         synchronized (jobs) {
>             synchronized (jobsByArrival) {
>                 synchronized (jobInitQueue) {
> This potentially can lead to a deadlock.
> Unless there is common lock on top of it in which case these
> three locks are redundant.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:27:19 2006
Return-Path: 
 <hadoop-dev-return-1153-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21829 invoked from network); 1 May 2006 20:27:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:27:19 -0000
Received: (qmail 73673 invoked by uid 500); 1 May 2006 20:27:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73560 invoked by uid 500); 1 May 2006 20:27:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73551 invoked by uid 99); 1 May 2006 20:27:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:27:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:27:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DCCED7142AD
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:26:47 +0000 (GMT)
Message-ID: <31686936.1146515207902.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:26:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-181) task trackers should not restart for
 having a late heartbeat
In-Reply-To: <701484.1146509206378.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-181?page=all ]

Sameer Paranjpye updated HADOOP-181:
------------------------------------

    Fix Version: 0.3

> task trackers should not restart for having a late heartbeat
> ------------------------------------------------------------
>
>          Key: HADOOP-181
>          URL: http://issues.apache.org/jira/browse/HADOOP-181
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> TaskTrackers should not close and restart themselves for having a late heartbeat. The JobTracker should just accept their current status.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:27:18 2006
Return-Path: 
 <hadoop-dev-return-1152-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21800 invoked from network); 1 May 2006 20:27:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:27:18 -0000
Received: (qmail 73441 invoked by uid 500); 1 May 2006 20:27:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73419 invoked by uid 500); 1 May 2006 20:27:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73409 invoked by uid 99); 1 May 2006 20:27:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:27:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:27:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 199A67142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:26:47 +0000 (GMT)
Message-ID: <13331930.1146515207102.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:26:47 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-179) task tracker ghosts remain after 10
 minutes
In-Reply-To: <1916800.1146508846408.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-179?page=all ]

Sameer Paranjpye updated HADOOP-179:
------------------------------------

    Fix Version: 0.3

> task tracker ghosts remain after 10 minutes
> -------------------------------------------
>
>          Key: HADOOP-179
>          URL: http://issues.apache.org/jira/browse/HADOOP-179
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> I had a bunch of TaskTrackers time out because they were in the middle of job cleanup and the JobTracker restarted them by responding to emitHeartbeat with UNKNOWN_TASKTRACKER. Afterwards, I ended up with both the new and the restarted TaskTrackers on the list:
> node1100_1234, 0-10 seconds since heartbeat
> node1100_4321,  >10,000 seconds since heartbeat

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:27:30 2006
Return-Path: 
 <hadoop-dev-return-1155-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21954 invoked from network); 1 May 2006 20:27:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:27:30 -0000
Received: (qmail 73941 invoked by uid 500); 1 May 2006 20:27:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73916 invoked by uid 500); 1 May 2006 20:27:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73902 invoked by uid 99); 1 May 2006 20:27:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:27:29 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:27:28 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A96FE7142B5
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:26:48 +0000 (GMT)
Message-ID: <30894251.1146515208691.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:26:48 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-180) task tracker times out cleaning big
 job
In-Reply-To: <24018329.1146508966485.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-180?page=all ]

Sameer Paranjpye updated HADOOP-180:
------------------------------------

    Fix Version: 0.3

> task tracker times out cleaning big job
> ---------------------------------------
>
>          Key: HADOOP-180
>          URL: http://issues.apache.org/jira/browse/HADOOP-180
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> After completing a big job (63,920 maps, 1880 reduces, 188 nodes), lots of the TaskTrackers timed out because the task cleanup is handled by the same thread as the heartbeats.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:27:25 2006
Return-Path: 
 <hadoop-dev-return-1154-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21913 invoked from network); 1 May 2006 20:27:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:27:25 -0000
Received: (qmail 73772 invoked by uid 500); 1 May 2006 20:27:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73754 invoked by uid 500); 1 May 2006 20:27:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73745 invoked by uid 99); 1 May 2006 20:27:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:27:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:27:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7A266410009
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:26:49 +0000 (GMT)
Message-ID: <20407453.1146515209498.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:26:49 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-182) lost task trackers should not update
 status of completed jobs
In-Reply-To: <18534471.1146509326381.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-182?page=all ]

Sameer Paranjpye updated HADOOP-182:
------------------------------------

    Fix Version: 0.3

> lost task trackers should not update status of completed jobs
> -------------------------------------------------------------
>
>          Key: HADOOP-182
>          URL: http://issues.apache.org/jira/browse/HADOOP-182
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.3

>
> When a Task Tracker is lost (by not sending a heartbeat for 10 minutes), the JobTracker marks the tasks that were active on that node as failed. There are two issues:
>    1. No task from a completed or failed job should be modified.
>    2. No reduces should be marked as failed, since their output is in dfs and therefore not only on the dead node.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:34:18 2006
Return-Path: 
 <hadoop-dev-return-1156-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 25635 invoked from network); 1 May 2006 20:34:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:34:18 -0000
Received: (qmail 80148 invoked by uid 500); 1 May 2006 20:34:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80130 invoked by uid 500); 1 May 2006 20:34:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80121 invoked by uid 99); 1 May 2006 20:34:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:34:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:34:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 171AB7142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:33:47 +0000 (GMT)
Message-ID: <29056765.1146515627092.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:33:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-122) Failed to execute fsck with -move
 option
In-Reply-To: <1204783379.1144281644496.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-122?page=comments#action_12377279 ] 

Doug Cutting commented on HADOOP-122:
-------------------------------------

To some degree this is a configuration issue.  A dfs data node stores data under the value of dfs.data.dir.  The dfs client code also writes temporary files in the directory dfs.data.dir.  Probably these should instead be different properties.  But there's also no reason that a client needs to have the same value for this property as a datanode.  So, in short, this can be fixed by changing the value of dfs.data.dir in the client's configuration to an alternate location for temporary files.

> Failed to execute fsck with -move option
> ----------------------------------------
>
>          Key: HADOOP-122
>          URL: http://issues.apache.org/jira/browse/HADOOP-122
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang

>
> I received the following error when running fsck with -move option. The dfs was started by a user while the fsck was ran by a different user that does not have the write access to the hadoop dfs data directory.
> - moving to /lost+found: /data.txt
> java.io.FileNotFoundException: hadoop-dfs-data-dir/tmp/client-8234960199756230677 (Permission denied)
> at java.io.FileOutputStream.open(Native Method)
> at java.io.FileOutputStream.<init>(FileOutputStream.java:179)
> at java.io.FileOutputStream.<init>(FileOutputStream.java:131)
> at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.<init>(DFSClient.java:546)
> at org.apache.hadoop.dfs.DFSClient.create(DFSClient.java:99)
> at org.apache.hadoop.dfs.DFSck.lostFoundMove(DFSck.java:222)
> at org.apache.hadoop.dfs.DFSck.check(DFSck.java:178)
> at org.apache.hadoop.dfs.DFSck.check(DFSck.java:124)
> at org.apache.hadoop.dfs.DFSck.fsck(DFSck.java:112)
> at org.apache.hadoop.dfs.DFSck.main(DFSck.java:433)
> Failed to move /data.txt to /lost+found: hadoop-dfs-data-dir/tmp/client-8234960199756230677 (Permission denied)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 20:40:20 2006
Return-Path: 
 <hadoop-dev-return-1157-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28377 invoked from network); 1 May 2006 20:40:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 20:40:20 -0000
Received: (qmail 90038 invoked by uid 500); 1 May 2006 20:40:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89668 invoked by uid 500); 1 May 2006 20:40:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89659 invoked by uid 99); 1 May 2006 20:40:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:40:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 13:40:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A4FBD7142A6
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 20:39:47 +0000 (GMT)
Message-ID: <4293238.1146515987673.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 20:39:47 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-159) name node at 100% cpu, making
 redundant replications
In-Reply-To: <929695.1145660285762.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-159?page=comments#action_12377280 ] 

Yoram Arnon commented on HADOOP-159:
------------------------------------

It was observed just twice, in the same timeframe.

I'm not aware of any patches that attempt to address this. Logging was added though.
Let's wait a while before closing, unless there's a specific fix.

> name node at 100% cpu, making redundant replications
> ----------------------------------------------------
>
>          Key: HADOOP-159
>          URL: http://issues.apache.org/jira/browse/HADOOP-159
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>     Priority: Blocker
>      Fix For: 0.2

>
> some hours after adding some new nodes to the cluster, the name node went into a state where it's consuming 100% cpu.
> The log file keeps logging messages of the forms
> 060421 155049 Obsoleting block blk_8093115169359854355
> 060421 155049 Pending transfer (block blk_-6965677235456960523) from node1383:50010 to 2 destinations
> 060421 155049 Block report from node1283:50010: 2140 blocks.
> 060421 155049 Redundant addStoredBlock request received for block blk_-6836937139917042917 on node node1143:50010
> many DFS operations time out, making useful work impossible.
> restarting dfs solved the problem for a while, but it came back within an hour.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 21:40:18 2006
Return-Path: 
 <hadoop-dev-return-1158-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49650 invoked from network); 1 May 2006 21:40:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 21:40:18 -0000
Received: (qmail 79715 invoked by uid 500); 1 May 2006 21:40:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79672 invoked by uid 500); 1 May 2006 21:40:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79658 invoked by uid 99); 1 May 2006 21:40:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 14:40:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 14:40:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BC98D7142AD
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 21:39:46 +0000 (GMT)
Message-ID: <10194334.1146519586768.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 21:39:46 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-184) hadoop nightly build and regression
 test on a cluster
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

hadoop nightly build and regression test on a cluster
-----------------------------------------------------

         Key: HADOOP-184
         URL: http://issues.apache.org/jira/browse/HADOOP-184
     Project: Hadoop
        Type: Test

    Reporter: Mahadev konar
    Priority: Minor


create a jar file for the tests and have  filesystem and mapreduce tests on the cluster

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 21:46:18 2006
Return-Path: 
 <hadoop-dev-return-1159-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53998 invoked from network); 1 May 2006 21:46:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 21:46:18 -0000
Received: (qmail 88535 invoked by uid 500); 1 May 2006 21:46:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88511 invoked by uid 500); 1 May 2006 21:46:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88502 invoked by uid 99); 1 May 2006 21:46:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 14:46:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 14:46:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 19D497142A2
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 21:45:47 +0000 (GMT)
Message-ID: <5271946.1146519947102.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 21:45:47 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-184) hadoop nightly build and regression
 test on a cluster
In-Reply-To: <10194334.1146519586768.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-184?page=all ]

Mahadev konar updated HADOOP-184:
---------------------------------

    Attachment: nightly_build.patch

filtered out owen's code for Example Driver to util ProgramDriver.java. Now both the AlltestDriver.java and ExampleDriver.java use this class. Changed the build file to generate a jar file for the test's as well. Changed the MapredLoadTest.java to make it a junit test and run it on a cluster as well.
So the tests can be run as 
bin/hadoop jar hadoop-0.2-test.jar  mapredtest args
bin/hadoop jar hadoop-0.2-test.jar testfilesystem args
on a cluster.

> hadoop nightly build and regression test on a cluster
> -----------------------------------------------------
>
>          Key: HADOOP-184
>          URL: http://issues.apache.org/jira/browse/HADOOP-184
>      Project: Hadoop
>         Type: Test

>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: nightly_build.patch
>
> create a jar file for the tests and have  filesystem and mapreduce tests on the cluster

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 21:46:19 2006
Return-Path: 
 <hadoop-dev-return-1160-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54026 invoked from network); 1 May 2006 21:46:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 21:46:19 -0000
Received: (qmail 88776 invoked by uid 500); 1 May 2006 21:46:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88651 invoked by uid 500); 1 May 2006 21:46:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88642 invoked by uid 99); 1 May 2006 21:46:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 14:46:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 14:46:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DC6507142A7
	for <hadoop-dev@lucene.apache.org>; Mon,  1 May 2006 21:45:47 +0000 (GMT)
Message-ID: <28388361.1146519947900.JavaMail.jira@brutus>
Date: Mon, 1 May 2006 21:45:47 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-63) problem with webapp when start a
 jobtracker
In-Reply-To: <1306920605.1141349984316.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-63?page=comments#action_12377286 ] 

Hairong Kuang commented on HADOOP-63:
-------------------------------------

I believe the issue is still there. But hadoop startup script gets around the problem. Let's clost it.

> problem with webapp when start a jobtracker
> -------------------------------------------
>
>          Key: HADOOP-63
>          URL: http://issues.apache.org/jira/browse/HADOOP-63
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>  Environment: RHL4
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor

>
> there exist two issues with starting up webapp
> 1. webapp is not be able to be loaded from a jar file.
> 2. web.xml can not be parsed properly using java 1.4

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  1 21:53:47 2006
Return-Path: 
 <hadoop-dev-return-1161-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56716 invoked from network); 1 May 2006 21:53:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 21:53:47 -0000
Received: (qmail 98727 invoked by uid 500); 1 May 2006 21:53:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98708 invoked by uid 500); 1 May 2006 21:53:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98699 invoked by uid 99); 1 May 2006 21:53:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 14:53:46 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.145.48.34] (HELO mail-relay1.yahoo.com) (216.145.48.34)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 14:53:45 -0700
Received: from KEPTSHOULDLX (keptshould-lx.corp.yahoo.com [66.228.170.54])
	by mail-relay1.yahoo.com (8.13.6/8.13.6/mr1) with ESMTP id k41LrPg2081684
	for <hadoop-dev@lucene.apache.org>; Mon, 1 May 2006 14:53:25 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	x-mailer:x-mimeole:thread-index;
	b=bNGhKS7ymlztyBKibSvDtFafdpu+mRxskMRGCTW/sWMHPCfE/QddKO7qLZzCcZpD
From: "Hairong Kuang" <hairong@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: fsck with the move option
Date: Mon, 1 May 2006 14:53:24 -0700
Message-ID: <003e01c66d69$ac0266b0$d09215ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_003F_01C66D2E.FFA38EB0"
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZtaauxitCvIVO3TeWi5xLYKy3XBA==
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_NextPart_000_003F_01C66D2E.FFA38EB0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

After I read the fsck code, I realize that if we run fsck with the move
option, the tool actually copies the corrupted files to "/lost+found" block
by block. I feel that it is very expensive especially with large corrupted
file system. Shall we simply do a rename, I mean, moving corrupted files to
"/lost+found"? Rename is a namespace mutation so it is much more efficent.
 
Hairong

------=_NextPart_000_003F_01C66D2E.FFA38EB0--


From MAILER-DAEMON Mon May  1 22:10:36 2006
Return-Path: 
 <hadoop-dev-return-1162-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63641 invoked from network); 1 May 2006 22:10:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 22:10:36 -0000
Received: (qmail 13974 invoked by uid 500); 1 May 2006 22:10:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13954 invoked by uid 500); 1 May 2006 22:10:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13938 invoked by uid 99); 1 May 2006 22:10:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 15:10:35 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 15:10:34 -0700
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k41M8Bbl049088
	for <hadoop-dev@lucene.apache.org>; Mon, 1 May 2006 15:08:11 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:x-mimeole:thread-index:in-reply-to;
	b=JIW6tKNQwasKtXYWwzHxbymMb/Rp1x72EAslhLXYSwHnDku9z0WKiEGgHKeQTYE6
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: fsck with the move option
Date: Mon, 1 May 2006 15:08:11 -0700
Message-ID: <003801c66d6b$bc09e090$496715ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZtaauxitCvIVO3TeWi5xLYKy3XBAAAcmvA
In-Reply-To: <003e01c66d69$ac0266b0$d09215ac@ds.corp.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

+1.
Files that are moved are inaccessible by normal means and there's little
reason to keep two copies of them around. A sys-admin could later either
remove them, or try to reassemble them and return them into place. Leaving
them in their original location just makes it harder to clean them up.

> -----Original Message-----
> From: Hairong Kuang [mailto:hairong@yahoo-inc.com] 
> Sent: Monday, May 01, 2006 2:53 PM
> To: hadoop-dev@lucene.apache.org
> Subject: fsck with the move option
> 
> After I read the fsck code, I realize that if we run fsck 
> with the move option, the tool actually copies the corrupted 
> files to "/lost+found" block by block. I feel that it is very 
> expensive especially with large corrupted file system. Shall 
> we simply do a rename, I mean, moving corrupted files to 
> "/lost+found"? Rename is a namespace mutation so it is much 
> more efficent.
>  
> Hairong
> 


From MAILER-DAEMON Mon May  1 22:30:07 2006
Return-Path: 
 <hadoop-dev-return-1163-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74890 invoked from network); 1 May 2006 22:30:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 May 2006 22:30:07 -0000
Received: (qmail 40992 invoked by uid 500); 1 May 2006 22:29:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40969 invoked by uid 500); 1 May 2006 22:29:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40952 invoked by uid 99); 1 May 2006 22:29:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 15:29:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 15:29:51 -0700
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k41MTk003209
	for <hadoop-dev@lucene.apache.org>; Mon, 1 May 2006 17:29:47 -0500
Message-ID: <44568C47.409@getopt.org>
Date: Tue, 02 May 2006 00:31:35 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: fsck with the move option
References: <003801c66d6b$bc09e090$496715ac@ds.corp.yahoo.com>
In-Reply-To: <003801c66d6b$bc09e090$496715ac@ds.corp.yahoo.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Yoram Arnon wrote:
> +1.
> Files that are moved are inaccessible by normal means and there's little
> reason to keep two copies of them around. A sys-admin could later either
> remove them, or try to reassemble them and return them into place. Leaving
> them in their original location just makes it harder to clean them up.
>
>   

Corrupted files are not left in their original location, if a -move 
option is specified. Fsck does not produce two copies either. As Hairong 
wrote, corrupted files are copied block by block to lost+found, and then 
removed from their original location; at the same time fsck tries to 
glue together consecutive blocks to minimize the number of remaining parts.

Yes, it is expensive. Perhaps we should add another option to -move, 
namely -recover. -move would just move corrupted files to lost+found 
using the namespace change, and -recover would try to recover remaining 
parts.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Tue May  2 03:58:24 2006
Return-Path: 
 <hadoop-dev-return-1164-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7113 invoked from network); 2 May 2006 03:58:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 03:58:24 -0000
Received: (qmail 56606 invoked by uid 500); 2 May 2006 03:58:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56088 invoked by uid 500); 2 May 2006 03:58:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56052 invoked by uid 99); 2 May 2006 03:58:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 20:58:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 20:58:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5EF757142C0
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 03:57:47 +0000 (GMT)
Message-ID: <26320371.1146542267385.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 03:57:47 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-185) tasks are lost during pollForNewTask
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

tasks are lost during pollForNewTask
------------------------------------

         Key: HADOOP-185
         URL: http://issues.apache.org/jira/browse/HADOOP-185
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Critical
     Fix For: 0.2


There is the potential for "losing" tasks that are assigned by the JobTracker to a TaskTracker, but that fail during returning the result (usually due to a RPC timeout). In this case, the Job becomes "wedged" in that the tasks will never run and never time out.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 04:02:18 2006
Return-Path: 
 <hadoop-dev-return-1165-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8101 invoked from network); 2 May 2006 04:02:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 04:02:18 -0000
Received: (qmail 58838 invoked by uid 500); 2 May 2006 04:02:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58713 invoked by uid 500); 2 May 2006 04:02:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58704 invoked by uid 99); 2 May 2006 04:02:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:02:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:02:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0E5747142B7
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 04:01:47 +0000 (GMT)
Message-ID: <17560783.1146542507056.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 04:01:47 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-185) tasks are lost during pollForNewTask
In-Reply-To: <26320371.1146542267385.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-185?page=all ]

Owen O'Malley updated HADOOP-185:
---------------------------------

    Attachment: launch-time-out.patch

This patch adds a new thread to the JobTracker that every three minutes checks the list of launched tasks that haven't been reported yet. If any of them are older than 10 minutes, they are marked as failed.

> tasks are lost during pollForNewTask
> ------------------------------------
>
>          Key: HADOOP-185
>          URL: http://issues.apache.org/jira/browse/HADOOP-185
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: launch-time-out.patch
>
> There is the potential for "losing" tasks that are assigned by the JobTracker to a TaskTracker, but that fail during returning the result (usually due to a RPC timeout). In this case, the Job becomes "wedged" in that the tasks will never run and never time out.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 04:22:19 2006
Return-Path: 
 <hadoop-dev-return-1167-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16429 invoked from network); 2 May 2006 04:22:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 04:22:19 -0000
Received: (qmail 82982 invoked by uid 500); 2 May 2006 04:22:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82961 invoked by uid 500); 2 May 2006 04:22:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82949 invoked by uid 99); 2 May 2006 04:22:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:22:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:22:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5AC497142B5
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 04:21:46 +0000 (GMT)
Message-ID: <18785389.1146543706369.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 04:21:46 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-186) communication problems in the task
 tracker cause long latency
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

communication problems in the task tracker cause long latency
-------------------------------------------------------------

         Key: HADOOP-186
         URL: http://issues.apache.org/jira/browse/HADOOP-186
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


The Task Tracker's offerService loop has no protection from exceptions, so that any communication problems with the Job Tracker, such as RPC timeouts, cause the TaskTracker to sleep 5 seconds and start again at the top of the loop. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 04:22:15 2006
Return-Path: 
 <hadoop-dev-return-1166-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16357 invoked from network); 2 May 2006 04:22:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 04:22:15 -0000
Received: (qmail 82847 invoked by uid 500); 2 May 2006 04:22:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82723 invoked by uid 500); 2 May 2006 04:22:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82707 invoked by uid 99); 2 May 2006 04:22:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:22:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.91] (HELO mailsrv.bangalore.corp.yahoo.com)
 (202.46.19.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:22:11 -0700
Received: from ddaslaptop (vpn-client129.bangalore.corp.yahoo.com
 [172.24.96.129])
	by mailsrv.bangalore.corp.yahoo.com (8.13.6/8.13.4/pop-in) with ESMTP id
 k424Lg5K084475
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 09:51:43 +0530 (IST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=reply-to:from:to:subject:date:organization:message-id:
	mime-version:content-type:content-transfer-encoding:x-mailer:x-mimeole:
	thread-index:in-reply-to;
	b=SPsXOO1naFZ9y78o7KmoGMiwciGZ3K691ICUObA+TZmyu9CmHUfhgJ6S9/BxXvt0
Reply-To: <ddas@yahoo-inc.com>
From: "Devaraj Das" <ddas@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: C API for Hadoop DFS
Date: Tue, 2 May 2006 09:52:51 +0530
Organization: Yahoo India
Message-ID: <02e101c66da0$1435c160$2201a8c0@ddaslaptop>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZsyOiz+uXAf5skSlS1YUkeCkNr3gA1b0Nw
In-Reply-To: <445575BE.6050409@yahoo-inc.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

> Do dfsConnect and dfsOpenFile return NULL on failure?
Yes.

> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
> dfsSetWorkingDirectory each have a return value to indicate success or 
> failure?  Or are they assumed to never fail?
Yes these functions should have return values. I will update the API spec.
Thanks for pointing this out.

-----Original Message-----
From: David Bowen [mailto:dbowen@yahoo-inc.com] 
Sent: Monday, May 01, 2006 8:13 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS


I'm curious about error handling. 

Do dfsConnect and dfsOpenFile return NULL on failure?

Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
dfsSetWorkingDirectory each have a return value to indicate success or 
failure?  Or are they assumed to never fail?

- David




From MAILER-DAEMON Tue May  2 04:28:21 2006
Return-Path: 
 <hadoop-dev-return-1168-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20360 invoked from network); 2 May 2006 04:28:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 04:28:21 -0000
Received: (qmail 90829 invoked by uid 500); 2 May 2006 04:28:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90806 invoked by uid 500); 2 May 2006 04:28:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90796 invoked by uid 99); 2 May 2006 04:28:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:28:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:28:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 45D847142B7
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 04:27:47 +0000 (GMT)
Message-ID: <13150461.1146544067283.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 04:27:47 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-186) communication problems in the task
 tracker cause long latency
In-Reply-To: <18785389.1146543706369.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-186?page=all ]

Owen O'Malley updated HADOOP-186:
---------------------------------

    Attachment: task-tracker-loop-isolation.patch

This patch adds catches around each of the routines that may throw in the offerService loop, with the exception of the emitHeartbeat. (I left one of them unguarded so that if the connection was down, it will get back to TaskTracker.run().) It also moves the time of the previous heartbeat to the top of the cycle rather than the bottom, which means that under load the task tracker stays much closer to a 10 second cycle than before.

> communication problems in the task tracker cause long latency
> -------------------------------------------------------------
>
>          Key: HADOOP-186
>          URL: http://issues.apache.org/jira/browse/HADOOP-186
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: task-tracker-loop-isolation.patch
>
> The Task Tracker's offerService loop has no protection from exceptions, so that any communication problems with the Job Tracker, such as RPC timeouts, cause the TaskTracker to sleep 5 seconds and start again at the top of the loop. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 04:30:19 2006
Return-Path: 
 <hadoop-dev-return-1169-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21634 invoked from network); 2 May 2006 04:30:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 04:30:19 -0000
Received: (qmail 92564 invoked by uid 500); 2 May 2006 04:30:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92443 invoked by uid 500); 2 May 2006 04:30:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92434 invoked by uid 99); 2 May 2006 04:30:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:30:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 21:30:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1608B7142B7
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 04:29:47 +0000 (GMT)
Message-ID: <16945295.1146544187087.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 04:29:47 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-186) communication problems in the task
 tracker cause long latency
In-Reply-To: <18785389.1146543706369.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-186?page=comments#action_12377316 ] 

Owen O'Malley commented on HADOOP-186:
--------------------------------------

I should add that there are other, as yet undiscovered sources of long latency in the TaskTracker. We've seen pings and progress calls that take 5 minutes to complete. This patch does not solve that problem at all.

> communication problems in the task tracker cause long latency
> -------------------------------------------------------------
>
>          Key: HADOOP-186
>          URL: http://issues.apache.org/jira/browse/HADOOP-186
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: task-tracker-loop-isolation.patch
>
> The Task Tracker's offerService loop has no protection from exceptions, so that any communication problems with the Job Tracker, such as RPC timeouts, cause the TaskTracker to sleep 5 seconds and start again at the top of the loop. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 05:31:18 2006
Return-Path: 
 <hadoop-dev-return-1170-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52023 invoked from network); 2 May 2006 05:31:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 05:31:18 -0000
Received: (qmail 37621 invoked by uid 500); 2 May 2006 05:31:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37593 invoked by uid 500); 2 May 2006 05:31:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37580 invoked by uid 99); 2 May 2006 05:31:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 22:31:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 22:31:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 62C587142B5
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 05:30:46 +0000 (GMT)
Message-ID: <22694148.1146547846401.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 05:30:46 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-187) simple distributed dfs random data
 writer & sort example applications
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

simple distributed dfs random data writer & sort example applications
---------------------------------------------------------------------

         Key: HADOOP-187
         URL: http://issues.apache.org/jira/browse/HADOOP-187
     Project: Hadoop
        Type: Test

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


These are the examples/benchmark programs that I've been using to test Hadoop map/reduce with. The first is a program that runs 10 maps/node and each map writes 1 gig of random data to a dfs file as a SequenceFile of BytesWritable/BytesWritable.

The second uses the identity map and reduce to sort the data and write it out to dfs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 05:32:40 2006
Return-Path: 
 <hadoop-dev-return-1171-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52731 invoked from network); 2 May 2006 05:32:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 05:32:40 -0000
Received: (qmail 38129 invoked by uid 500); 2 May 2006 05:32:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38107 invoked by uid 500); 2 May 2006 05:32:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38098 invoked by uid 99); 2 May 2006 05:32:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 22:32:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 22:32:37 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k425Vlbj062212
	for <hadoop-dev@lucene.apache.org>; Mon, 1 May 2006 22:31:47 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=OU8gMZAMiqW7voThlStgR1zt+0SFAQUOuKhZ3bDfUqqCr+Db9vYohWF3vDt5ZFg8
Received: from [10.0.1.2] ([10.72.77.76]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 1 May 2006 22:31:47 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <44568C47.409@getopt.org>
References: <003801c66d6b$bc09e090$496715ac@ds.corp.yahoo.com>
 <44568C47.409@getopt.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <33B02AF4-8667-42BB-B822-4C11C6AC7ACA@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: fsck with the move option
Date: Mon, 1 May 2006 22:31:42 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 02 May 2006 05:31:47.0187 (UTC)
 FILETIME=[B480AC30:01C66DA9]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Why not go after the FS APIs so you can simply read the remaining  
good blocks?  Might it work already if you had a client that skipped  
a block if it found a missing one (via error/exception)?  Or create  
empty blocks...

On May 1, 2006, at 3:31 PM, Andrzej Bialecki wrote:

> Yoram Arnon wrote:
>> +1.
>> Files that are moved are inaccessible by normal means and there's  
>> little
>> reason to keep two copies of them around. A sys-admin could later  
>> either
>> remove them, or try to reassemble them and return them into place.  
>> Leaving
>> them in their original location just makes it harder to clean them  
>> up.
>>
>>
>
> Corrupted files are not left in their original location, if a -move  
> option is specified. Fsck does not produce two copies either. As  
> Hairong wrote, corrupted files are copied block by block to lost 
> +found, and then removed from their original location; at the same  
> time fsck tries to glue together consecutive blocks to minimize the  
> number of remaining parts.
>
> Yes, it is expensive. Perhaps we should add another option to - 
> move, namely -recover. -move would just move corrupted files to lost 
> +found using the namespace change, and -recover would try to  
> recover remaining parts.
>
> -- 
> Best regards,
> Andrzej Bialecki     <><
> ___. ___ ___ ___ _ _   __________________________________
> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> http://www.sigram.com  Contact: info at sigram dot com
>
>


From MAILER-DAEMON Tue May  2 05:33:18 2006
Return-Path: 
 <hadoop-dev-return-1172-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53054 invoked from network); 2 May 2006 05:33:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 05:33:18 -0000
Received: (qmail 38412 invoked by uid 500); 2 May 2006 05:33:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38391 invoked by uid 500); 2 May 2006 05:33:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38382 invoked by uid 99); 2 May 2006 05:33:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 22:33:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 22:33:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2C9177142B5
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 05:32:47 +0000 (GMT)
Message-ID: <26324262.1146547967179.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 05:32:47 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-187) simple distributed dfs random data
 writer & sort example applications
In-Reply-To: <22694148.1146547846401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-187?page=all ]

Owen O'Malley updated HADOOP-187:
---------------------------------

    Attachment: sort-write.patch

> simple distributed dfs random data writer & sort example applications
> ---------------------------------------------------------------------
>
>          Key: HADOOP-187
>          URL: http://issues.apache.org/jira/browse/HADOOP-187
>      Project: Hadoop
>         Type: Test

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: sort-write.patch
>
> These are the examples/benchmark programs that I've been using to test Hadoop map/reduce with. The first is a program that runs 10 maps/node and each map writes 1 gig of random data to a dfs file as a SequenceFile of BytesWritable/BytesWritable.
> The second uses the identity map and reduce to sort the data and write it out to dfs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 06:21:47 2006
Return-Path: 
 <hadoop-dev-return-1173-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81677 invoked from network); 2 May 2006 06:21:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 06:21:47 -0000
Received: (qmail 77838 invoked by uid 500); 2 May 2006 06:21:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77813 invoked by uid 500); 2 May 2006 06:21:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77804 invoked by uid 99); 2 May 2006 06:21:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 23:21:46 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 01 May 2006 23:21:46 -0700
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k426LPG28258
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 01:21:25 -0500
Message-ID: <4456FADD.7030601@getopt.org>
Date: Tue, 02 May 2006 08:23:25 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: fsck with the move option
References: <003801c66d6b$bc09e090$496715ac@ds.corp.yahoo.com>
 <44568C47.409@getopt.org>
 <33B02AF4-8667-42BB-B822-4C11C6AC7ACA@yahoo-inc.com>
In-Reply-To: <33B02AF4-8667-42BB-B822-4C11C6AC7ACA@yahoo-inc.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
> Why not go after the FS APIs so you can simply read the remaining good 
> blocks?  Might it work already if you had a client that skipped a 
> block if it found a missing one (via error/exception)?  Or create 
> empty blocks...

Well, this version of fsck is an interim solution anyway. Currently 
corrupted files can't be processed, so we need a way to weed them out, 
and possible recover as much data as possible from the leftovers.

My point is that we have no other way to do it now. If/when the missing 
block handling improves so that it doesn't kill jobs, we can change this 
part of fsck to simply move files; for now I think a middle-ground 
solution (additional -recover option) would be better.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Tue May  2 18:04:59 2006
Return-Path: 
 <hadoop-dev-return-1174-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84828 invoked from network); 2 May 2006 18:04:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 18:04:59 -0000
Received: (qmail 80582 invoked by uid 500); 2 May 2006 16:18:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80545 invoked by uid 500); 2 May 2006 16:18:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80535 invoked by uid 99); 2 May 2006 16:18:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 09:18:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 09:18:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7F03971429F
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 16:17:46 +0000 (GMT)
Message-ID: <9486077.1146586666516.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 16:17:46 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-188) more unprotected RPC calls in
 JobClient.runJob allow loss of job due to timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

more unprotected RPC calls in JobClient.runJob allow loss of job due to timeout
-------------------------------------------------------------------------------

         Key: HADOOP-188
         URL: http://issues.apache.org/jira/browse/HADOOP-188
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.2


I fixed one of the RPC calls in JobClient.runJob, but I missed a couple of others.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 18:07:00 2006
Return-Path: 
 <hadoop-dev-return-1175-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87930 invoked from network); 2 May 2006 18:07:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 18:07:00 -0000
Received: (qmail 82522 invoked by uid 500); 2 May 2006 16:20:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82496 invoked by uid 500); 2 May 2006 16:20:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82487 invoked by uid 99); 2 May 2006 16:20:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 09:20:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 09:20:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2CAEE71429F
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 16:19:47 +0000 (GMT)
Message-ID: <31860325.1146586787179.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 16:19:47 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-188) more unprotected RPC calls in
 JobClient.runJob allow loss of job due to timeout
In-Reply-To: <9486077.1146586666516.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-188?page=all ]

Owen O'Malley updated HADOOP-188:
---------------------------------

    Attachment: catch-more-client.patch

This patch puts the try block around the entire body of the loop, so that if any IOExceptions are thrown in the runJob loop, the user gets a log message and a few retries before their job is killed.

> more unprotected RPC calls in JobClient.runJob allow loss of job due to timeout
> -------------------------------------------------------------------------------
>
>          Key: HADOOP-188
>          URL: http://issues.apache.org/jira/browse/HADOOP-188
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: catch-more-client.patch
>
> I fixed one of the RPC calls in JobClient.runJob, but I missed a couple of others.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 17:45:19 2006
Return-Path: 
 <hadoop-dev-return-1176-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50333 invoked from network); 2 May 2006 17:45:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 17:45:19 -0000
Received: (qmail 97836 invoked by uid 500); 2 May 2006 17:45:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97806 invoked by uid 500); 2 May 2006 17:45:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97784 invoked by uid 99); 2 May 2006 17:45:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 10:45:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 10:45:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5C88071429B
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 17:44:46 +0000 (GMT)
Message-ID: <26136403.1146591886342.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 17:44:46 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
-------------------------------------------------------------------

         Key: HADOOP-189
         URL: http://issues.apache.org/jira/browse/HADOOP-189
     Project: Hadoop
        Type: New Feature

  Components: mapred  
    Reporter: stack@archive.org


Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 17:55:30 2006
Return-Path: 
 <hadoop-dev-return-1177-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72470 invoked from network); 2 May 2006 17:55:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 17:55:30 -0000
Received: (qmail 20021 invoked by uid 500); 2 May 2006 17:55:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19960 invoked by uid 500); 2 May 2006 17:55:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19902 invoked by uid 99); 2 May 2006 17:55:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 10:55:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 10:55:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 15C1B71429E
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 17:54:47 +0000 (GMT)
Message-ID: <24874348.1146592487086.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 17:54:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-185) tasks are lost during pollForNewTask
In-Reply-To: <26320371.1146542267385.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-185?page=comments#action_12377439 ] 

Doug Cutting commented on HADOOP-185:
-------------------------------------

Might it be cleaner to make the launchingTasks field private to ExpireLaunchingTasks, and have access to it through syncronized methods?  That would make it much easier to assure oneself that it is always accessed in a thread safe manner, as access would be more localized, no?

> tasks are lost during pollForNewTask
> ------------------------------------
>
>          Key: HADOOP-185
>          URL: http://issues.apache.org/jira/browse/HADOOP-185
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: launch-time-out.patch
>
> There is the potential for "losing" tasks that are assigned by the JobTracker to a TaskTracker, but that fail during returning the result (usually due to a RPC timeout). In this case, the Job becomes "wedged" in that the tasks will never run and never time out.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 18:19:41 2006
Return-Path: 
 <hadoop-dev-return-1178-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4320 invoked from network); 2 May 2006 18:19:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 18:19:41 -0000
Received: (qmail 70355 invoked by uid 500); 2 May 2006 18:19:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70333 invoked by uid 500); 2 May 2006 18:19:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70320 invoked by uid 99); 2 May 2006 18:19:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 11:19:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 11:19:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CD1871429B
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 18:19:06 +0000 (GMT)
Message-ID: <26364824.1146593946573.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 18:19:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-186) communication problems in the task
 tracker cause long latency
In-Reply-To: <18785389.1146543706369.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-186?page=all ]
     
Doug Cutting resolved HADOOP-186:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> communication problems in the task tracker cause long latency
> -------------------------------------------------------------
>
>          Key: HADOOP-186
>          URL: http://issues.apache.org/jira/browse/HADOOP-186
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: task-tracker-loop-isolation.patch
>
> The Task Tracker's offerService loop has no protection from exceptions, so that any communication problems with the Job Tracker, such as RPC timeouts, cause the TaskTracker to sleep 5 seconds and start again at the top of the loop. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 18:50:19 2006
Return-Path: 
 <hadoop-dev-return-1179-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31468 invoked from network); 2 May 2006 18:50:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 18:50:19 -0000
Received: (qmail 39640 invoked by uid 500); 2 May 2006 18:50:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39624 invoked by uid 500); 2 May 2006 18:50:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39615 invoked by uid 99); 2 May 2006 18:50:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 11:50:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 11:50:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 46054714295
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 18:49:47 +0000 (GMT)
Message-ID: <31391868.1146595787284.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 18:49:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-187) simple distributed dfs random data
 writer & sort example applications
In-Reply-To: <22694148.1146547846401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-187?page=all ]
     
Doug Cutting resolved HADOOP-187:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen.

> simple distributed dfs random data writer & sort example applications
> ---------------------------------------------------------------------
>
>          Key: HADOOP-187
>          URL: http://issues.apache.org/jira/browse/HADOOP-187
>      Project: Hadoop
>         Type: Test

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: sort-write.patch
>
> These are the examples/benchmark programs that I've been using to test Hadoop map/reduce with. The first is a program that runs 10 maps/node and each map writes 1 gig of random data to a dfs file as a SequenceFile of BytesWritable/BytesWritable.
> The second uses the identity map and reduce to sort the data and write it out to dfs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 19:17:58 2006
Return-Path: 
 <hadoop-dev-return-1180-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48827 invoked from network); 2 May 2006 19:17:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 19:17:58 -0000
Received: (qmail 80829 invoked by uid 500); 2 May 2006 19:17:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80807 invoked by uid 500); 2 May 2006 19:17:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80798 invoked by uid 99); 2 May 2006 19:17:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 12:17:58 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 12:17:57 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k42JGiU9064842
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 12:16:44 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=czoA60HiFbodBdy3YyVETSMgT+UFAtfzqBC3WoGhP6v9Z4srO7Vk+mi+od7mXbXh
Message-ID: <4457B01C.2010007@yahoo-inc.com>
Date: Tue, 02 May 2006 12:16:44 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <02e101c66da0$1435c160$2201a8c0@ddaslaptop>
In-Reply-To: <02e101c66da0$1435c160$2201a8c0@ddaslaptop>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I think this a very important issue raised by David.

IMO __ALL__ functions should return an integer value indicating success 
(=0) or failure (<0).
Unless we want to use C style Exceptions, otherwise we won't be able to 
identify what went
wrong if anything.
NULL or bool is not enough in most cases, since we need to distinguish 
e.g. between
timeout (when we retry) and "file not found" cases.
The actual return objects should be passed as outputs parameters.
E.g.
dfsFS dfsConnect(char *host, tPort port);
will become
tCompletionCode dfsConnect(char *host, tPort port, dfsFS fileSystem );
where tCompletionCode could be integer for now. Or we can define a structure
{ int errCode; char *errDescription; }
to return the actual error descriptions along with the error code.

--Konstantin

Devaraj Das wrote:

>>Do dfsConnect and dfsOpenFile return NULL on failure?
>>    
>>
>Yes.
>
>  
>
>>Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>>dfsSetWorkingDirectory each have a return value to indicate success or 
>>failure?  Or are they assumed to never fail?
>>    
>>
>Yes these functions should have return values. I will update the API spec.
>Thanks for pointing this out.
>
>-----Original Message-----
>From: David Bowen [mailto:dbowen@yahoo-inc.com] 
>Sent: Monday, May 01, 2006 8:13 AM
>To: hadoop-dev@lucene.apache.org
>Subject: Re: C API for Hadoop DFS
>
>
>I'm curious about error handling. 
>
>Do dfsConnect and dfsOpenFile return NULL on failure?
>
>Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>dfsSetWorkingDirectory each have a return value to indicate success or 
>failure?  Or are they assumed to never fail?
>
>- David
>
>
>
>
>
>  
>


From MAILER-DAEMON Tue May  2 19:32:09 2006
Return-Path: 
 <hadoop-dev-return-1181-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63198 invoked from network); 2 May 2006 19:32:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 19:32:09 -0000
Received: (qmail 4698 invoked by uid 500); 2 May 2006 19:32:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4678 invoked by uid 500); 2 May 2006 19:32:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4669 invoked by uid 99); 2 May 2006 19:32:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 12:32:08 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 12:32:07 -0700
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k42JVkng023069
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 15:31:47 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout6-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k42JVjCo200830;
	Tue, 2 May 2006 15:31:45 -0400
Message-ID: <4457B3A0.2060303@apache.org>
Date: Tue, 02 May 2006 12:31:44 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <02e101c66da0$1435c160$2201a8c0@ddaslaptop>
 <4457B01C.2010007@yahoo-inc.com>
In-Reply-To: <4457B01C.2010007@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

The spec says:

/** All APIs set errno to meaningful values */

So callers should always check errno after each call.  Whether this is 
the best way to handle errors in C can be debated, but an error 
mechanism was in fact specified.

Doug

Konstantin Shvachko wrote:
> I think this a very important issue raised by David.
> 
> IMO __ALL__ functions should return an integer value indicating success 
> (=0) or failure (<0).
> Unless we want to use C style Exceptions, otherwise we won't be able to 
> identify what went
> wrong if anything.
> NULL or bool is not enough in most cases, since we need to distinguish 
> e.g. between
> timeout (when we retry) and "file not found" cases.
> The actual return objects should be passed as outputs parameters.
> E.g.
> dfsFS dfsConnect(char *host, tPort port);
> will become
> tCompletionCode dfsConnect(char *host, tPort port, dfsFS fileSystem );
> where tCompletionCode could be integer for now. Or we can define a 
> structure
> { int errCode; char *errDescription; }
> to return the actual error descriptions along with the error code.
> 
> --Konstantin
> 
> Devaraj Das wrote:
> 
>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>   
>>
>> Yes.
>>
>>  
>>
>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>>> dfsSetWorkingDirectory each have a return value to indicate success 
>>> or failure?  Or are they assumed to never fail?
>>>   
>>
>> Yes these functions should have return values. I will update the API 
>> spec.
>> Thanks for pointing this out.
>>
>> -----Original Message-----
>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May 01, 
>> 2006 8:13 AM
>> To: hadoop-dev@lucene.apache.org
>> Subject: Re: C API for Hadoop DFS
>>
>>
>> I'm curious about error handling.
>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>
>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>> dfsSetWorkingDirectory each have a return value to indicate success or 
>> failure?  Or are they assumed to never fail?
>>
>> - David
>>
>>
>>
>>
>>
>>  
>>
> 

From MAILER-DAEMON Tue May  2 19:53:23 2006
Return-Path: 
 <hadoop-dev-return-1182-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72990 invoked from network); 2 May 2006 19:53:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 19:53:23 -0000
Received: (qmail 30945 invoked by uid 500); 2 May 2006 19:53:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30823 invoked by uid 500); 2 May 2006 19:53:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30804 invoked by uid 99); 2 May 2006 19:53:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 12:53:21 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.126.228.150] (HELO rsmtp2.corp.yahoo.com)
 (207.126.228.150)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 12:53:20 -0700
Received: from [192.168.123.102] (S010600062589378a.vn.shawcable.net
 [24.82.143.46])
	(authenticated bits=0)
	by rsmtp2.corp.yahoo.com (8.13.6/8.13.6/y.rout) with ESMTP id k42Jqj6q034407
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 12:52:45 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:organization:user-agent:mime-version:to:
	subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=o+r3gazsb8YE923qgd4gs6ohtWIIKcYJdfpU8cAbbfunVOIvVYFJTCv8EhGGlw73
Message-ID: <4457B88C.6030902@yahoo-inc.com>
Date: Tue, 02 May 2006 12:52:44 -0700
From: David Bowen <dbowen@yahoo-inc.com>
Organization: Yahoo! Inc.
User-Agent: Thunderbird 1.5 (X11/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <02e101c66da0$1435c160$2201a8c0@ddaslaptop>
 <4457B01C.2010007@yahoo-inc.com> <4457B3A0.2060303@apache.org>
In-Reply-To: <4457B3A0.2060303@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> The spec says:
>
> /** All APIs set errno to meaningful values */
>
> So callers should always check errno after each call.  Whether this is 
> the best way to handle errors in C can be debated, but an error 
> mechanism was in fact specified.
I don't much like errno, but if we are using it we should follow the 
normal convention that applications only check errno when a return value 
indicates that there was an error.  So it does not need to be modified 
when there isn't an error.

- David


From MAILER-DAEMON Tue May  2 20:03:23 2006
Return-Path: 
 <hadoop-dev-return-1183-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78073 invoked from network); 2 May 2006 20:03:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 20:03:23 -0000
Received: (qmail 48285 invoked by uid 500); 2 May 2006 20:03:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48259 invoked by uid 500); 2 May 2006 20:03:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48249 invoked by uid 99); 2 May 2006 20:03:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 13:03:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 13:03:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3834F71429D
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 20:02:50 +0000 (GMT)
Message-ID: <27644943.1146600170227.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 20:02:50 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-184) hadoop nightly build and regression
 test on a cluster
In-Reply-To: <10194334.1146519586768.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-184?page=comments#action_12377460 ] 

Doug Cutting commented on HADOOP-184:
-------------------------------------

I'm having trouble applying this patch:

% patch -p 0 < ~/Desktop/nightly_build.patch patching file src/test/org/apache/hadoop/test/AllTestDriver.java patching file src/test/org/apache/hadoop/fs/TestFileSystem.java
patching file src/test/org/apache/hadoop/mapred/TestMapRed.java
patching file src/java/org/apache/hadoop/util/ProgramDriver.java
patching file src/examples/org/apache/hadoop/examples/ExampleDriver.java
patch: **** malformed patch at line 810: Index: build.xml


> hadoop nightly build and regression test on a cluster
> -----------------------------------------------------
>
>          Key: HADOOP-184
>          URL: http://issues.apache.org/jira/browse/HADOOP-184
>      Project: Hadoop
>         Type: Test

>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: nightly_build.patch
>
> create a jar file for the tests and have  filesystem and mapreduce tests on the cluster

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 20:11:23 2006
Return-Path: 
 <hadoop-dev-return-1184-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82201 invoked from network); 2 May 2006 20:11:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 20:11:23 -0000
Received: (qmail 64862 invoked by uid 500); 2 May 2006 20:11:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64794 invoked by uid 500); 2 May 2006 20:11:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64702 invoked by uid 99); 2 May 2006 20:11:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 13:11:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 13:11:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E596E714292
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 20:10:47 +0000 (GMT)
Message-ID: <8575332.1146600647937.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 20:10:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-188) more unprotected RPC calls in
 JobClient.runJob allow loss of job due to timeout
In-Reply-To: <9486077.1146586666516.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-188?page=all ]
     
Doug Cutting resolved HADOOP-188:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen.

> more unprotected RPC calls in JobClient.runJob allow loss of job due to timeout
> -------------------------------------------------------------------------------
>
>          Key: HADOOP-188
>          URL: http://issues.apache.org/jira/browse/HADOOP-188
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: catch-more-client.patch
>
> I fixed one of the RPC calls in JobClient.runJob, but I missed a couple of others.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 20:18:52 2006
Return-Path: 
 <hadoop-dev-return-1185-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87388 invoked from network); 2 May 2006 20:18:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 20:18:52 -0000
Received: (qmail 81675 invoked by uid 500); 2 May 2006 20:18:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81655 invoked by uid 500); 2 May 2006 20:18:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81645 invoked by uid 99); 2 May 2006 20:18:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 13:18:51 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [66.228.160.55] (HELO mercury2.inktomi.com) (66.228.160.55)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 13:18:50 -0700
Received: from inbox2.inktomi.com (inbox2.inktomi.com [66.228.160.112])
	by mercury2.inktomi.com (8.13.4/8.13.4) with ESMTP id k42KI9EP021405
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 13:18:09 -0700 (PDT)
Received: from [207.126.231.126] ([207.126.231.126]) by
          inbox2.inktomi.com (Netscape Messaging Server 4.1) with ESMTP id
          IYNN2900.13S for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006
          13:18:09 -0700
Message-ID: <4457BE81.6010505@yahoo-inc.com>
Date: Tue, 02 May 2006 13:18:09 -0700
From: Sameer Paranjpye <sameerp@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 0.7.1 (Windows/20040626)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <02e101c66da0$1435c160$2201a8c0@ddaslaptop>
 <4457B01C.2010007@yahoo-inc.com> <4457B3A0.2060303@apache.org>
In-Reply-To: <4457B3A0.2060303@apache.org>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

The common convention in C APIs is to have a return value that indicates 
failure, usually -1 or NULL. The caller checks errno only if the return 
value indicates failure.

This appears to be the convention followed in the published API, in most 
places. Functions returning 'void' like 'dfsCreateDirectory' should 
probably return ints with 0 indicating success and -1 indicating failure.

I also notice 'bool' being returned by a couple of functions, these 
should return ints as well.



Doug Cutting wrote:

> The spec says:
> 
> /** All APIs set errno to meaningful values */
> 
> So callers should always check errno after each call.  Whether this is 
> the best way to handle errors in C can be debated, but an error 
> mechanism was in fact specified.
> 
> Doug
> 
> Konstantin Shvachko wrote:
> 
>> I think this a very important issue raised by David.
>>
>> IMO __ALL__ functions should return an integer value indicating 
>> success (=0) or failure (<0).
>> Unless we want to use C style Exceptions, otherwise we won't be able 
>> to identify what went
>> wrong if anything.
>> NULL or bool is not enough in most cases, since we need to distinguish 
>> e.g. between
>> timeout (when we retry) and "file not found" cases.
>> The actual return objects should be passed as outputs parameters.
>> E.g.
>> dfsFS dfsConnect(char *host, tPort port);
>> will become
>> tCompletionCode dfsConnect(char *host, tPort port, dfsFS fileSystem );
>> where tCompletionCode could be integer for now. Or we can define a 
>> structure
>> { int errCode; char *errDescription; }
>> to return the actual error descriptions along with the error code.
>>
>> --Konstantin
>>
>> Devaraj Das wrote:
>>
>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>   
>>>
>>>
>>> Yes.
>>>
>>>  
>>>
>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>>>> dfsSetWorkingDirectory each have a return value to indicate success 
>>>> or failure?  Or are they assumed to never fail?
>>>>   
>>>
>>>
>>> Yes these functions should have return values. I will update the API 
>>> spec.
>>> Thanks for pointing this out.
>>>
>>> -----Original Message-----
>>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May 01, 
>>> 2006 8:13 AM
>>> To: hadoop-dev@lucene.apache.org
>>> Subject: Re: C API for Hadoop DFS
>>>
>>>
>>> I'm curious about error handling.
>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>
>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>>> dfsSetWorkingDirectory each have a return value to indicate success 
>>> or failure?  Or are they assumed to never fail?
>>>
>>> - David
>>>
>>>
>>>
>>>
>>>
>>>  
>>>
>>
> 

From MAILER-DAEMON Tue May  2 20:39:02 2006
Return-Path: 
 <hadoop-dev-return-1186-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97205 invoked from network); 2 May 2006 20:39:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 20:39:02 -0000
Received: (qmail 12842 invoked by uid 500); 2 May 2006 20:39:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12820 invoked by uid 500); 2 May 2006 20:39:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12811 invoked by uid 99); 2 May 2006 20:39:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 13:39:01 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 13:39:01 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k42KbMbx049763
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 13:37:22 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=piNXsNcrK53dlAHHrPsRKAdU3ZaN3VpVf0J/m/RQ7rWmK5zVNHZzc/Wuar1yAQjx
Received: from [172.21.147.237] ([172.21.179.132]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Tue, 2 May 2006 13:37:22 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <4456FADD.7030601@getopt.org>
References: <003801c66d6b$bc09e090$496715ac@ds.corp.yahoo.com>
 <44568C47.409@getopt.org>
 <33B02AF4-8667-42BB-B822-4C11C6AC7ACA@yahoo-inc.com>
 <4456FADD.7030601@getopt.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <12D265E9-06E3-4C75-849A-DFAFCE8F3505@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: fsck with the move option
Date: Tue, 2 May 2006 13:37:16 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 02 May 2006 20:37:22.0960 (UTC)
 FILETIME=[3725A900:01C66E28]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

So the goal is to be able to map/reduce from input files with missing  
blocks?

On May 1, 2006, at 11:23 PM, Andrzej Bialecki wrote:

> Eric Baldeschwieler wrote:
>> Why not go after the FS APIs so you can simply read the remaining  
>> good blocks?  Might it work already if you had a client that  
>> skipped a block if it found a missing one (via error/exception)?   
>> Or create empty blocks...
>
> Well, this version of fsck is an interim solution anyway. Currently  
> corrupted files can't be processed, so we need a way to weed them  
> out, and possible recover as much data as possible from the leftovers.
>
> My point is that we have no other way to do it now. If/when the  
> missing block handling improves so that it doesn't kill jobs, we  
> can change this part of fsck to simply move files; for now I think  
> a middle-ground solution (additional -recover option) would be better.
>
> -- 
> Best regards,
> Andrzej Bialecki     <><
> ___. ___ ___ ___ _ _   __________________________________
> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> http://www.sigram.com  Contact: info at sigram dot com
>
>


From MAILER-DAEMON Tue May  2 21:11:55 2006
Return-Path: 
 <hadoop-dev-return-1187-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11332 invoked from network); 2 May 2006 21:11:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 21:11:55 -0000
Received: (qmail 63895 invoked by uid 500); 2 May 2006 21:11:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63593 invoked by uid 500); 2 May 2006 21:11:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63553 invoked by uid 99); 2 May 2006 21:11:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:11:48 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:11:10 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k42L9sC5060204
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 14:09:54 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=wg0zjT3lj4RNM+C3OdPGVIyhjE9oVlqok+qrLf2WMqV692IikvTJbxAuJvwErQVY
Message-ID: <4457CAA1.5080403@yahoo-inc.com>
Date: Tue, 02 May 2006 14:09:53 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <02e101c66da0$1435c160$2201a8c0@ddaslaptop>
 <4457B01C.2010007@yahoo-inc.com> <4457B3A0.2060303@apache.org>
In-Reply-To: <4457B3A0.2060303@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Don't think errno is a particularly good idea for several reasons.
It is not common to set errno codes.
If a system library function uses errno, and we overwrite its value to 
return
something dfs related, the library function behavior becomes unpredictable.
This could be hard to debug.
We have a JNI layer between our C library and Java, which also might 
generate
errno-s overwriting the values we were trying to bring back from Java.

--Konstantin

Doug Cutting wrote:

> The spec says:
>
> /** All APIs set errno to meaningful values */
>
> So callers should always check errno after each call.  Whether this is 
> the best way to handle errors in C can be debated, but an error 
> mechanism was in fact specified.
>
> Doug
>
> Konstantin Shvachko wrote:
>
>> I think this a very important issue raised by David.
>>
>> IMO __ALL__ functions should return an integer value indicating 
>> success (=0) or failure (<0).
>> Unless we want to use C style Exceptions, otherwise we won't be able 
>> to identify what went
>> wrong if anything.
>> NULL or bool is not enough in most cases, since we need to 
>> distinguish e.g. between
>> timeout (when we retry) and "file not found" cases.
>> The actual return objects should be passed as outputs parameters.
>> E.g.
>> dfsFS dfsConnect(char *host, tPort port);
>> will become
>> tCompletionCode dfsConnect(char *host, tPort port, dfsFS fileSystem );
>> where tCompletionCode could be integer for now. Or we can define a 
>> structure
>> { int errCode; char *errDescription; }
>> to return the actual error descriptions along with the error code.
>>
>> --Konstantin
>>
>> Devaraj Das wrote:
>>
>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>   
>>>
>>>
>>> Yes.
>>>
>>>  
>>>
>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>>>> dfsSetWorkingDirectory each have a return value to indicate success 
>>>> or failure?  Or are they assumed to never fail?
>>>>   
>>>
>>>
>>> Yes these functions should have return values. I will update the API 
>>> spec.
>>> Thanks for pointing this out.
>>>
>>> -----Original Message-----
>>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May 
>>> 01, 2006 8:13 AM
>>> To: hadoop-dev@lucene.apache.org
>>> Subject: Re: C API for Hadoop DFS
>>>
>>>
>>> I'm curious about error handling.
>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>
>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>>> dfsSetWorkingDirectory each have a return value to indicate success 
>>> or failure?  Or are they assumed to never fail?
>>>
>>> - David
>>>
>>>
>>>
>>>
>>>
>>>  
>>>
>>
>
>
>


From MAILER-DAEMON Tue May  2 21:30:24 2006
Return-Path: 
 <hadoop-dev-return-1189-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19340 invoked from network); 2 May 2006 21:30:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 21:30:24 -0000
Received: (qmail 4724 invoked by uid 500); 2 May 2006 21:30:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4598 invoked by uid 500); 2 May 2006 21:30:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4589 invoked by uid 99); 2 May 2006 21:30:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:30:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:30:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BBFBF714292
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 21:29:48 +0000 (GMT)
Message-ID: <3588072.1146605388767.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 21:29:48 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-190) Job fails though task succeeded if we
 fail to exit
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Job fails though task succeeded if we fail to exit
--------------------------------------------------

         Key: HADOOP-190
         URL: http://issues.apache.org/jira/browse/HADOOP-190
     Project: Hadoop
        Type: Bug

    Reporter: stack@archive.org


This is an odd case.  Main cause will be programmer error but I suppose it could happen during normal processing. Whichever, would be grand if hadoop was better able to deal.

My map task completed 'successfully' but because I had started threads inside in my task that were not set to be of daemon type that under certain circumstances were left running,  my child stuck around after reporting 'done' -- the JVM wouldn't go down while non-daemon threads still running.  After ten minutes, TT steps in,  kills the child and does cleanup of the successful output.  Because JT has been told the task completed successfully, reducers keep showing up looking for the output now removed -- until the job fails.

Below is illustration of the problem using log output:

....
060501 090401 task_0001_m_000798_0 0.99491096% adding http://www.score.umd.edu/a
um.jpg 24891 image/jpeg
060501 090401 task_0001_m_000798_0 1.0% adding http://www.score.umd.edu/album.jp
24891 image/jpeg
060501 090401 Task task_0001_m_000798_0 is done.
...
060501 091410 task_0001_m_000798_0: Task failed to report status for 608 seconds
Killing.
....
060501 091410 Calling cleanup because was killed or FAILED task_0001_m_000798_0
060501 091410 task_0001_m_000798_0 done; removing files.

Then, subsequently....

060501 091422 SEVERE Can't open map output:/1/hadoop/tmp/task_0001_m_000798_0/pa
-12.out
java.io.FileNotFoundException: LocalFS
...

and on and on.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 21:30:22 2006
Return-Path: 
 <hadoop-dev-return-1188-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19286 invoked from network); 2 May 2006 21:30:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 21:30:22 -0000
Received: (qmail 4578 invoked by uid 500); 2 May 2006 21:30:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4445 invoked by uid 500); 2 May 2006 21:30:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4426 invoked by uid 99); 2 May 2006 21:30:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:30:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:30:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ABEAB71428F
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 21:29:48 +0000 (GMT)
Message-ID: <30164785.1146605388701.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 21:29:48 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-185) tasks are lost during pollForNewTask
In-Reply-To: <26320371.1146542267385.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-185?page=all ]

Owen O'Malley updated HADOOP-185:
---------------------------------

    Attachment: launch-time-out-2.patch

Ok, this patch pulls the set of launching tasks into the runnable object that checks for expired tasks.

> tasks are lost during pollForNewTask
> ------------------------------------
>
>          Key: HADOOP-185
>          URL: http://issues.apache.org/jira/browse/HADOOP-185
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: launch-time-out-2.patch, launch-time-out.patch
>
> There is the potential for "losing" tasks that are assigned by the JobTracker to a TaskTracker, but that fail during returning the result (usually due to a RPC timeout). In this case, the Job becomes "wedged" in that the tasks will never run and never time out.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 21:32:19 2006
Return-Path: 
 <hadoop-dev-return-1190-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19917 invoked from network); 2 May 2006 21:32:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 21:32:19 -0000
Received: (qmail 8235 invoked by uid 500); 2 May 2006 21:32:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8216 invoked by uid 500); 2 May 2006 21:32:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8207 invoked by uid 99); 2 May 2006 21:32:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:32:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:32:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A9BFD71428E
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 21:31:46 +0000 (GMT)
Message-ID: <30907212.1146605506677.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 21:31:46 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-190) Job fails though task succeeded if we
 fail to exit
In-Reply-To: <3588072.1146605388767.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-190?page=all ]

stack@archive.org updated HADOOP-190:
-------------------------------------

    Attachment: nocleanifdone.patch

Here's a suggested patch.  If task has been marked 'done', don't remove the output (I haven't tested this patch -- the condition is awkward to manufacture).

> Job fails though task succeeded if we fail to exit
> --------------------------------------------------
>
>          Key: HADOOP-190
>          URL: http://issues.apache.org/jira/browse/HADOOP-190
>      Project: Hadoop
>         Type: Bug

>     Reporter: stack@archive.org
>  Attachments: nocleanifdone.patch
>
> This is an odd case.  Main cause will be programmer error but I suppose it could happen during normal processing. Whichever, would be grand if hadoop was better able to deal.
> My map task completed 'successfully' but because I had started threads inside in my task that were not set to be of daemon type that under certain circumstances were left running,  my child stuck around after reporting 'done' -- the JVM wouldn't go down while non-daemon threads still running.  After ten minutes, TT steps in,  kills the child and does cleanup of the successful output.  Because JT has been told the task completed successfully, reducers keep showing up looking for the output now removed -- until the job fails.
> Below is illustration of the problem using log output:
> ....
> 060501 090401 task_0001_m_000798_0 0.99491096% adding http://www.score.umd.edu/a
> um.jpg 24891 image/jpeg
> 060501 090401 task_0001_m_000798_0 1.0% adding http://www.score.umd.edu/album.jp
> 24891 image/jpeg
> 060501 090401 Task task_0001_m_000798_0 is done.
> ...
> 060501 091410 task_0001_m_000798_0: Task failed to report status for 608 seconds
> Killing.
> ....
> 060501 091410 Calling cleanup because was killed or FAILED task_0001_m_000798_0
> 060501 091410 task_0001_m_000798_0 done; removing files.
> Then, subsequently....
> 060501 091422 SEVERE Can't open map output:/1/hadoop/tmp/task_0001_m_000798_0/pa
> -12.out
> java.io.FileNotFoundException: LocalFS
> ...
> and on and on.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 21:34:13 2006
Return-Path: 
 <hadoop-dev-return-1191-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20804 invoked from network); 2 May 2006 21:34:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 21:34:13 -0000
Received: (qmail 12113 invoked by uid 500); 2 May 2006 21:34:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11990 invoked by uid 500); 2 May 2006 21:34:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11892 invoked by uid 99); 2 May 2006 21:34:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:34:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:34:09 -0700
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k42LY2S14035
	for <hadoop-dev@lucene.apache.org>; Tue, 2 May 2006 16:34:03 -0500
Message-ID: <4457D0BB.3010506@getopt.org>
Date: Tue, 02 May 2006 23:35:55 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: fsck with the move option
References: <003801c66d6b$bc09e090$496715ac@ds.corp.yahoo.com>
 <44568C47.409@getopt.org>
 <33B02AF4-8667-42BB-B822-4C11C6AC7ACA@yahoo-inc.com>
 <4456FADD.7030601@getopt.org>
 <12D265E9-06E3-4C75-849A-DFAFCE8F3505@yahoo-inc.com>
In-Reply-To: <12D265E9-06E3-4C75-849A-DFAFCE8F3505@yahoo-inc.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
> So the goal is to be able to map/reduce from input files with missing 
> blocks?

Yes, we should be able to skip bad records (missing blocks fall into 
this category), report them and continue.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Tue May  2 21:54:20 2006
Return-Path: 
 <hadoop-dev-return-1192-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30256 invoked from network); 2 May 2006 21:54:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 21:54:20 -0000
Received: (qmail 42511 invoked by uid 500); 2 May 2006 21:54:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42486 invoked by uid 500); 2 May 2006 21:54:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42477 invoked by uid 99); 2 May 2006 21:54:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:54:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 14:54:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 19FDC714292
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 21:53:47 +0000 (GMT)
Message-ID: <9305555.1146606827103.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 21:53:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-189?page=all ]

Doug Cutting updated HADOOP-189:
--------------------------------

    Attachment: local-jar.patch

Tell me if this fixes things for you.  Thanks!

> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>  Attachments: local-jar.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 22:07:20 2006
Return-Path: 
 <hadoop-dev-return-1193-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36880 invoked from network); 2 May 2006 22:07:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 22:07:20 -0000
Received: (qmail 73286 invoked by uid 500); 2 May 2006 22:07:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73161 invoked by uid 500); 2 May 2006 22:07:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73152 invoked by uid 99); 2 May 2006 22:07:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:07:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:07:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1C48A71428E
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 22:06:47 +0000 (GMT)
Message-ID: <12128935.1146607607113.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 22:06:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-185) tasks are lost during pollForNewTask
In-Reply-To: <26320371.1146542267385.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-185?page=all ]
     
Doug Cutting resolved HADOOP-185:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> tasks are lost during pollForNewTask
> ------------------------------------
>
>          Key: HADOOP-185
>          URL: http://issues.apache.org/jira/browse/HADOOP-185
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: launch-time-out-2.patch, launch-time-out.patch
>
> There is the potential for "losing" tasks that are assigned by the JobTracker to a TaskTracker, but that fail during returning the result (usually due to a RPC timeout). In this case, the Job becomes "wedged" in that the tasks will never run and never time out.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 22:11:19 2006
Return-Path: 
 <hadoop-dev-return-1194-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38979 invoked from network); 2 May 2006 22:11:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 22:11:19 -0000
Received: (qmail 77552 invoked by uid 500); 2 May 2006 22:11:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77528 invoked by uid 500); 2 May 2006 22:11:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77519 invoked by uid 99); 2 May 2006 22:11:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:11:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:11:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6334D71428E
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 22:10:46 +0000 (GMT)
Message-ID: <8632181.1146607846403.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 22:10:46 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-191) add hadoopStreaming to src/contrib
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

add hadoopStreaming to src/contrib
----------------------------------

         Key: HADOOP-191
         URL: http://issues.apache.org/jira/browse/HADOOP-191
     Project: Hadoop
        Type: New Feature

    Reporter: Michel Tourn
 Assigned to: Doug Cutting 


This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)


TO test the patch: 
Merge the patch. 
The only existing file that is modified is trunk/build.xml
trunk>ant deploy-contrib
trunk>bin/hadoopStreaming : should show usage message
trunk>ant test-contrib    : should run one test successfully

TO add src/contrib/someOtherProject:
edit src/contrib/build.xml





-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 22:12:38 2006
Return-Path: 
 <hadoop-dev-return-1195-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39575 invoked from network); 2 May 2006 22:12:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 22:12:38 -0000
Received: (qmail 81297 invoked by uid 500); 2 May 2006 22:12:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81274 invoked by uid 500); 2 May 2006 22:12:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81261 invoked by uid 99); 2 May 2006 22:12:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:12:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:12:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D3F3A71423B
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 22:11:47 +0000 (GMT)
Message-ID: <11042079.1146607907865.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 22:11:47 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-191?page=all ]

Michel Tourn updated HADOOP-191:
--------------------------------

    Attachment: streaming.patch

> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>  Attachments: streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 22:12:40 2006
Return-Path: 
 <hadoop-dev-return-1196-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39616 invoked from network); 2 May 2006 22:12:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 22:12:40 -0000
Received: (qmail 81387 invoked by uid 500); 2 May 2006 22:12:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81364 invoked by uid 500); 2 May 2006 22:12:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81342 invoked by uid 99); 2 May 2006 22:12:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:12:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:12:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 195B171428E
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 22:11:49 +0000 (GMT)
Message-ID: <25775334.1146607909101.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 22:11:49 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-184) hadoop nightly build and regression
 test on a cluster
In-Reply-To: <10194334.1146519586768.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-184?page=all ]

Mahadev konar updated HADOOP-184:
---------------------------------

    Attachment: nightly_build.patch

attaching the updated patch. should work now..


> hadoop nightly build and regression test on a cluster
> -----------------------------------------------------
>
>          Key: HADOOP-184
>          URL: http://issues.apache.org/jira/browse/HADOOP-184
>      Project: Hadoop
>         Type: Test

>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: nightly_build.patch, nightly_build.patch
>
> create a jar file for the tests and have  filesystem and mapreduce tests on the cluster

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 22:19:21 2006
Return-Path: 
 <hadoop-dev-return-1197-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42039 invoked from network); 2 May 2006 22:19:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 22:19:21 -0000
Received: (qmail 88479 invoked by uid 500); 2 May 2006 22:19:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88461 invoked by uid 500); 2 May 2006 22:19:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88452 invoked by uid 99); 2 May 2006 22:19:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:19:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:19:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1326C71428E
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 22:18:47 +0000 (GMT)
Message-ID: <26589678.1146608327075.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 22:18:47 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-191?page=comments#action_12377480 ] 

Michel Tourn commented on HADOOP-191:
-------------------------------------

The usage message:

hadoop-trunk>bin/hadoopStreaming

Usage: hadoopStreaming [options]
Options:
  -input   <path>     DFS input file(s) for the Map step
  -output  <path>     DFS output directory for the Reduce step
  -mapper  <cmd>      The streaming command to run
  -reducer <cmd>      The streaming command to run
  -files   <file>     Additional files to be shipped in the Job jar file
  -cluster <name>     Default uses hadoop-default.xml and hadoop-site.xml
  -config  <file>     Optional. One or more paths to xml config files
  -inputreader <spec> Optional. See below
  -verbose

In -input: globbing on <path> is supported and can have multiple -input
Default Map input format: a line is a record in UTF-8
  the key part ends at first TAB, the rest of the line is the value
Custom Map input format: -inputreader package.MyRecordReader,n=v,n=v
  comma-separated name-values can be specified to configure the InputFormat
  Ex: -inputreader 'StreamXmlRecordReader,begin=<doc>,end=</doc>'
Map output format, reduce input/output format:
  Format defined by what mapper command outputs. Line-oriented
Mapper and Reducer <cmd> syntax:
  If the mapper or reducer programs are prefixed with noship: then
  the paths are assumed to be valid absolute paths on the task tracker machines
  and are NOT packaged with the Job jar file.
Use -cluster <name> to switch between "local" Hadoop and one or more remote
  Hadoop clusters.
  The default is to use the normal hadoop-default.xml and hadoop-site.xml
  Else configuration will use $HADOOP_HOME/conf/hadoop-<name>.xml

Example: hadoopStreaming -mapper "noship:/usr/local/bin/perl5 filter.pl"
           -files /local/filter.pl -input "/logs/0604*/*" [...]
  Ships a script, invokes the non-shipped perl interpreter
  Shipped files go to the working directory so filter.pl is found by perl
  Input files are all the daily logs for days in month 2006-04


> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>  Attachments: streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 22:46:20 2006
Return-Path: 
 <hadoop-dev-return-1198-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51414 invoked from network); 2 May 2006 22:46:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 22:46:20 -0000
Received: (qmail 30330 invoked by uid 500); 2 May 2006 22:46:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30303 invoked by uid 500); 2 May 2006 22:46:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30292 invoked by uid 99); 2 May 2006 22:46:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:46:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:46:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 12F5271423B
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 22:45:47 +0000 (GMT)
Message-ID: <20337897.1146609947075.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 22:45:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-191?page=comments#action_12377484 ] 

Doug Cutting commented on HADOOP-191:
-------------------------------------

Most of the changes to the top-level build.xml don't seem to be required, and a number are spurious whitespace and comment changes.  It seems to build fine with only the new targets added.

Also, is the new bin/ script required?  Won't 'bin/hadoop jar build/hadoop-streaming.jar ...' suffice?  (You'll need to set the "Main-Class" attribute in the jar's manifest.)


> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>  Attachments: streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 22:55:21 2006
Return-Path: 
 <hadoop-dev-return-1199-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55003 invoked from network); 2 May 2006 22:55:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 22:55:21 -0000
Received: (qmail 39018 invoked by uid 500); 2 May 2006 22:55:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38982 invoked by uid 500); 2 May 2006 22:55:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38939 invoked by uid 99); 2 May 2006 22:55:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:55:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 15:55:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AAC9171428C
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 22:54:46 +0000 (GMT)
Message-ID: <20045588.1146610486676.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 22:54:46 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-190) Job fails though task succeeded if we
 fail to exit
In-Reply-To: <3588072.1146605388767.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-190?page=all ]
     
Doug Cutting resolved HADOOP-190:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I applied this patch.  Thanks, Michael.

> Job fails though task succeeded if we fail to exit
> --------------------------------------------------
>
>          Key: HADOOP-190
>          URL: http://issues.apache.org/jira/browse/HADOOP-190
>      Project: Hadoop
>         Type: Bug

>     Reporter: stack@archive.org
>      Fix For: 0.2
>  Attachments: nocleanifdone.patch
>
> This is an odd case.  Main cause will be programmer error but I suppose it could happen during normal processing. Whichever, would be grand if hadoop was better able to deal.
> My map task completed 'successfully' but because I had started threads inside in my task that were not set to be of daemon type that under certain circumstances were left running,  my child stuck around after reporting 'done' -- the JVM wouldn't go down while non-daemon threads still running.  After ten minutes, TT steps in,  kills the child and does cleanup of the successful output.  Because JT has been told the task completed successfully, reducers keep showing up looking for the output now removed -- until the job fails.
> Below is illustration of the problem using log output:
> ....
> 060501 090401 task_0001_m_000798_0 0.99491096% adding http://www.score.umd.edu/a
> um.jpg 24891 image/jpeg
> 060501 090401 task_0001_m_000798_0 1.0% adding http://www.score.umd.edu/album.jp
> 24891 image/jpeg
> 060501 090401 Task task_0001_m_000798_0 is done.
> ...
> 060501 091410 task_0001_m_000798_0: Task failed to report status for 608 seconds
> Killing.
> ....
> 060501 091410 Calling cleanup because was killed or FAILED task_0001_m_000798_0
> 060501 091410 task_0001_m_000798_0 done; removing files.
> Then, subsequently....
> 060501 091422 SEVERE Can't open map output:/1/hadoop/tmp/task_0001_m_000798_0/pa
> -12.out
> java.io.FileNotFoundException: LocalFS
> ...
> and on and on.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 23:02:19 2006
Return-Path: 
 <hadoop-dev-return-1200-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58314 invoked from network); 2 May 2006 23:02:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 23:02:19 -0000
Received: (qmail 45057 invoked by uid 500); 2 May 2006 23:02:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 45033 invoked by uid 500); 2 May 2006 23:02:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 45024 invoked by uid 99); 2 May 2006 23:02:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 16:02:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 16:02:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 172E771428C
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 23:01:47 +0000 (GMT)
Message-ID: <29844612.1146610907092.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 23:01:47 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-191?page=comments#action_12377487 ] 

Michel Tourn commented on HADOOP-191:
-------------------------------------

>top-level build.xml : 
OK, I can remove the unnecessary changes.
Which contrib targets would you keep in?
I mimicked deploy-contrib, test-contrib, clean-contrib on Nutch plugins.
(It is true that for now the new targets are not required since the nightly target does not call them.)

>bin/hadoop jar build/hadoop-streaming.jar ...
Looks cleaner. I'll try to do it this way



> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>  Attachments: streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 23:09:20 2006
Return-Path: 
 <hadoop-dev-return-1201-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61238 invoked from network); 2 May 2006 23:09:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 23:09:20 -0000
Received: (qmail 51084 invoked by uid 500); 2 May 2006 23:09:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51063 invoked by uid 500); 2 May 2006 23:09:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51047 invoked by uid 99); 2 May 2006 23:09:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 16:09:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 16:09:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 326F2410005
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 23:08:47 +0000 (GMT)
Message-ID: <28391263.1146611327204.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 23:08:47 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-94) disallow more than one datanode
 running on one computing sharing the same data directory
In-Reply-To: <1264551394.1142645179057.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-94?page=all ]
     
eric baldeschwieler resolved HADOOP-94:
---------------------------------------

    Resolution: Duplicate

> disallow more than one datanode running on one computing sharing the same data directory
> ----------------------------------------------------------------------------------------
>
>          Key: HADOOP-94
>          URL: http://issues.apache.org/jira/browse/HADOOP-94
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Hairong Kuang
>      Fix For: 0.3

>
> Currently dfs disallows more one datanode to run on the same computer if they are started up using the same hadoop conf dir. However, this does not prevent more than one data node gets started, each using a different conf dir (strickly speaking, a different pid file). If every machine has two such datanodes running, namenode will be busy on deleting and replicating blocks or eventually lead to block loss.
> Suggested solution: put pid file in  the data directory and disallow configuration.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 23:11:20 2006
Return-Path: 
 <hadoop-dev-return-1202-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63074 invoked from network); 2 May 2006 23:11:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 23:11:20 -0000
Received: (qmail 55600 invoked by uid 500); 2 May 2006 23:11:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55584 invoked by uid 500); 2 May 2006 23:11:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55575 invoked by uid 99); 2 May 2006 23:11:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 16:11:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 16:11:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 195ED410005
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 23:10:47 +0000 (GMT)
Message-ID: <30081257.1146611447101.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 23:10:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-191?page=comments#action_12377488 ] 

Doug Cutting commented on HADOOP-191:
-------------------------------------

I'm okay with all the contrib targets.  But all of the other changes to that file seem spurious.  The new properties are unused and the directory created will be created by another build script anyway.

> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>  Attachments: streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  2 23:13:20 2006
Return-Path: 
 <hadoop-dev-return-1203-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65019 invoked from network); 2 May 2006 23:13:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 May 2006 23:13:20 -0000
Received: (qmail 58459 invoked by uid 500); 2 May 2006 23:13:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58438 invoked by uid 500); 2 May 2006 23:13:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58429 invoked by uid 99); 2 May 2006 23:13:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 16:13:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 16:13:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9364E71428C
	for <hadoop-dev@lucene.apache.org>; Tue,  2 May 2006 23:12:47 +0000 (GMT)
Message-ID: <29707638.1146611567601.JavaMail.jira@brutus>
Date: Tue, 2 May 2006 23:12:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-184) hadoop nightly build and regression
 test on a cluster
In-Reply-To: <10194334.1146519586768.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-184?page=all ]
     
Doug Cutting resolved HADOOP-184:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Mahadev konar

I just committed this.  Thanks, Mahadev.

> hadoop nightly build and regression test on a cluster
> -----------------------------------------------------
>
>          Key: HADOOP-184
>          URL: http://issues.apache.org/jira/browse/HADOOP-184
>      Project: Hadoop
>         Type: Test

>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: nightly_build.patch, nightly_build.patch
>
> create a jar file for the tests and have  filesystem and mapreduce tests on the cluster

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 00:01:20 2006
Return-Path: 
 <hadoop-dev-return-1204-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83780 invoked from network); 3 May 2006 00:01:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 00:01:20 -0000
Received: (qmail 15705 invoked by uid 500); 3 May 2006 00:01:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15679 invoked by uid 500); 3 May 2006 00:01:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15670 invoked by uid 99); 3 May 2006 00:01:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 17:01:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 17:01:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 15DD471428C
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 00:00:47 +0000 (GMT)
Message-ID: <31513102.1146614447086.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 00:00:47 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-191?page=all ]

Michel Tourn updated HADOOP-191:
--------------------------------

    Attachment: streaming.2.patch

Updated patch:

1. top-level build.xml has 3 contrib targets and no other changes.

2. script hadoopStreaming is gone. 
new Usage message: 
bin/hadoop jar build/hadoop-streaming.jar [options]

3. removed some spurious exec permissions on  source files


> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>  Attachments: streaming.2.patch, streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 00:11:20 2006
Return-Path: 
 <hadoop-dev-return-1205-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87182 invoked from network); 3 May 2006 00:11:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 00:11:20 -0000
Received: (qmail 28000 invoked by uid 500); 3 May 2006 00:11:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27980 invoked by uid 500); 3 May 2006 00:11:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27971 invoked by uid 99); 3 May 2006 00:11:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 17:11:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 17:11:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 36B6B71428D
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 00:10:47 +0000 (GMT)
Message-ID: <8977828.1146615047221.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 00:10:47 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-54) SequenceFile should compress blocks,
 not individual entries
In-Reply-To: <442955632.1140640880483.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-54?page=all ]

eric baldeschwieler updated HADOOP-54:
--------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> SequenceFile should compress blocks, not individual entries
> -----------------------------------------------------------
>
>          Key: HADOOP-54
>          URL: http://issues.apache.org/jira/browse/HADOOP-54
>      Project: Hadoop
>         Type: Improvement

>   Components: io
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Michel Tourn
>      Fix For: 0.4

>
> SequenceFile will optionally compress individual values.  But both compression and performance would be much better if sequences of keys and values are compressed together.  Sync marks should only be placed between blocks.  This will require some changes to MapFile too, so that all file positions stored there are the positions of blocks, not entries within blocks.  Probably this can be accomplished by adding a getBlockStartPosition() method to SequenceFile.Writer.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 00:11:21 2006
Return-Path: 
 <hadoop-dev-return-1206-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87208 invoked from network); 3 May 2006 00:11:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 00:11:21 -0000
Received: (qmail 28150 invoked by uid 500); 3 May 2006 00:11:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28123 invoked by uid 500); 3 May 2006 00:11:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28114 invoked by uid 99); 3 May 2006 00:11:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 17:11:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 17:11:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0D872410005
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 00:10:48 +0000 (GMT)
Message-ID: <23943105.1146615048052.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 00:10:48 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-48) add user data to task reports
In-Reply-To: <642884722.1140560655919.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-48?page=all ]

eric baldeschwieler updated HADOOP-48:
--------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> add user data to task reports
> -----------------------------
>
>          Key: HADOOP-48
>          URL: http://issues.apache.org/jira/browse/HADOOP-48
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>      Fix For: 0.4

>
> The Reporter interface should permit tasks to set user-data for a task, either as a String or, better-yet, as a Writable.  This should be returned with each TaskReport.  This would facilitate programmatic instrumentation of tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 00:13:19 2006
Return-Path: 
 <hadoop-dev-return-1207-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87562 invoked from network); 3 May 2006 00:13:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 00:13:19 -0000
Received: (qmail 28807 invoked by uid 500); 3 May 2006 00:13:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28781 invoked by uid 500); 3 May 2006 00:13:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28768 invoked by uid 99); 3 May 2006 00:13:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 17:13:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 17:13:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0917171428D
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 00:12:47 +0000 (GMT)
Message-ID: <29363420.1146615167034.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 00:12:47 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-64) DataNode should be capable of managing
 multiple volumes
In-Reply-To: <96561968.1141686362086.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-64?page=all ]

eric baldeschwieler updated HADOOP-64:
--------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> DataNode should be capable of managing multiple volumes
> -------------------------------------------------------
>
>          Key: HADOOP-64
>          URL: http://issues.apache.org/jira/browse/HADOOP-64
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.4

>
> The dfs Datanode can only store data on a single filesystem volume. When a node runs its disks JBOD this means running a Datanode per disk on the machine. While the scheme works reasonably well on small clusters, on larger installations (several 100 nodes) it implies a very large number of Datanodes with associated management overhead in the Namenode.
> The Datanod should be enhanced to be able to handle multiple volumes on a single machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 02:14:25 2006
Return-Path: 
 <hadoop-dev-return-1208-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 25751 invoked from network); 3 May 2006 02:14:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 02:14:25 -0000
Received: (qmail 26569 invoked by uid 500); 3 May 2006 02:14:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26544 invoked by uid 500); 3 May 2006 02:14:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26535 invoked by uid 99); 3 May 2006 02:14:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 19:14:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 19:14:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7D2DF71428D
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 02:13:51 +0000 (GMT)
Message-ID: <7697998.1146622431452.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 02:13:51 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-189?page=comments#action_12377506 ] 

stack@archive.org commented on HADOOP-189:
------------------------------------------

The patch seems to have no effect.  When my map goes to run, unless the classes I want to instantiate are in the root of the job jar, they are not found (ClassNotFoundException).  Nothing under the job jar /lib nor /classes directory is ever found.  

Tracing, I see that any new class will have null for ClassLoader -- i.e. the "bootstrap class loader" -- never the URLClassLoader created by this patch. 

Seems like this patch runs too late in the game to be of use?   In order to create a job, I need to be able to refer to the implementing class (and possibly configurations) BEFORE LocalJobRunner has had a chance to do its job jar unrolling machinations.  To be able to refer to implementing classes, they need to be on the immediate CLASSPATH.  

Seems like any messings w/ classloading populating the CLASSPATH needs to happen before we run Main-Class. This would be most useful I'd imagine.  Would a java program that did nothing but read hadoop config. for hadoop local and system dir and then unrolled the job jar finishing by emitting Main-Class and CLASSPATH additions for the hadoop script to exec online #156 be too ugly?  It would have the advantage of resemblng how job jars are unrolled out on slaves.

I can work up such a patch if amenable.



> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>  Attachments: local-jar.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 03:06:46 2006
Return-Path: 
 <hadoop-dev-return-1209-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42745 invoked from network); 3 May 2006 03:06:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 03:06:46 -0000
Received: (qmail 56427 invoked by uid 500); 3 May 2006 03:06:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56034 invoked by uid 500); 3 May 2006 03:06:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55936 invoked by uid 99); 3 May 2006 03:06:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 20:06:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 20:06:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 58F6C410009
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 03:05:49 +0000 (GMT)
Message-ID: <14557107.1146625549361.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 03:05:49 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-189?page=comments#action_12377510 ] 

Doug Cutting commented on HADOOP-189:
-------------------------------------

> Tracing, I see that any new class will have null for ClassLoader

For this patch to work your, e.g., Mapper class needs to only be in the job jar, not also on the classpath built by bin/hadoop.  If you are able to instantiate classes in the job jar, and they show up with the bootstrap class loader, then that means the jar file is somehow on the bootstrap classpath, which it should not be after the changes to 'bin/hadoop jar' made in the patch.  Is that how you are starting things?

Another potential problem could be that the URLClassloader is not correctly constructed.  The urls added must be either a jar file or end in slashes.  It might be useful to log the urls added to the path in LocalJobRunner to check this.

> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>  Attachments: local-jar.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 06:18:38 2006
Return-Path: 
 <hadoop-dev-return-1210-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20990 invoked from network); 3 May 2006 06:18:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 06:18:38 -0000
Received: (qmail 12655 invoked by uid 500); 3 May 2006 06:18:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12521 invoked by uid 500); 3 May 2006 06:18:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12504 invoked by uid 99); 3 May 2006 06:18:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 23:18:36 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.91] (HELO mailsrv.bangalore.corp.yahoo.com)
 (202.46.19.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 23:18:35 -0700
Received: from ddaslaptop (boniface-laptop.bangalore.corp.yahoo.com
 [172.24.91.182])
	by mailsrv.bangalore.corp.yahoo.com (8.13.6/8.13.4/pop-in) with ESMTP id
 k436I7t0093797
	for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006 11:48:07 +0530 (IST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=reply-to:from:to:subject:date:organization:message-id:
	mime-version:content-type:content-transfer-encoding:x-mailer:x-mimeole:
	thread-index:in-reply-to;
	b=LS7OPmZAE+sf/9XS2udoR/AnR/z3QJUTlmhP7LRZEWNGVcpqf6Y7kX0HbHasfFcV
Reply-To: <ddas@yahoo-inc.com>
From: "Devaraj Das" <ddas@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: C API for Hadoop DFS
Date: Wed, 3 May 2006 11:49:17 +0530
Organization: Yahoo India
Message-ID: <030e01c66e79$81b97130$2201a8c0@ddaslaptop>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZuLRmtyETWOfRBTmS01j0bfPF5pgARSAwg
In-Reply-To: <4457CAA1.5080403@yahoo-inc.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

In our case, the components involved are the C API library, JNI layer and
Java APIs. In all these, we have control over errno. For example, if a
particular C API uses a third party library function that might return error
and hence set errno, we know about it already. Depending on the error, we
take a decision whether to proceed further in the API implementation code or
return an error to the client invoking the API. This includes the functions
in the JNI library which the API implementation calls. In the Java world, we
deal with exceptions and don't bother about errno. So for example, if a Java
method, invoked through JNI from a C API, throws an exception, the C API
implementation will get the exception object and depending on that the API
implementation will set a meaningful errno and return a (-1) or NULL to
signify that an error occurred. As I said earlier, this includes the case
where the JNI function itself fails (for some reason like out-of-memory or
something).
As an aside, the JNI layer doesn't generate errno-s.

-----Original Message-----
From: Konstantin Shvachko [mailto:shv@yahoo-inc.com] 
Sent: Wednesday, May 03, 2006 2:40 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS

Don't think errno is a particularly good idea for several reasons.
It is not common to set errno codes.
If a system library function uses errno, and we overwrite its value to 
return
something dfs related, the library function behavior becomes unpredictable.
This could be hard to debug.
We have a JNI layer between our C library and Java, which also might 
generate
errno-s overwriting the values we were trying to bring back from Java.

--Konstantin

Doug Cutting wrote:

> The spec says:
>
> /** All APIs set errno to meaningful values */
>
> So callers should always check errno after each call.  Whether this is 
> the best way to handle errors in C can be debated, but an error 
> mechanism was in fact specified.
>
> Doug
>
> Konstantin Shvachko wrote:
>
>> I think this a very important issue raised by David.
>>
>> IMO __ALL__ functions should return an integer value indicating 
>> success (=0) or failure (<0).
>> Unless we want to use C style Exceptions, otherwise we won't be able 
>> to identify what went
>> wrong if anything.
>> NULL or bool is not enough in most cases, since we need to 
>> distinguish e.g. between
>> timeout (when we retry) and "file not found" cases.
>> The actual return objects should be passed as outputs parameters.
>> E.g.
>> dfsFS dfsConnect(char *host, tPort port);
>> will become
>> tCompletionCode dfsConnect(char *host, tPort port, dfsFS fileSystem );
>> where tCompletionCode could be integer for now. Or we can define a 
>> structure
>> { int errCode; char *errDescription; }
>> to return the actual error descriptions along with the error code.
>>
>> --Konstantin
>>
>> Devaraj Das wrote:
>>
>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>   
>>>
>>>
>>> Yes.
>>>
>>>  
>>>
>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>>>> dfsSetWorkingDirectory each have a return value to indicate success 
>>>> or failure?  Or are they assumed to never fail?
>>>>   
>>>
>>>
>>> Yes these functions should have return values. I will update the API 
>>> spec.
>>> Thanks for pointing this out.
>>>
>>> -----Original Message-----
>>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May 
>>> 01, 2006 8:13 AM
>>> To: hadoop-dev@lucene.apache.org
>>> Subject: Re: C API for Hadoop DFS
>>>
>>>
>>> I'm curious about error handling.
>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>
>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and 
>>> dfsSetWorkingDirectory each have a return value to indicate success 
>>> or failure?  Or are they assumed to never fail?
>>>
>>> - David
>>>
>>>
>>>
>>>
>>>
>>>  
>>>
>>
>
>
>



From MAILER-DAEMON Wed May  3 06:26:35 2006
Return-Path: 
 <hadoop-dev-return-1211-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24274 invoked from network); 3 May 2006 06:26:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 06:26:35 -0000
Received: (qmail 21164 invoked by uid 500); 3 May 2006 06:26:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 21042 invoked by uid 500); 3 May 2006 06:26:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 21031 invoked by uid 99); 3 May 2006 06:26:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 23:26:34 -0700
X-ASF-Spam-Status: No, hits=0.6 required=10.0
	tests=NO_REAL_NAME
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [213.59.116.41] (HELO orbita1.ru) (213.59.116.41)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 02 May 2006 23:26:31 -0700
Received: from anton.ipt ([192.168.0.177] helo=anton)
	by orbita1.ru with esmtpa (Exim 4.42)
	id 1FbAoK-0000I0-O2
	for hadoop-dev@lucene.apache.org; Wed, 03 May 2006 10:26:08 +0400
From: <anton@orbita1.ru>
To: <hadoop-dev@lucene.apache.org>
Subject: Global counter
Date: Wed, 3 May 2006 10:25:35 +0400
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook, Build 11.0.5510
In-Reply-To: <029601c66ab3$615b2010$2201a8c0@ddaslaptop>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2800.1106
Thread-Index: AcZqF5CiUdvuDqeSS6e9JSqgkQgKzQAmUTTwAPHnMcA=
X-Virus-Checked: Checked by ClamAV on apache.org
Message-Id: <20060503062631.97BD910FB00A@asf.osuosl.org>
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

In Google MapRed docs we have read about global counters. Please, tell us if
this feature is implemented in Hadoop.  



From MAILER-DAEMON Wed May  3 17:25:39 2006
Return-Path: 
 <hadoop-dev-return-1212-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21425 invoked from network); 3 May 2006 17:25:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 17:25:39 -0000
Received: (qmail 91350 invoked by uid 500); 3 May 2006 17:25:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91184 invoked by uid 500); 3 May 2006 17:25:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91174 invoked by uid 99); 3 May 2006 17:25:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 10:25:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 10:25:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 01124410006
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 17:24:47 +0000 (GMT)
Message-ID: <4327935.1146677087001.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 17:24:47 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-192) Trivial JRE 1.5 versus 1.4 bug
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Trivial JRE 1.5 versus 1.4 bug
------------------------------

         Key: HADOOP-192
         URL: http://issues.apache.org/jira/browse/HADOOP-192
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2    
    Reporter: David Bowen
    Priority: Blocker


Long.valueOf(long) is in 1.5 but not in 1.4.x.  Use new Long(long) instead.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 17:27:26 2006
Return-Path: 
 <hadoop-dev-return-1213-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 22616 invoked from network); 3 May 2006 17:27:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 17:27:26 -0000
Received: (qmail 97658 invoked by uid 500); 3 May 2006 17:27:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97641 invoked by uid 500); 3 May 2006 17:27:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97630 invoked by uid 99); 3 May 2006 17:27:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 10:27:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 10:27:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A4F15410005
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 17:26:47 +0000 (GMT)
Message-ID: <8079634.1146677207673.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 17:26:47 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-192) Trivial JRE 1.5 versus 1.4 bug
In-Reply-To: <4327935.1146677087001.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-192?page=all ]

David Bowen updated HADOOP-192:
-------------------------------

    Attachment: valueOfBug.patch

Here's the fix.

> Trivial JRE 1.5 versus 1.4 bug
> ------------------------------
>
>          Key: HADOOP-192
>          URL: http://issues.apache.org/jira/browse/HADOOP-192
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: David Bowen
>     Priority: Blocker
>  Attachments: valueOfBug.patch
>
> Long.valueOf(long) is in 1.5 but not in 1.4.x.  Use new Long(long) instead.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 20:12:21 2006
Return-Path: 
 <hadoop-dev-return-1214-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31253 invoked from network); 3 May 2006 20:12:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 20:12:21 -0000
Received: (qmail 78390 invoked by uid 500); 3 May 2006 20:12:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78349 invoked by uid 500); 3 May 2006 20:12:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78339 invoked by uid 99); 3 May 2006 20:12:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:12:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:12:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A8A5F410005
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 20:11:46 +0000 (GMT)
Message-ID: <30045704.1146687106679.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 20:11:46 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-189?page=all ]

Doug Cutting updated HADOOP-189:
--------------------------------

    Attachment: local-jar2.patch

Here's a patch I've actually tested!

> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>  Attachments: local-jar.patch, local-jar2.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 20:21:12 2006
Return-Path: 
 <hadoop-dev-return-1215-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37070 invoked from network); 3 May 2006 20:21:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 20:21:12 -0000
Received: (qmail 82296 invoked by uid 500); 3 May 2006 20:14:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81967 invoked by uid 500); 3 May 2006 20:14:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81805 invoked by uid 99); 3 May 2006 20:14:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:14:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:14:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 52C94410007
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 20:13:50 +0000 (GMT)
Message-ID: <5230097.1146687230336.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 20:13:50 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-189?page=all ]

Doug Cutting updated HADOOP-189:
--------------------------------

    Attachment:     (was: local-jar.patch)

> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>  Attachments: local-jar2.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 20:38:21 2006
Return-Path: 
 <hadoop-dev-return-1216-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48665 invoked from network); 3 May 2006 20:38:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 20:38:21 -0000
Received: (qmail 38712 invoked by uid 500); 3 May 2006 20:38:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38695 invoked by uid 500); 3 May 2006 20:38:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38686 invoked by uid 99); 3 May 2006 20:38:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:38:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:38:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B481771428F
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 20:37:46 +0000 (GMT)
Message-ID: <11161856.1146688666721.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 20:37:46 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-189?page=comments#action_12377624 ] 

stack@archive.org commented on HADOOP-189:
------------------------------------------

Ok.  This patch works really well (Looks to be spin on unbundling before invocation of Main-Class).  Thanks for all your work on this.

> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>  Attachments: local-jar2.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 20:50:21 2006
Return-Path: 
 <hadoop-dev-return-1217-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56699 invoked from network); 3 May 2006 20:50:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 20:50:21 -0000
Received: (qmail 65157 invoked by uid 500); 3 May 2006 20:50:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65137 invoked by uid 500); 3 May 2006 20:50:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65128 invoked by uid 99); 3 May 2006 20:50:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:50:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:50:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DA72D71428F
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 20:49:46 +0000 (GMT)
Message-ID: <8471048.1146689386865.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 20:49:46 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-189?page=all ]
     
Doug Cutting resolved HADOOP-189:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.

> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>      Fix For: 0.2
>  Attachments: local-jar2.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 20:52:25 2006
Return-Path: 
 <hadoop-dev-return-1218-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58062 invoked from network); 3 May 2006 20:52:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 20:52:25 -0000
Received: (qmail 70213 invoked by uid 500); 3 May 2006 20:52:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70161 invoked by uid 500); 3 May 2006 20:52:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70111 invoked by uid 99); 3 May 2006 20:52:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:52:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 13:52:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E66C971428D
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 20:51:47 +0000 (GMT)
Message-ID: <23896565.1146689507941.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 20:51:47 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-192) Trivial JRE 1.5 versus 1.4 bug
In-Reply-To: <4327935.1146677087001.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-192?page=all ]
     
Doug Cutting resolved HADOOP-192:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, David!

> Trivial JRE 1.5 versus 1.4 bug
> ------------------------------
>
>          Key: HADOOP-192
>          URL: http://issues.apache.org/jira/browse/HADOOP-192
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: David Bowen
>     Priority: Blocker
>      Fix For: 0.2
>  Attachments: valueOfBug.patch
>
> Long.valueOf(long) is in 1.5 but not in 1.4.x.  Use new Long(long) instead.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 21:02:31 2006
Return-Path: 
 <hadoop-dev-return-1219-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65559 invoked from network); 3 May 2006 21:02:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 21:02:31 -0000
Received: (qmail 93972 invoked by uid 500); 3 May 2006 21:02:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93911 invoked by uid 500); 3 May 2006 21:02:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93826 invoked by uid 99); 3 May 2006 21:02:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 14:02:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 14:02:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 296AA410007
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 21:01:49 +0000 (GMT)
Message-ID: <14254077.1146690109166.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 21:01:49 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-191?page=all ]
     
Doug Cutting resolved HADOOP-191:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  It looks great!  Thanks, Michel.

> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: streaming.2.patch, streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 21:06:09 2006
Return-Path: 
 <hadoop-dev-return-1220-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68276 invoked from network); 3 May 2006 21:06:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 21:06:09 -0000
Received: (qmail 98318 invoked by uid 500); 3 May 2006 21:06:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98291 invoked by uid 500); 3 May 2006 21:06:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98272 invoked by uid 99); 3 May 2006 21:06:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 14:06:08 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 14:06:08 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k43L5ZbL016634
	for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006 17:05:36 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k43L5jKg145234;
	Wed, 3 May 2006 17:05:45 -0400
Message-ID: <44591B28.7000209@apache.org>
Date: Wed, 03 May 2006 14:05:44 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: 0.2 release preparations
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I'm preparing to make the Hadoop 0.2 release.  If there's anything 
anyone expects to be in this release that's not yet committed, please 
speak up soon.

Doug

From MAILER-DAEMON Wed May  3 21:14:21 2006
Return-Path: 
 <hadoop-dev-return-1221-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72012 invoked from network); 3 May 2006 21:14:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 21:14:21 -0000
Received: (qmail 15142 invoked by uid 500); 3 May 2006 21:14:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15019 invoked by uid 500); 3 May 2006 21:14:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15010 invoked by uid 99); 3 May 2006 21:14:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 14:14:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 14:14:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A1CA5410006
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 21:13:46 +0000 (GMT)
Message-ID: <3839294.1146690826660.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 21:13:46 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-153) skip records that throw exceptions
In-Reply-To: <25993970.1145554865659.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-153?page=all ]

Doug Cutting updated HADOOP-153:
--------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> skip records that throw exceptions
> ----------------------------------
>
>          Key: HADOOP-153
>          URL: http://issues.apache.org/jira/browse/HADOOP-153
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.3

>
> MapReduce should skip records that throw exceptions.
> If the exception is thrown under RecordReader.next() then RecordReader implementations should automatically skip to the start of a subsequent record.
> Exceptions in map and reduce implementations can simply be logged, unless they happen under RecordWriter.write().  Cancelling partial output could be hard.  So such output errors will still result in task failure.
> This behaviour should be optional, but enabled by default.  A count of errors per task and job should be maintained and displayed in the web ui.  Perhaps if some percentage of records (>50%?) result in exceptions then the task should fail.  This would stop jobs early that are misconfigured or have buggy code.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 22:23:58 2006
Return-Path: 
 <hadoop-dev-return-1222-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10997 invoked from network); 3 May 2006 22:23:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 22:23:58 -0000
Received: (qmail 42424 invoked by uid 500); 3 May 2006 22:23:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42319 invoked by uid 500); 3 May 2006 22:23:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42271 invoked by uid 99); 3 May 2006 22:23:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 15:23:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 15:23:53 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 39BBF41000D
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 22:23:20 +0000 (GMT)
Message-ID: <8657357.1146695000232.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 22:23:20 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-65) add a record I/O framework to hadoop
In-Reply-To: <554934043.1141686841971.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-65?page=all ]

Milind Bhandarkar updated HADOOP-65:
------------------------------------

    Attachment: HadoopRecordIO.patch

I have attached a patch for Hadoop record I/O framework. It contains a translator for generating Java or C++ code from the record definitions, and a Java and C++ runtime library for serializing and deserializing records in binary, CSV, and XML formats. Generated Java code for records implements the WritableComparable interface, so these records could be used as keys and values for the Hadooop map-reduce framework. See the package.html file in org.apache.hadoop.record for full description.

> add a record I/O framework to hadoop
> ------------------------------------
>
>          Key: HADOOP-65
>          URL: http://issues.apache.org/jira/browse/HADOOP-65
>      Project: Hadoop
>         Type: New Feature

>   Components: io, ipc
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: HadoopRecordIO.patch
>
> Hadoop could benefit greatly from a simple record I/O framework that enables the specification of simple record types and enables the generation of code for serialization/deserialization in multiple target languages. The framework would handle a small well understood set of primitive types and simple compositions of these (structs, vectors, maps) . It would be possible to leverage this framework to express I/O in MapReduce computations and to use this as the basis for Hadoops RPC implementation. This would make interfacing with code in languages other than Java much easier.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 22:27:51 2006
Return-Path: 
 <hadoop-dev-return-1224-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12230 invoked from network); 3 May 2006 22:27:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 22:27:51 -0000
Received: (qmail 45387 invoked by uid 500); 3 May 2006 22:27:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 45266 invoked by uid 500); 3 May 2006 22:27:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 45257 invoked by uid 99); 3 May 2006 22:27:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 15:27:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 15:27:50 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4696D714292
	for <hadoop-dev@lucene.apache.org>; Wed,  3 May 2006 22:27:17 +0000 (GMT)
Message-ID: <19786841.1146695237259.JavaMail.jira@brutus>
Date: Wed, 3 May 2006 22:27:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Reopened: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-189?page=all ]
     
Doug Cutting reopened HADOOP-189:
---------------------------------

     Assign To: Doug Cutting

I just reverted this, since it broke distributed operation.

> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: local-jar2.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May  3 22:26:45 2006
Return-Path: 
 <hadoop-dev-return-1223-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11793 invoked from network); 3 May 2006 22:26:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 22:26:45 -0000
Received: (qmail 44408 invoked by uid 500); 3 May 2006 22:26:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44287 invoked by uid 500); 3 May 2006 22:26:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44278 invoked by uid 99); 3 May 2006 22:26:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 15:26:44 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 15:26:43 -0700
Received: from [66.228.175.147] (lordseason-mac.corp.yahoo.com
 [66.228.175.147])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k43MPXDD000106
	for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006 15:25:33 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=user-agent:date:subject:from:to:message-id:thread-topic:
	thread-index:in-reply-to:mime-version:content-type:content-transfer-encoding;
	b=HpgQ3EnkDm2Wj78kUWJioapRF4IERybHNEns2T5qxho7HO96ri+KGDbOkMpyZsI+
User-Agent: Microsoft-Entourage/11.2.3.060209
Date: Wed, 03 May 2006 15:27:29 -0700
Subject: Re: 0.2 release preparations
From: Milind Bhandarkar <milindb@yahoo-inc.com>
To: "hadoop-dev@lucene.apache.org" <hadoop-dev@lucene.apache.org>
Message-ID: <C07E7C61.3910%milindb@yahoo-inc.com>
Thread-Topic: 0.2 release preparations
Thread-Index: AcZvAMMRAX8dD9r0EdqH9gARJH2NCg==
In-Reply-To: <44591B28.7000209@apache.org>
Mime-version: 1.0
Content-type: text/plain;
	charset="US-ASCII"
Content-transfer-encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug,

I have attached the record I/O patch for hadoop-65. The bug mentions fix
version to be 0.2, so please consider it for committing.

Thanks,

Milind


On 5/3/06 2:05 PM, "Doug Cutting" <cutting@apache.org> wrote:

> I'm preparing to make the Hadoop 0.2 release.  If there's anything
> anyone expects to be in this release that's not yet committed, please
> speak up soon.
> 
> Doug
> 
> 

--
Milind Bhandarkar
408-349-2136
(milindb@yahoo-inc.com)



From MAILER-DAEMON Wed May  3 23:16:59 2006
Return-Path: 
 <hadoop-dev-return-1225-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43858 invoked from network); 3 May 2006 23:16:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 May 2006 23:16:59 -0000
Received: (qmail 18303 invoked by uid 500); 3 May 2006 23:16:59 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18281 invoked by uid 500); 3 May 2006 23:16:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18272 invoked by uid 99); 3 May 2006 23:16:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 16:16:58 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 16:16:57 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k43NFYMo014659
	for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006 16:15:34 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=OZI4c6oMDY6fQBKcNmsOcahjj0V56MhnUMiBNZGS8YFQUx9QizneJ0Ki3G9SCVpR
Message-ID: <44593996.2040400@yahoo-inc.com>
Date: Wed, 03 May 2006 16:15:34 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: 0.2 release preparations
References: <44591B28.7000209@apache.org>
In-Reply-To: <44591B28.7000209@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug,

I'm planning to submit updated benchmark test by the end of the day.
Please do not release before that.
I'm adding comments.

--Konst

Doug Cutting wrote:

> I'm preparing to make the Hadoop 0.2 release.  If there's anything 
> anyone expects to be in this release that's not yet committed, please 
> speak up soon.
>
> Doug
>
>
>


From MAILER-DAEMON Thu May  4 00:14:57 2006
Return-Path: 
 <hadoop-dev-return-1226-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66719 invoked from network); 4 May 2006 00:14:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 00:14:57 -0000
Received: (qmail 78071 invoked by uid 500); 4 May 2006 00:14:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77975 invoked by uid 500); 4 May 2006 00:14:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77938 invoked by uid 99); 4 May 2006 00:14:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 17:14:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 17:14:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0A003714292
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 00:14:18 +0000 (GMT)
Message-ID: <28136682.1146701658038.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 00:14:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-189) Add job jar lib, classes, etc. to
 CLASSPATH when in standalone mode
In-Reply-To: <26136403.1146591886342.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-189?page=all ]
     
Doug Cutting resolved HADOOP-189:
---------------------------------

    Resolution: Fixed

Okay, this time it works in both standalone and distributed modes.

> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
> -------------------------------------------------------------------
>
>          Key: HADOOP-189
>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: stack@archive.org
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: local-jar2.patch
>
> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 01:01:51 2006
Return-Path: 
 <hadoop-dev-return-1227-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76153 invoked from network); 4 May 2006 01:01:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 01:01:51 -0000
Received: (qmail 5524 invoked by uid 500); 4 May 2006 01:01:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5503 invoked by uid 500); 4 May 2006 01:01:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5489 invoked by uid 99); 4 May 2006 01:01:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:01:44 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:01:43 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 98EE341000A
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 00:40:17 +0000 (GMT)
Message-ID: <32477117.1146703217623.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 00:40:17 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-184) hadoop nightly build and regression
 test on a cluster
In-Reply-To: <10194334.1146519586768.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-184?page=all ]

Mahadev konar updated HADOOP-184:
---------------------------------

    Attachment: build.patch

My patch broke ant package.. It did not do a compile-test before. It does it now. The hadoop-test.jar is made available with the package now.

> hadoop nightly build and regression test on a cluster
> -----------------------------------------------------
>
>          Key: HADOOP-184
>          URL: http://issues.apache.org/jira/browse/HADOOP-184
>      Project: Hadoop
>         Type: Test

>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: build.patch, nightly_build.patch, nightly_build.patch
>
> create a jar file for the tests and have  filesystem and mapreduce tests on the cluster

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 01:47:52 2006
Return-Path: 
 <hadoop-dev-return-1228-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97310 invoked from network); 4 May 2006 01:47:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 01:47:52 -0000
Received: (qmail 21181 invoked by uid 500); 4 May 2006 01:47:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20998 invoked by uid 500); 4 May 2006 01:47:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20902 invoked by uid 99); 4 May 2006 01:47:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:47:51 -0700
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:47:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A1F62410008
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 01:47:17 +0000 (GMT)
Message-ID: <28567444.1146707237660.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 01:47:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-184) hadoop nightly build and regression
 test on a cluster
In-Reply-To: <10194334.1146519586768.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-184?page=comments#action_12377676 ] 

Doug Cutting commented on HADOOP-184:
-------------------------------------

Thanks.  I committed this.

> hadoop nightly build and regression test on a cluster
> -----------------------------------------------------
>
>          Key: HADOOP-184
>          URL: http://issues.apache.org/jira/browse/HADOOP-184
>      Project: Hadoop
>         Type: Test

>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: build.patch, nightly_build.patch, nightly_build.patch
>
> create a jar file for the tests and have  filesystem and mapreduce tests on the cluster

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 01:49:53 2006
Return-Path: 
 <hadoop-dev-return-1229-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97953 invoked from network); 4 May 2006 01:49:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 01:49:53 -0000
Received: (qmail 46522 invoked by uid 500); 4 May 2006 01:49:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46492 invoked by uid 500); 4 May 2006 01:49:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46444 invoked by uid 99); 4 May 2006 01:49:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:49:51 -0700
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:49:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 18997410008
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 01:49:18 +0000 (GMT)
Message-ID: <205405.1146707358097.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 01:49:18 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-96?page=all ]

Hairong Kuang updated HADOOP-96:
--------------------------------

    Attachment: namenodeLogging.patch

Here is patch that includes the changes that Doug suggested. I tested it on a RH linux machine, it worked fine. But it seems that it has a problem on cygwin in that File.exists() returns true for a nonexistent directory. Doug, could you test it? If I am able to figure out what went wrong on cygwin, I will resubmit the patch tomorrow.

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch, namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 01:53:16 2006
Return-Path: 
 <hadoop-dev-return-1230-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99170 invoked from network); 4 May 2006 01:53:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 01:53:16 -0000
Received: (qmail 52651 invoked by uid 500); 4 May 2006 01:53:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52617 invoked by uid 500); 4 May 2006 01:53:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52600 invoked by uid 99); 4 May 2006 01:53:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:53:15 -0700
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [207.241.227.188] (HELO mail.archive.org) (207.241.227.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:53:14 -0700
Received: from localhost (localhost [127.0.0.1])
	by mail.archive.org (Postfix) with ESMTP id 114FF141063EC;
	Wed,  3 May 2006 18:52:54 -0700 (PDT)
Received: from mail.archive.org ([127.0.0.1])
	by localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)
	with LMTP id 10907-05-7; Wed, 3 May 2006 18:52:53 -0700 (PDT)
Received: from [192.168.0.110] (adsl-71-130-102-78.dsl.pltn13.pacbell.net
 [71.130.102.78])
	by mail.archive.org (Postfix) with ESMTP id 3893B140FF92A;
	Wed,  3 May 2006 18:52:53 -0700 (PDT)
Message-ID: <44595E62.3070409@archive.org>
Date: Wed, 03 May 2006 18:52:34 -0700
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (X11; U; Linux i686 (x86_64); en-US;
 rv:1.8.0.1) Gecko/20060130 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: FYI: JVM1.6.0 issue: Re: [jira] Updated: (HADOOP-189) Add job jar
 lib, classes, etc. to CLASSPATH when in standalone mode
References: <30045704.1146687106679.JavaMail.jira@brutus>
In-Reply-To: <30045704.1146687106679.JavaMail.jira@brutus>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: Debian amavisd-new at archive.org
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

FYI, the final commit on HADOOP-189 was failing for me in really weird 
ways.  Compiling hadoop with 1.6.0beta2 looks to be the culprit.

Just starting up daemons in pseudo-distributed mode, usually NameNode 
and TaskTracker would fail with exceptions like the following:

060503 180738 12 Client connection to 127.0.0.1:9000 caught: 
java.lang.RuntimeException: java.lang.ClassNotFoundException: 
[Lorg.apache.hadoop.dfs.Block;
java.lang.RuntimeException: java.lang.ClassNotFoundException: 
[Lorg.apache.hadoop.dfs.Block;
    at 
org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:177)
    at 
org.apache.hadoop.io.ObjectWritable.readFields(ObjectWritable.java:60)
    at org.apache.hadoop.ipc.Client$Connection.run(Client.java:170)


Or...

060503 175932 Client connection to 127.0.0.1:9001 caught: 
java.lang.RuntimeException: java.lang.ClassNotFoundException: 
[Ljava.lang.String;
java.lang.RuntimeException: java.lang.ClassNotFoundException: 
[Ljava.lang.String;
    at 
org.apache.hadoop.io.ObjectWritable$NullInstance.readFields(ObjectWritable.java:94)
    at 
org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:230)
    at 
org.apache.hadoop.io.ObjectWritable.readFields(ObjectWritable.java:60)
    at org.apache.hadoop.ipc.Client$Connection.run(Client.java:170)

I'd compiled hadoop with beta2 1.6.0:

[bregeon 1506] hadoop > /usr/local/jdk1.6.0/bin/java -version
java version "1.6.0-beta2"
Java(TM) SE Runtime Environment (build 1.6.0-beta2-b76)
Java HotSpot(TM) 64-Bit Server VM (build 1.6.0-beta2-b76, mixed mode)


After recompiling with 1.5.0_06, the above issues went away.

St.Ack





Doug Cutting (JIRA) wrote:
>      [ http://issues.apache.org/jira/browse/HADOOP-189?page=all ]
>
> Doug Cutting updated HADOOP-189:
> --------------------------------
>
>     Attachment: local-jar2.patch
>
> Here's a patch I've actually tested!
>
>   
>> Add job jar lib, classes, etc. to CLASSPATH when in standalone mode
>> -------------------------------------------------------------------
>>
>>          Key: HADOOP-189
>>          URL: http://issues.apache.org/jira/browse/HADOOP-189
>>      Project: Hadoop
>>         Type: New Feature
>>     
>
>   
>>   Components: mapred
>>     Reporter: stack@archive.org
>>  Attachments: local-jar.patch, local-jar2.patch
>>
>> Currently, in standalone mode,  hadoop is unable to launch other than the most basic of job jars where 'basic' is a job jar with nought but class files at top level of the jar with Main-Class pointing at entry point.  If the job jar has dependencies on jars under the job jar lib or there are job jar plugins in the classes dir, etc.,  these dependencies are not loaded and the job fails launch.
>>     
>
>   


From MAILER-DAEMON Thu May  4 01:59:51 2006
Return-Path: 
 <hadoop-dev-return-1231-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1297 invoked from network); 4 May 2006 01:59:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 01:59:51 -0000
Received: (qmail 58402 invoked by uid 500); 4 May 2006 01:59:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58380 invoked by uid 500); 4 May 2006 01:59:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58370 invoked by uid 99); 4 May 2006 01:59:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:59:50 -0700
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:59:50 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 042CD410008
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 01:59:17 +0000 (GMT)
Message-ID: <25075847.1146707957014.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 01:59:17 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-193) DFS i/o benchmark.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DFS i/o benchmark.
------------------

         Key: HADOOP-193
         URL: http://issues.apache.org/jira/browse/HADOOP-193
     Project: Hadoop
        Type: Test

  Components: fs  
    Reporter: Konstantin Shvachko
 Attachments: IOBenchmark.patch

DFS i/o benchmark is a map-reduce based test that measures performance of the cluster for reads and writes.
This is an evolved version of HADOOP-72, and HADOOP-95 test.

This test writes into or reads from a specified number of files.
File size is specified as a parameter to the test.
Each file is processed in a separate map task.
The unique reducer then collects stats.
Finally, the following information is displayed

# read or write test
# date and time the test finished
# number of files processed
# total number of bytes processed
# throughput in mb/sec (total number of bytes / sum of processing times)
# average i/o rate in mb/sec per file
# standard i/o rate deviation

I  included the test into the AllTestDriver.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 01:59:52 2006
Return-Path: 
 <hadoop-dev-return-1232-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1329 invoked from network); 4 May 2006 01:59:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 01:59:52 -0000
Received: (qmail 58646 invoked by uid 500); 4 May 2006 01:59:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58520 invoked by uid 500); 4 May 2006 01:59:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58511 invoked by uid 99); 4 May 2006 01:59:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:59:51 -0700
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 18:59:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CCD8471428E
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 01:59:17 +0000 (GMT)
Message-ID: <25339558.1146707957836.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 01:59:17 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-193) DFS i/o benchmark.
In-Reply-To: <25075847.1146707957014.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-193?page=all ]

Konstantin Shvachko updated HADOOP-193:
---------------------------------------

    Attachment: IOBenchmark.patch

> DFS i/o benchmark.
> ------------------
>
>          Key: HADOOP-193
>          URL: http://issues.apache.org/jira/browse/HADOOP-193
>      Project: Hadoop
>         Type: Test

>   Components: fs
>     Reporter: Konstantin Shvachko
>  Attachments: IOBenchmark.patch
>
> DFS i/o benchmark is a map-reduce based test that measures performance of the cluster for reads and writes.
> This is an evolved version of HADOOP-72, and HADOOP-95 test.
> This test writes into or reads from a specified number of files.
> File size is specified as a parameter to the test.
> Each file is processed in a separate map task.
> The unique reducer then collects stats.
> Finally, the following information is displayed
> # read or write test
> # date and time the test finished
> # number of files processed
> # total number of bytes processed
> # throughput in mb/sec (total number of bytes / sum of processing times)
> # average i/o rate in mb/sec per file
> # standard i/o rate deviation
> I  included the test into the AllTestDriver.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 02:04:51 2006
Return-Path: 
 <hadoop-dev-return-1233-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4302 invoked from network); 4 May 2006 02:04:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 02:04:51 -0000
Received: (qmail 65605 invoked by uid 500); 4 May 2006 02:04:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65585 invoked by uid 500); 4 May 2006 02:04:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65576 invoked by uid 99); 4 May 2006 02:04:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 19:04:51 -0700
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 19:04:50 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 44DB071428E
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 02:04:17 +0000 (GMT)
Message-ID: <18029407.1146708257240.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 02:04:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-65) add a record I/O framework to hadoop
In-Reply-To: <554934043.1141686841971.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-65?page=all ]
     
Doug Cutting resolved HADOOP-65:
--------------------------------

    Resolution: Fixed

I have committed this.  It looks great!  Thanks, Milind!

> add a record I/O framework to hadoop
> ------------------------------------
>
>          Key: HADOOP-65
>          URL: http://issues.apache.org/jira/browse/HADOOP-65
>      Project: Hadoop
>         Type: New Feature

>   Components: io, ipc
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: HadoopRecordIO.patch
>
> Hadoop could benefit greatly from a simple record I/O framework that enables the specification of simple record types and enables the generation of code for serialization/deserialization in multiple target languages. The framework would handle a small well understood set of primitive types and simple compositions of these (structs, vectors, maps) . It would be possible to leverage this framework to express I/O in MapReduce computations and to use this as the basis for Hadoops RPC implementation. This would make interfacing with code in languages other than Java much easier.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 02:12:56 2006
Return-Path: 
 <hadoop-dev-return-1234-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6939 invoked from network); 4 May 2006 02:12:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 02:12:56 -0000
Received: (qmail 75009 invoked by uid 500); 4 May 2006 02:12:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74770 invoked by uid 500); 4 May 2006 02:12:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74759 invoked by uid 99); 4 May 2006 02:12:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 19:12:52 -0700
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 19:12:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 52DF141000D
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 02:12:18 +0000 (GMT)
Message-ID: <11311725.1146708738336.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 02:12:18 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-194) Distributed checkup of the file system
 consistency.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Distributed checkup of the file system consistency.
---------------------------------------------------

         Key: HADOOP-194
         URL: http://issues.apache.org/jira/browse/HADOOP-194
     Project: Hadoop
        Type: Test

    Reporter: Konstantin Shvachko


This is a map-reduce based test that checks consistency of the file system
by  reading all blocks of all files, and detecting which of them are missing or corrupted.
See HADOOP-95 and HADOOP-101 for related discussions.

This could be an alternative to the sequential checkup in dfsck.
It would be nice to integrate distributed checkup with dfsck, but I don't yet see how.

This test reuses classes defined in HADOOP-193.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 02:14:52 2006
Return-Path: 
 <hadoop-dev-return-1235-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7516 invoked from network); 4 May 2006 02:14:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 02:14:52 -0000
Received: (qmail 76631 invoked by uid 500); 4 May 2006 02:14:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76508 invoked by uid 500); 4 May 2006 02:14:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76499 invoked by uid 99); 4 May 2006 02:14:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 19:14:51 -0700
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 19:14:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9142E410008
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 02:14:17 +0000 (GMT)
Message-ID: <18118340.1146708857592.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 02:14:17 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-194) Distributed checkup of the file system
 consistency.
In-Reply-To: <11311725.1146708738336.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-194?page=all ]

Konstantin Shvachko updated HADOOP-194:
---------------------------------------

    Attachment: FSCheck.patch

Should be applied after HADOOP-193.

> Distributed checkup of the file system consistency.
> ---------------------------------------------------
>
>          Key: HADOOP-194
>          URL: http://issues.apache.org/jira/browse/HADOOP-194
>      Project: Hadoop
>         Type: Test

>     Reporter: Konstantin Shvachko
>  Attachments: FSCheck.patch
>
> This is a map-reduce based test that checks consistency of the file system
> by  reading all blocks of all files, and detecting which of them are missing or corrupted.
> See HADOOP-95 and HADOOP-101 for related discussions.
> This could be an alternative to the sequential checkup in dfsck.
> It would be nice to integrate distributed checkup with dfsck, but I don't yet see how.
> This test reuses classes defined in HADOOP-193.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 03:52:53 2006
Return-Path: 
 <hadoop-dev-return-1236-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52895 invoked from network); 4 May 2006 03:52:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 03:52:53 -0000
Received: (qmail 66420 invoked by uid 500); 4 May 2006 03:52:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66358 invoked by uid 500); 4 May 2006 03:52:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66307 invoked by uid 99); 4 May 2006 03:52:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 20:52:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 20:52:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0B35541000A
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 03:52:18 +0000 (GMT)
Message-ID: <26528189.1146714738043.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 03:52:18 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-182) lost task trackers should not update
 status of completed jobs
In-Reply-To: <18534471.1146509326381.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-182?page=comments#action_12377692 ] 

Owen O'Malley commented on HADOOP-182:
--------------------------------------

Note that marking completed reduces of running jobs as failed is _really_ bad because if the file already exists, I believe the tip will fail, thereby killing the job.

> lost task trackers should not update status of completed jobs
> -------------------------------------------------------------
>
>          Key: HADOOP-182
>          URL: http://issues.apache.org/jira/browse/HADOOP-182
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.3

>
> When a Task Tracker is lost (by not sending a heartbeat for 10 minutes), the JobTracker marks the tasks that were active on that node as failed. There are two issues:
>    1. No task from a completed or failed job should be modified.
>    2. No reduces should be marked as failed, since their output is in dfs and therefore not only on the dead node.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 04:06:55 2006
Return-Path: 
 <hadoop-dev-return-1237-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45461 invoked from network); 4 May 2006 04:06:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 04:06:55 -0000
Received: (qmail 86104 invoked by uid 500); 4 May 2006 04:06:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86079 invoked by uid 500); 4 May 2006 04:06:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86069 invoked by uid 99); 4 May 2006 04:06:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:06:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:06:53 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E5CAD41000B
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 04:06:19 +0000 (GMT)
Message-ID: <3417461.1146715579938.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 04:06:19 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-115?page=all ]

Owen O'Malley reassigned HADOOP-115:
------------------------------------

    Assign To: Runping Qi

Runping is going to take a look at fixing the patch.

> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Runping Qi
>     Assignee: Runping Qi
>  Attachments: hadoop-115_ReduceTask.patch, hadoop-115_tk.patch
>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 04:12:56 2006
Return-Path: 
 <hadoop-dev-return-1238-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56165 invoked from network); 4 May 2006 04:12:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 04:12:56 -0000
Received: (qmail 91861 invoked by uid 500); 4 May 2006 04:12:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91388 invoked by uid 500); 4 May 2006 04:12:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91358 invoked by uid 99); 4 May 2006 04:12:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:12:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:12:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 807A641000C
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 04:12:18 +0000 (GMT)
Message-ID: <27713714.1146715938523.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 04:12:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-65) add a record I/O framework to hadoop
In-Reply-To: <554934043.1141686841971.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-65?page=comments#action_12377702 ] 

Doug Cutting commented on HADOOP-65:
------------------------------------

Looking a bit more closely, I see that some of the packages and classes are missing javadoc.  Can you please supply an additional patch which adds this?  In many cases, javadoc comments are only needed on base classes and interfaces (e.g., JType, InputArchive, OutputArchive) as they will automatically propagate to subclasses & implementations.  Also, the JavaCC-generated code will in many places lack javadoc, but a package.html explaining that the package contains only generated code would be useful.

> add a record I/O framework to hadoop
> ------------------------------------
>
>          Key: HADOOP-65
>          URL: http://issues.apache.org/jira/browse/HADOOP-65
>      Project: Hadoop
>         Type: New Feature

>   Components: io, ipc
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: HadoopRecordIO.patch
>
> Hadoop could benefit greatly from a simple record I/O framework that enables the specification of simple record types and enables the generation of code for serialization/deserialization in multiple target languages. The framework would handle a small well understood set of primitive types and simple compositions of these (structs, vectors, maps) . It would be possible to leverage this framework to express I/O in MapReduce computations and to use this as the basis for Hadoops RPC implementation. This would make interfacing with code in languages other than Java much easier.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 04:16:28 2006
Return-Path: 
 <hadoop-dev-return-1239-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58960 invoked from network); 4 May 2006 04:16:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 04:16:28 -0000
Received: (qmail 96055 invoked by uid 500); 4 May 2006 04:16:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96034 invoked by uid 500); 4 May 2006 04:16:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96025 invoked by uid 99); 4 May 2006 04:16:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:16:28 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:16:27 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k444FPSI059483
	for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006 21:15:25 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=aJvkxJVe5crKOS22m+gv/zheHsf607iSXX9aASBEAMXbq+k7j6gaZukbEQWDAbA+
Received: from [10.0.1.2] ([10.72.76.229]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 3 May 2006 21:15:25 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <030e01c66e79$81b97130$2201a8c0@ddaslaptop>
References: <030e01c66e79$81b97130$2201a8c0@ddaslaptop>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <474C5E89-2C58-4669-B284-BCC75E7C46CD@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: C API for Hadoop DFS
Date: Wed, 3 May 2006 21:15:16 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 04 May 2006 04:15:25.0195 (UTC)
 FILETIME=[5E3FADB0:01C66F31]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I'd vote against errno, because I don't see why we need it.  Why not  
just return the error as a negative number?  Adding a global just  
complicates the code and introduces an opportunity for further error.

What am I missing?

On May 2, 2006, at 11:19 PM, Devaraj Das wrote:

> In our case, the components involved are the C API library, JNI  
> layer and
> Java APIs. In all these, we have control over errno. For example, if a
> particular C API uses a third party library function that might  
> return error
> and hence set errno, we know about it already. Depending on the  
> error, we
> take a decision whether to proceed further in the API  
> implementation code or
> return an error to the client invoking the API. This includes the  
> functions
> in the JNI library which the API implementation calls. In the Java  
> world, we
> deal with exceptions and don't bother about errno. So for example,  
> if a Java
> method, invoked through JNI from a C API, throws an exception, the  
> C API
> implementation will get the exception object and depending on that  
> the API
> implementation will set a meaningful errno and return a (-1) or  
> NULL to
> signify that an error occurred. As I said earlier, this includes  
> the case
> where the JNI function itself fails (for some reason like out-of- 
> memory or
> something).
> As an aside, the JNI layer doesn't generate errno-s.
>
> -----Original Message-----
> From: Konstantin Shvachko [mailto:shv@yahoo-inc.com]
> Sent: Wednesday, May 03, 2006 2:40 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: C API for Hadoop DFS
>
> Don't think errno is a particularly good idea for several reasons.
> It is not common to set errno codes.
> If a system library function uses errno, and we overwrite its value to
> return
> something dfs related, the library function behavior becomes  
> unpredictable.
> This could be hard to debug.
> We have a JNI layer between our C library and Java, which also might
> generate
> errno-s overwriting the values we were trying to bring back from Java.
>
> --Konstantin
>
> Doug Cutting wrote:
>
>> The spec says:
>>
>> /** All APIs set errno to meaningful values */
>>
>> So callers should always check errno after each call.  Whether  
>> this is
>> the best way to handle errors in C can be debated, but an error
>> mechanism was in fact specified.
>>
>> Doug
>>
>> Konstantin Shvachko wrote:
>>
>>> I think this a very important issue raised by David.
>>>
>>> IMO __ALL__ functions should return an integer value indicating
>>> success (=0) or failure (<0).
>>> Unless we want to use C style Exceptions, otherwise we won't be able
>>> to identify what went
>>> wrong if anything.
>>> NULL or bool is not enough in most cases, since we need to
>>> distinguish e.g. between
>>> timeout (when we retry) and "file not found" cases.
>>> The actual return objects should be passed as outputs parameters.
>>> E.g.
>>> dfsFS dfsConnect(char *host, tPort port);
>>> will become
>>> tCompletionCode dfsConnect(char *host, tPort port, dfsFS  
>>> fileSystem );
>>> where tCompletionCode could be integer for now. Or we can define a
>>> structure
>>> { int errCode; char *errDescription; }
>>> to return the actual error descriptions along with the error code.
>>>
>>> --Konstantin
>>>
>>> Devaraj Das wrote:
>>>
>>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>
>>>>
>>>>
>>>> Yes.
>>>>
>>>>
>>>>
>>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>> dfsSetWorkingDirectory each have a return value to indicate  
>>>>> success
>>>>> or failure?  Or are they assumed to never fail?
>>>>>
>>>>
>>>>
>>>> Yes these functions should have return values. I will update the  
>>>> API
>>>> spec.
>>>> Thanks for pointing this out.
>>>>
>>>> -----Original Message-----
>>>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May
>>>> 01, 2006 8:13 AM
>>>> To: hadoop-dev@lucene.apache.org
>>>> Subject: Re: C API for Hadoop DFS
>>>>
>>>>
>>>> I'm curious about error handling.
>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>
>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>> dfsSetWorkingDirectory each have a return value to indicate success
>>>> or failure?  Or are they assumed to never fail?
>>>>
>>>> - David
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>
>>
>>
>>
>
>


From MAILER-DAEMON Thu May  4 04:40:54 2006
Return-Path: 
 <hadoop-dev-return-1240-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82908 invoked from network); 4 May 2006 04:40:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 04:40:54 -0000
Received: (qmail 10709 invoked by uid 500); 4 May 2006 04:40:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10649 invoked by uid 500); 4 May 2006 04:40:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10628 invoked by uid 99); 4 May 2006 04:40:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:40:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:40:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 62722410009
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 04:40:18 +0000 (GMT)
Message-ID: <32129416.1146717618400.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 04:40:18 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-193) DFS i/o benchmark.
In-Reply-To: <25075847.1146707957014.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-193?page=all ]
     
Doug Cutting resolved HADOOP-193:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  Thanks, Konstantin.

> DFS i/o benchmark.
> ------------------
>
>          Key: HADOOP-193
>          URL: http://issues.apache.org/jira/browse/HADOOP-193
>      Project: Hadoop
>         Type: Test

>   Components: fs
>     Reporter: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: IOBenchmark.patch
>
> DFS i/o benchmark is a map-reduce based test that measures performance of the cluster for reads and writes.
> This is an evolved version of HADOOP-72, and HADOOP-95 test.
> This test writes into or reads from a specified number of files.
> File size is specified as a parameter to the test.
> Each file is processed in a separate map task.
> The unique reducer then collects stats.
> Finally, the following information is displayed
> # read or write test
> # date and time the test finished
> # number of files processed
> # total number of bytes processed
> # throughput in mb/sec (total number of bytes / sum of processing times)
> # average i/o rate in mb/sec per file
> # standard i/o rate deviation
> I  included the test into the AllTestDriver.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 04:40:55 2006
Return-Path: 
 <hadoop-dev-return-1241-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83059 invoked from network); 4 May 2006 04:40:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 04:40:55 -0000
Received: (qmail 11097 invoked by uid 500); 4 May 2006 04:40:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10974 invoked by uid 500); 4 May 2006 04:40:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10965 invoked by uid 99); 4 May 2006 04:40:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:40:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 21:40:53 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7C5D041000A
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 04:40:19 +0000 (GMT)
Message-ID: <2174123.1146717619506.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 04:40:19 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-194) Distributed checkup of the file
 system consistency.
In-Reply-To: <11311725.1146708738336.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-194?page=all ]
     
Doug Cutting resolved HADOOP-194:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed
      Assign To: Konstantin Shvachko

I just committed this.  Thanks, Konstantin.

> Distributed checkup of the file system consistency.
> ---------------------------------------------------
>
>          Key: HADOOP-194
>          URL: http://issues.apache.org/jira/browse/HADOOP-194
>      Project: Hadoop
>         Type: Test

>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2
>  Attachments: FSCheck.patch
>
> This is a map-reduce based test that checks consistency of the file system
> by  reading all blocks of all files, and detecting which of them are missing or corrupted.
> See HADOOP-95 and HADOOP-101 for related discussions.
> This could be an alternative to the sequential checkup in dfsck.
> It would be nice to integrate distributed checkup with dfsck, but I don't yet see how.
> This test reuses classes defined in HADOOP-193.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 05:31:05 2006
Return-Path: 
 <hadoop-dev-return-1242-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28093 invoked from network); 4 May 2006 05:31:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 05:31:05 -0000
Received: (qmail 62882 invoked by uid 500); 4 May 2006 05:31:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62814 invoked by uid 500); 4 May 2006 05:31:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62802 invoked by uid 99); 4 May 2006 05:31:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 22:31:00 -0700
X-ASF-Spam-Status: No, hits=1.6 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,MAILTO_TO_SPAM_ADDR
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.91] (HELO mailsrv.bangalore.corp.yahoo.com)
 (202.46.19.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 22:30:59 -0700
Received: from ddaslaptop (UNKNOWN-172-24-91-210.yahoo.com [172.24.91.210]
 (may be forged))
	by mailsrv.bangalore.corp.yahoo.com (8.13.6/8.13.4/pop-in) with ESMTP id
 k445UUVI019775
	for <hadoop-dev@lucene.apache.org>; Thu, 4 May 2006 11:00:30 +0530 (IST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=reply-to:from:to:subject:date:organization:message-id:
	mime-version:content-type:content-transfer-encoding:x-mailer:x-mimeole:
	thread-index:in-reply-to;
	b=sD4Xo4XDY5mjc9PIOmVIoptlXBLQ0ilJBtB8cwJxuTQOJGDcG/LhnBU/lHv6u+at
Reply-To: <ddas@yahoo-inc.com>
From: "Devaraj Das" <ddas@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: C API for Hadoop DFS
Date: Thu, 4 May 2006 11:01:41 +0530
Organization: Yahoo India
Message-ID: <037101c66f3c$05ebfaf0$2201a8c0@ddaslaptop>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZvMZWQ23uwst47RvOPeIC0TGhlhQACgp/w
In-Reply-To: <474C5E89-2C58-4669-B284-BCC75E7C46CD@yahoo-inc.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Returning error as a negative number works as well. We initially decided to
go with errno since it's a standard in most I/O centric APIs.

-----Original Message-----
From: Eric Baldeschwieler [mailto:eric14@yahoo-inc.com] 
Sent: Thursday, May 04, 2006 9:45 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS

I'd vote against errno, because I don't see why we need it.  Why not  
just return the error as a negative number?  Adding a global just  
complicates the code and introduces an opportunity for further error.

What am I missing?

On May 2, 2006, at 11:19 PM, Devaraj Das wrote:

> In our case, the components involved are the C API library, JNI  
> layer and
> Java APIs. In all these, we have control over errno. For example, if a
> particular C API uses a third party library function that might  
> return error
> and hence set errno, we know about it already. Depending on the  
> error, we
> take a decision whether to proceed further in the API  
> implementation code or
> return an error to the client invoking the API. This includes the  
> functions
> in the JNI library which the API implementation calls. In the Java  
> world, we
> deal with exceptions and don't bother about errno. So for example,  
> if a Java
> method, invoked through JNI from a C API, throws an exception, the  
> C API
> implementation will get the exception object and depending on that  
> the API
> implementation will set a meaningful errno and return a (-1) or  
> NULL to
> signify that an error occurred. As I said earlier, this includes  
> the case
> where the JNI function itself fails (for some reason like out-of- 
> memory or
> something).
> As an aside, the JNI layer doesn't generate errno-s.
>
> -----Original Message-----
> From: Konstantin Shvachko [mailto:shv@yahoo-inc.com]
> Sent: Wednesday, May 03, 2006 2:40 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: C API for Hadoop DFS
>
> Don't think errno is a particularly good idea for several reasons.
> It is not common to set errno codes.
> If a system library function uses errno, and we overwrite its value to
> return
> something dfs related, the library function behavior becomes  
> unpredictable.
> This could be hard to debug.
> We have a JNI layer between our C library and Java, which also might
> generate
> errno-s overwriting the values we were trying to bring back from Java.
>
> --Konstantin
>
> Doug Cutting wrote:
>
>> The spec says:
>>
>> /** All APIs set errno to meaningful values */
>>
>> So callers should always check errno after each call.  Whether  
>> this is
>> the best way to handle errors in C can be debated, but an error
>> mechanism was in fact specified.
>>
>> Doug
>>
>> Konstantin Shvachko wrote:
>>
>>> I think this a very important issue raised by David.
>>>
>>> IMO __ALL__ functions should return an integer value indicating
>>> success (=0) or failure (<0).
>>> Unless we want to use C style Exceptions, otherwise we won't be able
>>> to identify what went
>>> wrong if anything.
>>> NULL or bool is not enough in most cases, since we need to
>>> distinguish e.g. between
>>> timeout (when we retry) and "file not found" cases.
>>> The actual return objects should be passed as outputs parameters.
>>> E.g.
>>> dfsFS dfsConnect(char *host, tPort port);
>>> will become
>>> tCompletionCode dfsConnect(char *host, tPort port, dfsFS  
>>> fileSystem );
>>> where tCompletionCode could be integer for now. Or we can define a
>>> structure
>>> { int errCode; char *errDescription; }
>>> to return the actual error descriptions along with the error code.
>>>
>>> --Konstantin
>>>
>>> Devaraj Das wrote:
>>>
>>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>
>>>>
>>>>
>>>> Yes.
>>>>
>>>>
>>>>
>>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>> dfsSetWorkingDirectory each have a return value to indicate  
>>>>> success
>>>>> or failure?  Or are they assumed to never fail?
>>>>>
>>>>
>>>>
>>>> Yes these functions should have return values. I will update the  
>>>> API
>>>> spec.
>>>> Thanks for pointing this out.
>>>>
>>>> -----Original Message-----
>>>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May
>>>> 01, 2006 8:13 AM
>>>> To: hadoop-dev@lucene.apache.org
>>>> Subject: Re: C API for Hadoop DFS
>>>>
>>>>
>>>> I'm curious about error handling.
>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>
>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>> dfsSetWorkingDirectory each have a return value to indicate success
>>>> or failure?  Or are they assumed to never fail?
>>>>
>>>> - David
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>
>>
>>
>>
>
>



From MAILER-DAEMON Thu May  4 05:41:28 2006
Return-Path: 
 <hadoop-dev-return-1243-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34054 invoked from network); 4 May 2006 05:41:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 05:41:28 -0000
Received: (qmail 73983 invoked by uid 500); 4 May 2006 05:41:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73962 invoked by uid 500); 4 May 2006 05:41:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73952 invoked by uid 99); 4 May 2006 05:41:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 22:41:27 -0700
X-ASF-Spam-Status: No, hits=1.6 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,MAILTO_TO_SPAM_ADDR
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 22:41:26 -0700
Received: from explainfloorlx (snvvpn2-10-72-76-c154.corp.yahoo.com
 [10.72.76.154])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k445eR3Q057865;
	Wed, 3 May 2006 22:40:27 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=CpTtKLmj5Ccx6tnN/kTXQ/SlmZ1vbtaqmZH/v+9ZjYTEj4kngpLTK7xa3QUF0rCA
From: "Runping Qi" <runping@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>, <ddas@yahoo-inc.com>
Subject: RE: C API for Hadoop DFS
Date: Wed, 3 May 2006 22:40:27 -0700
Message-ID: <000001c66f3d$3f82e930$9a4c480a@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <037101c66f3c$05ebfaf0$2201a8c0@ddaslaptop>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
Thread-Index: AcZvMZWQ23uwst47RvOPeIC0TGhlhQACgp/wAABJKRA=
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


Errno approach proved to be problematic in multi-thread environments.
Returning an error code is better.

Runping


-----Original Message-----
From: Devaraj Das [mailto:ddas@yahoo-inc.com] 
Sent: Wednesday, May 03, 2006 10:32 PM
To: hadoop-dev@lucene.apache.org
Subject: RE: C API for Hadoop DFS

Returning error as a negative number works as well. We initially decided to
go with errno since it's a standard in most I/O centric APIs.

-----Original Message-----
From: Eric Baldeschwieler [mailto:eric14@yahoo-inc.com] 
Sent: Thursday, May 04, 2006 9:45 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS

I'd vote against errno, because I don't see why we need it.  Why not  
just return the error as a negative number?  Adding a global just  
complicates the code and introduces an opportunity for further error.

What am I missing?

On May 2, 2006, at 11:19 PM, Devaraj Das wrote:

> In our case, the components involved are the C API library, JNI  
> layer and
> Java APIs. In all these, we have control over errno. For example, if a
> particular C API uses a third party library function that might  
> return error
> and hence set errno, we know about it already. Depending on the  
> error, we
> take a decision whether to proceed further in the API  
> implementation code or
> return an error to the client invoking the API. This includes the  
> functions
> in the JNI library which the API implementation calls. In the Java  
> world, we
> deal with exceptions and don't bother about errno. So for example,  
> if a Java
> method, invoked through JNI from a C API, throws an exception, the  
> C API
> implementation will get the exception object and depending on that  
> the API
> implementation will set a meaningful errno and return a (-1) or  
> NULL to
> signify that an error occurred. As I said earlier, this includes  
> the case
> where the JNI function itself fails (for some reason like out-of- 
> memory or
> something).
> As an aside, the JNI layer doesn't generate errno-s.
>
> -----Original Message-----
> From: Konstantin Shvachko [mailto:shv@yahoo-inc.com]
> Sent: Wednesday, May 03, 2006 2:40 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: C API for Hadoop DFS
>
> Don't think errno is a particularly good idea for several reasons.
> It is not common to set errno codes.
> If a system library function uses errno, and we overwrite its value to
> return
> something dfs related, the library function behavior becomes  
> unpredictable.
> This could be hard to debug.
> We have a JNI layer between our C library and Java, which also might
> generate
> errno-s overwriting the values we were trying to bring back from Java.
>
> --Konstantin
>
> Doug Cutting wrote:
>
>> The spec says:
>>
>> /** All APIs set errno to meaningful values */
>>
>> So callers should always check errno after each call.  Whether  
>> this is
>> the best way to handle errors in C can be debated, but an error
>> mechanism was in fact specified.
>>
>> Doug
>>
>> Konstantin Shvachko wrote:
>>
>>> I think this a very important issue raised by David.
>>>
>>> IMO __ALL__ functions should return an integer value indicating
>>> success (=0) or failure (<0).
>>> Unless we want to use C style Exceptions, otherwise we won't be able
>>> to identify what went
>>> wrong if anything.
>>> NULL or bool is not enough in most cases, since we need to
>>> distinguish e.g. between
>>> timeout (when we retry) and "file not found" cases.
>>> The actual return objects should be passed as outputs parameters.
>>> E.g.
>>> dfsFS dfsConnect(char *host, tPort port);
>>> will become
>>> tCompletionCode dfsConnect(char *host, tPort port, dfsFS  
>>> fileSystem );
>>> where tCompletionCode could be integer for now. Or we can define a
>>> structure
>>> { int errCode; char *errDescription; }
>>> to return the actual error descriptions along with the error code.
>>>
>>> --Konstantin
>>>
>>> Devaraj Das wrote:
>>>
>>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>
>>>>
>>>>
>>>> Yes.
>>>>
>>>>
>>>>
>>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>> dfsSetWorkingDirectory each have a return value to indicate  
>>>>> success
>>>>> or failure?  Or are they assumed to never fail?
>>>>>
>>>>
>>>>
>>>> Yes these functions should have return values. I will update the  
>>>> API
>>>> spec.
>>>> Thanks for pointing this out.
>>>>
>>>> -----Original Message-----
>>>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May
>>>> 01, 2006 8:13 AM
>>>> To: hadoop-dev@lucene.apache.org
>>>> Subject: Re: C API for Hadoop DFS
>>>>
>>>>
>>>> I'm curious about error handling.
>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>
>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>> dfsSetWorkingDirectory each have a return value to indicate success
>>>> or failure?  Or are they assumed to never fail?
>>>>
>>>> - David
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>
>>
>>
>>
>
>




From MAILER-DAEMON Thu May  4 05:46:24 2006
Return-Path: 
 <hadoop-dev-return-1244-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35562 invoked from network); 4 May 2006 05:46:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 05:46:24 -0000
Received: (qmail 82516 invoked by uid 500); 4 May 2006 05:46:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82460 invoked by uid 500); 4 May 2006 05:46:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82430 invoked by uid 99); 4 May 2006 05:46:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 22:46:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 22:46:09 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id D7730144546
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 07:28:20 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 06580-02 for <hadoop-dev@lucene.apache.org>;
	Thu, 4 May 2006 07:28:20 +0200 (CEST)
Received: from [10.10.16.254] (unknown [64.71.164.125])
	by mslinux.media-style.com (Postfix) with ESMTP id 16EB1144540
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 07:28:18 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
To: hadoop-dev@lucene.apache.org
Message-Id: <2147AD20-F1D5-4CFF-B5A9-FE794AA83B6B@media-style.com>
Content-Type: multipart/alternative; boundary=Apple-Mail-18-910614117
From: Stefan Groschupf <sg@media-style.com>
Subject: reopen HADOOP-18,
 at java.util.zip.CRC32.update ArrayIndexOutOfBoundsException
Date: Wed, 3 May 2006 22:45:38 -0700
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-18-910614117
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed

Hi,
sorry I'm not able to reopen an issue.
But we had this as well, may the sources change a bit but in the end  
it is the same error.
This happens until a own written map task. The job runs without any  
problems locally.

Any thoughts what this could be?
Can someone with privileges reopen the bug or should I create a new one?

Thanks.
Stefan


java.lang.ArrayIndexOutOfBoundsException
	at java.util.zip.CRC32.update(CRC32.java:43)
	at org.apache.hadoop.fs.FSDataInputStream$Checker.read 
(FSDataInputStream.java:93)
	at org.apache.hadoop.fs.FSDataInputStream$PositionCache.read 
(FSDataInputStream.java:158)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
	at java.io.DataInputStream.readFully(DataInputStream.java:176)
	at org.apache.hadoop.io.DataOutputBuffer$Buffer.write 
(DataOutputBuffer.java:55)
	at org.apache.hadoop.io.DataOutputBuffer.write(DataOutputBuffer.java: 
89)
	at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:390)
	at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:311)
	at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:333)
	at org.apache.hadoop.mapred.SequenceFileRecordReader.next 
(SequenceFileRecordReader.java:58)
	at org.apache.hadoop.mapred.MapTask$3.next(MapTask.java:119)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:46)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:129)
	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java: 
755)
--Apple-Mail-18-910614117--

From MAILER-DAEMON Thu May  4 06:06:45 2006
Return-Path: 
 <hadoop-dev-return-1245-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46473 invoked from network); 4 May 2006 06:06:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 06:06:45 -0000
Received: (qmail 17761 invoked by uid 500); 4 May 2006 06:06:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17743 invoked by uid 500); 4 May 2006 06:06:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17734 invoked by uid 99); 4 May 2006 06:06:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 23:06:45 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [66.228.160.55] (HELO mercury2.inktomi.com) (66.228.160.55)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 23:06:44 -0700
Received: from inbox2.inktomi.com (inbox2.inktomi.com [66.228.160.112])
	by mercury2.inktomi.com (8.13.4/8.13.4) with ESMTP id k4466J3j002910
	for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006 23:06:19 -0700 (PDT)
Received: from [10.72.76.129] ([10.72.76.129]) by
          inbox2.inktomi.com (Netscape Messaging Server 4.1) with ESMTP id
          IYQ8YJ00.QQJ for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006
          23:06:19 -0700
Message-ID: <445999DA.6070700@yahoo-inc.com>
Date: Wed, 03 May 2006 23:06:18 -0700
From: Sameer Paranjpye <sameerp@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 0.7.1 (Windows/20040626)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <030e01c66e79$81b97130$2201a8c0@ddaslaptop>
 <474C5E89-2C58-4669-B284-BCC75E7C46CD@yahoo-inc.com>
In-Reply-To: <474C5E89-2C58-4669-B284-BCC75E7C46CD@yahoo-inc.com>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Negative numbers work fine when the return value is an int. But what do 
you do when returning a pointer? Either you have an integer return value 
and a pointer to pointer as an output parameter, or you return NULL and 
indicate the error via errno





Eric Baldeschwieler wrote:
> I'd vote against errno, because I don't see why we need it.  Why not  
> just return the error as a negative number?  Adding a global just  
> complicates the code and introduces an opportunity for further error.
> 
> What am I missing?
> 
> On May 2, 2006, at 11:19 PM, Devaraj Das wrote:
> 
>> In our case, the components involved are the C API library, JNI  layer 
>> and
>> Java APIs. In all these, we have control over errno. For example, if a
>> particular C API uses a third party library function that might  
>> return error
>> and hence set errno, we know about it already. Depending on the  
>> error, we
>> take a decision whether to proceed further in the API  implementation 
>> code or
>> return an error to the client invoking the API. This includes the  
>> functions
>> in the JNI library which the API implementation calls. In the Java  
>> world, we
>> deal with exceptions and don't bother about errno. So for example,  if 
>> a Java
>> method, invoked through JNI from a C API, throws an exception, the  C API
>> implementation will get the exception object and depending on that  
>> the API
>> implementation will set a meaningful errno and return a (-1) or  NULL to
>> signify that an error occurred. As I said earlier, this includes  the 
>> case
>> where the JNI function itself fails (for some reason like out-of- 
>> memory or
>> something).
>> As an aside, the JNI layer doesn't generate errno-s.
>>
>> -----Original Message-----
>> From: Konstantin Shvachko [mailto:shv@yahoo-inc.com]
>> Sent: Wednesday, May 03, 2006 2:40 AM
>> To: hadoop-dev@lucene.apache.org
>> Subject: Re: C API for Hadoop DFS
>>
>> Don't think errno is a particularly good idea for several reasons.
>> It is not common to set errno codes.
>> If a system library function uses errno, and we overwrite its value to
>> return
>> something dfs related, the library function behavior becomes  
>> unpredictable.
>> This could be hard to debug.
>> We have a JNI layer between our C library and Java, which also might
>> generate
>> errno-s overwriting the values we were trying to bring back from Java.
>>
>> --Konstantin
>>
>> Doug Cutting wrote:
>>
>>> The spec says:
>>>
>>> /** All APIs set errno to meaningful values */
>>>
>>> So callers should always check errno after each call.  Whether  this is
>>> the best way to handle errors in C can be debated, but an error
>>> mechanism was in fact specified.
>>>
>>> Doug
>>>
>>> Konstantin Shvachko wrote:
>>>
>>>> I think this a very important issue raised by David.
>>>>
>>>> IMO __ALL__ functions should return an integer value indicating
>>>> success (=0) or failure (<0).
>>>> Unless we want to use C style Exceptions, otherwise we won't be able
>>>> to identify what went
>>>> wrong if anything.
>>>> NULL or bool is not enough in most cases, since we need to
>>>> distinguish e.g. between
>>>> timeout (when we retry) and "file not found" cases.
>>>> The actual return objects should be passed as outputs parameters.
>>>> E.g.
>>>> dfsFS dfsConnect(char *host, tPort port);
>>>> will become
>>>> tCompletionCode dfsConnect(char *host, tPort port, dfsFS  fileSystem );
>>>> where tCompletionCode could be integer for now. Or we can define a
>>>> structure
>>>> { int errCode; char *errDescription; }
>>>> to return the actual error descriptions along with the error code.
>>>>
>>>> --Konstantin
>>>>
>>>> Devaraj Das wrote:
>>>>
>>>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>>
>>>>>
>>>>>
>>>>> Yes.
>>>>>
>>>>>
>>>>>
>>>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>>> dfsSetWorkingDirectory each have a return value to indicate  success
>>>>>> or failure?  Or are they assumed to never fail?
>>>>>>
>>>>>
>>>>>
>>>>> Yes these functions should have return values. I will update the  API
>>>>> spec.
>>>>> Thanks for pointing this out.
>>>>>
>>>>> -----Original Message-----
>>>>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May
>>>>> 01, 2006 8:13 AM
>>>>> To: hadoop-dev@lucene.apache.org
>>>>> Subject: Re: C API for Hadoop DFS
>>>>>
>>>>>
>>>>> I'm curious about error handling.
>>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>
>>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>> dfsSetWorkingDirectory each have a return value to indicate success
>>>>> or failure?  Or are they assumed to never fail?
>>>>>
>>>>> - David
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>>>
>>
>>
> 
> 

From MAILER-DAEMON Thu May  4 06:08:42 2006
Return-Path: 
 <hadoop-dev-return-1246-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47079 invoked from network); 4 May 2006 06:08:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 06:08:42 -0000
Received: (qmail 18311 invoked by uid 500); 4 May 2006 06:08:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18285 invoked by uid 500); 4 May 2006 06:08:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18275 invoked by uid 99); 4 May 2006 06:08:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 23:08:42 -0700
X-ASF-Spam-Status: No, hits=1.6 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,MAILTO_TO_SPAM_ADDR
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [66.228.160.55] (HELO mercury2.inktomi.com) (66.228.160.55)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 23:08:41 -0700
Received: from inbox2.inktomi.com (inbox2.inktomi.com [66.228.160.112])
	by mercury2.inktomi.com (8.13.4/8.13.4) with ESMTP id k4468AP8002949
	for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006 23:08:10 -0700 (PDT)
Received: from [10.72.76.129] ([10.72.76.129]) by
          inbox2.inktomi.com (Netscape Messaging Server 4.1) with ESMTP id
          IYQ91M00.OOG for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006
          23:08:10 -0700
Message-ID: <44599A49.9070308@yahoo-inc.com>
Date: Wed, 03 May 2006 23:08:09 -0700
From: Sameer Paranjpye <sameerp@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 0.7.1 (Windows/20040626)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <000001c66f3d$3f82e930$9a4c480a@ds.corp.yahoo.com>
In-Reply-To: <000001c66f3d$3f82e930$9a4c480a@ds.corp.yahoo.com>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Errno is not a global and is thread safe in all modern libc 
implementations. If you compile with -D_REENTRANT you'll be just fine. 
There is a separate errno for each thread.



Runping Qi wrote:

> Errno approach proved to be problematic in multi-thread environments.
> Returning an error code is better.
> 
> Runping
> 
> 
> -----Original Message-----
> From: Devaraj Das [mailto:ddas@yahoo-inc.com] 
> Sent: Wednesday, May 03, 2006 10:32 PM
> To: hadoop-dev@lucene.apache.org
> Subject: RE: C API for Hadoop DFS
> 
> Returning error as a negative number works as well. We initially decided to
> go with errno since it's a standard in most I/O centric APIs.
> 
> -----Original Message-----
> From: Eric Baldeschwieler [mailto:eric14@yahoo-inc.com] 
> Sent: Thursday, May 04, 2006 9:45 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: C API for Hadoop DFS
> 
> I'd vote against errno, because I don't see why we need it.  Why not  
> just return the error as a negative number?  Adding a global just  
> complicates the code and introduces an opportunity for further error.
> 
> What am I missing?
> 
> On May 2, 2006, at 11:19 PM, Devaraj Das wrote:
> 
> 
>>In our case, the components involved are the C API library, JNI  
>>layer and
>>Java APIs. In all these, we have control over errno. For example, if a
>>particular C API uses a third party library function that might  
>>return error
>>and hence set errno, we know about it already. Depending on the  
>>error, we
>>take a decision whether to proceed further in the API  
>>implementation code or
>>return an error to the client invoking the API. This includes the  
>>functions
>>in the JNI library which the API implementation calls. In the Java  
>>world, we
>>deal with exceptions and don't bother about errno. So for example,  
>>if a Java
>>method, invoked through JNI from a C API, throws an exception, the  
>>C API
>>implementation will get the exception object and depending on that  
>>the API
>>implementation will set a meaningful errno and return a (-1) or  
>>NULL to
>>signify that an error occurred. As I said earlier, this includes  
>>the case
>>where the JNI function itself fails (for some reason like out-of- 
>>memory or
>>something).
>>As an aside, the JNI layer doesn't generate errno-s.
>>
>>-----Original Message-----
>>From: Konstantin Shvachko [mailto:shv@yahoo-inc.com]
>>Sent: Wednesday, May 03, 2006 2:40 AM
>>To: hadoop-dev@lucene.apache.org
>>Subject: Re: C API for Hadoop DFS
>>
>>Don't think errno is a particularly good idea for several reasons.
>>It is not common to set errno codes.
>>If a system library function uses errno, and we overwrite its value to
>>return
>>something dfs related, the library function behavior becomes  
>>unpredictable.
>>This could be hard to debug.
>>We have a JNI layer between our C library and Java, which also might
>>generate
>>errno-s overwriting the values we were trying to bring back from Java.
>>
>>--Konstantin
>>
>>Doug Cutting wrote:
>>
>>
>>>The spec says:
>>>
>>>/** All APIs set errno to meaningful values */
>>>
>>>So callers should always check errno after each call.  Whether  
>>>this is
>>>the best way to handle errors in C can be debated, but an error
>>>mechanism was in fact specified.
>>>
>>>Doug
>>>
>>>Konstantin Shvachko wrote:
>>>
>>>
>>>>I think this a very important issue raised by David.
>>>>
>>>>IMO __ALL__ functions should return an integer value indicating
>>>>success (=0) or failure (<0).
>>>>Unless we want to use C style Exceptions, otherwise we won't be able
>>>>to identify what went
>>>>wrong if anything.
>>>>NULL or bool is not enough in most cases, since we need to
>>>>distinguish e.g. between
>>>>timeout (when we retry) and "file not found" cases.
>>>>The actual return objects should be passed as outputs parameters.
>>>>E.g.
>>>>dfsFS dfsConnect(char *host, tPort port);
>>>>will become
>>>>tCompletionCode dfsConnect(char *host, tPort port, dfsFS  
>>>>fileSystem );
>>>>where tCompletionCode could be integer for now. Or we can define a
>>>>structure
>>>>{ int errCode; char *errDescription; }
>>>>to return the actual error descriptions along with the error code.
>>>>
>>>>--Konstantin
>>>>
>>>>Devaraj Das wrote:
>>>>
>>>>
>>>>>>Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>>
>>>>>
>>>>>
>>>>>Yes.
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>>Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>>>dfsSetWorkingDirectory each have a return value to indicate  
>>>>>>success
>>>>>>or failure?  Or are they assumed to never fail?
>>>>>>
>>>>>
>>>>>
>>>>>Yes these functions should have return values. I will update the  
>>>>>API
>>>>>spec.
>>>>>Thanks for pointing this out.
>>>>>
>>>>>-----Original Message-----
>>>>>From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May
>>>>>01, 2006 8:13 AM
>>>>>To: hadoop-dev@lucene.apache.org
>>>>>Subject: Re: C API for Hadoop DFS
>>>>>
>>>>>
>>>>>I'm curious about error handling.
>>>>>Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>
>>>>>Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>>dfsSetWorkingDirectory each have a return value to indicate success
>>>>>or failure?  Or are they assumed to never fail?
>>>>>
>>>>>- David
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>>
> 
> 
> 
> 

From MAILER-DAEMON Thu May  4 06:21:58 2006
Return-Path: 
 <hadoop-dev-return-1247-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51447 invoked from network); 4 May 2006 06:21:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 06:21:58 -0000
Received: (qmail 40614 invoked by uid 500); 4 May 2006 06:21:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40589 invoked by uid 500); 4 May 2006 06:21:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40580 invoked by uid 99); 4 May 2006 06:21:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 23:21:57 -0700
X-ASF-Spam-Status: No, hits=1.6 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,MAILTO_TO_SPAM_ADDR
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [66.228.160.55] (HELO mercury2.inktomi.com) (66.228.160.55)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 03 May 2006 23:21:57 -0700
Received: from inbox2.inktomi.com (inbox2.inktomi.com [66.228.160.112])
	by mercury2.inktomi.com (8.13.4/8.13.4) with ESMTP id k446LOV6003425
	for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006 23:21:24 -0700 (PDT)
Received: from [10.72.76.129] ([10.72.76.129]) by
          inbox2.inktomi.com (Netscape Messaging Server 4.1) with ESMTP id
          IYQ9NO00.PSB for <hadoop-dev@lucene.apache.org>; Wed, 3 May 2006
          23:21:24 -0700
Message-ID: <44599D63.5010602@yahoo-inc.com>
Date: Wed, 03 May 2006 23:21:23 -0700
From: Sameer Paranjpye <sameerp@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 0.7.1 (Windows/20040626)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: C API for Hadoop DFS
References: <000001c66f3d$3f82e930$9a4c480a@ds.corp.yahoo.com>
 <44599A49.9070308@yahoo-inc.com>
In-Reply-To: <44599A49.9070308@yahoo-inc.com>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

All that said, I don't mean to be religious about errno. Using negative 
return values is a perfectly reasonably approach as well. If folks feel 
strongly about it I'm happy to go along ...



Sameer Paranjpye wrote:

> Errno is not a global and is thread safe in all modern libc 
> implementations. If you compile with -D_REENTRANT you'll be just fine. 
> There is a separate errno for each thread.
> 
> 
> 
> Runping Qi wrote:
> 
>> Errno approach proved to be problematic in multi-thread environments.
>> Returning an error code is better.
>>
>> Runping
>>
>>
>> -----Original Message-----
>> From: Devaraj Das [mailto:ddas@yahoo-inc.com] Sent: Wednesday, May 03, 
>> 2006 10:32 PM
>> To: hadoop-dev@lucene.apache.org
>> Subject: RE: C API for Hadoop DFS
>>
>> Returning error as a negative number works as well. We initially 
>> decided to
>> go with errno since it's a standard in most I/O centric APIs.
>>
>> -----Original Message-----
>> From: Eric Baldeschwieler [mailto:eric14@yahoo-inc.com] Sent: 
>> Thursday, May 04, 2006 9:45 AM
>> To: hadoop-dev@lucene.apache.org
>> Subject: Re: C API for Hadoop DFS
>>
>> I'd vote against errno, because I don't see why we need it.  Why not  
>> just return the error as a negative number?  Adding a global just  
>> complicates the code and introduces an opportunity for further error.
>>
>> What am I missing?
>>
>> On May 2, 2006, at 11:19 PM, Devaraj Das wrote:
>>
>>
>>> In our case, the components involved are the C API library, JNI  
>>> layer and
>>> Java APIs. In all these, we have control over errno. For example, if a
>>> particular C API uses a third party library function that might  
>>> return error
>>> and hence set errno, we know about it already. Depending on the  
>>> error, we
>>> take a decision whether to proceed further in the API  implementation 
>>> code or
>>> return an error to the client invoking the API. This includes the  
>>> functions
>>> in the JNI library which the API implementation calls. In the Java  
>>> world, we
>>> deal with exceptions and don't bother about errno. So for example,  
>>> if a Java
>>> method, invoked through JNI from a C API, throws an exception, the  C 
>>> API
>>> implementation will get the exception object and depending on that  
>>> the API
>>> implementation will set a meaningful errno and return a (-1) or  NULL to
>>> signify that an error occurred. As I said earlier, this includes  the 
>>> case
>>> where the JNI function itself fails (for some reason like out-of- 
>>> memory or
>>> something).
>>> As an aside, the JNI layer doesn't generate errno-s.
>>>
>>> -----Original Message-----
>>> From: Konstantin Shvachko [mailto:shv@yahoo-inc.com]
>>> Sent: Wednesday, May 03, 2006 2:40 AM
>>> To: hadoop-dev@lucene.apache.org
>>> Subject: Re: C API for Hadoop DFS
>>>
>>> Don't think errno is a particularly good idea for several reasons.
>>> It is not common to set errno codes.
>>> If a system library function uses errno, and we overwrite its value to
>>> return
>>> something dfs related, the library function behavior becomes  
>>> unpredictable.
>>> This could be hard to debug.
>>> We have a JNI layer between our C library and Java, which also might
>>> generate
>>> errno-s overwriting the values we were trying to bring back from Java.
>>>
>>> --Konstantin
>>>
>>> Doug Cutting wrote:
>>>
>>>
>>>> The spec says:
>>>>
>>>> /** All APIs set errno to meaningful values */
>>>>
>>>> So callers should always check errno after each call.  Whether  this is
>>>> the best way to handle errors in C can be debated, but an error
>>>> mechanism was in fact specified.
>>>>
>>>> Doug
>>>>
>>>> Konstantin Shvachko wrote:
>>>>
>>>>
>>>>> I think this a very important issue raised by David.
>>>>>
>>>>> IMO __ALL__ functions should return an integer value indicating
>>>>> success (=0) or failure (<0).
>>>>> Unless we want to use C style Exceptions, otherwise we won't be able
>>>>> to identify what went
>>>>> wrong if anything.
>>>>> NULL or bool is not enough in most cases, since we need to
>>>>> distinguish e.g. between
>>>>> timeout (when we retry) and "file not found" cases.
>>>>> The actual return objects should be passed as outputs parameters.
>>>>> E.g.
>>>>> dfsFS dfsConnect(char *host, tPort port);
>>>>> will become
>>>>> tCompletionCode dfsConnect(char *host, tPort port, dfsFS  
>>>>> fileSystem );
>>>>> where tCompletionCode could be integer for now. Or we can define a
>>>>> structure
>>>>> { int errCode; char *errDescription; }
>>>>> to return the actual error descriptions along with the error code.
>>>>>
>>>>> --Konstantin
>>>>>
>>>>> Devaraj Das wrote:
>>>>>
>>>>>
>>>>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>>>
>>>>>>
>>>>>>
>>>>>> Yes.
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>>>> dfsSetWorkingDirectory each have a return value to indicate  success
>>>>>>> or failure?  Or are they assumed to never fail?
>>>>>>>
>>>>>>
>>>>>>
>>>>>> Yes these functions should have return values. I will update the  API
>>>>>> spec.
>>>>>> Thanks for pointing this out.
>>>>>>
>>>>>> -----Original Message-----
>>>>>> From: David Bowen [mailto:dbowen@yahoo-inc.com] Sent: Monday, May
>>>>>> 01, 2006 8:13 AM
>>>>>> To: hadoop-dev@lucene.apache.org
>>>>>> Subject: Re: C API for Hadoop DFS
>>>>>>
>>>>>>
>>>>>> I'm curious about error handling.
>>>>>> Do dfsConnect and dfsOpenFile return NULL on failure?
>>>>>>
>>>>>> Shouldn't dfsSeek, dfsRename, dfsCreateDirectory and
>>>>>> dfsSetWorkingDirectory each have a return value to indicate success
>>>>>> or failure?  Or are they assumed to never fail?
>>>>>>
>>>>>> - David
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>>>
>>>
>>
>>
>>
>>
> 

From MAILER-DAEMON Thu May  4 17:02:56 2006
Return-Path: 
 <hadoop-dev-return-1248-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24498 invoked from network); 4 May 2006 17:02:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 17:02:56 -0000
Received: (qmail 98541 invoked by uid 500); 4 May 2006 17:02:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98449 invoked by uid 500); 4 May 2006 17:02:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98401 invoked by uid 99); 4 May 2006 17:02:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 10:02:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 10:02:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CD1FE410008
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 17:02:17 +0000 (GMT)
Message-ID: <7488119.1146762137666.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 17:02:17 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-65) add a record I/O framework to hadoop
In-Reply-To: <554934043.1141686841971.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-65?page=comments#action_12377844 ] 

Milind Bhandarkar commented on HADOOP-65:
-----------------------------------------

I realized that some of the classes which were earlier package-private had to be made public, and therefore are lacking in class comments. I will add comments and will submit a patch.

> add a record I/O framework to hadoop
> ------------------------------------
>
>          Key: HADOOP-65
>          URL: http://issues.apache.org/jira/browse/HADOOP-65
>      Project: Hadoop
>         Type: New Feature

>   Components: io, ipc
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: HadoopRecordIO.patch
>
> Hadoop could benefit greatly from a simple record I/O framework that enables the specification of simple record types and enables the generation of code for serialization/deserialization in multiple target languages. The framework would handle a small well understood set of primitive types and simple compositions of these (structs, vectors, maps) . It would be possible to leverage this framework to express I/O in MapReduce computations and to use this as the basis for Hadoops RPC implementation. This would make interfacing with code in languages other than Java much easier.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 17:52:58 2006
Return-Path: 
 <hadoop-dev-return-1249-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56934 invoked from network); 4 May 2006 17:52:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 17:52:58 -0000
Received: (qmail 21745 invoked by uid 500); 4 May 2006 17:52:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 21690 invoked by uid 500); 4 May 2006 17:52:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 21600 invoked by uid 99); 4 May 2006 17:52:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 10:52:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 10:52:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5F08F41000B
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 17:52:18 +0000 (GMT)
Message-ID: <6413697.1146765138386.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 17:52:18 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-195) transfer map output transfer with http
 instead of rpc
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

transfer map output transfer with http instead of rpc
-----------------------------------------------------

         Key: HADOOP-195
         URL: http://issues.apache.org/jira/browse/HADOOP-195
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3


The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 18:00:56 2006
Return-Path: 
 <hadoop-dev-return-1250-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61262 invoked from network); 4 May 2006 18:00:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 18:00:56 -0000
Received: (qmail 43848 invoked by uid 500); 4 May 2006 18:00:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43815 invoked by uid 500); 4 May 2006 18:00:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43791 invoked by uid 99); 4 May 2006 18:00:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:00:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:00:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AC972410009
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 18:00:17 +0000 (GMT)
Message-ID: <13339278.1146765617704.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 18:00:17 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12377857 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

The RPC mechanism is designed to be able to support large values.  Timeouts are for inactivity on a request, not for completion.  So perhaps there is just a bug in the RPC mechanism that can be fixed.  Or perhaps this really is an inappropriate use of it.  I'd like to hear more about the failures you're seeing before we decide.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 18:18:53 2006
Return-Path: 
 <hadoop-dev-return-1251-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77324 invoked from network); 4 May 2006 18:18:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 18:18:53 -0000
Received: (qmail 89959 invoked by uid 500); 4 May 2006 18:18:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89940 invoked by uid 500); 4 May 2006 18:18:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89931 invoked by uid 99); 4 May 2006 18:18:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:18:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:18:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B7FF6410009
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 18:18:17 +0000 (GMT)
Message-ID: <17494252.1146766697750.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 18:18:17 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12377862 ] 

paul sutter commented on HADOOP-195:
------------------------------------


I've had problems with timeouts during the copy phase, but its not clear to me that the problem is with the RPC mechanism. It may be TCP, in which case going to HTTP wouldnt help. 

Since the copy phase is the moment when the switch is busiest, my recommendation is to saturate your switch with traffic, and experiment with various transfer methods, like HTTP, etc.

I did tests to saturate our (cheap) switch with traffic from the nodes and measure packet loss. Though all the nodes were sending data at near a gigabit, the packet loss rate ranged from 0.5% to 2%, sometimes peaking at 5%. 

TCP behaves badly in such an environment, even with low latency. This is probably an opportunity to retune TCP, but ever since our workaround this problem has gone to the back burner.

We worked around the problem by dramatically increasing the number of mappers, which reduces the size of the map output file. For probablistic problems like this, the proobability of failure increases with the duration of the transfer, and when files reach a certain size the failure is likely to happen on every transfer, and no forward progress can be made.

The problem is an open question. I spent a lot of time trying to debug the RPC mechanisms, and I wasnt able to find a clear culprit.


> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 18:30:54 2006
Return-Path: 
 <hadoop-dev-return-1252-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85947 invoked from network); 4 May 2006 18:30:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 18:30:54 -0000
Received: (qmail 31114 invoked by uid 500); 4 May 2006 18:30:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30982 invoked by uid 500); 4 May 2006 18:30:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30970 invoked by uid 99); 4 May 2006 18:30:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:30:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:30:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EDC48410008
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 18:30:17 +0000 (GMT)
Message-ID: <32557320.1146767417620.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 18:30:17 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-130) Should be able to specify "wide" or
 "full" replication
In-Reply-To: <1115698231.1144702080037.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-130?page=all ]

Sameer Paranjpye updated HADOOP-130:
------------------------------------

    Fix Version: 0.3
        Version: 0.2

> Should be able to specify "wide" or "full" replication
> ------------------------------------------------------
>
>          Key: HADOOP-130
>          URL: http://issues.apache.org/jira/browse/HADOOP-130
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>  Environment: N/A
>     Reporter: Bryan Pendleton
>     Priority: Minor
>      Fix For: 0.3

>
> Should be able to specify that a file be "fully" or "widely" replicated, rather than an explicit replication count. This would be useful for job configuration and jar files, and probably other files whose use is wide enough to necessitate reducing latency to access them.
> The current implementation will also complain if you specify replication that is wider than the system's maximum replication value, and has no facility to enable "full" replication should the number of datanodes exceed the current maximum settable value of 32k.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 18:54:56 2006
Return-Path: 
 <hadoop-dev-return-1253-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 2731 invoked from network); 4 May 2006 18:54:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 18:54:56 -0000
Received: (qmail 77468 invoked by uid 500); 4 May 2006 18:54:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77448 invoked by uid 500); 4 May 2006 18:54:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77439 invoked by uid 99); 4 May 2006 18:54:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:54:55 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:54:53 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 58C4A7142B7
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 18:54:19 +0000 (GMT)
Message-ID: <16826277.1146768859360.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 18:54:19 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-182) lost task trackers should not update
 status of completed jobs
In-Reply-To: <18534471.1146509326381.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-182?page=all ]

Owen O'Malley updated HADOOP-182:
---------------------------------

    Attachment: lost-tracker.patch

This patch fixes:
  1. subtracting the progress for failed tasks
  2. completed/failedTask methods now update the status
  3. only fail maps and reduces that are currently running
  4. remove a few unused imports and a method

> lost task trackers should not update status of completed jobs
> -------------------------------------------------------------
>
>          Key: HADOOP-182
>          URL: http://issues.apache.org/jira/browse/HADOOP-182
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: lost-tracker.patch
>
> When a Task Tracker is lost (by not sending a heartbeat for 10 minutes), the JobTracker marks the tasks that were active on that node as failed. There are two issues:
>    1. No task from a completed or failed job should be modified.
>    2. No reduces should be marked as failed, since their output is in dfs and therefore not only on the dead node.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 18:58:54 2006
Return-Path: 
 <hadoop-dev-return-1254-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 5344 invoked from network); 4 May 2006 18:58:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 18:58:54 -0000
Received: (qmail 86700 invoked by uid 500); 4 May 2006 18:58:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86679 invoked by uid 500); 4 May 2006 18:58:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86669 invoked by uid 99); 4 May 2006 18:58:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:58:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 11:58:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ACC2D7142AE
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 18:58:17 +0000 (GMT)
Message-ID: <13740715.1146769097704.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 18:58:17 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-182) lost task trackers should not update
 status of completed jobs
In-Reply-To: <18534471.1146509326381.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-182?page=all ]

Owen O'Malley updated HADOOP-182:
---------------------------------

    Priority: Major  (was: Minor)

> lost task trackers should not update status of completed jobs
> -------------------------------------------------------------
>
>          Key: HADOOP-182
>          URL: http://issues.apache.org/jira/browse/HADOOP-182
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: lost-tracker.patch
>
> When a Task Tracker is lost (by not sending a heartbeat for 10 minutes), the JobTracker marks the tasks that were active on that node as failed. There are two issues:
>    1. No task from a completed or failed job should be modified.
>    2. No reduces should be marked as failed, since their output is in dfs and therefore not only on the dead node.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 21:50:55 2006
Return-Path: 
 <hadoop-dev-return-1255-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20035 invoked from network); 4 May 2006 21:50:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 21:50:55 -0000
Received: (qmail 28980 invoked by uid 500); 4 May 2006 21:50:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28954 invoked by uid 500); 4 May 2006 21:50:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28945 invoked by uid 99); 4 May 2006 21:50:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 14:50:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 14:50:53 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 577587142AE
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 21:50:18 +0000 (GMT)
Message-ID: <32654100.1146779418355.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 21:50:18 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-196) Fix buggy uselessness of
 Configuration( Configuration other) constructor
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Fix buggy uselessness of Configuration( Configuration other) constructor
------------------------------------------------------------------------

         Key: HADOOP-196
         URL: http://issues.apache.org/jira/browse/HADOOP-196
     Project: Hadoop
        Type: Bug

  Components: conf  
    Reporter: alan wootton


The constructor 
public Configuration(Configuration other) 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 22:01:04 2006
Return-Path: 
 <hadoop-dev-return-1256-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23953 invoked from network); 4 May 2006 22:01:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 22:01:04 -0000
Received: (qmail 49548 invoked by uid 500); 4 May 2006 22:00:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49518 invoked by uid 500); 4 May 2006 22:00:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49507 invoked by uid 99); 4 May 2006 22:00:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 15:00:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 15:00:53 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 812FC7142B6
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 22:00:18 +0000 (GMT)
Message-ID: <20983786.1146780018526.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 22:00:18 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-196) Fix buggy uselessness of
 Configuration( Configuration other) constructor
In-Reply-To: <32654100.1146779418355.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-196?page=all ]

alan wootton updated HADOOP-196:
--------------------------------

    Attachment: ConfigConstructorFix.patch

> Fix buggy uselessness of Configuration( Configuration other) constructor
> ------------------------------------------------------------------------
>
>          Key: HADOOP-196
>          URL: http://issues.apache.org/jira/browse/HADOOP-196
>      Project: Hadoop
>         Type: Bug

>   Components: conf
>     Reporter: alan wootton
>  Attachments: ConfigConstructorFix.patch
>
> The constructor 
> public Configuration(Configuration other) 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 22:01:09 2006
Return-Path: 
 <hadoop-dev-return-1257-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23978 invoked from network); 4 May 2006 22:01:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 22:01:09 -0000
Received: (qmail 49739 invoked by uid 500); 4 May 2006 22:00:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49599 invoked by uid 500); 4 May 2006 22:00:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49536 invoked by uid 99); 4 May 2006 22:00:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 15:00:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 15:00:54 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6850C7142BB
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 22:00:19 +0000 (GMT)
Message-ID: <24501383.1146780019424.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 22:00:19 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-196) Fix buggy uselessness of
 Configuration( Configuration other) constructor
In-Reply-To: <32654100.1146779418355.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-196?page=comments#action_12377895 ] 

alan wootton commented on HADOOP-196:
-------------------------------------

The constructor: 

	public Configuration(Configuration other)
	
sets the defaultResources, and the finalResources but does not use them 
because it then sets the properties to a clone of the other.properties.

If someone then calls addFinalResource (as does JobConf) then the
'other' properties are just lost. This becomes a problem if you attempt to use: 
	public JobConf(Class exampleClass)  

My fix (there are several possible ways to fix this) is to just remember
the other.properties and then overlay then whenever getProps() loads the resources.



> Fix buggy uselessness of Configuration( Configuration other) constructor
> ------------------------------------------------------------------------
>
>          Key: HADOOP-196
>          URL: http://issues.apache.org/jira/browse/HADOOP-196
>      Project: Hadoop
>         Type: Bug

>   Components: conf
>     Reporter: alan wootton
>  Attachments: ConfigConstructorFix.patch
>
> The constructor 
> public Configuration(Configuration other) 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 22:40:58 2006
Return-Path: 
 <hadoop-dev-return-1258-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44645 invoked from network); 4 May 2006 22:40:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 22:40:58 -0000
Received: (qmail 15933 invoked by uid 500); 4 May 2006 22:40:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15798 invoked by uid 500); 4 May 2006 22:40:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15789 invoked by uid 99); 4 May 2006 22:40:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 15:40:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 15:40:53 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 62F607142AE
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 22:40:18 +0000 (GMT)
Message-ID: <28818520.1146782418401.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 22:40:18 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
------------------------------------------------------------------------------

         Key: HADOOP-197
         URL: http://issues.apache.org/jira/browse/HADOOP-197
     Project: Hadoop
        Type: Improvement

  Components: dfs, mapred  
 Environment: all
    Reporter: alan wootton
    Priority: Minor
 Attachments: InetAddressWrapper.patch

I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()

The patch is:

1) replace InetAddress.getLocalHost().getHostName() with xxxx
	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()

There's 3 places where it happens:
DataNode
DFSClient
TaskTracker

I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May  4 22:40:59 2006
Return-Path: 
 <hadoop-dev-return-1259-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44662 invoked from network); 4 May 2006 22:41:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 May 2006 22:40:59 -0000
Received: (qmail 16083 invoked by uid 500); 4 May 2006 22:40:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15961 invoked by uid 500); 4 May 2006 22:40:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15952 invoked by uid 99); 4 May 2006 22:40:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 15:40:56 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 15:40:55 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7996C7142B5
	for <hadoop-dev@lucene.apache.org>; Thu,  4 May 2006 22:40:20 +0000 (GMT)
Message-ID: <18146822.1146782420495.JavaMail.jira@brutus>
Date: Thu, 4 May 2006 22:40:20 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
In-Reply-To: <28818520.1146782418401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-197?page=all ]

alan wootton updated HADOOP-197:
--------------------------------

    Attachment: InetAddressWrapper.patch

> Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-197
>          URL: http://issues.apache.org/jira/browse/HADOOP-197
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs, mapred
>  Environment: all
>     Reporter: alan wootton
>     Priority: Minor
>  Attachments: InetAddressWrapper.patch
>
> I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
> let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()
> The patch is:
> 1) replace InetAddress.getLocalHost().getHostName() with xxxx
> 	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
> 	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
> 2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()
> There's 3 places where it happens:
> DataNode
> DFSClient
> TaskTracker
> I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 00:19:54 2006
Return-Path: 
 <hadoop-dev-return-1260-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88338 invoked from network); 5 May 2006 00:19:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 00:19:54 -0000
Received: (qmail 32046 invoked by uid 500); 5 May 2006 00:19:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32020 invoked by uid 500); 5 May 2006 00:19:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32011 invoked by uid 99); 5 May 2006 00:19:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 17:19:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 17:19:53 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 329727142A7
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 00:19:18 +0000 (GMT)
Message-ID: <25980631.1146788358204.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 00:19:18 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-96?page=all ]

Hairong Kuang updated HADOOP-96:
--------------------------------

    Attachment: namenodeLogging.patch

The Cygwin problem is solved.

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch, namenodeLogging.patch, namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 00:34:54 2006
Return-Path: 
 <hadoop-dev-return-1261-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94901 invoked from network); 5 May 2006 00:34:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 00:34:54 -0000
Received: (qmail 51490 invoked by uid 500); 5 May 2006 00:34:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51460 invoked by uid 500); 5 May 2006 00:34:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51449 invoked by uid 99); 5 May 2006 00:34:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 17:34:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 17:34:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 78926410008
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 00:34:17 +0000 (GMT)
Message-ID: <18686658.1146789257466.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 00:34:17 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-198) adding owen's examples to
 exampledriver
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

adding owen's examples to exampledriver
---------------------------------------

         Key: HADOOP-198
         URL: http://issues.apache.org/jira/browse/HADOOP-198
     Project: Hadoop
        Type: Improvement

    Reporter: Mahadev konar
 Assigned to: Mahadev konar 
    Priority: Minor


owen's sorter and randomwriter are not added to the examples.jar file

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 00:38:57 2006
Return-Path: 
 <hadoop-dev-return-1262-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96035 invoked from network); 5 May 2006 00:38:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 00:38:57 -0000
Received: (qmail 53652 invoked by uid 500); 5 May 2006 00:38:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53526 invoked by uid 500); 5 May 2006 00:38:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53517 invoked by uid 99); 5 May 2006 00:38:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 17:38:56 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 May 2006 17:38:55 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A181B410009
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 00:38:20 +0000 (GMT)
Message-ID: <24982017.1146789500659.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 00:38:20 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-198) adding owen's examples to
 exampledriver
In-Reply-To: <18686658.1146789257466.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-198?page=all ]

Mahadev konar updated HADOOP-198:
---------------------------------

    Attachment: examples.patch

Added owen's examples to exampledriver. Also, made the ClusterStatus contructors public since the WritableFactories throw an exception if non public fields are accessed out of the package.

> adding owen's examples to exampledriver
> ---------------------------------------
>
>          Key: HADOOP-198
>          URL: http://issues.apache.org/jira/browse/HADOOP-198
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>  Attachments: examples.patch
>
> owen's sorter and randomwriter are not added to the examples.jar file

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 14:43:07 2006
Return-Path: 
 <hadoop-dev-return-1263-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73779 invoked from network); 5 May 2006 14:43:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 14:43:07 -0000
Received: (qmail 32048 invoked by uid 500); 5 May 2006 14:43:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32024 invoked by uid 500); 5 May 2006 14:43:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32014 invoked by uid 99); 5 May 2006 14:43:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 07:43:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 07:43:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 45BBE7142C0
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 14:42:29 +0000 (GMT)
Message-ID: <13164628.1146840149282.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 14:42:29 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
In-Reply-To: <28818520.1146782418401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-197?page=comments#action_12378048 ] 

Doug Cutting commented on HADOOP-197:
-------------------------------------

Can you say more about why you need multiple names for a single host?


> Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-197
>          URL: http://issues.apache.org/jira/browse/HADOOP-197
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred, dfs
>  Environment: all
>     Reporter: alan wootton
>     Priority: Minor
>  Attachments: InetAddressWrapper.patch
>
> I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
> let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()
> The patch is:
> 1) replace InetAddress.getLocalHost().getHostName() with xxxx
> 	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
> 	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
> 2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()
> There's 3 places where it happens:
> DataNode
> DFSClient
> TaskTracker
> I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 16:31:05 2006
Return-Path: 
 <hadoop-dev-return-1264-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39069 invoked from network); 5 May 2006 16:31:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 16:31:05 -0000
Received: (qmail 89455 invoked by uid 500); 5 May 2006 16:31:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89435 invoked by uid 500); 5 May 2006 16:31:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89426 invoked by uid 99); 5 May 2006 16:31:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 09:31:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 09:31:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 45D517142B8
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 16:30:28 +0000 (GMT)
Message-ID: <13326400.1146846628283.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 16:30:28 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-198) adding owen's examples to
 exampledriver
In-Reply-To: <18686658.1146789257466.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-198?page=all ]
     
Doug Cutting resolved HADOOP-198:
---------------------------------

    Fix Version: 0.2
     Resolution: Fixed

I just committed this.  I changed your fix to the WritableFactory problem slightly, as I'd rather avoid making more things public to work around this.  Please confirm that things work for you the way I fixed it.  Thanks!

> adding owen's examples to exampledriver
> ---------------------------------------
>
>          Key: HADOOP-198
>          URL: http://issues.apache.org/jira/browse/HADOOP-198
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: examples.patch
>
> owen's sorter and randomwriter are not added to the examples.jar file

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 17:10:18 2006
Return-Path: 
 <hadoop-dev-return-1265-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58303 invoked from network); 5 May 2006 17:10:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 17:10:18 -0000
Received: (qmail 54714 invoked by uid 500); 5 May 2006 17:10:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54623 invoked by uid 500); 5 May 2006 17:10:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54432 invoked by uid 99); 5 May 2006 17:10:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 10:10:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 10:10:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D54547142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 17:09:28 +0000 (GMT)
Message-ID: <15946949.1146848968868.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 17:09:28 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-96?page=all ]
     
Doug Cutting resolved HADOOP-96:
--------------------------------

    Resolution: Fixed

I just committed this.

I made one additional change.  You removed the 'cd $HADOOP_HOME' line in hadoop-daemon.sh.  I re-added this to hadoop-daemons.sh, so that, when starting remote daemons, they are always run from HADOOP_HOME rather than the users home directory, which is more likely to be NFS mounted.  The CWD of a daemon is used for core dumps, java profiler output, etc. and it is generally best if it is not NFS mounted.

Thanks, Hairong!

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch, namenodeLogging.patch, namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 17:39:05 2006
Return-Path: 
 <hadoop-dev-return-1266-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69135 invoked from network); 5 May 2006 17:39:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 17:39:05 -0000
Received: (qmail 87391 invoked by uid 500); 5 May 2006 17:39:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87264 invoked by uid 500); 5 May 2006 17:39:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87255 invoked by uid 99); 5 May 2006 17:39:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 10:39:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 10:39:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 302BE7142BF
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 17:38:28 +0000 (GMT)
Message-ID: <10691571.1146850708194.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 17:38:28 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378080 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

Looking at the logs of my sort benchmark on 188 nodes, each reduce is fetching and processing 1 gig of data from ~64k maps. After all of the maps are done, a reduce takes 8 hours to run. 7 of those hours are in fetching the map outputs.

Timing of calls to getFile that complete (average ~15k bytes):
   Max: 76 seconds
   Avg: 385 ms
   Mean: 45 ms
   Distribution (count, int(log_2(ms))):
     149 0
   41449 1
   96305 2
  101595 3
13060775 4
71232197 5
 9675008 6
 4569403 7
 5688185 8
 5196811 9
 3878971 10
 4267733 11
 1855209 12
  411456 13
   70594 14
   24182 15
       1 16

Timeouts from getFile: 29120

So the reduce prepare is being dominated by calls to getFile (64k * 385 = 6.8 hours).

For a first pass, I'll try increasing the number of threads serving data to 20 (from 2) and try the parallel rpc call to fetch 5 files at a time.

Thoughts?

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 18:10:08 2006
Return-Path: 
 <hadoop-dev-return-1267-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85645 invoked from network); 5 May 2006 18:10:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 18:10:08 -0000
Received: (qmail 33830 invoked by uid 500); 5 May 2006 18:10:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33807 invoked by uid 500); 5 May 2006 18:10:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33798 invoked by uid 99); 5 May 2006 18:10:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:10:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:10:07 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9F0C57142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 18:09:31 +0000 (GMT)
Message-ID: <21047019.1146852571648.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 18:09:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378086 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

So you're seeing nearly a 50% timeout rate.  That's not good.  It would be nice to know more about how these occur.  For example, if they're occurring because the client connection  to that host is busy, then increasing the number of serving threads alone won't help.  You'd also need to disable or enhance connection pooling on the client.  Parallel RPC calls will probably increase the timeout rate, but might still improve things, since (hopefully) one of the requests will find an available server and keep the clients network interface busy.

Disabling pooling for these calls should not be hard.  Add an option to RPC.getProxy() to disable connection pooling, and store this as a new field in the Invoker.  Then add an option to Client.call() that it passes to getConnection() to bypass the connection cache.  Then, in a finally clause of Client.call(), close the connection when noCacheConnections was passed.  You could even bypass the connection's thread and simply read the response directly under Client.call(), since there will be no other calls multiplexed over the connection.

Enhancing pooling might be better yet.  One could, e.g., remove a connection from the pool while a request is outstanding, and then add it back into the pool only if there were no io errors, if there's not already a pooled connection to that host, and perhaps if the pool's not too big.  So each call could have a dedicated connection.

The ability to multiplex requests and responses over a single connection is still probably an important feature for, e.g., Nutch's distributed search, where you might have a hundred clients all broadcasting queries to a hundred backends.  In this case you don't want to have 10,000 connections, but rather just 100, and you don't want to force fast queries to wait for slower queries to complete.  So dedicated connections per call should be an option, not mandated.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 18:12:18 2006
Return-Path: 
 <hadoop-dev-return-1268-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87256 invoked from network); 5 May 2006 18:12:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 18:12:18 -0000
Received: (qmail 36450 invoked by uid 500); 5 May 2006 18:12:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36429 invoked by uid 500); 5 May 2006 18:12:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36420 invoked by uid 99); 5 May 2006 18:12:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:12:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:12:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2D8C17142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 18:11:28 +0000 (GMT)
Message-ID: <28413728.1146852688183.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 18:11:28 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-182) lost task trackers should not update
 status of completed jobs
In-Reply-To: <18534471.1146509326381.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-182?page=all ]
     
Owen O'Malley resolved HADOOP-182:
----------------------------------

    Fix Version: 0.2
                     (was: 0.3)
     Resolution: Fixed

> lost task trackers should not update status of completed jobs
> -------------------------------------------------------------
>
>          Key: HADOOP-182
>          URL: http://issues.apache.org/jira/browse/HADOOP-182
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.2
>  Attachments: lost-tracker.patch
>
> When a Task Tracker is lost (by not sending a heartbeat for 10 minutes), the JobTracker marks the tasks that were active on that node as failed. There are two issues:
>    1. No task from a completed or failed job should be modified.
>    2. No reduces should be marked as failed, since their output is in dfs and therefore not only on the dead node.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 18:12:18 2006
Return-Path: 
 <hadoop-dev-return-1269-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87255 invoked from network); 5 May 2006 18:12:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 18:12:18 -0000
Received: (qmail 36697 invoked by uid 500); 5 May 2006 18:12:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36572 invoked by uid 500); 5 May 2006 18:12:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36563 invoked by uid 99); 5 May 2006 18:12:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:12:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:12:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 062EE7142C0
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 18:11:29 +0000 (GMT)
Message-ID: <10550205.1146852689022.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 18:11:29 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
In-Reply-To: <28818520.1146782418401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-197?page=comments#action_12378087 ] 

alan wootton commented on HADOOP-197:
-------------------------------------


For the purposes of debugging, and generally exploring the behaviour of the distributed hadoop system, I have constructed a simulation that runs several TaskTrackers, and DataNodes from Eclipse. In many threads.

This is not a hard trick (and it's very useful, imho) but the DataNodes, for example, need to think they are all running on different hosts. To do this I define localhost0, localhost1, etc, just like localhost, and as I launch the DataNodes I give them each their own config with their own values for a hostname (inetaddress.localhost.name) and also unique values for dfs.name.dir, dfs.data.dir, etc.

Also, in general, I will wave my arms in the air and say that a single machine might have any of several names and just using the one from InetAddress may not be the right thing all the time, for everyone. Or, perhaps nobody cares :-)

While I'm here. Is ClusterTestDFS.java being maintained? It seems broken, and I can't see how any replication would be allowed, or how this test can barely even run. Put in this patch and I'll fix it for you.


> Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-197
>          URL: http://issues.apache.org/jira/browse/HADOOP-197
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred, dfs
>  Environment: all
>     Reporter: alan wootton
>     Priority: Minor
>  Attachments: InetAddressWrapper.patch
>
> I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
> let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()
> The patch is:
> 1) replace InetAddress.getLocalHost().getHostName() with xxxx
> 	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
> 	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
> 2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()
> There's 3 places where it happens:
> DataNode
> DFSClient
> TaskTracker
> I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 18:20:05 2006
Return-Path: 
 <hadoop-dev-return-1270-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90751 invoked from network); 5 May 2006 18:20:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 18:20:05 -0000
Received: (qmail 49958 invoked by uid 500); 5 May 2006 18:20:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49935 invoked by uid 500); 5 May 2006 18:20:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49926 invoked by uid 99); 5 May 2006 18:20:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:20:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:20:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 888D57142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 18:19:28 +0000 (GMT)
Message-ID: <31197184.1146853168556.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 18:19:28 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-180) task tracker times out cleaning big
 job
In-Reply-To: <24018329.1146508966485.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-180?page=all ]

Owen O'Malley updated HADOOP-180:
---------------------------------

    Attachment: task-cleanup-thread.patch

This patch fixes the timeouts by creating a synchronized queue (we really should go to java 1.5 soon) of tasks that need to be cleaned up and a daemon thread that does it in the background.

It also fixes some race conditions in the TaskTracker on the tasks variable. (Some references where locking the TaskTracker and others were locking the TaskTracker.TaskInProgress.)

I also changed the rpc logging a little to include both client and server time measurements.

> task tracker times out cleaning big job
> ---------------------------------------
>
>          Key: HADOOP-180
>          URL: http://issues.apache.org/jira/browse/HADOOP-180
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: task-cleanup-thread.patch
>
> After completing a big job (63,920 maps, 1880 reduces, 188 nodes), lots of the TaskTrackers timed out because the task cleanup is handled by the same thread as the heartbeats.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 18:24:06 2006
Return-Path: 
 <hadoop-dev-return-1271-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93669 invoked from network); 5 May 2006 18:24:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 18:24:06 -0000
Received: (qmail 57046 invoked by uid 500); 5 May 2006 18:24:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57027 invoked by uid 500); 5 May 2006 18:24:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57014 invoked by uid 99); 5 May 2006 18:24:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:24:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:24:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3122B7142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 18:23:28 +0000 (GMT)
Message-ID: <5652871.1146853408198.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 18:23:28 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378090 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

No, I'm seeing a 0.01% timeout rate. There are 64k*2k = 128m getFile calls. Losing 29k of them is sub-optimal, but not a serious drain.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 18:46:06 2006
Return-Path: 
 <hadoop-dev-return-1272-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4958 invoked from network); 5 May 2006 18:46:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 18:46:06 -0000
Received: (qmail 91667 invoked by uid 500); 5 May 2006 18:46:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91646 invoked by uid 500); 5 May 2006 18:46:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91634 invoked by uid 99); 5 May 2006 18:46:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:46:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:46:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8B5907142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 18:45:28 +0000 (GMT)
Message-ID: <5753708.1146854728568.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 18:45:28 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
In-Reply-To: <28818520.1146782418401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-197?page=comments#action_12378098 ] 

Doug Cutting commented on HADOOP-197:
-------------------------------------

> Also, in general, I will wave my arms in the air and say that a single machine might have any of several names and just using the one from InetAddress may not be the right thing all the time [ ...]

Yes,  for sure.  The more common problem is with machines with multiple public ips, or hosts that return the loopback address.  There isn't really a good way (yet) in java to get the preferred public ip (if any) from a host.

http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4665037

I just wanted to understand whether this was the issue you were having, or something else.

I'm up for implementing this feature.  I don't particularly like the name InetAddressWrapper, since it is not a complete wrapper.  So if we rename this NetworkUtils, then, unless someone objects, I'm up for committing it.

Thanks!

> Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-197
>          URL: http://issues.apache.org/jira/browse/HADOOP-197
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred, dfs
>  Environment: all
>     Reporter: alan wootton
>     Priority: Minor
>  Attachments: InetAddressWrapper.patch
>
> I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
> let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()
> The patch is:
> 1) replace InetAddress.getLocalHost().getHostName() with xxxx
> 	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
> 	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
> 2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()
> There's 3 places where it happens:
> DataNode
> DFSClient
> TaskTracker
> I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 18:48:06 2006
Return-Path: 
 <hadoop-dev-return-1273-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6179 invoked from network); 5 May 2006 18:48:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 18:48:06 -0000
Received: (qmail 96043 invoked by uid 500); 5 May 2006 18:48:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96023 invoked by uid 500); 5 May 2006 18:48:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96014 invoked by uid 99); 5 May 2006 18:48:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:48:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:48:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9E1A67142BB
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 18:47:28 +0000 (GMT)
Message-ID: <19352265.1146854848644.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 18:47:28 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12378099 ] 

Hairong Kuang commented on HADOOP-96:
-------------------------------------

Hi Doug,

Thanks for commiting this patch.

The reason that I removed the line 'cd $HADOOP_HOME' is that I had difficulty starting hadoop from any directory except for "HADOOP_HOME". In my configuration, the log dir & pid dir are relative to "HADOOP_HOME".  But "HADOOP_HOME" is relative to the current directory ".". If the script changes the current directory, it is not able to get the log dir and pid dir right.

An alternative fix is to set HADOOP_HOME to be its absolute path.

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch, namenodeLogging.patch, namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 18:50:08 2006
Return-Path: 
 <hadoop-dev-return-1274-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7058 invoked from network); 5 May 2006 18:50:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 18:50:08 -0000
Received: (qmail 325 invoked by uid 500); 5 May 2006 18:50:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 199 invoked by uid 500); 5 May 2006 18:50:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99834 invoked by uid 99); 5 May 2006 18:50:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:50:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 11:50:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7D5037142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 18:49:28 +0000 (GMT)
Message-ID: <33058677.1146854968510.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 18:49:28 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378100 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

In that case then, perhaps increasing the the number of serving threads to N*2*tasks_per_node, and using parallel calls to N hosts (where N = 5 to start?) will help throughput, as you suggest.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 19:07:07 2006
Return-Path: 
 <hadoop-dev-return-1275-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15499 invoked from network); 5 May 2006 19:07:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 19:07:07 -0000
Received: (qmail 23624 invoked by uid 500); 5 May 2006 19:07:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23601 invoked by uid 500); 5 May 2006 19:07:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23592 invoked by uid 99); 5 May 2006 19:07:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:07:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:07:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 85A507142C0
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 19:06:29 +0000 (GMT)
Message-ID: <18296359.1146855989544.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 19:06:29 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
In-Reply-To: <28818520.1146782418401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-197?page=comments#action_12378106 ] 

alan wootton commented on HADOOP-197:
-------------------------------------

I don't especially even like the idea of having to make a whole new class for one little static method. I'd be happy to rename it NetworkUtils. I even considered just inlining it everywhere, and I also looked around for another class the stick this static method in.

Shall we go with NetworkUtils?

> Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-197
>          URL: http://issues.apache.org/jira/browse/HADOOP-197
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred, dfs
>  Environment: all
>     Reporter: alan wootton
>     Priority: Minor
>  Attachments: InetAddressWrapper.patch
>
> I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
> let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()
> The patch is:
> 1) replace InetAddress.getLocalHost().getHostName() with xxxx
> 	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
> 	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
> 2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()
> There's 3 places where it happens:
> DataNode
> DFSClient
> TaskTracker
> I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 19:09:10 2006
Return-Path: 
 <hadoop-dev-return-1276-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16386 invoked from network); 5 May 2006 19:09:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 19:09:10 -0000
Received: (qmail 24637 invoked by uid 500); 5 May 2006 19:09:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24513 invoked by uid 500); 5 May 2006 19:09:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24504 invoked by uid 99); 5 May 2006 19:09:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:09:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:09:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E5CBC7142C1
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 19:08:29 +0000 (GMT)
Message-ID: <15521668.1146856109938.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 19:08:29 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12378108 ] 

Doug Cutting commented on HADOOP-96:
------------------------------------

I'm now having troubles with things under cygwin.  'bin/hadoop-daemon.sh start namenode' works, but 'bin/start-dfs.sh' silently fails to start any daemons.

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch, namenodeLogging.patch, namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 19:15:06 2006
Return-Path: 
 <hadoop-dev-return-1277-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18857 invoked from network); 5 May 2006 19:15:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 19:15:06 -0000
Received: (qmail 31285 invoked by uid 500); 5 May 2006 19:15:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31162 invoked by uid 500); 5 May 2006 19:15:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31153 invoked by uid 99); 5 May 2006 19:15:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:15:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:15:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 66C167142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 19:14:28 +0000 (GMT)
Message-ID: <11908405.1146856468417.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 19:14:28 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378110 ] 

paul sutter commented on HADOOP-195:
------------------------------------


glad to hear you're working on a sort benchmark for hadoop.

compare:
- 1 gigabyte in 7 hours on 188 nodes, to
- 1 terabyte in 7 minutes on 80 itaniums

http://research.microsoft.com/barc/SortBenchmark/

cleaning up the sort path will benefit us all greatly!

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 19:38:07 2006
Return-Path: 
 <hadoop-dev-return-1278-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36436 invoked from network); 5 May 2006 19:38:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 19:38:07 -0000
Received: (qmail 51979 invoked by uid 500); 5 May 2006 19:38:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51856 invoked by uid 500); 5 May 2006 19:38:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51847 invoked by uid 99); 5 May 2006 19:38:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:38:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:38:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 79A5D7142C0
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 19:37:29 +0000 (GMT)
Message-ID: <11371097.1146857849495.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 19:37:29 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12378116 ] 

Doug Cutting commented on HADOOP-96:
------------------------------------

I figured out the problem under Cygwin & fixed it.  HADOOP_HOME wasn't quoted in hadoop-daemon.sh, so things failed when the path contained a space (as my HADOOP_HOME does under cygwin).  When testing under Cygwin one should always install in a path that contains a space to test these cases.

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2
>  Attachments: namenodeLogging.patch, namenodeLogging.patch, namenodeLogging.patch
>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 19:40:05 2006
Return-Path: 
 <hadoop-dev-return-1279-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37288 invoked from network); 5 May 2006 19:40:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 19:40:05 -0000
Received: (qmail 53367 invoked by uid 500); 5 May 2006 19:40:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53350 invoked by uid 500); 5 May 2006 19:40:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53341 invoked by uid 99); 5 May 2006 19:40:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:40:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:40:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 376C67142BD
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 19:39:28 +0000 (GMT)
Message-ID: <25235639.1146857968224.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 19:39:28 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
In-Reply-To: <28818520.1146782418401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-197?page=comments#action_12378117 ] 

Doug Cutting commented on HADOOP-197:
-------------------------------------

It could become a method on Configuration, named getLocalHost().

> Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-197
>          URL: http://issues.apache.org/jira/browse/HADOOP-197
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred, dfs
>  Environment: all
>     Reporter: alan wootton
>     Priority: Minor
>  Attachments: InetAddressWrapper.patch
>
> I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
> let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()
> The patch is:
> 1) replace InetAddress.getLocalHost().getHostName() with xxxx
> 	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
> 	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
> 2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()
> There's 3 places where it happens:
> DataNode
> DFSClient
> TaskTracker
> I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 19:56:07 2006
Return-Path: 
 <hadoop-dev-return-1280-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46473 invoked from network); 5 May 2006 19:56:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 19:56:07 -0000
Received: (qmail 83943 invoked by uid 500); 5 May 2006 19:56:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83779 invoked by uid 500); 5 May 2006 19:56:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83768 invoked by uid 99); 5 May 2006 19:56:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:56:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 12:56:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7E15E7142B7
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 19:55:28 +0000 (GMT)
Message-ID: <15896766.1146858928513.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 19:55:28 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378127 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

> 1 gigabyte in 7 hours on 188 nodes

Note that the total size of the data sorted in this case is several terabytes.  Owen said 1G per reduce task, and I think he has a few thousand reduce tasks.  (Owen?)  So, you're right, we're not yet down to 7 minutes/terabyte, but things still aren't quite as bad as you state.

Google's MapReduce paper reports a terabyte sort time of 891 seconds using a cluster of 1800 dual Xeon nodes.

The Indy test you cite (TB in 7 minutes on 80 Itaniums) also has fancier switches and disk arrays than Google's cluster or Owen's cluster.  In particular, it's not clear that it would easily scale to sorting 10 terabytes in 7 minutes on 800 Itaniums, since 800-port switches are harder to find.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 20:23:07 2006
Return-Path: 
 <hadoop-dev-return-1281-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62018 invoked from network); 5 May 2006 20:23:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 20:23:07 -0000
Received: (qmail 31943 invoked by uid 500); 5 May 2006 20:23:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31923 invoked by uid 500); 5 May 2006 20:23:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31914 invoked by uid 99); 5 May 2006 20:23:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 13:23:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 13:23:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5AD357142AE
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 20:22:29 +0000 (GMT)
Message-ID: <10645455.1146860549369.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 20:22:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378130 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

The code that I'm testing with is in the examples directory.

randomwriter generates 1g/map and 10 maps/node for a total of 1880 g of data.
the sequence file format splits that into 63920 maps and I use 1880 reduces.



> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 20:48:05 2006
Return-Path: 
 <hadoop-dev-return-1282-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70115 invoked from network); 5 May 2006 20:48:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 20:48:05 -0000
Received: (qmail 63167 invoked by uid 500); 5 May 2006 20:48:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63146 invoked by uid 500); 5 May 2006 20:48:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63136 invoked by uid 99); 5 May 2006 20:48:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 13:48:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 13:48:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3FD2B410008
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 20:47:28 +0000 (GMT)
Message-ID: <2843493.1146862048258.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 20:47:28 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378132 ] 

paul sutter commented on HADOOP-195:
------------------------------------


ooops, i was wrong by a few orders of magnitude. 
but i was also right by a couple orders of magnitude

the best feature of the map/reduce approach is that you only have to make one thing fast, and every program you write is fast.

and that one thing is sort.

so again,.. im very pleased that we're taking a look at the sort path!

once the copy phase is fixed, the next step is for the Yahoo guys to contribute David Cossock's sort ;)

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 22:20:06 2006
Return-Path: 
 <hadoop-dev-return-1283-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9482 invoked from network); 5 May 2006 22:20:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 22:20:06 -0000
Received: (qmail 67851 invoked by uid 500); 5 May 2006 22:20:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67825 invoked by uid 500); 5 May 2006 22:20:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67816 invoked by uid 99); 5 May 2006 22:20:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 15:20:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 15:20:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3D1F87142BB
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 22:19:28 +0000 (GMT)
Message-ID: <23708140.1146867568247.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 22:19:28 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-158) dfs block ids sometimes collide
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-158?page=all ]

Doug Cutting updated HADOOP-158:
--------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> dfs block ids sometimes collide
> -------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.3

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 22:20:07 2006
Return-Path: 
 <hadoop-dev-return-1284-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9503 invoked from network); 5 May 2006 22:20:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 22:20:07 -0000
Received: (qmail 67984 invoked by uid 500); 5 May 2006 22:20:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67965 invoked by uid 500); 5 May 2006 22:20:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67956 invoked by uid 99); 5 May 2006 22:20:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 15:20:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 15:20:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6FF6F7142BE
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 22:19:29 +0000 (GMT)
Message-ID: <25586093.1146867569456.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 22:19:29 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-159) name node at 100% cpu, making
 redundant replications
In-Reply-To: <929695.1145660285762.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-159?page=all ]

Doug Cutting updated HADOOP-159:
--------------------------------

    Fix Version: 0.3
                     (was: 0.2)

> name node at 100% cpu, making redundant replications
> ----------------------------------------------------
>
>          Key: HADOOP-159
>          URL: http://issues.apache.org/jira/browse/HADOOP-159
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>     Priority: Blocker
>      Fix For: 0.3

>
> some hours after adding some new nodes to the cluster, the name node went into a state where it's consuming 100% cpu.
> The log file keeps logging messages of the forms
> 060421 155049 Obsoleting block blk_8093115169359854355
> 060421 155049 Pending transfer (block blk_-6965677235456960523) from node1383:50010 to 2 destinations
> 060421 155049 Block report from node1283:50010: 2140 blocks.
> 060421 155049 Redundant addStoredBlock request received for block blk_-6836937139917042917 on node node1143:50010
> many DFS operations time out, making useful work impossible.
> restarting dfs solved the problem for a while, but it came back within an hour.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 23:24:07 2006
Return-Path: 
 <hadoop-dev-return-1285-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28413 invoked from network); 5 May 2006 23:24:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 23:24:07 -0000
Received: (qmail 21846 invoked by uid 500); 5 May 2006 23:24:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 21823 invoked by uid 500); 5 May 2006 23:24:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 21814 invoked by uid 99); 5 May 2006 23:24:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 16:24:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 16:24:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D4BE8410008
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 23:23:28 +0000 (GMT)
Message-ID: <29956484.1146871408857.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 23:23:28 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
In-Reply-To: <28818520.1146782418401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-197?page=all ]

alan wootton updated HADOOP-197:
--------------------------------

    Attachment: conf_getHostName.patch

patch to Configuration so it will return the local host name. 

> Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-197
>          URL: http://issues.apache.org/jira/browse/HADOOP-197
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred, dfs
>  Environment: all
>     Reporter: alan wootton
>     Priority: Minor
>  Attachments: InetAddressWrapper.patch, conf_getHostName.patch
>
> I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
> let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()
> The patch is:
> 1) replace InetAddress.getLocalHost().getHostName() with xxxx
> 	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
> 	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
> 2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()
> There's 3 places where it happens:
> DataNode
> DFSClient
> TaskTracker
> I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May  5 23:26:10 2006
Return-Path: 
 <hadoop-dev-return-1286-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28843 invoked from network); 5 May 2006 23:26:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 May 2006 23:26:10 -0000
Received: (qmail 22753 invoked by uid 500); 5 May 2006 23:26:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22733 invoked by uid 500); 5 May 2006 23:26:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22723 invoked by uid 99); 5 May 2006 23:26:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 16:26:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 16:26:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 469227142BB
	for <hadoop-dev@lucene.apache.org>; Fri,  5 May 2006 23:25:28 +0000 (GMT)
Message-ID: <1443480.1146871528250.JavaMail.jira@brutus>
Date: Fri, 5 May 2006 23:25:28 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-197) Hook
 InetAddress.getLocalHost().getHostName() to support cluster simulatation.
In-Reply-To: <28818520.1146782418401.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-197?page=comments#action_12378168 ] 

alan wootton commented on HADOOP-197:
-------------------------------------

I thought of adding it to conf. That is logical. It's just that Configuration is so, ..., 'clean' and I didn't want to start dumping stuff into to. But, since you bring it up: I send a patch with InetAddress.getLocalHost().getHostName() implemented as a method named 'getLocalHost'

> Hook InetAddress.getLocalHost().getHostName() to support cluster simulatation.
> ------------------------------------------------------------------------------
>
>          Key: HADOOP-197
>          URL: http://issues.apache.org/jira/browse/HADOOP-197
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred, dfs
>  Environment: all
>     Reporter: alan wootton
>     Priority: Minor
>  Attachments: InetAddressWrapper.patch, conf_getHostName.patch
>
> I have been running a simulation for weeks now (and also a 30 machine crawl). To make it work I need to sometimes 
> let DataNodes, and TaskTrackers think they have a different machine-name than the one in InetAddress.getLocalHost()
> The patch is:
> 1) replace InetAddress.getLocalHost().getHostName() with xxxx
> 	1.a)xxxx could be "conf.get("inetaddress.localhost.name",InetAddress.getLocalHost().getHostName())"
> 	1.b)or, xxxx could be a static call, I chose the latter: "InetAddressWrapper.getLocalHostName(conf)"
> 2) InetAddressWrapper.getLocalHostName(conf) checks the config for a hostname, and then calls InetAddress.getLocalHost().getHostName()
> There's 3 places where it happens:
> DataNode
> DFSClient
> TaskTracker
> I did not patch the two tests that call InetAddress because they are not really using hostname.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May  6 02:31:34 2006
Return-Path: 
 <hadoop-dev-return-1287-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85098 invoked from network); 6 May 2006 02:31:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 May 2006 02:31:34 -0000
Received: (qmail 32252 invoked by uid 500); 6 May 2006 02:31:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31852 invoked by uid 500); 6 May 2006 02:31:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31752 invoked by uid 99); 6 May 2006 02:31:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 19:31:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 May 2006 19:31:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 49CB4410009
	for <hadoop-dev@lucene.apache.org>; Sat,  6 May 2006 02:30:48 +0000 (GMT)
Message-ID: <25680174.1146882648299.JavaMail.jira@brutus>
Date: Sat, 6 May 2006 02:30:48 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-136?page=comments#action_12378179 ] 

Michel Tourn commented on HADOOP-136:
-------------------------------------

I need a fix for this. (Serialization of long UTF8 strings)

I have two proposals.
I am not addressing 4-byte UTF8 characters.
What would others recommend here?


Option 1. 

An alternate encoding for potentially long Strings. 
Code must explicitely choose to write and read back the "large" version.

To share as much code as possible, 
just add an optional argument to the UTF8 constructors: boolean large
If large mode:
 the length encoding is a VarLenShort (see below)
else:
 the length encoding is a short (the current format)

Note about static methods in class o.a.h.io.UTF8:
This change requires instance state (for the boolean large flag)
So the static versions of the UTF8 methods would ignore this change.
This should not be a problem since the code mentions that 
the static methods are deprecated and will go away,
   
   
   
Option 2. A semi-backward-compatible change.

In fact this is the same change as Option 1, 
except that we always assume large = true

in UTF8 change this:
  int bytes = in.readUnsignedShort();
to this:
  int bytes = in.readVarLenShort(); 
(and similarly for writes)

This is word-level variable-length encoding:
if the highest bit of the length word (16th bit) is set, 
then there is an extension word for the length. 
Total payload: 30 bits worth of length, which is enough.

For short enough Strings, the length encoding is unchanged 
This is why it is semi-backwards-compatible.

What inputs are currently accepted:
 Unicode strings, clipped at 0xffff/3=21845 characters.

What would be backwards compatible:
 Strings of encoded length <= 32767 bytes
 This includes: 
  o content with average character length less than 32767/21845 = 1.5 bytes
  o in partic. all single-byte UTF-8 (ASCII, iso-8859)
 


> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor

>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May  6 18:12:01 2006
Return-Path: 
 <hadoop-dev-return-1288-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58049 invoked from network); 6 May 2006 18:12:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 May 2006 18:12:01 -0000
Received: (qmail 65126 invoked by uid 500); 6 May 2006 18:12:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65093 invoked by uid 500); 6 May 2006 18:12:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65080 invoked by uid 99); 6 May 2006 18:12:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 11:12:00 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 11:11:58 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3C79771429D
	for <hadoop-dev@lucene.apache.org>; Sat,  6 May 2006 18:11:21 +0000 (GMT)
Message-ID: <16433131.1146939081223.JavaMail.jira@brutus>
Date: Sat, 6 May 2006 18:11:21 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-136?page=comments#action_12378237 ] 

Sameer Paranjpye commented on HADOOP-136:
-----------------------------------------

What about simply introducing a new UTF8_String class that does the right thing for the complete range of characters and deprecating the use of the current class?

> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor

>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May  6 20:17:00 2006
Return-Path: 
 <hadoop-dev-return-1289-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21115 invoked from network); 6 May 2006 20:17:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 May 2006 20:17:00 -0000
Received: (qmail 53374 invoked by uid 500); 6 May 2006 20:17:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53346 invoked by uid 500); 6 May 2006 20:16:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53335 invoked by uid 99); 6 May 2006 20:16:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 13:16:59 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 13:16:58 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3D07E7142C0
	for <hadoop-dev@lucene.apache.org>; Sat,  6 May 2006 20:16:21 +0000 (GMT)
Message-ID: <14333509.1146946581232.JavaMail.jira@brutus>
Date: Sat, 6 May 2006 20:16:21 +0000 (GMT+00:00)
From: "Dick King (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-136?page=comments#action_12378247 ] 

Dick King commented on HADOOP-136:
----------------------------------

I would vote for option 2 above.  I'm having difficulty imagining an existing file that has the following three properties:

1: too large to convert if need be with a one-off

2: has UTF8's larger than 32767 bytes encoded but smaller than 21845 characters

3: hasn't already been trashed by a UTF8 that was truncated.

I woul dlike to go after the 4-byters as well.  There's no compatibility issue here.

-dk


> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor

>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 01:16:01 2006
Return-Path: 
 <hadoop-dev-return-1290-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96829 invoked from network); 7 May 2006 01:16:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 01:16:01 -0000
Received: (qmail 87179 invoked by uid 500); 7 May 2006 01:16:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87153 invoked by uid 500); 7 May 2006 01:16:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87144 invoked by uid 99); 7 May 2006 01:16:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 18:16:00 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 18:15:59 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 90A497142AE
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 01:15:21 +0000 (GMT)
Message-ID: <21929025.1146964521589.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 01:15:21 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378265 ] 

paul sutter commented on HADOOP-195:
------------------------------------


I checked with Robert Ramey who held the PennySort record for a while, because the PennySort runs on a single commodity meachine, so we should all feel comfortable with the comparison.

His sort does about 1GB/minute on an ordinary machine.

So,  1880GB on 188 machines should be = 10 minutes sort time + ?? copy time (copy should be faster than sort).

If Owen's example is taking 1 hour sort time plus 7 hours copy time, its apparent that the biggest win is in improving the copy, and the next important task is improving the sort.

David Cossock's sort at Yahoo is very fast, so that is one option if Yahoo is interested. 

If  Yahoo isnt interested in contributing that, Robert Ramey may be open to doing consulting work in this area. Once the copy times are improved, we'd be interested in helping sponsor sort performance improvements.



> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 03:29:00 2006
Return-Path: 
 <hadoop-dev-return-1291-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31602 invoked from network); 7 May 2006 03:29:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 03:29:00 -0000
Received: (qmail 39650 invoked by uid 500); 7 May 2006 03:29:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39632 invoked by uid 500); 7 May 2006 03:28:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39618 invoked by uid 99); 7 May 2006 03:28:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 20:28:59 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 20:28:59 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E56C27142C5
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 03:28:20 +0000 (GMT)
Message-ID: <25410254.1146972500935.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 03:28:20 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-199) reduce copy progress not updating
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

reduce copy progress not updating
---------------------------------

         Key: HADOOP-199
         URL: http://issues.apache.org/jira/browse/HADOOP-199
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.3    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Minor


I'm running with the svn head from Friday and my patch for hadoop-180 and I'm not getting progress updates until reduces finish. I'm worried that it may be related to my changes for hadoop-182. I'll track it down, but I wanted to let everyone know.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 03:56:00 2006
Return-Path: 
 <hadoop-dev-return-1292-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36952 invoked from network); 7 May 2006 03:56:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 03:56:00 -0000
Received: (qmail 48796 invoked by uid 500); 7 May 2006 03:56:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48768 invoked by uid 500); 7 May 2006 03:55:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48751 invoked by uid 99); 7 May 2006 03:55:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 20:55:59 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 06 May 2006 20:55:59 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E1A6E7142C5
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 03:55:20 +0000 (GMT)
Message-ID: <13737024.1146974120921.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 03:55:20 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-200) The map task names are sent to the
 reduces
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

The map task names are sent to the reduces
------------------------------------------

         Key: HADOOP-200
         URL: http://issues.apache.org/jira/browse/HADOOP-200
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3


As each reduce is created, it is given the entire set of potential map names. For my large sort jobs with 64k maps, this means that each reduce task is given a two dimensional array that is 5 tasks/map * 64k maps = 320k strings. Since the reduce task is passed from the job tracker to the task tracker and down to the task runner, passing the entire list is very expensive. I suspect that this is the cause of the slow downs that I see in the task trackers heart beats when the reduce tasks are being launched.

I propose that the ReduceTask be changed to just get the count of maps, with ids from 0 .. maps -1.
  public ReduceTask(String jobFile, String taskId, int maps, int partition);
Then we need to change the protocol for finding map outputs:
  MapOutputLocation[] locateMapOutputs(String jobId, int[] mapIds, int partition);


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 17:31:02 2006
Return-Path: 
 <hadoop-dev-return-1293-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85174 invoked from network); 7 May 2006 17:31:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 17:31:02 -0000
Received: (qmail 45909 invoked by uid 500); 7 May 2006 17:31:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 45785 invoked by uid 500); 7 May 2006 17:31:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 45760 invoked by uid 99); 7 May 2006 17:31:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 10:31:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 10:31:00 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9DC64410009
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 17:30:21 +0000 (GMT)
Message-ID: <19644881.1147023021643.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 17:30:21 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378307 ] 

paul sutter commented on HADOOP-195:
------------------------------------

Owen,
 
Here are a few things you can try for your sort performance issues:
 
(1) DONT NAGLE
 
Nagle's algorithm can add 200ms to a TCP transaction, and could be accounting for a chunk of that average 385 milliseconds you're seeing. I think Nagle is enabled by default. You could try disabling Nagle with setTcpNoDelay on the RPC-server-side socket.

With 64,000 files, one Nagle per file could waste hours.

Note that by disabling Nagle, you'll get some runt packets (for example, the header and at the boundary of each socket write). This should not be a material performance issue, and you can reduce it arbitrarily by increasing the size of the buffer (right now it's a hardcoded 8KB buffer).
 
It would be great Java allowed the use of TCP_CORK and the use of sendfile(), since you could avoid runts and avoid a few buffer copies because sendfile does it all in the kernel. That's what HTTP servers do, which was your original suggestion.
 
Other TCP tuning could help. My intuition is that these wildly varying transfer times are related to packet loss, and I expect some level of tuning to help this but I haventhad time to look into it. Disabling linger should help when packets are lost in the closing handshake.  I'm also an advocate of much larger buffers, although that isn't an issue for your particular case. Another minor issue (and not causing your particular performance issue) is that we should turn on keepalives with a short retry, since without keepalives TCP does not _always_ detect hung sessions, and the current code that ignores socket timeouts can leave us with a collection of zombie sessions. But of course, that's not an issue for your situation.

(2) BIGGER FILES
 
Modern disks transfer at over 50MB/s, yet seek no faster than the drives used by the ancient sumerians.
 
15KB takes less than 300 microseconds to transfer to or from a SATA disk. Since a seek takes probably more than 10 milliseconds, you're at least 97% seek bound with a 15KB file.  Its actually worse: how many disk seeks does it take to create a file and then delete it later? (I dont know) 
 
Transferring even 1MB whenever you touch disk is 30-50% seek-bound, because the 20ms it takes to transfer 1MB is in the same ballpark as the seek time of the drive (I get 10-20ms when I measure SATA seek). 

You might as well transfer 4MB or 16MB each time you touch disk, then your code will still work a few years from now.
 
Increasing drive transfer speed is due to increasing data density. The more bits per inch the more bits per second at a given rotational speed. Our grandfathers got away with using 4KB and 8KB block sizes in their JCL because data densities were just really low back then. 
 
(3) LESS THRASHING
 
We're moving terabytes, yet the sort path writes map output to disk and reads it back in 5 times before the data reaches the reducer:
 
1 - mapper output, 
2 - copy individual map output files to reducer, 
3 - concatenate little files into big file, 
4 - write merge file when sort buffer is full, 
5 - write merged data to disk.
 
Steps 3 and 5 are the first opportunity for a speedup because they exist purely for programmer convenience. The sorter can read directly from a list of files instead of one file, and the reducer could call the merger directly to collect the input records instead of storing it to disk as an intermediate step.
 
Step 2 permits the mapper-to-reducer copy to be restarted if it fails, but strictly speaking that data only needs to go to disk if the sort buffer doesn't have enough space left to hold the entire file (since it would be easy to back out of a failed transfer as long as the sort buffer doesn't fill up). Also, you could just start the sort early when you encountered a file that would fit in the sort buffer, but there's just not enough room left in the sort buffer. 
 
Step 4 only needs to occur when the data is too large to fit into RAM.
 
Whether or not step 1 needs to occur could be a matter of debate.
 
(4) BIG BUFFERS IN MERGE PHASE
 
The default 4KB buffer size is really bad for the merge phase (see suggestion 2). Since the merger is reading from a bunch of merge files, and from the perspective of the OS, you are performing one read at a time from a randomly-chosen merge file, its unlikely for the OS to figure out that you really want to sequentialize. 

It's a little daredevil to rely on Linux doing 1000-to-1 sequentialization anyway; you might as well just use a big buffer and be done with it -I'm not sure of the benefit of the small buffer.
 
(5) OTHER IMPROVEMENTS
 
The DFS write of the data coming out of the reducer currently writes a local copy of data to disk, but this could be eliminated by using a 32MB RAM buffer instead of a disk file for recoveries from connection failures. 
 
In general, we'd be better off using NIO instead of stream IO because of fewer buffer copies and better control of buffering and endian-ness. Stream IO does at least two buffer copies of the data, one in the kernel because of use of the disk cache, and at least one in Java.  Yes, I realize that this would be a major rewrite and less important than the others mentioned. 
 
It would be interesting to calculate the number of buffer copies in the current sort path above considering that you get two buffer copies when you write the disk and two when you read the disk, and you have 5 extra visits to disk plus the network transfer. 


> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 18:37:02 2006
Return-Path: 
 <hadoop-dev-return-1294-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8588 invoked from network); 7 May 2006 18:37:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 18:37:02 -0000
Received: (qmail 84430 invoked by uid 500); 7 May 2006 18:37:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84404 invoked by uid 500); 7 May 2006 18:37:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84394 invoked by uid 99); 7 May 2006 18:37:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 11:37:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 11:37:00 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 974D77142C8
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 18:36:21 +0000 (GMT)
Message-ID: <27569742.1147026981617.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 18:36:21 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-200) The map task names are sent to the
 reduces
In-Reply-To: <13737024.1146974120921.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-200?page=comments#action_12378309 ] 

eric baldeschwieler commented on HADOOP-200:
--------------------------------------------

+1 and another and another...

> The map task names are sent to the reduces
> ------------------------------------------
>
>          Key: HADOOP-200
>          URL: http://issues.apache.org/jira/browse/HADOOP-200
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> As each reduce is created, it is given the entire set of potential map names. For my large sort jobs with 64k maps, this means that each reduce task is given a two dimensional array that is 5 tasks/map * 64k maps = 320k strings. Since the reduce task is passed from the job tracker to the task tracker and down to the task runner, passing the entire list is very expensive. I suspect that this is the cause of the slow downs that I see in the task trackers heart beats when the reduce tasks are being launched.
> I propose that the ReduceTask be changed to just get the count of maps, with ids from 0 .. maps -1.
>   public ReduceTask(String jobFile, String taskId, int maps, int partition);
> Then we need to change the protocol for finding map outputs:
>   MapOutputLocation[] locateMapOutputs(String jobId, int[] mapIds, int partition);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 19:11:02 2006
Return-Path: 
 <hadoop-dev-return-1295-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19764 invoked from network); 7 May 2006 19:11:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 19:11:02 -0000
Received: (qmail 773 invoked by uid 500); 7 May 2006 19:11:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 748 invoked by uid 500); 7 May 2006 19:11:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 739 invoked by uid 99); 7 May 2006 19:11:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 12:11:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 12:11:00 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 99013410009
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 19:10:21 +0000 (GMT)
Message-ID: <4669805.1147029021623.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 19:10:21 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378311 ] 

eric baldeschwieler commented on HADOOP-195:
--------------------------------------------

Good list paul!

Some very simple changes should have a big impact on sort behavior as you observe. We'll start working on that once it becomes the bottleneck.

One simple way to increase the file sizes is to reduce the number of reduces significantly and increase the DFS block size to 64 or 128meg.

We'll play with these (if I can convince owen).  I think we should bump the hadoop default block size to 128m, this is still small enough to replicate quickly, but will reduce #map jobs significantly when you just want to scan data.  Reduce the number of reduces as well and we'll have significantly larger transactions.

All that said, I think we are probably uncovering things in the RPC layer (and server threading) more than basic network issues, since we're running on a decent network and not even beginning to approach saturating it.  But we'll certainly play with "setTcpNoDelay."  It will be interesting to see if that moves things along.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 20:11:02 2006
Return-Path: 
 <hadoop-dev-return-1296-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49204 invoked from network); 7 May 2006 20:11:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 20:11:02 -0000
Received: (qmail 41578 invoked by uid 500); 7 May 2006 20:11:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41554 invoked by uid 500); 7 May 2006 20:11:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41545 invoked by uid 99); 7 May 2006 20:11:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 13:11:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 13:11:00 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9073C7142BA
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 20:10:21 +0000 (GMT)
Message-ID: <11763254.1147032621589.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 20:10:21 +0000 (GMT+00:00)
From: "Dominik Friedrich (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378313 ] 

Dominik Friedrich commented on HADOOP-195:
------------------------------------------

Has anybody tried to use the APR (Apache portable runtime) with a JNI wrapper like tomcat? With this wrapper you could use OS features like sendfile, epoll, random number generator and so on. I haven't used it myself, just saw some performance test with JBoss web which is using this.

This is might bit off topic, but Java NIO has been mentioned before. I've played around with Java NIO some weeks ago to see where it could be usefull in Nutch/hadoop. With my simple tests I found no significant performance improvements in file IO. I guess the tests were just too simple (serializing/deserializing Java objects to/from disk) to give useful results.

I also tested the network throughput with a multiplexed socket compared to the one-thread-per-client design. With NIO the throughput was almost independent from the number of concurrent connections while the threading overhead became very significant with 100+ threads. 

My testbed was a simple server with two IO thread and a few worker thread and bunch of clients that sent messages (serialized Java objects) to the server. On the server side one IO thread read messages from the socket and put them into a blocking queue and the other IO thread read outgoing messages from another blocking queue and sent them. The worker thread pulled messages from the in-queue, work on them (in my test they just copied the message) and put their result on the out-queue. This way the server could handle a few 1000 connections without problem. This design or something similar might be useful for the namenode or distributed search as mentioned before.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 20:51:02 2006
Return-Path: 
 <hadoop-dev-return-1297-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62315 invoked from network); 7 May 2006 20:51:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 20:51:02 -0000
Received: (qmail 69063 invoked by uid 500); 7 May 2006 20:51:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69043 invoked by uid 500); 7 May 2006 20:51:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69034 invoked by uid 99); 7 May 2006 20:51:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 13:51:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 13:51:00 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 932507142C4
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 20:50:21 +0000 (GMT)
Message-ID: <26389265.1147035021600.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 20:50:21 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378315 ] 

paul sutter commented on HADOOP-195:
------------------------------------


eric,

most of my suggestions relate to the copy phase of the sort path, not the sort itself. once that is working, i can make sort suggestions (although my best sort suggestion is for you guys to talk with david cossock about sorts).

this whole area is critical. on that cluster, owen's 2TB should sort in 10 minutes, and the data should be copied in less than that time, for a total run time of <20 minutes. 

pleased that yahoo has resources to apply. 

paul

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 21:19:02 2006
Return-Path: 
 <hadoop-dev-return-1298-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72225 invoked from network); 7 May 2006 21:19:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 21:19:02 -0000
Received: (qmail 94236 invoked by uid 500); 7 May 2006 21:19:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94208 invoked by uid 500); 7 May 2006 21:19:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94192 invoked by uid 99); 7 May 2006 21:19:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 14:19:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 14:19:00 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 936447142D0
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 21:18:21 +0000 (GMT)
Message-ID: <13608454.1147036701601.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 21:18:21 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378335 ] 

paul sutter commented on HADOOP-195:
------------------------------------


dominek,

buffer copies are nowhere near a bottleneck in hadoop, yet. right now we have lots of wins just from getting our buffering right.

reducing buffer copies only matters when buffer copies are a bottleneck. you would have to use a profiler to see how much time was being spent in your serialization/deserialization code, for example. if your code is the bottleneck, then reducing buffer copies might not matter. how long are your requests? if they are small, its not likely to matter. if they are gigabytes, then it could matter a lot.

other questions about your use of NIO:
- did you try using the native endian-ness with NIO? or the default? (the default is evil Sun endian-ness)
- are you using direct buffers, or indirect? (indirect buffers still cost you a buffer copy in user space)
- are you using memory mapping, or buffered io? (buffered io costs you a buffer copy in kernel space)

of course, an honest-to-god unbuffered read is so much better than memory mapping. someone who is more of a unix guy could help you figure out which linux filesystem supports real unbuffered io, and how to make that happen from java. when you're memory mapped, its hard to coerce the system into doing the multimegabyte double-buffered reads that you really want to do if you are interested in performance. you might have to use JNI to make that io fast. but again, its only worthwhile if you know where the bottlenecks are. windows nt is popular among sort people because its so easy to get an honest-to-god unbuffered io.

but again, none of that matters if you're not moving much data, or if you dont have a buffer copy bottleneck.

using the JNI interface you mention sounds interesting. of course, if we're going to go non-pure-java, we might as well use owen's idea of an http server to serve up the map output data, since that server will already be tuned. we're using lighttpd here and getting super good performance (for a different application of course).

im super glad there's an interest in performance here!

paul

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 16:09:33 2006
Return-Path: 
 <hadoop-dev-return-1308-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93120 invoked from network); 8 May 2006 16:09:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 16:09:33 -0000
Received: (qmail 55625 invoked by uid 500); 8 May 2006 16:09:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55502 invoked by uid 500); 8 May 2006 16:09:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55493 invoked by uid 99); 8 May 2006 16:09:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 09:09:30 -0700
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=DATE_IN_PAST_12_24,DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 09:09:29 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k48G87Pg021648
	for <hadoop-dev@lucene.apache.org>; Mon, 8 May 2006 09:08:07 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=PUD5fWOZLoZnPhFTPrU4f4KRiP/U5ohIeZcDkAXWDb2aRGZ8gPGEMb5EnPASFmRM
Received: from [172.21.147.237] ([172.21.179.132]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 8 May 2006 09:08:07 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <26389265.1147035021600.JavaMail.jira@brutus>
References: <26389265.1147035021600.JavaMail.jira@brutus>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <C27FF99F-80CE-4877-A8AE-8CF38763E3A1@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
Date: Sun, 7 May 2006 15:55:49 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 08 May 2006 16:08:07.0910 (UTC)
 FILETIME=[98772860:01C672B9]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

yes of course.  Agree with your analysis.

On May 7, 2006, at 1:50 PM, paul sutter (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-195? 
> page=comments#action_12378315 ]
>
> paul sutter commented on HADOOP-195:
> ------------------------------------
>
>
> eric,
>
> most of my suggestions relate to the copy phase of the sort path,  
> not the sort itself. once that is working, i can make sort  
> suggestions (although my best sort suggestion is for you guys to  
> talk with david cossock about sorts).
>
> this whole area is critical. on that cluster, owen's 2TB should  
> sort in 10 minutes, and the data should be copied in less than that  
> time, for a total run time of <20 minutes.
>
> pleased that yahoo has resources to apply.
>
> paul
>
>> transfer map output transfer with http instead of rpc
>> -----------------------------------------------------
>>
>>          Key: HADOOP-195
>>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>>      Project: Hadoop
>>         Type: Improvement
>
>>   Components: mapred
>>     Versions: 0.2
>>     Reporter: Owen O'Malley
>>     Assignee: Owen O'Malley
>>      Fix For: 0.3
>
>>
>> The data transfer of the map output should be transfered via http  
>> instead rpc, because rpc is very slow for this application and the  
>> timeout behavior is suboptimal. (server sends data and client  
>> ignores it because it took more than 10 seconds to be received.)
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Sun May  7 22:57:02 2006
Return-Path: 
 <hadoop-dev-return-1299-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6799 invoked from network); 7 May 2006 22:57:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 22:57:02 -0000
Received: (qmail 51879 invoked by uid 500); 7 May 2006 22:57:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51856 invoked by uid 500); 7 May 2006 22:57:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51847 invoked by uid 99); 7 May 2006 22:57:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 15:57:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 15:57:00 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9558E7142D0
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 22:56:21 +0000 (GMT)
Message-ID: <22063000.1147042581609.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 22:56:21 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378340 ] 

paul sutter commented on HADOOP-195:
------------------------------------


Owen,

Mike Ovsiannikov had a great suggestion.  Can you check netstat for TIME_WAIT sessions during the slowdown? Maybe the system is running out of sockets (ports), 64,000 connects per reducer is a lot of connections.

If you are accumulating zillions of TIME_WAIT sessions, you might want to try to experiment with the following:

net.ipv4.tcp_tw_reuse
net.ipv4.tcp_tw_recycle

That histogram that you have.. can you show that as a time-series? Does it go really fast at first, and then bog down?

It might also be good to instrument the time it takes to connect versus transfer versus close, etc.

Paul

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 23:08:02 2006
Return-Path: 
 <hadoop-dev-return-1300-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9396 invoked from network); 7 May 2006 23:08:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 23:08:02 -0000
Received: (qmail 56098 invoked by uid 500); 7 May 2006 23:08:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56074 invoked by uid 500); 7 May 2006 23:08:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56065 invoked by uid 99); 7 May 2006 23:08:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 16:08:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 16:08:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9BF0C7142D0
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 23:07:21 +0000 (GMT)
Message-ID: <5296331.1147043241636.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 23:07:21 +0000 (GMT+00:00)
From: "Dominik Friedrich (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378341 ] 

Dominik Friedrich commented on HADOOP-195:
------------------------------------------

paul,

the file IO test were really pretty simple. To be honest I don't remember my actual setup anymore but only that I saw not much difference between normal stream IO and NIO but the data was by far not gigabytes.

I used default endian-ness, direct buffers and buffered io. From what I read before memory mapping gives almost no performance gain against buffered io for streaming io. It makes if you've random access within a limited region of a file. In both cases you've buffered IO because of the OS's file system buffer. From what I know about OSs there is no copy to kernel space and the file system buffer of a modern OS is hardly to beat performance wise. Unbuffered IO would actually decrease the performance because the file system cannot change the write order and do other tricks to reduce seeks. In general I don't think there is much space for file IO performance improvements in hadoop except using e.g. APR through JNI.

To improve the sorting performance I'd start by looking at the algorithm itself, because there seem to be better algorithms out there. This huge difference in performance cannot be caused by suboptimal implementation. Bottlenecks are file and network IO so the goal is to reduce those. I haven't used Nutch/hadoop for some time now and so I'm not up to date with the current code. 

This is a really interesting problem, could be a nice project for Google's Summer of Code.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May  7 23:18:02 2006
Return-Path: 
 <hadoop-dev-return-1301-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14554 invoked from network); 7 May 2006 23:18:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 May 2006 23:18:02 -0000
Received: (qmail 73900 invoked by uid 500); 7 May 2006 23:18:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73875 invoked by uid 500); 7 May 2006 23:18:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73866 invoked by uid 99); 7 May 2006 23:18:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 16:18:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 16:18:00 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 91857410009
	for <hadoop-dev@lucene.apache.org>; Sun,  7 May 2006 23:17:21 +0000 (GMT)
Message-ID: <25565541.1147043841593.JavaMail.jira@brutus>
Date: Sun, 7 May 2006 23:17:21 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378342 ] 

paul sutter commented on HADOOP-195:
------------------------------------


dominek,

if you're not moving gigabytes of data, its unlikely that you need to worry about one or two buffer copies.

if an application does move gigabytes of data, and you have some other use for the CPU while you're moving data, you definitely dont want that data flowing through the file cache because you are incurring a buffer copy and the data volumes are too large to get any benefit from the file cache. 

but it feels like there are a few too many if's for our discussion to be of much importance ;) its definitely a fun area of work!

paul



> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 02:14:14 2006
Return-Path: 
 <hadoop-dev-return-1302-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83508 invoked from network); 8 May 2006 02:14:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 02:14:14 -0000
Received: (qmail 83778 invoked by uid 500); 8 May 2006 02:14:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83608 invoked by uid 500); 8 May 2006 02:14:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83552 invoked by uid 99); 8 May 2006 02:14:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 19:14:03 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.28] (HELO mrout2-b.corp.dcn.yahoo.com)
 (216.109.112.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 19:14:02 -0700
Received: from enemysentdx (enemysent-dx.corp.yahoo.com [66.228.175.168])
	by mrout2-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k482DQwg099884
	for <hadoop-dev@lucene.apache.org>; Sun, 7 May 2006 19:13:26 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:thread-index:x-mimeole;
	b=kz0Nd9aREmhR7taiw7BNGYvxyt7qm4qlJ0IThW1ZEe61x3tMt29unNx5+2bpRxtW
From: "Mahadev Konar" <mahadev@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: [jira] Created: (HADOOP-199) reduce copy progress not updating
Date: Sun, 7 May 2006 19:13:26 -0700
Message-ID: <000001c67244$fe2c5a60$a8afe442@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <25410254.1146972500935.JavaMail.jira@brutus>
Thread-Index: AcZxhmfwWFiU2ROBRR+GGGnjc2+kgwAupEQg
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Looks like the current code in JobTracker only updates when a task is
finished or failed.
In updateTaskStatuses() (In the JobTracker), there should be 
 job.updateTaskStatus(tip, report);
 if the tip is not null.
 I will try adding this line and see if it fixes it.

Regards
Mahadev

                 

-----Original Message-----
From: Owen O'Malley (JIRA) [mailto:jira@apache.org] 
Sent: Saturday, May 06, 2006 8:28 PM
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-199) reduce copy progress not updating

reduce copy progress not updating
---------------------------------

         Key: HADOOP-199
         URL: http://issues.apache.org/jira/browse/HADOOP-199
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.3    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Minor


I'm running with the svn head from Friday and my patch for hadoop-180 and
I'm not getting progress updates until reduces finish. I'm worried that it
may be related to my changes for hadoop-182. I'll track it down, but I
wanted to let everyone know.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira



From MAILER-DAEMON Mon May  8 04:35:05 2006
Return-Path: 
 <hadoop-dev-return-1303-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26010 invoked from network); 8 May 2006 04:35:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 04:35:05 -0000
Received: (qmail 83505 invoked by uid 500); 8 May 2006 04:35:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83379 invoked by uid 500); 8 May 2006 04:35:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83370 invoked by uid 99); 8 May 2006 04:35:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 21:35:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 21:35:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D3ADF7142D0
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 04:34:23 +0000 (GMT)
Message-ID: <20085044.1147062863862.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 04:34:23 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-195) transfer map output transfer with http
 instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-195?page=all ]

Owen O'Malley updated HADOOP-195:
---------------------------------

    Attachment: netstat.log

Here are two dumps of "netstat -ees" taken ~5 hours apart on one of the worker nodes during reduce.  Let me know if you see anything interesting.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 05:39:03 2006
Return-Path: 
 <hadoop-dev-return-1304-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46807 invoked from network); 8 May 2006 05:39:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 05:39:03 -0000
Received: (qmail 33783 invoked by uid 500); 8 May 2006 05:39:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33762 invoked by uid 500); 8 May 2006 05:39:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33753 invoked by uid 99); 8 May 2006 05:39:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 22:39:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 22:39:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CABC7142D0
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 05:38:22 +0000 (GMT)
Message-ID: <8931675.1147066702573.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 05:38:22 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-199) reduce copy progress not updating
In-Reply-To: <25410254.1146972500935.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-199?page=all ]

Owen O'Malley updated HADOOP-199:
---------------------------------

    Attachment: fix-reduce-progress.patch

Good catch, Mahadev. Here is the patch.

> reduce copy progress not updating
> ---------------------------------
>
>          Key: HADOOP-199
>          URL: http://issues.apache.org/jira/browse/HADOOP-199
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>  Attachments: fix-reduce-progress.patch
>
> I'm running with the svn head from Friday and my patch for hadoop-180 and I'm not getting progress updates until reduces finish. I'm worried that it may be related to my changes for hadoop-182. I'll track it down, but I wanted to let everyone know.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 05:41:02 2006
Return-Path: 
 <hadoop-dev-return-1305-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47271 invoked from network); 8 May 2006 05:41:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 05:41:02 -0000
Received: (qmail 34914 invoked by uid 500); 8 May 2006 05:41:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34891 invoked by uid 500); 8 May 2006 05:41:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34882 invoked by uid 99); 8 May 2006 05:41:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 22:41:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 07 May 2006 22:41:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 98C397142D0
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 05:40:21 +0000 (GMT)
Message-ID: <5027790.1147066821622.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 05:40:21 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-199) reduce copy progress not updating
In-Reply-To: <25410254.1146972500935.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-199?page=all ]

Owen O'Malley updated HADOOP-199:
---------------------------------

    Fix Version: 0.2
        Version: 0.2
                     (was: 0.3)

> reduce copy progress not updating
> ---------------------------------
>
>          Key: HADOOP-199
>          URL: http://issues.apache.org/jira/browse/HADOOP-199
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: fix-reduce-progress.patch
>
> I'm running with the svn head from Friday and my patch for hadoop-180 and I'm not getting progress updates until reduces finish. I'm worried that it may be related to my changes for hadoop-182. I'll track it down, but I wanted to let everyone know.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 11:23:24 2006
Return-Path: 
 <hadoop-dev-return-1306-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4882 invoked from network); 8 May 2006 11:23:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 11:23:24 -0000
Received: (qmail 79709 invoked by uid 500); 8 May 2006 11:23:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79686 invoked by uid 500); 8 May 2006 11:23:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79675 invoked by uid 99); 8 May 2006 11:23:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 04:23:01 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 04:23:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E549D7142A4
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 11:22:20 +0000 (GMT)
Message-ID: <18968481.1147087340936.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 11:22:20 +0000 (GMT+00:00)
From: "Johan Oskarson (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-201) hadoop dfs -report throws exception
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

hadoop dfs -report throws exception
-----------------------------------

         Key: HADOOP-201
         URL: http://issues.apache.org/jira/browse/HADOOP-201
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.2    
 Environment: linux, jdk 1.5
    Reporter: Johan Oskarson
    Priority: Minor


Running hadoop dfs -report throws the lovely exception below.
Changing org.apache.hadoop.dfs.DatanodeInfo back to being a public class solves the problem.


~/hadoop$ bin/hadoop dfs -report
060508 104801 parsing file:/home/hadoop/hadoop/conf/hadoop-default.xml
060508 104801 parsing file:/home/hadoop/hadoop/conf/hadoop-site.xml
060508 104801 No FS indicated, using default:xxx:9000
060508 104801 Client connection to 10.0.0.12:9000: starting
Total raw bytes: 2763338170368 (2573.55 Gb)
Used raw bytes: 1548564473694 (1442.21 Gb)
% used: 56.03%

Total effective bytes: 145953744375 (135.93 Gb)
Effective replication multiplier: 10.609967427182013
-------------------------------------------------
060508 104801 Client connection to 10.0.0.12:9000 caught: java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.DatanodeInfo with modifiers "public"
java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.DatanodeInfo with modifiers "public"
        at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
        at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:226)
        at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:163)
        at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:211)
        at org.apache.hadoop.io.ObjectWritable.readFields(ObjectWritable.java:60)
        at org.apache.hadoop.ipc.Client$Connection.run(Client.java:170)
Caused by: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.DatanodeInfo with modifiers "public"
        at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:65)
        at java.lang.Class.newInstance0(Class.java:344)
        at java.lang.Class.newInstance(Class.java:303)
        at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:45)
        ... 5 more
060508 104801 Client connection to 10.0.0.12:9000: closing


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 13:33:06 2006
Return-Path: 
 <hadoop-dev-return-1307-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90733 invoked from network); 8 May 2006 13:33:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 13:33:06 -0000
Received: (qmail 9558 invoked by uid 500); 8 May 2006 13:33:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9528 invoked by uid 500); 8 May 2006 13:33:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9518 invoked by uid 99); 8 May 2006 13:33:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 06:33:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 06:33:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A1D10410009
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 13:32:21 +0000 (GMT)
Message-ID: <15147971.1147095141660.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 13:32:21 +0000 (GMT+00:00)
From: "Dominik Friedrich (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378420 ] 

Dominik Friedrich commented on HADOOP-195:
------------------------------------------

paul,

i agree, the less you copy the data the better (faster). But moving data in RAM is a few orders of magnitude faster then disk writes (factor 1000-10000 or so). So when optimizing one should start to reduce the slowest operations as much as possible and that are disk IO and network IO. 

I had a short look at the sorter implementation in SequenceFile.java. If I understood the code correctly the sorter reads as big chunks as possible from the input file, sort them in-memory and writes the sorted chunk to a temp file. When the whole input file has been sorted to several sorted chunk files one or more merge runs are started that merge those chuck files to one sorted file which has the complete input file sorted in total order. Before you got the final sorted file the mapper writes a temp file, the sorter reads it and writes several sorted temp files and finaly you run one or more merge phases that have to read those sorted chunks and write the final sorted output.

I'd split the whole sorting. The mapper output collector does not have to write one big output file, it could also write several pre sorted chunks like the sort phase in the current sorter does. The merging phase can be done on the fly when transfering the sorted map output to the reducers. This way you only have to write a few sorted chunks (the number depends on the buffer size of the output collector and the temp data size produced by the mapper). This reduces disk IO and also disk space needed for temp data.

Another possible optimization could be the creation of index files when you've small keys and large values. The collector would dump the values in one big file and put the keys along with the index of the value in sorted index chunks like before. When merging the partial sorted output on the fly while transfering keys and values are joined together again.

I'm not sure if I've the time to implement this and run performance comparisons against the current implementation, but I think this could speed up the sorting quite a lot.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 17:21:04 2006
Return-Path: 
 <hadoop-dev-return-1309-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34870 invoked from network); 8 May 2006 17:21:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 17:21:04 -0000
Received: (qmail 81856 invoked by uid 500); 8 May 2006 17:21:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81824 invoked by uid 500); 8 May 2006 17:21:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81815 invoked by uid 99); 8 May 2006 17:21:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 10:21:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 10:21:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A42AC41000C
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 17:20:21 +0000 (GMT)
Message-ID: <16708881.1147108821669.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 17:20:21 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-195) transfer map output transfer with http
 instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-195?page=all ]

paul sutter updated HADOOP-195:
-------------------------------

    Attachment: netstat.xls


owen,

i took a look at the netstat, and nothing jumped out at me, but i'll show this to a couple other people to see what they think.

i'm posting an excel spreadsheet with the before, after, and delta numbers in columns

paul

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 18:15:10 2006
Return-Path: 
 <hadoop-dev-return-1310-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67599 invoked from network); 8 May 2006 18:15:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 18:15:10 -0000
Received: (qmail 92225 invoked by uid 500); 8 May 2006 18:15:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91826 invoked by uid 500); 8 May 2006 18:15:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91810 invoked by uid 99); 8 May 2006 18:15:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 11:15:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 11:15:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A2EB171428F
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 18:14:21 +0000 (GMT)
Message-ID: <29132904.1147112061664.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 18:14:21 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-199) reduce copy progress not updating
In-Reply-To: <25410254.1146972500935.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-199?page=all ]
     
Doug Cutting resolved HADOOP-199:
---------------------------------

    Fix Version: 0.2.1
                     (was: 0.2)
     Resolution: Fixed

I just committed this.  It probably warrants a 0.2.1 release, so I've earmarked it that way, for Friday.

> reduce copy progress not updating
> ---------------------------------
>
>          Key: HADOOP-199
>          URL: http://issues.apache.org/jira/browse/HADOOP-199
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.2.1
>  Attachments: fix-reduce-progress.patch
>
> I'm running with the svn head from Friday and my patch for hadoop-180 and I'm not getting progress updates until reduces finish. I'm worried that it may be related to my changes for hadoop-182. I'll track it down, but I wanted to let everyone know.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 18:17:03 2006
Return-Path: 
 <hadoop-dev-return-1311-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68736 invoked from network); 8 May 2006 18:17:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 18:17:03 -0000
Received: (qmail 94614 invoked by uid 500); 8 May 2006 18:17:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94590 invoked by uid 500); 8 May 2006 18:17:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94581 invoked by uid 99); 8 May 2006 18:17:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 11:17:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 11:17:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C6CE571428F
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 18:16:21 +0000 (GMT)
Message-ID: <23837962.1147112181811.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 18:16:21 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-200) The map task names are sent to the
 reduces
In-Reply-To: <13737024.1146974120921.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-200?page=comments#action_12378484 ] 

Doug Cutting commented on HADOOP-200:
-------------------------------------

+1 this sounds good to me.

> The map task names are sent to the reduces
> ------------------------------------------
>
>          Key: HADOOP-200
>          URL: http://issues.apache.org/jira/browse/HADOOP-200
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> As each reduce is created, it is given the entire set of potential map names. For my large sort jobs with 64k maps, this means that each reduce task is given a two dimensional array that is 5 tasks/map * 64k maps = 320k strings. Since the reduce task is passed from the job tracker to the task tracker and down to the task runner, passing the entire list is very expensive. I suspect that this is the cause of the slow downs that I see in the task trackers heart beats when the reduce tasks are being launched.
> I propose that the ReduceTask be changed to just get the count of maps, with ids from 0 .. maps -1.
>   public ReduceTask(String jobFile, String taskId, int maps, int partition);
> Then we need to change the protocol for finding map outputs:
>   MapOutputLocation[] locateMapOutputs(String jobId, int[] mapIds, int partition);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 18:25:04 2006
Return-Path: 
 <hadoop-dev-return-1312-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72211 invoked from network); 8 May 2006 18:25:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 18:25:04 -0000
Received: (qmail 4840 invoked by uid 500); 8 May 2006 18:25:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4706 invoked by uid 500); 8 May 2006 18:25:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4690 invoked by uid 99); 8 May 2006 18:25:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 11:25:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 11:25:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9505C41000B
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 18:24:21 +0000 (GMT)
Message-ID: <28473037.1147112661607.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 18:24:21 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-201) hadoop dfs -report throws exception
In-Reply-To: <18968481.1147087340936.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-201?page=all ]
     
Doug Cutting resolved HADOOP-201:
---------------------------------

    Fix Version: 0.2.1
     Resolution: Fixed
      Assign To: Doug Cutting

I just committed a fix for this.  It will be in the 0.2.1 bugfix release later this week.

> hadoop dfs -report throws exception
> -----------------------------------
>
>          Key: HADOOP-201
>          URL: http://issues.apache.org/jira/browse/HADOOP-201
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: linux, jdk 1.5
>     Reporter: Johan Oskarson
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.2.1

>
> Running hadoop dfs -report throws the lovely exception below.
> Changing org.apache.hadoop.dfs.DatanodeInfo back to being a public class solves the problem.
> ~/hadoop$ bin/hadoop dfs -report
> 060508 104801 parsing file:/home/hadoop/hadoop/conf/hadoop-default.xml
> 060508 104801 parsing file:/home/hadoop/hadoop/conf/hadoop-site.xml
> 060508 104801 No FS indicated, using default:xxx:9000
> 060508 104801 Client connection to 10.0.0.12:9000: starting
> Total raw bytes: 2763338170368 (2573.55 Gb)
> Used raw bytes: 1548564473694 (1442.21 Gb)
> % used: 56.03%
> Total effective bytes: 145953744375 (135.93 Gb)
> Effective replication multiplier: 10.609967427182013
> -------------------------------------------------
> 060508 104801 Client connection to 10.0.0.12:9000 caught: java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.DatanodeInfo with modifiers "public"
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.DatanodeInfo with modifiers "public"
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:226)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:163)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:211)
>         at org.apache.hadoop.io.ObjectWritable.readFields(ObjectWritable.java:60)
>         at org.apache.hadoop.ipc.Client$Connection.run(Client.java:170)
> Caused by: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.DatanodeInfo with modifiers "public"
>         at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:65)
>         at java.lang.Class.newInstance0(Class.java:344)
>         at java.lang.Class.newInstance(Class.java:303)
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:45)
>         ... 5 more
> 060508 104801 Client connection to 10.0.0.12:9000: closing

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 18:58:03 2006
Return-Path: 
 <hadoop-dev-return-1313-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88127 invoked from network); 8 May 2006 18:58:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 18:58:03 -0000
Received: (qmail 66634 invoked by uid 500); 8 May 2006 18:58:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66509 invoked by uid 500); 8 May 2006 18:58:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66500 invoked by uid 99); 8 May 2006 18:58:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 11:58:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 11:58:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 32A9E410009
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 18:57:21 +0000 (GMT)
Message-ID: <10378926.1147114641189.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 18:57:21 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-136?page=comments#action_12378493 ] 

Doug Cutting commented on HADOOP-136:
-------------------------------------

I think we should aim for 100% back-compatibility.  Perhaps if the 16th bit is set, and the next byte is invalid UTF-8 (e.g., a null) then we can assume the fourth byte is part of the length, otherwise the third and fourth are payload data.  That would permit up to 2^23 bytes.  In a subsequent release we could drop this "feature", permitting up to 2^31 bytes.  Could something like that work?


> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor

>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 22:22:08 2006
Return-Path: 
 <hadoop-dev-return-1314-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7452 invoked from network); 8 May 2006 22:22:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 22:22:08 -0000
Received: (qmail 46702 invoked by uid 500); 8 May 2006 22:22:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46623 invoked by uid 500); 8 May 2006 22:22:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46607 invoked by uid 99); 8 May 2006 22:22:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 15:22:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 15:22:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A467B410007
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 22:21:21 +0000 (GMT)
Message-ID: <11267606.1147126881670.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 22:21:21 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-200) The map task names are sent to the
 reduces
In-Reply-To: <13737024.1146974120921.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-200?page=all ]

Owen O'Malley updated HADOOP-200:
---------------------------------

    Attachment: map-id.patch

Here is the patch. It does dramatically lower the slugishness when the reduces are launching.

> The map task names are sent to the reduces
> ------------------------------------------
>
>          Key: HADOOP-200
>          URL: http://issues.apache.org/jira/browse/HADOOP-200
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: map-id.patch
>
> As each reduce is created, it is given the entire set of potential map names. For my large sort jobs with 64k maps, this means that each reduce task is given a two dimensional array that is 5 tasks/map * 64k maps = 320k strings. Since the reduce task is passed from the job tracker to the task tracker and down to the task runner, passing the entire list is very expensive. I suspect that this is the cause of the slow downs that I see in the task trackers heart beats when the reduce tasks are being launched.
> I propose that the ReduceTask be changed to just get the count of maps, with ids from 0 .. maps -1.
>   public ReduceTask(String jobFile, String taskId, int maps, int partition);
> Then we need to change the protocol for finding map outputs:
>   MapOutputLocation[] locateMapOutputs(String jobId, int[] mapIds, int partition);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 22:29:03 2006
Return-Path: 
 <hadoop-dev-return-1315-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9332 invoked from network); 8 May 2006 22:29:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 22:29:03 -0000
Received: (qmail 53536 invoked by uid 500); 8 May 2006 22:29:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53513 invoked by uid 500); 8 May 2006 22:29:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53501 invoked by uid 99); 8 May 2006 22:29:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 15:29:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 15:29:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E7E72410007
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 22:28:20 +0000 (GMT)
Message-ID: <9539530.1147127300947.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 22:28:20 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-202) sort should use a smaller number of
 reduces
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

sort should use a smaller number of reduces
-------------------------------------------

         Key: HADOOP-202
         URL: http://issues.apache.org/jira/browse/HADOOP-202
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Trivial
     Fix For: 0.3


We should see better performance with fewer reduces. I'll change the default number of reduces to be equal to the capacity of the cluster.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 22:31:03 2006
Return-Path: 
 <hadoop-dev-return-1316-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9862 invoked from network); 8 May 2006 22:31:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 22:31:03 -0000
Received: (qmail 54352 invoked by uid 500); 8 May 2006 22:31:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54225 invoked by uid 500); 8 May 2006 22:31:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54216 invoked by uid 99); 8 May 2006 22:31:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 15:31:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 15:31:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A0AA9410007
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 22:30:21 +0000 (GMT)
Message-ID: <16705243.1147127421655.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 22:30:21 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-202) sort should use a smaller number of
 reduces
In-Reply-To: <9539530.1147127300947.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-202?page=all ]

Owen O'Malley updated HADOOP-202:
---------------------------------

    Attachment: sort-default-reduces.patch

> sort should use a smaller number of reduces
> -------------------------------------------
>
>          Key: HADOOP-202
>          URL: http://issues.apache.org/jira/browse/HADOOP-202
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Trivial
>      Fix For: 0.3
>  Attachments: sort-default-reduces.patch
>
> We should see better performance with fewer reduces. I'll change the default number of reduces to be equal to the capacity of the cluster.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 22:41:03 2006
Return-Path: 
 <hadoop-dev-return-1317-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14785 invoked from network); 8 May 2006 22:41:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 22:41:03 -0000
Received: (qmail 73695 invoked by uid 500); 8 May 2006 22:41:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73677 invoked by uid 500); 8 May 2006 22:41:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73668 invoked by uid 99); 8 May 2006 22:41:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 15:41:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 15:41:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D6ED6410005
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 22:40:20 +0000 (GMT)
Message-ID: <13879069.1147128020850.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 22:40:20 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-203) remove deprecated java.io.File methods
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

remove deprecated java.io.File methods
--------------------------------------

         Key: HADOOP-203
         URL: http://issues.apache.org/jira/browse/HADOOP-203
     Project: Hadoop
        Type: Improvement

  Components: fs  
    Reporter: Doug Cutting
 Assigned to: Doug Cutting 
    Priority: Minor
     Fix For: 0.3


Now that the 0.2 release is out, we should remove the deprecated FileSystem methods that use java.io.File, since using org.apache.hadoop.fs.Path is less error-prone.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May  8 23:15:04 2006
Return-Path: 
 <hadoop-dev-return-1318-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32920 invoked from network); 8 May 2006 23:15:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 May 2006 23:15:04 -0000
Received: (qmail 18020 invoked by uid 500); 8 May 2006 23:15:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17991 invoked by uid 500); 8 May 2006 23:15:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17982 invoked by uid 99); 8 May 2006 23:15:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 16:15:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 16:15:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1484B410005
	for <hadoop-dev@lucene.apache.org>; Mon,  8 May 2006 23:14:22 +0000 (GMT)
Message-ID: <11246405.1147130062080.JavaMail.jira@brutus>
Date: Mon, 8 May 2006 23:14:22 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12378532 ] 

alan wootton commented on HADOOP-90:
------------------------------------


Since we have virtually no 'metadata' for a file we could have a complete description of the filesystem by adding a couple of fields to org.apache.hadoop.dfs.Block and then have the DataNodes write small block info files to the same directory as the actual block data.

I actually did this one day as an experiment.

class Block ...

    long blkid;
    long len;
    UTF8 path;// the full path name of this block in the NameNode  
    long position;// the starting position of this block in the file  

The NameNode can recover it's state by just waiting for the DataNodes to report the blocks they have.

The ugly part is what happens during a directory rename. Every DataNode needs to know that the blocks have changed and then re-write it. It could be a LOT of blocks.

One adds this (below) to FSNamesystem:

   //
    // Keeps a Vector for every named machine.  The Vector contains
    // blocks that have recently been part of a rename and are thought to live
    // on the machine in question.
    //
    TreeMap recentRenameSets = new TreeMap();

Then NameNode.getBlockWork has this code at it's beginning:

        // check to see of there are blocks that need to be renamed.
        //
        Block blocks[] = namesystem.blocksToRename(new UTF8(sender));
        if (blocks != null) {
        	BlockCommand cmd = new BlockCommand(blocks);
        	cmd.setRenameBlocks();
        	return cmd;
        }

I don't think I'm formally proposing this scheme, but I'd like to talk about it before I go off half cocked and write the wrong thing.

We are very concerned here about losing our DFS if something ever happens to the NameNode. I have the assignment to fix it, somehow, in the next couple of weeks.


> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon

>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 01:15:10 2006
Return-Path: 
 <hadoop-dev-return-1319-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91066 invoked from network); 9 May 2006 01:15:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 01:15:10 -0000
Received: (qmail 47137 invoked by uid 500); 9 May 2006 01:15:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46936 invoked by uid 500); 9 May 2006 01:15:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46675 invoked by uid 99); 9 May 2006 01:15:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 18:15:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 18:15:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3F21E7142CD
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 01:14:21 +0000 (GMT)
Message-ID: <16802388.1147137261240.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 01:14:21 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-136?page=comments#action_12378549 ] 

Michel Tourn commented on HADOOP-136:
-------------------------------------

OK, given the need for 100% backward-compatibility and given that I will only use this format internally:
I will go with Sameer's suggestion: 
have a separate class org.apache.hadoop.io.LargeUTF8.java

I will just make its length field 4-bytes, rather than var-length:
Otherwise this would complicate things like the ad-hoc offset computations in UTF8.Comparator.


Should I make a TestLargeUTF8 based on TestUTF8?

---

Concerning 4-bytes-long UTF-8 characters:
it seems that this situation does not occur in "Java-modified-UTF8"

The 4-byte chars are represented as 3+3.
See Modified UTF-8 in:
http://java.sun.com/developer/technicalArticles/Intl/Supplementary/



> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor

>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 01:17:05 2006
Return-Path: 
 <hadoop-dev-return-1320-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 92106 invoked from network); 9 May 2006 01:17:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 01:17:05 -0000
Received: (qmail 49890 invoked by uid 500); 9 May 2006 01:17:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49863 invoked by uid 500); 9 May 2006 01:17:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49854 invoked by uid 99); 9 May 2006 01:17:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 18:17:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 18:17:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 056617142CD
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 01:16:22 +0000 (GMT)
Message-ID: <21040745.1147137382019.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 01:16:22 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12378550 ] 

Konstantin Shvachko commented on HADOOP-124:
--------------------------------------------

There is a problem with shutting down the old datanode when the new one starts.
The new datanode must be sure the old one is gone before taking over.

I think a datanode should merely keep a FileLock in the dfs.data.dir while it is running.
In this case the new node will not be able to start with the same data directory.
Is that the problem we are trying to solve here?


> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 05:18:05 2006
Return-Path: 
 <hadoop-dev-return-1321-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86249 invoked from network); 9 May 2006 05:18:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 05:18:05 -0000
Received: (qmail 18490 invoked by uid 500); 9 May 2006 05:18:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18447 invoked by uid 500); 9 May 2006 05:18:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18435 invoked by uid 99); 9 May 2006 05:18:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 22:18:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 08 May 2006 22:18:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1724E7142CE
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 05:17:22 +0000 (GMT)
Message-ID: <4932776.1147151842092.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 05:17:22 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12378570 ] 

eric baldeschwieler commented on HADOOP-124:
--------------------------------------------

I believe we have three problems to address:

1) The namenode needs to know to purge old entries identical entries when a new datanode registers.  Else we get rot.  See doug's suggestions above.

2) You could have 2 or more datanodes on one server.  They need to always be unique.  We should asign a unique ID to each datanode home directory and make sure the datanode is started with a valid home directory as well.  I like the idea of assigning a uniqueID to each datanode home.

3) You concern that two daemons might run on the same datadir.

We should address all these concerns.  Your suggestion of a startup lock and a uniqueID, plus (hello method) should together handle all of these.


> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 16:54:49 2006
Return-Path: 
 <hadoop-dev-return-1322-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91035 invoked from network); 9 May 2006 16:54:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 16:54:49 -0000
Received: (qmail 75111 invoked by uid 500); 9 May 2006 16:54:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75072 invoked by uid 500); 9 May 2006 16:54:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75063 invoked by uid 99); 9 May 2006 16:54:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 09:54:47 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 09:54:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3BD567142D9
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 16:54:05 +0000 (GMT)
Message-ID: <5574853.1147193645242.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 16:54:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378655 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

Since there is obviously interest in my benchmark, here is an update:

I reran my sort test yesterday with:
   1. fewer reduces (2/node) (hadoop-202)
   2. the map ids replaced with integers (hadoop-200)
   3. the number of server threads for map output serving set to 20

I sorted 1760 gig of data on 179 nodes in 18.6 hours, which is much better than before.

I had 20 reduce tasks fail and reexecute themselves (last original reduce finished in ~16.5 hours)

2 of those tasks were assigned to the same node and were the only two tasks running for the last hour, which clearly shows that we need speculative reduces.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 17:41:52 2006
Return-Path: 
 <hadoop-dev-return-1323-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20880 invoked from network); 9 May 2006 17:41:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 17:41:52 -0000
Received: (qmail 85953 invoked by uid 500); 9 May 2006 17:41:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85842 invoked by uid 500); 9 May 2006 17:41:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85801 invoked by uid 99); 9 May 2006 17:41:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 10:41:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 10:41:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 46E46410007
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 17:41:05 +0000 (GMT)
Message-ID: <30707194.1147196465287.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 17:41:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378670 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

btw, here is the timeline:

060508 145202 Running job: job_0002
060508 145203  map 0%  reduce 0%
060508 145316  map 1%  reduce 0%
060508 145435  map 2%  reduce 0%
060508 145553  map 3%  reduce 0%
060508 145704  map 4%  reduce 0%
060508 145822  map 5%  reduce 0%
060508 145934  map 6%  reduce 0%
060508 150045  map 7%  reduce 0%
060508 150203  map 8%  reduce 0%
060508 150323  map 9%  reduce 0%
060508 150435  map 10%  reduce 0%
060508 150551  map 11%  reduce 0%
060508 150704  map 12%  reduce 0%
060508 150824  map 13%  reduce 0%
060508 150942  map 14%  reduce 0%
060508 151055  map 15%  reduce 0%
060508 151211  map 16%  reduce 0%
060508 151326  map 17%  reduce 0%
060508 151446  map 18%  reduce 0%
060508 151606  map 19%  reduce 0%
060508 151731  map 20%  reduce 0%
060508 151847  map 21%  reduce 0%
060508 152006  map 22%  reduce 0%
060508 152127  map 23%  reduce 0%
060508 152246  map 24%  reduce 0%
060508 152407  map 25%  reduce 0%
060508 152526  map 26%  reduce 0%
060508 152645  map 27%  reduce 0%
060508 152806  map 28%  reduce 0%
060508 152926  map 29%  reduce 0%
060508 153054  map 30%  reduce 0%
060508 153112  map 30%  reduce 1%
060508 153214  map 31%  reduce 1%
060508 153336  map 32%  reduce 1%
060508 153457  map 33%  reduce 1%
060508 153616  map 34%  reduce 1%
060508 153736  map 35%  reduce 1%
060508 153903  map 36%  reduce 1%
060508 154023  map 37%  reduce 1%
060508 154143  map 38%  reduce 1%
060508 154303  map 39%  reduce 1%
060508 154424  map 40%  reduce 1%
060508 154544  map 41%  reduce 1%
060508 154705  map 42%  reduce 1%
060508 154825  map 43%  reduce 1%
060508 154944  map 44%  reduce 1%
060508 155104  map 45%  reduce 1%
060508 155223  map 46%  reduce 1%
060508 155345  map 47%  reduce 1%
060508 155505  map 48%  reduce 1%
060508 155624  map 49%  reduce 1%
060508 155745  map 50%  reduce 1%
060508 155906  map 51%  reduce 1%
060508 160027  map 52%  reduce 1%
060508 160146  map 53%  reduce 1%
060508 160305  map 54%  reduce 1%
060508 160427  map 55%  reduce 1%
060508 160546  map 56%  reduce 1%
060508 160712  map 57%  reduce 1%
060508 160833  map 58%  reduce 1%
060508 160953  map 59%  reduce 1%
060508 161102  map 59%  reduce 2%
060508 161115  map 60%  reduce 2%
060508 161236  map 61%  reduce 2%
060508 161403  map 62%  reduce 2%
060508 161523  map 63%  reduce 2%
060508 161642  map 64%  reduce 2%
060508 161804  map 65%  reduce 2%
060508 161925  map 66%  reduce 2%
060508 162044  map 67%  reduce 2%
060508 162203  map 68%  reduce 2%
060508 162323  map 69%  reduce 2%
060508 162445  map 70%  reduce 2%
060508 162607  map 71%  reduce 2%
060508 162725  map 72%  reduce 2%
060508 162844  map 73%  reduce 2%
060508 163005  map 74%  reduce 2%
060508 163124  map 75%  reduce 2%
060508 163246  map 76%  reduce 2%
060508 163406  map 77%  reduce 2%
060508 163527  map 78%  reduce 2%
060508 163646  map 79%  reduce 2%
060508 163814  map 80%  reduce 2%
060508 163936  map 81%  reduce 2%
060508 164055  map 82%  reduce 2%
060508 164215  map 83%  reduce 2%
060508 164336  map 84%  reduce 2%
060508 164456  map 85%  reduce 2%
060508 164617  map 86%  reduce 2%
060508 164736  map 87%  reduce 2%
060508 164857  map 88%  reduce 2%
060508 165017  map 89%  reduce 2%
060508 165144  map 90%  reduce 2%
060508 165303  map 91%  reduce 2%
060508 165355  map 91%  reduce 3%
060508 165424  map 92%  reduce 3%
060508 165544  map 93%  reduce 3%
060508 165704  map 94%  reduce 3%
060508 165825  map 95%  reduce 3%
060508 165947  map 96%  reduce 3%
060508 170106  map 97%  reduce 3%
060508 170224  map 98%  reduce 3%
060508 170336  map 99%  reduce 3%
060508 170454  map 100%  reduce 3%
060508 171720  map 100%  reduce 4%
060508 173342  map 100%  reduce 5%
060508 175008  map 100%  reduce 6%
060508 180613  map 100%  reduce 7%
060508 182222  map 100%  reduce 8%
060508 183822  map 100%  reduce 9%
060508 185446  map 100%  reduce 10%
060508 191056  map 100%  reduce 11%
060508 192715  map 100%  reduce 12%
060508 194330  map 100%  reduce 13%
060508 195923  map 100%  reduce 14%
060508 201521  map 100%  reduce 15%
060508 203111  map 100%  reduce 16%
060508 204638  map 100%  reduce 17%
060508 210211  map 100%  reduce 18%
060508 211742  map 100%  reduce 19%
060508 213258  map 100%  reduce 20%
060508 214824  map 100%  reduce 21%
060508 220344  map 100%  reduce 22%
060508 221856  map 100%  reduce 23%
060508 223424  map 100%  reduce 24%
060508 224715  map 100%  reduce 25%
060508 225618  map 100%  reduce 26%
060508 230309  map 100%  reduce 27%
060508 230842  map 100%  reduce 28%
060508 231336  map 100%  reduce 29%
060508 231800  map 100%  reduce 30%
060508 232215  map 100%  reduce 31%
060508 232613  map 100%  reduce 32%
060508 233012  map 100%  reduce 33%
060508 233410  map 100%  reduce 34%
060508 233806  map 100%  reduce 35%
060508 234202  map 100%  reduce 36%
060508 234557  map 100%  reduce 37%
060508 234948  map 100%  reduce 38%
060508 235344  map 100%  reduce 39%
060508 235744  map 100%  reduce 40%
060509 000132  map 100%  reduce 41%
060509 000533  map 100%  reduce 42%
060509 000932  map 100%  reduce 43%
060509 001347  map 100%  reduce 44%
060509 001822  map 100%  reduce 45%
060509 002355  map 100%  reduce 46%
060509 003007  map 100%  reduce 47%
060509 003723  map 100%  reduce 48%
060509 004651  map 100%  reduce 49%
060509 010213  map 100%  reduce 50%
060509 011506  map 100%  reduce 51%
060509 012217  map 100%  reduce 52%
060509 012730  map 100%  reduce 53%
060509 013027  map 100%  reduce 54%
060509 013259  map 100%  reduce 55%
060509 013606  map 100%  reduce 56%
060509 013913  map 100%  reduce 57%
060509 014153  map 100%  reduce 58%
060509 014350  map 100%  reduce 59%
060509 014557  map 100%  reduce 60%
060509 014854  map 100%  reduce 61%
060509 015056  map 100%  reduce 62%
060509 015356  map 100%  reduce 63%
060509 015638  map 100%  reduce 64%
060509 015947  map 100%  reduce 65%
060509 020204  map 100%  reduce 66%
060509 020543  map 100%  reduce 67%
060509 020728  map 100%  reduce 68%
060509 021001  map 100%  reduce 69%
060509 021200  map 100%  reduce 70%
060509 021330  map 100%  reduce 71%
060509 021502  map 100%  reduce 72%
060509 021703  map 100%  reduce 73%
060509 022007  map 100%  reduce 74%
060509 022301  map 100%  reduce 75%
060509 022609  map 100%  reduce 76%
060509 022940  map 100%  reduce 77%
060509 023324  map 100%  reduce 78%
060509 023642  map 100%  reduce 77%
060509 023723  map 100%  reduce 76%
060509 023746  map 100%  reduce 77%
060509 023800  map 100%  reduce 76%
060509 023820  map 100%  reduce 77%
060509 024342  map 100%  reduce 78%
060509 024559  map 100%  reduce 77%
060509 024602  map 100%  reduce 78%
060509 024845  map 100%  reduce 79%
060509 025201  map 100%  reduce 80%
060509 025453  map 99%  reduce 80%
060509 025523  map 100%  reduce 80%
060509 025645  map 100%  reduce 81%
060509 030103  map 100%  reduce 82%
060509 030454  map 100%  reduce 83%
060509 030844  map 100%  reduce 84%
060509 031401  map 100%  reduce 85%
060509 031924  map 100%  reduce 86%
060509 032352  map 100%  reduce 87%
060509 032927  map 100%  reduce 88%
060509 033737  map 100%  reduce 89%
060509 034300  map 100%  reduce 90%
060509 035312  map 100%  reduce 91%
060509 040142  map 100%  reduce 92%
060509 041755  map 100%  reduce 93%
060509 043246  map 100%  reduce 94%
060509 050725  map 100%  reduce 95%
060509 060826  map 100%  reduce 96%
060509 065234  map 100%  reduce 97%
060509 074655  map 100%  reduce 98%
060509 075706  map 100%  reduce 99%
060509 081125  map 100%  reduce 100%
060509 092825 Job complete: job_0002
Job ended: Tue May 09 09:28:25 PDT 2006
The job took 66983 seconds.


> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 18:40:49 2006
Return-Path: 
 <hadoop-dev-return-1324-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50603 invoked from network); 9 May 2006 18:40:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 18:40:49 -0000
Received: (qmail 3941 invoked by uid 500); 9 May 2006 18:40:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3815 invoked by uid 500); 9 May 2006 18:40:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3805 invoked by uid 99); 9 May 2006 18:40:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 11:40:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 11:40:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4A2137142CB
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 18:40:05 +0000 (GMT)
Message-ID: <15754126.1147200005300.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 18:40:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378685 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

As to why we lost the 20 reduces, here is the breakdown:

no progress update to task tracker for 20 min: 11
rpc timeout on progress: 4
lost task tracker (no heartbeat to job tracker for 10 min): 3
exit 65 (caused by ping failures): 4

one task had exit 65 and lost task tracker
one task had exit 65 and no progress update

so it task tracker latency is still a big concern.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 19:25:49 2006
Return-Path: 
 <hadoop-dev-return-1325-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82721 invoked from network); 9 May 2006 19:25:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 19:25:49 -0000
Received: (qmail 90974 invoked by uid 500); 9 May 2006 19:25:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90942 invoked by uid 500); 9 May 2006 19:25:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90931 invoked by uid 99); 9 May 2006 19:25:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 12:25:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 12:25:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3EC647142D9
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 19:25:05 +0000 (GMT)
Message-ID: <7669647.1147202705253.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 19:25:05 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378703 ] 

paul sutter commented on HADOOP-195:
------------------------------------


Owen,

Are you still using 64,000 mappers? If so, wouldnt your average map output file size be around 80KB?

I'd suggest doing a /= 10 or /=50 on those mappers. 

If you had 1880 mappers and 376 reducers, your map output files would be 2.8MB each, which might be better then 80KB.

You might try 1800 mappers and 350 reducers, so that you have spare capacity on your nodes for failed mappers or reducers (giving you 3MB map output files).

Has anyone measured the map-task creation overhead? Does anyone know the file creation/deletion overhead on Linux? Each of those little files is created, written, read, and deleted twice in the currnet code, and each time as that tiny filesize).

Paul

Paul

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 19:53:16 2006
Return-Path: 
 <hadoop-dev-return-1326-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96987 invoked from network); 9 May 2006 19:53:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 19:53:16 -0000
Received: (qmail 35127 invoked by uid 500); 9 May 2006 19:52:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35002 invoked by uid 500); 9 May 2006 19:52:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34993 invoked by uid 99); 9 May 2006 19:52:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 12:52:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 12:52:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 33ADD410007
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 19:52:05 +0000 (GMT)
Message-ID: <14976407.1147204325208.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 19:52:05 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378715 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

> Are you still using 64,000 mappers? If so, wouldnt your average map output file size be around 80KB?

Yes.  But this comes from having a map task per input file block, which permits map tasks to be placed on nodes where their data is local.  Simply reducing the number of map tasks will defeat that important optimization.  Better to instead increase the dfs block size to 128m, as Eric suggested.  This would increase the map outputs to 340k (with 376 reducers).  But, once we move to a larger cluster, with 1000 or more reducers, then the map outputs will again become small.  So optimizing for small map outputs will remain important, even as we increase the dfs block size.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 19:59:54 2006
Return-Path: 
 <hadoop-dev-return-1327-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 562 invoked from network); 9 May 2006 19:59:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 19:59:54 -0000
Received: (qmail 51088 invoked by uid 500); 9 May 2006 19:59:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51065 invoked by uid 500); 9 May 2006 19:59:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51056 invoked by uid 99); 9 May 2006 19:59:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 12:59:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 12:59:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 442C041000E
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 19:59:10 +0000 (GMT)
Message-ID: <14816169.1147204750276.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 19:59:10 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378719 ] 

paul sutter commented on HADOOP-195:
------------------------------------


Fantastic! I wasnt aware of that optimization.

- Has the map task creation overhead been measured?
- Why not go to gigabyte blocks? 

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 20:03:52 2006
Return-Path: 
 <hadoop-dev-return-1328-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 2597 invoked from network); 9 May 2006 20:03:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 20:03:52 -0000
Received: (qmail 64404 invoked by uid 500); 9 May 2006 20:03:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64353 invoked by uid 500); 9 May 2006 20:03:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64225 invoked by uid 99); 9 May 2006 20:03:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 13:03:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 13:03:48 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C11EF410009
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 20:03:05 +0000 (GMT)
Message-ID: <22942249.1147204985788.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 20:03:05 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-204) Need to tweak a few things in the
 metrics package to support the Simon plugin
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Need to tweak a few things in the metrics package to support the Simon plugin
-----------------------------------------------------------------------------

         Key: HADOOP-204
         URL: http://issues.apache.org/jira/browse/HADOOP-204
     Project: Hadoop
        Type: Improvement

  Components: metrics  
    Reporter: David Bowen
 Assigned to: David Bowen 


(1) added an extra metrics.jar target to the build.xml so that I can build a stand-alone library containing only the
metrics package and its subpackages.

(2) added serialversionUIDs to a bunch of classes to make Eclipse happy

(3) made AbstractMetricsContext.createRecord final, and added a protected newRecord that subclasses can use
to customize record creation without breaking the parent class.

(4) minor fix to how errors in callbacks are handled

(5) constructor in MetricsRecordImpl made protected rather than package private so that it can be subclassed

(6) extended Util.parse(String serverSpecs, int defaultPort) to handle the case of a null serverSpecs by defaulting to localhost



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 20:11:49 2006
Return-Path: 
 <hadoop-dev-return-1329-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7320 invoked from network); 9 May 2006 20:11:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 20:11:49 -0000
Received: (qmail 95845 invoked by uid 500); 9 May 2006 20:11:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 95822 invoked by uid 500); 9 May 2006 20:11:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 95811 invoked by uid 99); 9 May 2006 20:11:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 13:11:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 13:11:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 33B957142D8
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 20:11:05 +0000 (GMT)
Message-ID: <26072274.1147205465209.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 20:11:05 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-204) Need to tweak a few things in the
 metrics package to support the Simon plugin
In-Reply-To: <22942249.1147204985788.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-204?page=all ]

David Bowen updated HADOOP-204:
-------------------------------

    Attachment: tweaks.patch

> Need to tweak a few things in the metrics package to support the Simon plugin
> -----------------------------------------------------------------------------
>
>          Key: HADOOP-204
>          URL: http://issues.apache.org/jira/browse/HADOOP-204
>      Project: Hadoop
>         Type: Improvement

>   Components: metrics
>     Reporter: David Bowen
>     Assignee: David Bowen
>  Attachments: tweaks.patch
>
> (1) added an extra metrics.jar target to the build.xml so that I can build a stand-alone library containing only the
> metrics package and its subpackages.
> (2) added serialversionUIDs to a bunch of classes to make Eclipse happy
> (3) made AbstractMetricsContext.createRecord final, and added a protected newRecord that subclasses can use
> to customize record creation without breaking the parent class.
> (4) minor fix to how errors in callbacks are handled
> (5) constructor in MetricsRecordImpl made protected rather than package private so that it can be subclassed
> (6) extended Util.parse(String serverSpecs, int defaultPort) to handle the case of a null serverSpecs by defaulting to localhost

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 20:58:48 2006
Return-Path: 
 <hadoop-dev-return-1330-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34304 invoked from network); 9 May 2006 20:58:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 20:58:48 -0000
Received: (qmail 92634 invoked by uid 500); 9 May 2006 20:58:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92616 invoked by uid 500); 9 May 2006 20:58:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92604 invoked by uid 99); 9 May 2006 20:58:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 13:58:47 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 13:58:46 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 868D67142D5
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 20:58:04 +0000 (GMT)
Message-ID: <10031675.1147208284547.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 20:58:04 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-205) the job tracker does not schedule
 enough map on the cluster
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

the job tracker does not schedule enough map on the cluster
-----------------------------------------------------------

         Key: HADOOP-205
         URL: http://issues.apache.org/jira/browse/HADOOP-205
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.4


The job tracker during my big sort runs only has 80-120 maps running at a time with 2 tasks/node and 179 nodes and a large queue of map tasks. It seems to be caused by the load balancing using the current load rather than the required load to run all of the queued tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 22:43:49 2006
Return-Path: 
 <hadoop-dev-return-1331-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81032 invoked from network); 9 May 2006 22:43:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 22:43:49 -0000
Received: (qmail 43179 invoked by uid 500); 9 May 2006 22:43:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43049 invoked by uid 500); 9 May 2006 22:43:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43040 invoked by uid 99); 9 May 2006 22:43:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 15:43:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 15:43:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 360E87142CD
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 22:43:05 +0000 (GMT)
Message-ID: <21241645.1147214585218.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 22:43:05 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378768 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

By "map task creation" do you mean task startup costs?  We have not yet explicitly measured that, but it does involve starting a JVM.  Currently the shuffle is still the slowest step, and until that changes, that's where the attention is.

Gigabyte blocks could prove useful.  We have not yet experimented much with larger sized blocks.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 23:13:48 2006
Return-Path: 
 <hadoop-dev-return-1332-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 92907 invoked from network); 9 May 2006 23:13:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 23:13:48 -0000
Received: (qmail 68008 invoked by uid 500); 9 May 2006 23:13:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67989 invoked by uid 500); 9 May 2006 23:13:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67977 invoked by uid 99); 9 May 2006 23:13:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 16:13:47 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 16:13:46 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 786717142D2
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 23:13:04 +0000 (GMT)
Message-ID: <9977634.1147216384490.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 23:13:04 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-206) local map-reduce job limited to single
 reducer
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

local map-reduce job limited to single reducer
----------------------------------------------

         Key: HADOOP-206
         URL: http://issues.apache.org/jira/browse/HADOOP-206
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.1.0, 0.2, 0.1.1    
 Environment: local job tracker
    Reporter: Yoram Arnon
    Priority: Minor


when mapred.job.tracker is set to 'local', my setNumReduceTasks call is ignored, and the number of reduce tasks is set at 1.
This prevents me from locally debugging my partition function, which tries to partition based on the number of reduce tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May  9 23:55:21 2006
Return-Path: 
 <hadoop-dev-return-1333-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9222 invoked from network); 9 May 2006 23:55:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 May 2006 23:55:21 -0000
Received: (qmail 15390 invoked by uid 500); 9 May 2006 23:55:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15368 invoked by uid 500); 9 May 2006 23:55:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15358 invoked by uid 99); 9 May 2006 23:55:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 16:55:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 16:55:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7A6AD71421C
	for <hadoop-dev@lucene.apache.org>; Tue,  9 May 2006 23:54:04 +0000 (GMT)
Message-ID: <7275763.1147218844498.JavaMail.jira@brutus>
Date: Tue, 9 May 2006 23:54:04 +0000 (GMT+00:00)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Patch to HADOOP-96 uses long deprecated call
--------------------------------------------

         Key: HADOOP-207
         URL: http://issues.apache.org/jira/browse/HADOOP-207
     Project: Hadoop
        Type: Bug

    Reporter: Bryan Pendleton
    Priority: Critical


System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 10 00:21:01 2006
Return-Path: 
 <hadoop-dev-return-1334-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18226 invoked from network); 10 May 2006 00:21:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 May 2006 00:21:01 -0000
Received: (qmail 37251 invoked by uid 500); 10 May 2006 00:20:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37190 invoked by uid 500); 10 May 2006 00:20:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37094 invoked by uid 99); 10 May 2006 00:20:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 17:20:50 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 17:20:48 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C17DF41000B
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 00:20:05 +0000 (GMT)
Message-ID: <13967600.1147220405788.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 00:20:05 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12378787 ] 

Konstantin Shvachko commented on HADOOP-124:
--------------------------------------------

I see exactly 2 problems now.
1) Two datanodes can be started sharing the same data directory, and reporting the same blocks twice.
I'm planning to solve this by placing a lock in the data dir.
2) Starting a replacement datanode.
If a datanode fails, or intentionally shut down, the new datanode
server can be started on the same node and port or on a different node or port,
but connected to the same data directory.
In current implementation if the new datanode starts before the namenode removed the old datanode from
its list identical block will be considered belonging to both nodes, and consequently over-replicated.
To solve this second problem the datanode should store a unique id per data directory as proposed.
And the namenode should identify block reports by those ids (only!), rather than by hostname:port.
Each datanode reporting the same id (no matter which hostname or port it has) should be considered
a replacement to the old node, and the old datanode at this point should be removed from the namenode
the same way it is removed when its hearbeats are not reaching the namenode for 10 minutes.

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 10 03:52:51 2006
Return-Path: 
 <hadoop-dev-return-1335-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12524 invoked from network); 10 May 2006 03:52:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 May 2006 03:52:51 -0000
Received: (qmail 40433 invoked by uid 500); 10 May 2006 03:52:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40382 invoked by uid 500); 10 May 2006 03:52:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40361 invoked by uid 99); 10 May 2006 03:52:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 20:52:50 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 09 May 2006 20:52:49 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AA6B341000F
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 03:52:06 +0000 (GMT)
Message-ID: <5979869.1147233126695.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 03:52:06 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12378816 ] 

eric baldeschwieler commented on HADOOP-124:
--------------------------------------------

+1

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3

>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 10 09:01:51 2006
Return-Path: 
 <hadoop-dev-return-1336-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60767 invoked from network); 10 May 2006 09:01:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 May 2006 09:01:51 -0000
Received: (qmail 32249 invoked by uid 500); 10 May 2006 09:01:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32218 invoked by uid 500); 10 May 2006 09:01:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32209 invoked by uid 99); 10 May 2006 09:01:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 02:01:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 02:01:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CBAF671429D
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 09:01:04 +0000 (GMT)
Message-ID: <920097.1147251664816.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 09:01:04 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-24?page=all ]

Gal Nitzan updated HADOOP-24:
-----------------------------

    Attachment: HADOOP-24.patch

Hi,

I have implemented the configuration interface.

Remarks would be appreciated.

Gal.

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 10 10:08:59 2006
Return-Path: 
 <hadoop-dev-return-1337-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95759 invoked from network); 10 May 2006 10:08:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 May 2006 10:08:59 -0000
Received: (qmail 4253 invoked by uid 500); 10 May 2006 10:08:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4112 invoked by uid 500); 10 May 2006 10:08:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4058 invoked by uid 99); 10 May 2006 10:08:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 03:08:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 03:08:48 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CA5A571429F
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 10:08:04 +0000 (GMT)
Message-ID: <30666142.1147255684799.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 10:08:04 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-24?page=all ]

Gal Nitzan updated HADOOP-24:
-----------------------------

    Attachment: HADOOP-24.patch

Fix previous patch. Forgot to add the actual files :)

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 10 15:17:34 2006
Return-Path: 
 <hadoop-dev-return-1338-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14210 invoked from network); 10 May 2006 15:17:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 May 2006 15:17:34 -0000
Received: (qmail 33343 invoked by uid 500); 10 May 2006 14:17:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33323 invoked by uid 500); 10 May 2006 14:17:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33314 invoked by uid 99); 10 May 2006 14:17:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 07:17:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 07:17:48 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 341A37141F6
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 14:17:05 +0000 (GMT)
Message-ID: <23598219.1147270625210.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 14:17:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378927 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

Ok, last night's run with the parallel fetches (upto 5 at a time) finished in 14.13 hours. The input data and cluster were the same as monday's run.

None of the reduces failed, which helped.

After I take the kids to school and get into the office, I'll take a closer look at the logs.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 05:25:00 2006
Return-Path: 
 <hadoop-dev-return-1339-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4073 invoked from network); 11 May 2006 05:25:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 05:25:00 -0000
Received: (qmail 96519 invoked by uid 500); 10 May 2006 20:06:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96492 invoked by uid 500); 10 May 2006 20:06:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96483 invoked by uid 99); 10 May 2006 20:06:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 13:06:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 13:06:48 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C25127142B6
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 20:06:04 +0000 (GMT)
Message-ID: <3229953.1147291564784.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 20:06:04 +0000 (GMT+00:00)
From: "David Bowen (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12378968 ] 

David Bowen commented on HADOOP-24:
-----------------------------------


The code contains getObject and setObject methods.  Is this a good idea - considering that it means that the ConfigurationImpl cannot be written out and read back without losing those values?  I think it would be better to remove these and maintain the ability to serialize and deserialize.  (Is there a reason not to have Configuration extend Writable?)

What is a use case for ConfigurationBase.getProperties() which returns an object of unknown type?  It might be better to have something like String[] getPropertyNames(String regex).  (And this should be in Configuration also.)  This allows for things like treating the property name space as a hierarchy, so that e.g. you can find all the properties beginning with some string.

- David




> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 05:27:51 2006
Return-Path: 
 <hadoop-dev-return-1340-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12870 invoked from network); 11 May 2006 05:27:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 05:27:51 -0000
Received: (qmail 90114 invoked by uid 500); 10 May 2006 20:27:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90080 invoked by uid 500); 10 May 2006 20:27:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90071 invoked by uid 99); 10 May 2006 20:27:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 13:27:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 13:27:49 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 583BD7142BA
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 20:27:05 +0000 (GMT)
Message-ID: <10527104.1147292825357.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 20:27:05 +0000 (GMT+00:00)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12378972 ] 

Andrzej Bialecki  commented on HADOOP-24:
-----------------------------------------

In Nutch in many places we create objects with a "pseudo-singleton" semantics (i.e. one per task), that are costly to create. These methods were added to provide a convenient caching mechanism to carry around these objects within the same task. They don't have to be serialized/deserialized.

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 04:53:31 2006
Return-Path: 
 <hadoop-dev-return-1341-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57265 invoked from network); 11 May 2006 04:53:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 04:53:31 -0000
Received: (qmail 12599 invoked by uid 500); 10 May 2006 21:46:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12574 invoked by uid 500); 10 May 2006 21:46:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12565 invoked by uid 99); 10 May 2006 21:46:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 14:46:50 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 14:46:49 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A20BE7142C1
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 21:46:05 +0000 (GMT)
Message-ID: <4662258.1147297565652.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 21:46:05 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12378979 ] 

Gal Nitzan commented on HADOOP-24:
----------------------------------

Since this is my first interaction with Hadoop code "on a first name basis" :) I didn't want to rock the boat too much.

My first goal was to implement the interfaces and the implementation with as little as possible major changes all arround the code. As it is now all test are still working and nothing broken.

So if the patch would "pass" the reviews it would be easier to make additions when all blocks are in place.

getPropertyNames is good idea to add as an interface to configuration.

Thanks.

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 05:40:37 2006
Return-Path: 
 <hadoop-dev-return-1342-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53281 invoked from network); 11 May 2006 05:40:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 05:40:37 -0000
Received: (qmail 70059 invoked by uid 500); 10 May 2006 22:33:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69858 invoked by uid 500); 10 May 2006 22:33:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69453 invoked by uid 99); 10 May 2006 22:33:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 15:33:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 15:33:48 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7D3137142BA
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 22:33:04 +0000 (GMT)
Message-ID: <25090401.1147300384509.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 22:33:04 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-208) add failure page to webapp
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

add failure page to webapp
--------------------------

         Key: HADOOP-208
         URL: http://issues.apache.org/jira/browse/HADOOP-208
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3


I'd like a webapp page that just lists the failures in a job so that I can find them more easily. I also want to put back the job detail page.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 05:44:45 2006
Return-Path: 
 <hadoop-dev-return-1343-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70384 invoked from network); 11 May 2006 05:44:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 05:44:45 -0000
Received: (qmail 76721 invoked by uid 500); 10 May 2006 22:37:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76590 invoked by uid 500); 10 May 2006 22:37:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76506 invoked by uid 99); 10 May 2006 22:37:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 15:37:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 15:37:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F3FD941000B
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 22:37:06 +0000 (GMT)
Message-ID: <33446039.1147300626996.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 22:37:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-208) add failure page to webapp
In-Reply-To: <25090401.1147300384509.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-208?page=all ]

Owen O'Malley updated HADOOP-208:
---------------------------------

    Attachment: failure-list.patch

This patch:
   1. pulls the task tracker list off the root page and puts it on its own page
   2. creates a job failure page that lists the task attempts that have failed
   3. puts back a generic job page that covers both map and reduce

> add failure page to webapp
> --------------------------
>
>          Key: HADOOP-208
>          URL: http://issues.apache.org/jira/browse/HADOOP-208
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: failure-list.patch
>
> I'd like a webapp page that just lists the failures in a job so that I can find them more easily. I also want to put back the job detail page.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 06:12:53 2006
Return-Path: 
 <hadoop-dev-return-1344-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55995 invoked from network); 11 May 2006 06:12:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 06:12:53 -0000
Received: (qmail 5568 invoked by uid 500); 10 May 2006 23:00:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5341 invoked by uid 500); 10 May 2006 23:00:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5199 invoked by uid 99); 10 May 2006 23:00:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 16:00:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 16:00:49 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3782C7141F8
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 23:00:05 +0000 (GMT)
Message-ID: <31662047.1147302005224.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 23:00:05 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12378992 ] 

paul sutter commented on HADOOP-195:
------------------------------------


Owen,

A couple of small ideas:

- Could you fit the tempfiles in a RAM disk? This would just be a hack to determine whether the disk physics of small files are a factor here, both on the mapper end and the reducer end. Note that you need 2X the space on the reducer end, because it keeps two copies of the data around in small-file-form. 

- If small files are shown to be a problem (as I am guessing), and (as Doug suggests) we want to optimize for that case, perhaps the best thing to do would be to send the map output data directly to the reducer, and have the reducers write them to disk in some log structured format, maintaining a list of segments that were abandoned mid-stream and are to be ignored in the processing step. This way you'd have all sequential disk access

Thanks. Sorry for the volume of responses here, but its an area of great interest to us.

Paul

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 06:13:30 2006
Return-Path: 
 <hadoop-dev-return-1345-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57141 invoked from network); 11 May 2006 06:13:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 06:13:30 -0000
Received: (qmail 58414 invoked by uid 500); 10 May 2006 23:06:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58396 invoked by uid 500); 10 May 2006 23:06:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58387 invoked by uid 99); 10 May 2006 23:06:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 16:06:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 16:06:48 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8180D7142BA
	for <hadoop-dev@lucene.apache.org>; Wed, 10 May 2006 23:06:04 +0000 (GMT)
Message-ID: <25124034.1147302364527.JavaMail.jira@brutus>
Date: Wed, 10 May 2006 23:06:04 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-209) Add a program to recursively copy
 directories across file systems
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Add a program to recursively copy directories across file systems
-----------------------------------------------------------------

         Key: HADOOP-209
         URL: http://issues.apache.org/jira/browse/HADOOP-209
     Project: Hadoop
        Type: New Feature

  Components: fs  
    Versions: 0.3    
 Environment: All
    Reporter: Milind Bhandarkar


A useful feature would be a simple command to copy directories recursively across filesystems. The source and destination path should be specified using a filesystem-neutral URI, such as:

hadoop cp dfs://namenode1:port1/path/to/srcdir file:///path/to/local/destination/dir

"cp" command would invoke a map-reduce program to copy files recursively.

I willl attach a patch as soon as svn is up and running.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 05:37:33 2006
Return-Path: 
 <hadoop-dev-return-1346-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41380 invoked from network); 11 May 2006 05:37:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 05:37:33 -0000
Received: (qmail 86988 invoked by uid 500); 11 May 2006 00:10:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86722 invoked by uid 500); 11 May 2006 00:10:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86693 invoked by uid 99); 11 May 2006 00:10:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 17:10:50 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 17:10:49 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ADC1A7142C1
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 00:10:05 +0000 (GMT)
Message-ID: <22832248.1147306205708.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 00:10:05 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-210) Namenode not able to accept
 connections
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Namenode not able to accept connections
---------------------------------------

         Key: HADOOP-210
         URL: http://issues.apache.org/jira/browse/HADOOP-210
     Project: Hadoop
        Type: Bug

  Components: dfs  
 Environment: linux
    Reporter: Mahadev konar
 Assigned to: Mahadev konar 


I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:

Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
        at java.lang.Thread.start0(Native Method)
        at java.lang.Thread.start(Thread.java:574)
        at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)

After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
java.net.SocketTimeoutException: timed out waiting for rpc response
	at org.apache.hadoop.ipc.Client.call(Client.java:305)
	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).


The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 05:36:33 2006
Return-Path: 
 <hadoop-dev-return-1347-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36932 invoked from network); 11 May 2006 05:36:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 05:36:33 -0000
Received: (qmail 83462 invoked by uid 500); 11 May 2006 02:49:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83430 invoked by uid 500); 11 May 2006 02:49:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83404 invoked by uid 99); 11 May 2006 02:49:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 19:49:50 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 10 May 2006 19:49:49 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 383577142BA
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 02:49:05 +0000 (GMT)
Message-ID: <10476740.1147315745227.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 02:49:05 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12379001 ] 

eric baldeschwieler commented on HADOOP-195:
--------------------------------------------

The problem with such approaches is that they add a lot of complexity and break down in some cases.  They are particularly challenged by node failures and graceful handling of those is a key requirement to scaling up.  I think we have a lot of good optimizations we can do without changing the model.  We should do those first and gain some experience operating them before radically departing from it.

Can you give us some data on the workload challenges you are facing?  In our current benchmark we are not to a place where these issues are the logical ones to tackle.  Maybe you could publish an alternate that expresses the demands of your workload?


> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 07:09:06 2006
Return-Path: 
 <hadoop-dev-return-1348-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30056 invoked from network); 11 May 2006 07:09:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 07:09:06 -0000
Received: (qmail 87382 invoked by uid 500); 11 May 2006 07:09:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87351 invoked by uid 500); 11 May 2006 07:09:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87341 invoked by uid 99); 11 May 2006 07:09:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 00:09:05 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of toelen@gmail.com designates
 64.233.182.185 as permitted sender)
Received: from [64.233.182.185] (HELO nf-out-0910.google.com) (64.233.182.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 00:09:03 -0700
Received: by nf-out-0910.google.com with SMTP id o60so86965nfa
        for <hadoop-dev@lucene.apache.org>;
 Thu, 11 May 2006 00:08:42 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=jdN/K8jlEQo0rFrLEwxrnqz8ActPh4dBD7MmHhQooyoEBicJxONnSF3ajbnz/gVcYcuz/RozXIsNgzHmNJrJ/8SmPkhnrZQBFpiet2K2FmYWRAzUwyjXMAqdeEiS+GDS6NzcZ7cPoSBt8NYe0aZTT3e8OutWdOwr20E2dPgrBmo=
Received: by 10.48.4.19 with SMTP id 19mr284080nfd;
        Thu, 11 May 2006 00:08:42 -0700 (PDT)
Received: by 10.49.51.10 with HTTP; Thu, 11 May 2006 00:08:42 -0700 (PDT)
Message-ID: <a494a0bc0605110008v5ffb008dkdc781f4ae24e5f87@mail.gmail.com>
Date: Thu, 11 May 2006 09:08:42 +0200
From: "Leen Toelen" <toelen@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: BigTable
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

are there any plans to create a structured data storage system like
Google's BigTable in Hadoop? Their implementation relies heavily on
mapreduce and gfs, so Hadoop is an ideal match. BigTable is what
drives google base, earth and news for instance.

http://blog.outer-court.com/archive/2005-10-23-n61.html

Regards,
Leen Toelen

From MAILER-DAEMON Thu May 11 07:20:35 2006
Return-Path: 
 <hadoop-dev-return-1349-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36431 invoked from network); 11 May 2006 07:20:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 07:20:35 -0000
Received: (qmail 98036 invoked by uid 500); 11 May 2006 07:20:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97935 invoked by uid 500); 11 May 2006 07:20:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97926 invoked by uid 99); 11 May 2006 07:20:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 00:20:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 00:20:33 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 2DA741445F8
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 09:01:33 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 32169-04 for <hadoop-dev@lucene.apache.org>;
	Thu, 11 May 2006 09:01:33 +0200 (CEST)
Received: from [10.10.16.254] (unknown [64.71.164.125])
	by mslinux.media-style.com (Postfix) with ESMTP id 5D1EA1445EE
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 09:01:32 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <a494a0bc0605110008v5ffb008dkdc781f4ae24e5f87@mail.gmail.com>
References: <a494a0bc0605110008v5ffb008dkdc781f4ae24e5f87@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <56DE3FAE-8E3A-490E-BAF7-4973C479BAAD@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: BigTable
Date: Thu, 11 May 2006 00:20:02 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
I'm already have some very basic code but it does not work yet,  
however it is part of a project and I plan to publish  it somehow.
But I can not imaging that it will find the way to the hadoop svn  
once. However it uses  hadoop rcp, dfs and writables.
Stefan

Am 11.05.2006 um 00:08 schrieb Leen Toelen:

> Hi,
>
> are there any plans to create a structured data storage system like
> Google's BigTable in Hadoop? Their implementation relies heavily on
> mapreduce and gfs, so Hadoop is an ideal match. BigTable is what
> drives google base, earth and news for instance.
>
> http://blog.outer-court.com/archive/2005-10-23-n61.html
>
> Regards,
> Leen Toelen
>


From MAILER-DAEMON Thu May 11 07:32:56 2006
Return-Path: 
 <hadoop-dev-return-1350-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43526 invoked from network); 11 May 2006 07:32:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 07:32:56 -0000
Received: (qmail 12153 invoked by uid 500); 11 May 2006 07:32:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12118 invoked by uid 500); 11 May 2006 07:32:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12009 invoked by uid 99); 11 May 2006 07:32:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 00:32:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 00:32:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 65302410009
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 07:32:07 +0000 (GMT)
Message-ID: <936088.1147332727411.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 07:32:07 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-195) transfer map output transfer with http
 instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-195?page=all ]

Owen O'Malley updated HADOOP-195:
---------------------------------

    Attachment: data-transfer-chart.pdf

Here is a chart of the data transfers from Monday's run (blue) and Tuesday's run (red). The parallel fetches seem help most in the early part of the curve. You can also see the substantial rework that was caused by losing the tasks on Monday.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: data-transfer-chart.pdf, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 10:28:52 2006
Return-Path: 
 <hadoop-dev-return-1351-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 5213 invoked from network); 11 May 2006 10:28:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 10:28:52 -0000
Received: (qmail 74300 invoked by uid 500); 11 May 2006 10:28:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74278 invoked by uid 500); 11 May 2006 10:28:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74269 invoked by uid 99); 11 May 2006 10:28:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 03:28:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 03:28:50 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CDA197141F6
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 10:28:05 +0000 (GMT)
Message-ID: <25397237.1147343285839.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 10:28:05 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-24?page=all ]

Gal Nitzan updated HADOOP-24:
-----------------------------

    Attachment: HADOOP-24-2.patch

Added some missing interfaces

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 12:16:44 2006
Return-Path: 
 <hadoop-dev-return-1352-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35697 invoked from network); 11 May 2006 12:16:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 12:16:44 -0000
Received: (qmail 27737 invoked by uid 500); 11 May 2006 12:16:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27609 invoked by uid 500); 11 May 2006 12:16:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27589 invoked by uid 99); 11 May 2006 12:16:43 -0000
X-ASF-Spam-Status: No, hits=-10.0 required=10.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 05:16:43 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C15F9410009
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 12:15:04 +0000 (GMT)
Message-ID: <19332210.1147349704789.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 12:15:04 +0000 (GMT+00:00)
From: "Johan Oskarson (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-27) MapRed tries to allocate tasks to
 nodes that have no available disk space
In-Reply-To: <1424617142.1139335680270.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-27?page=comments#action_12379064 ] 

Johan Oskarson commented on HADOOP-27:
--------------------------------------

I just ran into this problem, but the machine did actually have space available.
However, it was on another disk set in dfs.data.dir. So the first disk is full and the second one
almost empty. Would it not make sense to just continue putting the map output to the second disk?

> MapRed tries to allocate tasks to nodes that have no available disk space
> -------------------------------------------------------------------------
>
>          Key: HADOOP-27
>          URL: http://issues.apache.org/jira/browse/HADOOP-27
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mike Cafarella

>
>   What it says above.  MapRed TaskTrackers should not offer task service if the local disk
> space is too constrained.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 14:30:58 2006
Return-Path: 
 <hadoop-dev-return-1353-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3684 invoked from network); 11 May 2006 14:30:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 14:30:58 -0000
Received: (qmail 62730 invoked by uid 500); 11 May 2006 14:30:57 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62710 invoked by uid 500); 11 May 2006 14:30:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62701 invoked by uid 99); 11 May 2006 14:30:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 07:30:57 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 07:30:56 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CD2F7142AD
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 14:30:10 +0000 (GMT)
Message-ID: <26955844.1147357810574.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 14:30:10 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-24?page=all ]

Gal Nitzan updated HADOOP-24:
-----------------------------

    Attachment: HADOOP-24-3.patch

Last minute changes :(

Had to move getObject setObject to ConfigurationImpl

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 15:45:53 2006
Return-Path: 
 <hadoop-dev-return-1354-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34355 invoked from network); 11 May 2006 15:45:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 15:45:53 -0000
Received: (qmail 99178 invoked by uid 500); 11 May 2006 15:45:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99154 invoked by uid 500); 11 May 2006 15:45:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99139 invoked by uid 99); 11 May 2006 15:45:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 08:45:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 08:45:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ABCD341000B
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 15:45:06 +0000 (GMT)
Message-ID: <13526858.1147362306700.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 15:45:06 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12379089 ] 

paul sutter commented on HADOOP-195:
------------------------------------


Owen,

Lovely chart, thanks for posting it. 

Are you sure that the big valley in sequential mode was the re-execution of tasks?? if not, that looks really promising area for further measurement to see what else is going on at that time.

It is interesting that parallel sessions dont seem to increase the transfer rate by much. Either approach gets 50-60k files/minute, which means about 1000 files a second, which is only about 5 files received per second per node, or 10 files per second total per node (in+out).

Does this suggest that the bottleneck is not TCP or anything in the network, since parallel sessions should absorb these type of issues??

If so, the problem must be somewhere else, possibly disk or RPC code. Admittedly, 10 files per second processed by a node is so feeble that it seems hard to imagine it is a spindle problem, but  keeping an open mind:

- Are you using a single spindle for your temporary files, or are you spreading them across all the available spindles on each node? Example:

<property>
  <name>mapred.local.dir</name>
<value>/data/tmp/hadoop/mapred/local,/data1/tmp/hadoop/mapred/local,/data2/tmp/mapred/local,/data3/tmp/mapred/local</value>
  <description>The local directory where MapReduce stores intermediate
  data files.  May be a space- or comma- separated list of
  directories on different devices in order to spread disk i/o.
  </description>
</property>

- Another way to test whether spindle contention is the issue would be to use a RAM disk for the temporary files. Yes its a silly thing to do, but it would be a way to test the question if you have enough RAM.


> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: data-transfer-chart.pdf, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 16:03:53 2006
Return-Path: 
 <hadoop-dev-return-1355-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40745 invoked from network); 11 May 2006 16:03:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 16:03:53 -0000
Received: (qmail 34391 invoked by uid 500); 11 May 2006 16:03:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34377 invoked by uid 500); 11 May 2006 16:03:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34367 invoked by uid 99); 11 May 2006 16:03:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 09:03:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 09:03:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C8EA2714204
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 16:03:05 +0000 (GMT)
Message-ID: <6830004.1147363385820.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 16:03:05 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12379092 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

Everything we're now seeing is consistent with the inter-rack switches being the primary bottleneck.  With 188 nodes sharing a 1Gb/s backbone, there's only 600KB/s per node.  We're seeing 10 80kB files transferred per second, or 800kB/second, slightly higher, since some files are already on the same rack.

Instead of caching temp files in RAM we can instead try to transfer files soon after they are generated and to process them on the remote end soon after they are recieved.  That way we can benefit from the kernel's cache, getting performance similar to what we'd see if we cached them ourselves.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: data-transfer-chart.pdf, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 16:11:26 2006
Return-Path: 
 <hadoop-dev-return-1356-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42253 invoked from network); 11 May 2006 16:11:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 16:11:26 -0000
Received: (qmail 50188 invoked by uid 500); 11 May 2006 16:11:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50153 invoked by uid 500); 11 May 2006 16:11:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49983 invoked by uid 99); 11 May 2006 16:11:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 09:11:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [64.202.165.199] (HELO
 smtpout04-04.prod.mesa1.secureserver.net) (64.202.165.199)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 11 May 2006 09:11:17 -0700
Received: (qmail 18049 invoked from network); 11 May 2006 16:10:53 -0000
Received: from unknown (71.140.53.217)
  by smtpout04-04.prod.mesa1.secureserver.net (64.202.165.199) with ESMTP;
 11 May 2006 16:10:53 -0000
From: "Paul Sutter" <psutter@quantcast.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
Date: Thu, 11 May 2006 09:11:21 -0700
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook, Build 11.0.6353
In-Reply-To: <6830004.1147363385820.JavaMail.jira@brutus>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
thread-index: AcZ1FH/EafRg2x6NSdmRuSNxdXj7gAAAJt2A
X-Virus-Checked: Checked by ClamAV on apache.org
Message-Id: <20060511161118.1F04010FB012@asf.osuosl.org>
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


I assumed it was on one big switch. Sounds like an easy theory to test, and
even easier to fix. 

How hard is it to monitor traffic levels on the switch cross-connects?

-----Original Message-----
From: Doug Cutting (JIRA) [mailto:jira@apache.org] 
Sent: Thursday, May 11, 2006 9:03 AM
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
http instead of rpc

    [
http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_1237909
2 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

Everything we're now seeing is consistent with the inter-rack switches being
the primary bottleneck.  With 188 nodes sharing a 1Gb/s backbone, there's
only 600KB/s per node.  We're seeing 10 80kB files transferred per second,
or 800kB/second, slightly higher, since some files are already on the same
rack.

Instead of caching temp files in RAM we can instead try to transfer files
soon after they are generated and to process them on the remote end soon
after they are recieved.  That way we can benefit from the kernel's cache,
getting performance similar to what we'd see if we cached them ourselves.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: data-transfer-chart.pdf, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead
rpc, because rpc is very slow for this application and the timeout behavior
is suboptimal. (server sends data and client ignores it because it took more
than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira



From MAILER-DAEMON Thu May 11 16:41:54 2006
Return-Path: 
 <hadoop-dev-return-1357-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51026 invoked from network); 11 May 2006 16:41:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 16:41:54 -0000
Received: (qmail 8655 invoked by uid 500); 11 May 2006 16:41:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8639 invoked by uid 500); 11 May 2006 16:41:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8630 invoked by uid 99); 11 May 2006 16:41:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 09:41:53 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 09:41:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1ABC841000B
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 16:41:07 +0000 (GMT)
Message-ID: <31229467.1147365667106.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 16:41:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12379098 ] 

Doug Cutting commented on HADOOP-210:
-------------------------------------

I'd guess you're out of file handles or threads (both which can appear as OutOfMemoryError).  Each DFS client JVM and each datanode keeps a connection open to the namenode with a corresponding thread.  The number of threads per process in some older kernels was limited, but more recent kernels have mostly removed that limit, and the scheduler now also supports large numbers of threads effectively.  But you may need to change some limits.  Use 'ulimit -n' to see how many file handles you are permitted, and increase that to at least 4x the number of nodes in your cluster.  You may need to change some kernel options to increase the number of threads:

http://www.kegel.com/c10k.html#limits.threads

You can monitor the number of open file handles with 'lsof', and the number of threads with 'ps'.

I spent some time trying to get Hadoop's IPC to use non-blocking IO a while back (and hence far fewer threads).  The problem is that, since IPC requests include objects, we cannot start processing a request until we've recieved the complete request, and requests can be bigger than a single packet.  Moreover, the end of one request and the beginning of the next can be combined in a packet.  So it's easy to accumulate buffers for many connections using just a single thread, the problem is knowing when a buffer has a complete request that should be dispatched to a worker thread.  So we'd need to length-prefix requests, or break them into length-prefixed chunks.  This may be required for effective operation of very large clusters, or perhaps Linux kernel threads are now up to the task.  We'll soon see.


> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 16:48:52 2006
Return-Path: 
 <hadoop-dev-return-1358-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57017 invoked from network); 11 May 2006 16:48:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 16:48:52 -0000
Received: (qmail 22575 invoked by uid 500); 11 May 2006 16:48:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22553 invoked by uid 500); 11 May 2006 16:48:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22544 invoked by uid 99); 11 May 2006 16:48:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 09:48:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 09:48:50 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4991641000B
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 16:48:05 +0000 (GMT)
Message-ID: <14271634.1147366085291.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 16:48:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-208) add failure page to webapp
In-Reply-To: <25090401.1147300384509.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-208?page=comments#action_12379101 ] 

Owen O'Malley commented on HADOOP-208:
--------------------------------------

Don't commit this one yet, I messed up the links for the next/prev. I'll generate a new patch.

> add failure page to webapp
> --------------------------
>
>          Key: HADOOP-208
>          URL: http://issues.apache.org/jira/browse/HADOOP-208
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: failure-list.patch
>
> I'd like a webapp page that just lists the failures in a job so that I can find them more easily. I also want to put back the job detail page.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 17:15:52 2006
Return-Path: 
 <hadoop-dev-return-1359-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85353 invoked from network); 11 May 2006 17:15:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 17:15:52 -0000
Received: (qmail 26499 invoked by uid 500); 11 May 2006 17:15:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26472 invoked by uid 500); 11 May 2006 17:15:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26462 invoked by uid 99); 11 May 2006 17:15:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 10:15:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 10:15:50 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3304A41000B
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 17:15:05 +0000 (GMT)
Message-ID: <1384405.1147367705206.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 17:15:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12379107 ] 

Owen O'Malley commented on HADOOP-210:
--------------------------------------

The file handles are fine at 32768.
The kernel is 2.6.9, so it should be fine too.

The problem seems to be that the default thread stack size is 512k, which is more than a gig of stack for his 2036 threads. Mahadev is going to take the stack size on the Listener threads down to 128k, which should take the pressure off.

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 18:07:57 2006
Return-Path: 
 <hadoop-dev-return-1360-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78209 invoked from network); 11 May 2006 18:07:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 18:07:57 -0000
Received: (qmail 36233 invoked by uid 500); 11 May 2006 18:07:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36188 invoked by uid 500); 11 May 2006 18:07:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36139 invoked by uid 99); 11 May 2006 18:07:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:07:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:07:52 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 25F887141F3
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 18:07:07 +0000 (GMT)
Message-ID: <1449939.1147370827152.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 18:07:07 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12379117 ] 

Runping Qi commented on HADOOP-210:
-----------------------------------


Reducing stack size may relieve the problem temporally, but will not solve the problem completely.
It seems to me that the problem is due to the fact that a thread is created per RPC connection. A better solution is to use a thread pool and a connection queue. This way, it is easier to manage the resource limits.



> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 18:18:03 2006
Return-Path: 
 <hadoop-dev-return-1361-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13204 invoked from network); 11 May 2006 18:18:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 18:18:03 -0000
Received: (qmail 98407 invoked by uid 500); 11 May 2006 18:18:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98388 invoked by uid 500); 11 May 2006 18:18:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98379 invoked by uid 99); 11 May 2006 18:18:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:18:02 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:18:01 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A201541000B
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 18:17:15 +0000 (GMT)
Message-ID: <24571992.1147371435660.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 18:17:15 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-208) add failure page to webapp
In-Reply-To: <25090401.1147300384509.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-208?page=all ]

Owen O'Malley updated HADOOP-208:
---------------------------------

    Attachment: failure-list-2.patch

This patch replaces the other one and fixes the targets of the links for next/prev on the task lists.

> add failure page to webapp
> --------------------------
>
>          Key: HADOOP-208
>          URL: http://issues.apache.org/jira/browse/HADOOP-208
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: failure-list-2.patch, failure-list.patch
>
> I'd like a webapp page that just lists the failures in a job so that I can find them more easily. I also want to put back the job detail page.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 18:18:04 2006
Return-Path: 
 <hadoop-dev-return-1362-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13277 invoked from network); 11 May 2006 18:18:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 18:18:04 -0000
Received: (qmail 98555 invoked by uid 500); 11 May 2006 18:18:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98530 invoked by uid 500); 11 May 2006 18:18:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98521 invoked by uid 99); 11 May 2006 18:18:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:18:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:18:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BE837410010
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 18:17:16 +0000 (GMT)
Message-ID: <22112655.1147371436777.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 18:17:16 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12379122 ] 

Doug Cutting commented on HADOOP-210:
-------------------------------------

> Reducing stack size may relieve the problem temporally, but will not solve the problem completely.

This remains to be seen.  What you say is possible, but it is also possible that, e.g., 2GB heap may gracefully  handle 10k or more connection threads.  We need to determine this.

It's a question of constants.  We know we need to allocate some buffer memory per connection, perhaps a few K, but perhaps more in some cases (e.g., block reports).  With a thread, we need some stack space, but less buffer space; probably more memory on the whole.  But there's no point in optimizing this if we can handle as many threads as we need with the amount of memory we have.

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 18:32:53 2006
Return-Path: 
 <hadoop-dev-return-1363-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31824 invoked from network); 11 May 2006 18:32:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 18:32:53 -0000
Received: (qmail 27361 invoked by uid 500); 11 May 2006 18:32:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27342 invoked by uid 500); 11 May 2006 18:32:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27333 invoked by uid 99); 11 May 2006 18:32:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:32:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:32:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8491D714292
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 18:32:05 +0000 (GMT)
Message-ID: <3483715.1147372325539.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 18:32:05 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12379125 ] 

Owen O'Malley commented on HADOOP-210:
--------------------------------------

It seems clear to me that before we get to a 2000 node Hadoop cluster, we will be using select to manage the incoming connections. Even with the 128k stack the 8000 threads would need 1 gig of ram, which is too much on our current hardware. The servers already have thread pools, but they just also have a thread per a socket.

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 18:51:50 2006
Return-Path: 
 <hadoop-dev-return-1364-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72959 invoked from network); 11 May 2006 18:51:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 18:51:50 -0000
Received: (qmail 59391 invoked by uid 500); 11 May 2006 18:51:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59329 invoked by uid 500); 11 May 2006 18:51:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Delivered-To: moderator for hadoop-dev@lucene.apache.org
Received: (qmail 35872 invoked by uid 99); 11 May 2006 18:39:24 -0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_POST
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: BigTable
Date: Thu, 11 May 2006 12:38:57 -0600
Message-ID: <ACE0A132FDBA7A4687822B4959D3AE4822B529@DEN-EXM-04.corp.ebay.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: BigTable
Thread-Index: AcZ0ym+QOBw+bkUkRE2n/udGnmlPCQAWqAag
From: "Wootton, Alan" <awootton@shopping.com>
To: <hadoop-dev@lucene.apache.org>
X-OriginalArrivalTime: 11 May 2006 18:38:58.0697 (UTC)
 FILETIME=[2A64E790:01C6752A]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

That would solve a lot of problems for me.
I've been thinking of ways to sneak up on it, and not have to write the =
whole thing as per the google bigtable spec.

A good start, imho, would be to get some db read code (like for =
instance: LinkDbReader) to distribute the lookup to local machines =
instead of streaming big chunks to a client machine so it can find one =
record.

- alan wootton =20

-----Original Message-----
From: Leen Toelen [mailto:toelen@gmail.com]
Sent: Thursday, May 11, 2006 12:09 AM
To: hadoop-dev@lucene.apache.org
Subject: BigTable


Hi,

are there any plans to create a structured data storage system like
Google's BigTable in Hadoop? Their implementation relies heavily on
mapreduce and gfs, so Hadoop is an ideal match. BigTable is what
drives google base, earth and news for instance.

http://blog.outer-court.com/archive/2005-10-23-n61.html

Regards,
Leen Toelen

From MAILER-DAEMON Thu May 11 18:53:54 2006
Return-Path: 
 <hadoop-dev-return-1365-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 75108 invoked from network); 11 May 2006 18:53:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 18:53:54 -0000
Received: (qmail 63431 invoked by uid 500); 11 May 2006 18:53:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63395 invoked by uid 500); 11 May 2006 18:53:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63383 invoked by uid 99); 11 May 2006 18:53:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:53:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 11:53:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0FA5D714293
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 18:53:06 +0000 (GMT)
Message-ID: <3211704.1147373586061.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 18:53:06 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-196) Fix buggy uselessness of
 Configuration( Configuration other) constructor
In-Reply-To: <32654100.1146779418355.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-196?page=comments#action_12379130 ] 

alan wootton commented on HADOOP-196:
-------------------------------------

Some mistakes in this submission (my first one, and I can't seem to edit them away).

Let me restate the bug.

This constructor

  public JobConf(Configuration conf) {
    super(conf);
    initialize();
  }

does not work as it should. The conf that is passed in gets lost.

The patch fixes this bug.

- alan wootton, shopping.com

> Fix buggy uselessness of Configuration( Configuration other) constructor
> ------------------------------------------------------------------------
>
>          Key: HADOOP-196
>          URL: http://issues.apache.org/jira/browse/HADOOP-196
>      Project: Hadoop
>         Type: Bug

>   Components: conf
>     Reporter: alan wootton
>  Attachments: ConfigConstructorFix.patch
>
> The constructor 
> public Configuration(Configuration other) 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 11 20:33:52 2006
Return-Path: 
 <hadoop-dev-return-1366-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33722 invoked from network); 11 May 2006 20:33:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 May 2006 20:33:52 -0000
Received: (qmail 29887 invoked by uid 500); 11 May 2006 20:33:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29864 invoked by uid 500); 11 May 2006 20:33:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29855 invoked by uid 99); 11 May 2006 20:33:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 13:33:51 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 13:33:51 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 87C787141F1
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 20:33:05 +0000 (GMT)
Message-ID: <21143415.1147379585552.JavaMail.jira@brutus>
Date: Thu, 11 May 2006 20:33:05 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-209) Add a program to recursively copy
 directories across file systems
In-Reply-To: <25124034.1147302364527.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-209?page=all ]

Milind Bhandarkar updated HADOOP-209:
-------------------------------------

    Attachment: CopyDir.patch

Here is a patch for recursively copying directories across multiple file-systems. Consists of addition of a cp command to bin/hadoop, a mapreduce program to copy files, and a unit test that tests all combinations of filesystems (i.e. 4 combinations of local, and dfs).

> Add a program to recursively copy directories across file systems
> -----------------------------------------------------------------
>
>          Key: HADOOP-209
>          URL: http://issues.apache.org/jira/browse/HADOOP-209
>      Project: Hadoop
>         Type: New Feature

>   Components: fs
>     Versions: 0.3
>  Environment: All
>     Reporter: Milind Bhandarkar
>  Attachments: CopyDir.patch
>
> A useful feature would be a simple command to copy directories recursively across filesystems. The source and destination path should be specified using a filesystem-neutral URI, such as:
> hadoop cp dfs://namenode1:port1/path/to/srcdir file:///path/to/local/destination/dir
> "cp" command would invoke a map-reduce program to copy files recursively.
> I willl attach a patch as soon as svn is up and running.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 01:29:57 2006
Return-Path: 
 <hadoop-dev-return-1369-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94392 invoked from network); 12 May 2006 01:29:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 01:29:57 -0000
Received: (qmail 63339 invoked by uid 500); 12 May 2006 01:29:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57857 invoked by uid 500); 12 May 2006 01:28:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53415 invoked by uid 99); 12 May 2006 01:27:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 18:27:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 16:18:28 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 61E8B7141F9
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 23:18:08 +0000 (GMT)
Message-ID: <11693488.1147389488398.JavaMail.root@brutus>
Date: Thu, 11 May 2006 23:18:08 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-211) logging improvements for Hadoop
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

logging improvements for Hadoop
-------------------------------

         Key: HADOOP-211
         URL: http://issues.apache.org/jira/browse/HADOOP-211
     Project: Hadoop
        Type: Improvement

    Versions: 0.2    
    Reporter: Sameer Paranjpye
 Assigned to: Sameer Paranjpye 
    Priority: Minor
     Fix For: 0.3


Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
broad changes to the way logging is currently done, these being:

- The use of a uniform logging format by all Hadoop subsystems
- The use of Apache commons logging as a facade above an underlying logging framework
- The use of Log4J as the underlying logging framework instead of java.util.logging

This is largely polishing work, but it seems like it would make log analysis and debugging
easier in the short term. In the long term, it would future proof logging to the extent of
allowing the logging framework used to change while requiring minimal code change. The 
propos changes are motivated by the following requirements which we think Hadoops 
logging should meet:

- Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
- Log entries should be clearly annotated with a timestamp and a logging level
- Log entries should be traceable to the subsystem from which they originated
- The logging implementation should allow log entries to be annotated with source code 
location information like classname, methodname, file and line number, without requiring
code changes
- It should be possible to change the logging implementation used without having to change
thousands of lines of code
- The mapping of loggers to destinations (files, directories, servers etc.) should be 
specified and modifiable via configuration


Uniform logging format:

All Hadoop logs should have the following structure.

<Header>\n
<LogEntry>\n [<Exception>\n]
.
.
.

where the header line specifies the format of each log entry. The header line has the format:
'# <Fieldname> <Fieldname>...\n'. 

The default format of each log entry is: '# Timestamp Level LoggerName Message', where:

- Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
- Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
- LoggerName is the short name of the logging subsystem from which the message originated e.g.
fs.FSNamesystem, dfs.Datanode etc.
- Message is the log message produced


Why Apache commons logging and Log4J?

Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
implementation. Bridges from Apache commons logging to popular logging implementations 
(Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
and involves the implementation of subclasses of the commons logging LogFactory and Logger 
classes. Using Apache commons logging and making all logging calls through it enables us to
move to a different logging implementation by simply changing configuration in the best case.
Even otherwise, it incurs minimal code churn overhead.

Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
logging back end.

- Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
can be completely specified in configuration. It is possible to do this with Java logging as
well, however, configuration is a lot more restrictive. For instance, with Java logging all 
log files must have names derived from the same pattern. For the namenode, log files could 
be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
directory with names like namenode0.log etc. With Log4J it would be possible to configure
the namenode to emit log files with different names, say heartbeats.log, namespace.log,
clients.log etc. Configuration variables in Log4J can also have the values of system 
properties embedded in them.

- Takes wrappers into account: Log4J takes into account the possibility that an application
may be invoking it via a wrapper, such as Apache commons logging. This is important because
logging event objects must be able to infer the context of the logging call such as classname,
methodname etc. Inferring context is a relatively expensive operation that involves creating
an exception and examining the stack trace to find the frame just before the first frame 
of the logging framework. It is therefore done lazily only when this information actually 
needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
Apache commons logging is responsible for inferring the calling context and setting it in the 
logging event and b) this inference has to be done on every logging call regardless of whether
or not it is needed.

- More handy features: Log4J has some handy features that Java logging doesn't. A couple
of examples of these:
a) Date based rolling of log files 
b) Format control through configuration. Log4J has a PatternLayout class that can be 
configured to generate logs with a user specified pattern. The logging format described
above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
indicate that each log line should have the date and time followed by the logger name followed
by the logging level or priority followed by the application generated message.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 01:46:17 2006
Return-Path: 
 <hadoop-dev-return-1370-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3217 invoked from network); 12 May 2006 01:46:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 01:46:17 -0000
Received: (qmail 90921 invoked by uid 500); 12 May 2006 01:45:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88132 invoked by uid 500); 12 May 2006 01:44:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83880 invoked by uid 99); 12 May 2006 01:44:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 18:44:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 16:37:29 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 252D3410009
	for <hadoop-dev@lucene.apache.org>; Thu, 11 May 2006 23:37:09 +0000 (GMT)
Message-ID: <23252285.1147390629149.JavaMail.root@brutus>
Date: Thu, 11 May 2006 23:37:09 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
In-Reply-To: <7275763.1147218844498.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-207?page=all ]

Hairong Kuang updated HADOOP-207:
---------------------------------

    Attachment: logging.patch

This patch allows hadoop logging works with java1.4. It also makes the .log name consistent with .log name.

> Patch to HADOOP-96 uses long deprecated call
> --------------------------------------------
>
>          Key: HADOOP-207
>          URL: http://issues.apache.org/jira/browse/HADOOP-207
>      Project: Hadoop
>         Type: Bug

>     Reporter: Bryan Pendleton
>     Priority: Critical
>  Attachments: logging.patch
>
> System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 01:13:59 2006
Return-Path: 
 <hadoop-dev-return-1367-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78833 invoked from network); 12 May 2006 01:13:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 01:13:59 -0000
Received: (qmail 13759 invoked by uid 500); 12 May 2006 01:11:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13378 invoked by uid 500); 12 May 2006 01:11:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13031 invoked by uid 99); 12 May 2006 01:10:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 18:10:56 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 17:05:29 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7F46E410009
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 00:05:09 +0000 (GMT)
Message-ID: <13549848.1147392309517.JavaMail.root@brutus>
Date: Fri, 12 May 2006 00:05:09 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
In-Reply-To: <7275763.1147218844498.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-207?page=all ]

Hairong Kuang updated HADOOP-207:
---------------------------------

    Attachment: logging.patch

> Patch to HADOOP-96 uses long deprecated call
> --------------------------------------------
>
>          Key: HADOOP-207
>          URL: http://issues.apache.org/jira/browse/HADOOP-207
>      Project: Hadoop
>         Type: Bug

>     Reporter: Bryan Pendleton
>     Priority: Critical
>  Attachments: logging.patch, logging.patch
>
> System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 01:30:26 2006
Return-Path: 
 <hadoop-dev-return-1368-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95969 invoked from network); 12 May 2006 01:30:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 01:30:26 -0000
Received: (qmail 63822 invoked by uid 500); 12 May 2006 01:29:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57791 invoked by uid 500); 12 May 2006 01:28:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54375 invoked by uid 99); 12 May 2006 01:27:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 18:27:52 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 18:27:29 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 28BE941000B
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 01:27:09 +0000 (GMT)
Message-ID: <13755574.1147397229164.JavaMail.root@brutus>
Date: Fri, 12 May 2006 01:27:09 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-195) transfer map output transfer with http
 instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-195?page=all ]

paul sutter updated HADOOP-195:
-------------------------------

    Attachment: MapFileSimulator.java
                mapfilesimulator-sort2.txt
                mapfilesimulator-big.txt


I dont have a 188 node cluster, so i wrote a simulator to test the impact of file sizes and buffer sizes on performance for a single node in Owen's test. The program has a simiulated map step, to create the output files using the configured buffer size, and a copy step to copy the files. 

The idea is to isolate filesystem/disk performance issues from any interaction with RPC, TCP, switches, etc.

Results show an 8-10X speedup with larger files and buffers:

Configration "sort2":
(32MB DFS blocks, 4KB buffer, 320 mappers/node, 356 reducers total, 10GB total data): 
- map phase: 48 minutes and 45 seconds
- copy phase: 70 minutes and 38 seconds

Configuration "big":
(1GB DFS blocks, 1MB buffer, 10 mappers/node, 356 reducers total, 10GB total data)::
- map phase: 6 minutes and 24 seconds
- copy phase, 7 minutes and 56 seconds

That final copy phase was only running at 30MB/sec, so it should be easy to move that across the network if those 188 nodes were on one big switch. Obviously, this is about half the speed of the bare drive, so there is another 2X improvement possible and still be able to fit within gigabit network limitations.

Like Owen's sort test, this test generate 10GB of data per node, and the node I'm using has 4GB of RAM. The program is attached, along with outout according to Owens' last configuration and a run with larger files and buffers. 

The program also has a configuration called "sort1" that had the original configuraiton, but would take too long to run so i didint run it.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 05:20:31 2006
Return-Path: 
 <hadoop-dev-return-1371-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58154 invoked from network); 12 May 2006 05:20:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 05:20:31 -0000
Received: (qmail 69346 invoked by uid 500); 12 May 2006 05:20:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69315 invoked by uid 500); 12 May 2006 05:20:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69305 invoked by uid 99); 12 May 2006 05:20:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 22:20:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 22:20:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 905FA41000B
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 05:20:09 +0000 (GMT)
Message-ID: <11127002.1147411209588.JavaMail.root@brutus>
Date: Fri, 12 May 2006 05:20:09 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
In-Reply-To: <7275763.1147218844498.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-207?page=all ]

Sameer Paranjpye updated HADOOP-207:
------------------------------------

    Fix Version: 0.2.1
        Version: 0.2
      Assign To: Hairong Kuang

> Patch to HADOOP-96 uses long deprecated call
> --------------------------------------------
>
>          Key: HADOOP-207
>          URL: http://issues.apache.org/jira/browse/HADOOP-207
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>     Reporter: Bryan Pendleton
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2.1
>  Attachments: logging.patch, logging.patch
>
> System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 05:24:31 2006
Return-Path: 
 <hadoop-dev-return-1372-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60738 invoked from network); 12 May 2006 05:24:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 05:24:31 -0000
Received: (qmail 74111 invoked by uid 500); 12 May 2006 05:24:30 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74087 invoked by uid 500); 12 May 2006 05:24:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74078 invoked by uid 99); 12 May 2006 05:24:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 22:24:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 22:24:29 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1B77441000B
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 05:24:09 +0000 (GMT)
Message-ID: <28938274.1147411449109.JavaMail.root@brutus>
Date: Fri, 12 May 2006 05:24:09 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-165) long response times from task trackers
 under load
In-Reply-To: <28414302.1145982857680.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-165?page=all ]

Sameer Paranjpye updated HADOOP-165:
------------------------------------

    Fix Version: 0.3

> long response times from task trackers under load
> -------------------------------------------------
>
>          Key: HADOOP-165
>          URL: http://issues.apache.org/jira/browse/HADOOP-165
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>  Environment: 190 redhat linux boxes, each with 2 hyperthreaded cpus, 2gb memory
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> we are seeing very slow response times from the task tracker. I put in some instrumentation to measure how long each call took for the RPC.Sever code to run the method (so it does not include serialization/deserialization time). The top of the list (in ms) looks like:
> 7581 progress node1192
> 7022 ping node1192
> 5393 ping node1162
> 4854 progress node1162
> 4749 progress node1194
> 4709 ping node1194
> 3813 ping node1100
> 3486 ping node1190
> 3266 progress node1190
> 3187 progress node1265
> 3078 ping node1203
> 2972 progress node1203
> 2947 progress node1240
> 2889 progress node1100
> 2875 ping node1116
> 2843 ping node1189
> 2772 ping node1183
> 2737 ping node1110
> 2727 progress node1183
> 2710 ping node1123
> 2563 ping node1304
> 2527 progress node1144
> 2479 ping node1137
> 2476 progress node1304
> 2430 ping node1240
> 2416 ping node1144
> 2377 progress node1176
> 2339 ping node1109
> 2321 progress node1114
> 2311 ping node1157
> 2185 ping node1265
> 2185 ping node1109
> 2172 ping node1114
> 2145 progress node1109
> 2127 ping node1176
> 2083 progress node1189
> 2076 ping node1229
> 2073 progress node1188
> 2072 progress node1123
> 2048 ping node1161
> 2003 progress node1110
> 1989 ping node1180
> 1963 ping node1114

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 05:59:32 2006
Return-Path: 
 <hadoop-dev-return-1373-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74097 invoked from network); 12 May 2006 05:59:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 05:59:32 -0000
Received: (qmail 12887 invoked by uid 500); 12 May 2006 05:59:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12865 invoked by uid 500); 12 May 2006 05:59:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12856 invoked by uid 99); 12 May 2006 05:59:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 22:59:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 22:59:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E0BF1410009
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 05:59:09 +0000 (GMT)
Message-ID: <26590997.1147413549917.JavaMail.root@brutus>
Date: Fri, 12 May 2006 05:59:09 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12379173 ] 

eric baldeschwieler commented on HADOOP-210:
--------------------------------------------

Let's not argue the point in the abstract. 

If someone does submit a patch that reduces the overhead of having many RPCs/connections without complicating the programming model or tanking performance, I assume it would be acceptable, right?

If someone feels they can achieve these aims, I'd encourage them to sign up / implement something.  Then we can test it.

Otherwise, let's let it lie.



> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 06:32:31 2006
Return-Path: 
 <hadoop-dev-return-1374-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82082 invoked from network); 12 May 2006 06:32:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 06:32:31 -0000
Received: (qmail 44519 invoked by uid 500); 12 May 2006 06:32:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44393 invoked by uid 500); 12 May 2006 06:32:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44384 invoked by uid 99); 12 May 2006 06:32:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 23:32:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 23:32:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3A6897141F5
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 06:32:09 +0000 (GMT)
Message-ID: <22073820.1147415529236.JavaMail.root@brutus>
Date: Fri, 12 May 2006 06:32:09 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12379174 ] 

eric baldeschwieler commented on HADOOP-195:
--------------------------------------------

The network core has a lot more bandwidth than that.  Each rack has a 1Gbit uplink, although this is a crufty enough network (oldest gear we have) that we may find some odd outliers.  But it can be assumed that we have at least 30mBits of bandwidth simultaneously from ever node to every other.  And the write tests are behaving as if we do.  So we can focus on finding other explainations.  We're also starting benchmarking on a newer set of nodes with ~100mBits simultaneously all to all.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 06:56:33 2006
Return-Path: 
 <hadoop-dev-return-1375-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87194 invoked from network); 12 May 2006 06:56:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 06:56:33 -0000
Received: (qmail 65381 invoked by uid 500); 12 May 2006 06:56:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65255 invoked by uid 500); 12 May 2006 06:56:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65246 invoked by uid 99); 12 May 2006 06:56:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 23:56:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 11 May 2006 23:56:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 86403714209
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 06:56:10 +0000 (GMT)
Message-ID: <26458767.1147416970546.JavaMail.root@brutus>
Date: Fri, 12 May 2006 06:56:10 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12379176 ] 

eric baldeschwieler commented on HADOOP-211:
--------------------------------------------

I suggest we use iso8601 time format.

http://www.cl.cam.ac.uk/~mgk25/iso-time.html

This would suggest yyyy-MM-ddTHH:mm:SS , such as 2006-05-11T23:47:03

The T is a literal and no one ever likes it.  Change it for all I care, but standards are ok.  This also suggests UTC, which I think is a good default, but also allows for local time, with a distinct notation 2006-05-11T23:47:03-08.  We could support that as a config option if folks care.

This format is also directly sortable, which is nice and avoids localization issues (MM-dd or dd-MM).



> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 15:46:39 2006
Return-Path: 
 <hadoop-dev-return-1376-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86075 invoked from network); 12 May 2006 15:46:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 15:46:39 -0000
Received: (qmail 26344 invoked by uid 500); 12 May 2006 15:46:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26122 invoked by uid 500); 12 May 2006 15:46:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26029 invoked by uid 99); 12 May 2006 15:46:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 08:46:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 08:46:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BAAC07142AE
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 15:46:09 +0000 (GMT)
Message-ID: <28825893.1147448769761.JavaMail.root@brutus>
Date: Fri, 12 May 2006 15:46:09 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-212) allow changes to dfs block size
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

allow changes to dfs block size
-------------------------------

         Key: HADOOP-212
         URL: http://issues.apache.org/jira/browse/HADOOP-212
     Project: Hadoop
        Type: Improvement

  Components: dfs  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Critical
     Fix For: 0.3


Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
  1. Change the default block size to 64 * 1024 * 1024.
  2. Add the config variable dfs.block.size that sets the default block size.
  3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
  4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
  5. Add a new method to FileSytem.getBlockSize that takes a pathname.
  6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
  7. Have the InputFormatBase use the blocksize of each file to determine the split size.

Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 17:01:32 2006
Return-Path: 
 <hadoop-dev-return-1377-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14818 invoked from network); 12 May 2006 17:01:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 17:01:32 -0000
Received: (qmail 80569 invoked by uid 500); 12 May 2006 17:01:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80543 invoked by uid 500); 12 May 2006 17:01:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80529 invoked by uid 99); 12 May 2006 17:01:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:01:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:01:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1DF3F714292
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 17:01:09 +0000 (GMT)
Message-ID: <27413277.1147453269119.JavaMail.root@brutus>
Date: Fri, 12 May 2006 17:01:09 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-212?page=comments#action_12383219 ] 

alan wootton commented on HADOOP-212:
-------------------------------------

Are there two issues here?

I can see a need to change the default block size for a DFS. In my case I'd like to write unit tests with small block sizes to check dfs code for bugs. 

I don't see the need for files to have their own sizes. Does this not introduce another 'moving part' to the dfs, and even more possibilities for bugs?  

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3

>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 17:17:31 2006
Return-Path: 
 <hadoop-dev-return-1378-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20083 invoked from network); 12 May 2006 17:17:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 17:17:31 -0000
Received: (qmail 2122 invoked by uid 500); 12 May 2006 17:17:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2101 invoked by uid 500); 12 May 2006 17:17:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2090 invoked by uid 99); 12 May 2006 17:17:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:17:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:17:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A760C714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 17:17:08 +0000 (GMT)
Message-ID: <9190605.1147454228682.JavaMail.root@brutus>
Date: Fri, 12 May 2006 17:17:08 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12383220 ] 

Doug Cutting commented on HADOOP-211:
-------------------------------------

I'm +1 for switching to commons-logging and to log4j by default.  But I think we shouldn't mandate a format.  It should be possible to embed Hadoop in other systems with other logging standards, and get it to comply with those standards.  So most of what you suggest about log formats I think should be couched in the terms "by default", right?


> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 17:30:32 2006
Return-Path: 
 <hadoop-dev-return-1379-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 22832 invoked from network); 12 May 2006 17:30:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 17:30:32 -0000
Received: (qmail 17550 invoked by uid 500); 12 May 2006 17:30:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17529 invoked by uid 500); 12 May 2006 17:30:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17520 invoked by uid 99); 12 May 2006 17:30:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:30:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:30:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2CE1D714292
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 17:30:09 +0000 (GMT)
Message-ID: <3137470.1147455009135.JavaMail.root@brutus>
Date: Fri, 12 May 2006 17:30:09 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-212?page=comments#action_12383223 ] 

Owen O'Malley commented on HADOOP-212:
--------------------------------------

As you point out, it is possible to just make configuration variable and use it everywhere. The problem is that you become very sensititve to differences in the configuration between nodes. It seemed less error prone to leave the client in charge of block size and consistently use their setting.

Under the hood, dfs currently supports variable block sizes within a file, but I certainly do _not_ want to expose that to the user-visible APIs.

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3

>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 17:41:31 2006
Return-Path: 
 <hadoop-dev-return-1380-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 25441 invoked from network); 12 May 2006 17:41:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 17:41:31 -0000
Received: (qmail 31047 invoked by uid 500); 12 May 2006 17:41:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31024 invoked by uid 500); 12 May 2006 17:41:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31013 invoked by uid 99); 12 May 2006 17:41:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:41:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:41:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ACDBF714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 17:41:08 +0000 (GMT)
Message-ID: <18410126.1147455668678.JavaMail.root@brutus>
Date: Fri, 12 May 2006 17:41:08 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12383224 ] 

Owen O'Malley commented on HADOOP-211:
--------------------------------------

I'm +1 for using a time format that is sortable. I've been using the sed, awk, grep tools for merging logs files to see trends across time.

commons-logging and log4j sound good.

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 17:50:31 2006
Return-Path: 
 <hadoop-dev-return-1381-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28122 invoked from network); 12 May 2006 17:50:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 17:50:31 -0000
Received: (qmail 44771 invoked by uid 500); 12 May 2006 17:50:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44755 invoked by uid 500); 12 May 2006 17:50:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44746 invoked by uid 99); 12 May 2006 17:50:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:50:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:50:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ADC3E714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 17:50:08 +0000 (GMT)
Message-ID: <32520996.1147456208681.JavaMail.root@brutus>
Date: Fri, 12 May 2006 17:50:08 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12383227 ] 

Sameer Paranjpye commented on HADOOP-211:
-----------------------------------------

Yes, the suggestions about formats are meant to be defaults. This is one more reason for using Log4J, it gives you a fair amount of freedom with specifying formats in configuration. 

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 17:54:33 2006
Return-Path: 
 <hadoop-dev-return-1382-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29022 invoked from network); 12 May 2006 17:54:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 17:54:33 -0000
Received: (qmail 48635 invoked by uid 500); 12 May 2006 17:54:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48510 invoked by uid 500); 12 May 2006 17:54:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48501 invoked by uid 99); 12 May 2006 17:54:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:54:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 10:54:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5798371429E
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 17:54:10 +0000 (GMT)
Message-ID: <28978044.1147456450355.JavaMail.root@brutus>
Date: Fri, 12 May 2006 17:54:10 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12383230 ] 

Doug Cutting commented on HADOOP-210:
-------------------------------------

> Let's not argue the point in the abstract.  If someone [...] it would be acceptable, right?

Is that a question for me?  I can't answer in the abstract.  Show me code & I'll give an opinion.  Other committers can too, folks can cause me to change my opinion, etc.  Heck, if someone convincingly demonstrates that the thread-per-connection model has reached the end of its tether, then I might implement it myself.

Having explored this a few times now, I currently think some sort of chunked encoding for requests is required.  We could also chunk responses, which might solve some other issues.

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 18:11:32 2006
Return-Path: 
 <hadoop-dev-return-1383-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36526 invoked from network); 12 May 2006 18:11:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 18:11:32 -0000
Received: (qmail 78878 invoked by uid 500); 12 May 2006 18:11:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78753 invoked by uid 500); 12 May 2006 18:11:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78744 invoked by uid 99); 12 May 2006 18:11:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:11:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:11:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7A11F714293
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 18:11:09 +0000 (GMT)
Message-ID: <13651451.1147457469497.JavaMail.root@brutus>
Date: Fri, 12 May 2006 18:11:09 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-146) potential conflict in block id's,
 leading to data corruption
In-Reply-To: <2179039.1145398037471.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-146?page=all ]

Milind Bhandarkar updated HADOOP-146:
-------------------------------------

    Attachment: hadoop-146-random.patch

I have attached a patch that fixes block-id conflicts for randomly generated block-ids. Now it checks after generating a block ID whether it already exists in the file system.


> potential conflict in block id's, leading to data corruption
> ------------------------------------------------------------
>
>          Key: HADOOP-146
>          URL: http://issues.apache.org/jira/browse/HADOOP-146
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>      Fix For: 0.3
>  Attachments: hadoop-146-random.patch
>
> currently, block id's are generated randomly, and are not tested for collisions with existing id's.
> while ids are 64 bits, given enough time and a large enough FS, collisions are expected.
> when a collision occurs, a random subset of blocks with that id will be removed as extra replicas, and the contents of that portion of the containing file are one random version of the block.
> to solve this one could check for id collision when creating a new block, getting a new id in case of conflict. This approach requires the name node to keep track of all existing block id's (rather than just the ones who have reported in), and to identify old versions of a block id as in valid (in case a data node dies, a file is deleted, then a block id is reused for a new file).
> Alternatively, one could simply use sequential block id's. Here the downsides are: 
> 1. migration from an existing file system is hard, requiring compaction of the entire FS
> 2. once you cycle through 64 bits of id's (quite a few years at full blast), you're in trouble again (or run occasional/background compaction)
> 3. you must never lose the high watermark block id.
> synchronized Block allocateBlock(UTF8 src) {
>         Block b = new Block();
>         FileUnderConstruction v = (FileUnderConstruction) pendingCreates.get(src);
>         v.add(b);
>         pendingCreateBlocks.add(b);
>         return b;
>     }
> static Random r = new Random();
>     /**
>      */
>     public Block() {
>         this.blkid = r.nextLong();
>         this.len = 0;
>     }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 18:19:34 2006
Return-Path: 
 <hadoop-dev-return-1384-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38254 invoked from network); 12 May 2006 18:19:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 18:19:34 -0000
Received: (qmail 84975 invoked by uid 500); 12 May 2006 18:19:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84850 invoked by uid 500); 12 May 2006 18:19:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84841 invoked by uid 99); 12 May 2006 18:19:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:19:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:19:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 86F49714293
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 18:19:09 +0000 (GMT)
Message-ID: <4138897.1147457949549.JavaMail.root@brutus>
Date: Fri, 12 May 2006 18:19:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12383238 ] 

Doug Cutting commented on HADOOP-211:
-------------------------------------

Even log4j should be a default.  Hadoop code should only reference the commons-logging api, right?  BTW, Sun's logging API also gives you complete freedom in formatting, although you have to write some Java classes, not just configure it with formatting strings as you can with log4j.

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 18:32:32 2006
Return-Path: 
 <hadoop-dev-return-1385-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42102 invoked from network); 12 May 2006 18:32:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 18:32:32 -0000
Received: (qmail 99567 invoked by uid 500); 12 May 2006 18:32:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99442 invoked by uid 500); 12 May 2006 18:32:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99433 invoked by uid 99); 12 May 2006 18:32:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:32:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:32:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 85A49714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 18:32:09 +0000 (GMT)
Message-ID: <32075362.1147458729544.JavaMail.root@brutus>
Date: Fri, 12 May 2006 18:32:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
In-Reply-To: <7275763.1147218844498.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-207?page=comments#action_12383240 ] 

Doug Cutting commented on HADOOP-207:
-------------------------------------

The 1.4 compatibility issue could be worthy of fixing in 0.2.1 (which I can't release until svn writes are re-enabled... checking... and it looks like they just were!).  What exactly is the problem on your mixed cluster?  Should I try to squeeze this into the 0.2.1 release?

I'm concerned about the other changes on Win32.  Have you tested that the new Java command-line parameters work correctly if they contain spaces?  In particular, we should test that these work correctly when either the username or the log directory path contain spaces.

Thanks!

> Patch to HADOOP-96 uses long deprecated call
> --------------------------------------------
>
>          Key: HADOOP-207
>          URL: http://issues.apache.org/jira/browse/HADOOP-207
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>     Reporter: Bryan Pendleton
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2.1
>  Attachments: logging.patch, logging.patch
>
> System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 18:32:33 2006
Return-Path: 
 <hadoop-dev-return-1386-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42127 invoked from network); 12 May 2006 18:32:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 18:32:33 -0000
Received: (qmail 99708 invoked by uid 500); 12 May 2006 18:32:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99583 invoked by uid 500); 12 May 2006 18:32:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99574 invoked by uid 99); 12 May 2006 18:32:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:32:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:32:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E9441714292
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 18:32:09 +0000 (GMT)
Message-ID: <17886713.1147458729952.JavaMail.root@brutus>
Date: Fri, 12 May 2006 18:32:09 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12383241 ] 

Sameer Paranjpye commented on HADOOP-211:
-----------------------------------------

Wasn't really thinking in terms of making the logging implementation configurable, but there's no reason that can't be done. Hadoop code won't be invoking any part of log4j or whatever else directly.

Sun's logging does give you complete freedom in formatting, I was pointing out that it's not as flexible as log4j where a lot can be achieved in configuration.

We can have the logging implementation used be specified in configuration. Do you see a lot of people making use of that feature though? My instinct is that they won't...

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 18:51:33 2006
Return-Path: 
 <hadoop-dev-return-1387-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47721 invoked from network); 12 May 2006 18:51:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 18:51:33 -0000
Received: (qmail 36609 invoked by uid 500); 12 May 2006 18:51:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36586 invoked by uid 500); 12 May 2006 18:51:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36576 invoked by uid 99); 12 May 2006 18:51:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:51:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 11:51:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7E472714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 18:51:09 +0000 (GMT)
Message-ID: <9313494.1147459869514.JavaMail.root@brutus>
Date: Fri, 12 May 2006 18:51:09 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
In-Reply-To: <7275763.1147218844498.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-207?page=comments#action_12383242 ] 

Owen O'Malley commented on HADOOP-207:
--------------------------------------

If you run Hadoop 0.2.0 on jdk 1.4.2 it gets an exception that stops the servers at start up.

> Patch to HADOOP-96 uses long deprecated call
> --------------------------------------------
>
>          Key: HADOOP-207
>          URL: http://issues.apache.org/jira/browse/HADOOP-207
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>     Reporter: Bryan Pendleton
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2.1
>  Attachments: logging.patch, logging.patch
>
> System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 19:06:44 2006
Return-Path: 
 <hadoop-dev-return-1388-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53729 invoked from network); 12 May 2006 19:06:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 19:06:44 -0000
Received: (qmail 71336 invoked by uid 500); 12 May 2006 19:06:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71241 invoked by uid 500); 12 May 2006 19:06:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71231 invoked by uid 99); 12 May 2006 19:06:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 12:06:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 12:06:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 85CD7714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 19:06:08 +0000 (GMT)
Message-ID: <16272983.1147460768545.JavaMail.root@brutus>
Date: Fri, 12 May 2006 19:06:08 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-213) add/change TestDFSIO command line
 arguments
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

add/change TestDFSIO command line arguments
-------------------------------------------

         Key: HADOOP-213
         URL: http://issues.apache.org/jira/browse/HADOOP-213
     Project: Hadoop
        Type: Improvement

  Components: dfs  
    Reporter: Yoram Arnon
 Assigned to: Konstantin Shvachko 
    Priority: Minor


TestDFSIO would benefit from the follwing changes on the command line:

1. allow a "-dfs <dfs>" option, to specify which dfs to test. Just like the hadoop dfs command.
2. allow a "-jt <job tracker>" option, to specify a job tracker. Just like the hadoop job command.
3. allign the file size units with the dfs block size. Using MB (2^20) when the dfs uses 10^6 skews the results a bit.
4. add a "-replication <replication>" option, to specify files' replication factor.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 19:18:32 2006
Return-Path: 
 <hadoop-dev-return-1389-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57672 invoked from network); 12 May 2006 19:18:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 19:18:32 -0000
Received: (qmail 88829 invoked by uid 500); 12 May 2006 19:18:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88704 invoked by uid 500); 12 May 2006 19:18:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88695 invoked by uid 99); 12 May 2006 19:18:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 12:18:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 12:18:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 72D5F714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 19:18:09 +0000 (GMT)
Message-ID: <10428358.1147461489467.JavaMail.root@brutus>
Date: Fri, 12 May 2006 19:18:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
In-Reply-To: <7275763.1147218844498.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-207?page=comments#action_12383251 ] 

Doug Cutting commented on HADOOP-207:
-------------------------------------

Is that because I mistakenly compiled 0.2.0 with JDK 1.5, or is there something more going on?  How does it fail?  What's the minimal patch?  (I'll start trying this now and will soon find out, since I'm about to start building & testing release 0.2.1 using JDK 1.4, but any hints are welcome.)

> Patch to HADOOP-96 uses long deprecated call
> --------------------------------------------
>
>          Key: HADOOP-207
>          URL: http://issues.apache.org/jira/browse/HADOOP-207
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>     Reporter: Bryan Pendleton
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2.1
>  Attachments: logging.patch, logging.patch
>
> System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 19:50:38 2006
Return-Path: 
 <hadoop-dev-return-1390-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74908 invoked from network); 12 May 2006 19:50:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 19:50:38 -0000
Received: (qmail 39101 invoked by uid 500); 12 May 2006 19:50:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39055 invoked by uid 500); 12 May 2006 19:50:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39043 invoked by uid 99); 12 May 2006 19:50:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 12:50:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 12:50:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D324F71429E
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 19:50:08 +0000 (GMT)
Message-ID: <7144677.1147463408861.JavaMail.root@brutus>
Date: Fri, 12 May 2006 19:50:08 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-214) ClusterTestDFS fails
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

ClusterTestDFS fails
--------------------

         Key: HADOOP-214
         URL: http://issues.apache.org/jira/browse/HADOOP-214
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.2.1    
 Environment: local workstation (windows) 
    Reporter: alan wootton
 Attachments: fix_clustertestdfs.patch


The dfs unit tests, from the ant target 'cluster' have been failing. (ClusterTestDFSNamespaceLogging, ClusterTestDFS). I don't know if anyone but me cares about these tests, but I do. I would like to write better tests for dns. I think we all need that.

They have been partially broken since  "test.dfs.same.host.targets.allowed" went away and replication ceased for these tests. 

They got really broken when NameNode stopped automatically formatting itself .

Since they seem to be ignored, I took the liberty of changing how they work.

The main thing is, you must put this into your hosts file:

127.0.0.1       localhost0
127.0.0.1       localhost1
127.0.0.1       localhost2
127.0.0.1       localhost3
127.0.0.1       localhost4
127.0.0.1       localhost5
127.0.0.1       localhost6
127.0.0.1       localhost7
127.0.0.1       localhost8
127.0.0.1       localhost9
127.0.0.1       localhost10
127.0.0.1       localhost11
127.0.0.1       localhost12
127.0.0.1       localhost13
127.0.0.1       localhost14
127.0.0.1       localhost15

This way you can start DataNodes, and TaskTrackers (up to 16 of them) with unique hostnames.

Also, I changed all the places that used to call InetAddress.getLocalHost().getHostName() to get it from a new method in Configuration (this issue is the same as http://issues.apache.org/jira/browse/HADOOP-197 ).


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 19:50:47 2006
Return-Path: 
 <hadoop-dev-return-1391-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74972 invoked from network); 12 May 2006 19:50:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 19:50:47 -0000
Received: (qmail 40045 invoked by uid 500); 12 May 2006 19:50:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39835 invoked by uid 500); 12 May 2006 19:50:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39720 invoked by uid 99); 12 May 2006 19:50:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 12:50:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 12:50:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A15127142C0
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 19:50:10 +0000 (GMT)
Message-ID: <29957431.1147463410658.JavaMail.root@brutus>
Date: Fri, 12 May 2006 19:50:10 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-214) ClusterTestDFS fails
In-Reply-To: <7144677.1147463408861.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-214?page=all ]

alan wootton updated HADOOP-214:
--------------------------------

    Attachment: fix_clustertestdfs.patch

> ClusterTestDFS fails
> --------------------
>
>          Key: HADOOP-214
>          URL: http://issues.apache.org/jira/browse/HADOOP-214
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>  Environment: local workstation (windows) 
>     Reporter: alan wootton
>  Attachments: fix_clustertestdfs.patch
>
> The dfs unit tests, from the ant target 'cluster' have been failing. (ClusterTestDFSNamespaceLogging, ClusterTestDFS). I don't know if anyone but me cares about these tests, but I do. I would like to write better tests for dns. I think we all need that.
> They have been partially broken since  "test.dfs.same.host.targets.allowed" went away and replication ceased for these tests. 
> They got really broken when NameNode stopped automatically formatting itself .
> Since they seem to be ignored, I took the liberty of changing how they work.
> The main thing is, you must put this into your hosts file:
> 127.0.0.1       localhost0
> 127.0.0.1       localhost1
> 127.0.0.1       localhost2
> 127.0.0.1       localhost3
> 127.0.0.1       localhost4
> 127.0.0.1       localhost5
> 127.0.0.1       localhost6
> 127.0.0.1       localhost7
> 127.0.0.1       localhost8
> 127.0.0.1       localhost9
> 127.0.0.1       localhost10
> 127.0.0.1       localhost11
> 127.0.0.1       localhost12
> 127.0.0.1       localhost13
> 127.0.0.1       localhost14
> 127.0.0.1       localhost15
> This way you can start DataNodes, and TaskTrackers (up to 16 of them) with unique hostnames.
> Also, I changed all the places that used to call InetAddress.getLocalHost().getHostName() to get it from a new method in Configuration (this issue is the same as http://issues.apache.org/jira/browse/HADOOP-197 ).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 20:10:34 2006
Return-Path: 
 <hadoop-dev-return-1392-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80600 invoked from network); 12 May 2006 20:10:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 20:10:34 -0000
Received: (qmail 74279 invoked by uid 500); 12 May 2006 20:10:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74225 invoked by uid 500); 12 May 2006 20:10:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74201 invoked by uid 99); 12 May 2006 20:10:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 13:10:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 13:10:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 47791714292
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 20:10:09 +0000 (GMT)
Message-ID: <10647310.1147464609289.JavaMail.root@brutus>
Date: Fri, 12 May 2006 20:10:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-214) ClusterTestDFS fails
In-Reply-To: <7144677.1147463408861.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-214?page=comments#action_12383263 ] 

Doug Cutting commented on HADOOP-214:
-------------------------------------

Having to change the hosts file for a test is not great.

Perhaps we could instead just alter Java to resolve hostnames differently while testing?

http://forum.java.sun.com/thread.jspa?threadID=729300


> ClusterTestDFS fails
> --------------------
>
>          Key: HADOOP-214
>          URL: http://issues.apache.org/jira/browse/HADOOP-214
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>  Environment: local workstation (windows) 
>     Reporter: alan wootton
>  Attachments: fix_clustertestdfs.patch
>
> The dfs unit tests, from the ant target 'cluster' have been failing. (ClusterTestDFSNamespaceLogging, ClusterTestDFS). I don't know if anyone but me cares about these tests, but I do. I would like to write better tests for dns. I think we all need that.
> They have been partially broken since  "test.dfs.same.host.targets.allowed" went away and replication ceased for these tests. 
> They got really broken when NameNode stopped automatically formatting itself .
> Since they seem to be ignored, I took the liberty of changing how they work.
> The main thing is, you must put this into your hosts file:
> 127.0.0.1       localhost0
> 127.0.0.1       localhost1
> 127.0.0.1       localhost2
> 127.0.0.1       localhost3
> 127.0.0.1       localhost4
> 127.0.0.1       localhost5
> 127.0.0.1       localhost6
> 127.0.0.1       localhost7
> 127.0.0.1       localhost8
> 127.0.0.1       localhost9
> 127.0.0.1       localhost10
> 127.0.0.1       localhost11
> 127.0.0.1       localhost12
> 127.0.0.1       localhost13
> 127.0.0.1       localhost14
> 127.0.0.1       localhost15
> This way you can start DataNodes, and TaskTrackers (up to 16 of them) with unique hostnames.
> Also, I changed all the places that used to call InetAddress.getLocalHost().getHostName() to get it from a new method in Configuration (this issue is the same as http://issues.apache.org/jira/browse/HADOOP-197 ).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 20:16:37 2006
Return-Path: 
 <hadoop-dev-return-1393-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84252 invoked from network); 12 May 2006 20:16:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 20:16:37 -0000
Received: (qmail 86962 invoked by uid 500); 12 May 2006 20:16:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86939 invoked by uid 500); 12 May 2006 20:16:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86930 invoked by uid 99); 12 May 2006 20:16:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 13:16:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 13:16:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ED5B17142B7
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 20:16:11 +0000 (GMT)
Message-ID: <11664236.1147464971969.JavaMail.root@brutus>
Date: Fri, 12 May 2006 20:16:11 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
In-Reply-To: <7275763.1147218844498.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-207?page=comments#action_12383267 ] 

Owen O'Malley commented on HADOOP-207:
--------------------------------------

Assuming you have the trivial program:

public class test {
  public static void main(String[] args) {
    System.out.println("Home is " + System.getenv("HOME"));
  }
}

Compiling under 1.5 produces no warnings.
Compiling under 1.4.2 produces a depreciated warning for getenv.

Running either the 1.5 or 1.4.2 class file under jvm 1.5 works fine.
Running the 1.4 binary under the jvm 1.4.2 throws:
Exception in thread "main" java.lang.Error: getenv no longer supported, use properties and -D instead: HOME
        at java.lang.System.getenv(System.java:691)
        at test.main(test.java:3)


> Patch to HADOOP-96 uses long deprecated call
> --------------------------------------------
>
>          Key: HADOOP-207
>          URL: http://issues.apache.org/jira/browse/HADOOP-207
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>     Reporter: Bryan Pendleton
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2.1
>  Attachments: logging.patch, logging.patch
>
> System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 20:18:42 2006
Return-Path: 
 <hadoop-dev-return-1394-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85411 invoked from network); 12 May 2006 20:18:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 20:18:42 -0000
Received: (qmail 90867 invoked by uid 500); 12 May 2006 20:18:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90828 invoked by uid 500); 12 May 2006 20:18:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90808 invoked by uid 99); 12 May 2006 20:18:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 13:18:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 13:18:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 785E7714293
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 20:18:10 +0000 (GMT)
Message-ID: <1526554.1147465090489.JavaMail.root@brutus>
Date: Fri, 12 May 2006 20:18:10 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-207) Patch to HADOOP-96 uses long
 deprecated call
In-Reply-To: <7275763.1147218844498.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-207?page=all ]
     
Doug Cutting resolved HADOOP-207:
---------------------------------

    Resolution: Fixed

I just committed this.  The patch did not correctly handle paths with spaces on Win32.  I fixed that by converting them to space-free DOS paths.  Thanks, Hairong.

> Patch to HADOOP-96 uses long deprecated call
> --------------------------------------------
>
>          Key: HADOOP-207
>          URL: http://issues.apache.org/jira/browse/HADOOP-207
>      Project: Hadoop
>         Type: Bug

>     Versions: 0.2
>     Reporter: Bryan Pendleton
>     Assignee: Hairong Kuang
>     Priority: Critical
>      Fix For: 0.2.1
>  Attachments: logging.patch, logging.patch
>
> System.getenv() was deprecated in Java 1.4. My mixed Java 1.4/Java 1.5 cluster won't start up with this code in place. Should probably change the scripts to pass the necessary environment variables in using -D or explicit arguments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 20:50:33 2006
Return-Path: 
 <hadoop-dev-return-1395-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94883 invoked from network); 12 May 2006 20:50:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 20:50:33 -0000
Received: (qmail 48711 invoked by uid 500); 12 May 2006 20:50:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48670 invoked by uid 500); 12 May 2006 20:50:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48639 invoked by uid 99); 12 May 2006 20:50:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 13:50:30 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 13:50:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5CF4E714293
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 20:50:08 +0000 (GMT)
Message-ID: <9733318.1147467008377.JavaMail.root@brutus>
Date: Fri, 12 May 2006 20:50:08 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-215) New method for obtaining report of
 NameNode and JobTracker internals
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

New method for obtaining report of NameNode and JobTracker internals
--------------------------------------------------------------------

         Key: HADOOP-215
         URL: http://issues.apache.org/jira/browse/HADOOP-215
     Project: Hadoop
        Type: New Feature

  Components: mapred, dfs  
    Reporter: alan wootton
    Priority: Minor


Many weeks ago we (at shopping.com research) decided we wanted to be able to get reports from the internals of JobTracker and NameNode. The hadoop web server provides some of this, but we wanted a more structured output, and easier extensibility.

So, we decided to use xml, and I wrote it.

There is a very thin interface to ClientProtocol, and JobSubmissionProtocol like this:

public XmlReporter getXmlReport(String classname, String question);

The implementation (in JobTracker and NameNode ) looks like this:

public XmlReporter getXmlReport(String classname, String question)
    {
		XmlReporter reporter = XmlReporter.getInstance( classname, this,  question);
		reporter.report();
		return reporter;
    }

The idea being that you pass in some xml (question), an XmlReporter (classname) is instanciated and passed back. 

An XmlReporter object consists of nothing more that two org.w3c.dom.Document objects (one in the question, the other is the answer). The Writable interface, for the RPC, simply serializes the dom tree to a string, and then parses it back to a dom tree.

Anyway, here it is. I would like for it to either make it into the code, or for me to find anoher way. 



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:00:32 2006
Return-Path: 
 <hadoop-dev-return-1396-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97721 invoked from network); 12 May 2006 21:00:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:00:32 -0000
Received: (qmail 67733 invoked by uid 500); 12 May 2006 21:00:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67712 invoked by uid 500); 12 May 2006 21:00:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67702 invoked by uid 99); 12 May 2006 21:00:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:00:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:00:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4C5B7714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:00:09 +0000 (GMT)
Message-ID: <799322.1147467609309.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:00:09 +0000 (GMT+00:00)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-216) Task Detail web page missing progress
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Task Detail web page missing progress
-------------------------------------

         Key: HADOOP-216
         URL: http://issues.apache.org/jira/browse/HADOOP-216
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Reporter: Bryan Pendleton
    Priority: Trivial
 Attachments: betterprogressdetail.patch.txt

You can see progress on the job view web page, but not the individual task page.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:00:33 2006
Return-Path: 
 <hadoop-dev-return-1397-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97744 invoked from network); 12 May 2006 21:00:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:00:33 -0000
Received: (qmail 67898 invoked by uid 500); 12 May 2006 21:00:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67874 invoked by uid 500); 12 May 2006 21:00:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67862 invoked by uid 99); 12 May 2006 21:00:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:00:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:00:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3D34C7141F2
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:00:10 +0000 (GMT)
Message-ID: <18200583.1147467610246.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:00:10 +0000 (GMT+00:00)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-216) Task Detail web page missing progress
In-Reply-To: <799322.1147467609309.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-216?page=all ]

Bryan Pendleton updated HADOOP-216:
-----------------------------------

    Attachment: betterprogressdetail.patch.txt

Here's the change which adds the progress display to the task details page.

> Task Detail web page missing progress
> -------------------------------------
>
>          Key: HADOOP-216
>          URL: http://issues.apache.org/jira/browse/HADOOP-216
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Bryan Pendleton
>     Priority: Trivial
>  Attachments: betterprogressdetail.patch.txt
>
> You can see progress on the job view web page, but not the individual task page.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:04:35 2006
Return-Path: 
 <hadoop-dev-return-1398-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 98623 invoked from network); 12 May 2006 21:04:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:04:35 -0000
Received: (qmail 72522 invoked by uid 500); 12 May 2006 21:04:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72397 invoked by uid 500); 12 May 2006 21:04:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72272 invoked by uid 99); 12 May 2006 21:04:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:04:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:04:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4BBDD714293
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:04:09 +0000 (GMT)
Message-ID: <13665830.1147467849307.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:04:09 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-212?page=comments#action_12383285 ] 

alan wootton commented on HADOOP-212:
-------------------------------------

Variable block sizes within a file? I don't see that at all. I can see some checks being made to ensure that the size being sent matches what a datanode thinks is the correct size, but don't see any way, at all, that all Block's don't have a max size of 32 mb everywhere.

Isn't adding a 'blocksize' param to the create method of DFSClient exposing variable block sizes to the client? 

Are we talking about the same thing?

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3

>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:14:32 2006
Return-Path: 
 <hadoop-dev-return-1399-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1246 invoked from network); 12 May 2006 21:14:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:14:32 -0000
Received: (qmail 85155 invoked by uid 500); 12 May 2006 21:14:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85128 invoked by uid 500); 12 May 2006 21:14:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85119 invoked by uid 99); 12 May 2006 21:14:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:14:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:14:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1EDBF714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:14:09 +0000 (GMT)
Message-ID: <11876207.1147468449123.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:14:09 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-214) ClusterTestDFS fails
In-Reply-To: <7144677.1147463408861.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-214?page=comments#action_12383289 ] 

alan wootton commented on HADOOP-214:
-------------------------------------

Well, THAT looks like a nice trick (hacking the name resolver in java). I'll have to try it. That would eliminate the need to change the hosts file.

Remember, these are long tests that nobody is currently running anyway. Running them is a deliberate act and you only need to change your hosts file once. 



> ClusterTestDFS fails
> --------------------
>
>          Key: HADOOP-214
>          URL: http://issues.apache.org/jira/browse/HADOOP-214
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>  Environment: local workstation (windows) 
>     Reporter: alan wootton
>  Attachments: fix_clustertestdfs.patch
>
> The dfs unit tests, from the ant target 'cluster' have been failing. (ClusterTestDFSNamespaceLogging, ClusterTestDFS). I don't know if anyone but me cares about these tests, but I do. I would like to write better tests for dns. I think we all need that.
> They have been partially broken since  "test.dfs.same.host.targets.allowed" went away and replication ceased for these tests. 
> They got really broken when NameNode stopped automatically formatting itself .
> Since they seem to be ignored, I took the liberty of changing how they work.
> The main thing is, you must put this into your hosts file:
> 127.0.0.1       localhost0
> 127.0.0.1       localhost1
> 127.0.0.1       localhost2
> 127.0.0.1       localhost3
> 127.0.0.1       localhost4
> 127.0.0.1       localhost5
> 127.0.0.1       localhost6
> 127.0.0.1       localhost7
> 127.0.0.1       localhost8
> 127.0.0.1       localhost9
> 127.0.0.1       localhost10
> 127.0.0.1       localhost11
> 127.0.0.1       localhost12
> 127.0.0.1       localhost13
> 127.0.0.1       localhost14
> 127.0.0.1       localhost15
> This way you can start DataNodes, and TaskTrackers (up to 16 of them) with unique hostnames.
> Also, I changed all the places that used to call InetAddress.getLocalHost().getHostName() to get it from a new method in Configuration (this issue is the same as http://issues.apache.org/jira/browse/HADOOP-197 ).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:16:33 2006
Return-Path: 
 <hadoop-dev-return-1401-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1701 invoked from network); 12 May 2006 21:16:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:16:33 -0000
Received: (qmail 86899 invoked by uid 500); 12 May 2006 21:16:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86773 invoked by uid 500); 12 May 2006 21:16:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86764 invoked by uid 99); 12 May 2006 21:16:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:16:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:16:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E3822714292
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:16:09 +0000 (GMT)
Message-ID: <368779.1147468569929.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:16:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-204) Need to tweak a few things in the
 metrics package to support the Simon plugin
In-Reply-To: <22942249.1147204985788.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-204?page=all ]

Doug Cutting updated HADOOP-204:
--------------------------------

    Fix Version: 0.3

> Need to tweak a few things in the metrics package to support the Simon plugin
> -----------------------------------------------------------------------------
>
>          Key: HADOOP-204
>          URL: http://issues.apache.org/jira/browse/HADOOP-204
>      Project: Hadoop
>         Type: Improvement

>   Components: metrics
>     Reporter: David Bowen
>     Assignee: David Bowen
>      Fix For: 0.3
>  Attachments: tweaks.patch
>
> (1) added an extra metrics.jar target to the build.xml so that I can build a stand-alone library containing only the
> metrics package and its subpackages.
> (2) added serialversionUIDs to a bunch of classes to make Eclipse happy
> (3) made AbstractMetricsContext.createRecord final, and added a protected newRecord that subclasses can use
> to customize record creation without breaking the parent class.
> (4) minor fix to how errors in callbacks are handled
> (5) constructor in MetricsRecordImpl made protected rather than package private so that it can be subclassed
> (6) extended Util.parse(String serverSpecs, int defaultPort) to handle the case of a null serverSpecs by defaulting to localhost

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:16:32 2006
Return-Path: 
 <hadoop-dev-return-1400-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1677 invoked from network); 12 May 2006 21:16:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:16:32 -0000
Received: (qmail 86652 invoked by uid 500); 12 May 2006 21:16:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86632 invoked by uid 500); 12 May 2006 21:16:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86622 invoked by uid 99); 12 May 2006 21:16:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:16:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:16:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1E9E17141F2
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:16:09 +0000 (GMT)
Message-ID: <28772345.1147468569122.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:16:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-204) Need to tweak a few things in the
 metrics package to support the Simon plugin
In-Reply-To: <22942249.1147204985788.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-204?page=all ]
     
Doug Cutting resolved HADOOP-204:
---------------------------------

    Resolution: Fixed

I just committed this.  I changed the name of the file generated by the "metrics.jar" task to be hadoop-metrics-X.X.jar, where X.X is the hadoop version.  Should this artifact be included with Hadoop releases?  If so then we should make sure that it is bundled into the .tar.gz file built by the "tar" target.  Or do we always expect its consumers to build it themselves?

> Need to tweak a few things in the metrics package to support the Simon plugin
> -----------------------------------------------------------------------------
>
>          Key: HADOOP-204
>          URL: http://issues.apache.org/jira/browse/HADOOP-204
>      Project: Hadoop
>         Type: Improvement

>   Components: metrics
>     Reporter: David Bowen
>     Assignee: David Bowen
>      Fix For: 0.3
>  Attachments: tweaks.patch
>
> (1) added an extra metrics.jar target to the build.xml so that I can build a stand-alone library containing only the
> metrics package and its subpackages.
> (2) added serialversionUIDs to a bunch of classes to make Eclipse happy
> (3) made AbstractMetricsContext.createRecord final, and added a protected newRecord that subclasses can use
> to customize record creation without breaking the parent class.
> (4) minor fix to how errors in callbacks are handled
> (5) constructor in MetricsRecordImpl made protected rather than package private so that it can be subclassed
> (6) extended Util.parse(String serverSpecs, int defaultPort) to handle the case of a null serverSpecs by defaulting to localhost

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:16:34 2006
Return-Path: 
 <hadoop-dev-return-1402-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1735 invoked from network); 12 May 2006 21:16:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:16:34 -0000
Received: (qmail 86945 invoked by uid 500); 12 May 2006 21:16:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86920 invoked by uid 500); 12 May 2006 21:16:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86910 invoked by uid 99); 12 May 2006 21:16:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:16:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:16:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 23176714293
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:16:11 +0000 (GMT)
Message-ID: <9237078.1147468571141.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:16:11 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-208) add failure page to webapp
In-Reply-To: <25090401.1147300384509.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-208?page=all ]
     
Doug Cutting resolved HADOOP-208:
---------------------------------

    Resolution: Fixed

I just committed this.  It looks great!  Thanks, Owen!

> add failure page to webapp
> --------------------------
>
>          Key: HADOOP-208
>          URL: http://issues.apache.org/jira/browse/HADOOP-208
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: failure-list-2.patch, failure-list.patch
>
> I'd like a webapp page that just lists the failures in a job so that I can find them more easily. I also want to put back the job detail page.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:26:32 2006
Return-Path: 
 <hadoop-dev-return-1403-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3739 invoked from network); 12 May 2006 21:26:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:26:32 -0000
Received: (qmail 99792 invoked by uid 500); 12 May 2006 21:26:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99772 invoked by uid 500); 12 May 2006 21:26:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99763 invoked by uid 99); 12 May 2006 21:26:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:26:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:26:30 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 192CE714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:26:09 +0000 (GMT)
Message-ID: <29881272.1147469169100.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:26:09 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-212?page=comments#action_12383297 ] 

Owen O'Malley commented on HADOOP-212:
--------------------------------------

Sure, look at DFSInputStream.blockSeekTo. You can't generate files that look like that, but the infrastructure supports them.

I'm only trying to expose setting the block size for a given file when it is being created. I don't want to expose changing it _within_ a file.

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3

>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:37:32 2006
Return-Path: 
 <hadoop-dev-return-1404-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6824 invoked from network); 12 May 2006 21:37:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:37:32 -0000
Received: (qmail 12134 invoked by uid 500); 12 May 2006 21:37:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12114 invoked by uid 500); 12 May 2006 21:37:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12105 invoked by uid 99); 12 May 2006 21:37:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:37:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:37:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 45E6771428F
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:37:09 +0000 (GMT)
Message-ID: <32939197.1147469829283.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:37:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-209) Add a program to recursively copy
 directories across file systems
In-Reply-To: <25124034.1147302364527.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-209?page=all ]
     
Doug Cutting resolved HADOOP-209:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

I just committed this.  Thanks, Milind!

> Add a program to recursively copy directories across file systems
> -----------------------------------------------------------------
>
>          Key: HADOOP-209
>          URL: http://issues.apache.org/jira/browse/HADOOP-209
>      Project: Hadoop
>         Type: New Feature

>   Components: fs
>     Versions: 0.3
>  Environment: All
>     Reporter: Milind Bhandarkar
>      Fix For: 0.3
>  Attachments: CopyDir.patch
>
> A useful feature would be a simple command to copy directories recursively across filesystems. The source and destination path should be specified using a filesystem-neutral URI, such as:
> hadoop cp dfs://namenode1:port1/path/to/srcdir file:///path/to/local/destination/dir
> "cp" command would invoke a map-reduce program to copy files recursively.
> I willl attach a patch as soon as svn is up and running.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:47:32 2006
Return-Path: 
 <hadoop-dev-return-1405-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9694 invoked from network); 12 May 2006 21:47:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:47:32 -0000
Received: (qmail 23768 invoked by uid 500); 12 May 2006 21:47:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23745 invoked by uid 500); 12 May 2006 21:47:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23734 invoked by uid 99); 12 May 2006 21:47:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:47:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:47:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7A8A9714292
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:47:09 +0000 (GMT)
Message-ID: <31075160.1147470429499.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:47:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-146) potential conflict in block id's,
 leading to data corruption
In-Reply-To: <2179039.1145398037471.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-146?page=all ]
     
Doug Cutting resolved HADOOP-146:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Konstantin!

> potential conflict in block id's, leading to data corruption
> ------------------------------------------------------------
>
>          Key: HADOOP-146
>          URL: http://issues.apache.org/jira/browse/HADOOP-146
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>      Fix For: 0.3
>  Attachments: hadoop-146-random.patch
>
> currently, block id's are generated randomly, and are not tested for collisions with existing id's.
> while ids are 64 bits, given enough time and a large enough FS, collisions are expected.
> when a collision occurs, a random subset of blocks with that id will be removed as extra replicas, and the contents of that portion of the containing file are one random version of the block.
> to solve this one could check for id collision when creating a new block, getting a new id in case of conflict. This approach requires the name node to keep track of all existing block id's (rather than just the ones who have reported in), and to identify old versions of a block id as in valid (in case a data node dies, a file is deleted, then a block id is reused for a new file).
> Alternatively, one could simply use sequential block id's. Here the downsides are: 
> 1. migration from an existing file system is hard, requiring compaction of the entire FS
> 2. once you cycle through 64 bits of id's (quite a few years at full blast), you're in trouble again (or run occasional/background compaction)
> 3. you must never lose the high watermark block id.
> synchronized Block allocateBlock(UTF8 src) {
>         Block b = new Block();
>         FileUnderConstruction v = (FileUnderConstruction) pendingCreates.get(src);
>         v.add(b);
>         pendingCreateBlocks.add(b);
>         return b;
>     }
> static Random r = new Random();
>     /**
>      */
>     public Block() {
>         this.blkid = r.nextLong();
>         this.len = 0;
>     }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:49:32 2006
Return-Path: 
 <hadoop-dev-return-1406-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10055 invoked from network); 12 May 2006 21:49:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:49:32 -0000
Received: (qmail 24713 invoked by uid 500); 12 May 2006 21:49:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24691 invoked by uid 500); 12 May 2006 21:49:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24682 invoked by uid 99); 12 May 2006 21:49:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:49:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:49:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9EA03714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:49:09 +0000 (GMT)
Message-ID: <29091275.1147470549646.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:49:09 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-146) potential conflict in block id's,
 leading to data corruption
In-Reply-To: <2179039.1145398037471.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-146?page=comments#action_12383305 ] 

Doug Cutting commented on HADOOP-146:
-------------------------------------

Oops.  I meant, "Thanks Milind! "  Sorry.  I wasn't paying attention.

> potential conflict in block id's, leading to data corruption
> ------------------------------------------------------------
>
>          Key: HADOOP-146
>          URL: http://issues.apache.org/jira/browse/HADOOP-146
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0, 0.1.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>      Fix For: 0.3
>  Attachments: hadoop-146-random.patch
>
> currently, block id's are generated randomly, and are not tested for collisions with existing id's.
> while ids are 64 bits, given enough time and a large enough FS, collisions are expected.
> when a collision occurs, a random subset of blocks with that id will be removed as extra replicas, and the contents of that portion of the containing file are one random version of the block.
> to solve this one could check for id collision when creating a new block, getting a new id in case of conflict. This approach requires the name node to keep track of all existing block id's (rather than just the ones who have reported in), and to identify old versions of a block id as in valid (in case a data node dies, a file is deleted, then a block id is reused for a new file).
> Alternatively, one could simply use sequential block id's. Here the downsides are: 
> 1. migration from an existing file system is hard, requiring compaction of the entire FS
> 2. once you cycle through 64 bits of id's (quite a few years at full blast), you're in trouble again (or run occasional/background compaction)
> 3. you must never lose the high watermark block id.
> synchronized Block allocateBlock(UTF8 src) {
>         Block b = new Block();
>         FileUnderConstruction v = (FileUnderConstruction) pendingCreates.get(src);
>         v.add(b);
>         pendingCreateBlocks.add(b);
>         return b;
>     }
> static Random r = new Random();
>     /**
>      */
>     public Block() {
>         this.blkid = r.nextLong();
>         this.len = 0;
>     }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 21:49:33 2006
Return-Path: 
 <hadoop-dev-return-1407-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10078 invoked from network); 12 May 2006 21:49:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 21:49:33 -0000
Received: (qmail 24955 invoked by uid 500); 12 May 2006 21:49:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24832 invoked by uid 500); 12 May 2006 21:49:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24823 invoked by uid 99); 12 May 2006 21:49:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:49:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 14:49:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 79272714292
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 21:49:10 +0000 (GMT)
Message-ID: <24929820.1147470550493.JavaMail.root@brutus>
Date: Fri, 12 May 2006 21:49:10 +0000 (GMT+00:00)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-152) Speculative tasks not being
 scheduled
In-Reply-To: <14064096.1145554385768.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-152?page=comments#action_12383306 ] 

Bryan Pendleton commented on HADOOP-152:
----------------------------------------

*bump*

Is anyone else seeing this problem? My cluster is pretty unevenly loaded, and, without speculative execution, I'm waiting for very long times for tasks to timeout on short jobs. Speculative execution is enabled, so there's no reason that, say, two maps out of ~1900 should be holding up execution. I suspect the "progress" accounting being done in the Job isn't being done correctly.

But, even then, perhaps we need more metrics - with the current metrics, if one of the job units happens to be running really slowly on a given node, but might run faster on other nodes, it might never get executed on another node because the progress on the slow node might be reported as close enough to done so as to not trip the speculative execution.

> Speculative tasks not being scheduled
> -------------------------------------
>
>          Key: HADOOP-152
>          URL: http://issues.apache.org/jira/browse/HADOOP-152
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>  Environment: ~30 node Opteron cluster
>     Reporter: Bryan Pendleton
>     Priority: Minor

>
> The criteria for starting up a speculative task includes a check that the "average progress"-"progress" > the speculative gap, currently 0.2.
> I don't know if this is the right metric, but it doesn't seem to be correctly calculated. I've regularly seen the "average progress" with values of less than 0.01, while the "progress" value is showing in the range .90-1.0, and yet, still no speculative tasks are started up. This has caused at least one long-running task to run about 10% longer while overloaded hosts catch up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 22:36:36 2006
Return-Path: 
 <hadoop-dev-return-1408-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31298 invoked from network); 12 May 2006 22:36:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 22:36:36 -0000
Received: (qmail 69970 invoked by uid 500); 12 May 2006 22:36:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69492 invoked by uid 500); 12 May 2006 22:36:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69267 invoked by uid 99); 12 May 2006 22:36:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 15:36:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 15:36:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5ACA7714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 22:36:10 +0000 (GMT)
Message-ID: <29783830.1147473370369.JavaMail.root@brutus>
Date: Fri, 12 May 2006 22:36:10 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-75) dfs should check full file availability
 only at close
In-Reply-To: <873621841.1142030138809.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-75?page=all ]

Milind Bhandarkar updated HADOOP-75:
------------------------------------

    Attachment: hadoop-75.patch

Added a patch that removes that check (whether the previous blocks have been replicated or not) after adding every block to the file in construction. Now it checks that all file blocks have been replicated only at close of a file.

> dfs should check full file availability only at close
> -----------------------------------------------------
>
>          Key: HADOOP-75
>          URL: http://issues.apache.org/jira/browse/HADOOP-75
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: hadoop-75.patch
>
> Currently it appears that dfs checks that the namenode knows about all blocks in a file as each block is written.  It would be more efficient to only check that all blocks are stored somewhere when the file is closed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 23:02:32 2006
Return-Path: 
 <hadoop-dev-return-1409-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40265 invoked from network); 12 May 2006 23:02:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 23:02:32 -0000
Received: (qmail 95207 invoked by uid 500); 12 May 2006 23:02:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 95084 invoked by uid 500); 12 May 2006 23:02:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 95075 invoked by uid 99); 12 May 2006 23:02:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 16:02:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 16:02:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 189FE714291
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 23:02:09 +0000 (GMT)
Message-ID: <15176310.1147474929097.JavaMail.root@brutus>
Date: Fri, 12 May 2006 23:02:09 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-212?page=comments#action_12383319 ] 

alan wootton commented on HADOOP-212:
-------------------------------------

Ok, I get it now. Even though it's currently impossible for any block, except the last block of a file, to be anything other than 32mb it looks like the system would support it.

We need to remove all references to BLOCK_SIZE. 

I see some problems. FSSataSet doesn't know which file it's working with. It always uses BLOCK_SIZE.  DFSClient.DFSOutputStream.write() has same problem. 

I'll vote yes.





> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3

>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 12 23:33:32 2006
Return-Path: 
 <hadoop-dev-return-1410-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50063 invoked from network); 12 May 2006 23:33:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 May 2006 23:33:32 -0000
Received: (qmail 23919 invoked by uid 500); 12 May 2006 23:33:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23899 invoked by uid 500); 12 May 2006 23:33:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23890 invoked by uid 99); 12 May 2006 23:33:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 16:33:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 16:33:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 83711714290
	for <hadoop-dev@lucene.apache.org>; Fri, 12 May 2006 23:33:09 +0000 (GMT)
Message-ID: <21473989.1147476789535.JavaMail.root@brutus>
Date: Fri, 12 May 2006 23:33:09 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-124) don't permit two datanodes to run from
 same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]

Konstantin Shvachko updated HADOOP-124:
---------------------------------------

    Attachment: DatanodeRegister.txt

Here is an algorithm that imo solves the problem in the most general case.
This is the registration part only, since the rest is rather straightforward.

I'm trying to cover two issues.
1) Data nodes should be banned from reporting the same block copies multiple times
if they are intentionally or unintentionally started to serve the same data storage.
That is why data nodes need to register, and need to keep a persistent storageID.
2) Name node should be able to recognize registered data nodes, even if it is restarted
or replaced by a spare name node serving the same name space.
That is why name nodes need to keep a persistent namespaceID.

Comments are highly appreciated.


> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May 13 00:58:36 2006
Return-Path: 
 <hadoop-dev-return-1411-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64297 invoked from network); 13 May 2006 00:58:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 May 2006 00:58:36 -0000
Received: (qmail 86246 invoked by uid 500); 13 May 2006 00:58:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86114 invoked by uid 500); 13 May 2006 00:58:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85677 invoked by uid 99); 13 May 2006 00:58:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 17:58:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 17:58:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 23A4B7142AE
	for <hadoop-dev@lucene.apache.org>; Sat, 13 May 2006 00:58:10 +0000 (GMT)
Message-ID: <1616267.1147481890143.JavaMail.root@brutus>
Date: Sat, 13 May 2006 00:58:10 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-217) IllegalAcessException when creating a
 Block object via WritableFactories
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

IllegalAcessException when creating a Block object via WritableFactories
------------------------------------------------------------------------

         Key: HADOOP-217
         URL: http://issues.apache.org/jira/browse/HADOOP-217
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.3    
    Reporter: Hairong Kuang
 Assigned to: Hairong Kuang 
     Fix For: 0.3
 Attachments: access.patch

When I ran the dfs namenode, I received an error message listed below. Changing Block class to be public will be able to fix the problem.

java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
        at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
        at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:226)
        at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:163)
        at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:211)
        at org.apache.hadoop.ipc.RPC$Invocation.readFields(RPC.java:88)
        at org.apache.hadoop.ipc.Server$Connection.run(Server.java:154)
Caused by: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
        at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:65)
        at java.lang.Class.newInstance0(Class.java:344)
        at java.lang.Class.newInstance(Class.java:303)
        at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:45)
        ... 5 more


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May 13 00:58:37 2006
Return-Path: 
 <hadoop-dev-return-1412-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64321 invoked from network); 13 May 2006 00:58:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 May 2006 00:58:37 -0000
Received: (qmail 86276 invoked by uid 500); 13 May 2006 00:58:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86260 invoked by uid 500); 13 May 2006 00:58:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86250 invoked by uid 99); 13 May 2006 00:58:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 17:58:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 17:58:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EF8327142B7
	for <hadoop-dev@lucene.apache.org>; Sat, 13 May 2006 00:58:10 +0000 (GMT)
Message-ID: <31385206.1147481890978.JavaMail.root@brutus>
Date: Sat, 13 May 2006 00:58:10 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-217) IllegalAcessException when creating a
 Block object via WritableFactories
In-Reply-To: <1616267.1147481890143.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-217?page=all ]

Hairong Kuang updated HADOOP-217:
---------------------------------

    Attachment: access.patch

> IllegalAcessException when creating a Block object via WritableFactories
> ------------------------------------------------------------------------
>
>          Key: HADOOP-217
>          URL: http://issues.apache.org/jira/browse/HADOOP-217
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.3
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>      Fix For: 0.3
>  Attachments: access.patch
>
> When I ran the dfs namenode, I received an error message listed below. Changing Block class to be public will be able to fix the problem.
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:226)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:163)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:211)
>         at org.apache.hadoop.ipc.RPC$Invocation.readFields(RPC.java:88)
>         at org.apache.hadoop.ipc.Server$Connection.run(Server.java:154)
> Caused by: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
>         at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:65)
>         at java.lang.Class.newInstance0(Class.java:344)
>         at java.lang.Class.newInstance(Class.java:303)
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:45)
>         ... 5 more

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May 13 05:03:34 2006
Return-Path: 
 <hadoop-dev-return-1413-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7806 invoked from network); 13 May 2006 05:03:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 May 2006 05:03:34 -0000
Received: (qmail 22344 invoked by uid 500); 13 May 2006 05:03:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22310 invoked by uid 500); 13 May 2006 05:03:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22293 invoked by uid 99); 13 May 2006 05:03:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 22:03:31 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 May 2006 22:03:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B1FF5714291
	for <hadoop-dev@lucene.apache.org>; Sat, 13 May 2006 05:03:08 +0000 (GMT)
Message-ID: <13079447.1147496588699.JavaMail.root@brutus>
Date: Sat, 13 May 2006 05:03:08 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12383356 ] 

eric baldeschwieler commented on HADOOP-211:
--------------------------------------------

What real advantage do we get  from all of this flexibility?

One of our goals for attacking the logging system is to allow us to easily process the logs with the system.  To do that will require building readers that can deal with the log format and organization.  I'd hate to loose that in the interest of complete generality.

Just curious what use case we are after with complete reformability and abstract logging.



> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May 14 20:24:44 2006
Return-Path: 
 <hadoop-dev-return-1414-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51332 invoked from network); 14 May 2006 20:24:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 May 2006 20:24:44 -0000
Received: (qmail 88667 invoked by uid 500); 14 May 2006 20:24:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88566 invoked by uid 500); 14 May 2006 20:24:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88557 invoked by uid 99); 14 May 2006 20:24:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 13:24:43 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of michael.cafarella@gmail.com
 designates 64.233.184.238 as permitted sender)
Received: from [64.233.184.238] (HELO wr-out-0506.google.com) (64.233.184.238)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 13:24:42 -0700
Received: by wr-out-0506.google.com with SMTP id i7so944497wra
        for <hadoop-dev@lucene.apache.org>;
 Sun, 14 May 2006 13:24:19 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=qnOUtJvPvztAeDbZCjyfuqpZSyD0Fn0kaYfqqTU13+fjq5p8SRZ4oNsH8QsGvy5zj0cVN4hpaZHpUuK1lttcs36s6hdz6JY357mv0qVnAiIFZeb807B/sO1FuxTxugCK6222islPybat6Qz8s2FY+tsB10IRd53qhE85M9EQbGo=
Received: by 10.65.233.12 with SMTP id k12mr1240780qbr;
        Sun, 14 May 2006 13:24:19 -0700 (PDT)
Received: by 10.64.220.14 with HTTP; Sun, 14 May 2006 13:24:19 -0700 (PDT)
Message-ID: <8a8b9f3f0605141324y9f5d200v1cee74ed9123f27@mail.gmail.com>
Date: Sun, 14 May 2006 13:24:19 -0700
From: "Michael Cafarella" <michael.cafarella@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Re: BigTable
In-Reply-To: <a494a0bc0605110008v5ffb008dkdc781f4ae24e5f87@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <a494a0bc0605110008v5ffb008dkdc781f4ae24e5f87@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Leen,

I've taken a look at this, and it's quite feasible.  I've been
working on a class I call HStore, which is a single-machine
row store.  This would be an important building block in any
such system.  (One would then need to design the table-distribution
aspect.)

Stefan, if you've got something in this area, perhaps we should
share...

--Mike



On 5/11/06, Leen Toelen <toelen@gmail.com> wrote:
> Hi,
>
> are there any plans to create a structured data storage system like
> Google's BigTable in Hadoop? Their implementation relies heavily on
> mapreduce and gfs, so Hadoop is an ideal match. BigTable is what
> drives google base, earth and news for instance.
>
> http://blog.outer-court.com/archive/2005-10-23-n61.html
>
> Regards,
> Leen Toelen
>

From MAILER-DAEMON Sun May 14 20:37:19 2006
Return-Path: 
 <hadoop-dev-return-1415-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54325 invoked from network); 14 May 2006 20:37:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 May 2006 20:37:19 -0000
Received: (qmail 94480 invoked by uid 500); 14 May 2006 20:37:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94459 invoked by uid 500); 14 May 2006 20:37:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94449 invoked by uid 99); 14 May 2006 20:37:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 13:37:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 13:37:18 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 879D11445D6
	for <hadoop-dev@lucene.apache.org>; Sun, 14 May 2006 22:17:42 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 32029-09 for <hadoop-dev@lucene.apache.org>;
	Sun, 14 May 2006 22:17:42 +0200 (CEST)
Received: from [10.10.16.254] (unknown [64.71.164.125])
	by mslinux.media-style.com (Postfix) with ESMTP id DA2D71445D2
	for <hadoop-dev@lucene.apache.org>; Sun, 14 May 2006 22:17:41 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <8a8b9f3f0605141324y9f5d200v1cee74ed9123f27@mail.gmail.com>
References: <a494a0bc0605110008v5ffb008dkdc781f4ae24e5f87@mail.gmail.com>
 <8a8b9f3f0605141324y9f5d200v1cee74ed9123f27@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <7FDCDE93-634B-4048-AC69-0E6D1D2ED5B5@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: BigTable
Date: Sun, 14 May 2006 13:36:46 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

> Stefan, if you've got something in this area, perhaps we should
> share...

Yes I would love to! I was working on basic infrastructure like  
master - slave  - client but there are no well working node internals  
itself (write buffer, checkpoint writing etc.).
I can clean up stuff and put it somewhere if there is interest but I  
need some time since I will be not able to access the code until next  
days.

However beside that I in general very much interested to work with  
other people on this.
May be we can make a short general master plan and split the work?

Stefan
	

From MAILER-DAEMON Sun May 14 22:00:27 2006
Return-Path: 
 <hadoop-dev-return-1416-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67833 invoked from network); 14 May 2006 22:00:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 May 2006 22:00:27 -0000
Received: (qmail 33225 invoked by uid 500); 14 May 2006 22:00:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33206 invoked by uid 500); 14 May 2006 22:00:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33197 invoked by uid 99); 14 May 2006 22:00:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 15:00:27 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of michael.cafarella@gmail.com
 designates 64.233.184.232 as permitted sender)
Received: from [64.233.184.232] (HELO wr-out-0506.google.com) (64.233.184.232)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 15:00:26 -0700
Received: by wr-out-0506.google.com with SMTP id i31so692195wra
        for <hadoop-dev@lucene.apache.org>;
 Sun, 14 May 2006 15:00:03 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=r40BYYIuLTRlT57qISgRAm8qN6H0qTF+1UFXH+oGPlS6ZJCXSK7kR6PV/p1IXu3yHKhmJyi32kvM7TCInjSMTEXY+fllWlNurY8jvJpzBn0UF/Z4vWwVTAjkzo59a/SF7IvVCr/AQCcsY38U2OdW7rslDd66q60kQyXimbhvsvY=
Received: by 10.65.22.16 with SMTP id z16mr417491qbi;
        Sun, 14 May 2006 15:00:03 -0700 (PDT)
Received: by 10.64.220.14 with HTTP; Sun, 14 May 2006 15:00:03 -0700 (PDT)
Message-ID: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
Date: Sun, 14 May 2006 15:00:03 -0700
From: "Michael Cafarella" <michael.cafarella@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: HBase Design Ideas, Part I
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi everyone,

I've written up a design that I've been working on for a little bit, for
a project I'll call "HBase".  The idea is for Hadoop to implement something
similar in spirit to BigTable.  That is, a distributed data store that
places a greater emphasis on scalability than on SQL compatibility
or traditional transactional correctness.

BigTable is neither completely described anywhere, nor is it
necessarily exactly what we want.  So I'm not trying to clone BigTable,
but I am going to draw on it a lot.

My personal view is that BigTable is a great "physical layer" but not yet
a great database system.  A major thing it lacks is a good query language.
Another, freely admitted by the Google people, is any kind of inter-row
locking.  I'm not going to try to solve all these problems, but I would
like HBase to be extendible enough that it's easy to add new query
languages or primitives.

In this mail, I'll describe a system that's pretty similar to BigTable.
I'll send a second one that describes what we might want to change
or add.

Please let me know what you think!

Thanks,
--Mike

---------------------------------------------------------------------------=
-----
I.  Table semantics

An HBase consists of one or more HTables.  An HTable is a list of rows,
sorted alphabetically by "row name".  An HTable also has a series of
"columns."  A row may or may not contain a value for a column.  The
HTable representation is sparse, so if a row does not contain a value
for a given column, there is no storage overhead.

(Thus, there's not really a "schema" to an HTable.  Every operation, even
adding a column, is considered a row-centric operation.)

The "current version" of a row is always available, timestamped with its
last modification date.  The system may also store previous versions of a r=
ow,
according to how the HTable is configured.

Updates to a single row are always atomic and can affect one or more column=
s.

II.  System layout

HTables are partitionable into contiguous row regions called HRegions.
All machines in a pool run an HRegionServer.  A given HRegion is served
to clients by a single HRegionServer.  A single HRegionServer may be
responsible for many HRegions.  The HRegions for a single HTable will
be scattered across arbitrary HRegionServers.

When a client wants to add/delete/update a row value, it must locate the
relevant HRegionServer.  It then contacts the HRegionServer and communicate=
s
the updates.  There may be other steps, mainly lock-oriented ones.  But loc=
ating
the relevant HRegionServers is a bare minimum.

The HBase system can repartition an HTable at any time.  For example, many
repeated inserts at a single location may cause a single HRegion to grow
very large.  The HBase would then try to split that into multiple HRegions.
Those HRegions may be served by the same HRegionServer as the
original or may be served by a different one.

Each HRegionServer sends a regular heartbeat to an HBaseMaster machine.
If the heartbeat for an HRegionServer fails, then the HBaseMaster is respon=
sible
for reassigning its HRegions to other available HRegionServers.

All HRegions are stored within DFS, so the HRegion is always available, eve=
n
in the face of machine failures.  The HRegionServers and DFS DataNodes run
on the same set of machines.  We would like for an HRegionServer to always
serve data stored locally, but that is not guaranteed when using DFS.  We c=
an
encourage it by:
1) In the event of an insert-motivated HRegion move, the new HRegionServer
should always create a new DFS file for the new HRegion.  The DFS rules of
thumb will allocate the chunks locally for the HRegionServer.
2) In the even of a machine failure, we cannot do anything similar to above=
.
Instead, the HBaseMaster can ask DFS for hints as to where the relevant
file blocks are stored.  If possible, it will allocate the new
HRegions to servers
that physically contain the HRegion.
3) If necessary, we could add an API to DFS that demands block replication
to a given node.  I'd like to avoid this if possible.

The mapping from row to HRegion (and hence, to HRegionServer) is itself
stored in a special HTable.  The HBaseMaster is the only client allowed to
write to this HTable.  This special HTable may itself be split into several
HRegions.  However, we only allow a hard-coded number of split-levels.
The top level of this hierarchy must be easily-stored on a single machine.
That top-level table is always served by the HBaseMaster itself.

III.  Client behavior

Let's think about what happens when a client wants to add a row.
1) The client must compute what HRegion is responsible for the key
it wants to insert into the HTable.  It must navigate the row->HRegion
mapping, which is stored in an HTable.

So the client first contacts the HBaseMaster for the top-level table conten=
ts.
It then steps downward through the table set, until it finds the mapping fo=
r
the target row.

2) The client contacts the HRegionServer responsible for the target row,
and asks to insert.  If the HRegionServer is no longer responsible for the
relevant HRegion, it returns a failure message and tells the client to go
back to step 1 to find the new correct HRegionServer.

If the HRegionServer is the right place to go, it accepts the new row from
the client.  The HRegionServer guarantees that the insert is atomic; it
will not intermingle the insert with a competing insert for the same row ke=
y.
When the row is stored, the HRegionServer includes version and timestamp
information.

3) That's it!

IV The HRegionServer

Maintaining the data for a single HRegion is slightly complicated.  It's
especially weird given the write-once semantics of DFS.  There are
three important moving parts:

1) HBackedStore is a file-backed store for rows and their values.
It is never edited in place.  It has B-Tree-like lookups for finding
a row quickly.  HBackedStore is actually a series of on-disk stores,
each store being tuned for a certain object size.  Thus, all the "small"
(in bytes) values for a row live within the same file, all the medium
ones live in a separate file, etc.  There is only one HBackedStore
for any single HRegion.

2) HUpdateLog is a log of updates to the HBackedStore.  It is backed
by an on-disk file.  When making reads from the HBackedStore, it may
be necessary to consult the HUpdateLog to see if any more-recent
updates have been made.  There may be a series of HUpdateLogs
for a single HRegion.

3) HUpdateBuf is an in-memory version of HUpdateLog.  It, too, needs
to be consulted whenever performing a read.  There is only one
HUpdateBuf for a single HRegion.

Any incoming edit is first made directly to the HUpdateBuf.  Changes
made to the HUpdateBuf are volatile until flushed to an HUpdateLog.
The rate of flushes is an admin-configurable parameter.

Periodically, the HBackedStore and the series of current HUpdateLogs
are merged to form a new HBackedStore.  At that point, the old HUpdateLog
objects can be destroyed.  During this compaction process, edits are
made to the HUpdateBuf.

From MAILER-DAEMON Sun May 14 22:09:37 2006
Return-Path: 
 <hadoop-dev-return-1417-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70305 invoked from network); 14 May 2006 22:09:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 May 2006 22:09:37 -0000
Received: (qmail 41094 invoked by uid 500); 14 May 2006 22:09:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41074 invoked by uid 500); 14 May 2006 22:09:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41065 invoked by uid 99); 14 May 2006 22:09:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 15:09:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 15:09:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F32747141EF
	for <hadoop-dev@lucene.apache.org>; Sun, 14 May 2006 22:09:05 +0000 (GMT)
Message-ID: <22268273.1147644545906.JavaMail.jira@brutus>
Date: Sun, 14 May 2006 22:09:05 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-218) Inefficient calls to get configuration
 values in TaskInprogress
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Inefficient calls to get configuration values in TaskInprogress
---------------------------------------------------------------

         Key: HADOOP-218
         URL: http://issues.apache.org/jira/browse/HADOOP-218
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Reporter: Mahadev konar
 Assigned to: Mahadev konar 
    Priority: Minor


Each time a pollforNewTask in called on the JobTracker, the taskinprogress makes a call to hasSpeculativeTask() which current does a conf.getSpeculativeExecution() each time its called. The fix would be to store it in the TaskInProgress as soon as it is created and make only a single call to conf.getSpeculativeExecution().

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May 14 22:11:32 2006
Return-Path: 
 <hadoop-dev-return-1418-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70773 invoked from network); 14 May 2006 22:11:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 May 2006 22:11:32 -0000
Received: (qmail 41684 invoked by uid 500); 14 May 2006 22:11:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41654 invoked by uid 500); 14 May 2006 22:11:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41645 invoked by uid 99); 14 May 2006 22:11:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 15:11:32 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 15:11:31 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CFFF7141ED
	for <hadoop-dev@lucene.apache.org>; Sun, 14 May 2006 22:11:06 +0000 (GMT)
Message-ID: <18346938.1147644666575.JavaMail.jira@brutus>
Date: Sun, 14 May 2006 22:11:06 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-218) Inefficient calls to get configuration
 values in TaskInprogress
In-Reply-To: <22268273.1147644545906.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-218?page=all ]

Mahadev konar updated HADOOP-218:
---------------------------------

    Attachment: speculative.patch

Here is a patch, that gets the configuration value once and stores it in the TaskInProgress.

> Inefficient calls to get configuration values in TaskInprogress
> ---------------------------------------------------------------
>
>          Key: HADOOP-218
>          URL: http://issues.apache.org/jira/browse/HADOOP-218
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>  Attachments: speculative.patch
>
> Each time a pollforNewTask in called on the JobTracker, the taskinprogress makes a call to hasSpeculativeTask() which current does a conf.getSpeculativeExecution() each time its called. The fix would be to store it in the TaskInProgress as soon as it is created and make only a single call to conf.getSpeculativeExecution().

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 03:59:04 2006
Return-Path: 
 <hadoop-dev-return-1419-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59505 invoked from network); 15 May 2006 03:59:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 03:59:04 -0000
Received: (qmail 19814 invoked by uid 500); 15 May 2006 03:58:59 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19679 invoked by uid 500); 15 May 2006 03:58:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19501 invoked by uid 99); 15 May 2006 03:58:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 20:58:58 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 14 May 2006 20:58:56 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4F3uTYG099430
	for <hadoop-dev@lucene.apache.org>; Sun, 14 May 2006 20:56:29 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=LSfcbKm7mL5g4t4uslXngaXqXuCcvIll/iB0vn4MwiCxg5ZwFOnaShwkvK//qemh
Received: from [10.0.1.2] ([172.21.179.133]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Sun, 14 May 2006 20:56:29 -0700
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
References: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <37AB4917-06E2-4781-8316-D6ABDDEA7F9B@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: HBase Design Ideas, Part I
Date: Sun, 14 May 2006 20:56:26 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-OriginalArrivalTime: 15 May 2006 03:56:29.0336 (UTC)
 FILETIME=[8BC49980:01C677D3]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Seems like you are exporting a lot of complexity to the clients by  
having them find the table chunks via DFS read.  Lots of data motion  
and sync / cache issues there.  When not just ask the master for the  
block/server of a key?  Or you could distribute this work over your  
HRegionServers if you don't want to stress the master.  All this  
could be kept fresh in RAM there (segmented if you get huge). [but  
this adds complexity]

As I read you design, it sounds like you might be doing a lot of  
seeks to find a record (do you need to scan all the logs to see if a  
key is present?).  Best to outline the performance you want and then  
look at the ram / disk trade-offs.  IE you can store everything in  
BTRees, but then you will thrash you disks.  Or you can store  
everything linearly and store all your unmerged entries in RAM.  This  
would have different costs/benefits...


On May 14, 2006, at 3:00 PM, Michael Cafarella wrote:

> Hi everyone,
>
> I've written up a design that I've been working on for a little  
> bit, for
> a project I'll call "HBase".  The idea is for Hadoop to implement  
> something
> similar in spirit to BigTable.  That is, a distributed data store that
> places a greater emphasis on scalability than on SQL compatibility
> or traditional transactional correctness.
>
> BigTable is neither completely described anywhere, nor is it
> necessarily exactly what we want.  So I'm not trying to clone  
> BigTable,
> but I am going to draw on it a lot.
>
> My personal view is that BigTable is a great "physical layer" but  
> not yet
> a great database system.  A major thing it lacks is a good query  
> language.
> Another, freely admitted by the Google people, is any kind of inter- 
> row
> locking.  I'm not going to try to solve all these problems, but I  
> would
> like HBase to be extendible enough that it's easy to add new query
> languages or primitives.
>
> In this mail, I'll describe a system that's pretty similar to  
> BigTable.
> I'll send a second one that describes what we might want to change
> or add.
>
> Please let me know what you think!
>
> Thanks,
> --Mike
>
> ---------------------------------------------------------------------- 
> ----------
> I.  Table semantics
>
> An HBase consists of one or more HTables.  An HTable is a list of  
> rows,
> sorted alphabetically by "row name".  An HTable also has a series of
> "columns."  A row may or may not contain a value for a column.  The
> HTable representation is sparse, so if a row does not contain a value
> for a given column, there is no storage overhead.
>
> (Thus, there's not really a "schema" to an HTable.  Every  
> operation, even
> adding a column, is considered a row-centric operation.)
>
> The "current version" of a row is always available, timestamped  
> with its
> last modification date.  The system may also store previous  
> versions of a row,
> according to how the HTable is configured.
>
> Updates to a single row are always atomic and can affect one or  
> more columns.
>
> II.  System layout
>
> HTables are partitionable into contiguous row regions called HRegions.
> All machines in a pool run an HRegionServer.  A given HRegion is  
> served
> to clients by a single HRegionServer.  A single HRegionServer may be
> responsible for many HRegions.  The HRegions for a single HTable will
> be scattered across arbitrary HRegionServers.
>
> When a client wants to add/delete/update a row value, it must  
> locate the
> relevant HRegionServer.  It then contacts the HRegionServer and  
> communicates
> the updates.  There may be other steps, mainly lock-oriented ones.   
> But locating
> the relevant HRegionServers is a bare minimum.
>
> The HBase system can repartition an HTable at any time.  For  
> example, many
> repeated inserts at a single location may cause a single HRegion to  
> grow
> very large.  The HBase would then try to split that into multiple  
> HRegions.
> Those HRegions may be served by the same HRegionServer as the
> original or may be served by a different one.
>
> Each HRegionServer sends a regular heartbeat to an HBaseMaster  
> machine.
> If the heartbeat for an HRegionServer fails, then the HBaseMaster  
> is responsible
> for reassigning its HRegions to other available HRegionServers.
>
> All HRegions are stored within DFS, so the HRegion is always  
> available, even
> in the face of machine failures.  The HRegionServers and DFS  
> DataNodes run
> on the same set of machines.  We would like for an HRegionServer to  
> always
> serve data stored locally, but that is not guaranteed when using  
> DFS.  We can
> encourage it by:
> 1) In the event of an insert-motivated HRegion move, the new  
> HRegionServer
> should always create a new DFS file for the new HRegion.  The DFS  
> rules of
> thumb will allocate the chunks locally for the HRegionServer.
> 2) In the even of a machine failure, we cannot do anything similar  
> to above.
> Instead, the HBaseMaster can ask DFS for hints as to where the  
> relevant
> file blocks are stored.  If possible, it will allocate the new
> HRegions to servers
> that physically contain the HRegion.
> 3) If necessary, we could add an API to DFS that demands block  
> replication
> to a given node.  I'd like to avoid this if possible.
>
> The mapping from row to HRegion (and hence, to HRegionServer) is  
> itself
> stored in a special HTable.  The HBaseMaster is the only client  
> allowed to
> write to this HTable.  This special HTable may itself be split into  
> several
> HRegions.  However, we only allow a hard-coded number of split-levels.
> The top level of this hierarchy must be easily-stored on a single  
> machine.
> That top-level table is always served by the HBaseMaster itself.
>
> III.  Client behavior
>
> Let's think about what happens when a client wants to add a row.
> 1) The client must compute what HRegion is responsible for the key
> it wants to insert into the HTable.  It must navigate the row->HRegion
> mapping, which is stored in an HTable.
>
> So the client first contacts the HBaseMaster for the top-level  
> table contents.
> It then steps downward through the table set, until it finds the  
> mapping for
> the target row.
>
> 2) The client contacts the HRegionServer responsible for the target  
> row,
> and asks to insert.  If the HRegionServer is no longer responsible  
> for the
> relevant HRegion, it returns a failure message and tells the client  
> to go
> back to step 1 to find the new correct HRegionServer.
>
> If the HRegionServer is the right place to go, it accepts the new  
> row from
> the client.  The HRegionServer guarantees that the insert is  
> atomic; it
> will not intermingle the insert with a competing insert for the  
> same row key.
> When the row is stored, the HRegionServer includes version and  
> timestamp
> information.
>
> 3) That's it!
>
> IV The HRegionServer
>
> Maintaining the data for a single HRegion is slightly complicated.   
> It's
> especially weird given the write-once semantics of DFS.  There are
> three important moving parts:
>
> 1) HBackedStore is a file-backed store for rows and their values.
> It is never edited in place.  It has B-Tree-like lookups for finding
> a row quickly.  HBackedStore is actually a series of on-disk stores,
> each store being tuned for a certain object size.  Thus, all the  
> "small"
> (in bytes) values for a row live within the same file, all the medium
> ones live in a separate file, etc.  There is only one HBackedStore
> for any single HRegion.
>
> 2) HUpdateLog is a log of updates to the HBackedStore.  It is backed
> by an on-disk file.  When making reads from the HBackedStore, it may
> be necessary to consult the HUpdateLog to see if any more-recent
> updates have been made.  There may be a series of HUpdateLogs
> for a single HRegion.
>
> 3) HUpdateBuf is an in-memory version of HUpdateLog.  It, too, needs
> to be consulted whenever performing a read.  There is only one
> HUpdateBuf for a single HRegion.
>
> Any incoming edit is first made directly to the HUpdateBuf.  Changes
> made to the HUpdateBuf are volatile until flushed to an HUpdateLog.
> The rate of flushes is an admin-configurable parameter.
>
> Periodically, the HBackedStore and the series of current HUpdateLogs
> are merged to form a new HBackedStore.  At that point, the old  
> HUpdateLog
> objects can be destroyed.  During this compaction process, edits are
> made to the HUpdateBuf.


From MAILER-DAEMON Mon May 15 09:52:50 2006
Return-Path: 
 <hadoop-dev-return-1420-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79457 invoked from network); 15 May 2006 09:52:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 09:52:50 -0000
Received: (qmail 86777 invoked by uid 500); 15 May 2006 09:52:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86751 invoked by uid 500); 15 May 2006 09:52:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86738 invoked by uid 99); 15 May 2006 09:52:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 02:52:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 02:52:48 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 984D71445E7
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 11:33:07 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 06613-09 for <hadoop-dev@lucene.apache.org>;
	Mon, 15 May 2006 11:33:07 +0200 (CEST)
Received: from [172.16.0.105] (adsl-71-129-29-145.dsl.pltn13.pacbell.net
 [71.129.29.145])
	by mslinux.media-style.com (Postfix) with ESMTP id E74741445CF
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 11:33:05 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
References: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <1C4AA81B-4C69-42B0-8B40-E1598CCB8E77@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: HBase Design Ideas, Part I
Date: Mon, 15 May 2006 02:52:19 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


Hi,
sounds pretty much similar to what I was thinking about,
just that I had used different terms and you description is much more  
elegant than my hand written notes.
Some comments below.

> ---------------------------------------------------------------------- 
> ----------
> I.  Table semantics
>
> An HBase consists of one or more HTables.  An HTable is a list of  
> rows,
> sorted alphabetically by "row name".  An HTable also has a series of
> "columns."  A row may or may not contain a value for a column.  The
> HTable representation is sparse, so if a row does not contain a value
> for a given column, there is no storage overhead.
>
> (Thus, there's not really a "schema" to an HTable.  Every  
> operation, even
> adding a column, is considered a row-centric operation.)
>
> The "current version" of a row is always available, timestamped  
> with its
> last modification date.  The system may also store previous  
> versions of a row,
> according to how the HTable is configured.
I was playing around with row and run in to several problems using  
the hadoop io package. (SequenceReader writer)
Optimal would be if a cell is a writable but having rowkey and cell  
key and value for each sell blows up disk usage.
Alternative we can have a row writable so we only one rowkey , n  
column key and n values.
In case a row has many column this scales very bad. For example my  
row key is a url and my column keys are user ids and the value are  
number of clicks.
if I want to get the number of clicks for a given url and user, I  
need to load the values for all other user as well. :(

I already posted a mail about this issue.
What we may be need is a Writer that can seek first for row key and  
than for column keys.
In general I agree with  sparse structure.


>
> Updates to a single row are always atomic and can affect one or  
> more columns.
>
> II.  System layout
>
> HTables are partitionable into contiguous row regions called HRegions.
> All machines in a pool run an HRegionServer.  A given HRegion is  
> served
> to clients by a single HRegionServer.  A single HRegionServer may be
> responsible for many HRegions.  The HRegions for a single HTable will
> be scattered across arbitrary HRegionServers.
>
> When a client wants to add/delete/update a row value, it must  
> locate the
> relevant HRegionServer.  It then contacts the HRegionServer and  
> communicates
> the updates.  There may be other steps, mainly lock-oriented ones.   
> But locating
> the relevant HRegionServers is a bare minimum.

My idea was to have the lock on the HRegionServer level, my ideas was  
that the client itself take care about replication,
means write the value to n servers that have the same replicatins of  
HRegions.

>
> The HBase system can repartition an HTable at any time.  For  
> example, many
> repeated inserts at a single location may cause a single HRegion to  
> grow
> very large.  The HBase would then try to split that into multiple  
> HRegions.
> Those HRegions may be served by the same HRegionServer as the
> original or may be served by a different one.
Would the node send out a message to request a split or does the  
master decide based on heart beat messages?
>
> Each HRegionServer sends a regular heartbeat to an HBaseMaster  
> machine.
> If the heartbeat for an HRegionServer fails, then the HBaseMaster  
> is responsible
> for reassigning its HRegions to other available HRegionServers.
>
> All HRegions are stored within DFS, so the HRegion is always  
> available, even
> in the face of machine failures.  The HRegionServers and DFS  
> DataNodes run
> on the same set of machines.  We would like for an HRegionServer to  
> always
> serve data stored locally, but that is not guaranteed when using  
> DFS.  We can
> encourage it by:
> 1) In the event of an insert-motivated HRegion move, the new  
> HRegionServer
> should always create a new DFS file for the new HRegion.  The DFS  
> rules of
> thumb will allocate the chunks locally for the HRegionServer.
> 2) In the even of a machine failure, we cannot do anything similar  
> to above.
> Instead, the HBaseMaster can ask DFS for hints as to where the  
> relevant
> file blocks are stored.  If possible, it will allocate the new
> HRegions to servers
> that physically contain the HRegion.
> 3) If necessary, we could add an API to DFS that demands block  
> replication
> to a given node.  I'd like to avoid this if possible.
My idea was to simply download the data to the node and read any time  
locally, but write into the dfs, since in my case write access can be  
slower but I needer very fast read access.

>
> The mapping from row to HRegion (and hence, to HRegionServer) is  
> itself
> stored in a special HTable.  The HBaseMaster is the only client  
> allowed to
> write to this HTable.  This special HTable may itself be split into  
> several
> HRegions.  However, we only allow a hard-coded number of split-levels.
> The top level of this hierarchy must be easily-stored on a single  
> machine.
> That top-level table is always served by the HBaseMaster itself.
>
> III.  Client behavior
>
> Let's think about what happens when a client wants to add a row.
> 1) The client must compute what HRegion is responsible for the key
> it wants to insert into the HTable.  It must navigate the row->HRegion
> mapping, which is stored in an HTable.
>
> So the client first contacts the HBaseMaster for the top-level  
> table contents.
> It then steps downward through the table set, until it finds the  
> mapping for
> the target row.
>
> 2) The client contacts the HRegionServer responsible for the target  
> row,
> and asks to insert.  If the HRegionServer is no longer responsible  
> for the
> relevant HRegion, it returns a failure message and tells the client  
> to go
> back to step 1 to find the new correct HRegionServer.
My idea was in such a case the HRegionServer may be know the new  
location at least until the master is informed.
So getting a forward message could be faster than get an error and  
try ask for the target again.
>
> If the HRegionServer is the right place to go, it accepts the new  
> row from
> the client.  The HRegionServer guarantees that the insert is  
> atomic; it
> will not intermingle the insert with a competing insert for the  
> same row key.
> When the row is stored, the HRegionServer includes version and  
> timestamp
> information.
>
> 3) That's it!
>
> IV The HRegionServer
>
> Maintaining the data for a single HRegion is slightly complicated.   
> It's
> especially weird given the write-once semantics of DFS.  There are
> three important moving parts:
>
> 1) HBackedStore is a file-backed store for rows and their values.
> It is never edited in place.  It has B-Tree-like lookups for finding
> a row quickly.  HBackedStore is actually a series of on-disk stores,
> each store being tuned for a certain object size.  Thus, all the  
> "small"
> (in bytes) values for a row live within the same file, all the medium
> ones live in a separate file, etc.  There is only one HBackedStore
> for any single HRegion.
>
> 2) HUpdateLog is a log of updates to the HBackedStore.  It is backed
> by an on-disk file.  When making reads from the HBackedStore, it may
> be necessary to consult the HUpdateLog to see if any more-recent
> updates have been made.  There may be a series of HUpdateLogs
> for a single HRegion.
>
> 3) HUpdateBuf is an in-memory version of HUpdateLog.  It, too, needs
> to be consulted whenever performing a read.  There is only one
> HUpdateBuf for a single HRegion.
>
> Any incoming edit is first made directly to the HUpdateBuf.  Changes
> made to the HUpdateBuf are volatile until flushed to an HUpdateLog.
> The rate of flushes is an admin-configurable parameter.
>
> Periodically, the HBackedStore and the series of current HUpdateLogs
> are merged to form a new HBackedStore.  At that point, the old  
> HUpdateLog
> objects can be destroyed.  During this compaction process, edits are
> made to the HUpdateBuf.

Sounds great!
Looking forward to see that working.
Stefan


From MAILER-DAEMON Mon May 15 10:09:57 2006
Return-Path: 
 <hadoop-dev-return-1421-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85867 invoked from network); 15 May 2006 10:09:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 10:09:57 -0000
Received: (qmail 11304 invoked by uid 500); 15 May 2006 10:09:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11178 invoked by uid 500); 15 May 2006 10:09:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11164 invoked by uid 99); 15 May 2006 10:09:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 03:09:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 03:09:44 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id EB6A11445E7
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 11:50:00 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 06915-04 for <hadoop-dev@lucene.apache.org>;
	Mon, 15 May 2006 11:50:00 +0200 (CEST)
Received: from [172.16.0.105] (adsl-71-129-29-145.dsl.pltn13.pacbell.net
 [71.129.29.145])
	by mslinux.media-style.com (Postfix) with ESMTP id 0EBB11445CF
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 11:49:58 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <37AB4917-06E2-4781-8316-D6ABDDEA7F9B@yahoo-inc.com>
References: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
 <37AB4917-06E2-4781-8316-D6ABDDEA7F9B@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <B5DB6452-18D8-4340-BABF-D6055249C267@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: HBase Design Ideas, Part I
Date: Mon, 15 May 2006 03:09:11 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

> Seems like you are exporting a lot of complexity to the clients by  
> having them find the table chunks via DFS read.  Lots of data  
> motion and sync / cache issues there.  When not just ask the master  
> for the block/server of a key?  Or you could distribute this work  
> over your HRegionServers if you don't want to stress the master.   
> All this could be kept fresh in RAM there (segmented if you get  
> huge). [but this adds complexity]

I see the possibility as described in the talk to get key regions  
form the master, than ask the next box for a key region  etc. So you  
can distribute the key region table over a set of boxes.
In case the client cache that the load on master shouldn't be that hard.
Alternative I see a chance of request an update with a given key and  
get a kind of forward message returned until the client find the  
region server that hosts the data for a given row key.
However since the client needs to start at the master, this would be  
a lot of load. A combination of both could be interesting.
>
> As I read you design, it sounds like you might be doing a lot of  
> seeks to find a record (do you need to scan all the logs to see if  
> a key is present?).  Best to outline the performance you want and  
> then look at the ram / disk trade-offs.  IE you can store  
> everything in BTRees, but then you will thrash you disks.  Or you  
> can store everything linearly and store all your unmerged entries  
> in RAM.  This would have different costs/benefits...
I agree there should be only one 'memory backed together' write cache  
that needs to be consulted before you search in the last checkpoint  
file.
In any case we can write also one log to make sure we lose no data  
when a box crash.
... just my 2 cents.

Stefan
>
>
> On May 14, 2006, at 3:00 PM, Michael Cafarella wrote:
>
>> Hi everyone,
>>
>> I've written up a design that I've been working on for a little  
>> bit, for
>> a project I'll call "HBase".  The idea is for Hadoop to implement  
>> something
>> similar in spirit to BigTable.  That is, a distributed data store  
>> that
>> places a greater emphasis on scalability than on SQL compatibility
>> or traditional transactional correctness.
>>
>> BigTable is neither completely described anywhere, nor is it
>> necessarily exactly what we want.  So I'm not trying to clone  
>> BigTable,
>> but I am going to draw on it a lot.
>>
>> My personal view is that BigTable is a great "physical layer" but  
>> not yet
>> a great database system.  A major thing it lacks is a good query  
>> language.
>> Another, freely admitted by the Google people, is any kind of  
>> inter-row
>> locking.  I'm not going to try to solve all these problems, but I  
>> would
>> like HBase to be extendible enough that it's easy to add new query
>> languages or primitives.
>>
>> In this mail, I'll describe a system that's pretty similar to  
>> BigTable.
>> I'll send a second one that describes what we might want to change
>> or add.
>>
>> Please let me know what you think!
>>
>> Thanks,
>> --Mike
>>
>> --------------------------------------------------------------------- 
>> -----------
>> I.  Table semantics
>>
>> An HBase consists of one or more HTables.  An HTable is a list of  
>> rows,
>> sorted alphabetically by "row name".  An HTable also has a series of
>> "columns."  A row may or may not contain a value for a column.  The
>> HTable representation is sparse, so if a row does not contain a value
>> for a given column, there is no storage overhead.
>>
>> (Thus, there's not really a "schema" to an HTable.  Every  
>> operation, even
>> adding a column, is considered a row-centric operation.)
>>
>> The "current version" of a row is always available, timestamped  
>> with its
>> last modification date.  The system may also store previous  
>> versions of a row,
>> according to how the HTable is configured.
>>
>> Updates to a single row are always atomic and can affect one or  
>> more columns.
>>
>> II.  System layout
>>
>> HTables are partitionable into contiguous row regions called  
>> HRegions.
>> All machines in a pool run an HRegionServer.  A given HRegion is  
>> served
>> to clients by a single HRegionServer.  A single HRegionServer may be
>> responsible for many HRegions.  The HRegions for a single HTable will
>> be scattered across arbitrary HRegionServers.
>>
>> When a client wants to add/delete/update a row value, it must  
>> locate the
>> relevant HRegionServer.  It then contacts the HRegionServer and  
>> communicates
>> the updates.  There may be other steps, mainly lock-oriented  
>> ones.  But locating
>> the relevant HRegionServers is a bare minimum.
>>
>> The HBase system can repartition an HTable at any time.  For  
>> example, many
>> repeated inserts at a single location may cause a single HRegion  
>> to grow
>> very large.  The HBase would then try to split that into multiple  
>> HRegions.
>> Those HRegions may be served by the same HRegionServer as the
>> original or may be served by a different one.
>>
>> Each HRegionServer sends a regular heartbeat to an HBaseMaster  
>> machine.
>> If the heartbeat for an HRegionServer fails, then the HBaseMaster  
>> is responsible
>> for reassigning its HRegions to other available HRegionServers.
>>
>> All HRegions are stored within DFS, so the HRegion is always  
>> available, even
>> in the face of machine failures.  The HRegionServers and DFS  
>> DataNodes run
>> on the same set of machines.  We would like for an HRegionServer  
>> to always
>> serve data stored locally, but that is not guaranteed when using  
>> DFS.  We can
>> encourage it by:
>> 1) In the event of an insert-motivated HRegion move, the new  
>> HRegionServer
>> should always create a new DFS file for the new HRegion.  The DFS  
>> rules of
>> thumb will allocate the chunks locally for the HRegionServer.
>> 2) In the even of a machine failure, we cannot do anything similar  
>> to above.
>> Instead, the HBaseMaster can ask DFS for hints as to where the  
>> relevant
>> file blocks are stored.  If possible, it will allocate the new
>> HRegions to servers
>> that physically contain the HRegion.
>> 3) If necessary, we could add an API to DFS that demands block  
>> replication
>> to a given node.  I'd like to avoid this if possible.
>>
>> The mapping from row to HRegion (and hence, to HRegionServer) is  
>> itself
>> stored in a special HTable.  The HBaseMaster is the only client  
>> allowed to
>> write to this HTable.  This special HTable may itself be split  
>> into several
>> HRegions.  However, we only allow a hard-coded number of split- 
>> levels.
>> The top level of this hierarchy must be easily-stored on a single  
>> machine.
>> That top-level table is always served by the HBaseMaster itself.
>>
>> III.  Client behavior
>>
>> Let's think about what happens when a client wants to add a row.
>> 1) The client must compute what HRegion is responsible for the key
>> it wants to insert into the HTable.  It must navigate the row- 
>> >HRegion
>> mapping, which is stored in an HTable.
>>
>> So the client first contacts the HBaseMaster for the top-level  
>> table contents.
>> It then steps downward through the table set, until it finds the  
>> mapping for
>> the target row.
>>
>> 2) The client contacts the HRegionServer responsible for the  
>> target row,
>> and asks to insert.  If the HRegionServer is no longer responsible  
>> for the
>> relevant HRegion, it returns a failure message and tells the  
>> client to go
>> back to step 1 to find the new correct HRegionServer.
>>
>> If the HRegionServer is the right place to go, it accepts the new  
>> row from
>> the client.  The HRegionServer guarantees that the insert is  
>> atomic; it
>> will not intermingle the insert with a competing insert for the  
>> same row key.
>> When the row is stored, the HRegionServer includes version and  
>> timestamp
>> information.
>>
>> 3) That's it!
>>
>> IV The HRegionServer
>>
>> Maintaining the data for a single HRegion is slightly  
>> complicated.  It's
>> especially weird given the write-once semantics of DFS.  There are
>> three important moving parts:
>>
>> 1) HBackedStore is a file-backed store for rows and their values.
>> It is never edited in place.  It has B-Tree-like lookups for finding
>> a row quickly.  HBackedStore is actually a series of on-disk stores,
>> each store being tuned for a certain object size.  Thus, all the  
>> "small"
>> (in bytes) values for a row live within the same file, all the medium
>> ones live in a separate file, etc.  There is only one HBackedStore
>> for any single HRegion.
>>
>> 2) HUpdateLog is a log of updates to the HBackedStore.  It is backed
>> by an on-disk file.  When making reads from the HBackedStore, it may
>> be necessary to consult the HUpdateLog to see if any more-recent
>> updates have been made.  There may be a series of HUpdateLogs
>> for a single HRegion.
>>
>> 3) HUpdateBuf is an in-memory version of HUpdateLog.  It, too, needs
>> to be consulted whenever performing a read.  There is only one
>> HUpdateBuf for a single HRegion.
>>
>> Any incoming edit is first made directly to the HUpdateBuf.  Changes
>> made to the HUpdateBuf are volatile until flushed to an HUpdateLog.
>> The rate of flushes is an admin-configurable parameter.
>>
>> Periodically, the HBackedStore and the series of current HUpdateLogs
>> are merged to form a new HBackedStore.  At that point, the old  
>> HUpdateLog
>> objects can be destroyed.  During this compaction process, edits are
>> made to the HUpdateBuf.
>
>


From MAILER-DAEMON Mon May 15 10:28:31 2006
Return-Path: 
 <hadoop-dev-return-1422-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93650 invoked from network); 15 May 2006 10:28:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 10:28:31 -0000
Received: (qmail 36743 invoked by uid 500); 15 May 2006 10:28:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36614 invoked by uid 500); 15 May 2006 10:28:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36605 invoked by uid 99); 15 May 2006 10:28:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 03:28:29 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 03:28:27 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 28C921445E7
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 12:08:44 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 07108-03 for <hadoop-dev@lucene.apache.org>;
	Mon, 15 May 2006 12:08:43 +0200 (CEST)
Received: from [172.16.0.105] (adsl-71-129-29-145.dsl.pltn13.pacbell.net
 [71.129.29.145])
	by mslinux.media-style.com (Postfix) with ESMTP id C7A281445CF
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 12:08:39 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
In-Reply-To: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
References: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
Content-Type: multipart/mixed; boundary=Apple-Mail-13--269534986
Message-Id: <0BDBD3F3-182D-4415-88B7-A8412BC2DD59@media-style.com>
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: HBase Design Ideas, Part I
Date: Mon, 15 May 2006 03:27:53 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-13--269534986
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed

Hi,

I collect some stuff  (in a hurry)  that was the result of playing  
around with this topic so please expect just nothing.
The tests do not pass and there are several known bugs, however that  
may be give you an idea what I had worked on.
--Apple-Mail-13--269534986
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed


May be we can define protocols and interfaces first and based on that  
people can implement.
Stefan 
  
--Apple-Mail-13--269534986--

From MAILER-DAEMON Mon May 15 18:08:35 2006
Return-Path: 
 <hadoop-dev-return-1423-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24966 invoked from network); 15 May 2006 18:08:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 18:08:35 -0000
Received: (qmail 45675 invoked by uid 500); 15 May 2006 18:08:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 45656 invoked by uid 500); 15 May 2006 18:08:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 45646 invoked by uid 99); 15 May 2006 18:08:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 11:08:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 11:08:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A545E410009
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 18:08:06 +0000 (GMT)
Message-ID: <20161730.1147716486673.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 18:08:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-212?page=all ]

Owen O'Malley updated HADOOP-212:
---------------------------------

    Attachment: dfs-blocksize.patch

Ok, here is the patch.

Changes dfs block size from a compile time constant to a parameter that is set when a file is created.

1. FileSystem.getBlockSize becomes getDefaultBlockSize
2. A new method FileSystem.getBlockSize(path) finds the blocksize of a file.
3. Block size is added to FileSystem.create
4. InputFormatBase uses the block size of each file rather than the global constant.
5. I followed the convention of using DfsPath to cache meta information values associatied with the dfs file.
6. FileUnderConstruction records the block size
7. Removed check to make sure that the block size was shorter than the global value.
8. Add a new value

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: dfs-blocksize.patch
>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 18:21:47 2006
Return-Path: 
 <hadoop-dev-return-1424-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31117 invoked from network); 15 May 2006 18:21:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 18:21:47 -0000
Received: (qmail 64547 invoked by uid 500); 15 May 2006 18:21:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64443 invoked by uid 500); 15 May 2006 18:21:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64327 invoked by uid 99); 15 May 2006 18:21:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 11:21:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 11:21:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D1EA5410007
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 18:21:06 +0000 (GMT)
Message-ID: <8800423.1147717266857.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 18:21:06 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-219) SequenceFile#handleChecksumException
 NPE
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

SequenceFile#handleChecksumException NPE
----------------------------------------

         Key: HADOOP-219
         URL: http://issues.apache.org/jira/browse/HADOOP-219
     Project: Hadoop
        Type: Bug

  Components: io  
    Reporter: stack@archive.org
    Priority: Trivial


The SequenceFile#handleChecksumException assumes the conf data member has been set.  It will not be set if we use the 'Reader(FileSystem fs, Path file, int bufferSize, long start, long length)' constructor.  The latter is used by ReduceTask Sorter:


java.lang.NullPointerException
	at org.apache.hadoop.io.SequenceFile$Reader.handleChecksumException(SequenceFile.java:407)
	at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:400)
	at org.apache.hadoop.io.SequenceFile$Sorter$MergeStream.next(SequenceFile.java:837)
	at org.apache.hadoop.io.SequenceFile$Sorter$MergeQueue.merge(SequenceFile.java:881)
	at org.apache.hadoop.io.SequenceFile$Sorter$MergePass.run(SequenceFile.java:766)
	at org.apache.hadoop.io.SequenceFile$Sorter.mergePass(SequenceFile.java:702)
	at org.apache.hadoop.io.SequenceFile$Sorter.sort(SequenceFile.java:528)
	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:253)
	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:787)


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 18:23:38 2006
Return-Path: 
 <hadoop-dev-return-1425-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32643 invoked from network); 15 May 2006 18:23:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 18:23:38 -0000
Received: (qmail 70239 invoked by uid 500); 15 May 2006 18:23:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70203 invoked by uid 500); 15 May 2006 18:23:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70152 invoked by uid 99); 15 May 2006 18:23:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 11:23:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 11:23:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3B4977141F2
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 18:23:06 +0000 (GMT)
Message-ID: <27799124.1147717386218.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 18:23:06 +0000 (GMT+00:00)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-219) SequenceFile#handleChecksumException
 NPE
In-Reply-To: <8800423.1147717266857.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-219?page=all ]

stack@archive.org updated HADOOP-219:
-------------------------------------

    Attachment: hadoop-219.patch

If no conf, default to throwing the checksum error.

> SequenceFile#handleChecksumException NPE
> ----------------------------------------
>
>          Key: HADOOP-219
>          URL: http://issues.apache.org/jira/browse/HADOOP-219
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: stack@archive.org
>     Priority: Trivial
>  Attachments: hadoop-219.patch
>
> The SequenceFile#handleChecksumException assumes the conf data member has been set.  It will not be set if we use the 'Reader(FileSystem fs, Path file, int bufferSize, long start, long length)' constructor.  The latter is used by ReduceTask Sorter:
> java.lang.NullPointerException
> 	at org.apache.hadoop.io.SequenceFile$Reader.handleChecksumException(SequenceFile.java:407)
> 	at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:400)
> 	at org.apache.hadoop.io.SequenceFile$Sorter$MergeStream.next(SequenceFile.java:837)
> 	at org.apache.hadoop.io.SequenceFile$Sorter$MergeQueue.merge(SequenceFile.java:881)
> 	at org.apache.hadoop.io.SequenceFile$Sorter$MergePass.run(SequenceFile.java:766)
> 	at org.apache.hadoop.io.SequenceFile$Sorter.mergePass(SequenceFile.java:702)
> 	at org.apache.hadoop.io.SequenceFile$Sorter.sort(SequenceFile.java:528)
> 	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:253)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:787)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 19:09:34 2006
Return-Path: 
 <hadoop-dev-return-1426-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50292 invoked from network); 15 May 2006 19:09:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 19:09:34 -0000
Received: (qmail 32915 invoked by uid 500); 15 May 2006 19:09:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32896 invoked by uid 500); 15 May 2006 19:09:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32880 invoked by uid 99); 15 May 2006 19:09:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:09:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:09:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9B0B7410005
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 19:09:06 +0000 (GMT)
Message-ID: <19862024.1147720146632.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 19:09:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-180) task tracker times out cleaning big
 job
In-Reply-To: <24018329.1146508966485.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-180?page=all ]
     
Doug Cutting resolved HADOOP-180:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> task tracker times out cleaning big job
> ---------------------------------------
>
>          Key: HADOOP-180
>          URL: http://issues.apache.org/jira/browse/HADOOP-180
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: task-cleanup-thread.patch
>
> After completing a big job (63,920 maps, 1880 reduces, 188 nodes), lots of the TaskTrackers timed out because the task cleanup is handled by the same thread as the heartbeats.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 19:19:34 2006
Return-Path: 
 <hadoop-dev-return-1427-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53944 invoked from network); 15 May 2006 19:19:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 19:19:34 -0000
Received: (qmail 48623 invoked by uid 500); 15 May 2006 19:19:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48604 invoked by uid 500); 15 May 2006 19:19:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48595 invoked by uid 99); 15 May 2006 19:19:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:19:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:19:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9366A410007
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 19:19:06 +0000 (GMT)
Message-ID: <11180584.1147720746601.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 19:19:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-200) The map task names are sent to the
 reduces
In-Reply-To: <13737024.1146974120921.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-200?page=all ]
     
Doug Cutting resolved HADOOP-200:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> The map task names are sent to the reduces
> ------------------------------------------
>
>          Key: HADOOP-200
>          URL: http://issues.apache.org/jira/browse/HADOOP-200
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: map-id.patch
>
> As each reduce is created, it is given the entire set of potential map names. For my large sort jobs with 64k maps, this means that each reduce task is given a two dimensional array that is 5 tasks/map * 64k maps = 320k strings. Since the reduce task is passed from the job tracker to the task tracker and down to the task runner, passing the entire list is very expensive. I suspect that this is the cause of the slow downs that I see in the task trackers heart beats when the reduce tasks are being launched.
> I propose that the ReduceTask be changed to just get the count of maps, with ids from 0 .. maps -1.
>   public ReduceTask(String jobFile, String taskId, int maps, int partition);
> Then we need to change the protocol for finding map outputs:
>   MapOutputLocation[] locateMapOutputs(String jobId, int[] mapIds, int partition);

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 19:23:34 2006
Return-Path: 
 <hadoop-dev-return-1428-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61611 invoked from network); 15 May 2006 19:23:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 19:23:34 -0000
Received: (qmail 52472 invoked by uid 500); 15 May 2006 19:23:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52449 invoked by uid 500); 15 May 2006 19:23:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52440 invoked by uid 99); 15 May 2006 19:23:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:23:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:23:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 97B95410007
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 19:23:06 +0000 (GMT)
Message-ID: <13849609.1147720986618.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 19:23:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-202) sort should use a smaller number of
 reduces
In-Reply-To: <9539530.1147127300947.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-202?page=all ]
     
Doug Cutting resolved HADOOP-202:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen.

> sort should use a smaller number of reduces
> -------------------------------------------
>
>          Key: HADOOP-202
>          URL: http://issues.apache.org/jira/browse/HADOOP-202
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Trivial
>      Fix For: 0.3
>  Attachments: sort-default-reduces.patch
>
> We should see better performance with fewer reduces. I'll change the default number of reduces to be equal to the capacity of the cluster.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 19:42:34 2006
Return-Path: 
 <hadoop-dev-return-1429-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68168 invoked from network); 15 May 2006 19:42:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 19:42:34 -0000
Received: (qmail 72281 invoked by uid 500); 15 May 2006 19:42:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72258 invoked by uid 500); 15 May 2006 19:42:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72248 invoked by uid 99); 15 May 2006 19:42:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:42:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:42:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AC827410007
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 19:42:06 +0000 (GMT)
Message-ID: <1519243.1147722126703.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 19:42:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-212?page=all ]

Doug Cutting updated HADOOP-212:
--------------------------------

    Attachment: TEST-org.apache.hadoop.fs.TestCopyFiles.txt

Overall, this looks great and is much needed.  Unfortunately I'm getting some null pointer exceptions running unit tests with this patch.  I've not yet tried to debug these...

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: TEST-org.apache.hadoop.fs.TestCopyFiles.txt, dfs-blocksize.patch
>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 19:59:53 2006
Return-Path: 
 <hadoop-dev-return-1430-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72618 invoked from network); 15 May 2006 19:59:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 19:59:53 -0000
Received: (qmail 93968 invoked by uid 500); 15 May 2006 19:59:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93945 invoked by uid 500); 15 May 2006 19:59:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93936 invoked by uid 99); 15 May 2006 19:59:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:59:52 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.1] (HELO arunc.bangalore.corp.yahoo.com)
 (202.46.19.1)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 12:59:51 -0700
Received: (from arunc@localhost)
	by arunc.bangalore.corp.yahoo.com (8.13.3/8.13.3) id k4FJxOki064931;
	Tue, 16 May 2006 01:29:24 +0530 (IST)
	(envelope-from arunc@yahoo-inc.com)
X-Authentication-Warning: arunc.bangalore.corp.yahoo.com: arunc set sender to
 arunc@yahoo-inc.com using -f
Date: Tue, 16 May 2006 01:29:24 +0530
From: Arun C Murthy <arunc@yahoo-inc.com>
To: hadoop-dev@lucene.apache.org
Cc: ucg-blr@yahoo-inc.com, Sameer Paranjpye <sameerp@yahoo-inc.com>
Subject: DFS Client: C api
Message-ID: <20060515195924.GA64134@yahoo-inc.com>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="UugvWAfsgieZRqgk"
Content-Disposition: inline
User-Agent: Mutt/1.4.2.1i
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--UugvWAfsgieZRqgk
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

Hi,

  I've been working on the C api for the DFS client (via JNI) for a couple of weeks now. Please find a rough, first-cut attached for your reviews/comments ...

  Status quo:
  a) Implements all of the apis Devraj (ddas@yahoo-inc.com) had posted to this list a while ago - a few enhancements are pending. E.g. need to make CLASSPATH configurable via a configfile while initializing JNI etc.
  b) There is a small test-suite for the same - though it isn't very comprehensive right now. This will change soon enough while I continue testing; especially hdfsCopy and hdfsMove need more testing with Local/Distributed FileSystem combinations.
  c) Critical point: I have this working against hadoop-0.1.0 (the latest - 0.2.0 wasn't out when I started on this) and have made sure the differences between 0.1.0 and 0.2.0 are contained in very small regions. Once I finish some more testing I'll start porting this to work against 0.2.0 (specifically, I need to change the JNI code which uses java.io.File to use org.apache.hadoop.fs.Path).

  I'll be working to get this ready for a stable patch to hadoop asap.

thanks,
Arun

--UugvWAfsgieZRqgk
Content-Type: application/x-tar-gz
Content-Disposition: attachment; filename="hdfs.tgz"
Content-Transfer-Encoding: base64

H4sIABnTaEQAA+09a1cbR7L5evkVbeXaSARJgImzC3FyMcixvFj4ArY3cXw4gzSCwdKMdmYE
Zjf+77ce3T3d85BGINkklzknsZjpR3W9uqq7uvq8148a3W8W+qzB82RzE/7d2Nxc+57+Xqe/
8cfj9ceP175ZX9t8vLG++eSH7+H7OpT74Ruxtliw+BlHsRMK8Y0Tjv1JeBhHbhhN+L7Gj/73
T/J86/ndwbjniso5csJ5Zcl+89L3XriDkRvip6XmysqSWBHyQ8u/3BI74ip0RlBARHE47sYi
DsSpKwBdPeFEYvnSGYzdZax1de4NXBE5l55/JuLz0HV6ov6TeNlpQ0MrYgitwJcIijaX4uuR
23P7qs2l/ywJeFRR17/cXvpsgLGtQUNg++MBtNYNA4SlG/iXbhgLR4y4zxMC0cGmoTvq7Vvo
yvNd8Uvr+IQLtfeq6seq+Ohe0/+OvH+7NfE7gRL5I6ge96vmx1VROTlBqHQrJycPx5VVUR37
kXfmu72abrZW2xa6Y138qP1bSzzeWNJfdl+0dv9xctH61HVHsRf4rdfH7YPOSbtz8qp1/AL+
fXuwK/7DMF1AM8GVcwpYNmqcbPNXry+qVfO9eCqqK4DKWv2n5C3//6DbHYeh26vi51pNdYBP
UZU9N+qG3qlLVbaT8itJQegwB65Jje4OXCdMt3jpnLh+r+qEZ5H5OnTjceiL+rp89/n3pc+a
Lc7cmJkHGfacGFr0QeAJLGAH+A5EcDWH9YOQ/j7zLl1fkqeBDf3PyAmd4ZboAIj8QvZ7bNTu
BoC8aBT4PWL1gJpKGmkugc6Jva7w/AHSWFXTQFZrkuG7506omeO9xSUfgOepSOBHsbiIgP3E
5fDZuL/v+mfxOeB6fZuFxrl03r5a4Y/vjSIfgAETqRIrJFXER8DYIryEJtZkEXrjB29fRfSS
e242f5FYU4AJx+9JuUJwvJhrW2KlpDByB/1qbVUkYoZDCPqmgKh+jlwX2fc6GAtngF+vxblz
6VoU6zrdc7fXaDSoDowF2Vt+rEXARt3zlh+H18/DYHiMMpJ0tK3lA6s9eCo6b/b3genTrIUI
4hF9VpDtDAYi9M7OY+hYRMEQ9JsbesE4EldB+BEq/mvsgRwBy4XuA1lnvSHavhd7zgCRhGN4
4UTnBJMssdEQ+we7/1AVHjfE7rnb/YggOv61eIl0IAScusCdXRhGLPuQNRjsX91oS7yJiBDV
KwDtPBgPeiLwBxJ/6+Ltq5pVpRNsiV1qj5H79pX8vNkQbzoIFI/8XEGMI6kqSuH3kxc7Ry9O
jnee7bf0e+IloMUJMAy33mOujKqPqsyXax+AFwzmXBWPiN8M4oREmzWTMH2phKO454bhqn6v
nsquAwQCAcztXPQdmJF64soDeYH6QbglHvZ+90Fhh5eyY2KmTzDGdflCkh4BkgKRgqnZNBAo
8ZfIIeJrBzQXjPUENdh26vsBa8qA/oneb35IFxArl0OJVnxUwbUPDf55ROIH+K7U9y6gRqMb
DEcwzPBp56DTqmwjqfe8iGaJl+1jkWlpvbilgRNFjZETnz9tngOvN6+bA9D4n9xu89zpBcGo
Ccqov1XwDf6UP+trjfXGWuPCCRkcYNFQUONulAFnoxAcaDB0wut8gLBE8yJ0qVvv8d+eQFfY
1xGoLB+UL3C/rC+wvjDIp3p+nNMzmBKnQeRuXfgew/4aGRDZqx66AxLDoRtFzhmMJJmwmNQN
qBzxNIjs+LZ1eIRT+frJxnamqIQBispf2waAqpB/oEttbotMG8bnxzmfwR4JQveNH7rd4MwH
VdTjOSPRekpqmZ+Z/aqPLodgz1wGXm9lpfYIVCJIqmzSEJkCec2RWZER2ozgmv0XyqzROT6W
zOLzmaVXuANQiKa07sQxTB0grV6krFI5Y2eEFydRwInSWNs2qqogmWDDcHu7aD/58TE1WM3i
bG0RyMrp+rb40lOwmm/1XA+mO06X0mynYq3O8eGvAszgFXfELbkNMI0BN6qWettzYgdRRjip
sYWXWKnuCL6d86Rdheag3dYhmKFPs1NzGkEaF6o615VosMedp9d5ksudxBIjwDAsX2RtSZ6P
wcMgLeUFjefo9wSnF243NmxIbGnLMBvFKICRgKMljDKom7hQHxqpk6pC2xR8KeTZgM0/8pEK
e5OAH9I/EcLFX8EQEEfjbhf0FRluiFp8R1ySZ6eqerrPjnt1QK8O+igg7QPsu2rYk6vSPCU7
dgWhV5YtzJIacompgeOfNaSu5Z7Y9mSDUly8dsisVb4CdM6F3xw/r1Jf1D5oukwHyLc56Ek7
TYn3Ie1gOd4LqvM0d9y7OG1x94+S+ilBrdBs5AVNbAisi0p1n97giJs8iO3aW/hAYzQkQfY8
ne3zLB9/2SAV0BCI6Xdh7H2ea22MIFM9jND2yTQ1SmAiqQlDPwBstNooWZ2dfUMNMqchsNu2
+gDvMA6D64QSBcRWxD10wfOLXE3gXWAgiWbCURZKVROsvOJaoGBT4kwYniLQPQm8IwZB1wGD
3+2DqS1xaWJxRuGmvrnUlIY1ihJxVg5oWkhRoyqI97HVQ9WoLZgWc7NUKhTuAfJjV1WW+KNi
hChc4Hh+RKsvIGI+NFJNpHxFnAdRDG7d6yCMYdRhnEi8eLnzdke0/vdN++3OPujlLe16YONH
11HsDkUf7ZXk7wY4xVXfvRLQVd87G4cOUqVakwyJlSVC+pGkrDFM9lYtWbbaScv50fYknZDy
egu9/S5PwHLSM/xRw8HXrRnOQhCeNZwR+rENNpQbaE83LIgt1WV/uY2Cgq6b3LVpyjetDkhx
gZoy9VMKgqmK6iZ6qgxaUhP7TCpKKEqQj3117gDlrkcEgMGXSCAQCHCkxJXjx5FaaUA0IMuX
M06Q2Lz86YplEvplntkj5vZGg0di2KckECgBJJAJRCh0fWPQwL2zsUCWFlku6EfNVLc5EwRM
Z2X4R05x1ruUFUxjyOJxCk3xOQtQUYNOLLD4sfUHgJnucFRlDVXpuX1nPIgrNfHoEWmqjCs/
hX5dORK3l09E1UyamAkyt7ZQvTEhhYUJz78MPrqv3Pg86DHpqmDAvXUG4EAAllLCfHS8c9ze
XSXEZelTTFuTrKICsFSKXIyyJM4pZvWzXdRDii/m4A1l9UY/aqRwL/2CBzkO0e34bRIT8aQp
JwuDcQRonurDaBUctBoz0aqcTWkezdcKex7ax6fj2O0ZugG/tH0whYLuRzfe6fVghoqqRmNk
mfdrifZQVvYLKNNxhu5ESxsbkvhKWlCzKNbuBL0ZLeasViETGcbQzAykwIRuk4LJNKSHpPGo
vpSxNnXlXGZLt1RkfSYgkG5Lq70EZfNVfoudHMAAbOayX/4cUUzP7Rnmjyx5FfImzC359jCT
RlX/AlMRCzB+2krI02xK9hNj1Au4ehhepx0CXhedNIz00G0n5yix3NGdwB8HI9cnf13a8/3I
9NZXyO1bFbi62R84Z6mPclWyrG0v+lJbUYeGQ0kFjvac2PlP2x+N4z8OxjH88xmEyAUPqf8f
L/ojiD5DbQxTIFO52s+x/WW5W9noxu5yrq1uuAmoHOWftX6Us1oABOEhlHEo0AFkrienTzgj
r4nbxQ6MjXd0TNQPySZACIguyKQHJ4d7B539X2viZ5BToGtFbIkKo6uynWlBt13YiGZcJbZy
7aJwficSEgXlsBGCm7XCHKCa0Uji5StB4QT0SjNzn1dn2KS3vSpH+UtZT12KeXXS4o6xqJUs
MOUuQ5puRWqLUIPS00uIHrAm7y9nEAdWi8jiwVAEQoM+0UTkeikzsd0BQ7Gz20J3/ihv0Wi6
kZipw+y4mjCVWiu40T7dVJvtYQQWUs0w28qAVM41TOlt1Nn0Q/LXEEAMulW5Sy29VcWEJ7S6
4zuDmuEdP8CaJhp0552DV61Xk51S2XH9J9m9XCq31AoXIGcVCkhRfmRJcrvz+s0xyOLBm2P4
oVQZT0F6bQ6Xe243+/DqkLBmnb5aWcM5hFaLBkHkpqccS4zLzCdYrtHFpsQitX2z+RoX6QAz
YTSz+jcLVImAP5vU3KLtH9mNER+jEV5i0jhyfC++Bo3udj/aHCf++MPijKfiTafdaR+3d/bb
v7X2chny2c7e8ww/1tdTq7g4URGj952uK67OkQbLRIplNS1x9BctlPQyE09SFyceC0TiU3vq
KTfT2BNNyXmFJsUJipT86GLdSRO8Hgw4I4SDXKsX18umhS0k6u9htLXFrG0qON2TuUgwfY0r
Q749t046DKejoTsMwmvWIqHrEjVSVuMaCW+MgW0kpYe4k5kruau06rwiTsd9YOBVwXUGFMhR
RqRPrwGi9x/E6aE0E/HF+4GMUjIkP2rQdurpYW2hlt6NZd+cyC0VgPKvhZ+MB2VUTth+Qizs
hKFzDT8PHfxhxGf5AdLjGRSxY7IK9AIphflrhBbuFXJngG4Mgho6H10RoXEZ00oqbqvTuOHf
ZaQAjnVZQ6ZgeqBVwEQx8f0gFryvHQZD4QAa/LplPhHGHxSuB78tIyiHFAQATEXxW5EH3Im0
kLwgaWEvkDxTtGIFInk/sQUmGWsGKQuVTtbtNUa9WlpZ5hl9iE5aUXn/rNbGFVo5wOl6y2pr
ig2XBmVrywhPKKZXWrfZbK8pl150M9ZjNGUO3TPcOmKDRY5xVaytCgv/rMNqph2WWibSDbYG
7hA0S5RuMoPiPGiKKq/VVinoZefZweFxSiMbgKJuhiks0c7vQmDTIvXMk/BNlLR6TSr6FHT0
UwzwxF05AqOa+OL9KGhcERCnd1Q7Wx5VsXpem1U3v8vqZqRG7Pp/MvWM5CtUz9KDKKGfiQvQ
agmkgrYQPxcNTdyep6K521gGzEhavZtRYatiR4Xa412iPQYyXtVSHDcxK00sld2cyzFtgQ5E
gFxdjzqeduHkCCZ56bOrdxOOrS1mg0TBW82V1fYpQUoU/kya+d1tNPO7SZpZL0z5QQMXmZgJ
Iwqr6o8Hg2uSBhiBqA680664ApzLil7DbYhlZp9l4cUYEf9AbNdrpsrnz5YbfeS6H4sUfXzQ
70egc8FXx7jz10FUE1N1OxnWEbY6CqI7qrvLWdbTVHd5JZxnj86kfG+iASyTbiYNYNt4FSRm
vvy/JPE32WOxRh5CMrORl49R2y2VjI7Mf+wOBvkCMd2uEcDyuLuAFg2go3pH2f8Lcv7czI/i
lZ+vuOzDOBoEQEJJP6C6MGaWXLlNfLWk0gyumhJpc8mI+Y1jql7OskZUVvK4g/nKXlWKXS1B
gzU1PR+Mo/MCUSwzDwVRo09N3FExnJMHMdM0lLW7Fz4PWZbobBNR2hQlcuZPRaWWRrP1ZpUD
gqDIDMVnbnOSFoOdS+iNzhjedFZCi8zRrdxRacjudNxVY4y8co3PadreWJrTdabtBtzGWtOd
FMhJe1Y5mVlGEtTcyl2bKCO6D3tPMBhdKymJwi5uS1uhCmFXSs6R6EVx+jO8SoTpFX5wQwyf
UCdnVQ8C9z2uIqg7ukZBocXjH2mXcxXgGwax+xPiK/VKtnJ6LdT2Lp2c9XsDFQPqnAaXrtgU
XSdSJ/6azXyhRlajEeoQZ3AXU8G1isKoArA8DblkeY60eRN7gwYOczcAkNGLRd2jQ28AgJrx
J+IPnMZw7PLL4iB7a4WVuyPgqC88U60hq5JaIMLRr54OFaR25C/VHjNOsykxE+XHM94CKdQw
QXkclIUxPdadKBoPXXEaxOd8kAN5JcIgyVxoH0zqPt11PBwZXSusDoGtNFarqmAutKoP5NlL
t2q3p9H9dSaQI6KqMUUQqKlpZI/oaRQiFKQdIKhYPlAH2Tynl/INJCimWEDdO0f+4NyUNFgY
DZSehIqXkynhghtfOgNjsZjCk+T6VDtqS34/UAdyjlhbZiaMs0Fw6gworDOJ0igZ2p8fUa2S
gBT7JoBvPA+aai91lGHKePZYvedCMP8x5Y4rd2zACtPHxmJwi7M86sk/pzQ9djd3kJbJUvaM
T25L5sEfk57TDwAV4bWQKvM7EVTYRWog+EyJ6cUnJdXq+ZzmgvxpuNFo1GxKnwbBwHV8ccHW
ZnJWLVMC9HrIq+mZMlMDAflXwXmRQgyxf1gcD4jjQ9PVHGJO/It6co+P2OdC7AhR+6/fygWI
136bAILSl0qXr2oNDrjRCJ6AkjIHVPApwejTwx0Rv1tbJnaLT6rgU459eX5JMzA+OTHr+HzW
f2V22POGqnRlrlWUozFvsjYxaZog3N4ghlXXzRizE0tXJ/Fs/mEF9WS58FYMJQEqHUWbGeek
9RH1fBW2YwPKchZKugt5qFOGShkGLWWu/HmtlZvIHqvQ24heJeWITZ4z7o54LUy07owubzZv
5OUWYXHiVCDqAl52P14/mGRGOwKKjpI4DvXw0g/4uTIhCPzynWFVRlWaJbUxfTwczeD8yabz
zF3dULGhuzDypbGE61q0kMXKEGpx2D4iLLL1oIL/ZgJ/q8n2y0u8pNEXlXhjgF9c3iedy1C4
mAebpbmLUqPgLHhv09GjkP2VJp2/KgviGj4fUaoqfZQoaKvkbFDknMmVq5nzOBAl1ZHsb1JJ
xSt2qC+j29oqeYXLu/PZKlHNqX2RFVw6XjG3RZrmrgj/btKHP9umCC+OW+vpaieEl3mFLly4
x1Gutvz19XY2EqgypXosQLguXjzcW29zAFtD6ck7HPc7EndiR0Lmdb7fkvhLb0l8JScf9eVf
2slPDfBP4uL/SZdr79nJeu7CMqxh1Thfewn2/6V6nvOSzF92k6O0VPHzJWXLXqlUW73h5Wz7
u2E6r+d8Z3L2G2ZhENyETdzfL0lvhvWukVn/+tqL7jn6565yHfuRt1BLv91htcSDu7NseudW
xWSiluJ1Mbk4OCGN3VzS1KGsJMgFoso1lf5io/OnBeNPjK0vlQatTJr73ExoxnJE6XUHm5lS
57SVNlJILhmkz+Xnn+tswuyXP+sRx87zNMuk2e02IfnzTPplHxBjWuCJvjWxRd0aknrI64MF
khoMepyk33wJ0vh6Jgk+GPRMIZaNmukmqRjwtllMdZMU60dqORObXKUad1/SuU40Wc5hPDOI
uo3BJMuvezVDIzZ+SWVoKIwVTN1oeU3CPHXXNUmxRVPCklGoWtUIWpSSydgmX1/JyLGXMBkU
bmbRSNDQx+kJcCP42+3NxYoAhA+wzwVbDTOf6dPByKcnPFpM9EM/Sh3iu7OGBhLYVg7pjY1i
vTAlC+BNdQHSv4wm+I0ztUjJV3RZlOgjVDcRfNvXWJTjUG6HXKaBmSbU8xLkkLu79wBuIpgq
6XnMtx99xJvH7pacSvKWMv/fLtr8l8DcXkLxyWQ6/hpCK2+LAjEFoXkXhJihbM8LgdmC8NoS
Xyqo0tZh/uWTWP5JN3LPIs2A1bOc3lRiVTOlPBbcOY2CwTh20Xat1u5Kcnnx1EgVPVn8TRbK
HXgps1jOQXOXsByICo7A2+JWqZG3UKRyClOnTMHGTe3enPvusCfqI8VBRDHzQsNyfom8vW7W
FATpawdT8HDymew9KhVUYqIcOjODnBmJJTTIdHxTlCqANI7csD4Kg0uvByYsKwkqAn343dF1
VamRKmmVWrlbA4nBUgg2FND2rEqz9C2HxevN6plhACVcqByNzeNMJaCbrK9vYG71MQFdttXE
8DLu9bxjNlZuoNQdNrxMJZiH80lTwoIsrRwwZrS6bj8f5MAwZ3doNh1xe2+IOXCeIjr82PNA
s9gu0b3zM7sMGokCeoo+d8PpYRLfDZ+HYfmruTwr2unBS+GirKfD644qwWUUO2Gc/Fn+UgV2
dRCgXcTxCw+zENiiu6pa19mP7yV5siTnmJ5lrpm0qUAVFS+c4uIHcYLt1vFYZIpxu35Jn8Gu
NEO6SlQeJd03u48yauPly9r79zk+R7EbY/PognRNZiwTAjTKqaF8jYP2F14ZK4Ix5olHPgY5
Cj3KXJ4mtFqU2LFvbaG7xJxej/fNHBZV1+9J7xLT+l90xkNs6xlyV2RkPgfJJp7aJ2waWivp
VQ7PYkz78ivm3ZpYwasrzY6+WzfvvzJbyEpU0WVYOddwmcC8t3v8YEkNX6ZpDz0V2aO6XZtO
qU5wBfohjAC5gByGAZkJ743FG1BxryzS07aXNNoPwqr3dG0b3v2YIsW2+O47z4QnK+jPTMQb
dDtICsoU5RNS/5R5MhrCMwPEbsCps3OrzbFFI8/n2KS0IZAGo3gf8hlX823SQMK3Wd6ldvKP
eyPZP2Vz8iD5PyH5PwH5PaT4p9zYMrx3yejn04dUwNfnpQnFU2WLpAmfwgtJMwh7b6MlES6D
vCmpUIKQYA+QcmEjBRFygQi5kPKQdIHYuUhjx7qM+BZCkGIT4JsU1lKDl7eb9Majarn1oZlF
j0aUvQQYn7KXEc9hUSgfCBX6JwPuvoRtnOA/k9Qdb2TAr7jCltjI5Q3fpPIdNmtTFogBMxVQ
+DhV72fIXKvrLGbdXoNasGBfJqX57cw1DcGCcztrROax6C5C6cXXN+HQQ+dKV7+zPErJmCcd
wrn1CZwJt4hPO4gzG3OlSCaughDsw8AfXOPec8E5ptSyQ5lF1TRpLVEOky8zCLNR6/biPBPC
K/Zoyt9XYLU0k2Ab3S0wHbWBUnWXmi3abyK3d0Oxpqr3Iv3FRBrxvWBxZpKmRZk6nkmMscZi
RbiSADyvuXlW8SW0zPXiEYk5ktQlYNfY65KjIZdt2n4/qLKEiBVm4kQ+Vu2FweQmBqwlVvry
V0kJ96JkR6VfM7+AWMSvgp7X95BVxM8/pxSDdGDNSnTrkBFbMklskxDNNoJQchGQyi7ABDTQ
MOP5iEWahQZUi7IKmytMDbpC6ALofewNjby8UwkiaywirtTgv1I0eflFaGKCtQCi4P9Xmua9
TjQkFjabLg9YGsxxllpE35c3PJZdQCdQZlhE5/aLU2+XJ1sp0s1GPg3ftBOLRQtS+ScVc5Jp
W0cPv2qQ1DyCo8zdKb6M6ybBUfk6SE1Z9Z+G//D8HhmAxNriZ/GRV8jwfaILt8zXRlBVs2k0
RXtsgDWp0JSm2k53KRciDNHIFOk41MTt1tJSsUv0vXTkVKGZKZ/Z4qZMU4TverJtCDpKAvZY
qWALPlOy4o+HLV5PLx/Bmg5Cp7fvPyDmqX+OcB14fHg2smyNIKT1WiyLC/i6ji4hLGsKv3/V
iNc/535w1raUdFlTAWzZDR8sMcOeLhZfhPmguKaU7fA+FZH7RSwJBeHtzYibbM7Shdl2uI7c
ulJUkZpx6s4VlpVwGmpA61TZUooLkw5uvqOZ2prTalvyqL1ZZrIy7plZUBgykjRwi01eCeCR
c+kqFQUaa8jXikh1pbUVo93L22y1EJjea0VoTR2XLHfcZpvVEEqvBoKpQH3vfcjkCppiFdEe
X9/mkAKUMdoM5H2J/Zq+1la5U+AvbOUQbudy/irn0NVC/e/7me42Mx39mqhFVGjJv92QLQx8
y2d6CooWi6w06PXyjQkztQSyZFkz3Ne6IVYG0MnwcmTtC0sYgkQSdhl4vexYsnL3XI8OLcs8
wxIbIL4m05wxizErWoWKRIcm9XMVqNkhqLgGtZhxQlGR5ZcsUF8SRhAtEG/edFvKbalGqGmu
rCzBnHTpDbdEHD3d3BLRFf7fjUGHrDSXvrl/Sj2I2cb5YvtYg+fJ5ib8u7G5ufY9/b1Of+Oz
8fiHHza/WV/bfLyxvrn+ZH39m7X1jc3vN74Ra4sFi58xhhcK8Y0Tjv3uxHJuGE34zoNZ0//+
SZ5vvb7fc/ukZU5eLH0Lvz3fVX8ufev53cG454ofwX6HGef8p9QrP7bfxd7Qtd+QyYOvdOMH
J4d7B539X8W6MN69O6R3G/qVtpHExvffCxJ5AQas2HndjgRuwLAxBZp66Do+TM/98UBcOoMx
mNKgAWBkOLCTk+5oMI7wvyX3EyYsR5ejAvrqWxcm9T5rH7xmGEvDeB5vnMT4hi3IJtgJZG3C
tNtzYod0Jc78Tb6QzQMvYSTD31QjiANqQ8S0gEKN4Esqke7vySb3x7tK21g24A2mKy8+91Kn
olXFMdRcf4I149dBGHMfI/hllXJBl4s4WfoxtHRqQQimwOXny6t5n5NlJCizJ8t8NpuFKYx1
+AovjoNiPgagd3EuHEAZuuuwbzp4+FM6eYmHJxqydtMaBM6CKzKzPU8e+Z25/xp7QH40zoo7
o7uPq3T58R98V3lNXudud06Yo8Nu9PVYES5B4JtOu9M+bu/st39r7aH7lSCPLqvGrDPJK77F
Hd5tSPzxSOQVh2p+O1Ep9Y1+ePjIAIZnm4WO0LVttq3wV9THin6lGlZ4lTczo2kTi7pQv0DS
HPrEHhrfAqLQJv5nhBlHKB5wS+wIuX4LlmjseCidwgV2xuuZqYjAmMFVoBJatt4IA0TBzqbE
Rcjv+NUPeiR2sk9QJ3i9c0MsY/1lEZ0H40FPnLpgyUa44ehEHGIKRsp1MBZXDidT7CbQp28w
mdjWMuDOGQ/gaxUjWFG28DW43nzOtEeALnflrYBub9m8G6XKDFePQEnIJZe6bLDxaTiopdGG
zW8RI1NHIDBX5173nPqAmecSEOdFAldAXERmUl3ajYf0D6bjpasYXARSKQ4JEuCa8ANtg+YM
Qpvhpb9mUL5q+m3nFDJIuoYg1NENwC0KFqx7MHJ90id1gT8thgFdduZdwsshUDaDAHBHGAGg
xgf0pzmGdPH+wDmLtkSLeUrPKEGoZ5JVrarrHBQQClLZ9Fe6uYCcLmhwxxf/fLW/DBq/l8PC
shjQ4aMrT8ZGFGIXuqOB1+XVioF76Q5WwRLtNkTVbZw18AIN/fmnjR+b5p8/Js389Lf1v8NX
40WtkM6IF5vSAaKb8FyC0FjMJNf09WpCeGoVxMrexqgp4ovdQRC5kjHoN3m0CuSGSJM3Yl5I
pMvkZB54hiVwp4U5iIaXKpRC4BqiJxp30XlbFfX1BFtCWPjSxynVCExcaWT2DVcuPfYj1/0I
w6Z/8PgAyYCc4700Ao7PQc6NWBZkYho6YQvw4PkGU5Mk/QmQh2PPx1tytA08ZbA0eq+DKDns
ncLksQuqoS7UIo1ai0lwqdQF8qw4vY7dKDPQhSFn14LGRott2BiBZjiifMQUcdMhEB9wQP+w
RYq39ljStPghcyHWVFyMf/OEO7omFmUCIA8E6Zp8mItr8m8183M7E/UeGD+n0BVU4A6cbjym
W4iw01WYnqLIO4U/B2hQxAA6/4/72S4mC62uKxQXcSubYyqNBNdJHZ9MEewdOQp1wf8SyRAl
X59kCMokwoDbliAZAKbp09A2JUiDVcBimSQMGuuEnyK081Rzc+Q/B+uRrSka9Z1SmbkakwCe
qhnMoe5cOt6AlpHropOiA+1ddYHjwMQl0SSlEeNc46EvhLYOOkHocuLmF62/WXbml8KTo0dB
kG+XQJUe+EzoopQx6Nzg/YZUEFES+JbNTGIaoI2ZHhVdgMHDSuywKBiHXbOBnFrSyndY5Rk1
MkxJt06lu8D1ZM9nS7O4n14U2/2kqxWL8ayMigi83bV0+fSh++nqgv65p8/N6XP7awPz6SM3
QOpC/pibHZ94ggo52gmcG1JK5IyfMmqZd3huo5ZplrMDn8SBMq1yttLi2OkWObzzMUoZWuvi
4BSdbOFkkkHOYwoqxVJSA1CW1S1xRP823U+47gQeG8FVxzW1+eFypuzD+dgzUp4SU9pJNb8Y
7m7NVOUStxYYeTkJJHO8xCsukoTwkG+NJdgjL9bWN0GbaWhTVrqUg6SQ2b3qsYeUZsQkwVza
TTKaKzSjlI08YSFopgScYqU4AWfhskceVY4kVTLUaNDmTugOQGtdMrOB/+DBO7JZo2BwCXjX
3wGPXrw4/sZEOctAm+X5MfmsafOKVtLstF5oIjkf3RQfc9IFwJ0f+HX3Ey0bx3hs38VkDeR+
KsR781kjyUejQd252ZszpDUrQKGOnqiLthFm5pyi6+PQWJsJ5La7am+qGPs05jYbhWVvQ79q
PTbRObIdJYBihaIisKza9zBVrFmcNhOFFaatqnXlO95lVGoNGzDry2WnodzZpJpqb1N3qNbN
zJ45KxmtWe8GYz/W3eIfWFt+1JU+W2guoIIVMC31NW5wYIPEbk2DRWlQjuRwjc06UrlBMSIW
XZP9nC4IAW7VoGHu2NGPCzRW89heWmw6uGaLVWGQWjfJjhwoQsMs9JhF7xr4xsOhXtfVIEH8
KcI46NssL28I2S6zRTCX4PbiOVvFCkraezmiSEh1cIxVY5BCD7IGDOyfyc2MhPwknGX44urc
ZUuT7l7jTTYfNwr9M/jDd0HWe1/LiCqiaw45Z6Rm2ThNg3SISjEe8b6T2SBzWZXDPdQN8H3P
HfSimoLg1nFsxTzE2YKYgXROJiRr6BL7hLHXHQ9Az3L2pmoPr8QYeriRcnqNS8XiEX9CRVjj
7WbWgxGwUQDEbbD15QBqXI4HVhsNPHSPt50bYm9MVomxubcKjUn+5O67epsZDBraK/DFcDyI
vRGyMA7lS3s7mFuNy9JPvQqf5z1MWLS3i5dk5I26oaSYCPVzTgo0zWydSxLFYq5KcoskbgRu
cA7Hw4RbbkeqnMVz3fKkRc8SOXKKx6XzKtRlx9Rv6FyBPpRfDG5RQRK3mydzBgod1lWHM4w1
J9lK8VDpDLo1zDiIMTwXBquMHjSQeW/V2DqchwuYM2bqvT4jdVM5KLaX8qLaPutINv4XsMHh
e3gstiBOVsfIYsmXvvfCHYzAm1xMIOiU+M/1Hx6vy/jP79ee/LDxDXzc+H79Pv7zSzxJnOaF
72XDO2Xgpvlu4J1myjkYYWe9c52we26/G/GRCWpR/j4ZjmP30wnwuxOdH+MWzit8IZ6K18cv
Dls7eyev3hy3/nmSRNodYmiAihDdP9j9x8mLnaMXJ8c7z/Zb1Zqw26Wbth7Zbdd07TedafXH
fn4LuonXO8cvTo5ar3cOd44PDsXy1nLy7c1R6/Bkd3/n6AhLiUrzPBi6zesm4M/95HbVOTxU
KFsF3+BPFTu21lhvrDUunLDCgbCoizq8EiKVDXqmcqNvSIcHI2luyO8YEitBe3vQ3hP6WX67
rL+8PHj2srV7rL7sG192Dg93flWfl98bX54dHOy3djqyzm/ml1+PW0k/z4wvuy92DpMvu8aX
oxcHh8f6y5Hxpd3R7+FL2/iyf9D5Jfny0vjyfP9gJ2ntufFl7+AN0Fx92VtmvO65fiAzczMW
xZWrQwn5aCb6I0fHO8ftXfTs1dFLxK8VdisPiXNJDvpUZZc+CzzfeUwRm9QtZ0yheDUkFtrR
DnhBo1EYjEIPfVZJRYpvFk6ffBUEB4qignckuEsmHBdcmo+PbuvJ4NXOPw2uP2ntt17x5DZ0
PpGJIzf+rbOPLslojFLQwEba8TJHYQNeNtf+/oS24rq8IkDnSbqYJqhD5vh3osMtsnRFtSWT
G3PAoRYZM+Zx2C3RlhQQR5wDBgkg0xdJBBBwuu8t0TFWVOi1dA4MCst98T7Ajvij19nKGr/0
68g78x2gCBTiZRT5p11aVKqgGmnXIKoBBelXRbWB9GfE4+tUzWqWxRBtgI8IV5q2gKr/GmO8
FMa7qnoUCAwOiarBvos8HKYZGHnR6CnwCWeuf8nAyDw60iPGT5zCXIWnsqNMwcBjnxadsFcO
V6X1WhkwyaaeG4F/I8eGHctOERLlJFGMpGeNPlSugy94WW1VpXWXK8LYVKTWTxw8eplbX+bM
SddOqlJDLCaYQOjk+PBNC3GOv5/v7B+1ahzJSRj61AUONPtBfRsGVwjnNX5W57EpsCIHF/L4
Fza2E56Nh7QaWzXgdtTbGviF4HEaEckk8hbrYTOHreM3h52jLdOmpMVfc1m1gVBDAQCKEYM5
qABcBvEcz9wiGhxEBHjqeiAJxA2SWDoyZh5Pt1IusZoRK+oSVeNc4wo0mZOSQSlBzbtJqibJ
5jmVklUKsaLlfNV6rQQ479BuupzG5qpoNBo1qY/zDlBS3jNDBeky5KFOVjr0HQpOUxtGm5bu
eFuZIqImb1LtOTCmXJuk5nK50RqRIBZR9CtEYCpNV4pHymTULWCAWWuasGva00oVSQHMuczk
yJfVDKdi4QsWWrCl5I/e8zAY8ihvyaXlGDZHfiY2ZaCe4Of5MDerXwH8qRYIXSCqbhjjUt11
248DMpSt+h/da46bFCsYfAcV+Q92EqgiIi63oiqsTfC278V0slqZD7svWmDFt/6523p93D7o
gK9w8qoFZnm78/ZgV/znd8KIwWcnwGcn2/za61er9LeRtUEfwT7o0s4xJeGgxIS/S+RmSu65
UTcE051KbqtiyNDQrtlfTt1dmJ9Cu+KlcwKOPEp/lLxMMgHxm8+/q7t+/uIaWZ5hBqTQ5hBi
RZ6bZ/btDtTfiTh6PX5lNg3qSN7ySH8zPo/1oSnZSUbyDYGnugPM05EvMsnQWTywPICCR+Kz
+iEpnOAmNXoLVQlBksaBfan97KH9KSyqy7mfQJrUkXg6j02/AFcSag0OFwErD2QUcYmJXpZr
yzUs+913+jSb+pmgFxoi3Csq0losMXdqwMaJf7P2U+2U/vGHSH0wfNKcOxXo32Ss2LA2kqE2
G9iZ3PNQx9AGmJyGfQ2exZgz3vIBfmCGVaTwqmBZ1Q0l6fXdQeRmetYG/fS+c3pVgjil54l6
UZdi1VD/Ce9LStDFrWjYbazj6kE6KcB0vGYR+hb0+kLRaXaZ6WxuWJyIK7U2YnFnctc6/JiZ
P7FSLoM+42YXy6E5vef1uxAe/TfyaIKzyYjHJSEL65wbcnZ85yN7H1pbLKbT/WZ6XAiOUf9c
lEJwu2PrXLr3w5sZvV4uesGQXCx2092mO1wIcrFThaLPaj5MTD1j4pRZBsu7I9JKssb/QCFd
PHokzLd5WEnlaau88b3hiPe7wd+TyxPojKZyV2YMCDkCgv/P7A3e0O7knrMWSMoDkRuXCzAn
Kz964CL9VFkVqUFZKEkyBi7OnFQ2tWXyWUDJkim7RzPJJOHPSo5y5kr5cjMPzfDmtosrG95c
RiIkM3z+ky8cSLlIpGAmBs5x0qY7XciYE2cSFgsrpyvOIq9kXyYb5TtbFrnkTDJ1Isn0esP+
JHsQQj7felkmQx+VeiytvTBBb+4KjGo3wT6UzkkJhxpQyHEobaY6MxDz3PN7zNuIlvzWk2rz
9GXlKA298gshFTrSJFI9W+DMGQxVlQ8PqR4LQchdTzNUwSBlK9BM9Pmmq3GSX1qd48NfBTS/
4o40KqCsQgV633R2uTBFoDnizHIdYabBDVA76hV1IWSKaPiD32d25mXxEZQ9Z66tAqwtzBAl
v+Vs5+txYL2p94JXVMPcqt4q4U2VSWaPEBr95RY1UzgvQPmULIwT8HwrpD5vd/bK4fRBIZzu
qP5TQmVLzfEQdHZDewASMcYNH1jghLadT9CuoftW1iaOB2B7kKmVyWJIIfNgSWc3n2uZDLu5
zMINTOSSDKcwt+ifeWNbT3iqkAIl8h+WTYBIkWKxG8WNScFPt3smx3+tP95Y21D5/37YfAzv
1x9v/vDkPv7rSzw6PKvCmSArgjcVho7nV/EHGNhddQRsBf64RMEg1mw2dWQiKhAjcVRFZroC
H2RNcn5h0fW1xt/WGo83Gj9sQvG/A+rsGoNMFVQg3LAW9340Qa+LykEwih6I55Q0PJUSDBtO
X8eAElu3vBj6lXRgBsqHfc6eV2kihzSJjZpO1OufV5ImdTICCi6TNaz8Sxi5HHLmGpXMSl4/
YK+oPNAtTLv3o5KMl9KMPIx0QizPP8Mxyx7zFFbd0lhLxai18i9siYc9atfOykBj02AruuGj
47Nd9+PrIErUnySsTh1kNbGqymfSa0/AAVaZDw4U0PJcKcNdtwGvWh91op8UJnACVUMpP5Kz
pG8+qjAKIo/CNShZdTceXD8QvwQxEINHmMBSYpiFAKj0Rqo3IPagl21fNyDncNIcfFj0/eON
D0lXnL3FHw9PCCN86Oxpkn8nRfIq5X6pmadQg36V/zRvsc3ATYmS+sFgEFxhWN1DmZZo63f/
YUTg2yCsSmDNodjpv2wiKgtngoq4ylMRpwPnvBF/ivO0BCXaKVQTV0pNqDx3GTVRfZC0cEM1
gQ1oEbkqKSKFfRxw6jK7bRWdhPn+rhuNhtVVgkhCoTw8DTg8d91z56qSx0cy2ZDFSpxUiNCm
UZJlpjgcuL5ipu/WJ7HTuxDjQxUXaQay+s5TcRO0hZikLgxKkmEKKP/LqQqdVpxyHmVGXXq4
y31sYFlIwZa8JG4+EAKIGddk1gd28xP0hDEO7QpN0BTBoHdCZ7amKwuzWnd0XVjtBD5OqDoM
LourDi8n1PTdq8Ka8E3WnGw5YO6gLUWuqs4mhJhTqFjlQ11yhDXxsyL4g4rYEpUjJsuDimVX
5HaGiXDszig1jtk8d6ZwcpvOOE2K3Z1MnWKPTqHxNp1h3gy7K8qkgR2p5vHig4k9TBmNzs+R
HlKSuMPs7jaj4VUyux+Zr+cGXaRZtueFaY6F1/B2ozIFCanEAym+TWUlUJD28L7BcoAahtLG
908+TIEmJ2eHDVFeUo++Nm8yFhQAKSfZrQRakzGaK4Ww5GS2sGHJS31RFkNGHoIJIHwpdKir
JicBos9kAgT7iUNkndYEj3Wa0BknHjMN6aOQ5drB4yWZNuhwIdfPmKCZS13s+1HAxDS+pY+U
I1orLFSV6dP3r44DRkg2JcDRm93d1tHRg+ySWqaJjlS1q5XkPhh5C+G0qnwG42EXq9J6ac1o
ALN4TGtA0lnaN0Zl45YsC7vTr6X5zDtQU/B25TjneXh7vtPeb+2l0PZ5Eon1DXUJfa3j96lv
fePGr2wiD6a+oV4BK4+Mo/xpfqAIVrsHGq55q9eEG2lK84S8kStzCc2MnKGbyeGNkvyhm8jh
kM/T+YVvGrOSI9yUcdIZWKaxjj56T0kXtODzEfw03eUi2KpYs7kbl3WwwlTFkMrwoPQBBmeI
rFIgPkKGsd5yvCr1h9ex5TAOhS1l+S9b+f1Fbv080HMLqafye8xNPux9wP9gaHKe8lbFxaow
+8vChM93311kP3zOvAFJKWKuG2gYRYYCHuH/51yUOq+NivtnIQ/mDkOtssg+Ju//0G6POv+/
vrFJ+z9r62v3+z9f4tndxfCdbndpf0/+2H2+v/MLXlQo6sPHG6J+JurvxLf1d5gso/6Odjmh
sCpUfzdYrYfkYaYPsdMFsRehS8fYvcd/e9KUF5nU98sXHVxcDiUgnAeTe/wklvbbHYS93s5t
TG1rTf4ML/3xp6Xj1tHxkZzPaDMUGn920tl51VIvu0tHL/Dd29bhUfuggxsVYung2UtVqxEs
Hb6C381Tz2+GAHF/aQkQtiX+u6qaqsFv6qgmlpaM11gGW6ot/Re83cNiEr01UQ8EgG0UbkRB
47+rFiw1xkgU0I06JYrL7sTvS//16JEY+IDZfpluMkVwGNTUFuOgiyPY3cUeduUAsEIH3tS7
qsiSwsJWgm6zJn9sdIFLGkB+E3/MBoEutLTUxcDzLax8+KomVhpg0AJcKwmmVxqD4EzcTzL3
z/1z/9w/98/9c//cP/fP/XP/3D/3z/1z/9w/98/9c//cP/fP/XP/3D/3z/+T5/8ALlLg0gBA
AQA=

--UugvWAfsgieZRqgk--

From MAILER-DAEMON Mon May 15 20:15:39 2006
Return-Path: 
 <hadoop-dev-return-1431-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79803 invoked from network); 15 May 2006 20:15:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 20:15:39 -0000
Received: (qmail 14139 invoked by uid 500); 15 May 2006 20:15:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13946 invoked by uid 500); 15 May 2006 20:15:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13841 invoked by uid 99); 15 May 2006 20:15:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 13:15:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 13:15:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 396A141000D
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 20:15:07 +0000 (GMT)
Message-ID: <29142220.1147724107232.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 20:15:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-219) SequenceFile#handleChecksumException
 NPE
In-Reply-To: <8800423.1147717266857.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-219?page=all ]
     
Doug Cutting resolved HADOOP-219:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed
      Assign To: Doug Cutting

I just committed a fix for this.  Instead of checking for a null configuration, I tried to make sure that a non-null configuration is always available.  Thanks, Michael!

> SequenceFile#handleChecksumException NPE
> ----------------------------------------
>
>          Key: HADOOP-219
>          URL: http://issues.apache.org/jira/browse/HADOOP-219
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: stack@archive.org
>     Assignee: Doug Cutting
>     Priority: Trivial
>      Fix For: 0.3
>  Attachments: hadoop-219.patch
>
> The SequenceFile#handleChecksumException assumes the conf data member has been set.  It will not be set if we use the 'Reader(FileSystem fs, Path file, int bufferSize, long start, long length)' constructor.  The latter is used by ReduceTask Sorter:
> java.lang.NullPointerException
> 	at org.apache.hadoop.io.SequenceFile$Reader.handleChecksumException(SequenceFile.java:407)
> 	at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:400)
> 	at org.apache.hadoop.io.SequenceFile$Sorter$MergeStream.next(SequenceFile.java:837)
> 	at org.apache.hadoop.io.SequenceFile$Sorter$MergeQueue.merge(SequenceFile.java:881)
> 	at org.apache.hadoop.io.SequenceFile$Sorter$MergePass.run(SequenceFile.java:766)
> 	at org.apache.hadoop.io.SequenceFile$Sorter.mergePass(SequenceFile.java:702)
> 	at org.apache.hadoop.io.SequenceFile$Sorter.sort(SequenceFile.java:528)
> 	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:253)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:787)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 20:25:36 2006
Return-Path: 
 <hadoop-dev-return-1432-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83275 invoked from network); 15 May 2006 20:25:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 20:25:36 -0000
Received: (qmail 26841 invoked by uid 500); 15 May 2006 20:25:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26761 invoked by uid 500); 15 May 2006 20:25:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26736 invoked by uid 99); 15 May 2006 20:25:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 13:25:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 13:25:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1D05941000F
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 20:25:07 +0000 (GMT)
Message-ID: <21117753.1147724707116.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 20:25:07 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-212?page=comments#action_12402410 ] 

Milind Bhandarkar commented on HADOOP-212:
------------------------------------------

Doug, the problem is occuring much earlier before NPE:

060515 123400 DIR* FSDirectory.mkdirs: failed to create directory /srcdat

Looks like your DFS config has a root directory not writable for you. Because the test is trying to create dfs://localhost:65314/srcdat. I am using org.apache.hadoop.dfs.MiniDFSCluster for testing copying across dfs.


> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: TEST-org.apache.hadoop.fs.TestCopyFiles.txt, dfs-blocksize.patch
>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 20:40:34 2006
Return-Path: 
 <hadoop-dev-return-1433-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87411 invoked from network); 15 May 2006 20:40:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 20:40:34 -0000
Received: (qmail 51121 invoked by uid 500); 15 May 2006 20:40:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51102 invoked by uid 500); 15 May 2006 20:40:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51093 invoked by uid 99); 15 May 2006 20:40:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 13:40:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 13:40:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8C8BA41000D
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 20:40:06 +0000 (GMT)
Message-ID: <21044356.1147725606573.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 20:40:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-212?page=comments#action_12402416 ] 

Doug Cutting commented on HADOOP-212:
-------------------------------------

Milind, I don't think these 'failed to create directory' messages are the problem.  That unit test succeeeds w/o this patch and fails with it.  In either case the unit test prints these messages.  I think these messages are because the directories already exist, so new attempts to create them fail, but I have not yet looked closely at that.

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: TEST-org.apache.hadoop.fs.TestCopyFiles.txt, dfs-blocksize.patch
>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 20:50:34 2006
Return-Path: 
 <hadoop-dev-return-1434-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89687 invoked from network); 15 May 2006 20:50:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 20:50:34 -0000
Received: (qmail 59732 invoked by uid 500); 15 May 2006 20:50:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59710 invoked by uid 500); 15 May 2006 20:50:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59701 invoked by uid 99); 15 May 2006 20:50:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 13:50:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 13:50:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A376E41000E
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 20:50:06 +0000 (GMT)
Message-ID: <22948660.1147726206665.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 20:50:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-212?page=comments#action_12402418 ] 

Owen O'Malley commented on HADOOP-212:
--------------------------------------

Ok, I found the problem. I'll create a new patch.

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: TEST-org.apache.hadoop.fs.TestCopyFiles.txt, dfs-blocksize.patch
>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 21:00:34 2006
Return-Path: 
 <hadoop-dev-return-1435-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 92553 invoked from network); 15 May 2006 21:00:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 21:00:34 -0000
Received: (qmail 71647 invoked by uid 500); 15 May 2006 21:00:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71521 invoked by uid 500); 15 May 2006 21:00:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71512 invoked by uid 99); 15 May 2006 21:00:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 14:00:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 14:00:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 93B9F41000D
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 21:00:06 +0000 (GMT)
Message-ID: <32696909.1147726806602.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 21:00:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-212?page=all ]

Owen O'Malley updated HADOOP-212:
---------------------------------

    Attachment: dfs-blocksize-2.patch

This adds an additional check for null on a file's block list.

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: TEST-org.apache.hadoop.fs.TestCopyFiles.txt, dfs-blocksize-2.patch, dfs-blocksize.patch
>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 21:28:34 2006
Return-Path: 
 <hadoop-dev-return-1436-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 2264 invoked from network); 15 May 2006 21:28:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 21:28:34 -0000
Received: (qmail 33306 invoked by uid 500); 15 May 2006 21:28:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33283 invoked by uid 500); 15 May 2006 21:28:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33274 invoked by uid 99); 15 May 2006 21:28:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 14:28:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 14:28:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8D2F641000D
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 21:28:06 +0000 (GMT)
Message-ID: <12895975.1147728486575.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 21:28:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-212) allow changes to dfs block size
In-Reply-To: <28825893.1147448769761.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-212?page=all ]
     
Doug Cutting resolved HADOOP-212:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> allow changes to dfs block size
> -------------------------------
>
>          Key: HADOOP-212
>          URL: http://issues.apache.org/jira/browse/HADOOP-212
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: TEST-org.apache.hadoop.fs.TestCopyFiles.txt, dfs-blocksize-2.patch, dfs-blocksize.patch
>
> Trying to change the DFS block size, led the realization that the 32,000,000 was hard coded into the source code. I propose:
>   1. Change the default block size to 64 * 1024 * 1024.
>   2. Add the config variable dfs.block.size that sets the default block size.
>   3. Add a parameter to the FileSystem, DFSClient, and ClientProtocol create method that let's the user control the block size.
>   4. Rename the FileSystem.getBlockSize to getDefaultBlockSize.
>   5. Add a new method to FileSytem.getBlockSize that takes a pathname.
>   6. Use long for the block size in the API, which is what was used before. However, the implementation will not work if block size is set bigger than 2**31.
>   7. Have the InputFormatBase use the blocksize of each file to determine the split size.
> Thoughts?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 21:51:34 2006
Return-Path: 
 <hadoop-dev-return-1437-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10075 invoked from network); 15 May 2006 21:51:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 21:51:34 -0000
Received: (qmail 75942 invoked by uid 500); 15 May 2006 21:51:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75921 invoked by uid 500); 15 May 2006 21:51:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75912 invoked by uid 99); 15 May 2006 21:51:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 14:51:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 14:51:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 915557141F8
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 21:51:06 +0000 (GMT)
Message-ID: <21183947.1147729866592.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 21:51:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-218) Inefficient calls to get
 configuration values in TaskInprogress
In-Reply-To: <22268273.1147644545906.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-218?page=all ]
     
Doug Cutting resolved HADOOP-218:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

I just committed this.  Thanks, Mahadev!

> Inefficient calls to get configuration values in TaskInprogress
> ---------------------------------------------------------------
>
>          Key: HADOOP-218
>          URL: http://issues.apache.org/jira/browse/HADOOP-218
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: speculative.patch
>
> Each time a pollforNewTask in called on the JobTracker, the taskinprogress makes a call to hasSpeculativeTask() which current does a conf.getSpeculativeExecution() each time its called. The fix would be to store it in the TaskInProgress as soon as it is created and make only a single call to conf.getSpeculativeExecution().

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 15 22:20:33 2006
Return-Path: 
 <hadoop-dev-return-1438-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15976 invoked from network); 15 May 2006 22:20:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 May 2006 22:20:33 -0000
Received: (qmail 19967 invoked by uid 500); 15 May 2006 22:20:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19947 invoked by uid 500); 15 May 2006 22:20:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19938 invoked by uid 99); 15 May 2006 22:20:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 15:20:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 15:20:32 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DC78841000D
	for <hadoop-dev@lucene.apache.org>; Mon, 15 May 2006 22:20:05 +0000 (GMT)
Message-ID: <19210133.1147731605899.JavaMail.jira@brutus>
Date: Mon, 15 May 2006 22:20:05 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-220) Add -dfs and -jt command-line
 parameters to specify namenode and jobtracker.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Add -dfs and -jt command-line parameters to specify namenode and jobtracker.
----------------------------------------------------------------------------

         Key: HADOOP-220
         URL: http://issues.apache.org/jira/browse/HADOOP-220
     Project: Hadoop
        Type: Sub-task

  Components: fs  
 Environment: All
    Reporter: Milind Bhandarkar


Most hadoop commands accept -df and -jt commandline parameters. Make the cp command to accept those as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 03:39:21 2006
Return-Path: 
 <hadoop-dev-return-1439-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91876 invoked from network); 16 May 2006 03:39:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 03:39:21 -0000
Received: (qmail 50662 invoked by uid 500); 16 May 2006 03:39:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50640 invoked by uid 500); 16 May 2006 03:39:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50631 invoked by uid 99); 16 May 2006 03:39:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 20:39:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 20:39:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 87615410011
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 03:38:52 +0000 (GMT)
Message-ID: <9402608.1147750732522.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 03:38:52 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-221) make the number of map output
 configurable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

make the number of map output configurable
------------------------------------------

         Key: HADOOP-221
         URL: http://issues.apache.org/jira/browse/HADOOP-221
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3
 Attachments: more-map-output-servers.patch

The number of map output server threads in each task tracker is currently set to the number of task slots. Since the optimum setting depends on the network, it would be nice to have more threads serving map output files than reduces.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 03:39:22 2006
Return-Path: 
 <hadoop-dev-return-1440-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91909 invoked from network); 16 May 2006 03:39:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 03:39:22 -0000
Received: (qmail 50818 invoked by uid 500); 16 May 2006 03:39:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50797 invoked by uid 500); 16 May 2006 03:39:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50786 invoked by uid 99); 16 May 2006 03:39:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 20:39:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 20:39:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 48F5E410012
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 03:38:54 +0000 (GMT)
Message-ID: <21127438.1147750734289.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 03:38:54 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-221) make the number of map output
 configurable
In-Reply-To: <9402608.1147750732522.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-221?page=all ]

Owen O'Malley updated HADOOP-221:
---------------------------------

    Attachment: more-map-output-servers.patch

> make the number of map output configurable
> ------------------------------------------
>
>          Key: HADOOP-221
>          URL: http://issues.apache.org/jira/browse/HADOOP-221
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: more-map-output-servers.patch
>
> The number of map output server threads in each task tracker is currently set to the number of task slots. Since the optimum setting depends on the network, it would be nice to have more threads serving map output files than reduces.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 04:01:35 2006
Return-Path: 
 <hadoop-dev-return-1441-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95910 invoked from network); 16 May 2006 04:01:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 04:01:35 -0000
Received: (qmail 61619 invoked by uid 500); 16 May 2006 04:01:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61600 invoked by uid 500); 16 May 2006 04:01:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61591 invoked by uid 99); 16 May 2006 04:01:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 21:01:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 21:01:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A173541000D
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 04:01:06 +0000 (GMT)
Message-ID: <27265954.1147752066658.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 04:01:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-179) task tracker ghosts remain after 10
 minutes
In-Reply-To: <1916800.1146508846408.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-179?page=all ]
     
Owen O'Malley resolved HADOOP-179:
----------------------------------

    Resolution: Fixed

This bug is fixed in the most part by my patch to HADOOP-180, which among other things made the task trackers choose names for themselves based on the host and port number. Because when task trackers are reinitialized for missing a heartbeat, they will almost always get the same name, they will not leave behind "ghosts".

> task tracker ghosts remain after 10 minutes
> -------------------------------------------
>
>          Key: HADOOP-179
>          URL: http://issues.apache.org/jira/browse/HADOOP-179
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> I had a bunch of TaskTrackers time out because they were in the middle of job cleanup and the JobTracker restarted them by responding to emitHeartbeat with UNKNOWN_TASKTRACKER. Afterwards, I ended up with both the new and the restarted TaskTrackers on the list:
> node1100_1234, 0-10 seconds since heartbeat
> node1100_4321,  >10,000 seconds since heartbeat

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 04:04:02 2006
Return-Path: 
 <hadoop-dev-return-1442-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96256 invoked from network); 16 May 2006 04:04:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 04:04:02 -0000
Received: (qmail 62474 invoked by uid 500); 16 May 2006 04:04:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62360 invoked by uid 500); 16 May 2006 04:04:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62349 invoked by uid 99); 16 May 2006 04:04:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 21:04:02 -0700
X-ASF-Spam-Status: No, hits=0.3 required=10.0
	tests=HTML_MESSAGE,MAILTO_TO_SPAM_ADDR,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of michael.cafarella@gmail.com
 designates 64.233.184.234 as permitted sender)
Received: from [64.233.184.234] (HELO wr-out-0506.google.com) (64.233.184.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 21:04:00 -0700
Received: by wr-out-0506.google.com with SMTP id 68so930047wri
        for <hadoop-dev@lucene.apache.org>;
 Mon, 15 May 2006 21:03:39 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=QovVA1m33ZD7FTyMowNjhMM8JLHLtU5lv0nrP9PuNKNbVO3NUmqTjPi6nUOjbIu9sbISCPjE5rhIR24y67aP0zz+GQDIazOTcBr7bGT3X2Wvkz5AZv7wfJVTVp3Ed6h3kUUC3TQpuaOSD3LEGphQxFyuRAN+JDicOeg3HvrtS4E=
Received: by 10.65.254.20 with SMTP id g20mr2690791qbs;
        Mon, 15 May 2006 21:03:39 -0700 (PDT)
Received: by 10.64.220.14 with HTTP; Mon, 15 May 2006 21:03:39 -0700 (PDT)
Message-ID: <8a8b9f3f0605152103r76c103dak452b4ce71d9ca8dc@mail.gmail.com>
Date: Mon, 15 May 2006 21:03:39 -0700
From: "Michael Cafarella" <michael.cafarella@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Re: HBase Design Ideas, Part I
In-Reply-To: <37AB4917-06E2-4781-8316-D6ABDDEA7F9B@yahoo-inc.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_74321_2666152.1147752219779"
References: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
	 <37AB4917-06E2-4781-8316-D6ABDDEA7F9B@yahoo-inc.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_74321_2666152.1147752219779
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

On 5/14/06, Eric Baldeschwieler <eric14@yahoo-inc.com> wrote:
>
> Seems like you are exporting a lot of complexity to the clients by
> having them find the table chunks via DFS read.  Lots of data motion
> and sync / cache issues there.  When not just ask the master for the
> block/server of a key?  Or you could distribute this work over your
> HRegionServers if you don't want to stress the master.  All this
> could be kept fresh in RAM there (segmented if you get huge). [but
> this adds complexity]


Sorry, maybe the text was confusing.  I didn't mean for a client to
ever directly read a DFS file.  The stored files should only be served
by HRegionServers, directly to clients.  Clients might have to go through
a level of indirection to find the right HRegionServer, but that should
only happen once before being cached.

I imagine in practice that most of the key-->HRegionServer mapping
will end up being cached in memory.


As I read you design, it sounds like you might be doing a lot of
> seeks to find a record (do you need to scan all the logs to see if a
> key is present?).  Best to outline the performance you want and then
> look at the ram / disk trade-offs.  IE you can store everything in
> BTRees, but then you will thrash you disks.  Or you can store
> everything linearly and store all your unmerged entries in RAM.  This
> would have different costs/benefits...


Checking for the existence of a key should require at most one
sort.  To check for the presence of a key, you need to locate the relevant
HRegionServer, then test to see if the key is stored there.

The suggestion is to keep most data in read-only files where the
start and end keys for a page are stored in an external map.  True, you
need a seek to test for the existence of a key, but there's no way to
avoid that unless all keys are stored in memory.  Items are stored
in-order, so linear scans will be very quick.  You never edit one of
these structures in place.

Edits are kept in memory and periodically logged to disk.  Every so
often, we generate a brand-new read-only structure by merging the logs and
the
existing read-only structure.

Writes are fast, being logged to memory and lazily to disk.
A read lookup takes at most one disk seek.  A scan is very efficient,
requiring no unnecessary seeks.  Read operations may become a little
complicated, as we have to integrate the read-only structure, the log
files, and the memory buffer.  However, since all of these extra operations
will be in-memory, there should be no problem performance-wise.  (One
thing to worry about is the edits that have been logged to disk already.
We should probably compact often enough so that edits can always
fit in memory comfortably.)


On May 14, 2006, at 3:00 PM, Michael Cafarella wrote:
>
> > Hi everyone,
> >
> > I've written up a design that I've been working on for a little
> > bit, for
> > a project I'll call "HBase".  The idea is for Hadoop to implement
> > something
> > similar in spirit to BigTable.  That is, a distributed data store that
> > places a greater emphasis on scalability than on SQL compatibility
> > or traditional transactional correctness.
> >
> > BigTable is neither completely described anywhere, nor is it
> > necessarily exactly what we want.  So I'm not trying to clone
> > BigTable,
> > but I am going to draw on it a lot.
> >
> > My personal view is that BigTable is a great "physical layer" but
> > not yet
> > a great database system.  A major thing it lacks is a good query
> > language.
> > Another, freely admitted by the Google people, is any kind of inter-
> > row
> > locking.  I'm not going to try to solve all these problems, but I
> > would
> > like HBase to be extendible enough that it's easy to add new query
> > languages or primitives.
> >
> > In this mail, I'll describe a system that's pretty similar to
> > BigTable.
> > I'll send a second one that describes what we might want to change
> > or add.
> >
> > Please let me know what you think!
> >
> > Thanks,
> > --Mike
> >
> > ----------------------------------------------------------------------
> > ----------
> > I.  Table semantics
> >
> > An HBase consists of one or more HTables.  An HTable is a list of
> > rows,
> > sorted alphabetically by "row name".  An HTable also has a series of
> > "columns."  A row may or may not contain a value for a column.  The
> > HTable representation is sparse, so if a row does not contain a value
> > for a given column, there is no storage overhead.
> >
> > (Thus, there's not really a "schema" to an HTable.  Every
> > operation, even
> > adding a column, is considered a row-centric operation.)
> >
> > The "current version" of a row is always available, timestamped
> > with its
> > last modification date.  The system may also store previous
> > versions of a row,
> > according to how the HTable is configured.
> >
> > Updates to a single row are always atomic and can affect one or
> > more columns.
> >
> > II.  System layout
> >
> > HTables are partitionable into contiguous row regions called HRegions.
> > All machines in a pool run an HRegionServer.  A given HRegion is
> > served
> > to clients by a single HRegionServer.  A single HRegionServer may be
> > responsible for many HRegions.  The HRegions for a single HTable will
> > be scattered across arbitrary HRegionServers.
> >
> > When a client wants to add/delete/update a row value, it must
> > locate the
> > relevant HRegionServer.  It then contacts the HRegionServer and
> > communicates
> > the updates.  There may be other steps, mainly lock-oriented ones.
> > But locating
> > the relevant HRegionServers is a bare minimum.
> >
> > The HBase system can repartition an HTable at any time.  For
> > example, many
> > repeated inserts at a single location may cause a single HRegion to
> > grow
> > very large.  The HBase would then try to split that into multiple
> > HRegions.
> > Those HRegions may be served by the same HRegionServer as the
> > original or may be served by a different one.
> >
> > Each HRegionServer sends a regular heartbeat to an HBaseMaster
> > machine.
> > If the heartbeat for an HRegionServer fails, then the HBaseMaster
> > is responsible
> > for reassigning its HRegions to other available HRegionServers.
> >
> > All HRegions are stored within DFS, so the HRegion is always
> > available, even
> > in the face of machine failures.  The HRegionServers and DFS
> > DataNodes run
> > on the same set of machines.  We would like for an HRegionServer to
> > always
> > serve data stored locally, but that is not guaranteed when using
> > DFS.  We can
> > encourage it by:
> > 1) In the event of an insert-motivated HRegion move, the new
> > HRegionServer
> > should always create a new DFS file for the new HRegion.  The DFS
> > rules of
> > thumb will allocate the chunks locally for the HRegionServer.
> > 2) In the even of a machine failure, we cannot do anything similar
> > to above.
> > Instead, the HBaseMaster can ask DFS for hints as to where the
> > relevant
> > file blocks are stored.  If possible, it will allocate the new
> > HRegions to servers
> > that physically contain the HRegion.
> > 3) If necessary, we could add an API to DFS that demands block
> > replication
> > to a given node.  I'd like to avoid this if possible.
> >
> > The mapping from row to HRegion (and hence, to HRegionServer) is
> > itself
> > stored in a special HTable.  The HBaseMaster is the only client
> > allowed to
> > write to this HTable.  This special HTable may itself be split into
> > several
> > HRegions.  However, we only allow a hard-coded number of split-levels.
> > The top level of this hierarchy must be easily-stored on a single
> > machine.
> > That top-level table is always served by the HBaseMaster itself.
> >
> > III.  Client behavior
> >
> > Let's think about what happens when a client wants to add a row.
> > 1) The client must compute what HRegion is responsible for the key
> > it wants to insert into the HTable.  It must navigate the row->HRegion
> > mapping, which is stored in an HTable.
> >
> > So the client first contacts the HBaseMaster for the top-level
> > table contents.
> > It then steps downward through the table set, until it finds the
> > mapping for
> > the target row.
> >
> > 2) The client contacts the HRegionServer responsible for the target
> > row,
> > and asks to insert.  If the HRegionServer is no longer responsible
> > for the
> > relevant HRegion, it returns a failure message and tells the client
> > to go
> > back to step 1 to find the new correct HRegionServer.
> >
> > If the HRegionServer is the right place to go, it accepts the new
> > row from
> > the client.  The HRegionServer guarantees that the insert is
> > atomic; it
> > will not intermingle the insert with a competing insert for the
> > same row key.
> > When the row is stored, the HRegionServer includes version and
> > timestamp
> > information.
> >
> > 3) That's it!
> >
> > IV The HRegionServer
> >
> > Maintaining the data for a single HRegion is slightly complicated.
> > It's
> > especially weird given the write-once semantics of DFS.  There are
> > three important moving parts:
> >
> > 1) HBackedStore is a file-backed store for rows and their values.
> > It is never edited in place.  It has B-Tree-like lookups for finding
> > a row quickly.  HBackedStore is actually a series of on-disk stores,
> > each store being tuned for a certain object size.  Thus, all the
> > "small"
> > (in bytes) values for a row live within the same file, all the medium
> > ones live in a separate file, etc.  There is only one HBackedStore
> > for any single HRegion.
> >
> > 2) HUpdateLog is a log of updates to the HBackedStore.  It is backed
> > by an on-disk file.  When making reads from the HBackedStore, it may
> > be necessary to consult the HUpdateLog to see if any more-recent
> > updates have been made.  There may be a series of HUpdateLogs
> > for a single HRegion.
> >
> > 3) HUpdateBuf is an in-memory version of HUpdateLog.  It, too, needs
> > to be consulted whenever performing a read.  There is only one
> > HUpdateBuf for a single HRegion.
> >
> > Any incoming edit is first made directly to the HUpdateBuf.  Changes
> > made to the HUpdateBuf are volatile until flushed to an HUpdateLog.
> > The rate of flushes is an admin-configurable parameter.
> >
> > Periodically, the HBackedStore and the series of current HUpdateLogs
> > are merged to form a new HBackedStore.  At that point, the old
> > HUpdateLog
> > objects can be destroyed.  During this compaction process, edits are
> > made to the HUpdateBuf.
>
>

------=_Part_74321_2666152.1147752219779--

From MAILER-DAEMON Tue May 16 04:22:28 2006
Return-Path: 
 <hadoop-dev-return-1443-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 332 invoked from network); 16 May 2006 04:22:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 04:22:28 -0000
Received: (qmail 84891 invoked by uid 500); 16 May 2006 04:22:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84866 invoked by uid 500); 16 May 2006 04:22:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84857 invoked by uid 99); 16 May 2006 04:22:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 21:22:28 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of michael.cafarella@gmail.com
 designates 64.233.184.239 as permitted sender)
Received: from [64.233.184.239] (HELO wr-out-0506.google.com) (64.233.184.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 21:22:27 -0700
Received: by wr-out-0506.google.com with SMTP id i31so975908wra
        for <hadoop-dev@lucene.apache.org>;
 Mon, 15 May 2006 21:22:06 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Fj9lCKLU9QTeOB/sDruS/rKj8miSXRxRw1DDJgxANSlwtziYruZNr80s2AtBZKilHOwK42e5xMWEkuDMQCOxAKf6JR85T7oR9e9+RGOeFUR4UxBEiLXOfjfGODw70Rag98kISPbb95S7bIicYfXgy2AyWUNB818SeNu7X/g0rMU=
Received: by 10.65.219.7 with SMTP id w7mr465302qbq;
        Mon, 15 May 2006 21:22:06 -0700 (PDT)
Received: by 10.64.220.14 with HTTP; Mon, 15 May 2006 21:22:06 -0700 (PDT)
Message-ID: <8a8b9f3f0605152122l47c34c51gcc16cc7dbe9138de@mail.gmail.com>
Date: Mon, 15 May 2006 21:22:06 -0700
From: "Michael Cafarella" <michael.cafarella@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Re: HBase Design Ideas, Part I
In-Reply-To: <1C4AA81B-4C69-42B0-8B40-E1598CCB8E77@media-style.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_74425_30345858.1147753326136"
References: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
	 <1C4AA81B-4C69-42B0-8B40-E1598CCB8E77@media-style.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_74425_30345858.1147753326136
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Hi Stefan,

Thanks for your mail.  Comments below.

On 5/15/06, Stefan Groschupf <sg@media-style.com> wrote:
>
> I was playing around with row and run in to several problems using
> the hadoop io package. (SequenceReader writer)
> Optimal would be if a cell is a writable but having rowkey and cell
> key and value for each sell blows up disk usage.
> Alternative we can have a row writable so we only one rowkey , n
> column key and n values.
> In case a row has many column this scales very bad. For example my
> row key is a url and my column keys are user ids and the value are
> number of clicks.
> if I want to get the number of clicks for a given url and user, I
> need to load the values for all other user as well. :(
>
> I already posted a mail about this issue.
> What we may be need is a Writer that can seek first for row key and
> than for column keys.
> In general I agree with  sparse structure.


What about this: don't store explicit "column" fields anywhere.  Rather,
each row is stored as a series of key-value pairs, where the key is the
column name.

True, if there are a huge number of columns and you are interested in
just one, there will be unnecessary processing.  This is especially bad
if one column is a 2-char string and another column is a video file.

So we should actually keep a family of files, segmented by object size.
But in the general case, it shouldn't be possible to "seek to a column".
Instead, you seek to a row and unpack all its key/val (col/cell) pairs.


> My idea was to have the lock on the HRegionServer level, my ideas was
> that the client itself take care about replication,
> means write the value to n servers that have the same replicatins of
> HRegions.


Do you mean that a lock applies to an entire server at once?  Or
that an HRegionServer is responsible for all locks?  (I'd like to do
the latter, at least in the short-term.)

I'd like to avoid having an HRegion that's hosted by multiple servers,
because then it's unclear which HRegionServer should own the lock.
I suppose the HRegionServers for a given HRegion could hold an
election, but this seems like a lot of work.

If there's a row that's really "hot" and wanted by a lot of clients, I coul=
d
imagine starting a series of "read-only" HRegionServers that field read
requests.  That way you avoid having an election for the lock but can
still scale capacity if necessary.

(I don't think we'll ever have a situation where a flood of writes come in
the door.  If so, the whole design is a bad idea!)


>
> > The HBase system can repartition an HTable at any time.  For
> > example, many
> > repeated inserts at a single location may cause a single HRegion to
> > grow
> > very large.  The HBase would then try to split that into multiple
> > HRegions.
> > Those HRegions may be served by the same HRegionServer as the
> > original or may be served by a different one.
> Would the node send out a message to request a split or does the
> master decide based on heart beat messages?


There are two ways that an HRegionServer might offer brand-new
service for an HRegion:
1) The HRegion's old HRegionServer died.  A new HRegionServer
offers the exact same HRegion, loaded from a DFS file.  This will
have to be initiated by the HBaseMaster, because it is the only node that
knows about heartbeats.

2) An HRegion is getting too big, and must be split into two.  I
imagine that this can be initiated by the local HRegionServer,
which then asks the master for various hints (like where there
is another lightly-loaded HRegionServer that could take a new
Region).


My idea was to simply download the data to the node and read any time
> locally, but write into the dfs, since in my case write access can be
> slower but I needer very fast read access.


You mean just keep a local cache of the DFS file?  That might be
a good idea for a feature we add into DFS as a performance enhancement.


My idea was in such a case the HRegionServer may be know the new
> location at least until the master is informed.
> So getting a forward message could be faster than get an error and
> try ask for the target again.


The old HRegionServer may not know the new location, depending
on how the new one was created.  (The old one might be dead, too!)
But if we can speed things up substantially by forwarding the location,
I think that's OK.

------=_Part_74425_30345858.1147753326136--

From MAILER-DAEMON Tue May 16 04:54:41 2006
Return-Path: 
 <hadoop-dev-return-1444-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6915 invoked from network); 16 May 2006 04:54:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 04:54:41 -0000
Received: (qmail 3417 invoked by uid 500); 16 May 2006 04:54:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3396 invoked by uid 500); 16 May 2006 04:54:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3387 invoked by uid 99); 16 May 2006 04:54:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 21:54:40 -0700
X-ASF-Spam-Status: No, hits=0.9 required=10.0
	tests=HTML_10_20,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of michael.cafarella@gmail.com
 designates 64.233.184.235 as permitted sender)
Received: from [64.233.184.235] (HELO wr-out-0506.google.com) (64.233.184.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 15 May 2006 21:54:39 -0700
Received: by wr-out-0506.google.com with SMTP id i11so112264wra
        for <hadoop-dev@lucene.apache.org>;
 Mon, 15 May 2006 21:54:18 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=IywS85WywE7uulw/PWTbN2ac2bZ8QUbvYeOM0zUgHETxMQRWXyHNZV+bAgrMptfyq6Odm3CQlHfHQtQKlbFht0sg6kQZxA4g7BlmNpJMfJw07a+jZiw9/l0uzwDCR5dxnhRaFDCk2u2s+Djs6fKYDwm7vEBbxq3T2SWvJWZYwEk=
Received: by 10.65.113.10 with SMTP id q10mr2777893qbm;
        Mon, 15 May 2006 21:54:18 -0700 (PDT)
Received: by 10.64.220.14 with HTTP; Mon, 15 May 2006 21:54:18 -0700 (PDT)
Message-ID: <8a8b9f3f0605152154q2f219948ieb997284b69e6854@mail.gmail.com>
Date: Mon, 15 May 2006 21:54:18 -0700
From: "Michael Cafarella" <michael.cafarella@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: HBase Design Ideas, Part II
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_74637_30969402.1147755258112"
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_74637_30969402.1147755258112
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Hi everyone,

My previous mail mentioned a bunch of design ideas that were mainly
lifted from Jeff Dean's BigTable talk.  BigTable seems like a useful
way to do large-scale row storage, and their decisions largely seem
like the right ones.

However, BigTable still leaves some things on the table.  Items to
improve include a query language and multi-row locking, among
other things.

Dean said explicitly in his talk that they wanted to avoid multirow
locking because it's complicated, error-prone, and maybe not necessary.
He's right on at least the first two, and maybe the third.

Multiple row locks are useful when you're making a change to
several rows that should be atomic; you want all the changes
or none of the changes.  It's also used in traditional databases
if you want to perform an expensive read operation (like a
multiway join) and you want to make sure the results don't
get modified while you're reading.

Distributed lock acquisition is very hard to do.  It's bug-prone
and often has very weird performance ramifications.  It's
difficult to get working, difficult to tune, difficult to everything.

Here are a few ideas on what to do:
1)  Suck it up and have the client acquire locks on multiple
HRegionServers simultaneously.  All clients would have to
agree to acquire locks according to some global ordering to
avoid deadlock.  HRegions would not be allowed to migrate
to a new server if locked.

If this is a rare circumstance, a better approach would be
to have a dedicated "lock acquirer" through which clients
make requests.  It doesn't help the theoretical problem here,
but it would make debugging an awful lot easier.

2)  In the case of long-lasting read operations, we can
use versioning to guarantee consistency.  If each row is
annotated with an edit timestamp, and we know that there
is sufficient version history available, the long-lasting job
can run over a specific version only.

Edits can continue to be made to the database while the
read-only job is ongoing.  The operation is performed over
the database as of the time the task was submitted.

3) In the case of multiple row updates, we may be able to
use different edit semantics to avoid locking.  For example,
consider that we want to add a single column/value pair to
multiple rows.  We want this to happen atomically, so that
both rows get the value or neither of them do so.

If it's just an add, then we don't need to lock the rows at
all; the add will always succeed, even if other writes
intervene. Traditionally there's been no difference between
among data "updates", so they all require locking.  If we
can get a client to adjust the update semantics slightly,
then the locking can be much more relaxed.

I'd say that "add" or "append" semantics are likely to be
at least as common as "edit" semantics.

Can you think of the family of edit semantics you'd like
to see offered here?

Also, how useful do you think a general-purpose query language
would be for HBase?  It would be fairly straightforward to implement,
for example, a poor man's version of SQL that has different locking
and update behavior (and which chucks out the more exotic elements).
This might be compiled into a piece of code that is executed
immediately, or it might be transformed into a long-lasting mapreduce
job.

I have a few ideas for such a language, but I'm worried it's getting
a little far afield from what we're interested in for Hadoop.

--Mike

------=_Part_74637_30969402.1147755258112--

From MAILER-DAEMON Tue May 16 15:49:40 2006
Return-Path: 
 <hadoop-dev-return-1448-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70250 invoked from network); 16 May 2006 15:49:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 15:49:40 -0000
Received: (qmail 61399 invoked by uid 500); 16 May 2006 15:49:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61378 invoked by uid 500); 16 May 2006 15:49:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Delivered-To: moderator for hadoop-dev@lucene.apache.org
Received: (qmail 54119 invoked by uid 99); 16 May 2006 08:58:32 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
From: Isabel Drost <idrost@HTWM.De>
To: hadoop-dev@lucene.apache.org
Subject: Fwd: Re: nitpicking: nutch tutorial/ missing option
Date: Tue, 16 May 2006 10:57:57 +0200
User-Agent: KMail/1.9.1
Organization: HU Berlin
MIME-Version: 1.0
Content-Type: multipart/signed;
  boundary="nextPart11966107.OErIZQ4eq7";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <200605161058.05801.drost@informatik.hu-berlin.de>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--nextPart11966107.OErIZQ4eq7
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline


Hello *,

I am just about to have a look at the new nutch 0.8 after six months
of "holidays" :) Looks really great. Although I will need some time to get
back into the code and realize what I would like to implement.

Just a little nitpicking documentationwise: At

 http://lucene.apache.org/nutch/tutorial8.html

there is a great tutorial for nutch newbies. Yet there seems to be a
missing option in the following line:

 bin/nutch invertlinks crawl/linkdb crawl/segments

I got that line working with

 bin/nutch invertlinks crawl/linkdb -dir crawl/segments

I cannot edit that page, that's why I am sending this by mail. Doug asked m=
e=20
to forward the request to this mailing list, so I guess someone of you has=
=20
the access rights ;) Or at least you can prove me wrong, in case I missed=20
something.


Cheers,
Isabel

Btw.: Some commands do not work as suggested with non-Bash shells. But I
guess an experienced user can figure that out for himself quite easily.


=2D-=20
QOTD: It is contrary to reasoning to say that there is a vacuum or space in=
=20
which there is absolutely nothing.   -- Descartes=20
  |\      _,,,---,,_    =20
  /,`.-'`'    -.  ;-;;,_  More information about the
 |,4-  ) )-,_..;\ (  `'-' sender of this mail available
'---''(_/--'  `-'\_) (fL) at http://www.isabel-drost.de ;)

--nextPart11966107.OErIZQ4eq7
Content-Type: application/pgp-signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)

iD8DBQBEaZQdPJpCBAwIhbQRAj9YAJ0ZBV1+wAJKeLFSkjkgXthufVCJ2gCeJKHU
oBth1vkCSjJSMS0532Jl9sM=
=oE6X
-----END PGP SIGNATURE-----

--nextPart11966107.OErIZQ4eq7--

From MAILER-DAEMON Tue May 16 11:18:35 2006
Return-Path: 
 <hadoop-dev-return-1445-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37221 invoked from network); 16 May 2006 11:18:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 11:18:35 -0000
Received: (qmail 38986 invoked by uid 500); 16 May 2006 11:18:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38957 invoked by uid 500); 16 May 2006 11:18:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38945 invoked by uid 99); 16 May 2006 11:18:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 04:18:33 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 04:18:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D51787141E3
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 11:18:05 +0000 (GMT)
Message-ID: <12449154.1147778285869.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 11:18:05 +0000 (GMT+00:00)
From: "Johan Oskarson (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-222) Set replication from dfsshell
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Set replication from dfsshell
-----------------------------

         Key: HADOOP-222
         URL: http://issues.apache.org/jira/browse/HADOOP-222
     Project: Hadoop
        Type: New Feature

  Components: dfs  
    Versions: 0.3    
    Reporter: Johan Oskarson
    Priority: Trivial


Added ability to set replication for a directory/file from the command line.
Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 11:20:35 2006
Return-Path: 
 <hadoop-dev-return-1446-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37817 invoked from network); 16 May 2006 11:20:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 11:20:35 -0000
Received: (qmail 40543 invoked by uid 500); 16 May 2006 11:20:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40521 invoked by uid 500); 16 May 2006 11:20:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40512 invoked by uid 99); 16 May 2006 11:20:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 04:20:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 04:20:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 999D1410005
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 11:20:06 +0000 (GMT)
Message-ID: <11881678.1147778406626.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 11:20:06 +0000 (GMT+00:00)
From: "Johan Oskarson (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-222?page=all ]

Johan Oskarson updated HADOOP-222:
----------------------------------

    Attachment: setrep.patch

> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>  Attachments: setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 12:00:53 2006
Return-Path: 
 <hadoop-dev-return-1447-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52506 invoked from network); 16 May 2006 12:00:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 12:00:53 -0000
Received: (qmail 74524 invoked by uid 500); 16 May 2006 12:00:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74501 invoked by uid 500); 16 May 2006 12:00:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74492 invoked by uid 99); 16 May 2006 12:00:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 05:00:53 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [202.46.19.91] (HELO mailsrv.bangalore.corp.yahoo.com)
 (202.46.19.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 05:00:51 -0700
Received: from [10.80.32.170] (UNKNOWN-10-80-32-170.yahoo.com [10.80.32.170]
 (may be forged))
	by mailsrv.bangalore.corp.yahoo.com (8.13.6/8.13.4/pop-in) with ESMTP id
 k4GC0Rrm041586
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 17:30:27 +0530 (IST)
Mime-Version: 1.0 (Apple Message framework v750)
Content-Transfer-Encoding: 7bit
Message-Id: <79B37A47-DB27-45DE-BB53-0E731D02930D@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Sanjay Dahiya <sanjayd@yahoo-inc.com>
Subject: MapReduce C++ API
Date: Tue, 16 May 2006 17:30:26 +0530
X-Mailer: Apple Mail (2.750)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi -

I am working on the C++ API for MapReduce. Following are a few ways  
to implement it, I am looking for feedback on how
users may want to use this API, which will impact how we should  
design it.

For Mapper and Reducer its fairly straightforward to provide a Java  
Class which acts as a proxy to channel calls to C++
code using JNI. The problem is with the data IO to Map and reduce  
functions. The complexity depends on how much
flexibility do we want to provide to the C++ code in terms of  
defining the data format.

1. Allow Users of API to define custom data format for records  
consumed/produced by Map and Reduce. It can be
implemented in 2 ways

a) Make MapReduce(java) framework aware of the data format by  
exporting IO formats and reading/writing to a native
implementation. In this case effectively all(most) of the classes  
involved in data read/write will have a proxy (native)
implementation which could be configured in jobcof. Implementation of  
native methods will be in a typical JNI lib. In
this case we can avoid moving data(explicitely by serializing)  
between C++ and Java code. This will increase the
complexity on user's part but gives more flexibility in defining data  
formats. In this case user will not need to write any Java code.

b) Use explicit serialization between java and C++ code using Record  
IO. In this case user defines the data format with
Record IO and generates C++/Java classes. Also user need to write  
wrappers for the generated classes which will
implement Writable/WriteableComparable. In this case the IO classes  
will not have native implementation and only
Mapper/Reducer need a native implementation with some helper classes  
which can serialize/deserialize data. User will
need knowledge of both Java and C++ (and Record IO).

2. User use a single/standard data formats.

a) MapReduce(java) framework is not aware of the actual record  
format. It deals with a single format which could be any
one of the available formats or strings. All interchange with C++  
through JNI is done in the form of strings, C++ code
can convert this raw data in any structure using JUTE or any other  
data binding tool. After processing the data C++
code will return the standard object back to Java. In this case if  
users are using the same record format then they
need to define only Map and Reduce functions, rest is taken care of  
by the framework using helper methods, otherwise
they also need to take care of serializing and deserializing data.

b) Map and reduce work on string records only. Export Map and Reduce  
methods to native code with a Java proxy. Users
need only implement these two methods and link the library. Rest is  
taken care of by the framework.

thanks
~Sanjay

From MAILER-DAEMON Tue May 16 18:11:36 2006
Return-Path: 
 <hadoop-dev-return-1449-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30307 invoked from network); 16 May 2006 18:11:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 18:11:36 -0000
Received: (qmail 71956 invoked by uid 500); 16 May 2006 18:11:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71822 invoked by uid 500); 16 May 2006 18:11:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71813 invoked by uid 99); 16 May 2006 18:11:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 11:11:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 11:11:33 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DC761714283
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 18:11:05 +0000 (GMT)
Message-ID: <30650123.1147803065900.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 18:11:05 +0000 (GMT+00:00)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-223) Should be able to re-run jobs,
 collecting only missing output
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Should be able to re-run jobs, collecting only missing output
-------------------------------------------------------------

         Key: HADOOP-223
         URL: http://issues.apache.org/jira/browse/HADOOP-223
     Project: Hadoop
        Type: New Feature

  Components: mapred  
    Reporter: Bryan Pendleton
    Priority: Minor


For jobs with no side effects (roughly == jobs with speculative execution enabled), if partial output has been generated, it should be possible to re-run the job, and fill in the missing pieces. I have now run the same job twice, once finishing 42 of 44 reduce tasks, another time finishing only 17. Each time, many nodes have failed, causing many many tasks to fail ( in one case, 5k failures from 15k map tasks, 23 failures from 44 reduces), but some valid output was generated. Since the output is only dependent on the input, and both jobs used the same input, I will now be able to combine these two failed task outputs to get a completed job's output. This should be something that can be more automatic.

In particular, it should be possible to resubmit a job, with a list of partitions that should be ignored. A special Combiner, or pre-Combiner, would throw out any map output for partitions that have already been successfully completed, thus reducing the amount of data that needs to be reduced to complete the job. It would, of course, be nice to support "filling in" existing outputs, rather than having to do a move operation on completed outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 19:26:36 2006
Return-Path: 
 <hadoop-dev-return-1450-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69305 invoked from network); 16 May 2006 19:26:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 19:26:36 -0000
Received: (qmail 27681 invoked by uid 500); 16 May 2006 19:26:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27661 invoked by uid 500); 16 May 2006 19:26:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27642 invoked by uid 99); 16 May 2006 19:26:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 12:26:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 12:26:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CC20241000E
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 19:26:06 +0000 (GMT)
Message-ID: <16988678.1147807566705.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 19:26:06 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-220) Add -dfs and -jt command-line
 parameters to specify namenode and jobtracker.
In-Reply-To: <19210133.1147731605899.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-220?page=all ]

Milind Bhandarkar updated HADOOP-220:
-------------------------------------

    Attachment: hadoop-220.patch

Indeed a lot of code is duplicated for parsing command-line options for hadoop commands. Until that gets fixed, here is a patch to add -dfs and -jt commands to "hadoop cp".


> Add -dfs and -jt command-line parameters to specify namenode and jobtracker.
> ----------------------------------------------------------------------------
>
>          Key: HADOOP-220
>          URL: http://issues.apache.org/jira/browse/HADOOP-220
>      Project: Hadoop
>         Type: Sub-task

>   Components: fs
>  Environment: All
>     Reporter: Milind Bhandarkar
>  Attachments: hadoop-220.patch
>
> Most hadoop commands accept -df and -jt commandline parameters. Make the cp command to accept those as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 20:51:35 2006
Return-Path: 
 <hadoop-dev-return-1451-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 5186 invoked from network); 16 May 2006 20:51:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 20:51:35 -0000
Received: (qmail 4539 invoked by uid 500); 16 May 2006 20:51:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4512 invoked by uid 500); 16 May 2006 20:51:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4503 invoked by uid 99); 16 May 2006 20:51:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 13:51:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 13:51:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3D1F941000E
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 20:51:06 +0000 (GMT)
Message-ID: <21710422.1147812666211.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 20:51:06 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-136?page=all ]

Michel Tourn updated HADOOP-136:
--------------------------------

    Attachment: largeutf8.patch

Here is the patch, two new files:

org.apache.hadoop.io.TestLargeUTF8
org.apache.hadoop.io.LargeUTF8

The only difference with the UTF8 string format is that 
the length is stored on 4 bytes rather than 2 bytes.

TestLargeUTF8 tests serialization of larger strings up to 1MB




> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor
>  Attachments: largeutf8.patch
>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 20:58:36 2006
Return-Path: 
 <hadoop-dev-return-1452-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7016 invoked from network); 16 May 2006 20:58:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 20:58:36 -0000
Received: (qmail 17029 invoked by uid 500); 16 May 2006 20:58:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17011 invoked by uid 500); 16 May 2006 20:58:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17001 invoked by uid 99); 16 May 2006 20:58:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 13:58:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 13:58:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2BD3C41000F
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 20:58:07 +0000 (GMT)
Message-ID: <20475687.1147813087176.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 20:58:07 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Reopened: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-191?page=all ]
     
Michel Tourn reopened HADOOP-191:
---------------------------------


An update to hadoop-streaming.



> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: streaming.2.patch, streaming.3.patch, streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 20:58:43 2006
Return-Path: 
 <hadoop-dev-return-1453-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7049 invoked from network); 16 May 2006 20:58:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 20:58:43 -0000
Received: (qmail 17298 invoked by uid 500); 16 May 2006 20:58:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17164 invoked by uid 500); 16 May 2006 20:58:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17154 invoked by uid 99); 16 May 2006 20:58:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 13:58:42 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 13:58:41 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 856ED410011
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 20:58:08 +0000 (GMT)
Message-ID: <32579201.1147813088544.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 20:58:08 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-191?page=all ]

Michel Tourn updated HADOOP-191:
--------------------------------

    Attachment: streaming.3.patch

This patch depends on the LargeUTF8 patch:  http://issues.apache.org/jira/browse/HADOOP-136


Added a few more configurable options.

michel@cdev2004> bin/hadoop jar build/hadoop-streaming.jar -info
Usage: $HADOOP_HOME/bin/hadoop jar build/hadoop-streaming.jar [options]
Options:
  -input    <path>     DFS input file(s) for the Map step
  -output   <path>     DFS output directory for the Reduce step
  -mapper   <cmd>      The streaming command to run
  -combiner <cmd>      Not implemented. But you can pipe the mapper output
  -reducer  <cmd>      The streaming command to run
  -file     <file>     File/dir to be shipped in the Job jar file
  -cluster  <name>     Default uses hadoop-default.xml and hadoop-site.xml
  -config   <file>     Optional. One or more paths to xml config files
  -dfs      <h:p>      Optional. Override DFS configuration
  -jt       <h:p>      Optional. Override JobTracker configuration
  -inputreader <spec>  Optional.
  -jobconf  <n>=<v>    Optional.
  -cmdenv   <n>=<v>    Optional. Pass env.var to streaming commands
  -verbose

For more details about these options:
Use $HADOOP_HOME/bin/hadoop jar build/hadoop-streaming.jar -info


> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: streaming.2.patch, streaming.3.patch, streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 21:21:04 2006
Return-Path: 
 <hadoop-dev-return-1454-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14545 invoked from network); 16 May 2006 21:21:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 21:21:04 -0000
Received: (qmail 55517 invoked by uid 500); 16 May 2006 21:20:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55475 invoked by uid 500); 16 May 2006 21:20:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55448 invoked by uid 99); 16 May 2006 21:20:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 14:20:51 -0700
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 14:20:50 -0700
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k4GLKPWJ002527
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 17:20:28 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout7-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k4GLKNux122016;
	Tue, 16 May 2006 17:20:23 -0400
Message-ID: <446A4216.6020306@apache.org>
Date: Tue, 16 May 2006 14:20:22 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.8 (X11/20060502)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Please don't re-open closed bugs
References: <20475687.1147813087176.JavaMail.jira@brutus>
In-Reply-To: <20475687.1147813087176.JavaMail.jira@brutus>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Please don't re-open closed bugs that are included in releases, since 
that messes up Jira's change log for the release.  Bugs normally 
transition from Open to Resolved/Fixed, then to Closed when a release is 
made.  It's okay to re-open a bug whose fix has not yet been released, 
but it is generally better to create a new bug in this case too.

Ideally I could modify the Jira permissions so that non-administrators 
cannot transition bugs from Closed to Open and are forced to instead 
start a new bug, but that does not appear to be possible.

Doug

From MAILER-DAEMON Tue May 16 21:29:36 2006
Return-Path: 
 <hadoop-dev-return-1455-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16537 invoked from network); 16 May 2006 21:29:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 21:29:36 -0000
Received: (qmail 69421 invoked by uid 500); 16 May 2006 21:29:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69399 invoked by uid 500); 16 May 2006 21:29:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69390 invoked by uid 99); 16 May 2006 21:29:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 14:29:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 14:29:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B9CBF41000F
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 21:29:06 +0000 (GMT)
Message-ID: <2943419.1147814946758.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 21:29:06 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-161) dfs blocks define equal, but not
 hashcode
In-Reply-To: <2765023.1145750645831.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-161?page=all ]

Milind Bhandarkar updated HADOOP-161:
-------------------------------------

    Attachment: hadoop-161.patch

Added a hashCode method to Block. The hash algorithm is from "Effective Java" by Joshua Bloch.

> dfs blocks define equal, but not hashcode
> -----------------------------------------
>
>          Key: HADOOP-161
>          URL: http://issues.apache.org/jira/browse/HADOOP-161
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Sameer Paranjpye
>  Attachments: hadoop-161.patch
>
> Findbugs reports that dfs.Block defines equals but not hashcode, which is problematic if it is ever put into a hash table.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 21:56:36 2006
Return-Path: 
 <hadoop-dev-return-1456-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23615 invoked from network); 16 May 2006 21:56:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 21:56:36 -0000
Received: (qmail 747 invoked by uid 500); 16 May 2006 21:56:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 711 invoked by uid 500); 16 May 2006 21:56:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 702 invoked by uid 99); 16 May 2006 21:56:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 14:56:34 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 14:56:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E018541000F
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 21:56:05 +0000 (GMT)
Message-ID: <3300836.1147816565914.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 21:56:05 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Allow simplified versioning for namenode and datanode metadata.
---------------------------------------------------------------

         Key: HADOOP-224
         URL: http://issues.apache.org/jira/browse/HADOOP-224
     Project: Hadoop
        Type: Improvement

  Components: dfs  
 Environment: All
    Reporter: Milind Bhandarkar


Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 

The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.

I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.

This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.

The writer is not so versioned, because metadata is always written in the most current version format.

One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.

For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.

Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 22:19:36 2006
Return-Path: 
 <hadoop-dev-return-1457-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30509 invoked from network); 16 May 2006 22:19:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 22:19:36 -0000
Received: (qmail 36085 invoked by uid 500); 16 May 2006 22:19:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36066 invoked by uid 500); 16 May 2006 22:19:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36057 invoked by uid 99); 16 May 2006 22:19:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 15:19:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 15:19:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 982C341000F
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 22:19:06 +0000 (GMT)
Message-ID: <6673399.1147817946620.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 22:19:06 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-161) dfs blocks define equal, but not
 hashcode
In-Reply-To: <2765023.1145750645831.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-161?page=all ]

Milind Bhandarkar updated HADOOP-161:
-------------------------------------

    Attachment: hadoop-161-correct.patch

Please disregard the last patch. Since equals compares blockIds only, hashCode should also consider only blockIds. Correct patch is attached here.

> dfs blocks define equal, but not hashcode
> -----------------------------------------
>
>          Key: HADOOP-161
>          URL: http://issues.apache.org/jira/browse/HADOOP-161
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Sameer Paranjpye
>  Attachments: hadoop-161-correct.patch, hadoop-161.patch
>
> Findbugs reports that dfs.Block defines equals but not hashcode, which is problematic if it is ever put into a hash table.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 22:51:36 2006
Return-Path: 
 <hadoop-dev-return-1458-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40138 invoked from network); 16 May 2006 22:51:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 22:51:36 -0000
Received: (qmail 73403 invoked by uid 500); 16 May 2006 22:51:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73381 invoked by uid 500); 16 May 2006 22:51:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73372 invoked by uid 99); 16 May 2006 22:51:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 15:51:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 15:51:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 998AF71423B
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 22:51:06 +0000 (GMT)
Message-ID: <3557027.1147819866626.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 22:51:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12412070 ] 

Doug Cutting commented on HADOOP-224:
-------------------------------------

I certainly agree that this data should be versioned.

I'm not sure what you mean by, "As we add information to these metadata, the complexity of the reader increases dramatically".  Typically I'd expect we'll be adding new fields to each entry, and perhaps sometimes removing a field, or adding a new type of entry.  Do you have something else in mind?

The way I'm used to handling this is to put a version byte at the start of each file and perhaps even each record.  I'm not sure that a major/minor versioning system is required, nor that we need a registry of reader classes, etc.  I've handled lots of such format changes with simple code like:

byte version = in.readByte();
...
if (version > 3) {
  newField = in.readXXX();
} else {
  newField = YYY;
}

This assumes that one is implementing the readFields() method directly.  If we're instead using generated code to read items, then perhaps an alternate mechanism is required.  Is that what you're assuming?


> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:02:49 2006
Return-Path: 
 <hadoop-dev-return-1459-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43564 invoked from network); 16 May 2006 23:02:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:02:49 -0000
Received: (qmail 89927 invoked by uid 500); 16 May 2006 23:02:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89902 invoked by uid 500); 16 May 2006 23:02:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89887 invoked by uid 99); 16 May 2006 23:02:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:02:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:02:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 12E53714296
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:02:07 +0000 (GMT)
Message-ID: <15849598.1147820527073.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:02:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-161) dfs blocks define equal, but not
 hashcode
In-Reply-To: <2765023.1145750645831.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-161?page=all ]
     
Doug Cutting resolved HADOOP-161:
---------------------------------

    Resolution: Fixed
     Assign To: Milind Bhandarkar  (was: Sameer Paranjpye)

I just committed this.  Thanks, Milind!

> dfs blocks define equal, but not hashcode
> -----------------------------------------
>
>          Key: HADOOP-161
>          URL: http://issues.apache.org/jira/browse/HADOOP-161
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Milind Bhandarkar
>  Attachments: hadoop-161-correct.patch, hadoop-161.patch
>
> Findbugs reports that dfs.Block defines equals but not hashcode, which is problematic if it is ever put into a hash table.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:02:49 2006
Return-Path: 
 <hadoop-dev-return-1460-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43584 invoked from network); 16 May 2006 23:02:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:02:49 -0000
Received: (qmail 90149 invoked by uid 500); 16 May 2006 23:02:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90054 invoked by uid 500); 16 May 2006 23:02:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90045 invoked by uid 99); 16 May 2006 23:02:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:02:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:02:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A053A41000F
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:02:08 +0000 (GMT)
Message-ID: <19325456.1147820528654.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:02:08 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-161) dfs blocks define equal, but not
 hashcode
In-Reply-To: <2765023.1145750645831.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-161?page=all ]

Doug Cutting updated HADOOP-161:
--------------------------------

    Fix Version: 0.3

> dfs blocks define equal, but not hashcode
> -----------------------------------------
>
>          Key: HADOOP-161
>          URL: http://issues.apache.org/jira/browse/HADOOP-161
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Milind Bhandarkar
>      Fix For: 0.3
>  Attachments: hadoop-161-correct.patch, hadoop-161.patch
>
> Findbugs reports that dfs.Block defines equals but not hashcode, which is problematic if it is ever put into a hash table.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:05:42 2006
Return-Path: 
 <hadoop-dev-return-1461-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44580 invoked from network); 16 May 2006 23:05:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:05:42 -0000
Received: (qmail 92704 invoked by uid 500); 16 May 2006 23:05:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92576 invoked by uid 500); 16 May 2006 23:05:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92567 invoked by uid 99); 16 May 2006 23:05:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:05:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:05:39 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 98FC4714294
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:05:06 +0000 (GMT)
Message-ID: <7123779.1147820706624.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:05:06 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12412072 ] 

Milind Bhandarkar commented on HADOOP-224:
------------------------------------------

I am referring to exactly this kind of code:

if (version > 3) { 
  newField = in.readXXX(); 
} else { 
  newField = YYY; 
} 

As more and more of such code gets added to the load and save method, it becomes complicated to follow. Such code is currently in the FSDirectory class, thus tightly coupling the abstraction of directory to the format used to store this data in the FSImage.

If we instead separate this into a separate class, say FSImageReader, and as we make major changes to file format, introduce new classes such as FSImageReaderV2, FSImaageReaderV3 etc. A member in FSDirectory will hold a reference to current file format reader, of which, the "parse" method will be called by FSDirectory. If FSImageReaderV3 is the current version, and it is trying to read an image that it cannot read, it will call FSImageReaderV2's parse method, and so on. Since the readers will not have any real state, the parse methods will be static methods, to avoid overhead of chaining.

So, as a first step, I could separate the loadFSImage and loadFSEdits into two different classes.

Does it make sense ?

> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:09:49 2006
Return-Path: 
 <hadoop-dev-return-1462-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45705 invoked from network); 16 May 2006 23:09:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:09:49 -0000
Received: (qmail 97200 invoked by uid 500); 16 May 2006 23:09:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97073 invoked by uid 500); 16 May 2006 23:09:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97064 invoked by uid 99); 16 May 2006 23:09:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:09:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:09:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 12611714294
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:09:07 +0000 (GMT)
Message-ID: <29979317.1147820947072.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:09:07 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-115?page=all ]

Runping Qi updated HADOOP-115:
------------------------------

    Attachment: patch_115.txt.2006_05_16

My patch is attached.

 

Change highlights:

JobConf.java:
    Added set/getMapOutputKey/ValueClass methods
    Modified getOutputKeyComparatorClass 

MapTask.java:
    call getMapOutputKey/ValueClass instead of getOutputKey/ValueClass

MapReduce.java:
    call getMapOutputKey/ValueClass instead of getOutputKey/ValueClass

MapOutputFile.java:
    call getMapOutputKey/ValueClass instead of getOutputKey/ValueClass

 

I've run a job with a combiner, with UTF8 as the  map output value class, and  CrawledDoc as the output value class.

The job completed successfully.



> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Runping Qi
>     Assignee: Runping Qi
>  Attachments: hadoop-115_ReduceTask.patch, hadoop-115_tk.patch, patch_115.txt.2006_05_16
>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:21:36 2006
Return-Path: 
 <hadoop-dev-return-1463-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51307 invoked from network); 16 May 2006 23:21:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:21:36 -0000
Received: (qmail 12791 invoked by uid 500); 16 May 2006 23:21:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12770 invoked by uid 500); 16 May 2006 23:21:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12761 invoked by uid 99); 16 May 2006 23:21:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:21:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:21:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 922B871429B
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:21:06 +0000 (GMT)
Message-ID: <13837990.1147821666595.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:21:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12412075 ] 

Doug Cutting commented on HADOOP-224:
-------------------------------------

Yes, it makes sense, but it sounds like a lot of duplicated code.  And how will fields added in V3 be populated correctly by the V2 reader?  In other words, we'll still need code in V3 that knows how to upgrade things from V2.  Yes, this code could be separated from the raw i/o code, but I don't see how it really saves much complexity.

To continue my example above, under your scheme you'd have something like:

public void readFields(DataInput in) {
  byte version = in.readByte();
  if (version < 3) {
    readFieldsV2(in);
    newField = YYY;  // version 2 didn't have this field, so we default its value
  } else {
    ReadFieldsV3(in)
  }
}

public static void readFieldsV3(Foo instance, DataInput in) {
  readFieldsV2(in);
  newField = in.readYYY();
}

Which doesn't look a lot simpler to me.  Or have I missed something?

> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:27:14 2006
Return-Path: 
 <hadoop-dev-return-1464-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53774 invoked from network); 16 May 2006 23:27:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:27:14 -0000
Received: (qmail 19662 invoked by uid 500); 16 May 2006 23:26:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19622 invoked by uid 500); 16 May 2006 23:26:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19224 invoked by uid 99); 16 May 2006 23:26:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:26:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:26:39 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AC4CF410011
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:26:10 +0000 (GMT)
Message-ID: <338134.1147821970703.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:26:10 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-115) permit reduce input types to differ
 from reduce output types
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-115?page=all ]

Doug Cutting updated HADOOP-115:
--------------------------------

        Summary: permit reduce input types to differ from reduce output types  (was: Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.)
           type: New Feature  (was: Improvement)
    Description: 
When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.

When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.

A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.



  was:

When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.

When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.

A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.




> permit reduce input types to differ from reduce output types
> ------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Runping Qi
>     Assignee: Runping Qi
>  Attachments: hadoop-115_ReduceTask.patch, hadoop-115_tk.patch, patch_115.txt.2006_05_16
>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:33:09 2006
Return-Path: 
 <hadoop-dev-return-1465-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58472 invoked from network); 16 May 2006 23:33:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:33:09 -0000
Received: (qmail 23879 invoked by uid 500); 16 May 2006 23:32:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23755 invoked by uid 500); 16 May 2006 23:32:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23529 invoked by uid 99); 16 May 2006 23:32:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:32:40 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:32:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 41726410013
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:32:09 +0000 (GMT)
Message-ID: <17344121.1147822329264.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:32:09 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12412076 ] 

Milind Bhandarkar commented on HADOOP-224:
------------------------------------------

I agree that readFields is a problem with versioning. That is why I said:

"One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly."

Which means, instead of using the readFields in reading the composite objects such as dfs.Block (which is the only class other than simple writable types such as UTF8 written to metadata currently), one should read basic types, and then use set methods of Block to set appropriate fields. If we modify block's state later, those modifications should always provide defaults (through constructors) for added fields, so it would remain backward-compatible.

> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:40:49 2006
Return-Path: 
 <hadoop-dev-return-1466-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61224 invoked from network); 16 May 2006 23:40:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:40:49 -0000
Received: (qmail 31817 invoked by uid 500); 16 May 2006 23:40:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31688 invoked by uid 500); 16 May 2006 23:40:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31672 invoked by uid 99); 16 May 2006 23:40:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:40:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:40:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0587941000F
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:40:07 +0000 (GMT)
Message-ID: <29844098.1147822807019.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:40:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-115) permit reduce input types to differ
 from reduce output types
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-115?page=all ]
     
Doug Cutting resolved HADOOP-115:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

Your patch has some strange formatting, and some spurious whitespace changes.  I fixed most of these.  It would also be best to have a unit test that uses this feature.  But I'm tired of this issue, and it should do no harm, so I committed it.

> permit reduce input types to differ from reduce output types
> ------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Runping Qi
>     Assignee: Runping Qi
>      Fix For: 0.3
>  Attachments: hadoop-115_ReduceTask.patch, hadoop-115_tk.patch, patch_115.txt.2006_05_16
>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 16 23:47:36 2006
Return-Path: 
 <hadoop-dev-return-1467-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62316 invoked from network); 16 May 2006 23:47:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 May 2006 23:47:36 -0000
Received: (qmail 36219 invoked by uid 500); 16 May 2006 23:47:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36198 invoked by uid 500); 16 May 2006 23:47:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36189 invoked by uid 99); 16 May 2006 23:47:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:47:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 16:47:34 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 95F4341000F
	for <hadoop-dev@lucene.apache.org>; Tue, 16 May 2006 23:47:06 +0000 (GMT)
Message-ID: <15018706.1147823226611.JavaMail.jira@brutus>
Date: Tue, 16 May 2006 23:47:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12412079 ] 

Doug Cutting commented on HADOOP-224:
-------------------------------------

What if we were to, e.g., add an accessTime, how could we have it default to lastModified?  Or if we remove a field, merging its value into another field, then we'd need fixup code specific to that.  I'm not sure how you'd handle that.  But then, I'm not sure I completely understand yet what you're proposing.  Maybe some pseudo code would help?

> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 05:06:51 2006
Return-Path: 
 <hadoop-dev-return-1468-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28195 invoked from network); 17 May 2006 05:06:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 05:06:51 -0000
Received: (qmail 48052 invoked by uid 500); 17 May 2006 05:06:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47969 invoked by uid 500); 17 May 2006 05:06:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47930 invoked by uid 99); 17 May 2006 05:06:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 22:06:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 22:06:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7DA5F71423B
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 05:06:07 +0000 (GMT)
Message-ID: <28507110.1147842367512.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 05:06:07 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12412092 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

I wrote a network bandwidth tester that just uses Java sockets to connect all nodes to all nodes. My application waits until all of the servers are up and starts sending data (10g/node) using Java's sockets. On my cluster, which is currently at 202 nodes, it took an average of 1423 seconds (mean of 1630) to finish the transfer between nodes. That is substantially faster than Hadoop's shuffle (7 hours?) and means that we have a long way to go in terms of shuffle optimization.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 05:09:06 2006
Return-Path: 
 <hadoop-dev-return-1469-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29066 invoked from network); 17 May 2006 05:09:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 05:09:06 -0000
Received: (qmail 50689 invoked by uid 500); 17 May 2006 05:08:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50667 invoked by uid 500); 17 May 2006 05:08:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50658 invoked by uid 99); 17 May 2006 05:08:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 22:08:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 22:08:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9FCC4410005
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 05:08:06 +0000 (GMT)
Message-ID: <4235777.1147842486651.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 05:08:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-195) transfer map output transfer with http
 instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-195?page=all ]

Owen O'Malley updated HADOOP-195:
---------------------------------

    Comment: was deleted

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 05:09:06 2006
Return-Path: 
 <hadoop-dev-return-1470-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29065 invoked from network); 17 May 2006 05:09:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 05:09:06 -0000
Received: (qmail 50839 invoked by uid 500); 17 May 2006 05:08:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50819 invoked by uid 500); 17 May 2006 05:08:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50810 invoked by uid 99); 17 May 2006 05:08:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 22:08:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 22:08:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 771E041000F
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 05:08:07 +0000 (GMT)
Message-ID: <29179612.1147842487485.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 05:08:07 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12412093 ] 

Owen O'Malley commented on HADOOP-195:
--------------------------------------

I wrote a network bandwidth tester that just uses Java sockets to connect all nodes to all nodes. My application waits until all of the servers are up and starts sending data (10g/node) using Java's sockets. On my cluster, which is currently at 202 nodes, it took an average of 1423 seconds (median of 1630) to finish the transfer between nodes. That is substantially faster than Hadoop's shuffle (7 hours?) and means that we have a long way to go in terms of shuffle optimization.



> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 05:18:41 2006
Return-Path: 
 <hadoop-dev-return-1471-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30972 invoked from network); 17 May 2006 05:18:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 05:18:41 -0000
Received: (qmail 62977 invoked by uid 500); 17 May 2006 05:18:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62851 invoked by uid 500); 17 May 2006 05:18:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62841 invoked by uid 99); 17 May 2006 05:18:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 22:18:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 16 May 2006 22:18:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A805641000E
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 05:18:06 +0000 (GMT)
Message-ID: <1832239.1147843086685.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 05:18:06 +0000 (GMT+00:00)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12412094 ] 

Runping Qi commented on HADOOP-224:
-----------------------------------


Is this issue the same as the general versioning problem of object deserialization? Or did I miss something?

In my own programs, when I need to write a serializable class, I've been using  a convention like the following:

	public void write(DataOutput out) throws IOException {
		out.writeInt(Link.version);
		out.writeUTF(this.url);
	}

	private void readFields_1(DataInput in) throws IOException {
		this.url = in.readUTF();
		...
	}

	public void readFields(DataInput in) throws IOException {
		int version = in.readInt();
		switch (version) {
		case 1:
			this.readFields_1(in);
			break;
		default:
			throw new IOException("Serialization version number " + version + " of class Link is not recognized\n");
		}
	}

When I make changes on the class representation that affect how the class is serialized, I'd implement a new read methods:

	public void write(DataOutput out) throws IOException {
		out.writeInt(Link.version);
		out.writeUTF(this.url);
		out.writeUTF(this.anchor);
	}

	private void readFields_2(DataInput in) throws IOException {
		this.url = in.readUTF();
		this.anchor = in.readUTF();
                                                     ....
	}

	public void readFields(DataInput in) throws IOException {
		int version = in.readInt();
		switch (version) {
		case 1:
			this.readFields_1(in);
			break;
                                                     case 2:
                                                                                this.readFields_2(in);
                                                                                break;
		default:
			throw new IOException("Serialization version number " + version + " of class Link is not recognized\n");
		}
	}


I found this approach provides me great flexibility in versioning while maintaining backward compatibility.
And the code is also not hard to maintain.




> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 09:45:40 2006
Return-Path: 
 <hadoop-dev-return-1472-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1588 invoked from network); 17 May 2006 09:45:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 09:45:40 -0000
Received: (qmail 67566 invoked by uid 500); 17 May 2006 09:45:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67544 invoked by uid 500); 17 May 2006 09:45:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67535 invoked by uid 99); 17 May 2006 09:45:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 02:45:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 02:45:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 045AF41000E
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 09:45:07 +0000 (GMT)
Message-ID: <29395251.1147859107015.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 09:45:07 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-124) don't permit two datanodes to run from
 same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]

Konstantin Shvachko updated HADOOP-124:
---------------------------------------

    Attachment: DirNotSharing.patch

This is the patch that fixes the problem.
DFS_CURRENT_VERSION has been changed to -2,
since internal file layouts have changed.

I created a new package for exceptions.


> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, DirNotSharing.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 16:55:37 2006
Return-Path: 
 <hadoop-dev-return-1473-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76355 invoked from network); 17 May 2006 16:55:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 16:55:37 -0000
Received: (qmail 68099 invoked by uid 500); 17 May 2006 16:55:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68018 invoked by uid 500); 17 May 2006 16:55:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68009 invoked by uid 99); 17 May 2006 16:55:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 09:55:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 09:55:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 32187410005
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 16:55:06 +0000 (GMT)
Message-ID: <19349005.1147884906175.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 16:55:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12412212 ] 

Owen O'Malley commented on HADOOP-211:
--------------------------------------

A lot of exceptions are currently being logged at the *info* level and most of them should probably be at the *warn* level. Especially, once we log the level it would be good to find the exceptions by grepping for WARN.

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 17:07:37 2006
Return-Path: 
 <hadoop-dev-return-1474-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91314 invoked from network); 17 May 2006 17:07:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 17:07:37 -0000
Received: (qmail 97087 invoked by uid 500); 17 May 2006 17:07:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97071 invoked by uid 500); 17 May 2006 17:07:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97062 invoked by uid 99); 17 May 2006 17:07:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:07:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:07:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3460B410005
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 17:07:06 +0000 (GMT)
Message-ID: <26659155.1147885626184.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 17:07:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12412213 ] 

Doug Cutting commented on HADOOP-211:
-------------------------------------

The semantics I use for levels is something like:

SEVERE: if this is a production system, someone should be paged, red lights should flash, etc.  Something is definitely wrong and the system is not operating correctly.  Intervention is required.  This should be used sparingly.

WARN: in a production system, warnings should be propagated & summarized on a central console.  If lots are generated then something may be wrong.

INFO, FINE, FINER, etc. are used for debugging.  INFO is the level normally logged in production, FINE, FINER, etc. are typically only used when developing.

Is that consistent with the way others use these?


> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 17:39:37 2006
Return-Path: 
 <hadoop-dev-return-1475-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7279 invoked from network); 17 May 2006 17:39:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 17:39:37 -0000
Received: (qmail 49174 invoked by uid 500); 17 May 2006 17:39:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49046 invoked by uid 500); 17 May 2006 17:39:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49031 invoked by uid 99); 17 May 2006 17:39:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:39:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:39:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2EC1F71429B
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 17:39:06 +0000 (GMT)
Message-ID: <3245163.1147887546173.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 17:39:06 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12412220 ] 

Milind Bhandarkar commented on HADOOP-211:
------------------------------------------

At least one place where level should be info and not warn is when we create a file on dfs. It tries to do mkdirs whether directory exists or not. If it already exists, it warns that there is an error creating the directory. I think the warning should be when the directory could not be created because of other factors (such as permissions), otherwise it should be info or even fine.

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 17:43:43 2006
Return-Path: 
 <hadoop-dev-return-1476-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10793 invoked from network); 17 May 2006 17:43:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 17:43:43 -0000
Received: (qmail 59057 invoked by uid 500); 17 May 2006 17:43:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58978 invoked by uid 500); 17 May 2006 17:43:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58961 invoked by uid 99); 17 May 2006 17:43:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:43:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:43:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 93DBC410005
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 17:43:06 +0000 (GMT)
Message-ID: <17556086.1147887786603.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 17:43:06 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12412222 ] 

Milind Bhandarkar commented on HADOOP-224:
------------------------------------------

Runping,

What I proposed is not a general versioning support for writables. It is only for namenode and datanode metadata, where formats may change more rapidly than a general object. Also, other communication within the system mostly happens at peers that have the same version. And therefore backward compatibility all the way to the first version is not an issue there. Whereas in the case of metadata, which is persistent across version upgrades, backward compatibility is a major issue. It is also linked with binary file-formats, and thus I suggest that we should not use struct-slurping to read from metadata.


> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 17:50:37 2006
Return-Path: 
 <hadoop-dev-return-1477-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12664 invoked from network); 17 May 2006 17:50:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 17:50:37 -0000
Received: (qmail 73489 invoked by uid 500); 17 May 2006 17:50:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73362 invoked by uid 500); 17 May 2006 17:50:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73353 invoked by uid 99); 17 May 2006 17:50:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:50:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:50:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9FF9A71429B
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 17:50:06 +0000 (GMT)
Message-ID: <2616617.1147888206652.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 17:50:06 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12412224 ] 

Milind Bhandarkar commented on HADOOP-224:
------------------------------------------

Doug,

The pseudocode for FSDirectory.loadFSData would look like:

loadFSData() {
    in = open metadata file;
    INode[] inodes = CurVersionReader.parse(in);
    if inodes == null:
        version not recognized at all.
}

The CurVersionReader would look like:

class CurVersionReader {
    private static class PrevVersionReader = FSReaderV0.class;

    public static Inode[] parse (stream in) {
       v = read version number from in
       if (v is recognized here) {
           inodes = read metadata
       } else {
           return PrevVersionReader.parse(in);
       }
}

When a new version is employed, all that needs to change is reference to CurVersionReader in FSDirectory. All other previous version readers do not change at all.


> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 17:52:36 2006
Return-Path: 
 <hadoop-dev-return-1478-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13228 invoked from network); 17 May 2006 17:52:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 17:52:36 -0000
Received: (qmail 80275 invoked by uid 500); 17 May 2006 17:52:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80258 invoked by uid 500); 17 May 2006 17:52:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80249 invoked by uid 99); 17 May 2006 17:52:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:52:35 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 10:52:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DEDB041000E
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 17:52:05 +0000 (GMT)
Message-ID: <14555788.1147888325909.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 17:52:05 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-225) tasks are left over when a job fails
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

tasks are left over when a job fails
------------------------------------

         Key: HADOOP-225
         URL: http://issues.apache.org/jira/browse/HADOOP-225
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Yoram Arnon
    Priority: Minor


when jobs are stopped or otherwise fail, tasks are often left around.
the job tracker shows that there are map or reduce (mostly reduce) tasks running, when no job is running.
these accumulate over time.
eventually there are so many of those, that the job tracker can't launch new tasks, requiring a restart of the MR cluster.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 22:11:37 2006
Return-Path: 
 <hadoop-dev-return-1479-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 735 invoked from network); 17 May 2006 22:11:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 22:11:37 -0000
Received: (qmail 73846 invoked by uid 500); 17 May 2006 22:11:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73821 invoked by uid 500); 17 May 2006 22:11:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73812 invoked by uid 99); 17 May 2006 22:11:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 15:11:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 15:11:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DDE8A7142A7
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 22:11:05 +0000 (GMT)
Message-ID: <24430703.1147903865906.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 22:11:05 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-226) DFSShell problems. Incorrect block
 replication detection in fsck.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DFSShell problems. Incorrect block replication detection in fsck.
-----------------------------------------------------------------

         Key: HADOOP-226
         URL: http://issues.apache.org/jira/browse/HADOOP-226
     Project: Hadoop
        Type: Bug

  Components: dfs  
 Environment: All
    Reporter: Konstantin Shvachko


1. We need to adjust Dfsck to the new per-file replication feature.
fsck checks block replication based on the configured global replication parameter.
Which is now just the default. The actual file replication is returned in DFSFileInfo.
So at least the reporting is screwed by that, although I didn't check what will happen with
other options -move and -delete.

2. fsck throws NullPointerException if you type
bin/hadoop fsck -files /doc
instead of
bin/hadoop fsck /doc -files

3. Unfortunately, there are several commands that throw different kinds of Exceptions
rather than at least printing the usage info, when some of its arguments are missing or
misplaced. ArrayIndexOutOfBoundsException is one them. Try
bin/hadoop dfs -mv
bin/hadoop dfs -cp
bin/hadoop dfs -rm

4. In general the shell is growing and getting more sophisticated.
Should we work out a general convention on how the parameters should be structured, named,
short/long version of the keywords, help, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 22:24:38 2006
Return-Path: 
 <hadoop-dev-return-1480-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3896 invoked from network); 17 May 2006 22:24:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 22:24:38 -0000
Received: (qmail 90445 invoked by uid 500); 17 May 2006 22:24:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90424 invoked by uid 500); 17 May 2006 22:24:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90415 invoked by uid 99); 17 May 2006 22:24:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 15:24:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 15:24:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 20F4D410005
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 22:24:07 +0000 (GMT)
Message-ID: <15866411.1147904647132.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 22:24:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-226) DFSShell problems. Incorrect block
 replication detection in fsck.
In-Reply-To: <24430703.1147903865906.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-226?page=comments#action_12412248 ] 

Doug Cutting commented on HADOOP-226:
-------------------------------------

This sounds like more than one bug.  (1) should be a separate bug.  (2) and (3) are minor: the error message is simply not very informative.  (4) calls for use of something like http://jakarta.apache.org/commons/cli/.  And 2-4 are somewhat related to HADOOP-59.

> DFSShell problems. Incorrect block replication detection in fsck.
> -----------------------------------------------------------------
>
>          Key: HADOOP-226
>          URL: http://issues.apache.org/jira/browse/HADOOP-226
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: All
>     Reporter: Konstantin Shvachko

>
> 1. We need to adjust Dfsck to the new per-file replication feature.
> fsck checks block replication based on the configured global replication parameter.
> Which is now just the default. The actual file replication is returned in DFSFileInfo.
> So at least the reporting is screwed by that, although I didn't check what will happen with
> other options -move and -delete.
> 2. fsck throws NullPointerException if you type
> bin/hadoop fsck -files /doc
> instead of
> bin/hadoop fsck /doc -files
> 3. Unfortunately, there are several commands that throw different kinds of Exceptions
> rather than at least printing the usage info, when some of its arguments are missing or
> misplaced. ArrayIndexOutOfBoundsException is one them. Try
> bin/hadoop dfs -mv
> bin/hadoop dfs -cp
> bin/hadoop dfs -rm
> 4. In general the shell is growing and getting more sophisticated.
> Should we work out a general convention on how the parameters should be structured, named,
> short/long version of the keywords, help, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 22:32:37 2006
Return-Path: 
 <hadoop-dev-return-1481-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6723 invoked from network); 17 May 2006 22:32:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 22:32:37 -0000
Received: (qmail 2726 invoked by uid 500); 17 May 2006 22:32:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2601 invoked by uid 500); 17 May 2006 22:32:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2592 invoked by uid 99); 17 May 2006 22:32:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 15:32:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 15:32:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9D75241000E
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 22:32:06 +0000 (GMT)
Message-ID: <3650357.1147905126642.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 22:32:06 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-222?page=comments#action_12412249 ] 

Konstantin Shvachko commented on HADOOP-222:
--------------------------------------------

This is very useful.
Some things that I have noticed.
- Usage info might be useful.
Right now it just throws ArrayIndexOutOfBoundsException if you do not specify the path.
Or some other exception if you forget to provide the replication number. Try
    hadoop dfs -setrep
    hadoop dfs -setrep 3
    hadoop dfs -setrep /user
- I think the 2 commands should be combined into one like
    hadoop dfs -setrep [-R] <path>
- Should we use abbreviations like "setrep" or full names?
see HADOOP-226 (4) about necessity for a general DFSShell convention.

> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>  Attachments: setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 23:03:38 2006
Return-Path: 
 <hadoop-dev-return-1482-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16875 invoked from network); 17 May 2006 23:03:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 23:03:38 -0000
Received: (qmail 33301 invoked by uid 500); 17 May 2006 23:03:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33282 invoked by uid 500); 17 May 2006 23:03:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33273 invoked by uid 99); 17 May 2006 23:03:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 16:03:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 16:03:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 042057142A4
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 23:03:07 +0000 (GMT)
Message-ID: <33426905.1147906987014.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 23:03:07 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12412253 ] 

Doug Cutting commented on HADOOP-24:
------------------------------------

I finally had a chance to look closely at this.  One problem I now see is that it's incompatible: code that previously called 'new Configuration()' has to be updated to instead call 'new ConfigurationImpl()'.  Nutch is a good test-case for back-compatibility, since it uses so much of Hadoop's APIs.  Ideally we can figure out a way to do this so that, e.g., the new Hadoop jar can be dropped into existing Nutch and work correctly.

I think this means that the interface cannot be named 'Configuration'.  Instead we should probably call it ConfigurationInterface, and change ConfigurationImpl to be Configuration.  Does that sound like a good solution?

Thanks for the patch, and thanks for your patience!

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 23:40:37 2006
Return-Path: 
 <hadoop-dev-return-1483-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28443 invoked from network); 17 May 2006 23:40:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 23:40:37 -0000
Received: (qmail 93695 invoked by uid 500); 17 May 2006 23:40:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93677 invoked by uid 500); 17 May 2006 23:40:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93668 invoked by uid 99); 17 May 2006 23:40:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 16:40:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 16:40:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D8CFC41000F
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 23:40:05 +0000 (GMT)
Message-ID: <17890828.1147909205885.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 23:40:05 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-227) Namespace check pointing is not
 performed until the namenode restarts.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Namespace check pointing is not performed until the namenode restarts.
----------------------------------------------------------------------

         Key: HADOOP-227
         URL: http://issues.apache.org/jira/browse/HADOOP-227
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Reporter: Konstantin Shvachko


In current implementation when the name node starts, it reads its image file, then
the edits file, and then saves the updated image back into the image file.
The image file is never updated after that.
In order to provide the system reliability reliability the namespace information should
be check pointed periodically, and the edits file should be kept relatively small.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 23:49:37 2006
Return-Path: 
 <hadoop-dev-return-1484-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30690 invoked from network); 17 May 2006 23:49:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 23:49:37 -0000
Received: (qmail 2074 invoked by uid 500); 17 May 2006 23:49:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2050 invoked by uid 500); 17 May 2006 23:49:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2041 invoked by uid 99); 17 May 2006 23:49:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 16:49:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 16:49:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9BD5F41000F
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 23:49:06 +0000 (GMT)
Message-ID: <23617474.1147909746635.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 23:49:06 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-216) Task Detail web page missing progress
In-Reply-To: <799322.1147467609309.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-216?page=all ]
     
Doug Cutting resolved HADOOP-216:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed
      Assign To: Doug Cutting

I just committed this.  Thanks, Bryan!

> Task Detail web page missing progress
> -------------------------------------
>
>          Key: HADOOP-216
>          URL: http://issues.apache.org/jira/browse/HADOOP-216
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Reporter: Bryan Pendleton
>     Assignee: Doug Cutting
>     Priority: Trivial
>      Fix For: 0.3
>  Attachments: betterprogressdetail.patch.txt
>
> You can see progress on the job view web page, but not the individual task page.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 17 23:49:39 2006
Return-Path: 
 <hadoop-dev-return-1485-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30716 invoked from network); 17 May 2006 23:49:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 May 2006 23:49:39 -0000
Received: (qmail 2219 invoked by uid 500); 17 May 2006 23:49:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2193 invoked by uid 500); 17 May 2006 23:49:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2184 invoked by uid 99); 17 May 2006 23:49:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 16:49:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 16:49:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DFFFE410010
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 23:49:07 +0000 (GMT)
Message-ID: <26316331.1147909747915.JavaMail.jira@brutus>
Date: Wed, 17 May 2006 23:49:07 +0000 (GMT+00:00)
From: "Barry Kaplan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12412263 ] 

Barry Kaplan commented on HADOOP-211:
-------------------------------------

At the very least switching to commons logging will make it easier when configuring hadoop within other applications. Currently this is one of the few libraries I use that I can't configure to use my standard log4j settings.

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 00:12:37 2006
Return-Path: 
 <hadoop-dev-return-1486-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35858 invoked from network); 18 May 2006 00:12:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 00:12:37 -0000
Received: (qmail 26411 invoked by uid 500); 18 May 2006 00:12:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26283 invoked by uid 500); 18 May 2006 00:12:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26274 invoked by uid 99); 18 May 2006 00:12:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 17:12:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 17:12:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EAF30410010
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 00:12:05 +0000 (GMT)
Message-ID: <1170975.1147911125959.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 00:12:05 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-228) hadoop cp should have a -config option
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

hadoop cp should have a -config option
--------------------------------------

         Key: HADOOP-228
         URL: http://issues.apache.org/jira/browse/HADOOP-228
     Project: Hadoop
        Type: Bug

  Components: fs  
    Reporter: Yoram Arnon
 Assigned to: Milind Bhandarkar 
    Priority: Minor


hadoop cp should have a -config option to enable overriding of default parameters.
it  would perhaps be good to rename the command as well to something like dcp or distcp, since it's not a simple command, but rather an entire map-recude job

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 00:24:37 2006
Return-Path: 
 <hadoop-dev-return-1487-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37642 invoked from network); 18 May 2006 00:24:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 00:24:37 -0000
Received: (qmail 30634 invoked by uid 500); 18 May 2006 00:24:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30613 invoked by uid 500); 18 May 2006 00:24:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30604 invoked by uid 99); 18 May 2006 00:24:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 17:24:36 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 17:24:35 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F32DB410011
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 00:24:05 +0000 (GMT)
Message-ID: <2422002.1147911845993.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 00:24:05 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-229) hadoop cp should generate a better
 number of map tasks
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

hadoop cp should generate a better number of map tasks 
-------------------------------------------------------

         Key: HADOOP-229
         URL: http://issues.apache.org/jira/browse/HADOOP-229
     Project: Hadoop
        Type: Bug

  Components: fs  
    Reporter: Yoram Arnon
 Assigned to: Milind Bhandarkar 
    Priority: Minor


hadoop cp currently assigns 10 files to copy per map task.
in case of a small number of large files on a large cluster (say 300 files of 30GB each on a 300 node cluster), this results in long execution times.
better would be to assign files per task such that the entire cluster is utilized: one file per map, with a cap of 10000 maps total, so as not to over burden the job tracker.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 01:39:38 2006
Return-Path: 
 <hadoop-dev-return-1488-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59419 invoked from network); 18 May 2006 01:39:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 01:39:38 -0000
Received: (qmail 96689 invoked by uid 500); 18 May 2006 01:39:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96665 invoked by uid 500); 18 May 2006 01:39:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96656 invoked by uid 99); 18 May 2006 01:39:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 18:39:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 18:39:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 110CC410010
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 01:39:07 +0000 (GMT)
Message-ID: <28088198.1147916347067.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 01:39:07 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12412273 ] 

Konstantin Shvachko commented on HADOOP-124:
--------------------------------------------

For future development in this direction.
We should persistently store on the name node all storage IDs, which the
name node ever assigned any blocks to.
With that knowledge the name node can reject blocks from any newly
registered data storages that are not on the name node list.
In other words when a data node registers NEW data storage it should not
report any blocks from that storage, and the name node can effectively verify 
that since it never assigned any blocks to this storage.
This would prevent us from accidentally connecting data nodes representing
different clusters (DFS instances).


> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, DirNotSharing.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 02:43:38 2006
Return-Path: 
 <hadoop-dev-return-1489-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72710 invoked from network); 18 May 2006 02:43:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 02:43:38 -0000
Received: (qmail 39830 invoked by uid 500); 18 May 2006 02:43:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39702 invoked by uid 500); 18 May 2006 02:43:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39689 invoked by uid 99); 18 May 2006 02:43:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 19:43:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 19:43:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CF164410013
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 02:43:06 +0000 (GMT)
Message-ID: <3314749.1147920186845.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 02:43:06 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-226) DFSShell problems. Incorrect block
 replication detection in fsck.
In-Reply-To: <24430703.1147903865906.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-226?page=comments#action_12412282 ] 

Konstantin Shvachko commented on HADOOP-226:
--------------------------------------------

I like Commons CLI. I think we should use it.
Except that we have sort of just one command, which is hadoop,
with hierarchical options, arguments, and sub-options.
Yes HADOOP-59 has other related issues.
I agree we should combine all of them in one new issue specifically
dedicated to DFSShell.


> DFSShell problems. Incorrect block replication detection in fsck.
> -----------------------------------------------------------------
>
>          Key: HADOOP-226
>          URL: http://issues.apache.org/jira/browse/HADOOP-226
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: All
>     Reporter: Konstantin Shvachko

>
> 1. We need to adjust Dfsck to the new per-file replication feature.
> fsck checks block replication based on the configured global replication parameter.
> Which is now just the default. The actual file replication is returned in DFSFileInfo.
> So at least the reporting is screwed by that, although I didn't check what will happen with
> other options -move and -delete.
> 2. fsck throws NullPointerException if you type
> bin/hadoop fsck -files /doc
> instead of
> bin/hadoop fsck /doc -files
> 3. Unfortunately, there are several commands that throw different kinds of Exceptions
> rather than at least printing the usage info, when some of its arguments are missing or
> misplaced. ArrayIndexOutOfBoundsException is one them. Try
> bin/hadoop dfs -mv
> bin/hadoop dfs -cp
> bin/hadoop dfs -rm
> 4. In general the shell is growing and getting more sophisticated.
> Should we work out a general convention on how the parameters should be structured, named,
> short/long version of the keywords, help, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 02:57:53 2006
Return-Path: 
 <hadoop-dev-return-1490-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78642 invoked from network); 18 May 2006 02:57:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 02:57:53 -0000
Received: (qmail 51546 invoked by uid 500); 18 May 2006 02:57:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51512 invoked by uid 500); 18 May 2006 02:57:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51503 invoked by uid 99); 18 May 2006 02:57:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 19:57:53 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 19:57:52 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4I2uXGT057621
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 19:56:33 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=pEJ0SvF8WeFroYTDRLP2JqFuqHFX5Vtf7vMIW08BF/SQb34gSmO6VOiVBKLIME8o
Received: from [10.0.1.2] ([172.21.179.129]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 17 May 2006 19:56:32 -0700
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <26659155.1147885626184.JavaMail.jira@brutus>
References: <26659155.1147885626184.JavaMail.jira@brutus>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <CCC144A4-C103-4383-8D19-904084FD7034@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
Date: Wed, 17 May 2006 19:56:33 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-OriginalArrivalTime: 18 May 2006 02:56:32.0599 (UTC)
 FILETIME=[AB2F5670:01C67A26]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Once we settle on something, let's post it on the twiki.

On May 17, 2006, at 10:07 AM, Doug Cutting (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-211? 
> page=comments#action_12412213 ]
>
> Doug Cutting commented on HADOOP-211:
> -------------------------------------
>
> The semantics I use for levels is something like:
>
> SEVERE: if this is a production system, someone should be paged,  
> red lights should flash, etc.  Something is definitely wrong and  
> the system is not operating correctly.  Intervention is required.   
> This should be used sparingly.
>
> WARN: in a production system, warnings should be propagated &  
> summarized on a central console.  If lots are generated then  
> something may be wrong.
>
> INFO, FINE, FINER, etc. are used for debugging.  INFO is the level  
> normally logged in production, FINE, FINER, etc. are typically only  
> used when developing.
>
> Is that consistent with the way others use these?
>
>
>> logging improvements for Hadoop
>> -------------------------------
>>
>>          Key: HADOOP-211
>>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>>      Project: Hadoop
>>         Type: Improvement
>
>>     Versions: 0.2
>>     Reporter: Sameer Paranjpye
>>     Assignee: Sameer Paranjpye
>>     Priority: Minor
>>      Fix For: 0.3
>
>>
>> Here's a proposal for some impovements to the way Hadoop does  
>> logging. It advocates 3
>> broad changes to the way logging is currently done, these being:
>> - The use of a uniform logging format by all Hadoop subsystems
>> - The use of Apache commons logging as a facade above an  
>> underlying logging framework
>> - The use of Log4J as the underlying logging framework instead of  
>> java.util.logging
>> This is largely polishing work, but it seems like it would make  
>> log analysis and debugging
>> easier in the short term. In the long term, it would future proof  
>> logging to the extent of
>> allowing the logging framework used to change while requiring  
>> minimal code change. The
>> propos changes are motivated by the following requirements which  
>> we think Hadoops
>> logging should meet:
>> - Hadoops logs should be amenable to analysis by tools like grep,  
>> sed, awk etc.
>> - Log entries should be clearly annotated with a timestamp and a  
>> logging level
>> - Log entries should be traceable to the subsystem from which they  
>> originated
>> - The logging implementation should allow log entries to be  
>> annotated with source code
>> location information like classname, methodname, file and line  
>> number, without requiring
>> code changes
>> - It should be possible to change the logging implementation used  
>> without having to change
>> thousands of lines of code
>> - The mapping of loggers to destinations (files, directories,  
>> servers etc.) should be
>> specified and modifiable via configuration
>> Uniform logging format:
>> All Hadoop logs should have the following structure.
>> <Header>\n
>> <LogEntry>\n [<Exception>\n]
>> .
>> .
>> .
>> where the header line specifies the format of each log entry. The  
>> header line has the format:
>> '# <Fieldname> <Fieldname>...\n'.
>> The default format of each log entry is: '# Timestamp Level  
>> LoggerName Message', where:
>> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
>> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
>> - LoggerName is the short name of the logging subsystem from which  
>> the message originated e.g.
>> fs.FSNamesystem, dfs.Datanode etc.
>> - Message is the log message produced
>> Why Apache commons logging and Log4J?
>> Apache commons logging is a facade meant to be used as a wrapper  
>> around an underlying logging
>> implementation. Bridges from Apache commons logging to popular  
>> logging implementations
>> (Java logging, Log4J, Avalon etc.) are implemented and available  
>> as part of the commons logging
>> distribution. Implementing a bridge to an unsupported  
>> implementation is fairly striaghtforward
>> and involves the implementation of subclasses of the commons  
>> logging LogFactory and Logger
>> classes. Using Apache commons logging and making all logging calls  
>> through it enables us to
>> move to a different logging implementation by simply changing  
>> configuration in the best case.
>> Even otherwise, it incurs minimal code churn overhead.
>> Log4J offers a few benefits over java.util.logging that make it a  
>> more desirable choice for the
>> logging back end.
>> - Configuration Flexibility: The mapping of loggers to  
>> destinations (files, sockets etc.)
>> can be completely specified in configuration. It is possible to do  
>> this with Java logging as
>> well, however, configuration is a lot more restrictive. For  
>> instance, with Java logging all
>> log files must have names derived from the same pattern. For the  
>> namenode, log files could
>> be named with the pattern "%h/namenode%u.log" which would put log  
>> files in the user.home
>> directory with names like namenode0.log etc. With Log4J it would  
>> be possible to configure
>> the namenode to emit log files with different names, say  
>> heartbeats.log, namespace.log,
>> clients.log etc. Configuration variables in Log4J can also have  
>> the values of system
>> properties embedded in them.
>> - Takes wrappers into account: Log4J takes into account the  
>> possibility that an application
>> may be invoking it via a wrapper, such as Apache commons logging.  
>> This is important because
>> logging event objects must be able to infer the context of the  
>> logging call such as classname,
>> methodname etc. Inferring context is a relatively expensive  
>> operation that involves creating
>> an exception and examining the stack trace to find the frame just  
>> before the first frame
>> of the logging framework. It is therefore done lazily only when  
>> this information actually
>> needs to be logged. Log4J can be instructed to look for the frame  
>> corresponding to the wrapper
>> class, Java logging cannot. In the case of Java logging this means  
>> that a) the bridge from
>> Apache commons logging is responsible for inferring the calling  
>> context and setting it in the
>> logging event and b) this inference has to be done on every  
>> logging call regardless of whether
>> or not it is needed.
>> - More handy features: Log4J has some handy features that Java  
>> logging doesn't. A couple
>> of examples of these:
>> a) Date based rolling of log files
>> b) Format control through configuration. Log4J has a PatternLayout  
>> class that can be
>> configured to generate logs with a user specified pattern. The  
>> logging format described
>> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m".  
>> The format specifiers
>> indicate that each log line should have the date and time followed  
>> by the logger name followed
>> by the logging level or priority followed by the application  
>> generated message.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Thu May 18 02:59:38 2006
Return-Path: 
 <hadoop-dev-return-1491-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78828 invoked from network); 18 May 2006 02:59:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 02:59:38 -0000
Received: (qmail 52061 invoked by uid 500); 18 May 2006 02:59:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52039 invoked by uid 500); 18 May 2006 02:59:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52030 invoked by uid 99); 18 May 2006 02:59:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 19:59:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 19:59:36 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 994A57142A1
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 02:59:06 +0000 (GMT)
Message-ID: <9744128.1147921146625.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 02:59:06 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12412284 ] 

eric baldeschwieler commented on HADOOP-211:
--------------------------------------------

True, user errors that cause no harm don't deserve warnings in a central log.  The trick is to propogate the issue back to the user...

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3

>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 03:12:38 2006
Return-Path: 
 <hadoop-dev-return-1492-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81542 invoked from network); 18 May 2006 03:12:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 03:12:38 -0000
Received: (qmail 57026 invoked by uid 500); 18 May 2006 03:12:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57002 invoked by uid 500); 18 May 2006 03:12:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56992 invoked by uid 99); 18 May 2006 03:12:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 20:12:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 20:12:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 23CA241000F
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 03:12:07 +0000 (GMT)
Message-ID: <1668392.1147921927144.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 03:12:07 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12412285 ] 

Konstantin Shvachko commented on HADOOP-24:
-------------------------------------------

I think that all declarations and parameters should say Configuration that is the interface.
And the constructors should be the only places where ConfigurationImpl
appears explicitly. E.g. all occurrences
      private static ConfigurationImpl conf = new ConfigurationImpl();
should be replaced by
      private static Configuration conf = new ConfigurationImpl();
I haven't seen a lot of nutch code, but if it uses only the API, then
that should work. If it does construct config instances then there should be
a static newInstance() somewhere I guess.


> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 03:23:00 2006
Return-Path: 
 <hadoop-dev-return-1493-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83922 invoked from network); 18 May 2006 03:23:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 03:23:00 -0000
Received: (qmail 68443 invoked by uid 500); 18 May 2006 03:23:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68424 invoked by uid 500); 18 May 2006 03:22:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68415 invoked by uid 99); 18 May 2006 03:22:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 20:22:59 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 17 May 2006 20:22:58 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4I3LvKR098074
	for <hadoop-dev@lucene.apache.org>; Wed, 17 May 2006 20:21:57 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=zKPu/ALWFfw05ye8VeHHjlWXnzQ7MVBQ4z9w34L8A8Drj2jF5V/1wf6BOY9PiRJS
Received: from [10.0.1.2] ([172.21.179.129]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 17 May 2006 20:21:56 -0700
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <28088198.1147916347067.JavaMail.jira@brutus>
References: <28088198.1147916347067.JavaMail.jira@brutus>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <009A0B50-6042-46DE-B362-24CE96231417@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
Date: Wed, 17 May 2006 20:21:57 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-OriginalArrivalTime: 18 May 2006 03:21:57.0026 (UTC)
 FILETIME=[37D07020:01C67A2A]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

why not store the cluster in the data node?

On May 17, 2006, at 6:39 PM, Konstantin Shvachko (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-124? 
> page=comments#action_12412273 ]
>
> Konstantin Shvachko commented on HADOOP-124:
> --------------------------------------------
>
> For future development in this direction.
> We should persistently store on the name node all storage IDs,  
> which the
> name node ever assigned any blocks to.
> With that knowledge the name node can reject blocks from any newly
> registered data storages that are not on the name node list.
> In other words when a data node registers NEW data storage it  
> should not
> report any blocks from that storage, and the name node can  
> effectively verify
> that since it never assigned any blocks to this storage.
> This would prevent us from accidentally connecting data nodes  
> representing
> different clusters (DFS instances).
>
>
>> don't permit two datanodes to run from same dfs.data.dir
>> --------------------------------------------------------
>>
>>          Key: HADOOP-124
>>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>>      Project: Hadoop
>>         Type: Bug
>
>>   Components: dfs
>>     Versions: 0.2
>>  Environment: ~30 node cluster
>>     Reporter: Bryan Pendleton
>>     Assignee: Konstantin Shvachko
>>     Priority: Critical
>>      Fix For: 0.3
>>  Attachments: DatanodeRegister.txt, DirNotSharing.patch
>>
>> DFS files are still rotting.
>> I suspect that there's a problem with block accounting/detecting  
>> identical hosts in the namenode. I have 30 physical nodes, with  
>> various numbers of local disks, meaning that my current 'bin/ 
>> hadoop dfs -report" shows 80 nodes after a full restart. However,  
>> when I discovered the  problem (which resulted in losing about  
>> 500gb worth of temporary data because of missing blocks in some of  
>> the larger chunks) -report showed 96 nodes. I suspect somehow  
>> there were extra datanodes running against the same paths, and  
>> that the namenode was counting those as replicated instances,  
>> which then showed up over-replicated, and one of them was told to  
>> delete its local block, leading to the block actually getting lost.
>> I will debug it more the next time the situation arises. This is  
>> at least the 5th time I've had a large amount of file data "rot"  
>> in DFS since January.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Thu May 18 09:39:38 2006
Return-Path: 
 <hadoop-dev-return-1494-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9118 invoked from network); 18 May 2006 09:39:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 09:39:38 -0000
Received: (qmail 96416 invoked by uid 500); 18 May 2006 09:39:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96394 invoked by uid 500); 18 May 2006 09:39:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96385 invoked by uid 99); 18 May 2006 09:39:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 02:39:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 02:39:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 980DD7142B7
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 09:39:06 +0000 (GMT)
Message-ID: <2326815.1147945146620.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 09:39:06 +0000 (GMT+00:00)
From: "Johan Oskarson (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-222?page=comments#action_12412317 ] 

Johan Oskarson commented on HADOOP-222:
---------------------------------------

Yeah, I know  there are issues like that, this is mostly a quick hack I needed to set the replication in order to save space.

My question is, should I fix them or should I wait for a complete DFSShell rehaul with Commons CLI?
I currently do not have time to rewrite the DFSShell myself, but perhaps if there's been no attempt made in a few weeks I might give it a try.

You're absolutely right that they should be combined into one, also related to the whole issue with proper command line parsing etc.
Same thing with -ls and -lsr I suppose.

Thanks for the comments.

> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>  Attachments: setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 10:32:38 2006
Return-Path: 
 <hadoop-dev-return-1495-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24003 invoked from network); 18 May 2006 10:32:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 10:32:38 -0000
Received: (qmail 73701 invoked by uid 500); 18 May 2006 10:32:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73683 invoked by uid 500); 18 May 2006 10:32:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73674 invoked by uid 99); 18 May 2006 10:32:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 03:32:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 03:32:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 98BFC7142B7
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 10:32:06 +0000 (GMT)
Message-ID: <15152325.1147948326623.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 10:32:06 +0000 (GMT+00:00)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-222?page=comments#action_12412326 ] 

Andrzej Bialecki  commented on HADOOP-222:
------------------------------------------

Other things that I would love to see added to DFSShell (to make it more shell-like). They are not such a big deal to implement, but they would increase the usefulness of this class tremendously (note: this is orthogonal to the issue of using Commons CLI, which I'd love to see too):

* globbing and multi-argument cp/mv/rm/ls, using the standard shell metacharacters

* interactive mode: ability to issue several commands in the same session, while keeping track of the context (such as pwd)

* scripts: nothing fancy, just the ability to execute several commands recorded in a text file.

The scriptability and interactive mode, and a host of other useful features we can throw in cheaply by using Rhino (http://www.mozilla.org/rhino/shell.html).

> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>  Attachments: setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 15:57:40 2006
Return-Path: 
 <hadoop-dev-return-1496-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58742 invoked from network); 18 May 2006 15:57:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 15:57:40 -0000
Received: (qmail 63379 invoked by uid 500); 18 May 2006 15:57:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63245 invoked by uid 500); 18 May 2006 15:57:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63058 invoked by uid 99); 18 May 2006 15:57:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 08:57:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 08:57:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5A1AF7142A7
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 15:57:06 +0000 (GMT)
Message-ID: <13592705.1147967826365.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 15:57:06 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-230) improve syntax of the hadoop dfs
 command
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

improve syntax of the hadoop dfs command 
-----------------------------------------

         Key: HADOOP-230
         URL: http://issues.apache.org/jira/browse/HADOOP-230
     Project: Hadoop
        Type: Improvement

    Reporter: Yoram Arnon
    Priority: Minor


the hadoop dfs syntax (hadoop dfs -option value -cmd arg) is clunky: options must appear before the command, the command looks like just another option.
I propose a more standard syntax:
1. the command (ls, mv, du etc.) always comes first
2. no '-' for the command
3. options may appear anywhere, including between the command and its arguments

allowed syntax would be:
hadoop dfs ls -dfs <dfs> /path
hadoop dfs job [-status] job_0002 -jt <jt>
etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 16:03:39 2006
Return-Path: 
 <hadoop-dev-return-1497-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60474 invoked from network); 18 May 2006 16:03:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 16:03:39 -0000
Received: (qmail 78564 invoked by uid 500); 18 May 2006 16:03:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78548 invoked by uid 500); 18 May 2006 16:03:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78539 invoked by uid 99); 18 May 2006 16:03:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 09:03:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 09:03:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3CEA77142A4
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 16:03:07 +0000 (GMT)
Message-ID: <14779185.1147968187246.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 16:03:07 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-24?page=all ]

Gal Nitzan updated HADOOP-24:
-----------------------------

    Attachment: HADOOP-24-4.patch

forgot to set abstract for getConfResource... in ConfigurationBase

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24-4.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 16:15:39 2006
Return-Path: 
 <hadoop-dev-return-1498-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65426 invoked from network); 18 May 2006 16:15:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 16:15:39 -0000
Received: (qmail 5445 invoked by uid 500); 18 May 2006 16:15:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5314 invoked by uid 500); 18 May 2006 16:15:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5304 invoked by uid 99); 18 May 2006 16:15:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 09:15:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 09:15:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 54F837142A1
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 16:15:07 +0000 (GMT)
Message-ID: <15601161.1147968907345.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 16:15:07 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-230) improve syntax of the hadoop dfs
 command
In-Reply-To: <13592705.1147967826365.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-230?page=all ]

Yoram Arnon updated HADOOP-230:
-------------------------------

    Description: 
the hadoop dfs syntax (hadoop dfs -option value -cmd arg) is clunky: options must appear before the command, the command looks like just another option.
I propose a more standard syntax:
1. the command (ls, mv, du etc.) always comes first
2. no '-' for the command
3. options may appear anywhere, including between the command and its arguments

allowed syntax would be:
hadoop dfs ls -dfs <dfs> /path
hadoop dfs ls /path -dfs <dfs>

other commands may benefit from a similar syntax change:
hadoop job [-status] job_0002 -jt <jt>
etc.

  was:
the hadoop dfs syntax (hadoop dfs -option value -cmd arg) is clunky: options must appear before the command, the command looks like just another option.
I propose a more standard syntax:
1. the command (ls, mv, du etc.) always comes first
2. no '-' for the command
3. options may appear anywhere, including between the command and its arguments

allowed syntax would be:
hadoop dfs ls -dfs <dfs> /path
hadoop dfs job [-status] job_0002 -jt <jt>
etc.


> improve syntax of the hadoop dfs command
> ----------------------------------------
>
>          Key: HADOOP-230
>          URL: http://issues.apache.org/jira/browse/HADOOP-230
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Yoram Arnon
>     Priority: Minor

>
> the hadoop dfs syntax (hadoop dfs -option value -cmd arg) is clunky: options must appear before the command, the command looks like just another option.
> I propose a more standard syntax:
> 1. the command (ls, mv, du etc.) always comes first
> 2. no '-' for the command
> 3. options may appear anywhere, including between the command and its arguments
> allowed syntax would be:
> hadoop dfs ls -dfs <dfs> /path
> hadoop dfs ls /path -dfs <dfs>
> other commands may benefit from a similar syntax change:
> hadoop job [-status] job_0002 -jt <jt>
> etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 16:23:39 2006
Return-Path: 
 <hadoop-dev-return-1499-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67720 invoked from network); 18 May 2006 16:23:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 16:23:39 -0000
Received: (qmail 22251 invoked by uid 500); 18 May 2006 16:23:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22115 invoked by uid 500); 18 May 2006 16:23:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22106 invoked by uid 99); 18 May 2006 16:23:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 09:23:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 09:23:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1905E410005
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 16:23:07 +0000 (GMT)
Message-ID: <10577375.1147969387099.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 16:23:07 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12412376 ] 

Gal Nitzan commented on HADOOP-24:
----------------------------------

Hi,

In regards to the code compatibility - For Hadoop all new code is already included (tests also) is in this patch.

For Nutch I already have the patch ready and it is not that big a change since most code uses Configuration (so the actual change is only in construction) so ConfigurationImpl has a copy constructor that accepts a Configuration. I actualy tested it also. I can submit it here as well if we decide to use this patch.

I'm not sure it would be a good idea to change the current design/implementation just for the sake of compatibility. I think the design(Doug's) and the implementation are clean and shall be more understandable to implementers/extenders.



> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24-4.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 19:44:38 2006
Return-Path: 
 <hadoop-dev-return-1500-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47293 invoked from network); 18 May 2006 19:44:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 19:44:38 -0000
Received: (qmail 43193 invoked by uid 500); 18 May 2006 19:44:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43065 invoked by uid 500); 18 May 2006 19:44:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43056 invoked by uid 99); 18 May 2006 19:44:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 12:44:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 12:44:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DF3FA71429F
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 19:44:05 +0000 (GMT)
Message-ID: <19513987.1147981445911.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 19:44:05 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-231) DFSShell Improvement wish list
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DFSShell Improvement wish list
------------------------------

         Key: HADOOP-231
         URL: http://issues.apache.org/jira/browse/HADOOP-231
     Project: Hadoop
        Type: Improvement

  Components: mapred, dfs, util  
    Reporter: Konstantin Shvachko


This is to discuss general DFSShell improvements, standardization, conventions, etc.
Here are links to assorted ideas on this issue from previous issues.
We need to generalize them at some point.

HADOOP-59
HADOOP-226
HADOOP-222#action_12412326
HADOOP-230


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 19:48:41 2006
Return-Path: 
 <hadoop-dev-return-1501-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48307 invoked from network); 18 May 2006 19:48:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 19:48:41 -0000
Received: (qmail 47110 invoked by uid 500); 18 May 2006 19:48:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47076 invoked by uid 500); 18 May 2006 19:48:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46977 invoked by uid 99); 18 May 2006 19:48:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 12:48:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 12:48:39 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2C1AE71429F
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 19:48:08 +0000 (GMT)
Message-ID: <29401757.1147981688177.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 19:48:08 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-222?page=comments#action_12412407 ] 

Konstantin Shvachko commented on HADOOP-222:
--------------------------------------------

Johan, I would vote for your patch if you fix it.


> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>  Attachments: setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 20:52:39 2006
Return-Path: 
 <hadoop-dev-return-1502-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62942 invoked from network); 18 May 2006 20:52:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 20:52:39 -0000
Received: (qmail 55166 invoked by uid 500); 18 May 2006 20:52:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55131 invoked by uid 500); 18 May 2006 20:52:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55122 invoked by uid 99); 18 May 2006 20:52:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 13:52:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 13:52:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CE6C47142A1
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 20:52:06 +0000 (GMT)
Message-ID: <20630286.1147985526842.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 20:52:06 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-220) Add -dfs and -jt command-line
 parameters to specify namenode and jobtracker.
In-Reply-To: <19210133.1147731605899.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-220?page=all ]

Milind Bhandarkar updated HADOOP-220:
-------------------------------------

    Attachment: hadoop-220-228-229.patch

Please disregard earlier patch. I am attaching another patch here that fixes hadoop-220, hadoop-228, and hadoop-229.


> Add -dfs and -jt command-line parameters to specify namenode and jobtracker.
> ----------------------------------------------------------------------------
>
>          Key: HADOOP-220
>          URL: http://issues.apache.org/jira/browse/HADOOP-220
>      Project: Hadoop
>         Type: Sub-task

>   Components: fs
>  Environment: All
>     Reporter: Milind Bhandarkar
>  Attachments: hadoop-220-228-229.patch, hadoop-220.patch
>
> Most hadoop commands accept -df and -jt commandline parameters. Make the cp command to accept those as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 20:54:39 2006
Return-Path: 
 <hadoop-dev-return-1503-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63818 invoked from network); 18 May 2006 20:54:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 20:54:39 -0000
Received: (qmail 61211 invoked by uid 500); 18 May 2006 20:54:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61190 invoked by uid 500); 18 May 2006 20:54:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61181 invoked by uid 99); 18 May 2006 20:54:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 13:54:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 13:54:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2540F7142BE
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 20:54:07 +0000 (GMT)
Message-ID: <2704104.1147985647149.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 20:54:07 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-228) hadoop cp should have a -config
 option
In-Reply-To: <1170975.1147911125959.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-228?page=comments#action_12412418 ] 

Milind Bhandarkar commented on HADOOP-228:
------------------------------------------

Added -config option.
Changed command name from "cp" to "distcp".
Part of patch attached to hadoop-220.

> hadoop cp should have a -config option
> --------------------------------------
>
>          Key: HADOOP-228
>          URL: http://issues.apache.org/jira/browse/HADOOP-228
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor

>
> hadoop cp should have a -config option to enable overriding of default parameters.
> it  would perhaps be good to rename the command as well to something like dcp or distcp, since it's not a simple command, but rather an entire map-recude job

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 20:58:39 2006
Return-Path: 
 <hadoop-dev-return-1504-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64668 invoked from network); 18 May 2006 20:58:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 20:58:39 -0000
Received: (qmail 70241 invoked by uid 500); 18 May 2006 20:58:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70113 invoked by uid 500); 18 May 2006 20:58:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70104 invoked by uid 99); 18 May 2006 20:58:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 13:58:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 13:58:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0E2CA7142A1
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 20:58:07 +0000 (GMT)
Message-ID: <7621142.1147985887055.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 20:58:07 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-229) hadoop cp should generate a better
 number of map tasks
In-Reply-To: <2422002.1147911845993.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-229?page=comments#action_12412420 ] 

Milind Bhandarkar commented on HADOOP-229:
------------------------------------------

Number of maps is now computed as follows:

numMaps = max(1, min(numFiles,  numNodes*10, totalBytes/256MB, 10000)).

Plus added reporting status for every file (or every 32MB - approx 10 seconds) so that tasks dont timeout while copying huge files.

This fix is part of the patch attached to hadoop-220.

> hadoop cp should generate a better number of map tasks
> ------------------------------------------------------
>
>          Key: HADOOP-229
>          URL: http://issues.apache.org/jira/browse/HADOOP-229
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor

>
> hadoop cp currently assigns 10 files to copy per map task.
> in case of a small number of large files on a large cluster (say 300 files of 30GB each on a 300 node cluster), this results in long execution times.
> better would be to assign files per task such that the entire cluster is utilized: one file per map, with a cap of 10000 maps total, so as not to over burden the job tracker.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 21:55:28 2006
Return-Path: 
 <hadoop-dev-return-1505-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79179 invoked from network); 18 May 2006 21:55:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 21:55:28 -0000
Received: (qmail 44740 invoked by uid 500); 18 May 2006 21:55:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44723 invoked by uid 500); 18 May 2006 21:55:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44714 invoked by uid 99); 18 May 2006 21:55:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 14:55:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 14:55:26 -0700
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k4ILtLQ23323
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 16:55:21 -0500
Message-ID: <446CECC9.6070801@getopt.org>
Date: Thu, 18 May 2006 23:53:13 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Unable to run more than one job concurrently
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi all,

I'm running Hadoop on a relatively small cluster (5 nodes) with growing 
datasets.

I noticed that if I start a job that is configured to run more map tasks 
than is the cluster capacity (mapred.tasktracker.tasks.maximum * number 
of nodes, 20 in this case), of course only that many map tasks will run, 
and when they are finished the next map tasks from that job will be 
scheduled.

However, when I try to start another job in parallel, only its reduce 
tasks will be scheduled (uselessly spin-waiting for map output, and only 
reducing the number of available tasks in the cluster...), and no map 
tasks from this job will be scheduled - until the first job completes. 
This feels wrong - not only I'm not making progress on the second job, 
but I'm also taking the slots away from the first job!

I'm somewhat miffed about this - I'd think that jobtracker should split 
the available resources evenly between these two jobs, i.e. it should 
schedule some map tasks from the first job and some from the second one. 
This is not what is happening, though ...

Is this a configuration error, a bug, or a feature? :)

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Thu May 18 22:18:38 2006
Return-Path: 
 <hadoop-dev-return-1506-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85233 invoked from network); 18 May 2006 22:18:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 22:18:38 -0000
Received: (qmail 74862 invoked by uid 500); 18 May 2006 22:18:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74736 invoked by uid 500); 18 May 2006 22:18:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74727 invoked by uid 99); 18 May 2006 22:18:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 15:18:37 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 15:18:37 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E5C9B7142BC
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 22:18:05 +0000 (GMT)
Message-ID: <25736722.1147990685938.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 22:18:05 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-232) jar files sent to task tracker should
 override existing jar
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

jar files sent to task tracker should override existing jar
-----------------------------------------------------------

         Key: HADOOP-232
         URL: http://issues.apache.org/jira/browse/HADOOP-232
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Yoram Arnon
 Assigned to: Milind Bhandarkar 
    Priority: Minor


jar files sent to task tracker are appended to list, rather than prepended to it.
this results in the original jar getting executed, although a new one was sent  - not the intent.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 18 23:18:40 2006
Return-Path: 
 <hadoop-dev-return-1507-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99824 invoked from network); 18 May 2006 23:18:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 May 2006 23:18:40 -0000
Received: (qmail 60221 invoked by uid 500); 18 May 2006 23:18:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60200 invoked by uid 500); 18 May 2006 23:18:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60191 invoked by uid 99); 18 May 2006 23:18:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 16:18:39 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 16:18:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 20AF57141EA
	for <hadoop-dev@lucene.apache.org>; Thu, 18 May 2006 23:18:07 +0000 (GMT)
Message-ID: <13213186.1147994287131.JavaMail.jira@brutus>
Date: Thu, 18 May 2006 23:18:07 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12412444 ] 

Konstantin Shvachko commented on HADOOP-124:
--------------------------------------------

Eric Baldeschwieler wrote:
> why not store the cluster in the data node?

We can alternatively store namespaceID in every data storage belonging to the cluster.
May be this is conceptually cleaner. I preferred storing storageIDs in the meta data just 
because this gives the name node knowledge of which storages are missing, and lets it 
report it.

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, DirNotSharing.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 00:06:43 2006
Return-Path: 
 <hadoop-dev-return-1508-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15012 invoked from network); 19 May 2006 00:06:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 00:06:43 -0000
Received: (qmail 38252 invoked by uid 500); 19 May 2006 00:06:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38147 invoked by uid 500); 19 May 2006 00:06:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38030 invoked by uid 99); 19 May 2006 00:06:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 17:06:38 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 17:06:38 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C5E3941000E
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 00:06:06 +0000 (GMT)
Message-ID: <29031689.1147997166807.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 00:06:06 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-233) add a http status server for the task
 trackers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

add a http status server for the task trackers
----------------------------------------------

         Key: HADOOP-233
         URL: http://issues.apache.org/jira/browse/HADOOP-233
     Project: Hadoop
        Type: New Feature

  Components: mapred  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3


I'd like to have:
  1. a jetty server on each task tracker to serve up logs and status
  2. the jetty server on the job tracker serve up logs

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 00:10:49 2006
Return-Path: 
 <hadoop-dev-return-1509-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16105 invoked from network); 19 May 2006 00:10:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 00:10:49 -0000
Received: (qmail 43300 invoked by uid 500); 19 May 2006 00:10:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43194 invoked by uid 500); 19 May 2006 00:10:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43112 invoked by uid 99); 19 May 2006 00:10:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 17:10:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 18 May 2006 17:10:44 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B7F11410013
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 00:10:12 +0000 (GMT)
Message-ID: <31247315.1147997412750.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 00:10:12 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-233) add a http status server for the task
 trackers
In-Reply-To: <29031689.1147997166807.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-233?page=all ]

Owen O'Malley updated HADOOP-233:
---------------------------------

    Attachment: task-tracker-webapp.patch

This patch generalizes the jetty server and splits it so that the task tracker and job tracker can have different jsp scripts registered. In particular,

In src/webapps:
  index.html -> job/index.html
  mapred/*.jsp -> job/*.jsp
  n/a -> task/
  n/a -> static/

We can put things like hadoop-logo.jpg in static and they will be available in either server under http://<host>:<port>/static/

The logs for each server are available under http://<host>:<port>/logs/

The default ports are:
   job tracker: 50030
   task tracker: 50060



> add a http status server for the task trackers
> ----------------------------------------------
>
>          Key: HADOOP-233
>          URL: http://issues.apache.org/jira/browse/HADOOP-233
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: task-tracker-webapp.patch
>
> I'd like to have:
>   1. a jetty server on each task tracker to serve up logs and status
>   2. the jetty server on the job tracker serve up logs

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 09:30:05 2006
Return-Path: 
 <hadoop-dev-return-1510-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57496 invoked from network); 19 May 2006 09:30:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 09:30:05 -0000
Received: (qmail 19948 invoked by uid 500); 19 May 2006 09:30:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19927 invoked by uid 500); 19 May 2006 09:30:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19918 invoked by uid 99); 19 May 2006 09:30:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 02:30:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 02:30:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3D1D5410011
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 09:29:31 +0000 (GMT)
Message-ID: <6140265.1148030971246.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 09:29:31 +0000 (GMT+00:00)
From: "Sanjay Dahiya (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Support for writing Map/Reduce functions in C++
-----------------------------------------------

         Key: HADOOP-234
         URL: http://issues.apache.org/jira/browse/HADOOP-234
     Project: Hadoop
        Type: New Feature

  Components: mapred  
    Reporter: Sanjay Dahiya


MapReduce C++ support

Requirements 

1. Allow users to write Map and Reduce functions in C++, rest of the 
infrastructure already present in Java should be reused. 
2. Avoid users having to write both Java and C++ for this to work. 
3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
4. Use Record IO for describing record format, both MR java framework and C++ should 
	use the same format to work seemlessly. 
5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
	simple strings. 

Implementation notes

- If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
	mapper and reducer methods in C++. 
- For composite Record IO types user starts with defining a record format using Record IO DDL. 
- User generates Java and C++ classes from the DDL using record IO. 
- Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
- User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
  makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
  generated C++ record IO classes. 
- User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 

Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 

Native(JNI) Java proxy for the Mapper : 
---------------------------------------
Without Record IO :-
--------------------
public class SimpleNativeMapper extends MapReduceBase implements Mapper {

	/**
	  * Works on simple strings. 
	  **/
	public void map(WritableComparable key, Writable value,
			OutputCollector output, Reporter reporter) throws IOException {

		mapNative(key.toString().getBytes()
				, value.toString().getBytes(), output, reporter); 
	}
	
	/**
	  * Native implementation. 
	  **/
	private native void mapNative(byte[] key, byte[] value, 
			OutputCollector output, Reporter reporter) throws IOException;

}


With Record IO :- 
------------------
public class RecordIONativeMapper extends MapReduceBase implements Mapper {

	/**
	 * Implementation of map method, this acts as a JNI proxy for actual map 
	 * method implemented in C++. Works for Record IO based records. 
	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
	 */
	public void map(WritableComparable key, Writable value,
			OutputCollector output, Reporter reporter) throws IOException {
		
		byte[] keyBytes = null ;
		byte[] valueBytes = null ;
		
		try{
			// we need to serialize the key and record and pass the serialized 
			// format to C++ / JNI methods so they can interpret it using appropriate 
			// record IO classes. 
			{
				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
				
				((Record)key).serialize(boa, "WhatIsTag");
				keyBytes = keyStream.toByteArray();
			}
			{
				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
				
				((Record)key).serialize(boa, "WhatIsTag");
				valueBytes = valueStream.toByteArray();
			}
		}catch(ClassCastException e){
			// throw better exceptions
			throw new IOException("Input record must be of Record IO Type"); 
		}
		// pass the serialized byte[] to C++ implementation. 
		mapNative(keyBytes, valueBytes, output, reporter); 
	}

	/**
	 * Implementation in C++.
	 */
	private native void mapNative(byte[] key, byte[] value, 
			OutputCollector output, Reporter reporter) throws IOException;
}

OutputCollector Proxy for C++
------------------------------
public class NativeOutputCollector implements OutputCollector {

	// standard method from interface
	public void collect(WritableComparable key, Writable value)
			throws IOException {
	}
	
	// deserializes key and value and calls collect(WritableComparable, Writable)
	public void collectFromNative(byte[]key, byte[]value){
		// deserialize key and value to java types ( as configured in JobConf )
		// call actual collect method 
	}
}



Core Native functions ( helper for user provided Mapper and Reducer ) 
---------------------------------------------------------------------
#include "org_apache_hadoop_mapred_NativeMapper.h"
#include "UserMapper.h"

/**
	* A C++ proxy method, calls actual implementation of the Mapper. This method 
	signature is generated by javah.
**/
JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
  (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
  	jobject output_collector, jobject reporter);
{
 
 	// convert char* and pass on to user defined map method. 
 	// user's map method should take care of converting it to correct record IO 
 	// type.
 	int keyLen = (*env)->GetArrayLength(env, key) ;
 	int valueLen = (*env)->GetArrayLength(env, valueLen) ;

 	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
 	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
 	
 	// Call User defined method 
 	user_map(keyBuf, valueBuf, output_collector, reporter) ;
 	
 	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
 	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
}

/**
	Helper method, acts as a proxy to OutputCollector in java. key and value 
	must be serialized forms of records as specified in JobConf. 
**/
void output_collector(const char * key, const char *value,
	jobject output_collector, jobject reporter){
	
	// invoke java NativeOutputCollector.collect with key and value. 
}


User defined Mapper ( and Reducer ) 
------------------------------------
/**
	implements user defined map operation. 
**/
void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {

	//1. deserialize key/value in the appropriate format using record IO. 
	
	//2. process key/value and generate the intermediate key/values in record IO format. 
	
	//3. Deserialize intermediate key/values to intermed_key and intermed_value
	
	//4. pass intermed_key/intermed_value using helper function - 
	// 		output_collector(intermed_key, intermed_value, collector, recorder);
	
	
}

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 10:12:17 2006
Return-Path: 
 <hadoop-dev-return-1511-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70074 invoked from network); 19 May 2006 10:12:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 10:12:17 -0000
Received: (qmail 92887 invoked by uid 500); 19 May 2006 10:12:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92862 invoked by uid 500); 19 May 2006 10:12:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92853 invoked by uid 99); 19 May 2006 10:12:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 03:12:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 03:12:16 -0700
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k4JABxh20132
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 05:11:59 -0500
Message-ID: <446D997C.8040002@getopt.org>
Date: Fri, 19 May 2006 12:10:04 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Job scheduling (Re: Unable to run more than one job concurrently)
References: <446CECC9.6070801@getopt.org>
In-Reply-To: <446CECC9.6070801@getopt.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Andrzej Bialecki wrote:
> Hi all,
>
> I'm running Hadoop on a relatively small cluster (5 nodes) with 
> growing datasets.
>
> I noticed that if I start a job that is configured to run more map 
> tasks than is the cluster capacity (mapred.tasktracker.tasks.maximum * 
> number of nodes, 20 in this case), of course only that many map tasks 
> will run, and when they are finished the next map tasks from that job 
> will be scheduled.
>
> However, when I try to start another job in parallel, only its reduce 
> tasks will be scheduled (uselessly spin-waiting for map output, and 
> only reducing the number of available tasks in the cluster...), and no 
> map tasks from this job will be scheduled - until the first job 
> completes. This feels wrong - not only I'm not making progress on the 
> second job, but I'm also taking the slots away from the first job!
>
> I'm somewhat miffed about this - I'd think that jobtracker should 
> split the available resources evenly between these two jobs, i.e. it 
> should schedule some map tasks from the first job and some from the 
> second one. This is not what is happening, though ...
>
> Is this a configuration error, a bug, or a feature? :)
>

It seems it's a feature - I found the code in 
JobTracker.pollForNewTask(), and I'm not too happy about it.

Let's consider the following example: if I'm running a Nutch fetcher, 
the main limitation is the available bandwidth to fetch pages, and not 
the capacity of the cluster. I'd love to be able to execute other jobs 
in parallel, so that I don't have to wait until fetcher completes. I 
could sacrifice some of the task slots on tasktrackers for that other 
job, because the fetcher job wouldn't suffer from this anyway (at least 
not too much).

So, I'd like to change this code to pick up a random job from the list 
jobsByArrival, and take job.obtainNewMapTask from that randomly selected 
job. Would that work? Additionally, if no map tasks from that job have 
been allocated I'd like to skip adding reduce tasks from that job, later 
in lines 721-750.

Perhaps we should extend JobInProgress to include a priority, and 
implement something a la Unix scheduler.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Fri May 19 16:12:38 2006
Return-Path: 
 <hadoop-dev-return-1512-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 92115 invoked from network); 19 May 2006 16:12:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 16:12:38 -0000
Received: (qmail 46879 invoked by uid 500); 19 May 2006 16:12:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46855 invoked by uid 500); 19 May 2006 16:12:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46846 invoked by uid 99); 19 May 2006 16:12:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 09:12:37 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 09:12:36 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4JGBXPu009675
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 09:11:33 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=QYFgJnctEw74QY2TUmvC4Nk4Vkm5BiSK6+a4q79DtYsXnwrPsAb0+Vougc2yyCzy
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Fri, 19 May 2006 09:11:32 -0700
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <15152325.1147948326623.JavaMail.jira@brutus>
References: <15152325.1147948326623.JavaMail.jira@brutus>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <EF6E7DF2-BD90-40AC-A1E4-511228EEC6A3@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-222) Set replication from dfsshell
Date: Fri, 19 May 2006 08:34:04 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-OriginalArrivalTime: 19 May 2006 16:11:32.0873 (UTC)
 FILETIME=[E52D4790:01C67B5E]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Good ideas, you should file a new bug on this.

On May 18, 2006, at 3:32 AM, Andrzej Bialecki (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-222? 
> page=comments#action_12412326 ]
>
> Andrzej Bialecki  commented on HADOOP-222:
> ------------------------------------------
>
> Other things that I would love to see added to DFSShell (to make it  
> more shell-like). They are not such a big deal to implement, but  
> they would increase the usefulness of this class tremendously  
> (note: this is orthogonal to the issue of using Commons CLI, which  
> I'd love to see too):
>
> * globbing and multi-argument cp/mv/rm/ls, using the standard shell  
> metacharacters
>
> * interactive mode: ability to issue several commands in the same  
> session, while keeping track of the context (such as pwd)
>
> * scripts: nothing fancy, just the ability to execute several  
> commands recorded in a text file.
>
> The scriptability and interactive mode, and a host of other useful  
> features we can throw in cheaply by using Rhino (http:// 
> www.mozilla.org/rhino/shell.html).
>
>> Set replication from dfsshell
>> -----------------------------
>>
>>          Key: HADOOP-222
>>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>>      Project: Hadoop
>>         Type: New Feature
>
>>   Components: dfs
>>     Versions: 0.3
>>     Reporter: Johan Oskarson
>>     Priority: Trivial
>>  Attachments: setrep.patch
>>
>> Added ability to set replication for a directory/file from the  
>> command line.
>> Not heavily tested...
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Fri May 19 17:44:14 2006
Return-Path: 
 <hadoop-dev-return-1513-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18768 invoked from network); 19 May 2006 17:44:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 17:44:14 -0000
Received: (qmail 82575 invoked by uid 500); 19 May 2006 17:44:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82549 invoked by uid 500); 19 May 2006 17:44:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82540 invoked by uid 99); 19 May 2006 17:44:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 10:44:13 -0700
X-ASF-Spam-Status: No, hits=0.9 required=10.0
	tests=HTML_10_20,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of bpendleton@gmail.com designates
 64.233.184.232 as permitted sender)
Received: from [64.233.184.232] (HELO wr-out-0506.google.com) (64.233.184.232)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 10:44:12 -0700
Received: by wr-out-0506.google.com with SMTP id i28so675301wra
        for <hadoop-dev@lucene.apache.org>;
 Fri, 19 May 2006 10:43:51 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:references:x-google-sender-auth;
        b=Z3WGOypQ+MC8fI70HHfIlHfrHmjHW+EzvBEI6pr+l5n4+cCm3AhqHuhAkvgdc1NpA5sD1yb90eXzKCvUJKojfKBIRZ/kGkadpf++ZeHf6B6F8xR1VuM4ca3nlwLvnTQLNnPxeza5cpKEBDxJQHDXrXU2/6R3usBDsMQc9+ZX7+I=
Received: by 10.65.253.8 with SMTP id f8mr1655279qbs;
        Fri, 19 May 2006 10:43:51 -0700 (PDT)
Received: by 10.65.224.14 with HTTP; Fri, 19 May 2006 10:43:51 -0700 (PDT)
Message-ID: <1bf79d3e0605191043x6db287b6j393b87043f3c3967@mail.gmail.com>
Date: Fri, 19 May 2006 10:43:51 -0700
From: "Bryan A. Pendleton" <bp@geekdom.net>
Sender: bpendleton@gmail.com
To: hadoop-dev@lucene.apache.org
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
In-Reply-To: <446D997C.8040002@getopt.org>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_98531_8674220.1148060631396"
References: <446CECC9.6070801@getopt.org> <446D997C.8040002@getopt.org>
X-Google-Sender-Auth: f166bb1e16bb1085
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_98531_8674220.1148060631396
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: base64
Content-Disposition: inline

VGhlcmUgYXJlIHNvbWUgYWRkaXRpb25hbCByaXNrcyB0byBydW5uaW5nIHNpbXVsdGFuZW91cyBq
b2JzLiBSaWdodCBub3csCkhhZG9vcCBkb2VzIGEgdmVyeSBiYWQgam9iIGRlYWxpbmcgd2l0aCBv
dXQtb2Ytc3BhY2UgY29uZGl0aW9ucy4gSWYgeW91IHJ1bgp0d28gam9icywgd2hlcmUgdGhlIHRv
dGFsIGFtb3VudCBvZiB0ZW1wb3Jhcnkgc3BhY2UgKGZvciBtYXAgb3V0cHV0cykKYmV0d2VlbiBi
b3RoIGpvYnMgaXMgZ3JlYXRlciB0aGFuIHRoZSBhbW91bnQgb2Ygc3BhY2UgYXZhaWxhYmxlIG9u
IHRoZQpjbHVzdGVyLCB0aGVuIHRoZXkgd2lsbCBib3RoIGZhaWwuIElmIHlvdSBydW4gdGhlbSBz
ZXJpYWxseSwgdGhleSBzaG91bGQKYm90aCBzdWNjZWVkLgoKSW4gdGhlIHZlcnkgbGVhc3QsIGl0
J3MgcHJvYmFibHkgd2lzZSB0byB0YWtlIGludG8gYWNjb3VudCBtb3JlIHRoYW4ganVzdApzY2hl
ZHVsaW5nIHByaW9yaXR5IGluIGFueSBzY2hlZHVsZXIuIChFeHBlY3RlZCkgdGVtcG9yYXJ5IHNw
YWNlIGRlbWFuZHMsCmJhbmR3aWR0aCBsaW1pdHMsIGFuZCBzaXplIG9mIGpvYnMgc2hvdWxkIGJl
IHNvbWUgb2YgdGhlIGNyaXRlcmlhIGF2YWlsYWJsZQp0byB0aGUgc2NoZWR1bGVyLgoKT24gNS8x
OS8wNiwgQW5kcnplaiBCaWFsZWNraSA8YWJAZ2V0b3B0Lm9yZz4gd3JvdGU6Cj4KPiBBbmRyemVq
IEJpYWxlY2tpIHdyb3RlOgo+ID4gSGkgYWxsLAo+ID4KPiA+IEknbSBydW5uaW5nIEhhZG9vcCBv
biBhIHJlbGF0aXZlbHkgc21hbGwgY2x1c3RlciAoNSBub2Rlcykgd2l0aAo+ID4gZ3Jvd2luZyBk
YXRhc2V0cy4KPiA+Cj4gPiBJIG5vdGljZWQgdGhhdCBpZiBJIHN0YXJ0IGEgam9iIHRoYXQgaXMg
Y29uZmlndXJlZCB0byBydW4gbW9yZSBtYXAKPiA+IHRhc2tzIHRoYW4gaXMgdGhlIGNsdXN0ZXIg
Y2FwYWNpdHkgKG1hcHJlZC50YXNrdHJhY2tlci50YXNrcy5tYXhpbXVtICoKPiA+IG51bWJlciBv
ZiBub2RlcywgMjAgaW4gdGhpcyBjYXNlKSwgb2YgY291cnNlIG9ubHkgdGhhdCBtYW55IG1hcCB0
YXNrcwo+ID4gd2lsbCBydW4sIGFuZCB3aGVuIHRoZXkgYXJlIGZpbmlzaGVkIHRoZSBuZXh0IG1h
cCB0YXNrcyBmcm9tIHRoYXQgam9iCj4gPiB3aWxsIGJlIHNjaGVkdWxlZC4KPiA+Cj4gPiBIb3dl
dmVyLCB3aGVuIEkgdHJ5IHRvIHN0YXJ0IGFub3RoZXIgam9iIGluIHBhcmFsbGVsLCBvbmx5IGl0
cyByZWR1Y2UKPiA+IHRhc2tzIHdpbGwgYmUgc2NoZWR1bGVkICh1c2VsZXNzbHkgc3Bpbi13YWl0
aW5nIGZvciBtYXAgb3V0cHV0LCBhbmQKPiA+IG9ubHkgcmVkdWNpbmcgdGhlIG51bWJlciBvZiBh
dmFpbGFibGUgdGFza3MgaW4gdGhlIGNsdXN0ZXIuLi4pLCBhbmQgbm8KPiA+IG1hcCB0YXNrcyBm
cm9tIHRoaXMgam9iIHdpbGwgYmUgc2NoZWR1bGVkIC0gdW50aWwgdGhlIGZpcnN0IGpvYgo+ID4g
Y29tcGxldGVzLiBUaGlzIGZlZWxzIHdyb25nIC0gbm90IG9ubHkgSSdtIG5vdCBtYWtpbmcgcHJv
Z3Jlc3Mgb24gdGhlCj4gPiBzZWNvbmQgam9iLCBidXQgSSdtIGFsc28gdGFraW5nIHRoZSBzbG90
cyBhd2F5IGZyb20gdGhlIGZpcnN0IGpvYiEKPiA+Cj4gPiBJJ20gc29tZXdoYXQgbWlmZmVkIGFi
b3V0IHRoaXMgLSBJJ2QgdGhpbmsgdGhhdCBqb2J0cmFja2VyIHNob3VsZAo+ID4gc3BsaXQgdGhl
IGF2YWlsYWJsZSByZXNvdXJjZXMgZXZlbmx5IGJldHdlZW4gdGhlc2UgdHdvIGpvYnMsIGkuZS4g
aXQKPiA+IHNob3VsZCBzY2hlZHVsZSBzb21lIG1hcCB0YXNrcyBmcm9tIHRoZSBmaXJzdCBqb2Ig
YW5kIHNvbWUgZnJvbSB0aGUKPiA+IHNlY29uZCBvbmUuIFRoaXMgaXMgbm90IHdoYXQgaXMgaGFw
cGVuaW5nLCB0aG91Z2ggLi4uCj4gPgo+ID4gSXMgdGhpcyBhIGNvbmZpZ3VyYXRpb24gZXJyb3Is
IGEgYnVnLCBvciBhIGZlYXR1cmU/IDopCj4gPgo+Cj4gSXQgc2VlbXMgaXQncyBhIGZlYXR1cmUg
LSBJIGZvdW5kIHRoZSBjb2RlIGluCj4gSm9iVHJhY2tlci5wb2xsRm9yTmV3VGFzaygpLCBhbmQg
SSdtIG5vdCB0b28gaGFwcHkgYWJvdXQgaXQuCj4KPiBMZXQncyBjb25zaWRlciB0aGUgZm9sbG93
aW5nIGV4YW1wbGU6IGlmIEknbSBydW5uaW5nIGEgTnV0Y2ggZmV0Y2hlciwKPiB0aGUgbWFpbiBs
aW1pdGF0aW9uIGlzIHRoZSBhdmFpbGFibGUgYmFuZHdpZHRoIHRvIGZldGNoIHBhZ2VzLCBhbmQg
bm90Cj4gdGhlIGNhcGFjaXR5IG9mIHRoZSBjbHVzdGVyLiBJJ2QgbG92ZSB0byBiZSBhYmxlIHRv
IGV4ZWN1dGUgb3RoZXIgam9icwo+IGluIHBhcmFsbGVsLCBzbyB0aGF0IEkgZG9uJ3QgaGF2ZSB0
byB3YWl0IHVudGlsIGZldGNoZXIgY29tcGxldGVzLiBJCj4gY291bGQgc2FjcmlmaWNlIHNvbWUg
b2YgdGhlIHRhc2sgc2xvdHMgb24gdGFza3RyYWNrZXJzIGZvciB0aGF0IG90aGVyCj4gam9iLCBi
ZWNhdXNlIHRoZSBmZXRjaGVyIGpvYiB3b3VsZG4ndCBzdWZmZXIgZnJvbSB0aGlzIGFueXdheSAo
YXQgbGVhc3QKPiBub3QgdG9vIG11Y2gpLgo+Cj4gU28sIEknZCBsaWtlIHRvIGNoYW5nZSB0aGlz
IGNvZGUgdG8gcGljayB1cCBhIHJhbmRvbSBqb2IgZnJvbSB0aGUgbGlzdAo+IGpvYnNCeUFycml2
YWwsIGFuZCB0YWtlIGpvYi5vYnRhaW5OZXdNYXBUYXNrIGZyb20gdGhhdCByYW5kb21seSBzZWxl
Y3RlZAo+IGpvYi4gV291bGQgdGhhdCB3b3JrPyBBZGRpdGlvbmFsbHksIGlmIG5vIG1hcCB0YXNr
cyBmcm9tIHRoYXQgam9iIGhhdmUKPiBiZWVuIGFsbG9jYXRlZCBJJ2QgbGlrZSB0byBza2lwIGFk
ZGluZyByZWR1Y2UgdGFza3MgZnJvbSB0aGF0IGpvYiwgbGF0ZXIKPiBpbiBsaW5lcyA3MjEtNzUw
Lgo+Cj4gUGVyaGFwcyB3ZSBzaG91bGQgZXh0ZW5kIEpvYkluUHJvZ3Jlc3MgdG8gaW5jbHVkZSBh
IHByaW9yaXR5LCBhbmQKPiBpbXBsZW1lbnQgc29tZXRoaW5nIGEgbGEgVW5peCBzY2hlZHVsZXIu
Cj4KPiAtLQo+IEJlc3QgcmVnYXJkcywKPiBBbmRyemVqIEJpYWxlY2tpICAgICA8PjwKPiBfX18u
IF9fXyBfX18gX19fIF8gXyAgIF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KPiBb
X18gfHwgX198X18vfF9ffHxcL3wgIEluZm9ybWF0aW9uIFJldHJpZXZhbCwgU2VtYW50aWMgV2Vi
Cj4gX19ffHx8X198fCAgXHwgIHx8ICB8ICBFbWJlZGRlZCBVbml4LCBTeXN0ZW0gSW50ZWdyYXRp
b24KPiBodHRwOi8vd3d3LnNpZ3JhbS5jb20gIENvbnRhY3Q6IGluZm8gYXQgc2lncmFtIGRvdCBj
b20KPgo+Cj4KCgotLSAKQnJ5YW4gQS4gUGVuZGxldG9uClBoOiAoODc3KSBnZWVrLTEtYnAK
------=_Part_98531_8674220.1148060631396--

From MAILER-DAEMON Fri May 19 17:45:04 2006
Return-Path: 
 <hadoop-dev-return-1514-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18848 invoked from network); 19 May 2006 17:45:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 17:45:04 -0000
Received: (qmail 82992 invoked by uid 500); 19 May 2006 17:45:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82966 invoked by uid 500); 19 May 2006 17:45:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82957 invoked by uid 99); 19 May 2006 17:45:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 10:45:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 10:45:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 08DB441000F
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 17:44:31 +0000 (GMT)
Message-ID: <6928007.1148060671032.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 17:44:31 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-163?page=all ]

Hairong Kuang reassigned HADOOP-163:
------------------------------------

    Assign To: Hairong Kuang

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Runping Qi
>     Assignee: Hairong Kuang
>      Fix For: 0.3

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 17:59:04 2006
Return-Path: 
 <hadoop-dev-return-1515-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 22607 invoked from network); 19 May 2006 17:59:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 17:59:04 -0000
Received: (qmail 5099 invoked by uid 500); 19 May 2006 17:59:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5076 invoked by uid 500); 19 May 2006 17:59:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5066 invoked by uid 99); 19 May 2006 17:59:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 10:59:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 10:59:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 13F1F41000E
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 17:58:31 +0000 (GMT)
Message-ID: <2104755.1148061511077.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 17:58:31 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12412547 ] 

Hairong Kuang commented on HADOOP-163:
--------------------------------------

I plan to take a simple approach to this problem. If a data node finds out that it can not write to its disk. It reports to the name node and aborts. The name node logs the error and alerts it on the http UI.

I will use the existing data node protocol "errorReport" for the error reporting but with a minor change. In addition to the parameter error message, the rpc will also send an error code so that the name node does not need to parse the error message to figure out which action to take.

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Runping Qi
>     Assignee: Hairong Kuang
>      Fix For: 0.3

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 17:59:07 2006
Return-Path: 
 <hadoop-dev-return-1516-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 22699 invoked from network); 19 May 2006 17:59:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 17:59:07 -0000
Received: (qmail 5630 invoked by uid 500); 19 May 2006 17:59:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5608 invoked by uid 500); 19 May 2006 17:59:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5574 invoked by uid 99); 19 May 2006 17:59:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 10:59:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 10:59:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 517E541000F
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 17:58:33 +0000 (GMT)
Message-ID: <30934809.1148061513330.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 17:58:33 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-232) jar files sent to task tracker should
 override existing jar
In-Reply-To: <25736722.1147990685938.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-232?page=all ]

Milind Bhandarkar updated HADOOP-232:
-------------------------------------

    Attachment: hadoop-232.patch

Patch attached.

> jar files sent to task tracker should override existing jar
> -----------------------------------------------------------
>
>          Key: HADOOP-232
>          URL: http://issues.apache.org/jira/browse/HADOOP-232
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>  Attachments: hadoop-232.patch
>
> jar files sent to task tracker are appended to list, rather than prepended to it.
> this results in the original jar getting executed, although a new one was sent  - not the intent.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 18:01:06 2006
Return-Path: 
 <hadoop-dev-return-1517-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24342 invoked from network); 19 May 2006 18:01:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:01:06 -0000
Received: (qmail 8447 invoked by uid 500); 19 May 2006 18:01:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8427 invoked by uid 500); 19 May 2006 18:01:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8418 invoked by uid 99); 19 May 2006 18:01:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:01:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [64.202.165.238] (HELO
 smtpout10-04.prod.mesa1.secureserver.net) (64.202.165.238)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 19 May 2006 11:01:04 -0700
Received: (qmail 19518 invoked from network); 19 May 2006 18:00:43 -0000
Received: from unknown (71.140.53.217)
  by smtpout10-04.prod.mesa1.secureserver.net (64.202.165.238) with ESMTP;
 19 May 2006 18:00:40 -0000
From: "Paul Sutter" <psutter@quantcast.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: Job scheduling (Re: Unable to run more than one job concurrently)
Date: Fri, 19 May 2006 11:01:05 -0700
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook, Build 11.0.6353
Thread-Index: AcZ7a9pA7Hz1x236Q/qj9vgxCcZ7XwAAGC2A
In-Reply-To: <1bf79d3e0605191043x6db287b6j393b87043f3c3967@mail.gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2869
X-Virus-Checked: Checked by ClamAV on apache.org
Message-Id: <20060519180104.D58BC10FB004@asf.osuosl.org>
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


A few suggestions to allow for a very simple extension to the current
scheduling:

(1) Allow submission times in the future, enabling the creation of
"background" jobs. My understanding is that job submission times are used to
prioritize scheduling. All tasks from a job submitted early run to
completion before those of a job submitted later. If we could submit any
days-long jobs with a submission time in the future, say the year 2010, and
any short hours-long jobs with the current time, that short job would be
able to interrupt the long job. Hack? Yes. Useful? I think so.

(2) Have a per-job total task count limit. Currently, we establish the
number of tasks each node runs, and how many map or reduce tasks we have
total in a given job. But it would be great if we could set a ceiling on the
number of tasks that run concurrently for a given job. This may help with
Andrzej's fetcher (since it is bandwidth constrained, maybe fewer concurrent
jobs would be fine?).

(3) Don't start the reducers until a certain number of mappers have
completed (25%? 75%? 90%?). This optimization of starting early will be less
important when we've solved the map output copy problems.

Just a few ideas.

-----Original Message-----
From: bpendleton@gmail.com [mailto:bpendleton@gmail.com] On Behalf Of Bryan
A. Pendleton
Sent: Friday, May 19, 2006 10:44 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: Job scheduling (Re: Unable to run more than one job
concurrently)

There are some additional risks to running simultaneous jobs. Right now,
Hadoop does a very bad job dealing with out-of-space conditions. If you run
two jobs, where the total amount of temporary space (for map outputs)
between both jobs is greater than the amount of space available on the
cluster, then they will both fail. If you run them serially, they should
both succeed.

In the very least, it's probably wise to take into account more than just
scheduling priority in any scheduler. (Expected) temporary space demands,
bandwidth limits, and size of jobs should be some of the criteria available
to the scheduler.

On 5/19/06, Andrzej Bialecki <ab@getopt.org> wrote:
>
> Andrzej Bialecki wrote:
> > Hi all,
> >
> > I'm running Hadoop on a relatively small cluster (5 nodes) with
> > growing datasets.
> >
> > I noticed that if I start a job that is configured to run more map
> > tasks than is the cluster capacity (mapred.tasktracker.tasks.maximum *
> > number of nodes, 20 in this case), of course only that many map tasks
> > will run, and when they are finished the next map tasks from that job
> > will be scheduled.
> >
> > However, when I try to start another job in parallel, only its reduce
> > tasks will be scheduled (uselessly spin-waiting for map output, and
> > only reducing the number of available tasks in the cluster...), and no
> > map tasks from this job will be scheduled - until the first job
> > completes. This feels wrong - not only I'm not making progress on the
> > second job, but I'm also taking the slots away from the first job!
> >
> > I'm somewhat miffed about this - I'd think that jobtracker should
> > split the available resources evenly between these two jobs, i.e. it
> > should schedule some map tasks from the first job and some from the
> > second one. This is not what is happening, though ...
> >
> > Is this a configuration error, a bug, or a feature? :)
> >
>
> It seems it's a feature - I found the code in
> JobTracker.pollForNewTask(), and I'm not too happy about it.
>
> Let's consider the following example: if I'm running a Nutch fetcher,
> the main limitation is the available bandwidth to fetch pages, and not
> the capacity of the cluster. I'd love to be able to execute other jobs
> in parallel, so that I don't have to wait until fetcher completes. I
> could sacrifice some of the task slots on tasktrackers for that other
> job, because the fetcher job wouldn't suffer from this anyway (at least
> not too much).
>
> So, I'd like to change this code to pick up a random job from the list
> jobsByArrival, and take job.obtainNewMapTask from that randomly selected
> job. Would that work? Additionally, if no map tasks from that job have
> been allocated I'd like to skip adding reduce tasks from that job, later
> in lines 721-750.
>
> Perhaps we should extend JobInProgress to include a priority, and
> implement something a la Unix scheduler.
>
> --
> Best regards,
> Andrzej Bialecki     <><
> ___. ___ ___ ___ _ _   __________________________________
> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> http://www.sigram.com  Contact: info at sigram dot com
>
>
>


-- 
Bryan A. Pendleton
Ph: (877) geek-1-bp


From MAILER-DAEMON Fri May 19 18:07:07 2006
Return-Path: 
 <hadoop-dev-return-1518-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27124 invoked from network); 19 May 2006 18:07:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:07:07 -0000
Received: (qmail 13397 invoked by uid 500); 19 May 2006 18:07:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13372 invoked by uid 500); 19 May 2006 18:07:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13333 invoked by uid 99); 19 May 2006 18:07:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:07:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:07:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5348441000E
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 18:06:31 +0000 (GMT)
Message-ID: <835619.1148061991336.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 18:06:31 +0000 (GMT+00:00)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12412565 ] 

Bryan Pendleton commented on HADOOP-163:
----------------------------------------

Sounds good - except, what "aborts"? The idea of the datanode staying operating, but reporting error and not accepting further blocks is probably better, but maybe you meant "abort the block write". The node's blocks should probably not be counted by the namenode, but still available as a source for replication. Also, staying up means that there are fewer timeouts - it used to be that, when writing large volumes into DFS, if one or more of your nodes was full, your writer would hit a periodic timeout as connections to the (full and constantly restarting) datanode were refused. Hitting a timeout because some fraction of all resources is overused is, of course, much *much* slower than continuing to stream. Further - if the datanode periodically re-tests if the error condition has lifted, it can more immediately begin contributing to the cluster productivity again.

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Runping Qi
>     Assignee: Hairong Kuang
>      Fix For: 0.3

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 18:30:35 2006
Return-Path: 
 <hadoop-dev-return-1519-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34231 invoked from network); 19 May 2006 18:30:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:30:35 -0000
Received: (qmail 35985 invoked by uid 500); 19 May 2006 18:30:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35899 invoked by uid 500); 19 May 2006 18:30:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35879 invoked by uid 99); 19 May 2006 18:30:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:30:31 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:30:30 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4JIT1BE001174
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 11:29:01 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=0IGLDrjwXbdVUneuLH84Wn7OTkHCgZTx+BLfc/b/zHrZN8wdzRFtkrWEqZ7XXjs/
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Fri, 19 May 2006 11:29:01 -0700
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <20060519180104.D58BC10FB004@asf.osuosl.org>
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <0BFD6213-7075-453A-97FC-DBF2EF00A7FD@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
Date: Fri, 19 May 2006 11:29:02 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-OriginalArrivalTime: 19 May 2006 18:29:01.0586 (UTC)
 FILETIME=[19CAFF20:01C67B72]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

We're planning to experiment with using existing batch scheduling  
systems for addressing these concerns later in the year.  Condor and  
Torque being the leading contenders.

The thinking is that these systems have huge investments in  
configurable scheduling policies and that it is best to keep hadoop  
simple and leverage these systems to get fine grained / multi-user  
scheduling control.

If this works, the idea is to run a durable HDFS cluster and have the  
batch systems setup task tracker networks for each user on demand.   
This approach is probably more applicable if you have large clusters  
with distinct users / systems sharing them, so this may not address  
your requirements.

In any case this is why my team is not putting a lot of thought into  
this problem in the short term.  That said, I've always anticipated  
that others in the hadoop community might pursue improved  
scheduling.  I just advocate keeping it simple, because when you look  
at condor or torque you will quickly appreciate how unsimple it can  
become!


On May 19, 2006, at 11:01 AM, Paul Sutter wrote:

>
> A few suggestions to allow for a very simple extension to the current
> scheduling:
>
> (1) Allow submission times in the future, enabling the creation of
> "background" jobs. My understanding is that job submission times  
> are used to
> prioritize scheduling. All tasks from a job submitted early run to
> completion before those of a job submitted later. If we could  
> submit any
> days-long jobs with a submission time in the future, say the year  
> 2010, and
> any short hours-long jobs with the current time, that short job  
> would be
> able to interrupt the long job. Hack? Yes. Useful? I think so.
>
> (2) Have a per-job total task count limit. Currently, we establish the
> number of tasks each node runs, and how many map or reduce tasks we  
> have
> total in a given job. But it would be great if we could set a  
> ceiling on the
> number of tasks that run concurrently for a given job. This may  
> help with
> Andrzej's fetcher (since it is bandwidth constrained, maybe fewer  
> concurrent
> jobs would be fine?).
>
> (3) Don't start the reducers until a certain number of mappers have
> completed (25%? 75%? 90%?). This optimization of starting early  
> will be less
> important when we've solved the map output copy problems.
>
> Just a few ideas.
>
> -----Original Message-----
> From: bpendleton@gmail.com [mailto:bpendleton@gmail.com] On Behalf  
> Of Bryan
> A. Pendleton
> Sent: Friday, May 19, 2006 10:44 AM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: Job scheduling (Re: Unable to run more than one job
> concurrently)
>
> There are some additional risks to running simultaneous jobs. Right  
> now,
> Hadoop does a very bad job dealing with out-of-space conditions. If  
> you run
> two jobs, where the total amount of temporary space (for map outputs)
> between both jobs is greater than the amount of space available on the
> cluster, then they will both fail. If you run them serially, they  
> should
> both succeed.
>
> In the very least, it's probably wise to take into account more  
> than just
> scheduling priority in any scheduler. (Expected) temporary space  
> demands,
> bandwidth limits, and size of jobs should be some of the criteria  
> available
> to the scheduler.
>
> On 5/19/06, Andrzej Bialecki <ab@getopt.org> wrote:
>>
>> Andrzej Bialecki wrote:
>>> Hi all,
>>>
>>> I'm running Hadoop on a relatively small cluster (5 nodes) with
>>> growing datasets.
>>>
>>> I noticed that if I start a job that is configured to run more map
>>> tasks than is the cluster capacity  
>>> (mapred.tasktracker.tasks.maximum *
>>> number of nodes, 20 in this case), of course only that many map  
>>> tasks
>>> will run, and when they are finished the next map tasks from that  
>>> job
>>> will be scheduled.
>>>
>>> However, when I try to start another job in parallel, only its  
>>> reduce
>>> tasks will be scheduled (uselessly spin-waiting for map output, and
>>> only reducing the number of available tasks in the cluster...),  
>>> and no
>>> map tasks from this job will be scheduled - until the first job
>>> completes. This feels wrong - not only I'm not making progress on  
>>> the
>>> second job, but I'm also taking the slots away from the first job!
>>>
>>> I'm somewhat miffed about this - I'd think that jobtracker should
>>> split the available resources evenly between these two jobs, i.e. it
>>> should schedule some map tasks from the first job and some from the
>>> second one. This is not what is happening, though ...
>>>
>>> Is this a configuration error, a bug, or a feature? :)
>>>
>>
>> It seems it's a feature - I found the code in
>> JobTracker.pollForNewTask(), and I'm not too happy about it.
>>
>> Let's consider the following example: if I'm running a Nutch fetcher,
>> the main limitation is the available bandwidth to fetch pages, and  
>> not
>> the capacity of the cluster. I'd love to be able to execute other  
>> jobs
>> in parallel, so that I don't have to wait until fetcher completes. I
>> could sacrifice some of the task slots on tasktrackers for that other
>> job, because the fetcher job wouldn't suffer from this anyway (at  
>> least
>> not too much).
>>
>> So, I'd like to change this code to pick up a random job from the  
>> list
>> jobsByArrival, and take job.obtainNewMapTask from that randomly  
>> selected
>> job. Would that work? Additionally, if no map tasks from that job  
>> have
>> been allocated I'd like to skip adding reduce tasks from that job,  
>> later
>> in lines 721-750.
>>
>> Perhaps we should extend JobInProgress to include a priority, and
>> implement something a la Unix scheduler.
>>
>> --
>> Best regards,
>> Andrzej Bialecki     <><
>> ___. ___ ___ ___ _ _   __________________________________
>> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
>> ___|||__||  \|  ||  |  Embedded Unix, System Integration
>> http://www.sigram.com  Contact: info at sigram dot com
>>
>>
>>
>
>
> -- 
> Bryan A. Pendleton
> Ph: (877) geek-1-bp
>


From MAILER-DAEMON Fri May 19 18:31:37 2006
Return-Path: 
 <hadoop-dev-return-1520-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34432 invoked from network); 19 May 2006 18:31:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:31:37 -0000
Received: (qmail 37293 invoked by uid 500); 19 May 2006 18:31:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37165 invoked by uid 500); 19 May 2006 18:31:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37156 invoked by uid 99); 19 May 2006 18:31:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:31:36 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:31:36 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k4JIUvRE046981
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 11:30:57 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=EmzA825g0Pc3yVwLtvyjKaXqjXj+ywLqZJksyvsv33r3CRp5NjTaHWLEAxhpyBKn
Message-ID: <446E0EE0.40504@yahoo-inc.com>
Date: Fri, 19 May 2006 11:30:56 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-222) Set replication from dfsshell
References: <15152325.1147948326623.JavaMail.jira@brutus>
 <EF6E7DF2-BD90-40AC-A1E4-511228EEC6A3@yahoo-inc.com>
In-Reply-To: <EF6E7DF2-BD90-40AC-A1E4-511228EEC6A3@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

The bug number is
[jira] Created: (HADOOP-231) DFSShell Improvement wish list
It has a link on this and other related issues.
Better to keep them in one place, as Doug proposed.


Eric Baldeschwieler wrote:

> Good ideas, you should file a new bug on this.
>
> On May 18, 2006, at 3:32 AM, Andrzej Bialecki (JIRA) wrote:
>
>>     [ http://issues.apache.org/jira/browse/HADOOP-222? 
>> page=comments#action_12412326 ]
>>
>> Andrzej Bialecki  commented on HADOOP-222:
>> ------------------------------------------
>>
>> Other things that I would love to see added to DFSShell (to make it  
>> more shell-like). They are not such a big deal to implement, but  
>> they would increase the usefulness of this class tremendously  (note: 
>> this is orthogonal to the issue of using Commons CLI, which  I'd love 
>> to see too):
>>
>> * globbing and multi-argument cp/mv/rm/ls, using the standard shell  
>> metacharacters
>>
>> * interactive mode: ability to issue several commands in the same  
>> session, while keeping track of the context (such as pwd)
>>
>> * scripts: nothing fancy, just the ability to execute several  
>> commands recorded in a text file.
>>
>> The scriptability and interactive mode, and a host of other useful  
>> features we can throw in cheaply by using Rhino (http:// 
>> www.mozilla.org/rhino/shell.html).
>>
>>> Set replication from dfsshell
>>> -----------------------------
>>>
>>>          Key: HADOOP-222
>>>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>>>      Project: Hadoop
>>>         Type: New Feature
>>
>>
>>>   Components: dfs
>>>     Versions: 0.3
>>>     Reporter: Johan Oskarson
>>>     Priority: Trivial
>>>  Attachments: setrep.patch
>>>
>>> Added ability to set replication for a directory/file from the  
>>> command line.
>>> Not heavily tested...
>>
>>
>> -- 
>> This message is automatically generated by JIRA.
>> -
>> If you think it was sent incorrectly contact one of the  administrators:
>>    http://issues.apache.org/jira/secure/Administrators.jspa
>> -
>> For more information on JIRA, see:
>>    http://www.atlassian.com/software/jira
>>
>
>
>


From MAILER-DAEMON Fri May 19 18:36:09 2006
Return-Path: 
 <hadoop-dev-return-1521-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35679 invoked from network); 19 May 2006 18:36:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:36:09 -0000
Received: (qmail 41152 invoked by uid 500); 19 May 2006 18:36:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41104 invoked by uid 500); 19 May 2006 18:36:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41060 invoked by uid 99); 19 May 2006 18:36:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:36:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:36:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8EF057142A1
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 18:35:33 +0000 (GMT)
Message-ID: <27435834.1148063733566.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 18:35:33 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-163?page=comments#action_12412571 ] 

eric baldeschwieler commented on HADOOP-163:
--------------------------------------------

We are trying to deal with the case that the node is misconfigured / broken.  Trying to operate in these situations is hard.  Simpler to fail fast, IMO.  This leverages the designed strengths of HDFS.  Our goal is to get the information to the operator so they can diagnose and fix the problem and seal the problem off from the cluster.

This is distinct from the case that the node is simply full.  That would not trigger this condition.

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Runping Qi
>     Assignee: Hairong Kuang
>      Fix For: 0.3

>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 18:47:46 2006
Return-Path: 
 <hadoop-dev-return-1522-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38146 invoked from network); 19 May 2006 18:47:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:47:46 -0000
Received: (qmail 57671 invoked by uid 500); 19 May 2006 18:47:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57650 invoked by uid 500); 19 May 2006 18:47:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57582 invoked by uid 99); 19 May 2006 18:47:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:47:44 -0700
X-ASF-Spam-Status: No, hits=0.3 required=10.0
	tests=HTML_MESSAGE,MAILTO_TO_SPAM_ADDR,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of sutter@gmail.com designates
 64.233.162.194 as permitted sender)
Received: from [64.233.162.194] (HELO nz-out-0102.google.com) (64.233.162.194)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:47:41 -0700
Received: by nz-out-0102.google.com with SMTP id o37so755350nzf
        for <hadoop-dev@lucene.apache.org>;
 Fri, 19 May 2006 11:47:21 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=mGqjB5J/cUazeeu/3C6XXQ8XEW/Gi8XPD9oUEopBDxXZ2MuV1HOMBzzDTJ5g99K3bolgRnFdUuUf664Wvv0G7ydvMj6jieGbO1Nuz10WgLdJtWGvvDLMzkpNqrXs2i4NDmJxl2SPeRE0GUc4yQtxhDu+HKP+Y0EJ+qWz3JQzlRw=
Received: by 10.36.42.17 with SMTP id p17mr1699805nzp;
        Fri, 19 May 2006 11:47:20 -0700 (PDT)
Received: by 10.36.128.1 with HTTP; Fri, 19 May 2006 11:47:20 -0700 (PDT)
Message-ID: <e1d10fc00605191147r1487189fkad269e21d737d3e7@mail.gmail.com>
Date: Fri, 19 May 2006 11:47:20 -0700
From: "Paul Sutter" <sutter@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
In-Reply-To: <0BFD6213-7075-453A-97FC-DBF2EF00A7FD@yahoo-inc.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_5343_15186895.1148064440854"
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
	 <0BFD6213-7075-453A-97FC-DBF2EF00A7FD@yahoo-inc.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_5343_15186895.1148064440854
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Using an existing full-featured scheduler will be great.

Being able to submit tasks in the future would be nice though, as an interi=
m
step. If it would work.

Question for any Hadoop scheduler experts out there: will that work as a
quick hack way to implement background tasks?

Paul


On 5/19/06, Eric Baldeschwieler <eric14@yahoo-inc.com> wrote:
>
> We're planning to experiment with using existing batch scheduling
> systems for addressing these concerns later in the year.  Condor and
> Torque being the leading contenders.
>
> The thinking is that these systems have huge investments in
> configurable scheduling policies and that it is best to keep hadoop
> simple and leverage these systems to get fine grained / multi-user
> scheduling control.
>
> If this works, the idea is to run a durable HDFS cluster and have the
> batch systems setup task tracker networks for each user on demand.
> This approach is probably more applicable if you have large clusters
> with distinct users / systems sharing them, so this may not address
> your requirements.
>
> In any case this is why my team is not putting a lot of thought into
> this problem in the short term.  That said, I've always anticipated
> that others in the hadoop community might pursue improved
> scheduling.  I just advocate keeping it simple, because when you look
> at condor or torque you will quickly appreciate how unsimple it can
> become!
>
>
> On May 19, 2006, at 11:01 AM, Paul Sutter wrote:
>
> >
> > A few suggestions to allow for a very simple extension to the current
> > scheduling:
> >
> > (1) Allow submission times in the future, enabling the creation of
> > "background" jobs. My understanding is that job submission times
> > are used to
> > prioritize scheduling. All tasks from a job submitted early run to
> > completion before those of a job submitted later. If we could
> > submit any
> > days-long jobs with a submission time in the future, say the year
> > 2010, and
> > any short hours-long jobs with the current time, that short job
> > would be
> > able to interrupt the long job. Hack? Yes. Useful? I think so.
> >
> > (2) Have a per-job total task count limit. Currently, we establish the
> > number of tasks each node runs, and how many map or reduce tasks we
> > have
> > total in a given job. But it would be great if we could set a
> > ceiling on the
> > number of tasks that run concurrently for a given job. This may
> > help with
> > Andrzej's fetcher (since it is bandwidth constrained, maybe fewer
> > concurrent
> > jobs would be fine?).
> >
> > (3) Don't start the reducers until a certain number of mappers have
> > completed (25%? 75%? 90%?). This optimization of starting early
> > will be less
> > important when we've solved the map output copy problems.
> >
> > Just a few ideas.
> >
> > -----Original Message-----
> > From: bpendleton@gmail.com [mailto:bpendleton@gmail.com] On Behalf
> > Of Bryan
> > A. Pendleton
> > Sent: Friday, May 19, 2006 10:44 AM
> > To: hadoop-dev@lucene.apache.org
> > Subject: Re: Job scheduling (Re: Unable to run more than one job
> > concurrently)
> >
> > There are some additional risks to running simultaneous jobs. Right
> > now,
> > Hadoop does a very bad job dealing with out-of-space conditions. If
> > you run
> > two jobs, where the total amount of temporary space (for map outputs)
> > between both jobs is greater than the amount of space available on the
> > cluster, then they will both fail. If you run them serially, they
> > should
> > both succeed.
> >
> > In the very least, it's probably wise to take into account more
> > than just
> > scheduling priority in any scheduler. (Expected) temporary space
> > demands,
> > bandwidth limits, and size of jobs should be some of the criteria
> > available
> > to the scheduler.
> >
> > On 5/19/06, Andrzej Bialecki <ab@getopt.org> wrote:
> >>
> >> Andrzej Bialecki wrote:
> >>> Hi all,
> >>>
> >>> I'm running Hadoop on a relatively small cluster (5 nodes) with
> >>> growing datasets.
> >>>
> >>> I noticed that if I start a job that is configured to run more map
> >>> tasks than is the cluster capacity
> >>> (mapred.tasktracker.tasks.maximum *
> >>> number of nodes, 20 in this case), of course only that many map
> >>> tasks
> >>> will run, and when they are finished the next map tasks from that
> >>> job
> >>> will be scheduled.
> >>>
> >>> However, when I try to start another job in parallel, only its
> >>> reduce
> >>> tasks will be scheduled (uselessly spin-waiting for map output, and
> >>> only reducing the number of available tasks in the cluster...),
> >>> and no
> >>> map tasks from this job will be scheduled - until the first job
> >>> completes. This feels wrong - not only I'm not making progress on
> >>> the
> >>> second job, but I'm also taking the slots away from the first job!
> >>>
> >>> I'm somewhat miffed about this - I'd think that jobtracker should
> >>> split the available resources evenly between these two jobs, i.e. it
> >>> should schedule some map tasks from the first job and some from the
> >>> second one. This is not what is happening, though ...
> >>>
> >>> Is this a configuration error, a bug, or a feature? :)
> >>>
> >>
> >> It seems it's a feature - I found the code in
> >> JobTracker.pollForNewTask(), and I'm not too happy about it.
> >>
> >> Let's consider the following example: if I'm running a Nutch fetcher,
> >> the main limitation is the available bandwidth to fetch pages, and
> >> not
> >> the capacity of the cluster. I'd love to be able to execute other
> >> jobs
> >> in parallel, so that I don't have to wait until fetcher completes. I
> >> could sacrifice some of the task slots on tasktrackers for that other
> >> job, because the fetcher job wouldn't suffer from this anyway (at
> >> least
> >> not too much).
> >>
> >> So, I'd like to change this code to pick up a random job from the
> >> list
> >> jobsByArrival, and take job.obtainNewMapTask from that randomly
> >> selected
> >> job. Would that work? Additionally, if no map tasks from that job
> >> have
> >> been allocated I'd like to skip adding reduce tasks from that job,
> >> later
> >> in lines 721-750.
> >>
> >> Perhaps we should extend JobInProgress to include a priority, and
> >> implement something a la Unix scheduler.
> >>
> >> --
> >> Best regards,
> >> Andrzej Bialecki     <><
> >> ___. ___ ___ ___ _ _   __________________________________
> >> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> >> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> >> http://www.sigram.com  Contact: info at sigram dot com
> >>
> >>
> >>
> >
> >
> > --
> > Bryan A. Pendleton
> > Ph: (877) geek-1-bp
> >
>
>

------=_Part_5343_15186895.1148064440854--

From MAILER-DAEMON Fri May 19 18:48:03 2006
Return-Path: 
 <hadoop-dev-return-1523-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38366 invoked from network); 19 May 2006 18:48:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:48:03 -0000
Received: (qmail 58193 invoked by uid 500); 19 May 2006 18:48:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58172 invoked by uid 500); 19 May 2006 18:48:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58163 invoked by uid 99); 19 May 2006 18:48:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:48:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:48:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D037A7142A1
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 18:47:29 +0000 (GMT)
Message-ID: <10557622.1148064449849.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 18:47:29 +0000 (GMT+00:00)
From: "Benjamin Reed (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-235) LocalFileSystem.openRaw() throws the
 wrong string for FileNotFoundException
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

LocalFileSystem.openRaw() throws the wrong string for FileNotFoundException
---------------------------------------------------------------------------

         Key: HADOOP-235
         URL: http://issues.apache.org/jira/browse/HADOOP-235
     Project: Hadoop
        Type: Bug

    Reporter: Benjamin Reed


openRaw should throw f.toString() on an error, not toString().

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 18:52:04 2006
Return-Path: 
 <hadoop-dev-return-1524-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38787 invoked from network); 19 May 2006 18:52:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:52:04 -0000
Received: (qmail 61148 invoked by uid 500); 19 May 2006 18:52:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61020 invoked by uid 500); 19 May 2006 18:52:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61011 invoked by uid 99); 19 May 2006 18:52:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:52:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:52:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8C4D07142A1
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 18:51:30 +0000 (GMT)
Message-ID: <18795041.1148064690571.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 18:51:30 +0000 (GMT+00:00)
From: "Benjamin Reed (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-235) LocalFileSystem.openRaw() throws the
 wrong string for FileNotFoundException
In-Reply-To: <10557622.1148064449849.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-235?page=all ]

Benjamin Reed updated HADOOP-235:
---------------------------------

    Attachment: missing-f.patch

> LocalFileSystem.openRaw() throws the wrong string for FileNotFoundException
> ---------------------------------------------------------------------------
>
>          Key: HADOOP-235
>          URL: http://issues.apache.org/jira/browse/HADOOP-235
>      Project: Hadoop
>         Type: Bug

>     Reporter: Benjamin Reed
>  Attachments: missing-f.patch
>
> openRaw should throw f.toString() on an error, not toString().

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 18:59:48 2006
Return-Path: 
 <hadoop-dev-return-1525-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40011 invoked from network); 19 May 2006 18:59:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 18:59:48 -0000
Received: (qmail 67356 invoked by uid 500); 19 May 2006 18:59:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67330 invoked by uid 500); 19 May 2006 18:59:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67321 invoked by uid 99); 19 May 2006 18:59:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:59:47 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 11:59:47 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k4JIxRWJ026099
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 14:59:27 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k4JIxOTT278052;
	Fri, 19 May 2006 14:59:25 -0400
Message-ID: <446E158B.9060203@apache.org>
Date: Fri, 19 May 2006 11:59:23 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.8 (X11/20060502)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
In-Reply-To: <20060519180104.D58BC10FB004@asf.osuosl.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Paul Sutter wrote:
> (1) Allow submission times in the future, enabling the creation of
> "background" jobs. My understanding is that job submission times are used to
> prioritize scheduling. All tasks from a job submitted early run to
> completion before those of a job submitted later. If we could submit any
> days-long jobs with a submission time in the future, say the year 2010, and
> any short hours-long jobs with the current time, that short job would be
> able to interrupt the long job. Hack? Yes. Useful? I think so.

I think this is equivalent to adding a job priority, where tasks with 
the highest priority job are run first.  If jobs are at the same 
priority, then the first submitted would run.  Adding priority would add 
a bit more complexity, but would also be less of a hack.

> (2) Have a per-job total task count limit. Currently, we establish the
> number of tasks each node runs, and how many map or reduce tasks we have
> total in a given job. But it would be great if we could set a ceiling on the
> number of tasks that run concurrently for a given job. This may help with
> Andrzej's fetcher (since it is bandwidth constrained, maybe fewer concurrent
> jobs would be fine?).

I like this idea.  So if the highest-priority job is already running at 
its task limit, then tasks can be run from the next highest-priority 
job.  Should there be separate limits for maps and reduces?

> (3) Don't start the reducers until a certain number of mappers have
> completed (25%? 75%? 90%?). This optimization of starting early will be less
> important when we've solved the map output copy problems.

Would this only be done if there were other jobs competing for reduce 
slots?  Otherwise this could have an impact on performance.

In theory, network bandwidth is the primary MapReduce bottleneck.  Map 
input usually doesn't cross the network, but map output must generally 
cross the network to reduce nodes.  Sorting can be done in parallel with 
mapping and copying of map output to reduce nodes, but reduce output 
cannot begin until all map output has arrived.  Finally, in general, 
reduce output must cross the network, for replication.  So the data must 
cross the network twice: once between map and reduce and once on reduce 
output, and these two transfers are serialized.  Since the network is 
the bottleneck, we will get the best performance when we saturate it 
continuously.  So we should thus begin transferring map outputs as soon 
as they are available.  That's the theory.

Doug

From MAILER-DAEMON Fri May 19 19:12:04 2006
Return-Path: 
 <hadoop-dev-return-1526-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42575 invoked from network); 19 May 2006 19:12:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:12:04 -0000
Received: (qmail 78190 invoked by uid 500); 19 May 2006 19:12:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78045 invoked by uid 500); 19 May 2006 19:12:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78024 invoked by uid 99); 19 May 2006 19:12:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:12:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:12:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9083241000E
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 19:11:30 +0000 (GMT)
Message-ID: <12717556.1148065890589.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 19:11:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-226) DFSShell problems. Incorrect block
 replication detection in fsck.
In-Reply-To: <24430703.1147903865906.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-226?page=comments#action_12412576 ] 

Doug Cutting commented on HADOOP-226:
-------------------------------------

We should not try to parse all command line options in one place.  A generic class should parse out -D, -conf, -fs, etc. options, build a configuration, then the per-command class should parse the rest of the command line.  That's what HADOOP-59 is about.  Commons CLI could be used to implement the generic option parser and/or each command's option parser.

> DFSShell problems. Incorrect block replication detection in fsck.
> -----------------------------------------------------------------
>
>          Key: HADOOP-226
>          URL: http://issues.apache.org/jira/browse/HADOOP-226
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: All
>     Reporter: Konstantin Shvachko

>
> 1. We need to adjust Dfsck to the new per-file replication feature.
> fsck checks block replication based on the configured global replication parameter.
> Which is now just the default. The actual file replication is returned in DFSFileInfo.
> So at least the reporting is screwed by that, although I didn't check what will happen with
> other options -move and -delete.
> 2. fsck throws NullPointerException if you type
> bin/hadoop fsck -files /doc
> instead of
> bin/hadoop fsck /doc -files
> 3. Unfortunately, there are several commands that throw different kinds of Exceptions
> rather than at least printing the usage info, when some of its arguments are missing or
> misplaced. ArrayIndexOutOfBoundsException is one them. Try
> bin/hadoop dfs -mv
> bin/hadoop dfs -cp
> bin/hadoop dfs -rm
> 4. In general the shell is growing and getting more sophisticated.
> Should we work out a general convention on how the parameters should be structured, named,
> short/long version of the keywords, help, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 19:19:05 2006
Return-Path: 
 <hadoop-dev-return-1527-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50049 invoked from network); 19 May 2006 19:19:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:19:05 -0000
Received: (qmail 89317 invoked by uid 500); 19 May 2006 19:19:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89266 invoked by uid 500); 19 May 2006 19:19:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89233 invoked by uid 99); 19 May 2006 19:19:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:19:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:19:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CB068410010
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 19:18:29 +0000 (GMT)
Message-ID: <22977378.1148066309828.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 19:18:29 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-236) job tracker should refuse connection
 from a task tracker with a different version number
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

job tracker should refuse connection from a task tracker with a different version number
----------------------------------------------------------------------------------------

         Key: HADOOP-236
         URL: http://issues.apache.org/jira/browse/HADOOP-236
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2.1    
    Reporter: Hairong Kuang


After one mapred system upgrade, we noticed that all tasks assigned to one task tracker failed. It turned out that for some reason the task tracker was not upgraded.

To avoid this, a task tracker should reports its version # when it registers itsself with a job tracker. If the job tracker receives an inconsistent version #, it should refuse the connection.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 19:26:17 2006
Return-Path: 
 <hadoop-dev-return-1528-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54151 invoked from network); 19 May 2006 19:26:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:26:17 -0000
Received: (qmail 2003 invoked by uid 500); 19 May 2006 19:26:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1984 invoked by uid 500); 19 May 2006 19:26:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1975 invoked by uid 99); 19 May 2006 19:26:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:26:16 -0700
X-ASF-Spam-Status: No, hits=0.9 required=10.0
	tests=HTML_10_20,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of sutter@gmail.com designates
 64.233.162.206 as permitted sender)
Received: from [64.233.162.206] (HELO nz-out-0102.google.com) (64.233.162.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:26:15 -0700
Received: by nz-out-0102.google.com with SMTP id o37so761823nzf
        for <hadoop-dev@lucene.apache.org>;
 Fri, 19 May 2006 12:25:52 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=NX+CuvJp6Bsr4iASe3LoMI9ci5Qjo6hOAdnTpNpWL+wA4NrQb5LrjtJ2RLUZpUR03mza5+7L00fZx5Ii8dhrvZ2ea91gqM5UJtdVoQBKH4/boC7UVAwmAQfbv1PptnZdTRDommfuYYR0NNoP07CGlRV6HxtwWP/cOOqEM5BUhG0=
Received: by 10.36.227.8 with SMTP id z8mr635358nzg;
        Fri, 19 May 2006 12:25:52 -0700 (PDT)
Received: by 10.36.128.1 with HTTP; Fri, 19 May 2006 12:25:52 -0700 (PDT)
Message-ID: <e1d10fc00605191225p3e4d988el2a2c88fc75590116@mail.gmail.com>
Date: Fri, 19 May 2006 12:25:52 -0700
From: "Paul Sutter" <sutter@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
In-Reply-To: <446E158B.9060203@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_5731_8883558.1148066752597"
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
	 <446E158B.9060203@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_5731_8883558.1148066752597
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

priority vs pretend dates: whatever is most trivial, i'm in favor. we could
certainly use it today.

delaying reducers: regardless of the bottleneck in the system, andrzej's
problem was that reducers were sitting idle while the mappers of another
task were running.

paul


On 5/19/06, Doug Cutting <cutting@apache.org> wrote:
>
> Paul Sutter wrote:
> > (1) Allow submission times in the future, enabling the creation of
> > "background" jobs. My understanding is that job submission times are
> used to
> > prioritize scheduling. All tasks from a job submitted early run to
> > completion before those of a job submitted later. If we could submit an=
y
> > days-long jobs with a submission time in the future, say the year 2010,
> and
> > any short hours-long jobs with the current time, that short job would b=
e
> > able to interrupt the long job. Hack? Yes. Useful? I think so.
>
> I think this is equivalent to adding a job priority, where tasks with
> the highest priority job are run first.  If jobs are at the same
> priority, then the first submitted would run.  Adding priority would add
> a bit more complexity, but would also be less of a hack.
>
> > (2) Have a per-job total task count limit. Currently, we establish the
> > number of tasks each node runs, and how many map or reduce tasks we hav=
e
> > total in a given job. But it would be great if we could set a ceiling o=
n
> the
> > number of tasks that run concurrently for a given job. This may help
> with
> > Andrzej's fetcher (since it is bandwidth constrained, maybe fewer
> concurrent
> > jobs would be fine?).
>
> I like this idea.  So if the highest-priority job is already running at
> its task limit, then tasks can be run from the next highest-priority
> job.  Should there be separate limits for maps and reduces?
>
> > (3) Don't start the reducers until a certain number of mappers have
> > completed (25%? 75%? 90%?). This optimization of starting early will be
> less
> > important when we've solved the map output copy problems.
>
> Would this only be done if there were other jobs competing for reduce
> slots?  Otherwise this could have an impact on performance.
>
> In theory, network bandwidth is the primary MapReduce bottleneck.  Map
> input usually doesn't cross the network, but map output must generally
> cross the network to reduce nodes.  Sorting can be done in parallel with
> mapping and copying of map output to reduce nodes, but reduce output
> cannot begin until all map output has arrived.  Finally, in general,
> reduce output must cross the network, for replication.  So the data must
> cross the network twice: once between map and reduce and once on reduce
> output, and these two transfers are serialized.  Since the network is
> the bottleneck, we will get the best performance when we saturate it
> continuously.  So we should thus begin transferring map outputs as soon
> as they are available.  That's the theory.
>
> Doug
>

------=_Part_5731_8883558.1148066752597--

From MAILER-DAEMON Fri May 19 19:27:05 2006
Return-Path: 
 <hadoop-dev-return-1529-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54357 invoked from network); 19 May 2006 19:27:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:27:05 -0000
Received: (qmail 2744 invoked by uid 500); 19 May 2006 19:27:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2718 invoked by uid 500); 19 May 2006 19:27:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2709 invoked by uid 99); 19 May 2006 19:27:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:27:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:27:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EF20E7141E6
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 19:26:30 +0000 (GMT)
Message-ID: <3918697.1148066790976.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 19:26:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12412580 ] 

Doug Cutting commented on HADOOP-24:
------------------------------------

API back-compatibility is important.  We'd like folks to be able to upgrade to new releases without having to change their code.  The convention we've had is that, code which compiles against release 0.X without deprecation warnings will still compile against release 0.X+1, but may require changes to compile against release 0.X+2.  Is that reasonable?

If so, then 'new Configuration()' must still create a usable configuration and not a compilation error in release 0.3.  It may be deprecated, but it should still work.  Yes, this is a pain, since Configuration would be a great name for the interface, but there's code out there (more than just Nutch) that we should try not to break.  Nutch is a good, public test case for this sort of back-compatibility, that's the reason I mention it.

Another approach might be to use a new package.  We could put the new classes in org.apache.hadoop.config, and then have org.apache.hadoop.conf.Configuration be a deprecated subclass of org.apache.hadoop.config.ConfigurationImpl.  Then, after 0.3 is released, we could remove the entire org.apache.hadoop.conf package.

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24-4.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 19:50:04 2006
Return-Path: 
 <hadoop-dev-return-1530-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60228 invoked from network); 19 May 2006 19:50:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:50:04 -0000
Received: (qmail 32119 invoked by uid 500); 19 May 2006 19:50:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32095 invoked by uid 500); 19 May 2006 19:50:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32086 invoked by uid 99); 19 May 2006 19:50:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:50:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:50:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9B9C7410010
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 19:49:30 +0000 (GMT)
Message-ID: <25078367.1148068170634.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 19:49:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
In-Reply-To: <6140265.1148030971246.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-234?page=comments#action_12412581 ] 

Doug Cutting commented on HADOOP-234:
-------------------------------------

It would be best to avoid deserializing & reserializing objects in Java before passing them to C.  So you might instead always use BytesWritable for the input and output keys and values in Java, and implement a subclass of SequenceFileInputFormat that uses SequenceFile.next(DataOutputBuffer) to copy the raw binary content into the BytesWritable.  Then your mapper and reducer implementations could simply get the bytes from the BytesWritable and pass it to the native method, without re-serializing.  Does this make sense?

> Support for writing Map/Reduce functions in C++
> -----------------------------------------------
>
>          Key: HADOOP-234
>          URL: http://issues.apache.org/jira/browse/HADOOP-234
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Sanjay Dahiya

>
> MapReduce C++ support
> Requirements 
> 1. Allow users to write Map and Reduce functions in C++, rest of the 
> infrastructure already present in Java should be reused. 
> 2. Avoid users having to write both Java and C++ for this to work. 
> 3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
> 4. Use Record IO for describing record format, both MR java framework and C++ should 
> 	use the same format to work seemlessly. 
> 5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
> 	simple strings. 
> Implementation notes
> - If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
> 	mapper and reducer methods in C++. 
> - For composite Record IO types user starts with defining a record format using Record IO DDL. 
> - User generates Java and C++ classes from the DDL using record IO. 
> - Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
> - User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
>   makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
>   generated C++ record IO classes. 
> - User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 
> Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 
> Native(JNI) Java proxy for the Mapper : 
> ---------------------------------------
> Without Record IO :-
> --------------------
> public class SimpleNativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	  * Works on simple strings. 
> 	  **/
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		mapNative(key.toString().getBytes()
> 				, value.toString().getBytes(), output, reporter); 
> 	}
> 	
> 	/**
> 	  * Native implementation. 
> 	  **/
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> With Record IO :- 
> ------------------
> public class RecordIONativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	 * Implementation of map method, this acts as a JNI proxy for actual map 
> 	 * method implemented in C++. Works for Record IO based records. 
> 	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
> 	 */
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		
> 		byte[] keyBytes = null ;
> 		byte[] valueBytes = null ;
> 		
> 		try{
> 			// we need to serialize the key and record and pass the serialized 
> 			// format to C++ / JNI methods so they can interpret it using appropriate 
> 			// record IO classes. 
> 			{
> 				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				keyBytes = keyStream.toByteArray();
> 			}
> 			{
> 				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				valueBytes = valueStream.toByteArray();
> 			}
> 		}catch(ClassCastException e){
> 			// throw better exceptions
> 			throw new IOException("Input record must be of Record IO Type"); 
> 		}
> 		// pass the serialized byte[] to C++ implementation. 
> 		mapNative(keyBytes, valueBytes, output, reporter); 
> 	}
> 	/**
> 	 * Implementation in C++.
> 	 */
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> OutputCollector Proxy for C++
> ------------------------------
> public class NativeOutputCollector implements OutputCollector {
> 	// standard method from interface
> 	public void collect(WritableComparable key, Writable value)
> 			throws IOException {
> 	}
> 	
> 	// deserializes key and value and calls collect(WritableComparable, Writable)
> 	public void collectFromNative(byte[]key, byte[]value){
> 		// deserialize key and value to java types ( as configured in JobConf )
> 		// call actual collect method 
> 	}
> }
> Core Native functions ( helper for user provided Mapper and Reducer ) 
> ---------------------------------------------------------------------
> #include "org_apache_hadoop_mapred_NativeMapper.h"
> #include "UserMapper.h"
> /**
> 	* A C++ proxy method, calls actual implementation of the Mapper. This method 
> 	signature is generated by javah.
> **/
> JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
>   (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
>   	jobject output_collector, jobject reporter);
> {
>  
>  	// convert char* and pass on to user defined map method. 
>  	// user's map method should take care of converting it to correct record IO 
>  	// type.
>  	int keyLen = (*env)->GetArrayLength(env, key) ;
>  	int valueLen = (*env)->GetArrayLength(env, valueLen) ;
>  	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
>  	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
>  	
>  	// Call User defined method 
>  	user_map(keyBuf, valueBuf, output_collector, reporter) ;
>  	
>  	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
>  	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
> }
> /**
> 	Helper method, acts as a proxy to OutputCollector in java. key and value 
> 	must be serialized forms of records as specified in JobConf. 
> **/
> void output_collector(const char * key, const char *value,
> 	jobject output_collector, jobject reporter){
> 	
> 	// invoke java NativeOutputCollector.collect with key and value. 
> }
> User defined Mapper ( and Reducer ) 
> ------------------------------------
> /**
> 	implements user defined map operation. 
> **/
> void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {
> 	//1. deserialize key/value in the appropriate format using record IO. 
> 	
> 	//2. process key/value and generate the intermediate key/values in record IO format. 
> 	
> 	//3. Deserialize intermediate key/values to intermed_key and intermed_value
> 	
> 	//4. pass intermed_key/intermed_value using helper function - 
> 	// 		output_collector(intermed_key, intermed_value, collector, recorder);
> 	
> 	
> }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 19:53:04 2006
Return-Path: 
 <hadoop-dev-return-1531-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60567 invoked from network); 19 May 2006 19:53:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:53:04 -0000
Received: (qmail 37968 invoked by uid 500); 19 May 2006 19:53:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37947 invoked by uid 500); 19 May 2006 19:53:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37938 invoked by uid 99); 19 May 2006 19:53:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:53:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:53:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9479441000F
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 19:52:30 +0000 (GMT)
Message-ID: <33139841.1148068350605.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 19:52:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-220) Add -dfs and -jt command-line
 parameters to specify namenode and jobtracker.
In-Reply-To: <19210133.1147731605899.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-220?page=all ]
     
Doug Cutting resolved HADOOP-220:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed
      Assign To: Milind Bhandarkar

I just committed this.  Thanks, Milind.

> Add -dfs and -jt command-line parameters to specify namenode and jobtracker.
> ----------------------------------------------------------------------------
>
>          Key: HADOOP-220
>          URL: http://issues.apache.org/jira/browse/HADOOP-220
>      Project: Hadoop
>         Type: Sub-task

>   Components: fs
>  Environment: All
>     Reporter: Milind Bhandarkar
>     Assignee: Milind Bhandarkar
>      Fix For: 0.3
>  Attachments: hadoop-220-228-229.patch, hadoop-220.patch
>
> Most hadoop commands accept -df and -jt commandline parameters. Make the cp command to accept those as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 19:55:05 2006
Return-Path: 
 <hadoop-dev-return-1532-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61202 invoked from network); 19 May 2006 19:55:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:55:05 -0000
Received: (qmail 40683 invoked by uid 500); 19 May 2006 19:55:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40664 invoked by uid 500); 19 May 2006 19:55:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40655 invoked by uid 99); 19 May 2006 19:55:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:55:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:55:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BBD9D41000F
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 19:54:31 +0000 (GMT)
Message-ID: <29372205.1148068471763.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 19:54:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-228) hadoop cp should have a -config
 option
In-Reply-To: <1170975.1147911125959.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-228?page=all ]
     
Doug Cutting resolved HADOOP-228:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

> hadoop cp should have a -config option
> --------------------------------------
>
>          Key: HADOOP-228
>          URL: http://issues.apache.org/jira/browse/HADOOP-228
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>      Fix For: 0.3

>
> hadoop cp should have a -config option to enable overriding of default parameters.
> it  would perhaps be good to rename the command as well to something like dcp or distcp, since it's not a simple command, but rather an entire map-recude job

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 19:55:08 2006
Return-Path: 
 <hadoop-dev-return-1533-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61228 invoked from network); 19 May 2006 19:55:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:55:08 -0000
Received: (qmail 40848 invoked by uid 500); 19 May 2006 19:55:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40824 invoked by uid 500); 19 May 2006 19:55:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40814 invoked by uid 99); 19 May 2006 19:55:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:55:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:55:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 28593410011
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 19:54:34 +0000 (GMT)
Message-ID: <16244580.1148068474160.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 19:54:34 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-229) hadoop cp should generate a better
 number of map tasks
In-Reply-To: <2422002.1147911845993.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-229?page=all ]
     
Doug Cutting resolved HADOOP-229:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

> hadoop cp should generate a better number of map tasks
> ------------------------------------------------------
>
>          Key: HADOOP-229
>          URL: http://issues.apache.org/jira/browse/HADOOP-229
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>      Fix For: 0.3

>
> hadoop cp currently assigns 10 files to copy per map task.
> in case of a small number of large files on a large cluster (say 300 files of 30GB each on a 300 node cluster), this results in long execution times.
> better would be to assign files per task such that the entire cluster is utilized: one file per map, with a cap of 10000 maps total, so as not to over burden the job tracker.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 19:58:17 2006
Return-Path: 
 <hadoop-dev-return-1535-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61611 invoked from network); 19 May 2006 19:58:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:58:17 -0000
Received: (qmail 46479 invoked by uid 500); 19 May 2006 19:58:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46460 invoked by uid 500); 19 May 2006 19:58:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46451 invoked by uid 99); 19 May 2006 19:58:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:58:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:58:15 -0700
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k4JJw5t08698
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 14:58:05 -0500
Message-ID: <446E22D0.7070706@getopt.org>
Date: Fri, 19 May 2006 21:56:00 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
	 <446E158B.9060203@apache.org>
 <e1d10fc00605191225p3e4d988el2a2c88fc75590116@mail.gmail.com>
In-Reply-To: <e1d10fc00605191225p3e4d988el2a2c88fc75590116@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Paul Sutter wrote:
> priority vs pretend dates: whatever is most trivial, i'm in favor. we 
> could
> certainly use it today.
>
> delaying reducers: regardless of the bottleneck in the system, andrzej's
> problem was that reducers were sitting idle while the mappers of another
> task were running.

Exactly. There is no point in starting any reducers if we haven't even 
scheduled a single map task for the job. As soon as at least one map 
task is scheduled, I'm fine with starting reducers, I agree with 
arguments about network bottlenecks that Doug presented.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Fri May 19 19:57:06 2006
Return-Path: 
 <hadoop-dev-return-1534-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61517 invoked from network); 19 May 2006 19:57:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 19:57:06 -0000
Received: (qmail 45890 invoked by uid 500); 19 May 2006 19:57:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 45873 invoked by uid 500); 19 May 2006 19:57:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 45864 invoked by uid 99); 19 May 2006 19:57:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:57:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 12:57:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0237441000F
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 19:56:31 +0000 (GMT)
Message-ID: <19898228.1148068591006.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 19:56:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-232) jar files sent to task tracker
 should override existing jar
In-Reply-To: <25736722.1147990685938.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-232?page=comments#action_12412583 ] 

Doug Cutting commented on HADOOP-232:
-------------------------------------

This is a security issue.  Typically there should not be multiple versions of a resource on the classpath.  If there are, what's to be trusted, the one local to the machine, or the one included in the job?  We don't want folks to be able to, e.g. include new versions of Hadoop's internal classes in a job.  Nor do we wish them to be able to override non-overrideable job settings, which this would permit.

Can you elaborate on the case where you needed this feature?

> jar files sent to task tracker should override existing jar
> -----------------------------------------------------------
>
>          Key: HADOOP-232
>          URL: http://issues.apache.org/jira/browse/HADOOP-232
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>  Attachments: hadoop-232.patch
>
> jar files sent to task tracker are appended to list, rather than prepended to it.
> this results in the original jar getting executed, although a new one was sent  - not the intent.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 20:21:04 2006
Return-Path: 
 <hadoop-dev-return-1536-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71439 invoked from network); 19 May 2006 20:21:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 20:21:04 -0000
Received: (qmail 87189 invoked by uid 500); 19 May 2006 20:21:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87167 invoked by uid 500); 19 May 2006 20:21:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87158 invoked by uid 99); 19 May 2006 20:21:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:21:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:21:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9252C410010
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 20:20:30 +0000 (GMT)
Message-ID: <11447012.1148070030596.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 20:20:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-233) add a http status server for the
 task trackers
In-Reply-To: <29031689.1147997166807.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-233?page=comments#action_12412584 ] 

Doug Cutting commented on HADOOP-233:
-------------------------------------

I finally figured out how to apply this:

svn mv src/webapps/mapred src/webapps/job
svn mv src/webapps/index.html src/webapps/job
patch -p 0 < task-tracker-webapp.patch
svn add src/webapps/task

But then it doesn't compile.  I think you forgot to include the new class that starts a jetty server, StatusHttpServer.  There doesn't appear to be any of the 'static' stuff (mentioned above) in the patch.  Is that also missing from the patch?


> add a http status server for the task trackers
> ----------------------------------------------
>
>          Key: HADOOP-233
>          URL: http://issues.apache.org/jira/browse/HADOOP-233
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: task-tracker-webapp.patch
>
> I'd like to have:
>   1. a jetty server on each task tracker to serve up logs and status
>   2. the jetty server on the job tracker serve up logs

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 20:28:05 2006
Return-Path: 
 <hadoop-dev-return-1537-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72157 invoked from network); 19 May 2006 20:28:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 20:28:05 -0000
Received: (qmail 93601 invoked by uid 500); 19 May 2006 20:28:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93575 invoked by uid 500); 19 May 2006 20:28:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93566 invoked by uid 99); 19 May 2006 20:28:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:28:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:28:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0501C71429B
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 20:27:31 +0000 (GMT)
Message-ID: <29301589.1148070451017.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 20:27:31 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-232) jar files sent to task tracker
 should override existing jar
In-Reply-To: <25736722.1147990685938.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-232?page=comments#action_12412585 ] 

Yoram Arnon commented on HADOOP-232:
------------------------------------

debugging the hadoop distcp command required it.
the command is executed by the dfs client, which is in this case a map task.
the class is part of the hadoop release however, so it already resided on the tasktracker's nodes. We wanted to actually override it using a newly sent jar, without upgrading and restarting the map-reduce cluster.
we saw that as a general enough case to warrant a change to the task tracker.

I guess that an alternate solution would be to unbundle the 'external' programs from the main jar file.


> jar files sent to task tracker should override existing jar
> -----------------------------------------------------------
>
>          Key: HADOOP-232
>          URL: http://issues.apache.org/jira/browse/HADOOP-232
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>  Attachments: hadoop-232.patch
>
> jar files sent to task tracker are appended to list, rather than prepended to it.
> this results in the original jar getting executed, although a new one was sent  - not the intent.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 20:35:26 2006
Return-Path: 
 <hadoop-dev-return-1538-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73621 invoked from network); 19 May 2006 20:35:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 20:35:26 -0000
Received: (qmail 4823 invoked by uid 500); 19 May 2006 20:35:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4691 invoked by uid 500); 19 May 2006 20:35:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4682 invoked by uid 99); 19 May 2006 20:35:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:35:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:35:24 -0700
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k4JKZIn17904
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 15:35:18 -0500
Message-ID: <446E2B89.6090608@getopt.org>
Date: Fri, 19 May 2006 22:33:13 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
 <446E158B.9060203@apache.org>
In-Reply-To: <446E158B.9060203@apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> Paul Sutter wrote:
>> (1) Allow submission times in the future, enabling the creation of
>> "background" jobs. My understanding is that job submission times are 
>> used to
>> prioritize scheduling. All tasks from a job submitted early run to
>> completion before those of a job submitted later. If we could submit any
>> days-long jobs with a submission time in the future, say the year 
>> 2010, and
>> any short hours-long jobs with the current time, that short job would be
>> able to interrupt the long job. Hack? Yes. Useful? I think so.
>
> I think this is equivalent to adding a job priority, where tasks with 
> the highest priority job are run first.  If jobs are at the same 
> priority, then the first submitted would run.  Adding priority would 
> add a bit more complexity, but would also be less of a hack.


Hmm.. If you compare it to a Unix scheduler, processes at the same 
priority have even chances of being run, regardless of which was started 
first - not only that, processes undergo a "priority decay", in that if 
they are running longer then their priority is lowered - this enables 
new processes to start quickly (and maybe quickly finish), and then 
fairly compete with other processes.

In our case, this would mean that jobs with the same priority would 
execute concurrently, sharing available map/reduce slots, and long 
running jobs would be gradually de-prioritized. This also means that the 
first job will slow down when the second one is started, but the second 
job will have a chance to make a good start (and perhaps quickly finish) 
and then, subject to the priority decay, run in parallel with other jobs 
(albeit slower) instead of being stuck in the wait queue.

And if the second job is started with a higher priority, it should 
preempt the first job (i.e. it should get proportionally more slots than 
the first job). If you need all cluster resources for a specific job, 
and don't want any other jobs to run, just set the priority to the 
highest value, thus preempting all other jobs (actually, it would 
suspend other already executing jobs, which would resume when your job 
is done - not a bad feature either!).

I think this is a relatively simple and well understood mechanism.


>> (2) Have a per-job total task count limit. Currently, we establish the
>> number of tasks each node runs, and how many map or reduce tasks we have
>> total in a given job. But it would be great if we could set a ceiling 
>> on the
>> number of tasks that run concurrently for a given job. This may help 
>> with
>> Andrzej's fetcher (since it is bandwidth constrained, maybe fewer 
>> concurrent
>> jobs would be fine?).
>
> I like this idea.  So if the highest-priority job is already running 
> at its task limit, then tasks can be run from the next 
> highest-priority job.  Should there be separate limits for maps and 
> reduces?

I like this idea too. I think a similar setting for the minimum number 
of tasks would be needed too? That would solve my problem. In fact, it 
would be probably better than the schema I described above, because it 
would guarantee certain minimum tasks running at any time.

This reminds me of the "idle time" and "real time" policies in BSD 
scheduler ... man 1 rtprio. The "real time" policy prevents the priority 
decay that normally occurs, and "idle time" policy allows processes to 
run only if CPU is idle.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Fri May 19 20:37:08 2006
Return-Path: 
 <hadoop-dev-return-1539-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73853 invoked from network); 19 May 2006 20:37:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 20:37:08 -0000
Received: (qmail 6390 invoked by uid 500); 19 May 2006 20:37:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6372 invoked by uid 500); 19 May 2006 20:37:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6363 invoked by uid 99); 19 May 2006 20:37:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:37:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:37:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 05D6A71429D
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 20:36:34 +0000 (GMT)
Message-ID: <20787195.1148070993989.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 20:36:33 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-232) jar files sent to task tracker
 should override existing jar
In-Reply-To: <25736722.1147990685938.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-232?page=comments#action_12412589 ] 

Doug Cutting commented on HADOOP-232:
-------------------------------------

Yes, if you think this cp command needs to be updatable separately from the core then its code should not be in the core build, but rather in the examples, contrib or perhaps a (new) apps build.

> jar files sent to task tracker should override existing jar
> -----------------------------------------------------------
>
>          Key: HADOOP-232
>          URL: http://issues.apache.org/jira/browse/HADOOP-232
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>  Attachments: hadoop-232.patch
>
> jar files sent to task tracker are appended to list, rather than prepended to it.
> this results in the original jar getting executed, although a new one was sent  - not the intent.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 20:41:07 2006
Return-Path: 
 <hadoop-dev-return-1540-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74385 invoked from network); 19 May 2006 20:41:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 20:41:07 -0000
Received: (qmail 9076 invoked by uid 500); 19 May 2006 20:41:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8943 invoked by uid 500); 19 May 2006 20:41:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8933 invoked by uid 99); 19 May 2006 20:41:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:41:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:41:05 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9E7AB410013
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 20:40:32 +0000 (GMT)
Message-ID: <5881821.1148071232633.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 20:40:32 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12412591 ] 

alan wootton commented on HADOOP-90:
------------------------------------

I thought about this for a while, and I think this is how I would attack the problem.

First, I introduce the concept of a 'precious file' in dfs. A precious file is a file that can be recovered even if all NameNode state is lost. This is probably not a new object but just a boolean in FSDirectory.INode to indicate that the file is precious (and a boolean in FileUnderConstruction). 

A precious file is composed of PreciousBlock's, instead of Block's like a normal dfs file: 

public class PreciousBlock extends Block {
	
	UTF8   pathName; // absolute dfs path
	long   timestamp;// milliseconds since last change
	int    sequence; // which block this is. ie 0th, first, etc.
	int    total;    // count of blocks for the file
	short  replication; 

	public void write(DataOutput out) ...
      public void readFields(DataInput in) ... etc.
}

Whenever a DataNode creates, or replicates, a block for a file that is precious it also serializes the PreciousBlock to a file in it's data directory(s).

You would see something like this in a datanode directory;

blk_2241143806243395050
blk_385073589724654571
blk_8416156569406441156
precious_385073589724654571

This would mean that block #385073589724654571 is part of a precious file. The file precious_385073589724654571 contains a serialization of PreciousBlock.

Files stored this way can be recovered with out any NameNode state at all. The NameNode could simply wait until the DataNodes report their blocks and reconstruct all the precious files. If a precious file is widely replicated it becomes almost impossible to ever lose. The purpose of the timestamp is for the case where a file is renamed, or deleted and recreated, and a datanode didn't get the message.

The next part is easy. The NameNode just writes its image and edits to precious files in the dfs. The NameNode can easily keep several old versions of its state, or any other good tricks. Old NameNode images could be rotated like log files, etc. 

Recovery from loss, or corruption, of NameNode state is relatively simple. The NameNode recovers the precious files and then just reads the latest reliable image/edits. 


> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon

>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 20:55:05 2006
Return-Path: 
 <hadoop-dev-return-1541-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76731 invoked from network); 19 May 2006 20:55:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 20:55:05 -0000
Received: (qmail 25009 invoked by uid 500); 19 May 2006 20:55:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24878 invoked by uid 500); 19 May 2006 20:55:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24869 invoked by uid 99); 19 May 2006 20:55:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:55:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 13:55:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 44783410011
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 20:54:31 +0000 (GMT)
Message-ID: <29549989.1148072071277.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 20:54:31 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12412592 ] 

Gal Nitzan commented on HADOOP-24:
----------------------------------

I totaly agree with you Doug on API back compatibilty.

+1 for org.apache.hadoop.config

So if Configuration subclasses ConfigurationImpl you would not have to introduce changes in Nutch for now? and you can postpone it to a suitable time?



> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24-4.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 21:09:50 2006
Return-Path: 
 <hadoop-dev-return-1542-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80128 invoked from network); 19 May 2006 21:09:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 21:09:50 -0000
Received: (qmail 56370 invoked by uid 500); 19 May 2006 21:09:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56347 invoked by uid 500); 19 May 2006 21:09:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56338 invoked by uid 99); 19 May 2006 21:09:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 14:09:49 -0700
X-ASF-Spam-Status: No, hits=0.9 required=10.0
	tests=HTML_10_20,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of sutter@gmail.com designates
 64.233.162.200 as permitted sender)
Received: from [64.233.162.200] (HELO nz-out-0102.google.com) (64.233.162.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 14:09:47 -0700
Received: by nz-out-0102.google.com with SMTP id o37so777732nzf
        for <hadoop-dev@lucene.apache.org>;
 Fri, 19 May 2006 14:09:27 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=AW9+vcLUSjrcyv9aVa+PrK7vul06oHRRr8o2ijRDErUtq4CcH8d7y+zNdwG7z3Nlf88bQWslpMJEJDK3L2RWBu2F1giZdlIhrpi9WDewm39hjDdXIVkitbr3rm2rn2IIyBaEcbvj4TKLudfWOUdeyFE+Xle32z14RjM2Bds2p10=
Received: by 10.36.80.14 with SMTP id d14mr1738533nzb;
        Fri, 19 May 2006 14:09:15 -0700 (PDT)
Received: by 10.36.128.1 with HTTP; Fri, 19 May 2006 14:09:27 -0700 (PDT)
Message-ID: <e1d10fc00605191409i55dd7917oebfcaceb43835c93@mail.gmail.com>
Date: Fri, 19 May 2006 14:09:27 -0700
From: "Paul Sutter" <sutter@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
In-Reply-To: <446E2B89.6090608@getopt.org>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_6847_20004588.1148072967017"
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
	 <446E158B.9060203@apache.org> <446E2B89.6090608@getopt.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_6847_20004588.1148072967017
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

right now, i would prefer that we have a really really simple scheme that
can be done quickly.

being able to run a huge days-long job in the background, such that a
smaller hours-long job basically takes over and runs to completion, that
would be a big win.

having multple jobs with time slicing? cool, but only 20% better and
probably 80% more work.

if we want a thorough scheme, i think eric has the right idea of using one
of the existing scheduler packages.


On 5/19/06, Andrzej Bialecki <ab@getopt.org> wrote:
>
> Doug Cutting wrote:
> > Paul Sutter wrote:
> >> (1) Allow submission times in the future, enabling the creation of
> >> "background" jobs. My understanding is that job submission times are
> >> used to
> >> prioritize scheduling. All tasks from a job submitted early run to
> >> completion before those of a job submitted later. If we could submit
> any
> >> days-long jobs with a submission time in the future, say the year
> >> 2010, and
> >> any short hours-long jobs with the current time, that short job would
> be
> >> able to interrupt the long job. Hack? Yes. Useful? I think so.
> >
> > I think this is equivalent to adding a job priority, where tasks with
> > the highest priority job are run first.  If jobs are at the same
> > priority, then the first submitted would run.  Adding priority would
> > add a bit more complexity, but would also be less of a hack.
>
>
> Hmm.. If you compare it to a Unix scheduler, processes at the same
> priority have even chances of being run, regardless of which was started
> first - not only that, processes undergo a "priority decay", in that if
> they are running longer then their priority is lowered - this enables
> new processes to start quickly (and maybe quickly finish), and then
> fairly compete with other processes.
>
> In our case, this would mean that jobs with the same priority would
> execute concurrently, sharing available map/reduce slots, and long
> running jobs would be gradually de-prioritized. This also means that the
> first job will slow down when the second one is started, but the second
> job will have a chance to make a good start (and perhaps quickly finish)
> and then, subject to the priority decay, run in parallel with other jobs
> (albeit slower) instead of being stuck in the wait queue.
>
> And if the second job is started with a higher priority, it should
> preempt the first job (i.e. it should get proportionally more slots than
> the first job). If you need all cluster resources for a specific job,
> and don't want any other jobs to run, just set the priority to the
> highest value, thus preempting all other jobs (actually, it would
> suspend other already executing jobs, which would resume when your job
> is done - not a bad feature either!).
>
> I think this is a relatively simple and well understood mechanism.
>
>
> >> (2) Have a per-job total task count limit. Currently, we establish the
> >> number of tasks each node runs, and how many map or reduce tasks we
> have
> >> total in a given job. But it would be great if we could set a ceiling
> >> on the
> >> number of tasks that run concurrently for a given job. This may help
> >> with
> >> Andrzej's fetcher (since it is bandwidth constrained, maybe fewer
> >> concurrent
> >> jobs would be fine?).
> >
> > I like this idea.  So if the highest-priority job is already running
> > at its task limit, then tasks can be run from the next
> > highest-priority job.  Should there be separate limits for maps and
> > reduces?
>
> I like this idea too. I think a similar setting for the minimum number
> of tasks would be needed too? That would solve my problem. In fact, it
> would be probably better than the schema I described above, because it
> would guarantee certain minimum tasks running at any time.
>
> This reminds me of the "idle time" and "real time" policies in BSD
> scheduler ... man 1 rtprio. The "real time" policy prevents the priority
> decay that normally occurs, and "idle time" policy allows processes to
> run only if CPU is idle.
>
> --
> Best regards,
> Andrzej Bialecki     <><
> ___. ___ ___ ___ _ _   __________________________________
> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> http://www.sigram.com  Contact: info at sigram dot com
>
>
>

------=_Part_6847_20004588.1148072967017--

From MAILER-DAEMON Fri May 19 21:59:05 2006
Return-Path: 
 <hadoop-dev-return-1543-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88235 invoked from network); 19 May 2006 21:59:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 21:59:05 -0000
Received: (qmail 22240 invoked by uid 500); 19 May 2006 21:59:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22222 invoked by uid 500); 19 May 2006 21:59:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22209 invoked by uid 99); 19 May 2006 21:59:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 14:59:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 14:59:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1073471429D
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 21:58:31 +0000 (GMT)
Message-ID: <12475329.1148075911064.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 21:58:31 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-232) jar files sent to task tracker
 should override existing jar
In-Reply-To: <25736722.1147990685938.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-232?page=comments#action_12412594 ] 

Milind Bhandarkar commented on HADOOP-232:
------------------------------------------

If the CopyFiles class is not put into core hadoop, I think it should not be part of the bin/hadoop command as well. Because all the classes invoked from bin/hadoop are in core hadoop. We should provide a separate script called distcp (which was my original proposal) in a top-level opt (denoting optional) directory. The source and class file should go to examples. Comments ?

> jar files sent to task tracker should override existing jar
> -----------------------------------------------------------
>
>          Key: HADOOP-232
>          URL: http://issues.apache.org/jira/browse/HADOOP-232
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>  Attachments: hadoop-232.patch
>
> jar files sent to task tracker are appended to list, rather than prepended to it.
> this results in the original jar getting executed, although a new one was sent  - not the intent.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 22:15:05 2006
Return-Path: 
 <hadoop-dev-return-1544-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91680 invoked from network); 19 May 2006 22:15:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 22:15:05 -0000
Received: (qmail 38039 invoked by uid 500); 19 May 2006 22:15:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37991 invoked by uid 500); 19 May 2006 22:15:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37982 invoked by uid 99); 19 May 2006 22:15:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 15:15:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 15:15:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2C82941000E
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 22:14:31 +0000 (GMT)
Message-ID: <19213436.1148076871179.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 22:14:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12412598 ] 

Doug Cutting commented on HADOOP-24:
------------------------------------

Right, we should not add dependencies to Nutch on as-yet-unreleased features in Hadoop.  But we want Nutch users to be able to use the current Hadoop trunk.  So once we've made the next Hadoop release, and upgraded Nutch's trunk to use that release, then we can introduce changes to Nutch.

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24-4.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 22:44:04 2006
Return-Path: 
 <hadoop-dev-return-1545-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97747 invoked from network); 19 May 2006 22:44:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 22:44:04 -0000
Received: (qmail 78014 invoked by uid 500); 19 May 2006 22:44:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77996 invoked by uid 500); 19 May 2006 22:44:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77987 invoked by uid 99); 19 May 2006 22:44:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 15:44:03 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 15:44:02 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D2B337142C8
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 22:43:29 +0000 (GMT)
Message-ID: <14919853.1148078609860.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 22:43:29 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-237) Standard set of Performance Metrics
 for Hadoop
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Standard set of Performance Metrics for Hadoop
----------------------------------------------

         Key: HADOOP-237
         URL: http://issues.apache.org/jira/browse/HADOOP-237
     Project: Hadoop
        Type: Improvement

  Components: metrics  
    Versions: 0.3    
 Environment: All
    Reporter: Milind Bhandarkar
 Assigned to: Milind Bhandarkar 


I am starting to use Hadoop's shiny new Metrics API to publish performance (and other) Metrics of running jobs and other daemons.

Which performance metrics are people interested in seeing ? If possible, please group them according to modules, such as map-reduce, dfs, general-cluster-related etc. I will follow this process:

1. collect this list
2. assess feasibility of obtaining metric
3. assign context/record/metrics names
4. seek approval for names
5. instrument the code.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 22:58:45 2006
Return-Path: 
 <hadoop-dev-return-1546-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1019 invoked from network); 19 May 2006 22:58:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 22:58:45 -0000
Received: (qmail 3128 invoked by uid 500); 19 May 2006 22:58:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3103 invoked by uid 500); 19 May 2006 22:58:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3093 invoked by uid 99); 19 May 2006 22:58:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 15:58:45 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [66.228.160.55] (HELO mercury2.inktomi.com) (66.228.160.55)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 15:58:44 -0700
Received: from inbox1.inktomi.com (inbox1.inktomi.com [66.228.160.102])
	by mercury2.inktomi.com (8.13.4/8.13.4) with ESMTP id k4JMvWMm006784
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 15:57:34 -0700 (PDT)
Received: from [66.228.166.58] ([66.228.166.58]) by
          inbox1.inktomi.com (Netscape Messaging Server 4.1) with ESMTP id
          IZJBRV00.U6T for <hadoop-dev@lucene.apache.org>; Fri, 19 May
          2006 15:57:31 -0700
Mime-Version: 1.0 (Apple Message framework v623)
In-Reply-To: <8a8b9f3f0605152154q2f219948ieb997284b69e6854@mail.gmail.com>
References: <8a8b9f3f0605152154q2f219948ieb997284b69e6854@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Message-Id: <4da785d8662903a7c7a354f2d3feb052@inktomi.com>
Content-Transfer-Encoding: 7bit
From: "Arkady Borkovsky" <arkady@inktomi.com>
Subject: Re: HBase Design Ideas, Part II
Date: Fri, 19 May 2006 15:57:31 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Michael,

I like the initiative and most of the ideas.
It looks like the design is very record oriented.

Some potential applications of HBase-like functionality are 
batch-oriented: select (a large) subset of records, process a subset of 
their columns (often a small subset), and either add either new 
columns, or new versions of columns.
Several applications like this may be running on the same "table" 
simultaneously.

Think, for example, about query log processing, where the key is a 
search query, and the daily stats are represented as columns (several 
columns per day), plus columns for data aggregated by week, by month, 
etc.

How well does the proposal address this kind of uses?

-- ab

On May 15, 2006, at 9:54 PM, Michael Cafarella wrote:

> Hi everyone,
>
> My previous mail mentioned a bunch of design ideas that were mainly
> lifted from Jeff Dean's BigTable talk.  BigTable seems like a useful
> way to do large-scale row storage, and their decisions largely seem
> like the right ones.
>
> However, BigTable still leaves some things on the table.  Items to
> improve include a query language and multi-row locking, among
> other things.
>
> Dean said explicitly in his talk that they wanted to avoid multirow
> locking because it's complicated, error-prone, and maybe not necessary.
> He's right on at least the first two, and maybe the third.
>
> Multiple row locks are useful when you're making a change to
> several rows that should be atomic; you want all the changes
> or none of the changes.  It's also used in traditional databases
> if you want to perform an expensive read operation (like a
> multiway join) and you want to make sure the results don't
> get modified while you're reading.
>
> Distributed lock acquisition is very hard to do.  It's bug-prone
> and often has very weird performance ramifications.  It's
> difficult to get working, difficult to tune, difficult to everything.
>
> Here are a few ideas on what to do:
> 1)  Suck it up and have the client acquire locks on multiple
> HRegionServers simultaneously.  All clients would have to
> agree to acquire locks according to some global ordering to
> avoid deadlock.  HRegions would not be allowed to migrate
> to a new server if locked.
>
> If this is a rare circumstance, a better approach would be
> to have a dedicated "lock acquirer" through which clients
> make requests.  It doesn't help the theoretical problem here,
> but it would make debugging an awful lot easier.
>
> 2)  In the case of long-lasting read operations, we can
> use versioning to guarantee consistency.  If each row is
> annotated with an edit timestamp, and we know that there
> is sufficient version history available, the long-lasting job
> can run over a specific version only.
>
> Edits can continue to be made to the database while the
> read-only job is ongoing.  The operation is performed over
> the database as of the time the task was submitted.
>
> 3) In the case of multiple row updates, we may be able to
> use different edit semantics to avoid locking.  For example,
> consider that we want to add a single column/value pair to
> multiple rows.  We want this to happen atomically, so that
> both rows get the value or neither of them do so.
>
> If it's just an add, then we don't need to lock the rows at
> all; the add will always succeed, even if other writes
> intervene. Traditionally there's been no difference between
> among data "updates", so they all require locking.  If we
> can get a client to adjust the update semantics slightly,
> then the locking can be much more relaxed.
>
> I'd say that "add" or "append" semantics are likely to be
> at least as common as "edit" semantics.
>
> Can you think of the family of edit semantics you'd like
> to see offered here?
>
> Also, how useful do you think a general-purpose query language
> would be for HBase?  It would be fairly straightforward to implement,
> for example, a poor man's version of SQL that has different locking
> and update behavior (and which chucks out the more exotic elements).
> This might be compiled into a piece of code that is executed
> immediately, or it might be transformed into a long-lasting mapreduce
> job.
>
> I have a few ideas for such a language, but I'm worried it's getting
> a little far afield from what we're interested in for Hadoop.
>
> --Mike


From MAILER-DAEMON Fri May 19 23:04:04 2006
Return-Path: 
 <hadoop-dev-return-1547-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1779 invoked from network); 19 May 2006 23:04:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 23:04:04 -0000
Received: (qmail 13147 invoked by uid 500); 19 May 2006 23:04:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13019 invoked by uid 500); 19 May 2006 23:04:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13010 invoked by uid 99); 19 May 2006 23:04:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:04:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:04:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8F11F7142C8
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 23:03:30 +0000 (GMT)
Message-ID: <30253424.1148079810583.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 23:03:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-237) Standard set of Performance Metrics
 for Hadoop
In-Reply-To: <14919853.1148078609860.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-237?page=comments#action_12412604 ] 

Doug Cutting commented on HADOOP-237:
-------------------------------------

Here are some quick ideas for what could be interesting statistics to monitor:

Map Input:
  records/second
  bytes/second

Map Output Transferred to Reduce Node;
  records/second
  bytes/second

Reduce Output:
  bytes/second
  records/second

Job Tracker:
  maps tasks launched
  map tasks completed
  reduce tasks launched
  reduce tasks completed

DFS Datanode
  bytes/second written
  bytes/second read
  blocks/second read
  blocks/second written
  blocks replicated
  blocks removed

DFS NameNode
  files created
  files renamed
  files listed
  files opened
  files removed

Is this the sort of thing you had in mind?


> Standard set of Performance Metrics for Hadoop
> ----------------------------------------------
>
>          Key: HADOOP-237
>          URL: http://issues.apache.org/jira/browse/HADOOP-237
>      Project: Hadoop
>         Type: Improvement

>   Components: metrics
>     Versions: 0.3
>  Environment: All
>     Reporter: Milind Bhandarkar
>     Assignee: Milind Bhandarkar

>
> I am starting to use Hadoop's shiny new Metrics API to publish performance (and other) Metrics of running jobs and other daemons.
> Which performance metrics are people interested in seeing ? If possible, please group them according to modules, such as map-reduce, dfs, general-cluster-related etc. I will follow this process:
> 1. collect this list
> 2. assess feasibility of obtaining metric
> 3. assign context/record/metrics names
> 4. seek approval for names
> 5. instrument the code.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 23:11:06 2006
Return-Path: 
 <hadoop-dev-return-1548-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3491 invoked from network); 19 May 2006 23:11:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 23:11:06 -0000
Received: (qmail 18241 invoked by uid 500); 19 May 2006 23:11:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18109 invoked by uid 500); 19 May 2006 23:11:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18099 invoked by uid 99); 19 May 2006 23:11:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:11:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:11:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9E7ED41000F
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 23:10:31 +0000 (GMT)
Message-ID: <20522262.1148080231646.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 23:10:31 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-237) Standard set of Performance Metrics
 for Hadoop
In-Reply-To: <14919853.1148078609860.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-237?page=comments#action_12412607 ] 

Milind Bhandarkar commented on HADOOP-237:
------------------------------------------

Yes, this sort of list is exactly what I had in mind.

> Standard set of Performance Metrics for Hadoop
> ----------------------------------------------
>
>          Key: HADOOP-237
>          URL: http://issues.apache.org/jira/browse/HADOOP-237
>      Project: Hadoop
>         Type: Improvement

>   Components: metrics
>     Versions: 0.3
>  Environment: All
>     Reporter: Milind Bhandarkar
>     Assignee: Milind Bhandarkar

>
> I am starting to use Hadoop's shiny new Metrics API to publish performance (and other) Metrics of running jobs and other daemons.
> Which performance metrics are people interested in seeing ? If possible, please group them according to modules, such as map-reduce, dfs, general-cluster-related etc. I will follow this process:
> 1. collect this list
> 2. assess feasibility of obtaining metric
> 3. assign context/record/metrics names
> 4. seek approval for names
> 5. instrument the code.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 23:15:04 2006
Return-Path: 
 <hadoop-dev-return-1549-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3899 invoked from network); 19 May 2006 23:15:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 23:15:04 -0000
Received: (qmail 20565 invoked by uid 500); 19 May 2006 23:15:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20438 invoked by uid 500); 19 May 2006 23:15:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20429 invoked by uid 99); 19 May 2006 23:15:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:15:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:15:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 829C97142C8
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 23:14:30 +0000 (GMT)
Message-ID: <31168145.1148080470532.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 23:14:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-233) add a http status server for the task
 trackers
In-Reply-To: <29031689.1147997166807.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-233?page=all ]

Owen O'Malley updated HADOOP-233:
---------------------------------

    Attachment: task-tracker-webapp-2.patch

Ok, here is an updated patch. You'll still need to move the src/webapps/mapred to src/webapps/job and copy the hadoop-logo.jpg into src/webapps/static. 



> add a http status server for the task trackers
> ----------------------------------------------
>
>          Key: HADOOP-233
>          URL: http://issues.apache.org/jira/browse/HADOOP-233
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: task-tracker-webapp-2.patch, task-tracker-webapp.patch
>
> I'd like to have:
>   1. a jetty server on each task tracker to serve up logs and status
>   2. the jetty server on the job tracker serve up logs

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 23:29:05 2006
Return-Path: 
 <hadoop-dev-return-1550-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8646 invoked from network); 19 May 2006 23:29:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 23:29:05 -0000
Received: (qmail 39524 invoked by uid 500); 19 May 2006 23:29:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39397 invoked by uid 500); 19 May 2006 23:29:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39388 invoked by uid 99); 19 May 2006 23:29:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:29:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:29:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 07D2F41000E
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 23:28:31 +0000 (GMT)
Message-ID: <8354831.1148081311029.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 23:28:31 +0000 (GMT+00:00)
From: "Gal Nitzan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-24) make Configuration an interface
In-Reply-To: <52371844.1139256627178.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-24?page=comments#action_12412610 ] 

Gal Nitzan commented on HADOOP-24:
----------------------------------

Great, I shall rewrite and submit a new patch for review.

> make Configuration an interface
> -------------------------------
>
>          Key: HADOOP-24
>          URL: http://issues.apache.org/jira/browse/HADOOP-24
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Reporter: Doug Cutting
>  Attachments: HADOOP-24-2.patch, HADOOP-24-3.patch, HADOOP-24-4.patch, HADOOP-24.patch, HADOOP-24.patch
>
> The Configuration class should become an interface, e.g.:
> public interface Configuration {
>   String get(String nam);
>   String set(String name, String value);
>   int getInt(String name);
>   void setInt(String name, int value);
>   float getFloat(String name);
>   void setFloat(String name, float value);
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> An abstract class named ConfigurationBase should be implemented as follows:
> public abstract class ConfigurationBase implements Configuration {
>   abstract public String get(String nam);
>   abstract public String set(String name, String value);
>   public  int getInt(String name) { ... implementation in terms of get(String) ... }
>   public void setInt(String name, int value) {... implementation in terms of set(String, String) ...}
>   public float getFloat(String name)  { ... implementation in terms of get(String) ... }
>   public void setFloat(String name, float value)  {... implementation in terms of set(String, String) ...}
>   //... other utility methods based on get(String) and set(String,String) ...
> }
> A concrete, default implementation will be provided as follows:
> public class ConfigurationImpl implements Writable extends ConfigurationBase {
>   private Properties properties;
>   // implement abstract methods from ConfigurationBase
>   public String get(String name) { ... implemented in terms of props ...}
>   public String set(String name, String value) { .. implemented in terms of props ... }
>   // Writable methods
>   public write(DataOutputStream out);
>   public readFields(DataInputStream in);
>   // permit chaining of configurations
>   public Configuration getDefaults();
>   public void setDefaults(Configuration defaults);
> }
> Only code which creates configurations should need to be updated, so this shouldn't be a huge change.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 23:34:04 2006
Return-Path: 
 <hadoop-dev-return-1551-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9363 invoked from network); 19 May 2006 23:34:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 23:34:04 -0000
Received: (qmail 43707 invoked by uid 500); 19 May 2006 23:34:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43681 invoked by uid 500); 19 May 2006 23:34:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43672 invoked by uid 99); 19 May 2006 23:34:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:34:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:34:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 910507142C8
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 23:33:30 +0000 (GMT)
Message-ID: <25910207.1148081610591.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 23:33:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-233) add a http status server for the
 task trackers
In-Reply-To: <29031689.1147997166807.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-233?page=comments#action_12412611 ] 

Doug Cutting commented on HADOOP-233:
-------------------------------------

Why do you copy the jsp files into the build directory?  That way they wind up in the jar, but only the .class files, .html and .jpg should need to be in the jar, since the .jsp files are pre-compiled, no?

> add a http status server for the task trackers
> ----------------------------------------------
>
>          Key: HADOOP-233
>          URL: http://issues.apache.org/jira/browse/HADOOP-233
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: task-tracker-webapp-2.patch, task-tracker-webapp.patch
>
> I'd like to have:
>   1. a jetty server on each task tracker to serve up logs and status
>   2. the jetty server on the job tracker serve up logs

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 19 23:47:04 2006
Return-Path: 
 <hadoop-dev-return-1552-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10355 invoked from network); 19 May 2006 23:47:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 19 May 2006 23:47:04 -0000
Received: (qmail 47338 invoked by uid 500); 19 May 2006 23:47:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47317 invoked by uid 500); 19 May 2006 23:47:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47308 invoked by uid 99); 19 May 2006 23:47:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:47:04 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 16:47:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8542441000E
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 23:46:30 +0000 (GMT)
Message-ID: <2096709.1148082390543.JavaMail.jira@brutus>
Date: Fri, 19 May 2006 23:46:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-233) add a http status server for the task
 trackers
In-Reply-To: <29031689.1147997166807.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-233?page=all ]
     
Doug Cutting resolved HADOOP-233:
---------------------------------

    Resolution: Fixed

I just committed this.  I changed build.xml to not copy jsp files into the build directory.

Thanks, Owen!

> add a http status server for the task trackers
> ----------------------------------------------
>
>          Key: HADOOP-233
>          URL: http://issues.apache.org/jira/browse/HADOOP-233
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: task-tracker-webapp-2.patch, task-tracker-webapp.patch
>
> I'd like to have:
>   1. a jetty server on each task tracker to serve up logs and status
>   2. the jetty server on the job tracker serve up logs

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May 20 00:08:05 2006
Return-Path: 
 <hadoop-dev-return-1553-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14458 invoked from network); 20 May 2006 00:08:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 May 2006 00:08:05 -0000
Received: (qmail 56765 invoked by uid 500); 20 May 2006 00:08:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56742 invoked by uid 500); 20 May 2006 00:08:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56730 invoked by uid 99); 20 May 2006 00:08:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 17:08:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 17:08:03 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C09C841000F
	for <hadoop-dev@lucene.apache.org>; Sat, 20 May 2006 00:07:30 +0000 (GMT)
Message-ID: <22431093.1148083650785.JavaMail.jira@brutus>
Date: Sat, 20 May 2006 00:07:30 +0000 (GMT+00:00)
From: "Barry Kaplan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-211?page=all ]

Barry Kaplan updated HADOOP-211:
--------------------------------

    Attachment: commons_logging_patch

I needed to get this working with log4j so I quickly ripped out the java.util.logging and replaced it with apache commons. The part I am unsure of is how much configuration of logging do you wish to do from hadoop itself. My opinion is let people configure the log4j the way they want it and hadoop should only choose whatever is available, and log to console if nothing is there (essentially what apache-commons does).

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: commons_logging_patch
>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May 20 03:43:35 2006
Return-Path: 
 <hadoop-dev-return-1555-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55464 invoked from network); 20 May 2006 03:43:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 May 2006 03:43:35 -0000
Received: (qmail 16946 invoked by uid 500); 20 May 2006 03:43:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16817 invoked by uid 500); 20 May 2006 03:43:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16808 invoked by uid 99); 20 May 2006 03:43:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 20:43:35 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 20:43:34 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4K3fPAn034629
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 20:41:25 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=nBBch/8A5hxZl4VN7pfmhfskQAOn9QfETDuclze/+iL8vvrSYK+UXPGcpNQ7CBcz
Received: from [10.0.1.2] ([172.21.179.134]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Fri, 19 May 2006 20:41:24 -0700
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <e1d10fc00605191409i55dd7917oebfcaceb43835c93@mail.gmail.com>
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
 <446E158B.9060203@apache.org> <446E2B89.6090608@getopt.org>
 <e1d10fc00605191409i55dd7917oebfcaceb43835c93@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <01032A58-7240-45A2-8D27-267D9D6301F5@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
Date: Fri, 19 May 2006 18:41:29 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-OriginalArrivalTime: 20 May 2006 03:41:24.0796 (UTC)
 FILETIME=[44AF7FC0:01C67BBF]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Yes, please keep it simple.

I know folks in research with many ideas for how to add features to  
the programming model and we still have a lot of work to do to make  
one job run efficiently.  I think it is best to not make these  
directions harder by adding many features that will need to be  
supported to the scheduler.  Let's master running one job well before  
putting a lot of effort into running lots of jobs.

That said, priority queuing seems simple and separable from my  
concerns.  Interleaving jobs gets more complicated and is something  
I'd be happy to see deferred.  Doing so by default with decaying  
priorities and such doesn't seem like the right trade-off to me.   
This is primarily a batch system.

On May 19, 2006, at 2:09 PM, Paul Sutter wrote:

> right now, i would prefer that we have a really really simple  
> scheme that
> can be done quickly.
>
> being able to run a huge days-long job in the background, such that a
> smaller hours-long job basically takes over and runs to completion,  
> that
> would be a big win.
>
> having multple jobs with time slicing? cool, but only 20% better and
> probably 80% more work.
>
> if we want a thorough scheme, i think eric has the right idea of  
> using one
> of the existing scheduler packages.
>
>
> On 5/19/06, Andrzej Bialecki <ab@getopt.org> wrote:
>>
>> Doug Cutting wrote:
>> > Paul Sutter wrote:
>> >> (1) Allow submission times in the future, enabling the creation of
>> >> "background" jobs. My understanding is that job submission  
>> times are
>> >> used to
>> >> prioritize scheduling. All tasks from a job submitted early run to
>> >> completion before those of a job submitted later. If we could  
>> submit
>> any
>> >> days-long jobs with a submission time in the future, say the year
>> >> 2010, and
>> >> any short hours-long jobs with the current time, that short job  
>> would
>> be
>> >> able to interrupt the long job. Hack? Yes. Useful? I think so.
>> >
>> > I think this is equivalent to adding a job priority, where tasks  
>> with
>> > the highest priority job are run first.  If jobs are at the same
>> > priority, then the first submitted would run.  Adding priority  
>> would
>> > add a bit more complexity, but would also be less of a hack.
>>
>>
>> Hmm.. If you compare it to a Unix scheduler, processes at the same
>> priority have even chances of being run, regardless of which was  
>> started
>> first - not only that, processes undergo a "priority decay", in  
>> that if
>> they are running longer then their priority is lowered - this enables
>> new processes to start quickly (and maybe quickly finish), and then
>> fairly compete with other processes.
>>
>> In our case, this would mean that jobs with the same priority would
>> execute concurrently, sharing available map/reduce slots, and long
>> running jobs would be gradually de-prioritized. This also means  
>> that the
>> first job will slow down when the second one is started, but the  
>> second
>> job will have a chance to make a good start (and perhaps quickly  
>> finish)
>> and then, subject to the priority decay, run in parallel with  
>> other jobs
>> (albeit slower) instead of being stuck in the wait queue.
>>
>> And if the second job is started with a higher priority, it should
>> preempt the first job (i.e. it should get proportionally more  
>> slots than
>> the first job). If you need all cluster resources for a specific job,
>> and don't want any other jobs to run, just set the priority to the
>> highest value, thus preempting all other jobs (actually, it would
>> suspend other already executing jobs, which would resume when your  
>> job
>> is done - not a bad feature either!).
>>
>> I think this is a relatively simple and well understood mechanism.
>>
>>
>> >> (2) Have a per-job total task count limit. Currently, we  
>> establish the
>> >> number of tasks each node runs, and how many map or reduce  
>> tasks we
>> have
>> >> total in a given job. But it would be great if we could set a  
>> ceiling
>> >> on the
>> >> number of tasks that run concurrently for a given job. This may  
>> help
>> >> with
>> >> Andrzej's fetcher (since it is bandwidth constrained, maybe fewer
>> >> concurrent
>> >> jobs would be fine?).
>> >
>> > I like this idea.  So if the highest-priority job is already  
>> running
>> > at its task limit, then tasks can be run from the next
>> > highest-priority job.  Should there be separate limits for maps and
>> > reduces?
>>
>> I like this idea too. I think a similar setting for the minimum  
>> number
>> of tasks would be needed too? That would solve my problem. In  
>> fact, it
>> would be probably better than the schema I described above,  
>> because it
>> would guarantee certain minimum tasks running at any time.
>>
>> This reminds me of the "idle time" and "real time" policies in BSD
>> scheduler ... man 1 rtprio. The "real time" policy prevents the  
>> priority
>> decay that normally occurs, and "idle time" policy allows  
>> processes to
>> run only if CPU is idle.
>>
>> --
>> Best regards,
>> Andrzej Bialecki     <><
>> ___. ___ ___ ___ _ _   __________________________________
>> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
>> ___|||__||  \|  ||  |  Embedded Unix, System Integration
>> http://www.sigram.com  Contact: info at sigram dot com
>>
>>
>>


From MAILER-DAEMON Sat May 20 03:43:34 2006
Return-Path: 
 <hadoop-dev-return-1554-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55442 invoked from network); 20 May 2006 03:43:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 May 2006 03:43:34 -0000
Received: (qmail 16706 invoked by uid 500); 20 May 2006 03:43:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16673 invoked by uid 500); 20 May 2006 03:43:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16664 invoked by uid 99); 20 May 2006 03:43:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 20:43:33 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 May 2006 20:43:33 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4K3fSQu034637
	for <hadoop-dev@lucene.apache.org>; Fri, 19 May 2006 20:41:28 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=vl8CUfWRIxaTQy7jpClMGpWWVLB2D/weg5PST3uBlC+FgQ1WE944Jb50/0k3giDH
Received: from [10.0.1.2] ([172.21.179.134]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Fri, 19 May 2006 20:41:28 -0700
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <22977378.1148066309828.JavaMail.jira@brutus>
References: <22977378.1148066309828.JavaMail.jira@brutus>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <C536C700-157D-4E70-A42F-93DABF700E6E@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Created: (HADOOP-236) job tracker should refuse connection
 from a task tracker with a different version number
Date: Fri, 19 May 2006 18:49:58 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-OriginalArrivalTime: 20 May 2006 03:41:28.0108 (UTC)
 FILETIME=[46A8DEC0:01C67BBF]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

And log / report the problem of course!

On May 19, 2006, at 12:18 PM, Hairong Kuang (JIRA) wrote:

> job tracker should refuse connection from a task tracker with a  
> different version number
> ---------------------------------------------------------------------- 
> ------------------
>
>          Key: HADOOP-236
>          URL: http://issues.apache.org/jira/browse/HADOOP-236
>      Project: Hadoop
>         Type: Bug
>
>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Hairong Kuang
>
>
> After one mapred system upgrade, we noticed that all tasks assigned  
> to one task tracker failed. It turned out that for some reason the  
> task tracker was not upgraded.
>
> To avoid this, a task tracker should reports its version # when it  
> registers itsself with a job tracker. If the job tracker receives  
> an inconsistent version #, it should refuse the connection.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Sun May 21 06:24:06 2006
Return-Path: 
 <hadoop-dev-return-1556-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7579 invoked from network); 21 May 2006 06:24:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 May 2006 06:24:06 -0000
Received: (qmail 10961 invoked by uid 500); 21 May 2006 06:24:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10932 invoked by uid 500); 21 May 2006 06:24:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10922 invoked by uid 99); 21 May 2006 06:24:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 20 May 2006 23:24:05 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 20 May 2006 23:24:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DA99A7141F2
	for <hadoop-dev@lucene.apache.org>; Sun, 21 May 2006 06:23:29 +0000 (GMT)
Message-ID: <32406774.1148192609892.JavaMail.jira@brutus>
Date: Sun, 21 May 2006 06:23:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-238) map outputs transfers fail with
 EOFException
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

map outputs transfers fail with EOFException
--------------------------------------------

         Key: HADOOP-238
         URL: http://issues.apache.org/jira/browse/HADOOP-238
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.3    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Blocker
     Fix For: 0.3


My patch on Friday unintentionally included part of my explorations with the file transfers, which broke map output transfers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May 21 06:29:08 2006
Return-Path: 
 <hadoop-dev-return-1557-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8817 invoked from network); 21 May 2006 06:29:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 May 2006 06:29:08 -0000
Received: (qmail 15072 invoked by uid 500); 21 May 2006 06:29:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15050 invoked by uid 500); 21 May 2006 06:29:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15038 invoked by uid 99); 21 May 2006 06:29:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 20 May 2006 23:29:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 20 May 2006 23:29:06 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AA8817141F2
	for <hadoop-dev@lucene.apache.org>; Sun, 21 May 2006 06:28:30 +0000 (GMT)
Message-ID: <7206910.1148192910695.JavaMail.jira@brutus>
Date: Sun, 21 May 2006 06:28:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-238) map outputs transfers fail with
 EOFException
In-Reply-To: <32406774.1148192609892.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-238?page=all ]

Owen O'Malley updated HADOOP-238:
---------------------------------

    Attachment: transfer.patch

This makes the map output location use the "real" task tracker port rather than the http port.

> map outputs transfers fail with EOFException
> --------------------------------------------
>
>          Key: HADOOP-238
>          URL: http://issues.apache.org/jira/browse/HADOOP-238
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Blocker
>      Fix For: 0.3
>  Attachments: transfer.patch
>
> My patch on Friday unintentionally included part of my explorations with the file transfers, which broke map output transfers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun May 21 18:23:03 2006
Return-Path: 
 <hadoop-dev-return-1558-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8985 invoked from network); 21 May 2006 18:23:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 May 2006 18:23:03 -0000
Received: (qmail 66260 invoked by uid 500); 21 May 2006 18:23:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66132 invoked by uid 500); 21 May 2006 18:23:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66123 invoked by uid 99); 21 May 2006 18:23:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 21 May 2006 11:23:02 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=RCVD_IN_SORBS_WEB,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of rbt@sitesell.com designates
 216.95.221.3 as permitted sender)
Received: from [216.95.221.3] (HELO server2.sitesell.com) (216.95.221.3)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 21 May 2006 11:23:01 -0700
Received: (qmail 23941 invoked by uid 223); 21 May 2006 18:22:32 -0000
Received: from 209.161.220.31 by server2.sitesell.com (envelope-from
 <rbt@sitesell.com>, uid 101) with qmail-scanner-1.25
 (clamdscan: 0.81/685. spamassassin: 3.0.1.  
 Clear:RC:1(209.161.220.31):.
 Processed in 0.026923 secs); 21 May 2006 18:22:32 -0000
Received: from 209-161-220-31.dsl.look.ca (209-161-220-31.dsl.look.ca
 [209.161.220.31])
  by server2.sitesell.com ([216.95.221.3])
  with ESMTP via TCP; 21 May 2006 18:22:32 -0000
Subject: Re: Job scheduling (Re: Unable to run more than one job
	concurrently)
From: Rod Taylor <rbt@sitesell.com>
To: hadoop-dev@lucene.apache.org
In-Reply-To: <446E158B.9060203@apache.org>
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
	 <446E158B.9060203@apache.org>
Content-Type: text/plain
Date: Sun, 21 May 2006 14:22:14 -0400
Message-Id: <1148235734.74169.31.camel@home>
Mime-Version: 1.0
X-Mailer: Evolution 2.6.1 FreeBSD GNOME Team Port 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


> > (2) Have a per-job total task count limit. Currently, we establish the
> > number of tasks each node runs, and how many map or reduce tasks we have
> > total in a given job. But it would be great if we could set a ceiling on the
> > number of tasks that run concurrently for a given job. This may help with
> > Andrzej's fetcher (since it is bandwidth constrained, maybe fewer concurrent
> > jobs would be fine?).
> 
> I like this idea.  So if the highest-priority job is already running at 
> its task limit, then tasks can be run from the next highest-priority 
> job.  Should there be separate limits for maps and reduces?

Limits for map and reduce are useful for a job class. Not so much for a
specific job instance.  Data collection may be best achieved with 15
parallel maps pulling data from remote data sources. But if the fact
there are 3 from one job and 12 from another isn't important. It's
important that 15 makes best use of resources.

A different priority for map and reduce would also be useful. Many times
data collection in a set timeframe is far more important than reducing
it for storage or post processing, particularly when data collection is
retrieving it from a remote resource.


Data warehousing activities often require that data collection occur
once a night between set hours (very high priority) but processing of
the data collected can occur any time until the end of the quarter.


For Nutch, with both of the above you should be able to achieve N number
of Fetch Map processes running at all times with everything else being
secondary within the remaining resources. This could make use of 100% of
available remote bandwidth.

-- 
Rod Taylor <rbt@sitesell.com>


From MAILER-DAEMON Mon May 22 04:12:14 2006
Return-Path: 
 <hadoop-dev-return-1559-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36853 invoked from network); 22 May 2006 04:12:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 May 2006 04:12:14 -0000
Received: (qmail 91760 invoked by uid 500); 22 May 2006 04:12:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91735 invoked by uid 500); 22 May 2006 04:12:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91725 invoked by uid 99); 22 May 2006 04:12:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 21 May 2006 21:12:13 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 21 May 2006 21:12:12 -0700
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4M4BN3m086121
	for <hadoop-dev@lucene.apache.org>; Sun, 21 May 2006 21:11:23 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=SY1Z5ZKrKQSQ6FcIeXH5NubESQt2pl9r7vWPlUMGbjm0rc23IgT2VikJREwKS2x7
Received: from [10.0.1.2] ([172.21.179.131]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Sun, 21 May 2006 21:11:22 -0700
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <1148235734.74169.31.camel@home>
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
 <446E158B.9060203@apache.org> <1148235734.74169.31.camel@home>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <D1D92A67-31FA-402D-9F13-69C804553705@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: Job scheduling (Re: Unable to run more than one job concurrently)
Date: Sun, 21 May 2006 21:11:23 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-OriginalArrivalTime: 22 May 2006 04:11:22.0900 (UTC)
 FILETIME=[C943E540:01C67D55]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

??

You have no guarantee that your time sensitive data is safe /  
committed until after your reduce has completed.  If you care about  
reliability or data integrity, simply run a full map-reduce job in  
your collection window and store the result in the HDFS.

Do expensive post processing you have a quarter to complete as  
another job.  Being able to preempt a long job with a time sensitive  
short job seems to really be your requirement.

On May 21, 2006, at 11:22 AM, Rod Taylor wrote:

>
>>> (2) Have a per-job total task count limit. Currently, we  
>>> establish the
>>> number of tasks each node runs, and how many map or reduce tasks  
>>> we have
>>> total in a given job. But it would be great if we could set a  
>>> ceiling on the
>>> number of tasks that run concurrently for a given job. This may  
>>> help with
>>> Andrzej's fetcher (since it is bandwidth constrained, maybe fewer  
>>> concurrent
>>> jobs would be fine?).
>>
>> I like this idea.  So if the highest-priority job is already  
>> running at
>> its task limit, then tasks can be run from the next highest-priority
>> job.  Should there be separate limits for maps and reduces?
>
> Limits for map and reduce are useful for a job class. Not so much  
> for a
> specific job instance.  Data collection may be best achieved with 15
> parallel maps pulling data from remote data sources. But if the fact
> there are 3 from one job and 12 from another isn't important. It's
> important that 15 makes best use of resources.
>
> A different priority for map and reduce would also be useful. Many  
> times
> data collection in a set timeframe is far more important than reducing
> it for storage or post processing, particularly when data  
> collection is
> retrieving it from a remote resource.
>
>
> Data warehousing activities often require that data collection occur
> once a night between set hours (very high priority) but processing of
> the data collected can occur any time until the end of the quarter.
>
>
> For Nutch, with both of the above you should be able to achieve N  
> number
> of Fetch Map processes running at all times with everything else being
> secondary within the remaining resources. This could make use of  
> 100% of
> available remote bandwidth.
>
> -- 
> Rod Taylor <rbt@sitesell.com>
>


From MAILER-DAEMON Mon May 22 04:29:54 2006
Return-Path: 
 <hadoop-dev-return-1560-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40474 invoked from network); 22 May 2006 04:29:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 May 2006 04:29:54 -0000
Received: (qmail 99323 invoked by uid 500); 22 May 2006 04:29:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99302 invoked by uid 500); 22 May 2006 04:29:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99291 invoked by uid 99); 22 May 2006 04:29:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 21 May 2006 21:29:53 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=RCVD_IN_SORBS_WEB,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of rbt@sitesell.com designates
 216.95.221.3 as permitted sender)
Received: from [216.95.221.3] (HELO server2.sitesell.com) (216.95.221.3)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 21 May 2006 21:29:52 -0700
Received: (qmail 24446 invoked by uid 223); 22 May 2006 04:29:31 -0000
Received: from 209.161.220.31 by server2.sitesell.com (envelope-from
 <rbt@sitesell.com>, uid 101) with qmail-scanner-1.25
 (clamdscan: 0.81/685. spamassassin: 3.0.1.  
 Clear:RC:1(209.161.220.31):.
 Processed in 0.040713 secs); 22 May 2006 04:29:31 -0000
Received: from 209-161-220-31.dsl.look.ca (209-161-220-31.dsl.look.ca
 [209.161.220.31])
  by server2.sitesell.com ([216.95.221.3])
  with ESMTP via TCP; 22 May 2006 04:29:31 -0000
Subject: Re: Job scheduling (Re: Unable to run more than one job
	concurrently)
From: Rod Taylor <rbt@sitesell.com>
To: hadoop-dev@lucene.apache.org
In-Reply-To: <D1D92A67-31FA-402D-9F13-69C804553705@yahoo-inc.com>
References: <20060519180104.D58BC10FB004@asf.osuosl.org>
	 <446E158B.9060203@apache.org> <1148235734.74169.31.camel@home>
	 <D1D92A67-31FA-402D-9F13-69C804553705@yahoo-inc.com>
Content-Type: text/plain
Date: Mon, 22 May 2006 00:29:16 -0400
Message-Id: <1148272156.74169.181.camel@home>
Mime-Version: 1.0
X-Mailer: Evolution 2.6.1 FreeBSD GNOME Team Port 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

> You have no guarantee that your time sensitive data is safe /  
> committed until after your reduce has completed.  If you care about  
> reliability or data integrity, simply run a full map-reduce job in  
> your collection window and store the result in the HDFS.

Perhaps I explained incorrectly. It's NOT the data that is time
sensitive it is the resource availability that is time sensitive. With a
given availability window for retrieval. So long as sorting is a
requirement of reduce, the overhead of saving is going to remain
significant.

> Do expensive post processing you have a quarter to complete as  
> another job.  Being able to preempt a long job with a time sensitive  
> short job seems to really be your requirement.

Fetch has the same problem. Running fetches end-to-end (starting a new
one the instant a previous has finished) you end up with lulls between
fetches. For me this is about 15% of the time (15% wasted bandwidth
since you pay a flat rate).

My machines all have 12GB ram -- temporary storage is in memory -- and
reasonably fast processors. I really don't want to hold up a new fetch
map for a previous rounds fetch reduce.

> On May 21, 2006, at 11:22 AM, Rod Taylor wrote:
> 
> >
> >>> (2) Have a per-job total task count limit. Currently, we  
> >>> establish the
> >>> number of tasks each node runs, and how many map or reduce tasks  
> >>> we have
> >>> total in a given job. But it would be great if we could set a  
> >>> ceiling on the
> >>> number of tasks that run concurrently for a given job. This may  
> >>> help with
> >>> Andrzej's fetcher (since it is bandwidth constrained, maybe fewer  
> >>> concurrent
> >>> jobs would be fine?).
> >>
> >> I like this idea.  So if the highest-priority job is already  
> >> running at
> >> its task limit, then tasks can be run from the next highest-priority
> >> job.  Should there be separate limits for maps and reduces?
> >
> > Limits for map and reduce are useful for a job class. Not so much  
> > for a
> > specific job instance.  Data collection may be best achieved with 15
> > parallel maps pulling data from remote data sources. But if the fact
> > there are 3 from one job and 12 from another isn't important. It's
> > important that 15 makes best use of resources.
> >
> > A different priority for map and reduce would also be useful. Many  
> > times
> > data collection in a set timeframe is far more important than reducing
> > it for storage or post processing, particularly when data  
> > collection is
> > retrieving it from a remote resource.
> >
> >
> > Data warehousing activities often require that data collection occur
> > once a night between set hours (very high priority) but processing of
> > the data collected can occur any time until the end of the quarter.
> >
> >
> > For Nutch, with both of the above you should be able to achieve N  
> > number
> > of Fetch Map processes running at all times with everything else being
> > secondary within the remaining resources. This could make use of  
> > 100% of
> > available remote bandwidth.
> >
> > -- 
> > Rod Taylor <rbt@sitesell.com>
> >
> 
> 
-- 
Rod Taylor <rbt@sitesell.com>


From MAILER-DAEMON Mon May 22 17:30:08 2006
Return-Path: 
 <hadoop-dev-return-1561-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93283 invoked from network); 22 May 2006 17:30:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 May 2006 17:30:08 -0000
Received: (qmail 42447 invoked by uid 500); 22 May 2006 17:30:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42421 invoked by uid 500); 22 May 2006 17:30:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42412 invoked by uid 99); 22 May 2006 17:30:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 10:30:07 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 10:30:07 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D86EC410007
	for <hadoop-dev@lucene.apache.org>; Mon, 22 May 2006 17:29:29 +0000 (GMT)
Message-ID: <7996228.1148318969883.JavaMail.jira@brutus>
Date: Mon, 22 May 2006 17:29:29 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-239) job tracker WI drops jobs after 24
 hours
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

job tracker WI drops jobs after 24 hours
----------------------------------------

         Key: HADOOP-239
         URL: http://issues.apache.org/jira/browse/HADOOP-239
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Yoram Arnon
    Priority: Minor


The jobtracker's WI, keeps track of jobs executed in the past 24 hours.
if the cluster was idle for a day (say Sunday) it drops all its history.
Monday morning, the page is empty.
Better would be to store a fixed number of jobs (say 10 each of succeeded and failed jobs).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 22 19:21:09 2006
Return-Path: 
 <hadoop-dev-return-1562-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36252 invoked from network); 22 May 2006 19:21:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 May 2006 19:21:09 -0000
Received: (qmail 6685 invoked by uid 500); 22 May 2006 19:21:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6658 invoked by uid 500); 22 May 2006 19:21:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6649 invoked by uid 99); 22 May 2006 19:21:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 12:21:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 12:21:07 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8FAB6410006
	for <hadoop-dev@lucene.apache.org>; Mon, 22 May 2006 19:20:30 +0000 (GMT)
Message-ID: <26424483.1148325630585.JavaMail.jira@brutus>
Date: Mon, 22 May 2006 19:20:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-235) LocalFileSystem.openRaw() throws the
 wrong string for FileNotFoundException
In-Reply-To: <10557622.1148064449849.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-235?page=comments#action_12412819 ] 

Owen O'Malley commented on HADOOP-235:
--------------------------------------

I agree that this change helps a lot.

> LocalFileSystem.openRaw() throws the wrong string for FileNotFoundException
> ---------------------------------------------------------------------------
>
>          Key: HADOOP-235
>          URL: http://issues.apache.org/jira/browse/HADOOP-235
>      Project: Hadoop
>         Type: Bug

>     Reporter: Benjamin Reed
>  Attachments: missing-f.patch
>
> openRaw should throw f.toString() on an error, not toString().

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 22 22:04:11 2006
Return-Path: 
 <hadoop-dev-return-1563-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85357 invoked from network); 22 May 2006 22:04:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 May 2006 22:04:11 -0000
Received: (qmail 41918 invoked by uid 500); 22 May 2006 22:04:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41898 invoked by uid 500); 22 May 2006 22:04:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41889 invoked by uid 99); 22 May 2006 22:04:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 15:04:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 15:04:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8E78B41000A
	for <hadoop-dev@lucene.apache.org>; Mon, 22 May 2006 22:03:31 +0000 (GMT)
Message-ID: <65665.1148335411580.JavaMail.jira@brutus>
Date: Mon, 22 May 2006 22:03:31 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
In-Reply-To: <6140265.1148030971246.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-234?page=comments#action_12412836 ] 

Owen O'Malley commented on HADOOP-234:
--------------------------------------

I agree with Doug that if you are going to throw away the advantages of actually having meaningful types on the C++ that the keys and values on the Java side should be BytesWritable. 

That said, I think it would be much less error-prone for the users and easier to understand and debug if you followed the Hadoop API much closer. Define a Writable and WritableComparable interfaces in C++. The Record IO classes will support them with a minor change to the code generator. 

> Support for writing Map/Reduce functions in C++
> -----------------------------------------------
>
>          Key: HADOOP-234
>          URL: http://issues.apache.org/jira/browse/HADOOP-234
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Sanjay Dahiya

>
> MapReduce C++ support
> Requirements 
> 1. Allow users to write Map and Reduce functions in C++, rest of the 
> infrastructure already present in Java should be reused. 
> 2. Avoid users having to write both Java and C++ for this to work. 
> 3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
> 4. Use Record IO for describing record format, both MR java framework and C++ should 
> 	use the same format to work seemlessly. 
> 5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
> 	simple strings. 
> Implementation notes
> - If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
> 	mapper and reducer methods in C++. 
> - For composite Record IO types user starts with defining a record format using Record IO DDL. 
> - User generates Java and C++ classes from the DDL using record IO. 
> - Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
> - User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
>   makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
>   generated C++ record IO classes. 
> - User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 
> Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 
> Native(JNI) Java proxy for the Mapper : 
> ---------------------------------------
> Without Record IO :-
> --------------------
> public class SimpleNativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	  * Works on simple strings. 
> 	  **/
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		mapNative(key.toString().getBytes()
> 				, value.toString().getBytes(), output, reporter); 
> 	}
> 	
> 	/**
> 	  * Native implementation. 
> 	  **/
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> With Record IO :- 
> ------------------
> public class RecordIONativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	 * Implementation of map method, this acts as a JNI proxy for actual map 
> 	 * method implemented in C++. Works for Record IO based records. 
> 	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
> 	 */
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		
> 		byte[] keyBytes = null ;
> 		byte[] valueBytes = null ;
> 		
> 		try{
> 			// we need to serialize the key and record and pass the serialized 
> 			// format to C++ / JNI methods so they can interpret it using appropriate 
> 			// record IO classes. 
> 			{
> 				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				keyBytes = keyStream.toByteArray();
> 			}
> 			{
> 				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				valueBytes = valueStream.toByteArray();
> 			}
> 		}catch(ClassCastException e){
> 			// throw better exceptions
> 			throw new IOException("Input record must be of Record IO Type"); 
> 		}
> 		// pass the serialized byte[] to C++ implementation. 
> 		mapNative(keyBytes, valueBytes, output, reporter); 
> 	}
> 	/**
> 	 * Implementation in C++.
> 	 */
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> OutputCollector Proxy for C++
> ------------------------------
> public class NativeOutputCollector implements OutputCollector {
> 	// standard method from interface
> 	public void collect(WritableComparable key, Writable value)
> 			throws IOException {
> 	}
> 	
> 	// deserializes key and value and calls collect(WritableComparable, Writable)
> 	public void collectFromNative(byte[]key, byte[]value){
> 		// deserialize key and value to java types ( as configured in JobConf )
> 		// call actual collect method 
> 	}
> }
> Core Native functions ( helper for user provided Mapper and Reducer ) 
> ---------------------------------------------------------------------
> #include "org_apache_hadoop_mapred_NativeMapper.h"
> #include "UserMapper.h"
> /**
> 	* A C++ proxy method, calls actual implementation of the Mapper. This method 
> 	signature is generated by javah.
> **/
> JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
>   (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
>   	jobject output_collector, jobject reporter);
> {
>  
>  	// convert char* and pass on to user defined map method. 
>  	// user's map method should take care of converting it to correct record IO 
>  	// type.
>  	int keyLen = (*env)->GetArrayLength(env, key) ;
>  	int valueLen = (*env)->GetArrayLength(env, valueLen) ;
>  	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
>  	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
>  	
>  	// Call User defined method 
>  	user_map(keyBuf, valueBuf, output_collector, reporter) ;
>  	
>  	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
>  	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
> }
> /**
> 	Helper method, acts as a proxy to OutputCollector in java. key and value 
> 	must be serialized forms of records as specified in JobConf. 
> **/
> void output_collector(const char * key, const char *value,
> 	jobject output_collector, jobject reporter){
> 	
> 	// invoke java NativeOutputCollector.collect with key and value. 
> }
> User defined Mapper ( and Reducer ) 
> ------------------------------------
> /**
> 	implements user defined map operation. 
> **/
> void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {
> 	//1. deserialize key/value in the appropriate format using record IO. 
> 	
> 	//2. process key/value and generate the intermediate key/values in record IO format. 
> 	
> 	//3. Deserialize intermediate key/values to intermed_key and intermed_value
> 	
> 	//4. pass intermed_key/intermed_value using helper function - 
> 	// 		output_collector(intermed_key, intermed_value, collector, recorder);
> 	
> 	
> }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 22 23:35:09 2006
Return-Path: 
 <hadoop-dev-return-1564-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21020 invoked from network); 22 May 2006 23:35:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 May 2006 23:35:09 -0000
Received: (qmail 73331 invoked by uid 500); 22 May 2006 23:35:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73307 invoked by uid 500); 22 May 2006 23:35:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73292 invoked by uid 99); 22 May 2006 23:35:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 16:35:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 16:35:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8F0D3410008
	for <hadoop-dev@lucene.apache.org>; Mon, 22 May 2006 23:34:30 +0000 (GMT)
Message-ID: <27655627.1148340870583.JavaMail.jira@brutus>
Date: Mon, 22 May 2006 23:34:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-238) map outputs transfers fail with
 EOFException
In-Reply-To: <32406774.1148192609892.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-238?page=all ]
     
Doug Cutting resolved HADOOP-238:
---------------------------------

    Resolution: Fixed

I just committed this.

> map outputs transfers fail with EOFException
> --------------------------------------------
>
>          Key: HADOOP-238
>          URL: http://issues.apache.org/jira/browse/HADOOP-238
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Blocker
>      Fix For: 0.3
>  Attachments: transfer.patch
>
> My patch on Friday unintentionally included part of my explorations with the file transfers, which broke map output transfers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 02:48:10 2006
Return-Path: 
 <hadoop-dev-return-1565-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80623 invoked from network); 23 May 2006 02:48:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 02:48:10 -0000
Received: (qmail 31815 invoked by uid 500); 23 May 2006 02:48:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31787 invoked by uid 500); 23 May 2006 02:48:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31778 invoked by uid 99); 23 May 2006 02:48:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 19:48:08 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 19:48:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 961D6410006
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 02:47:30 +0000 (GMT)
Message-ID: <24335137.1148352450612.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 02:47:30 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-239) job tracker WI drops jobs after 24
 hours
In-Reply-To: <7996228.1148318969883.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-239?page=comments#action_12412854 ] 

eric baldeschwieler commented on HADOOP-239:
--------------------------------------------

More please.

> job tracker WI drops jobs after 24 hours
> ----------------------------------------
>
>          Key: HADOOP-239
>          URL: http://issues.apache.org/jira/browse/HADOOP-239
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Priority: Minor

>
> The jobtracker's WI, keeps track of jobs executed in the past 24 hours.
> if the cluster was idle for a day (say Sunday) it drops all its history.
> Monday morning, the page is empty.
> Better would be to store a fixed number of jobs (say 10 each of succeeded and failed jobs).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 04:09:10 2006
Return-Path: 
 <hadoop-dev-return-1566-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95797 invoked from network); 23 May 2006 04:09:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 04:09:10 -0000
Received: (qmail 2751 invoked by uid 500); 23 May 2006 04:09:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2625 invoked by uid 500); 23 May 2006 04:09:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2616 invoked by uid 99); 23 May 2006 04:09:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 21:09:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 21:09:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9F1777141FA
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 04:08:30 +0000 (GMT)
Message-ID: <19068667.1148357310648.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 04:08:30 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-205) the job tracker does not schedule
 enough map on the cluster
In-Reply-To: <10031675.1147208284547.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-205?page=all ]

Mahadev konar updated HADOOP-205:
---------------------------------

    Attachment: maplaunch.patch

This patch allows map/reduce jobs to be scheduled using the pending load rather than the current load. Also, I have made changes in the JobInProgress to keep a running count of number of running/finished maps/reduces.

> the job tracker does not schedule enough map on the cluster
> -----------------------------------------------------------
>
>          Key: HADOOP-205
>          URL: http://issues.apache.org/jira/browse/HADOOP-205
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4
>  Attachments: maplaunch.patch
>
> The job tracker during my big sort runs only has 80-120 maps running at a time with 2 tasks/node and 179 nodes and a large queue of map tasks. It seems to be caused by the load balancing using the current load rather than the required load to run all of the queued tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 06:30:10 2006
Return-Path: 
 <hadoop-dev-return-1567-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26229 invoked from network); 23 May 2006 06:30:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 06:30:10 -0000
Received: (qmail 23357 invoked by uid 500); 23 May 2006 06:30:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23333 invoked by uid 500); 23 May 2006 06:30:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23323 invoked by uid 99); 23 May 2006 06:30:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 23:30:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 May 2006 23:30:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A008E7141E4
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 06:29:30 +0000 (GMT)
Message-ID: <12578724.1148365770652.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 06:29:30 +0000 (GMT+00:00)
From: "Sanjay Dahiya (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
In-Reply-To: <6140265.1148030971246.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-234?page=comments#action_12412870 ] 

Sanjay Dahiya commented on HADOOP-234:
--------------------------------------

I agree that  keys/values should be BytesWritable in case we are not using typed data (Records). But I am trying to understand how to to avoid serialization/de-serialization multiple times between Java and C++ and still use Record IO. 
So when we define a new record format and generate classes to work with the record, the generated classes contain Reader and Writer for the record. These read/write 'Record' objects from streams. One way to implement this would be to modify the class generation and make Reader extend SequenceInputFile and return(optionally) a ByetWritable rather than a Record. The idea is that the Record know how to read itself and its size etc. so we let it read from the input but it reads in BytesWritable rather than the record type in Java. we pass this BytesWritable to C++ and do deserialization only once to get the right type. 
With this in place we should be able to avoid the need for serialization/de-serialization and users will not need to write extra code per type of record. 

> Support for writing Map/Reduce functions in C++
> -----------------------------------------------
>
>          Key: HADOOP-234
>          URL: http://issues.apache.org/jira/browse/HADOOP-234
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Sanjay Dahiya

>
> MapReduce C++ support
> Requirements 
> 1. Allow users to write Map and Reduce functions in C++, rest of the 
> infrastructure already present in Java should be reused. 
> 2. Avoid users having to write both Java and C++ for this to work. 
> 3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
> 4. Use Record IO for describing record format, both MR java framework and C++ should 
> 	use the same format to work seemlessly. 
> 5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
> 	simple strings. 
> Implementation notes
> - If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
> 	mapper and reducer methods in C++. 
> - For composite Record IO types user starts with defining a record format using Record IO DDL. 
> - User generates Java and C++ classes from the DDL using record IO. 
> - Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
> - User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
>   makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
>   generated C++ record IO classes. 
> - User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 
> Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 
> Native(JNI) Java proxy for the Mapper : 
> ---------------------------------------
> Without Record IO :-
> --------------------
> public class SimpleNativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	  * Works on simple strings. 
> 	  **/
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		mapNative(key.toString().getBytes()
> 				, value.toString().getBytes(), output, reporter); 
> 	}
> 	
> 	/**
> 	  * Native implementation. 
> 	  **/
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> With Record IO :- 
> ------------------
> public class RecordIONativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	 * Implementation of map method, this acts as a JNI proxy for actual map 
> 	 * method implemented in C++. Works for Record IO based records. 
> 	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
> 	 */
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		
> 		byte[] keyBytes = null ;
> 		byte[] valueBytes = null ;
> 		
> 		try{
> 			// we need to serialize the key and record and pass the serialized 
> 			// format to C++ / JNI methods so they can interpret it using appropriate 
> 			// record IO classes. 
> 			{
> 				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				keyBytes = keyStream.toByteArray();
> 			}
> 			{
> 				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				valueBytes = valueStream.toByteArray();
> 			}
> 		}catch(ClassCastException e){
> 			// throw better exceptions
> 			throw new IOException("Input record must be of Record IO Type"); 
> 		}
> 		// pass the serialized byte[] to C++ implementation. 
> 		mapNative(keyBytes, valueBytes, output, reporter); 
> 	}
> 	/**
> 	 * Implementation in C++.
> 	 */
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> OutputCollector Proxy for C++
> ------------------------------
> public class NativeOutputCollector implements OutputCollector {
> 	// standard method from interface
> 	public void collect(WritableComparable key, Writable value)
> 			throws IOException {
> 	}
> 	
> 	// deserializes key and value and calls collect(WritableComparable, Writable)
> 	public void collectFromNative(byte[]key, byte[]value){
> 		// deserialize key and value to java types ( as configured in JobConf )
> 		// call actual collect method 
> 	}
> }
> Core Native functions ( helper for user provided Mapper and Reducer ) 
> ---------------------------------------------------------------------
> #include "org_apache_hadoop_mapred_NativeMapper.h"
> #include "UserMapper.h"
> /**
> 	* A C++ proxy method, calls actual implementation of the Mapper. This method 
> 	signature is generated by javah.
> **/
> JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
>   (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
>   	jobject output_collector, jobject reporter);
> {
>  
>  	// convert char* and pass on to user defined map method. 
>  	// user's map method should take care of converting it to correct record IO 
>  	// type.
>  	int keyLen = (*env)->GetArrayLength(env, key) ;
>  	int valueLen = (*env)->GetArrayLength(env, valueLen) ;
>  	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
>  	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
>  	
>  	// Call User defined method 
>  	user_map(keyBuf, valueBuf, output_collector, reporter) ;
>  	
>  	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
>  	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
> }
> /**
> 	Helper method, acts as a proxy to OutputCollector in java. key and value 
> 	must be serialized forms of records as specified in JobConf. 
> **/
> void output_collector(const char * key, const char *value,
> 	jobject output_collector, jobject reporter){
> 	
> 	// invoke java NativeOutputCollector.collect with key and value. 
> }
> User defined Mapper ( and Reducer ) 
> ------------------------------------
> /**
> 	implements user defined map operation. 
> **/
> void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {
> 	//1. deserialize key/value in the appropriate format using record IO. 
> 	
> 	//2. process key/value and generate the intermediate key/values in record IO format. 
> 	
> 	//3. Deserialize intermediate key/values to intermed_key and intermed_value
> 	
> 	//4. pass intermed_key/intermed_value using helper function - 
> 	// 		output_collector(intermed_key, intermed_value, collector, recorder);
> 	
> 	
> }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 11:37:11 2006
Return-Path: 
 <hadoop-dev-return-1568-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24382 invoked from network); 23 May 2006 11:37:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 11:37:11 -0000
Received: (qmail 37166 invoked by uid 500); 23 May 2006 11:37:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37138 invoked by uid 500); 23 May 2006 11:37:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37129 invoked by uid 99); 23 May 2006 11:37:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 04:37:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 04:37:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8E815714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 11:36:30 +0000 (GMT)
Message-ID: <2286708.1148384190580.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 11:36:30 +0000 (GMT+00:00)
From: "Arun C Murthy (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12412915 ] 

Arun C Murthy commented on HADOOP-210:
--------------------------------------

I'm exploring possible solutions to this problem, kicking off a discussion...

a) Procrastinate

  Get a really beefy 64-bit namenode. 
  Run it with lots of RAM in 64-bit (assuming none of the code needs changes and the JVM works) or with (almost) full 4GB virtual address space in 32-bit mode.

b) Thread pool
   
  i) Create one thread-per (persistent) connection for the datanodes and then use a thread-pool to handle incoming client-connections. It would ensure that only during times of very high memory usage incoming client connections are penalized while the datanodes themselves have a persistent connection to the namenode.

  ii) Everyone (clients & datanodes) go through the (possibly separate) thread-pool(s).

c) Selectors

 Owen: I'm not very clear how selects will help could you please chime in (I'm only casually acquainted with Selectors)?

thanks,
Arun

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 16:50:11 2006
Return-Path: 
 <hadoop-dev-return-1569-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73607 invoked from network); 23 May 2006 16:50:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 16:50:11 -0000
Received: (qmail 91017 invoked by uid 500); 23 May 2006 16:50:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90992 invoked by uid 500); 23 May 2006 16:50:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90983 invoked by uid 99); 23 May 2006 16:50:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 09:50:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 09:50:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 96247714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 16:49:30 +0000 (GMT)
Message-ID: <2843600.1148402970612.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 16:49:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
In-Reply-To: <6140265.1148030971246.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-234?page=comments#action_12412954 ] 

Doug Cutting commented on HADOOP-234:
-------------------------------------

I think we can mostly achieve what we want by using the SequenceFile.next(DataOutputBuffer) method to read the raw bytes of each entry, regardless of the declared types.  Thus the SequenceFile can still be created with the correct Java key and value classes, but when we actually read entries in Java we won't use instances of those classes, but rather just read the raw content of the entry into a byte-array container like BytesWritable that is passed to C.  Then the C code can deserialize the Record instance from the byte-array container.  So a C-based mapper should specify the real input key and value classes, but its InputFormat implementation will ignore that when entries are read, passing raw bytes to C.

> Support for writing Map/Reduce functions in C++
> -----------------------------------------------
>
>          Key: HADOOP-234
>          URL: http://issues.apache.org/jira/browse/HADOOP-234
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Sanjay Dahiya

>
> MapReduce C++ support
> Requirements 
> 1. Allow users to write Map and Reduce functions in C++, rest of the 
> infrastructure already present in Java should be reused. 
> 2. Avoid users having to write both Java and C++ for this to work. 
> 3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
> 4. Use Record IO for describing record format, both MR java framework and C++ should 
> 	use the same format to work seemlessly. 
> 5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
> 	simple strings. 
> Implementation notes
> - If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
> 	mapper and reducer methods in C++. 
> - For composite Record IO types user starts with defining a record format using Record IO DDL. 
> - User generates Java and C++ classes from the DDL using record IO. 
> - Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
> - User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
>   makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
>   generated C++ record IO classes. 
> - User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 
> Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 
> Native(JNI) Java proxy for the Mapper : 
> ---------------------------------------
> Without Record IO :-
> --------------------
> public class SimpleNativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	  * Works on simple strings. 
> 	  **/
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		mapNative(key.toString().getBytes()
> 				, value.toString().getBytes(), output, reporter); 
> 	}
> 	
> 	/**
> 	  * Native implementation. 
> 	  **/
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> With Record IO :- 
> ------------------
> public class RecordIONativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	 * Implementation of map method, this acts as a JNI proxy for actual map 
> 	 * method implemented in C++. Works for Record IO based records. 
> 	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
> 	 */
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		
> 		byte[] keyBytes = null ;
> 		byte[] valueBytes = null ;
> 		
> 		try{
> 			// we need to serialize the key and record and pass the serialized 
> 			// format to C++ / JNI methods so they can interpret it using appropriate 
> 			// record IO classes. 
> 			{
> 				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				keyBytes = keyStream.toByteArray();
> 			}
> 			{
> 				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				valueBytes = valueStream.toByteArray();
> 			}
> 		}catch(ClassCastException e){
> 			// throw better exceptions
> 			throw new IOException("Input record must be of Record IO Type"); 
> 		}
> 		// pass the serialized byte[] to C++ implementation. 
> 		mapNative(keyBytes, valueBytes, output, reporter); 
> 	}
> 	/**
> 	 * Implementation in C++.
> 	 */
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> OutputCollector Proxy for C++
> ------------------------------
> public class NativeOutputCollector implements OutputCollector {
> 	// standard method from interface
> 	public void collect(WritableComparable key, Writable value)
> 			throws IOException {
> 	}
> 	
> 	// deserializes key and value and calls collect(WritableComparable, Writable)
> 	public void collectFromNative(byte[]key, byte[]value){
> 		// deserialize key and value to java types ( as configured in JobConf )
> 		// call actual collect method 
> 	}
> }
> Core Native functions ( helper for user provided Mapper and Reducer ) 
> ---------------------------------------------------------------------
> #include "org_apache_hadoop_mapred_NativeMapper.h"
> #include "UserMapper.h"
> /**
> 	* A C++ proxy method, calls actual implementation of the Mapper. This method 
> 	signature is generated by javah.
> **/
> JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
>   (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
>   	jobject output_collector, jobject reporter);
> {
>  
>  	// convert char* and pass on to user defined map method. 
>  	// user's map method should take care of converting it to correct record IO 
>  	// type.
>  	int keyLen = (*env)->GetArrayLength(env, key) ;
>  	int valueLen = (*env)->GetArrayLength(env, valueLen) ;
>  	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
>  	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
>  	
>  	// Call User defined method 
>  	user_map(keyBuf, valueBuf, output_collector, reporter) ;
>  	
>  	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
>  	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
> }
> /**
> 	Helper method, acts as a proxy to OutputCollector in java. key and value 
> 	must be serialized forms of records as specified in JobConf. 
> **/
> void output_collector(const char * key, const char *value,
> 	jobject output_collector, jobject reporter){
> 	
> 	// invoke java NativeOutputCollector.collect with key and value. 
> }
> User defined Mapper ( and Reducer ) 
> ------------------------------------
> /**
> 	implements user defined map operation. 
> **/
> void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {
> 	//1. deserialize key/value in the appropriate format using record IO. 
> 	
> 	//2. process key/value and generate the intermediate key/values in record IO format. 
> 	
> 	//3. Deserialize intermediate key/values to intermed_key and intermed_value
> 	
> 	//4. pass intermed_key/intermed_value using helper function - 
> 	// 		output_collector(intermed_key, intermed_value, collector, recorder);
> 	
> 	
> }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 17:20:11 2006
Return-Path: 
 <hadoop-dev-return-1570-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83100 invoked from network); 23 May 2006 17:20:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 17:20:11 -0000
Received: (qmail 39934 invoked by uid 500); 23 May 2006 17:20:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39912 invoked by uid 500); 23 May 2006 17:20:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39899 invoked by uid 99); 23 May 2006 17:20:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:20:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:20:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 954A67141FA
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 17:19:30 +0000 (GMT)
Message-ID: <8489101.1148404770608.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 17:19:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12412958 ] 

Doug Cutting commented on HADOOP-210:
-------------------------------------

Threads are already pooled, with a single thread per client JVM.

The solution is either to not cache connections, using a new connection per request, or to use selectors, so that a single thread can efficiently handle requests on all connections.  In the latter case, we need to alter the request protocol so that incoming requests can be buffered until they are complete, and then dispatched to a worker thread.  Currently a request cannot be parsed except by a readFields method, so there's no way for generic server code to tell when one request ends and the next begins.  So we can simply first write requests to a buffer on the client, then send them length-prefixed.

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 17:22:09 2006
Return-Path: 
 <hadoop-dev-return-1571-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83542 invoked from network); 23 May 2006 17:22:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 17:22:09 -0000
Received: (qmail 41889 invoked by uid 500); 23 May 2006 17:22:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41856 invoked by uid 500); 23 May 2006 17:22:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41836 invoked by uid 99); 23 May 2006 17:22:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:22:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:22:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CB822714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 17:21:29 +0000 (GMT)
Message-ID: <10933304.1148404889830.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 17:21:29 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-240) namenode should not log failed mkdirs
 at warning level
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

namenode should not log failed mkdirs at warning level
------------------------------------------------------

         Key: HADOOP-240
         URL: http://issues.apache.org/jira/browse/HADOOP-240
     Project: Hadoop
        Type: Bug

  Components: dfs  
    Versions: 0.2.1    
    Reporter: Hairong Kuang
 Assigned to: Hairong Kuang 
    Priority: Minor


when a namenode creates a directory, it also recursively tries to creates its parent directories. If they already exist, the lastSuccess is  false and the "error" is logged at the warning level.

The right approach is to set the logging leve lower to fine or simply ignore the the "error".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 17:33:12 2006
Return-Path: 
 <hadoop-dev-return-1572-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86570 invoked from network); 23 May 2006 17:33:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 17:33:12 -0000
Received: (qmail 55667 invoked by uid 500); 23 May 2006 17:33:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55648 invoked by uid 500); 23 May 2006 17:33:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55639 invoked by uid 99); 23 May 2006 17:33:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:33:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:33:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AA4E8714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 17:32:31 +0000 (GMT)
Message-ID: <33407493.1148405551694.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 17:32:31 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
In-Reply-To: <6140265.1148030971246.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-234?page=comments#action_12412962 ] 

Milind Bhandarkar commented on HADOOP-234:
------------------------------------------

This can be done by providing just one C++ class in record IO. Currently, C++ version for record IO generates methods for each class that read from and write to InStream and OutStream interfaces, that contain only read and write methods. Creation of concrete classes that implement these interfaces is outside of the code generation. One could proovide a byteStream class in C++ that provides these interfaces. The construction of BytesOutStream happens in C++ and after serializing C++ record, this stream goes to Java via JNI, which is then converted to BytesWritable and written to the sequencefile. BytesInStream is created in Java tied with the sequencefile, and supplies bytes to the C++ record.

> Support for writing Map/Reduce functions in C++
> -----------------------------------------------
>
>          Key: HADOOP-234
>          URL: http://issues.apache.org/jira/browse/HADOOP-234
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Sanjay Dahiya

>
> MapReduce C++ support
> Requirements 
> 1. Allow users to write Map and Reduce functions in C++, rest of the 
> infrastructure already present in Java should be reused. 
> 2. Avoid users having to write both Java and C++ for this to work. 
> 3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
> 4. Use Record IO for describing record format, both MR java framework and C++ should 
> 	use the same format to work seemlessly. 
> 5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
> 	simple strings. 
> Implementation notes
> - If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
> 	mapper and reducer methods in C++. 
> - For composite Record IO types user starts with defining a record format using Record IO DDL. 
> - User generates Java and C++ classes from the DDL using record IO. 
> - Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
> - User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
>   makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
>   generated C++ record IO classes. 
> - User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 
> Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 
> Native(JNI) Java proxy for the Mapper : 
> ---------------------------------------
> Without Record IO :-
> --------------------
> public class SimpleNativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	  * Works on simple strings. 
> 	  **/
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		mapNative(key.toString().getBytes()
> 				, value.toString().getBytes(), output, reporter); 
> 	}
> 	
> 	/**
> 	  * Native implementation. 
> 	  **/
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> With Record IO :- 
> ------------------
> public class RecordIONativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	 * Implementation of map method, this acts as a JNI proxy for actual map 
> 	 * method implemented in C++. Works for Record IO based records. 
> 	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
> 	 */
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		
> 		byte[] keyBytes = null ;
> 		byte[] valueBytes = null ;
> 		
> 		try{
> 			// we need to serialize the key and record and pass the serialized 
> 			// format to C++ / JNI methods so they can interpret it using appropriate 
> 			// record IO classes. 
> 			{
> 				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				keyBytes = keyStream.toByteArray();
> 			}
> 			{
> 				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				valueBytes = valueStream.toByteArray();
> 			}
> 		}catch(ClassCastException e){
> 			// throw better exceptions
> 			throw new IOException("Input record must be of Record IO Type"); 
> 		}
> 		// pass the serialized byte[] to C++ implementation. 
> 		mapNative(keyBytes, valueBytes, output, reporter); 
> 	}
> 	/**
> 	 * Implementation in C++.
> 	 */
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> OutputCollector Proxy for C++
> ------------------------------
> public class NativeOutputCollector implements OutputCollector {
> 	// standard method from interface
> 	public void collect(WritableComparable key, Writable value)
> 			throws IOException {
> 	}
> 	
> 	// deserializes key and value and calls collect(WritableComparable, Writable)
> 	public void collectFromNative(byte[]key, byte[]value){
> 		// deserialize key and value to java types ( as configured in JobConf )
> 		// call actual collect method 
> 	}
> }
> Core Native functions ( helper for user provided Mapper and Reducer ) 
> ---------------------------------------------------------------------
> #include "org_apache_hadoop_mapred_NativeMapper.h"
> #include "UserMapper.h"
> /**
> 	* A C++ proxy method, calls actual implementation of the Mapper. This method 
> 	signature is generated by javah.
> **/
> JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
>   (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
>   	jobject output_collector, jobject reporter);
> {
>  
>  	// convert char* and pass on to user defined map method. 
>  	// user's map method should take care of converting it to correct record IO 
>  	// type.
>  	int keyLen = (*env)->GetArrayLength(env, key) ;
>  	int valueLen = (*env)->GetArrayLength(env, valueLen) ;
>  	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
>  	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
>  	
>  	// Call User defined method 
>  	user_map(keyBuf, valueBuf, output_collector, reporter) ;
>  	
>  	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
>  	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
> }
> /**
> 	Helper method, acts as a proxy to OutputCollector in java. key and value 
> 	must be serialized forms of records as specified in JobConf. 
> **/
> void output_collector(const char * key, const char *value,
> 	jobject output_collector, jobject reporter){
> 	
> 	// invoke java NativeOutputCollector.collect with key and value. 
> }
> User defined Mapper ( and Reducer ) 
> ------------------------------------
> /**
> 	implements user defined map operation. 
> **/
> void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {
> 	//1. deserialize key/value in the appropriate format using record IO. 
> 	
> 	//2. process key/value and generate the intermediate key/values in record IO format. 
> 	
> 	//3. Deserialize intermediate key/values to intermed_key and intermed_value
> 	
> 	//4. pass intermed_key/intermed_value using helper function - 
> 	// 		output_collector(intermed_key, intermed_value, collector, recorder);
> 	
> 	
> }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 17:39:10 2006
Return-Path: 
 <hadoop-dev-return-1573-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87693 invoked from network); 23 May 2006 17:39:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 17:39:10 -0000
Received: (qmail 59598 invoked by uid 500); 23 May 2006 17:39:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59577 invoked by uid 500); 23 May 2006 17:39:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59568 invoked by uid 99); 23 May 2006 17:39:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:39:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:39:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 28F1F7141FA
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 17:38:30 +0000 (GMT)
Message-ID: <26731947.1148405910149.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 17:38:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-136?page=comments#action_12412964 ] 

Doug Cutting commented on HADOOP-136:
-------------------------------------

If we can't fix the UTF8 class back-compatibly, then I'd prefer we provide a replacement class and deprecate UTF8.  Long-term we don't want two classes around that do almost the same thing.  We could name the new class Text or Chars.  It could use a variable number of bytes to indicate its length, using the 1 byte for lengths less than 127, two-bytes for lengths less than 2^14, etc., then encode the content with UTF-8.  Note that the length should be the number of bytes of content, not the number of encoded characters.  Does this sound reasonable?


> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor
>  Attachments: largeutf8.patch
>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 17:45:10 2006
Return-Path: 
 <hadoop-dev-return-1574-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89319 invoked from network); 23 May 2006 17:45:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 17:45:10 -0000
Received: (qmail 69986 invoked by uid 500); 23 May 2006 17:45:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69933 invoked by uid 500); 23 May 2006 17:45:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69903 invoked by uid 99); 23 May 2006 17:45:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:45:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 10:45:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2C4147141FA
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 17:44:30 +0000 (GMT)
Message-ID: <15453290.1148406270163.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 17:44:30 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-136?page=comments#action_12412967 ] 

Milind Bhandarkar commented on HADOOP-136:
------------------------------------------

The static methods for converting integers and longs to zero-encoded representation (similar to what you have suggested) already exists in the record IO Util class.

> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Reporter: Dick King
>     Priority: Minor
>  Attachments: largeutf8.patch
>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 18:24:13 2006
Return-Path: 
 <hadoop-dev-return-1575-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3404 invoked from network); 23 May 2006 18:24:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 18:24:13 -0000
Received: (qmail 37445 invoked by uid 500); 23 May 2006 18:24:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37396 invoked by uid 500); 23 May 2006 18:24:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37370 invoked by uid 99); 23 May 2006 18:24:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 11:24:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 11:24:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E73E871429B
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 18:23:29 +0000 (GMT)
Message-ID: <17055124.1148408609943.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 18:23:29 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-241) TestCopyFiles fails under cygwin due
 to incorrect path
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

TestCopyFiles fails under cygwin due to incorrect path
------------------------------------------------------

         Key: HADOOP-241
         URL: http://issues.apache.org/jira/browse/HADOOP-241
     Project: Hadoop
        Type: Bug

  Components: fs  
 Environment: Windows
    Reporter: Konstantin Shvachko
 Assigned to: Milind Bhandarkar 
    Priority: Minor


Under cygwin TestCopyFiles generates an incorrect url which includes windows style path.
This is the result of concatenation of a win path with unix path.
File.getPath() should be used to produce a consistent path.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 18:48:10 2006
Return-Path: 
 <hadoop-dev-return-1576-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13073 invoked from network); 23 May 2006 18:48:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 18:48:10 -0000
Received: (qmail 83238 invoked by uid 500); 23 May 2006 18:48:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83219 invoked by uid 500); 23 May 2006 18:48:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83210 invoked by uid 99); 23 May 2006 18:48:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 11:48:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 11:48:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A3CB7714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 18:47:30 +0000 (GMT)
Message-ID: <937166.1148410050668.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 18:47:30 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-240) namenode should not log failed mkdirs
 at warning level
In-Reply-To: <10933304.1148404889830.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-240?page=all ]

Hairong Kuang updated HADOOP-240:
---------------------------------

    Attachment: mkdir.patch

This patch fixes the problem by removing the logging when a namenode "fails" to create a parent directory. It also adjusts the logging level of some logs.

> namenode should not log failed mkdirs at warning level
> ------------------------------------------------------
>
>          Key: HADOOP-240
>          URL: http://issues.apache.org/jira/browse/HADOOP-240
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor
>  Attachments: mkdir.patch
>
> when a namenode creates a directory, it also recursively tries to creates its parent directories. If they already exist, the lastSuccess is  false and the "error" is logged at the warning level.
> The right approach is to set the logging leve lower to fine or simply ignore the the "error".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 19:16:10 2006
Return-Path: 
 <hadoop-dev-return-1577-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19499 invoked from network); 23 May 2006 19:16:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 19:16:10 -0000
Received: (qmail 18262 invoked by uid 500); 23 May 2006 19:16:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18240 invoked by uid 500); 23 May 2006 19:16:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18231 invoked by uid 99); 23 May 2006 19:16:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:16:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:16:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DFD65714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 19:15:29 +0000 (GMT)
Message-ID: <13734662.1148411729914.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 19:15:29 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-242) job fails because of "No valid local
 directories in property: " exception
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

job fails because of "No valid local directories in property: " exception
-------------------------------------------------------------------------

         Key: HADOOP-242
         URL: http://issues.apache.org/jira/browse/HADOOP-242
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Yoram Arnon
 Assigned to: Sameer Paranjpye 


when running a fairly large job, of 70+K map tasks, I get many exceptions as shown below, and eventually the job failes when a task fails four times.
The exception doesn't really tell us enough information to debug this properly, so the first thing to do would be to add more information (path) to the exception.
The path indicated in the config file exists, is writable and valid, though 'path' may be anything.

the exception:
java.io.IOException: No valid local directories in property: mapred.local.dir at org.apache.hadoop.conf.Configuration.getLocalPath(Configuration.java:293) at org.apache.hadoop.mapred.JobConf.getLocalPath(JobConf.java:153) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:523) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.launchTask(TaskTracker.java:572) at org.apache.hadoop.mapred.TaskTracker.startNewTask(TaskTracker.java:389) at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:303) at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:418) at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:920)

the code:
  public Path getLocalPath(String dirsProp, String path)
    throws IOException {
    String[] dirs = getStrings(dirsProp);
    int hashCode = path.hashCode();
    FileSystem fs = FileSystem.getNamed("local", this);
    for (int i = 0; i < dirs.length; i++) {  // try each local dir
      int index = (hashCode+i & Integer.MAX_VALUE) % dirs.length;
      Path file = new Path(dirs[index], path);
      Path dir = file.getParent();
      if (fs.exists(dir) || fs.mkdirs(dir)) {
        return file;
      }
    }
    throw new IOException("No valid local directories in property: "+dirsProp);
  }


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 19:19:15 2006
Return-Path: 
 <hadoop-dev-return-1578-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26489 invoked from network); 23 May 2006 19:19:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 19:19:15 -0000
Received: (qmail 26608 invoked by uid 500); 23 May 2006 19:19:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26479 invoked by uid 500); 23 May 2006 19:19:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26470 invoked by uid 99); 23 May 2006 19:19:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:19:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:19:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CFFFA714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 19:18:29 +0000 (GMT)
Message-ID: <32908038.1148411909849.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 19:18:29 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-243) WI shows progress as 100.00% before
 actual completion (rounding error)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

WI shows progress as 100.00% before actual completion (rounding error)
----------------------------------------------------------------------

         Key: HADOOP-243
         URL: http://issues.apache.org/jira/browse/HADOOP-243
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Yoram Arnon
    Priority: Trivial


For jobs of over 50000 tasks, the rounding error in the WI is confusing.
When less than 0.005% of the map (or reduce) tasks remain to execute, the WI shows progress as 100.00%, which is misleading.
Rounding down to the nearest .01% would be better.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 19:26:10 2006
Return-Path: 
 <hadoop-dev-return-1579-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29596 invoked from network); 23 May 2006 19:26:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 19:26:10 -0000
Received: (qmail 29889 invoked by uid 500); 23 May 2006 19:26:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29861 invoked by uid 500); 23 May 2006 19:26:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29852 invoked by uid 99); 23 May 2006 19:26:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:26:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:26:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C819F714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 19:25:29 +0000 (GMT)
Message-ID: <10706543.1148412329817.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 19:25:29 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-244) very long cleanup after a job fails
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

very long cleanup after a job fails
-----------------------------------

         Key: HADOOP-244
         URL: http://issues.apache.org/jira/browse/HADOOP-244
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Yoram Arnon
 Assigned to: Sameer Paranjpye 


Eight hours after a job failed (it executed for about 14 hours prior to failing), many task trackers keep throwing the exceptions below:

060523 121732 Server handler 0 on 50040 caught: java.io.FileNotFoundException: LocalFS
java.io.FileNotFoundException: LocalFS
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
060523 121814 task_0006_r_000123_0 copy failed: task_0006_m_046105_0 from node5:50040
java.net.SocketTimeoutException: timed out waiting for rpc response
        at org.apache.hadoop.ipc.Client.call(Client.java:305)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:150)
        at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
        at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:112)
        at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:67)
060523 121814 task_0006_r_000123_0 0.13023989% reduce > copy > task_0006_m_046105_0@node5:50040
060523 121814 task_0006_r_000123_0 Copying task_0006_m_048815_0 output from node6
060523 121817 SEVERE Can't open map output:/hadoop/mapred/local/task_0006_m_031921_0/part-152.out
java.io.FileNotFoundException: LocalFS
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
060523 121817 Unknown child with bad map output: task_0006_m_031921_0. Ignored.
060523 121817 Server handler 1 on 50040 caught: java.io.FileNotFoundException: LocalFS
java.io.FileNotFoundException: LocalFS
        at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
        at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
        at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
        at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
        at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
        at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
060523 121914 task_0006_r_000123_0 copy failed: task_0006_m_048815_0 from node6:50040
java.net.SocketTimeoutException: timed out waiting for rpc response
        at org.apache.hadoop.ipc.Client.call(Client.java:305)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:150)
        at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
        at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:112)
        at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:67)


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 19:42:11 2006
Return-Path: 
 <hadoop-dev-return-1580-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35374 invoked from network); 23 May 2006 19:42:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 19:42:11 -0000
Received: (qmail 56810 invoked by uid 500); 23 May 2006 19:42:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56785 invoked by uid 500); 23 May 2006 19:42:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56775 invoked by uid 99); 23 May 2006 19:42:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:42:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:42:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1590C71428E
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 19:41:31 +0000 (GMT)
Message-ID: <28551191.1148413291085.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 19:41:31 +0000 (GMT+00:00)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-191) add hadoopStreaming to src/contrib
In-Reply-To: <8632181.1146607846403.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-191?page=all ]
     
Michel Tourn closed HADOOP-191:
-------------------------------

    Resolution: Fixed

(Visible to jira-users)


> add hadoopStreaming to src/contrib
> ----------------------------------
>
>          Key: HADOOP-191
>          URL: http://issues.apache.org/jira/browse/HADOOP-191
>      Project: Hadoop
>         Type: New Feature

>     Reporter: Michel Tourn
>     Assignee: Doug Cutting
>      Fix For: 0.2
>  Attachments: streaming.2.patch, streaming.3.patch, streaming.patch
>
> This is a patch that adds a src/contrib/hadoopStreaming directory to the source tree.
> hadoopStreaming is a bridge to run non-Java code as Map/Reduce tasks.
> The unit test TestStreaming runs the Unix tools tr (as Map) and uniq (as Reduce)
> TO test the patch: 
> Merge the patch. 
> The only existing file that is modified is trunk/build.xml
> trunk>ant deploy-contrib
> trunk>bin/hadoopStreaming : should show usage message
> trunk>ant test-contrib    : should run one test successfully
> TO add src/contrib/someOtherProject:
> edit src/contrib/build.xml

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 19:45:12 2006
Return-Path: 
 <hadoop-dev-return-1581-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36500 invoked from network); 23 May 2006 19:45:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 19:45:12 -0000
Received: (qmail 59588 invoked by uid 500); 23 May 2006 19:45:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59454 invoked by uid 500); 23 May 2006 19:45:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59087 invoked by uid 99); 23 May 2006 19:45:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:45:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 12:45:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BB066714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 19:44:30 +0000 (GMT)
Message-ID: <15509125.1148413470763.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 19:44:30 +0000 (GMT+00:00)
From: "Jayant Shekhar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-237) Standard set of Performance Metrics
 for Hadoop
In-Reply-To: <14919853.1148078609860.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-237?page=comments#action_12412980 ] 

Jayant Shekhar commented on HADOOP-237:
---------------------------------------

Here are a few I would like to add to the list:

Job Tracker
  jobs submitted
  jobs completed


Task Tracker
  total tasks completed
  number of maps running
  number of reduces running


> Standard set of Performance Metrics for Hadoop
> ----------------------------------------------
>
>          Key: HADOOP-237
>          URL: http://issues.apache.org/jira/browse/HADOOP-237
>      Project: Hadoop
>         Type: Improvement

>   Components: metrics
>     Versions: 0.3
>  Environment: All
>     Reporter: Milind Bhandarkar
>     Assignee: Milind Bhandarkar

>
> I am starting to use Hadoop's shiny new Metrics API to publish performance (and other) Metrics of running jobs and other daemons.
> Which performance metrics are people interested in seeing ? If possible, please group them according to modules, such as map-reduce, dfs, general-cluster-related etc. I will follow this process:
> 1. collect this list
> 2. assess feasibility of obtaining metric
> 3. assign context/record/metrics names
> 4. seek approval for names
> 5. instrument the code.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 20:31:12 2006
Return-Path: 
 <hadoop-dev-return-1582-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58582 invoked from network); 23 May 2006 20:31:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 20:31:12 -0000
Received: (qmail 42408 invoked by uid 500); 23 May 2006 20:31:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42308 invoked by uid 500); 23 May 2006 20:31:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42162 invoked by uid 99); 23 May 2006 20:31:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:31:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:31:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 97FCF71428E
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 20:30:30 +0000 (GMT)
Message-ID: <14818934.1148416230619.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 20:30:30 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-242) job fails because of "No valid local
 directories in property: " exception
In-Reply-To: <13734662.1148411729914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-242?page=comments#action_12412984 ] 

eric baldeschwieler commented on HADOOP-242:
--------------------------------------------

perhaps we should not record failure until a job has been tried on two nodes?  Then we could collect stats on frequency that a job fails on a given node.

Also 4 failures seems odd.  Shouldn't we just have a configurable allowable % failure?  That will scale evenly.

> job fails because of "No valid local directories in property: " exception
> -------------------------------------------------------------------------
>
>          Key: HADOOP-242
>          URL: http://issues.apache.org/jira/browse/HADOOP-242
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye

>
> when running a fairly large job, of 70+K map tasks, I get many exceptions as shown below, and eventually the job failes when a task fails four times.
> The exception doesn't really tell us enough information to debug this properly, so the first thing to do would be to add more information (path) to the exception.
> The path indicated in the config file exists, is writable and valid, though 'path' may be anything.
> the exception:
> java.io.IOException: No valid local directories in property: mapred.local.dir at org.apache.hadoop.conf.Configuration.getLocalPath(Configuration.java:293) at org.apache.hadoop.mapred.JobConf.getLocalPath(JobConf.java:153) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:523) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.launchTask(TaskTracker.java:572) at org.apache.hadoop.mapred.TaskTracker.startNewTask(TaskTracker.java:389) at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:303) at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:418) at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:920)
> the code:
>   public Path getLocalPath(String dirsProp, String path)
>     throws IOException {
>     String[] dirs = getStrings(dirsProp);
>     int hashCode = path.hashCode();
>     FileSystem fs = FileSystem.getNamed("local", this);
>     for (int i = 0; i < dirs.length; i++) {  // try each local dir
>       int index = (hashCode+i & Integer.MAX_VALUE) % dirs.length;
>       Path file = new Path(dirs[index], path);
>       Path dir = file.getParent();
>       if (fs.exists(dir) || fs.mkdirs(dir)) {
>         return file;
>       }
>     }
>     throw new IOException("No valid local directories in property: "+dirsProp);
>   }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 20:39:10 2006
Return-Path: 
 <hadoop-dev-return-1583-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60940 invoked from network); 23 May 2006 20:39:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 20:39:10 -0000
Received: (qmail 53160 invoked by uid 500); 23 May 2006 20:39:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53137 invoked by uid 500); 23 May 2006 20:39:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53128 invoked by uid 99); 23 May 2006 20:39:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:39:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:39:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CDA371428E
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 20:38:30 +0000 (GMT)
Message-ID: <22837160.1148416710574.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 20:38:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-242) job fails because of "No valid local
 directories in property: " exception
In-Reply-To: <13734662.1148411729914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-242?page=comments#action_12412986 ] 

Owen O'Malley commented on HADOOP-242:
--------------------------------------

It is 4 failures of the _same_ fragment of work. So it takes map-0000000 failing 4 times before the job is killed. The job tracker does know which machines that each task has failed on and prefers to run other tasks on that node.

> job fails because of "No valid local directories in property: " exception
> -------------------------------------------------------------------------
>
>          Key: HADOOP-242
>          URL: http://issues.apache.org/jira/browse/HADOOP-242
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye

>
> when running a fairly large job, of 70+K map tasks, I get many exceptions as shown below, and eventually the job failes when a task fails four times.
> The exception doesn't really tell us enough information to debug this properly, so the first thing to do would be to add more information (path) to the exception.
> The path indicated in the config file exists, is writable and valid, though 'path' may be anything.
> the exception:
> java.io.IOException: No valid local directories in property: mapred.local.dir at org.apache.hadoop.conf.Configuration.getLocalPath(Configuration.java:293) at org.apache.hadoop.mapred.JobConf.getLocalPath(JobConf.java:153) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:523) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.launchTask(TaskTracker.java:572) at org.apache.hadoop.mapred.TaskTracker.startNewTask(TaskTracker.java:389) at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:303) at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:418) at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:920)
> the code:
>   public Path getLocalPath(String dirsProp, String path)
>     throws IOException {
>     String[] dirs = getStrings(dirsProp);
>     int hashCode = path.hashCode();
>     FileSystem fs = FileSystem.getNamed("local", this);
>     for (int i = 0; i < dirs.length; i++) {  // try each local dir
>       int index = (hashCode+i & Integer.MAX_VALUE) % dirs.length;
>       Path file = new Path(dirs[index], path);
>       Path dir = file.getParent();
>       if (fs.exists(dir) || fs.mkdirs(dir)) {
>         return file;
>       }
>     }
>     throw new IOException("No valid local directories in property: "+dirsProp);
>   }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 20:43:10 2006
Return-Path: 
 <hadoop-dev-return-1584-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61839 invoked from network); 23 May 2006 20:43:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 20:43:10 -0000
Received: (qmail 57914 invoked by uid 500); 23 May 2006 20:43:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57889 invoked by uid 500); 23 May 2006 20:43:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57879 invoked by uid 99); 23 May 2006 20:43:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:43:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:43:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E0FD071429B
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 20:42:29 +0000 (GMT)
Message-ID: <13294037.1148416949918.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 20:42:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-245) record io translator doesn't strip
 path names
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

record io translator doesn't strip path names
---------------------------------------------

         Key: HADOOP-245
         URL: http://issues.apache.org/jira/browse/HADOOP-245
     Project: Hadoop
        Type: Bug

  Components: record  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Milind Bhandarkar 


When I run the record translator with a pathname, the path name is not stripped. So for example:

% bin/rcc --language c++ foo/bar/bat.jr

generates:

foo/bar/bat.jr.hh (instead of ./bat.jr.hh)
and the first line is #ifndef __FOO/BAR/BAT_JR_HH__

the first was unexpected and the second is clearly wrong.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 20:47:10 2006
Return-Path: 
 <hadoop-dev-return-1585-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62428 invoked from network); 23 May 2006 20:47:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 20:47:10 -0000
Received: (qmail 59938 invoked by uid 500); 23 May 2006 20:47:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59912 invoked by uid 500); 23 May 2006 20:47:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59902 invoked by uid 99); 23 May 2006 20:47:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:47:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:47:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E64EA71429B
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 20:46:29 +0000 (GMT)
Message-ID: <3975508.1148417189940.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 20:46:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-246) the record-io generated c++ has wrong
 comments
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

the record-io generated c++ has wrong comments
----------------------------------------------

         Key: HADOOP-246
         URL: http://issues.apache.org/jira/browse/HADOOP-246
     Project: Hadoop
        Type: Bug

  Components: record  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Milind Bhandarkar 


The comments on the namespaces on the closing come out backward:

} // end namespace org
} // end namespace apache
} // end namespace hadoop
} // end namespace record
} // end namespace test


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 20:47:11 2006
Return-Path: 
 <hadoop-dev-return-1586-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62448 invoked from network); 23 May 2006 20:47:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 20:47:11 -0000
Received: (qmail 60197 invoked by uid 500); 23 May 2006 20:47:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60069 invoked by uid 500); 23 May 2006 20:47:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60060 invoked by uid 99); 23 May 2006 20:47:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:47:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:47:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C6700714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 20:46:30 +0000 (GMT)
Message-ID: <14667859.1148417190810.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 20:46:30 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12412989 ] 

eric baldeschwieler commented on HADOOP-210:
--------------------------------------------

I think we need to break the one thread per connection model.  otherwise our servers will not scale, so "selectors" are needed.

Also we probably need to break the very long connection caching model and the invarient of one connection per VM.  Connection setup is nearly free and serializing requests from different threads creates race conditions and other failure cases.


> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 20:47:12 2006
Return-Path: 
 <hadoop-dev-return-1587-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62484 invoked from network); 23 May 2006 20:47:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 20:47:12 -0000
Received: (qmail 60348 invoked by uid 500); 23 May 2006 20:47:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60219 invoked by uid 500); 23 May 2006 20:47:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60207 invoked by uid 99); 23 May 2006 20:47:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:47:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:47:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 35CF87142C8
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 20:46:32 +0000 (GMT)
Message-ID: <3488304.1148417192217.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 20:46:32 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-246) the record-io generated c++ has
 wrong comments
In-Reply-To: <3975508.1148417189940.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-246?page=comments#action_12412990 ] 

Owen O'Malley commented on HADOOP-246:
--------------------------------------

It would also be nice if the namespaces weren't closed off just to be opened again...

} // end namespace org
} // end namespace apache
} // end namespace hadoop
} // end namespace record
} // end namespace test
namespace org {
namespace apache {
namespace hadoop {
namespace record {
namespace test {


> the record-io generated c++ has wrong comments
> ----------------------------------------------
>
>          Key: HADOOP-246
>          URL: http://issues.apache.org/jira/browse/HADOOP-246
>      Project: Hadoop
>         Type: Bug

>   Components: record
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Milind Bhandarkar

>
> The comments on the namespaces on the closing come out backward:
> } // end namespace org
> } // end namespace apache
> } // end namespace hadoop
> } // end namespace record
> } // end namespace test

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 20:53:10 2006
Return-Path: 
 <hadoop-dev-return-1588-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64158 invoked from network); 23 May 2006 20:53:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 20:53:10 -0000
Received: (qmail 66137 invoked by uid 500); 23 May 2006 20:53:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66009 invoked by uid 500); 23 May 2006 20:53:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66000 invoked by uid 99); 23 May 2006 20:53:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:53:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:53:08 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D428F71428E
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 20:52:29 +0000 (GMT)
Message-ID: <8121535.1148417549865.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 20:52:29 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-247) The Reduce Task thread for reporting
 progress during the sort exits in case of any IOException
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

The Reduce Task thread for reporting progress during the sort exits in case of any IOException
----------------------------------------------------------------------------------------------

         Key: HADOOP-247
         URL: http://issues.apache.org/jira/browse/HADOOP-247
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Mahadev konar
 Assigned to: Mahadev konar 
    Priority: Critical


The Reduce task thread for reporting progress during the sort, exits in case of any exception (except InterruptedException). The solution would be to continue the thread in case of an exception.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 20:55:12 2006
Return-Path: 
 <hadoop-dev-return-1589-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64512 invoked from network); 23 May 2006 20:55:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 20:55:12 -0000
Received: (qmail 68225 invoked by uid 500); 23 May 2006 20:55:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68167 invoked by uid 500); 23 May 2006 20:55:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68077 invoked by uid 99); 23 May 2006 20:55:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:55:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 13:55:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 876F9714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 20:54:31 +0000 (GMT)
Message-ID: <20633708.1148417671552.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 20:54:31 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-247) The Reduce Task thread for reporting
 progress during the sort exits in case of any IOException
In-Reply-To: <8121535.1148417549865.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-247?page=all ]

Mahadev konar updated HADOOP-247:
---------------------------------

    Attachment: sortprogress.patch

This patch makes the thread exit on an InterruptedException and continues on a Throwable().

> The Reduce Task thread for reporting progress during the sort exits in case of any IOException
> ----------------------------------------------------------------------------------------------
>
>          Key: HADOOP-247
>          URL: http://issues.apache.org/jira/browse/HADOOP-247
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Critical
>  Attachments: sortprogress.patch
>
> The Reduce task thread for reporting progress during the sort, exits in case of any exception (except InterruptedException). The solution would be to continue the thread in case of an exception.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 21:28:16 2006
Return-Path: 
 <hadoop-dev-return-1590-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80678 invoked from network); 23 May 2006 21:28:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 21:28:16 -0000
Received: (qmail 32801 invoked by uid 500); 23 May 2006 21:28:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32749 invoked by uid 500); 23 May 2006 21:28:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32690 invoked by uid 99); 23 May 2006 21:28:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 14:28:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 14:28:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9930D714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 21:27:30 +0000 (GMT)
Message-ID: <12518941.1148419650624.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 21:27:30 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-247) The Reduce Task thread for reporting
 progress during the sort exits in case of any IOException
In-Reply-To: <8121535.1148417549865.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-247?page=all ]

Mahadev konar updated HADOOP-247:
---------------------------------

    Attachment: sortprogress.patch

Modified the patch so it follows 80 character lines.

> The Reduce Task thread for reporting progress during the sort exits in case of any IOException
> ----------------------------------------------------------------------------------------------
>
>          Key: HADOOP-247
>          URL: http://issues.apache.org/jira/browse/HADOOP-247
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Critical
>  Attachments: sortprogress.patch
>
> The Reduce task thread for reporting progress during the sort, exits in case of any exception (except InterruptedException). The solution would be to continue the thread in case of an exception.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 21:28:16 2006
Return-Path: 
 <hadoop-dev-return-1591-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80682 invoked from network); 23 May 2006 21:28:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 21:28:16 -0000
Received: (qmail 33163 invoked by uid 500); 23 May 2006 21:28:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33111 invoked by uid 500); 23 May 2006 21:28:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33060 invoked by uid 99); 23 May 2006 21:28:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 14:28:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 14:28:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8DCDC714283
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 21:27:31 +0000 (GMT)
Message-ID: <9419313.1148419651577.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 21:27:31 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-247) The Reduce Task thread for reporting
 progress during the sort exits in case of any IOException
In-Reply-To: <8121535.1148417549865.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-247?page=all ]

Mahadev konar updated HADOOP-247:
---------------------------------

    Attachment:     (was: sortprogress.patch)

> The Reduce Task thread for reporting progress during the sort exits in case of any IOException
> ----------------------------------------------------------------------------------------------
>
>          Key: HADOOP-247
>          URL: http://issues.apache.org/jira/browse/HADOOP-247
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Critical
>  Attachments: sortprogress.patch
>
> The Reduce task thread for reporting progress during the sort, exits in case of any exception (except InterruptedException). The solution would be to continue the thread in case of an exception.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 21:44:10 2006
Return-Path: 
 <hadoop-dev-return-1592-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85130 invoked from network); 23 May 2006 21:44:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 21:44:10 -0000
Received: (qmail 53371 invoked by uid 500); 23 May 2006 21:44:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53348 invoked by uid 500); 23 May 2006 21:44:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53335 invoked by uid 99); 23 May 2006 21:44:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 14:44:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 14:44:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9D4FD714283
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 21:43:30 +0000 (GMT)
Message-ID: <1002768.1148420610641.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 21:43:30 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-240) namenode should not log failed
 mkdirs at warning level
In-Reply-To: <10933304.1148404889830.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-240?page=comments#action_12413006 ] 

Hairong Kuang commented on HADOOP-240:
--------------------------------------

On a second thought, the right approach to this problem should distiguish different cases when create a directory and then log them differently. When the mkdirs function  is called, either the directory is successfully created, or the directory already existed, or the directory is not able to created due to its parent's problem.

Currently FSDirectory.addNode returns null when a directory exists or a directory is not able to be created. I am thinking to add a PathNotFound exception. When a directory is not able to be created, addNode throws a PathNotFound exception. When a directory exists, it returns null. Otherwise, returns a new node.

When the function mkdirs catches a PathNotFound exception, it logs it as a failure and returns. When it gets a null, simply continues.

> namenode should not log failed mkdirs at warning level
> ------------------------------------------------------
>
>          Key: HADOOP-240
>          URL: http://issues.apache.org/jira/browse/HADOOP-240
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor
>  Attachments: mkdir.patch
>
> when a namenode creates a directory, it also recursively tries to creates its parent directories. If they already exist, the lastSuccess is  false and the "error" is logged at the warning level.
> The right approach is to set the logging leve lower to fine or simply ignore the the "error".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:20:11 2006
Return-Path: 
 <hadoop-dev-return-1593-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99495 invoked from network); 23 May 2006 22:20:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:20:11 -0000
Received: (qmail 11749 invoked by uid 500); 23 May 2006 22:20:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11732 invoked by uid 500); 23 May 2006 22:20:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11723 invoked by uid 99); 23 May 2006 22:20:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:20:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:20:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 91F79714283
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 22:19:30 +0000 (GMT)
Message-ID: <17425851.1148422770595.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 22:19:30 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-214) ClusterTestDFS fails
In-Reply-To: <7144677.1147463408861.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-214?page=comments#action_12413015 ] 

alan wootton commented on HADOOP-214:
-------------------------------------

Here's the latest on this issue.

I have a new patch that fixes the two main DFS tests. I think it would be crazy for us to move onward without having good DFS tests. 

There is a 'name server' hack in the patch now. The requires the system property "sun.net.spi.nameservice.provider" to be set to "dns,mine".
It is not good enough to just call: 

System.setProperty("sun.net.spi.nameservice.provider.1","dns,mine");

in the code unless you can do it BEFORE anyone else initializes InetAddress.java. JUnit is bad this way so the property must be set in the ant script that calls JUnit. This is in the latest patch.

If you want to call the unit test from eclipse then you will need to pass 
-Dsun.net.spi.nameservice.provider.1=dns,mine
to the jvm. Or, you might define "127.0.0.1 localhost0" through "127.0.0.1 localhost15" in your hosts file and get the same result.

Speaking of build.xml, The definition of the 'test-cluster' target tries to run ANYTHING in the test directory as a unit test - this generates lots of failure messages (e.g. RandomDatum is not a TestCase so it fails). I changed it so that the test-cluster target only runs files of the form "ClusterTest*.java". ToCpp.java, FromCpp.java, and DistributedFSCheck.java are NOT being run. To include them we should either make a new ant target (preferred), or change their name to start with ClusterTest. Or change the ant script.

I changed several constants in the ClusterTest*.java tests to make them run faster. I divided all the timeouts by 10. I removed the 'already existing' file creation test from ClusterTestDFSNamespaceLogging because it fails by timing out and that takes 3 minutes. When we can override LEASE_PERIOD then we can put that test back in. The whole cluster-test target now runs in 4 min.

ClusterTestDFSNamespaceLogging and ClusterTestDFS have VERY similar DFS simulations. As does MiniDfsCluster. I think someone needs to factor-out the dfs sim from all three of these tests.


> ClusterTestDFS fails
> --------------------
>
>          Key: HADOOP-214
>          URL: http://issues.apache.org/jira/browse/HADOOP-214
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>  Environment: local workstation (windows) 
>     Reporter: alan wootton
>  Attachments: fix_clustertestdfs.patch
>
> The dfs unit tests, from the ant target 'cluster' have been failing. (ClusterTestDFSNamespaceLogging, ClusterTestDFS). I don't know if anyone but me cares about these tests, but I do. I would like to write better tests for dns. I think we all need that.
> They have been partially broken since  "test.dfs.same.host.targets.allowed" went away and replication ceased for these tests. 
> They got really broken when NameNode stopped automatically formatting itself .
> Since they seem to be ignored, I took the liberty of changing how they work.
> The main thing is, you must put this into your hosts file:
> 127.0.0.1       localhost0
> 127.0.0.1       localhost1
> 127.0.0.1       localhost2
> 127.0.0.1       localhost3
> 127.0.0.1       localhost4
> 127.0.0.1       localhost5
> 127.0.0.1       localhost6
> 127.0.0.1       localhost7
> 127.0.0.1       localhost8
> 127.0.0.1       localhost9
> 127.0.0.1       localhost10
> 127.0.0.1       localhost11
> 127.0.0.1       localhost12
> 127.0.0.1       localhost13
> 127.0.0.1       localhost14
> 127.0.0.1       localhost15
> This way you can start DataNodes, and TaskTrackers (up to 16 of them) with unique hostnames.
> Also, I changed all the places that used to call InetAddress.getLocalHost().getHostName() to get it from a new method in Configuration (this issue is the same as http://issues.apache.org/jira/browse/HADOOP-197 ).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:22:11 2006
Return-Path: 
 <hadoop-dev-return-1594-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 173 invoked from network); 23 May 2006 22:22:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:22:11 -0000
Received: (qmail 13963 invoked by uid 500); 23 May 2006 22:22:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13837 invoked by uid 500); 23 May 2006 22:22:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13828 invoked by uid 99); 23 May 2006 22:22:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:22:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:22:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 931A8714283
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 22:21:30 +0000 (GMT)
Message-ID: <10982958.1148422890599.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 22:21:30 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-214) ClusterTestDFS fails
In-Reply-To: <7144677.1147463408861.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-214?page=all ]

alan wootton updated HADOOP-214:
--------------------------------

    Attachment: ClusterTestFixes.patch

patch to fix dfs cluster tests.

> ClusterTestDFS fails
> --------------------
>
>          Key: HADOOP-214
>          URL: http://issues.apache.org/jira/browse/HADOOP-214
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>  Environment: local workstation (windows) 
>     Reporter: alan wootton
>  Attachments: ClusterTestFixes.patch, fix_clustertestdfs.patch
>
> The dfs unit tests, from the ant target 'cluster' have been failing. (ClusterTestDFSNamespaceLogging, ClusterTestDFS). I don't know if anyone but me cares about these tests, but I do. I would like to write better tests for dns. I think we all need that.
> They have been partially broken since  "test.dfs.same.host.targets.allowed" went away and replication ceased for these tests. 
> They got really broken when NameNode stopped automatically formatting itself .
> Since they seem to be ignored, I took the liberty of changing how they work.
> The main thing is, you must put this into your hosts file:
> 127.0.0.1       localhost0
> 127.0.0.1       localhost1
> 127.0.0.1       localhost2
> 127.0.0.1       localhost3
> 127.0.0.1       localhost4
> 127.0.0.1       localhost5
> 127.0.0.1       localhost6
> 127.0.0.1       localhost7
> 127.0.0.1       localhost8
> 127.0.0.1       localhost9
> 127.0.0.1       localhost10
> 127.0.0.1       localhost11
> 127.0.0.1       localhost12
> 127.0.0.1       localhost13
> 127.0.0.1       localhost14
> 127.0.0.1       localhost15
> This way you can start DataNodes, and TaskTrackers (up to 16 of them) with unique hostnames.
> Also, I changed all the places that used to call InetAddress.getLocalHost().getHostName() to get it from a new method in Configuration (this issue is the same as http://issues.apache.org/jira/browse/HADOOP-197 ).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:26:11 2006
Return-Path: 
 <hadoop-dev-return-1595-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3185 invoked from network); 23 May 2006 22:26:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:26:11 -0000
Received: (qmail 23473 invoked by uid 500); 23 May 2006 22:26:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23456 invoked by uid 500); 23 May 2006 22:26:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23447 invoked by uid 99); 23 May 2006 22:26:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:26:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:26:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9A745714283
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 22:25:30 +0000 (GMT)
Message-ID: <33452247.1148423130629.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 22:25:30 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12413017 ] 

Konstantin Shvachko commented on HADOOP-210:
--------------------------------------------

I thought that we might want to use java reflections to make versioning support more generic.
This would require some programming discipline and the reflection framework will do the rest.

So I suppose that all classes that require versioning implement Versioned (let me know if the
name does not sound right) interface that should include getVersion() method.
Additionally all versions of the same class should implement the same interface, which declares
methods that are version dependent.
For example lets consider the INode class.

public class INode implements INodeReader, Versioned {
    String name;
    int nrBlocks;
....
}

INodeReader is the interface that declares e.g. only one method readFields( in )
and each version of  INode  should implement this interface.
For each field declared in the INode class we must have corresponding methods
get<fieldName>
set<fieldName>
setDefault<fieldName>
For now I assume that all fields are of primitive types, and that version transition
means adding or removing fields in the class only.

Then we should have a procedure of retiring old versions, which I see as renaming
the package of the Versioned class such that it includes version number. E.g.
org.apache.hadoop.dfs.INode
is renamed to
org.apache.hadoop.dfs.v0.INode
if the old  version is 0 and the new one is 1.
The retired classes are placed in a separate jar file.
I didn't think whether the retiring can be automated with an ant script or not.

Finally we have VersionFactory class, which can be either
a member or a superclass of INode.
The implementation of readFields is simple:
INode.readFields( in ) {
    int storedVersion = in.readVersion();
    VersionFactory.read( getCurrentVersion(), storedVersion, this );
}

And then VersionFactory.read() does the actual job.
VersionFactory.read( targetVersion, sourceVersion, targetClass ) {
    get class name of the required version base on targetClass name and sourceVersion;
    construct the sourceClass;
    if class not found report return that the version is not supported;
    targetFields = targetClass.getFields() and sort them lexicographically by field name;
    sourceFields = sourceClass.getFields() and sort them lexicographically by field name;
    Then we scan the two lists.
    If both of them contain field A (of type T) then {
       // this common field of the two versions
       T value = in.readT();
        and then invoke targetClass.setA( value )
    }
    If field A is contained only in targetClass {
        // this is a new field
        invoke targetClass.setDefaultA();
    }
    if field A belongs only to sourceClass {
       // this field was removed in the new version
       T value = in.readT();
        and do not assign it to anything;
    }
}

Advantages:
That way we can read data from any previous version not only the preceding one.
And when defining a new version of the class we do not need to have any knowledge
of the previous version(s).
Also we can and should have many Versioned classes (for INode, for add, delete,
rename operation logs, ...) but we can use the same VersionFactory for all of them.



> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:39:11 2006
Return-Path: 
 <hadoop-dev-return-1596-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7818 invoked from network); 23 May 2006 22:39:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:39:11 -0000
Received: (qmail 48214 invoked by uid 500); 23 May 2006 22:39:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48188 invoked by uid 500); 23 May 2006 22:39:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48179 invoked by uid 99); 23 May 2006 22:39:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:39:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:39:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B08F471423B
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 22:38:30 +0000 (GMT)
Message-ID: <14055974.1148423910720.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 22:38:30 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12413019 ] 

Konstantin Shvachko commented on HADOOP-210:
--------------------------------------------

Sorry put the comment in a wrong thread.

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:39:12 2006
Return-Path: 
 <hadoop-dev-return-1597-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7848 invoked from network); 23 May 2006 22:39:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:39:12 -0000
Received: (qmail 48417 invoked by uid 500); 23 May 2006 22:39:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48334 invoked by uid 500); 23 May 2006 22:39:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48324 invoked by uid 99); 23 May 2006 22:39:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:39:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:39:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 974C6714283
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 22:38:31 +0000 (GMT)
Message-ID: <624837.1148423911617.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 22:38:31 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12413020 ] 

Konstantin Shvachko commented on HADOOP-224:
--------------------------------------------

 I thought that we might want to use java reflections to make versioning support more generic.
This would require some programming discipline and the reflection framework will do the rest.

So I suppose that all classes that require versioning implement Versioned (let me know if the
name does not sound right) interface that should include getVersion() method.
Additionally all versions of the same class should implement the same interface, which declares
methods that are version dependent.
For example lets consider the INode class.

public class INode implements INodeReader, Versioned {
    String name;
    int nrBlocks;
....
}

INodeReader is the interface that declares e.g. only one method readFields( in )
and each version of INode should implement this interface.
For each field declared in the INode class we must have corresponding methods
get<fieldName>
set<fieldName>
setDefault<fieldName>
For now I assume that all fields are of primitive types, and that version transition
means adding or removing fields in the class only.

Then we should have a procedure of retiring old versions, which I see as renaming
the package of the Versioned class such that it includes version number. E.g.
org.apache.hadoop.dfs.INode
is renamed to
org.apache.hadoop.dfs.v0.INode
if the old version is 0 and the new one is 1.
The retired classes are placed in a separate jar file.
I didn't think whether the retiring can be automated with an ant script or not.

Finally we have VersionFactory class, which can be either
a member or a superclass of INode.
The implementation of readFields is simple:
INode.readFields( in ) {
    int storedVersion = in.readVersion();
    VersionFactory.read( getCurrentVersion(), storedVersion, this );
}

And then VersionFactory.read() does the actual job.
VersionFactory.read( targetVersion, sourceVersion, targetClass ) {
    get class name of the required version base on targetClass name and sourceVersion;
    construct the sourceClass;
    if class not found report return that the version is not supported;
    targetFields = targetClass.getFields() and sort them lexicographically by field name;
    sourceFields = sourceClass.getFields() and sort them lexicographically by field name;
    Then we scan the two lists.
    If both of them contain field A (of type T) then {
       // this common field of the two versions
       T value = in.readT();
        and then invoke targetClass.setA( value )
    }
    If field A is contained only in targetClass {
        // this is a new field
        invoke targetClass.setDefaultA();
    }
    if field A belongs only to sourceClass {
       // this field was removed in the new version
       T value = in.readT();
        and do not assign it to anything;
    }
}

Advantages:
That way we can read data from any previous version not only the preceding one.
And when defining a new version of the class we do not need to have any knowledge
of the previous version(s).
Also we can and should have many Versioned classes (for INode, for add, delete,
rename operation logs, ...) but we can use the same VersionFactory for all of them.



> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:41:10 2006
Return-Path: 
 <hadoop-dev-return-1598-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8532 invoked from network); 23 May 2006 22:41:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:41:10 -0000
Received: (qmail 50545 invoked by uid 500); 23 May 2006 22:41:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50522 invoked by uid 500); 23 May 2006 22:41:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50513 invoked by uid 99); 23 May 2006 22:41:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:41:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:41:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7E0BD71423B
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 22:40:30 +0000 (GMT)
Message-ID: <12675784.1148424030513.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 22:40:30 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-210?page=all ]

Konstantin Shvachko updated HADOOP-210:
---------------------------------------

    Comment: was deleted

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:43:11 2006
Return-Path: 
 <hadoop-dev-return-1599-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10200 invoked from network); 23 May 2006 22:43:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:43:11 -0000
Received: (qmail 55064 invoked by uid 500); 23 May 2006 22:43:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55044 invoked by uid 500); 23 May 2006 22:43:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55035 invoked by uid 99); 23 May 2006 22:43:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:43:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:43:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 89AB371423B
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 22:42:30 +0000 (GMT)
Message-ID: <20090895.1148424150561.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 22:42:30 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-210?page=all ]

Konstantin Shvachko updated HADOOP-210:
---------------------------------------

    Comment: was deleted

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:58:11 2006
Return-Path: 
 <hadoop-dev-return-1600-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15592 invoked from network); 23 May 2006 22:58:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:58:11 -0000
Received: (qmail 80136 invoked by uid 500); 23 May 2006 22:58:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80111 invoked by uid 500); 23 May 2006 22:58:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80102 invoked by uid 99); 23 May 2006 22:58:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:58:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:58:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 01021714283
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 22:57:31 +0000 (GMT)
Message-ID: <27252797.1148425051001.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 22:57:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-205) the job tracker does not schedule
 enough map on the cluster
In-Reply-To: <10031675.1147208284547.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-205?page=all ]
     
Doug Cutting resolved HADOOP-205:
---------------------------------

    Fix Version: 0.3
                     (was: 0.4)
     Resolution: Fixed
      Assign To: Mahadev konar  (was: Owen O'Malley)

I just committed this.  Thanks, Mahadev!

> the job tracker does not schedule enough map on the cluster
> -----------------------------------------------------------
>
>          Key: HADOOP-205
>          URL: http://issues.apache.org/jira/browse/HADOOP-205
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Mahadev konar
>      Fix For: 0.3
>  Attachments: maplaunch.patch
>
> The job tracker during my big sort runs only has 80-120 maps running at a time with 2 tasks/node and 179 nodes and a large queue of map tasks. It seems to be caused by the load balancing using the current load rather than the required load to run all of the queued tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 22:59:03 2006
Return-Path: 
 <hadoop-dev-return-1601-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16209 invoked from network); 23 May 2006 22:59:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 22:59:03 -0000
Received: (qmail 83207 invoked by uid 500); 23 May 2006 22:59:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83180 invoked by uid 500); 23 May 2006 22:59:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83171 invoked by uid 99); 23 May 2006 22:59:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:59:03 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.28] (HELO mrout2-b.corp.dcn.yahoo.com)
 (216.109.112.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 15:59:01 -0700
Received: from [172.21.39.56] (finishship-lm.corp.yahoo.com [172.21.39.56])
	by mrout2-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k4NMwM95015501
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 15:58:23 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:to:message-id:content-type:from:subject:date:x-mailer;
	b=v6CJvIkXv26C4jW/i2stxOJC4pWFnNSWxwxLHOlH+FSZLgE0gsZvqIr2ojoen8XU
Mime-Version: 1.0 (Apple Message framework v750)
To: hadoop-dev@lucene.apache.org
Message-Id: <62D5D3C5-9F86-451F-BDAC-E6EDCB746312@yahoo-inc.com>
Content-Type: multipart/mixed; boundary=Apple-Mail-21-466841264
From: Ben Reed <breed@yahoo-inc.com>
Subject: Making the elephant run
Date: Tue, 23 May 2006 16:00:49 -0700
X-Mailer: Apple Mail (2.750)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-21-466841264
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed

Actually, these patches are really just to make Hadoop start  
trotting. It is still at least an order of magnitude slower than it  
should be, but I think these patches are a good start.

I've created two patches for clarity. They are not independent, but  
could easily be made so.

The disk-zoom patch is a performance trifecta: less disk IO, less  
disk space, less CPU, and overall a tremendous improvement. The patch  
is based on the following observation: every piece of data from a map  
hits the disk once on the mapper, and 3 (+plus sorting) times on the  
reducer. Further, the entire input for the reduce step is sorted  
together maximizing the sort time. This patch causes:

1)  the mapper to sort the relatively small fragments at the mapper  
which causes two hits to the disk, but they are smaller files.
2) the reducer copies the map output and may merge (if more than 100  
outputs are present) with a couple of other outputs at copy time. No  
sorting is done since the map outputs are sorted.
3) the reducer  will merge the map outputs on the fly in memory at  
reduce time.

I'm attaching the performance graph (with just the disk-zoom patch)  
to show the results. This benchmark uses a random input and null  
output to remove any DFS performance influences. The cluster of 49  
machines I was running on had limited disk space, so I was only able  
to run to a certain size on unmodified Hadoop. With the patch we use  
1/3 the amount of disk space.

The second patch allows the task tracker to reuse processes to avoid  
the over-head of starting the JVM. While JVM startup is relatively  
fast, restarting a Task causes disk IO and DFS operations that have a  
negative impact on the rest of the system. When a Task finishes,  
rather than exiting, it reads the next task to run from stdin. We  
still isolate the Task runtime from TaskTracker, but we only pay the  
startup penalty once.

This second patch also fixes two performance issues not related to  
JVM reuse. (The reuse just makes the problems glaring.) First, the  
JobTracker counts all jobs not just the running jobs to decide the  
load on a tracker. Second, the TaskTracker should really ask for a  
new Task as soon as one finishes rather than wait the 10 secs.

I've been benchmarking the code alot, but I don't have access to a  
really good cluster to try the code out on, so please treat it as  
experimental. I would love to feedback.

There is another obvious thing to change: ReduceTasks should start  
after the first batch of MapTasks complete, so that 1) they have  
something to do, and 2) they are running on the fastest machines.

thanx
ben



--Apple-Mail-21-466841264--

From MAILER-DAEMON Tue May 23 23:28:10 2006
Return-Path: 
 <hadoop-dev-return-1602-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29320 invoked from network); 23 May 2006 23:28:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 23:28:10 -0000
Received: (qmail 28154 invoked by uid 500); 23 May 2006 23:28:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28025 invoked by uid 500); 23 May 2006 23:28:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28012 invoked by uid 99); 23 May 2006 23:28:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 16:28:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 16:28:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DD996714283
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 23:27:29 +0000 (GMT)
Message-ID: <7950094.1148426849904.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 23:27:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-248) locating map outputs via random
 probing is inefficient
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

locating map outputs via random probing is inefficient
------------------------------------------------------

         Key: HADOOP-248
         URL: http://issues.apache.org/jira/browse/HADOOP-248
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3


Currently the ReduceTaskRunner polls the JobTracker for a random list of map tasks asking for their output locations. It would be better if the JobTracker kept an ordered log and the interface was changed to:

class MapLocationResults {
   public int getTimestamp();
   public MapOutputLocation[] getLocations();
}

interface InterTrackerProtocol {
  ...
  MapLocationResults locateMapOutputs(int prevTimestamp);
} 

with the intention that each time a ReduceTaskRunner calls locateMapOutputs, it passes back the "timestamp" that it got from the previous result. That way, reduces can easily find the new MapOutputs. This should help the "ramp up" when the maps first start finishing.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 23:28:15 2006
Return-Path: 
 <hadoop-dev-return-1603-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29416 invoked from network); 23 May 2006 23:28:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 23:28:15 -0000
Received: (qmail 28727 invoked by uid 500); 23 May 2006 23:28:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28676 invoked by uid 500); 23 May 2006 23:28:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28625 invoked by uid 99); 23 May 2006 23:28:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 16:28:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 16:28:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C83F8714293
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 23:27:32 +0000 (GMT)
Message-ID: <5745315.1148426852817.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 23:27:32 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-247) The Reduce Task thread for reporting
 progress during the sort exits in case of any IOException
In-Reply-To: <8121535.1148417549865.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-247?page=all ]
     
Doug Cutting resolved HADOOP-247:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

I just committed this.  Thanks, Mahadev!

> The Reduce Task thread for reporting progress during the sort exits in case of any IOException
> ----------------------------------------------------------------------------------------------
>
>          Key: HADOOP-247
>          URL: http://issues.apache.org/jira/browse/HADOOP-247
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: sortprogress.patch
>
> The Reduce task thread for reporting progress during the sort, exits in case of any exception (except InterruptedException). The solution would be to continue the thread in case of an exception.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 23 23:41:11 2006
Return-Path: 
 <hadoop-dev-return-1604-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34456 invoked from network); 23 May 2006 23:41:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 May 2006 23:41:11 -0000
Received: (qmail 48982 invoked by uid 500); 23 May 2006 23:41:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48961 invoked by uid 500); 23 May 2006 23:41:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48952 invoked by uid 99); 23 May 2006 23:41:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 16:41:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 16:41:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 25DF571423B
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 23:40:31 +0000 (GMT)
Message-ID: <2857058.1148427631152.JavaMail.jira@brutus>
Date: Tue, 23 May 2006 23:40:31 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-241) TestCopyFiles fails under cygwin due
 to incorrect path
In-Reply-To: <17055124.1148408609943.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-241?page=all ]

Milind Bhandarkar updated HADOOP-241:
-------------------------------------

    Attachment: hadoop-241.patch

First bug was in the test iself, which was using string instead of Path to construct a path. That was fixed. The second bug was that when Namenode was made to stop from MiniDFSCluster, it was correctly closing FSNamesystem, but it was not closing the FSDirectory. As a result the editlog was never getting closed. On Windows, when it was trying to create the MiniDFSCluster again, it could not format the namedir because the editlog was still not closed. Fixed it.

> TestCopyFiles fails under cygwin due to incorrect path
> ------------------------------------------------------
>
>          Key: HADOOP-241
>          URL: http://issues.apache.org/jira/browse/HADOOP-241
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>  Environment: Windows
>     Reporter: Konstantin Shvachko
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>  Attachments: hadoop-241.patch
>
> Under cygwin TestCopyFiles generates an incorrect url which includes windows style path.
> This is the result of concatenation of a win path with unix path.
> File.getPath() should be used to produce a consistent path.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 00:13:11 2006
Return-Path: 
 <hadoop-dev-return-1605-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43104 invoked from network); 24 May 2006 00:13:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 00:13:11 -0000
Received: (qmail 80742 invoked by uid 500); 24 May 2006 00:13:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80716 invoked by uid 500); 24 May 2006 00:13:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80707 invoked by uid 99); 24 May 2006 00:13:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:13:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:13:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 112C2714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 00:12:31 +0000 (GMT)
Message-ID: <19516159.1148429551067.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 00:12:31 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-245) record io translator doesn't strip
 path names
In-Reply-To: <13294037.1148416949918.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-245?page=all ]

Milind Bhandarkar updated HADOOP-245:
-------------------------------------

    Attachment: hadoop-245-246.patch

Fixed. This patch also includes fix for a bug HADOOP-246, plus much needed Javadoc in some parts of recordIO.

> record io translator doesn't strip path names
> ---------------------------------------------
>
>          Key: HADOOP-245
>          URL: http://issues.apache.org/jira/browse/HADOOP-245
>      Project: Hadoop
>         Type: Bug

>   Components: record
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Milind Bhandarkar
>  Attachments: hadoop-245-246.patch
>
> When I run the record translator with a pathname, the path name is not stripped. So for example:
> % bin/rcc --language c++ foo/bar/bat.jr
> generates:
> foo/bar/bat.jr.hh (instead of ./bat.jr.hh)
> and the first line is #ifndef __FOO/BAR/BAT_JR_HH__
> the first was unexpected and the second is clearly wrong.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 00:15:11 2006
Return-Path: 
 <hadoop-dev-return-1606-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44241 invoked from network); 24 May 2006 00:15:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 00:15:11 -0000
Received: (qmail 81650 invoked by uid 500); 24 May 2006 00:15:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81631 invoked by uid 500); 24 May 2006 00:15:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81622 invoked by uid 99); 24 May 2006 00:15:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:15:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:15:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 059CE714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 00:14:31 +0000 (GMT)
Message-ID: <10948059.1148429671020.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 00:14:31 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-246) the record-io generated c++ has
 wrong comments
In-Reply-To: <3975508.1148417189940.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-246?page=comments#action_12413038 ] 

Milind Bhandarkar commented on HADOOP-246:
------------------------------------------

I have attached a patch to hadoop-245 that includes a fix for this bug as well. Repeated opening and closing of namespaces does not cause any runtime inefficiency. (and probably very small compile-time inefficiency.) However it makes the code generator hairier than it needs to be. That is why I open and close namespaces for each record independently.

> the record-io generated c++ has wrong comments
> ----------------------------------------------
>
>          Key: HADOOP-246
>          URL: http://issues.apache.org/jira/browse/HADOOP-246
>      Project: Hadoop
>         Type: Bug

>   Components: record
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Milind Bhandarkar

>
> The comments on the namespaces on the closing come out backward:
> } // end namespace org
> } // end namespace apache
> } // end namespace hadoop
> } // end namespace record
> } // end namespace test

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 00:51:10 2006
Return-Path: 
 <hadoop-dev-return-1607-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50796 invoked from network); 24 May 2006 00:51:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 00:51:10 -0000
Received: (qmail 3233 invoked by uid 500); 24 May 2006 00:51:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3207 invoked by uid 500); 24 May 2006 00:51:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3198 invoked by uid 99); 24 May 2006 00:51:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:51:09 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:51:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D16F4714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 00:50:29 +0000 (GMT)
Message-ID: <12945804.1148431829854.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 00:50:29 +0000 (GMT+00:00)
From: "Benjamin Reed (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-249) Improving Map -> Reduce performance
 and Task JVM reuse
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Improving Map -> Reduce performance and Task JVM reuse
------------------------------------------------------

         Key: HADOOP-249
         URL: http://issues.apache.org/jira/browse/HADOOP-249
     Project: Hadoop
        Type: Improvement

    Versions: 0.3    
    Reporter: Benjamin Reed


These patches are really just to make Hadoop start trotting. It is still at least an order of magnitude slower than it should be, but I think these patches are a good start.

I've created two patches for clarity. They are not independent, but could easily be made so.

The disk-zoom patch is a performance trifecta: less disk IO, less disk space, less CPU, and overall a tremendous improvement. The patch is based on the following observation: every piece of data from a map hits the disk once on the mapper, and 3 (+plus sorting) times on the reducer. Further, the entire input for the reduce step is sorted together maximizing the sort time. This patch causes:

1)  the mapper to sort the relatively small fragments at the mapper which causes two hits to the disk, but they are smaller files.
2) the reducer copies the map output and may merge (if more than 100 outputs are present) with a couple of other outputs at copy time. No sorting is done since the map outputs are sorted.
3) the reducer  will merge the map outputs on the fly in memory at reduce time.

I'm attaching the performance graph (with just the disk-zoom patch) to show the results. This benchmark uses a random input and null output to remove any DFS performance influences. The cluster of 49 machines I was running on had limited disk space, so I was only able to run to a certain size on unmodified Hadoop. With the patch we use 1/3 the amount of disk space.

The second patch allows the task tracker to reuse processes to avoid the over-head of starting the JVM. While JVM startup is relatively fast, restarting a Task causes disk IO and DFS operations that have a negative impact on the rest of the system. When a Task finishes, rather than exiting, it reads the next task to run from stdin. We still isolate the Task runtime from TaskTracker, but we only pay the startup penalty once.

This second patch also fixes two performance issues not related to JVM reuse. (The reuse just makes the problems glaring.) First, the JobTracker counts all jobs not just the running jobs to decide the load on a tracker. Second, the TaskTracker should really ask for a new Task as soon as one finishes rather than wait the 10 secs.

I've been benchmarking the code alot, but I don't have access to a really good cluster to try the code out on, so please treat it as experimental. I would love to feedback.

There is another obvious thing to change: ReduceTasks should start after the first batch of MapTasks complete, so that 1) they have something to do, and 2) they are running on the fastest machines.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 00:53:15 2006
Return-Path: 
 <hadoop-dev-return-1608-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51172 invoked from network); 24 May 2006 00:53:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 00:53:15 -0000
Received: (qmail 5636 invoked by uid 500); 24 May 2006 00:53:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5502 invoked by uid 500); 24 May 2006 00:53:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5492 invoked by uid 99); 24 May 2006 00:53:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:53:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:53:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ABFCA714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 00:52:31 +0000 (GMT)
Message-ID: <15508820.1148431951701.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 00:52:31 +0000 (GMT+00:00)
From: "Benjamin Reed (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-249) Improving Map -> Reduce performance
 and Task JVM reuse
In-Reply-To: <12945804.1148431829854.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-249?page=all ]

Benjamin Reed updated HADOOP-249:
---------------------------------

    Attachment: image001.png

> Improving Map -> Reduce performance and Task JVM reuse
> ------------------------------------------------------
>
>          Key: HADOOP-249
>          URL: http://issues.apache.org/jira/browse/HADOOP-249
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.3
>     Reporter: Benjamin Reed
>  Attachments: disk_zoom.patch, image001.png, task_zoom.patch
>
> These patches are really just to make Hadoop start trotting. It is still at least an order of magnitude slower than it should be, but I think these patches are a good start.
> I've created two patches for clarity. They are not independent, but could easily be made so.
> The disk-zoom patch is a performance trifecta: less disk IO, less disk space, less CPU, and overall a tremendous improvement. The patch is based on the following observation: every piece of data from a map hits the disk once on the mapper, and 3 (+plus sorting) times on the reducer. Further, the entire input for the reduce step is sorted together maximizing the sort time. This patch causes:
> 1)  the mapper to sort the relatively small fragments at the mapper which causes two hits to the disk, but they are smaller files.
> 2) the reducer copies the map output and may merge (if more than 100 outputs are present) with a couple of other outputs at copy time. No sorting is done since the map outputs are sorted.
> 3) the reducer  will merge the map outputs on the fly in memory at reduce time.
> I'm attaching the performance graph (with just the disk-zoom patch) to show the results. This benchmark uses a random input and null output to remove any DFS performance influences. The cluster of 49 machines I was running on had limited disk space, so I was only able to run to a certain size on unmodified Hadoop. With the patch we use 1/3 the amount of disk space.
> The second patch allows the task tracker to reuse processes to avoid the over-head of starting the JVM. While JVM startup is relatively fast, restarting a Task causes disk IO and DFS operations that have a negative impact on the rest of the system. When a Task finishes, rather than exiting, it reads the next task to run from stdin. We still isolate the Task runtime from TaskTracker, but we only pay the startup penalty once.
> This second patch also fixes two performance issues not related to JVM reuse. (The reuse just makes the problems glaring.) First, the JobTracker counts all jobs not just the running jobs to decide the load on a tracker. Second, the TaskTracker should really ask for a new Task as soon as one finishes rather than wait the 10 secs.
> I've been benchmarking the code alot, but I don't have access to a really good cluster to try the code out on, so please treat it as experimental. I would love to feedback.
> There is another obvious thing to change: ReduceTasks should start after the first batch of MapTasks complete, so that 1) they have something to do, and 2) they are running on the fastest machines.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 00:53:15 2006
Return-Path: 
 <hadoop-dev-return-1609-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51177 invoked from network); 24 May 2006 00:53:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 00:53:15 -0000
Received: (qmail 5666 invoked by uid 500); 24 May 2006 00:53:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5512 invoked by uid 500); 24 May 2006 00:53:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5500 invoked by uid 99); 24 May 2006 00:53:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:53:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 17:53:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 90DE3714293
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 00:52:32 +0000 (GMT)
Message-ID: <15380424.1148431952590.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 00:52:32 +0000 (GMT+00:00)
From: "Benjamin Reed (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-249) Improving Map -> Reduce performance
 and Task JVM reuse
In-Reply-To: <12945804.1148431829854.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-249?page=all ]

Benjamin Reed updated HADOOP-249:
---------------------------------

    Attachment: disk_zoom.patch
                task_zoom.patch

> Improving Map -> Reduce performance and Task JVM reuse
> ------------------------------------------------------
>
>          Key: HADOOP-249
>          URL: http://issues.apache.org/jira/browse/HADOOP-249
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.3
>     Reporter: Benjamin Reed
>  Attachments: disk_zoom.patch, image001.png, task_zoom.patch
>
> These patches are really just to make Hadoop start trotting. It is still at least an order of magnitude slower than it should be, but I think these patches are a good start.
> I've created two patches for clarity. They are not independent, but could easily be made so.
> The disk-zoom patch is a performance trifecta: less disk IO, less disk space, less CPU, and overall a tremendous improvement. The patch is based on the following observation: every piece of data from a map hits the disk once on the mapper, and 3 (+plus sorting) times on the reducer. Further, the entire input for the reduce step is sorted together maximizing the sort time. This patch causes:
> 1)  the mapper to sort the relatively small fragments at the mapper which causes two hits to the disk, but they are smaller files.
> 2) the reducer copies the map output and may merge (if more than 100 outputs are present) with a couple of other outputs at copy time. No sorting is done since the map outputs are sorted.
> 3) the reducer  will merge the map outputs on the fly in memory at reduce time.
> I'm attaching the performance graph (with just the disk-zoom patch) to show the results. This benchmark uses a random input and null output to remove any DFS performance influences. The cluster of 49 machines I was running on had limited disk space, so I was only able to run to a certain size on unmodified Hadoop. With the patch we use 1/3 the amount of disk space.
> The second patch allows the task tracker to reuse processes to avoid the over-head of starting the JVM. While JVM startup is relatively fast, restarting a Task causes disk IO and DFS operations that have a negative impact on the rest of the system. When a Task finishes, rather than exiting, it reads the next task to run from stdin. We still isolate the Task runtime from TaskTracker, but we only pay the startup penalty once.
> This second patch also fixes two performance issues not related to JVM reuse. (The reuse just makes the problems glaring.) First, the JobTracker counts all jobs not just the running jobs to decide the load on a tracker. Second, the TaskTracker should really ask for a new Task as soon as one finishes rather than wait the 10 secs.
> I've been benchmarking the code alot, but I don't have access to a really good cluster to try the code out on, so please treat it as experimental. I would love to feedback.
> There is another obvious thing to change: ReduceTasks should start after the first batch of MapTasks complete, so that 1) they have something to do, and 2) they are running on the fastest machines.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 01:00:06 2006
Return-Path: 
 <hadoop-dev-return-1610-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52566 invoked from network); 24 May 2006 01:00:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 01:00:06 -0000
Received: (qmail 12283 invoked by uid 500); 24 May 2006 01:00:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12262 invoked by uid 500); 24 May 2006 01:00:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12253 invoked by uid 99); 24 May 2006 01:00:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 18:00:06 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 18:00:05 -0700
Received: from [172.21.39.56] (finishship-lm.corp.yahoo.com [172.21.39.56])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k4O0xLq4008470
	for <hadoop-dev@lucene.apache.org>; Tue, 23 May 2006 17:59:21 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:in-reply-to:references:content-type:message-id:
	content-transfer-encoding:from:subject:date:to:x-mailer;
	b=ZuCBvLKHrPuoQ0WWAmMtf3XC0+YLPTd6TOTUAWerQXBF1btSxSjh5t9QSH/6UWoy
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <62D5D3C5-9F86-451F-BDAC-E6EDCB746312@yahoo-inc.com>
References: <62D5D3C5-9F86-451F-BDAC-E6EDCB746312@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <00F20C3A-3C2B-44D0-A0EC-9C244BC028C3@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Ben Reed <breed@yahoo-inc.com>
Subject: Re: Making the elephant run
Date: Tue, 23 May 2006 18:01:47 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Sorry, I forgot that attachments don't work for me on the list...  
I've opened an issue and put the attachments there. Issue #249  
Improving Map -> Reduce performance..

thanx
ben

On May 23, 2006, at 4:00 PM, Ben Reed wrote:

> Actually, these patches are really just to make Hadoop start  
> trotting. It is still at least an order of magnitude slower than it  
> should be, but I think these patches are a good start.
>
> I've created two patches for clarity. They are not independent, but  
> could easily be made so.
>
> The disk-zoom patch is a performance trifecta: less disk IO, less  
> disk space, less CPU, and overall a tremendous improvement. The  
> patch is based on the following observation: every piece of data  
> from a map hits the disk once on the mapper, and 3 (+plus sorting)  
> times on the reducer. Further, the entire input for the reduce step  
> is sorted together maximizing the sort time. This patch causes:
>
> 1)  the mapper to sort the relatively small fragments at the mapper  
> which causes two hits to the disk, but they are smaller files.
> 2) the reducer copies the map output and may merge (if more than  
> 100 outputs are present) with a couple of other outputs at copy  
> time. No sorting is done since the map outputs are sorted.
> 3) the reducer  will merge the map outputs on the fly in memory at  
> reduce time.
>
> I'm attaching the performance graph (with just the disk-zoom patch)  
> to show the results. This benchmark uses a random input and null  
> output to remove any DFS performance influences. The cluster of 49  
> machines I was running on had limited disk space, so I was only  
> able to run to a certain size on unmodified Hadoop. With the patch  
> we use 1/3 the amount of disk space.
>
> The second patch allows the task tracker to reuse processes to  
> avoid the over-head of starting the JVM. While JVM startup is  
> relatively fast, restarting a Task causes disk IO and DFS  
> operations that have a negative impact on the rest of the system.  
> When a Task finishes, rather than exiting, it reads the next task  
> to run from stdin. We still isolate the Task runtime from  
> TaskTracker, but we only pay the startup penalty once.
>
> This second patch also fixes two performance issues not related to  
> JVM reuse. (The reuse just makes the problems glaring.) First, the  
> JobTracker counts all jobs not just the running jobs to decide the  
> load on a tracker. Second, the TaskTracker should really ask for a  
> new Task as soon as one finishes rather than wait the 10 secs.
>
> I've been benchmarking the code alot, but I don't have access to a  
> really good cluster to try the code out on, so please treat it as  
> experimental. I would love to feedback.
>
> There is another obvious thing to change: ReduceTasks should start  
> after the first batch of MapTasks complete, so that 1) they have  
> something to do, and 2) they are running on the fastest machines.
>
> thanx
> ben
>
>


From MAILER-DAEMON Wed May 24 05:06:13 2006
Return-Path: 
 <hadoop-dev-return-1611-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13166 invoked from network); 24 May 2006 05:06:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 05:06:13 -0000
Received: (qmail 9352 invoked by uid 500); 24 May 2006 05:06:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9187 invoked by uid 500); 24 May 2006 05:06:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9157 invoked by uid 99); 24 May 2006 05:06:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:06:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:06:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A9AD671423B
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 05:05:30 +0000 (GMT)
Message-ID: <7727792.1148447130692.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 05:05:30 +0000 (GMT+00:00)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12413065 ] 

eric baldeschwieler commented on HADOOP-224:
--------------------------------------------

Maybe I'm missing something, but this seems to be moving a lot of crud into the runtime type that doesn't belong there.  IMO we should segregate runtime data structures from serialization as much as possible and not complicate the main code with backwards compatibility code.

We want to segregate backwards compatibility code, not embed it into every class if possible.

I had the same reaction to milinds suggestions.  All this OO code just seems to be complicating simple serialization and versioning problems IMO.  I want this stuff to be so simple even a manager can understand it.  Let's separate the file formats from the runtime classes if possible.

I care much more about keeping the mainline simple then about infinite backwards compatibility.  What if we just have a completely separate utility that is invoked if we hit an old file that handles the whole thing?

<grumble/>

> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar

>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 05:08:11 2006
Return-Path: 
 <hadoop-dev-return-1612-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13268 invoked from network); 24 May 2006 05:08:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 05:08:11 -0000
Received: (qmail 9816 invoked by uid 500); 24 May 2006 05:08:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9688 invoked by uid 500); 24 May 2006 05:08:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9679 invoked by uid 99); 24 May 2006 05:08:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:08:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:08:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CF4771423B
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 05:07:30 +0000 (GMT)
Message-ID: <19206667.1148447250574.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 05:07:30 +0000 (GMT+00:00)
From: "Anonymous (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-240) namenode should not log failed mkdirs
 at warning level
In-Reply-To: <10933304.1148404889830.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-240?page=all ]

 updated HADOOP-240:
--------------------

    Attachment: mkdir_new.patch

> namenode should not log failed mkdirs at warning level
> ------------------------------------------------------
>
>          Key: HADOOP-240
>          URL: http://issues.apache.org/jira/browse/HADOOP-240
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor
>  Attachments: mkdir.patch, mkdir_new.patch
>
> when a namenode creates a directory, it also recursively tries to creates its parent directories. If they already exist, the lastSuccess is  false and the "error" is logged at the warning level.
> The right approach is to set the logging leve lower to fine or simply ignore the the "error".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 05:12:11 2006
Return-Path: 
 <hadoop-dev-return-1613-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13854 invoked from network); 24 May 2006 05:12:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 05:12:11 -0000
Received: (qmail 12425 invoked by uid 500); 24 May 2006 05:12:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12296 invoked by uid 500); 24 May 2006 05:12:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12287 invoked by uid 99); 24 May 2006 05:12:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:12:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:12:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 912DA71423B
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 05:11:30 +0000 (GMT)
Message-ID: <11767429.1148447490591.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 05:11:30 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-240) namenode should not log failed
 mkdirs at warning level
In-Reply-To: <10933304.1148404889830.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-240?page=comments#action_12413066 ] 

Hairong Kuang commented on HADOOP-240:
--------------------------------------

Just attached a new patch to this issue. Sorry that I forgot to log in.

> namenode should not log failed mkdirs at warning level
> ------------------------------------------------------
>
>          Key: HADOOP-240
>          URL: http://issues.apache.org/jira/browse/HADOOP-240
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor
>  Attachments: mkdir.patch, mkdir_new.patch
>
> when a namenode creates a directory, it also recursively tries to creates its parent directories. If they already exist, the lastSuccess is  false and the "error" is logged at the warning level.
> The right approach is to set the logging leve lower to fine or simply ignore the the "error".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 05:23:11 2006
Return-Path: 
 <hadoop-dev-return-1614-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15173 invoked from network); 24 May 2006 05:23:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 05:23:11 -0000
Received: (qmail 18964 invoked by uid 500); 24 May 2006 05:23:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18943 invoked by uid 500); 24 May 2006 05:23:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18934 invoked by uid 99); 24 May 2006 05:23:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:23:10 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:23:09 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0FC97714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 05:22:30 +0000 (GMT)
Message-ID: <29976966.1148448150061.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 05:22:30 +0000 (GMT+00:00)
From: "Devaraj Das (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-250) HTTP Browsing interface for DFS
 Health/Status
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

HTTP Browsing interface for DFS Health/Status
---------------------------------------------

         Key: HADOOP-250
         URL: http://issues.apache.org/jira/browse/HADOOP-250
     Project: Hadoop
        Type: New Feature

  Components: dfs  
    Versions: 0.3    
    Reporter: Devaraj Das


A web interface to view the DFS health/status (name and data nodes) is to be created. User can connect to the webserver on the namenode and a web page will be displayed. The web page will give some details about that namenode (startup time and the total cluster capacity). The web page will contain a table of 'live' and 'dead' datanodes. Each live datanode will be a link to the complete details of the datanode as given by DatanodeInfo (also see DataNodeReport).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 05:55:49 2006
Return-Path: 
 <hadoop-dev-return-1615-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29657 invoked from network); 24 May 2006 05:55:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 05:55:49 -0000
Received: (qmail 49999 invoked by uid 500); 24 May 2006 05:55:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49860 invoked by uid 500); 24 May 2006 05:55:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49851 invoked by uid 99); 24 May 2006 05:55:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:55:48 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 May 2006 22:55:47 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 04CAC410008
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 05:55:08 +0000 (GMT)
Message-ID: <25069005.1148450108016.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 05:55:08 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-250) HTTP Browsing interface for DFS
 Health/Status
In-Reply-To: <29976966.1148448150061.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-250?page=comments#action_12413068 ] 

Owen O'Malley commented on HADOOP-250:
--------------------------------------

You should be able to use the StatusHttpServer class and add the necessary jsp files for the name node. That will also give you access to the log directories via the web server. It would also make sense to include the free/used disk space on each data node.

> HTTP Browsing interface for DFS Health/Status
> ---------------------------------------------
>
>          Key: HADOOP-250
>          URL: http://issues.apache.org/jira/browse/HADOOP-250
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Devaraj Das

>
> A web interface to view the DFS health/status (name and data nodes) is to be created. User can connect to the webserver on the namenode and a web page will be displayed. The web page will give some details about that namenode (startup time and the total cluster capacity). The web page will contain a table of 'live' and 'dead' datanodes. Each live datanode will be a link to the complete details of the datanode as given by DatanodeInfo (also see DataNodeReport).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 15:49:51 2006
Return-Path: 
 <hadoop-dev-return-1616-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44530 invoked from network); 24 May 2006 15:49:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 15:49:51 -0000
Received: (qmail 77092 invoked by uid 500); 24 May 2006 15:49:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77067 invoked by uid 500); 24 May 2006 15:49:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77058 invoked by uid 99); 24 May 2006 15:49:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 08:49:50 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [74.0.0.77] (HELO linuxfly.dragonflymc.com) (74.0.0.77)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 08:49:49 -0700
Received: from [192.168.1.246] (unknown [63.133.162.98])
	by linuxfly.dragonflymc.com (Postfix) with ESMTP id 414A0C2006C
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 10:50:19 -0500 (CDT)
Message-ID: <44748088.9020603@dragonflymc.com>
Date: Wed, 24 May 2006 10:49:28 -0500
From: Dennis Kubes <nutch-dev@dragonflymc.com>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Debugging DFS and MapReduce through Eclipse
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Has anyone been able to successfully debug DFS and MapReduce servers 
running though eclipse.  I can get all the servers started and can run 
MapReduce tasks inside of eclipse but I am getting both classpath errors 
and debugging stalls.

I am just curious what kinds of setups people have for doing large scale 
development of DFS and MapReduce?

Dennis

From MAILER-DAEMON Wed May 24 15:59:55 2006
Return-Path: 
 <hadoop-dev-return-1617-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49580 invoked from network); 24 May 2006 15:59:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 15:59:55 -0000
Received: (qmail 97555 invoked by uid 500); 24 May 2006 15:59:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97505 invoked by uid 500); 24 May 2006 15:59:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97473 invoked by uid 99); 24 May 2006 15:59:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 08:59:47 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 08:59:46 -0700
Received: from [172.21.39.56] (finishship-lm.corp.yahoo.com [172.21.39.56])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4OFw4OP098389
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 08:58:04 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:in-reply-to:references:content-type:message-id:
	content-transfer-encoding:from:subject:date:to:x-mailer;
	b=lG+XV7h1mV7bHRbLbIa0vh/2WJ2Gh2QQxUEhX3Kyf2hvDat6ASDIwXelczZIGYO6
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <44748088.9020603@dragonflymc.com>
References: <44748088.9020603@dragonflymc.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <F6D23946-47FE-42E7-98A0-337E1024A9B7@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Ben Reed <breed@yahoo-inc.com>
Subject: Re: Debugging DFS and MapReduce through Eclipse
Date: Wed, 24 May 2006 09:00:30 -0700
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I debug using eclipse. For example, if I need to debug JobTracker, I  
put the following lines in the hadoop script:

elif [ "$COMMAND" = "jobtracker" ] ; then
   #HADOOP_OPTS="$HADOOP_OPTS - 
agentlib:jdwp=transport=dt_socket,address=8000,server=y,suspend=y"
   CLASS=org.apache.hadoop.mapred.JobTracker

the I just start everything up using start-all.sh. I should note that  
I always debug code built inside of eclipse. I don't use ant. I just  
import Java projects from SVN and export JAR files.

ben

On May 24, 2006, at 8:49 AM, Dennis Kubes wrote:

> Has anyone been able to successfully debug DFS and MapReduce  
> servers running though eclipse.  I can get all the servers started  
> and can run MapReduce tasks inside of eclipse but I am getting both  
> classpath errors and debugging stalls.
>
> I am just curious what kinds of setups people have for doing large  
> scale development of DFS and MapReduce?
>
> Dennis
>
>


From MAILER-DAEMON Wed May 24 16:55:23 2006
Return-Path: 
 <hadoop-dev-return-1618-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73141 invoked from network); 24 May 2006 16:55:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 16:55:23 -0000
Received: (qmail 14984 invoked by uid 500); 24 May 2006 16:55:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14963 invoked by uid 500); 24 May 2006 16:55:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14954 invoked by uid 99); 24 May 2006 16:55:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 09:55:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [74.0.0.77] (HELO linuxfly.dragonflymc.com) (74.0.0.77)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 09:55:20 -0700
Received: from [192.168.1.246] (unknown [63.133.162.98])
	by linuxfly.dragonflymc.com (Postfix) with ESMTP id 3E6BCC2006C
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 11:54:55 -0500 (CDT)
Message-ID: <44748FAE.6090700@dragonflymc.com>
Date: Wed, 24 May 2006 11:54:06 -0500
From: Dennis Kubes <nutch-dev@dragonflymc.com>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Debugging DFS and MapReduce through Eclipse
References: <44748088.9020603@dragonflymc.com>
 <F6D23946-47FE-42E7-98A0-337E1024A9B7@yahoo-inc.com>
In-Reply-To: <F6D23946-47FE-42E7-98A0-337E1024A9B7@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Ben,

Thanks for the response.  I was trying to set it up to run inside of 
eclipse instead of remote debugging.  And I finally got it working.  I 
have both the nutch and hadoop projects pulled from SVN so I am starting 
the dfs and mapreduce servers from the hadoop codebase.  I am starting 
the servers all on one box inside of eclipse.  Setting up the servers to 
run in psuedo-distributed mode through eclipse is pretty easy, you just 
have to have launchers with the correct configurations (parameters). 

If you want to debug the servers and you want to do it inside of eclipse 
and not through remote debugging (such as is the case if you are doing 
it on windows without cygwin), the setup is not so obvious.  The key is 
when you are creating debug launchers, especially for TaskTracker, you 
have to include the nutch project and the nutch project has to export 
its plugin directory and all the jars in the lib directory.  This way 
the TaskTracker can find the correct plugins and source code when 
running tasks.  Again the key is the classpath of the launchers, not of 
the projects themselves.

If anyone needs a more detailed explanation on how to set this up, send 
me an email.

Dennis

Ben Reed wrote:
> I debug using eclipse. For example, if I need to debug JobTracker, I 
> put the following lines in the hadoop script:
>
> elif [ "$COMMAND" = "jobtracker" ] ; then
>   #HADOOP_OPTS="$HADOOP_OPTS 
> -agentlib:jdwp=transport=dt_socket,address=8000,server=y,suspend=y"
>   CLASS=org.apache.hadoop.mapred.JobTracker
>
> the I just start everything up using start-all.sh. I should note that 
> I always debug code built inside of eclipse. I don't use ant. I just 
> import Java projects from SVN and export JAR files.
>
> ben
>
> On May 24, 2006, at 8:49 AM, Dennis Kubes wrote:
>
>> Has anyone been able to successfully debug DFS and MapReduce servers 
>> running though eclipse.  I can get all the servers started and can 
>> run MapReduce tasks inside of eclipse but I am getting both classpath 
>> errors and debugging stalls.
>>
>> I am just curious what kinds of setups people have for doing large 
>> scale development of DFS and MapReduce?
>>
>> Dennis
>>
>>
>

From MAILER-DAEMON Wed May 24 16:59:12 2006
Return-Path: 
 <hadoop-dev-return-1619-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73857 invoked from network); 24 May 2006 16:59:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 16:59:12 -0000
Received: (qmail 17519 invoked by uid 500); 24 May 2006 16:59:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17387 invoked by uid 500); 24 May 2006 16:59:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17370 invoked by uid 99); 24 May 2006 16:59:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 09:59:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 09:59:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8F6BE7141FA
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 16:58:30 +0000 (GMT)
Message-ID: <17312293.1148489910584.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 16:58:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-195) transfer map output transfer with http
 instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-195?page=all ]

Sameer Paranjpye updated HADOOP-195:
------------------------------------

    Attachment: parallel-copiers.txt

Here's a patch that ought to address a lot of the concerns with the copy phase. The reduce task now launches a small number of threads (default 5) that fetch map outputs in parallel. The difference between this and the parallel RPC is that the parallel fetches are independent of each other, as soon as one copy finishes the next one starts. The parallel RPC send N requests and wait for them all to complete before sending the next N.

Ran Owen's benchmark with this code for a total runtime of 8 hours 53 minutes. Sorting 2000GB on 200 nodes, with 10 parallel fetchers per reduce. The (map+copy) finished in approximately 2.5 hours, so that the bulk of the time was spent in the reduce phase. We saw 41 failures during sort and reduce, which pushed out the total runtime.
Tasktracker latency causing pings and progress reports from the child to fail appears to be the biggest concern at this point.

The copy phase could be speeded further by improving the hit rate at the beginning of the copy. At this time a reduce probes for a random subset of the map outputs
and fetches as many as are available, the fetcher threads are mostly idle early on, and they don't need to be. Having the job tracker furnish a list of maps that have completed since the last query from a tasktracker would go a long way towards addressing this.


The number of parallel copiers per reduce is controlled by the config variable "mapred.reduce.parallel.copiers" the default is 5 


> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls, parallel-copiers.txt
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 17:27:12 2006
Return-Path: 
 <hadoop-dev-return-1620-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84368 invoked from network); 24 May 2006 17:27:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 17:27:12 -0000
Received: (qmail 64238 invoked by uid 500); 24 May 2006 17:27:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64213 invoked by uid 500); 24 May 2006 17:27:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64200 invoked by uid 99); 24 May 2006 17:27:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:27:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:27:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 964237141F9
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 17:26:30 +0000 (GMT)
Message-ID: <5755855.1148491590612.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 17:26:30 +0000 (GMT+00:00)
From: "Milind Bhandarkar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-224?page=all ]

Milind Bhandarkar updated HADOOP-224:
-------------------------------------

    Attachment: hadoop-224.patch

Eric,

I agree. I have attached a patch that simplifies the mainline code, while keeping all the logic for backward compatibility in a different class. The advantage with this is that when you change a format significantly, you just have to write a reader for that, without modifying any earlier versions.

> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar
>  Attachments: hadoop-224.patch
>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 17:40:12 2006
Return-Path: 
 <hadoop-dev-return-1621-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89044 invoked from network); 24 May 2006 17:40:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 17:40:12 -0000
Received: (qmail 96517 invoked by uid 500); 24 May 2006 17:40:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96500 invoked by uid 500); 24 May 2006 17:40:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96491 invoked by uid 99); 24 May 2006 17:40:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:40:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:40:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 97B027141FA
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 17:39:30 +0000 (GMT)
Message-ID: <194973.1148492370618.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 17:39:30 +0000 (GMT+00:00)
From: "Devaraj Das (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-250) HTTP Browsing interface for DFS
 Health/Status
In-Reply-To: <29976966.1148448150061.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-250?page=all ]

Devaraj Das updated HADOOP-250:
-------------------------------

    Attachment: http_browsing_dfs.patch

Attaching a patch which implements the DFS HTTP browsing interface. The default port where the webserver (on the namenode) runs on is 50070. Also attached a screenshot of the webpage.

> HTTP Browsing interface for DFS Health/Status
> ---------------------------------------------
>
>          Key: HADOOP-250
>          URL: http://issues.apache.org/jira/browse/HADOOP-250
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Devaraj Das
>  Attachments: http_browsing_dfs.patch
>
> A web interface to view the DFS health/status (name and data nodes) is to be created. User can connect to the webserver on the namenode and a web page will be displayed. The web page will give some details about that namenode (startup time and the total cluster capacity). The web page will contain a table of 'live' and 'dead' datanodes. Each live datanode will be a link to the complete details of the datanode as given by DatanodeInfo (also see DataNodeReport).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 17:42:12 2006
Return-Path: 
 <hadoop-dev-return-1622-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89617 invoked from network); 24 May 2006 17:42:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 17:42:12 -0000
Received: (qmail 99102 invoked by uid 500); 24 May 2006 17:42:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99083 invoked by uid 500); 24 May 2006 17:42:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99074 invoked by uid 99); 24 May 2006 17:42:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:42:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:42:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8A84A714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 17:41:30 +0000 (GMT)
Message-ID: <30116614.1148492490564.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 17:41:30 +0000 (GMT+00:00)
From: "Devaraj Das (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-250) HTTP Browsing interface for DFS
 Health/Status
In-Reply-To: <29976966.1148448150061.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-250?page=all ]

Devaraj Das updated HADOOP-250:
-------------------------------

    Attachment: dfshealth.pdf

The screen shot of the webpage

> HTTP Browsing interface for DFS Health/Status
> ---------------------------------------------
>
>          Key: HADOOP-250
>          URL: http://issues.apache.org/jira/browse/HADOOP-250
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Devaraj Das
>  Attachments: dfshealth.pdf, http_browsing_dfs.patch
>
> A web interface to view the DFS health/status (name and data nodes) is to be created. User can connect to the webserver on the namenode and a web page will be displayed. The web page will give some details about that namenode (startup time and the total cluster capacity). The web page will contain a table of 'live' and 'dead' datanodes. Each live datanode will be a link to the complete details of the datanode as given by DatanodeInfo (also see DataNodeReport).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 17:49:12 2006
Return-Path: 
 <hadoop-dev-return-1623-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91873 invoked from network); 24 May 2006 17:49:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 17:49:12 -0000
Received: (qmail 7155 invoked by uid 500); 24 May 2006 17:49:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7027 invoked by uid 500); 24 May 2006 17:49:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7018 invoked by uid 99); 24 May 2006 17:49:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:49:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:49:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 973C6714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 17:48:30 +0000 (GMT)
Message-ID: <29338386.1148492910616.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 17:48:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12413154 ] 

Sameer Paranjpye commented on HADOOP-195:
-----------------------------------------

Some more implementation notes:

1) The ReduceTaskRunner queries for map output locations concurrently with the copies. Discovered outputs
are pushed into a queue from which they are pulled by the copiers.
2) Added a new RPC method 'callRaw' which bypasses RPC's connection sharing mechanism. Requests are sent down a socket owned exclusively by the caller. The caller is free to do what he pleases with the connection once the request is complete. This implementation closes the connection immediately so that we don't get lots of idle threads in the tasktrackers.
3) Early runs showed some load imbalances in the copies with lots of reduces pounding a single tasktracker. I've tried to address this by
  a) ensuring that a reduce only copies 1 output from a given host at any time 
  b) introducing a backoff if a copy from some host fails
this seems to works fine for single node and small clusters because the number outputs is also small enough that a lot of parallelism isn't needed
4) Some tasktrackers were running out of memory when 100s of clients connected to them at once. This happened because not enough memory was available to create the threads needed to handle the concurrent connections. This caused tasktrackers to go into a bad state and not service any more client requests while still sending heartbeats to the jobtracker. Tasktrackers now handle OutOfMemory errors gracefully. Of course, this condition no longer manifested once the load balancing code mentioned in 3) was introduced.







> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls, parallel-copiers.txt
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 17:57:12 2006
Return-Path: 
 <hadoop-dev-return-1624-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94782 invoked from network); 24 May 2006 17:57:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 17:57:12 -0000
Received: (qmail 22734 invoked by uid 500); 24 May 2006 17:57:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22716 invoked by uid 500); 24 May 2006 17:57:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22706 invoked by uid 99); 24 May 2006 17:57:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:57:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 10:57:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F0C95714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 17:56:30 +0000 (GMT)
Message-ID: <25800678.1148493390983.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 17:56:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-241) TestCopyFiles fails under cygwin due
 to incorrect path
In-Reply-To: <17055124.1148408609943.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-241?page=all ]
     
Doug Cutting resolved HADOOP-241:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

I just committed this.  Thanks, Milind.

> TestCopyFiles fails under cygwin due to incorrect path
> ------------------------------------------------------
>
>          Key: HADOOP-241
>          URL: http://issues.apache.org/jira/browse/HADOOP-241
>      Project: Hadoop
>         Type: Bug

>   Components: fs
>  Environment: Windows
>     Reporter: Konstantin Shvachko
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: hadoop-241.patch
>
> Under cygwin TestCopyFiles generates an incorrect url which includes windows style path.
> This is the result of concatenation of a win path with unix path.
> File.getPath() should be used to produce a consistent path.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 18:17:12 2006
Return-Path: 
 <hadoop-dev-return-1625-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 5546 invoked from network); 24 May 2006 18:17:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 18:17:12 -0000
Received: (qmail 69157 invoked by uid 500); 24 May 2006 18:17:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69031 invoked by uid 500); 24 May 2006 18:17:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69022 invoked by uid 99); 24 May 2006 18:17:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 11:17:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 11:17:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 96E99714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 18:16:30 +0000 (GMT)
Message-ID: <3572491.1148494590615.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 18:16:30 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12413158 ] 

Konstantin Shvachko commented on HADOOP-224:
--------------------------------------------

> I care much more about keeping the mainline simple then about infinite backwards compatibility.
> What if we just have a completely separate utility that is invoked if we hit an old file that handles the whole thing?

Yes, this is what my approach does. Keeping it simple it works in 2 steps:
- Modify a serializable class as you wish (some restrictions like simple field types are applied)
- Invoke VersionFactory to handle the whole versioning/serialization thing if an old file is hit.
All the complexity is about how that factory works.
Miland's patch, although it simplifies the existing code a lot, has specific serialization methods
or classes (generally) for each version.
I do not, the runtime class does not have knowledge of previous versions, it's the factory that does.


> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar
>  Attachments: hadoop-224.patch
>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 18:29:16 2006
Return-Path: 
 <hadoop-dev-return-1626-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17909 invoked from network); 24 May 2006 18:29:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 18:29:16 -0000
Received: (qmail 4886 invoked by uid 500); 24 May 2006 18:29:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4823 invoked by uid 500); 24 May 2006 18:29:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4641 invoked by uid 99); 24 May 2006 18:29:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 11:29:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 11:29:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 720F9714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 18:28:31 +0000 (GMT)
Message-ID: <19128543.1148495311464.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 18:28:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12413160 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

This is great!

The RPC.callRaw() method really seems like it belongs in Client.java, and should mostly be code that's shared with non-raw calls.  Otherwise we duplicate code: if we change the format of calls on the wire or the way errors are handled, etc. this code will break.

So instead we might:

1. Make RPC.Invocation public.
2. Add a boolean 'newConnection' to Client.call(), adding the signature:
    Writable call(Writable, InetAddress, newConnection);
    This method can be implemented by constructing a Connection instance, but never calling connection.start(), moving the body of Connection.run() to a new method, Connection.getResponse() that can be called from Client.call() when newConnection is specified.

Does this make sense?

This way, e.g., if we want to specify a connect timeout for RPC connections (first creating the socket, then explicitly connecting), change buffer sizes, etc. we can do it in one place.

If there's agreement to clean this up (or that it doesn't need cleaning up!) then I can commit this as-is, and we can clean that up as a subsequent step, so that the patch doesn't grow too huge, the codebase doesn't move, etc.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls, parallel-copiers.txt
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 19:02:14 2006
Return-Path: 
 <hadoop-dev-return-1627-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36432 invoked from network); 24 May 2006 19:02:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 19:02:14 -0000
Received: (qmail 72182 invoked by uid 500); 24 May 2006 19:02:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72054 invoked by uid 500); 24 May 2006 19:02:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72045 invoked by uid 99); 24 May 2006 19:02:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 12:02:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 12:02:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 530067141EE
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 19:01:32 +0000 (GMT)
Message-ID: <32902058.1148497292337.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 19:01:32 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-250) HTTP Browsing interface for DFS
 Health/Status
In-Reply-To: <29976966.1148448150061.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-250?page=comments#action_12413164 ] 

Doug Cutting commented on HADOOP-250:
-------------------------------------

This looks great.  However the method FSNameSystem.getAddress duplicates the logic of DataNode.createSocketAddr.  We should have a single static method for this, and it should probably take a Configuration parameter.  At a minimum, we should call that method rather than copying it.

> HTTP Browsing interface for DFS Health/Status
> ---------------------------------------------
>
>          Key: HADOOP-250
>          URL: http://issues.apache.org/jira/browse/HADOOP-250
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Devaraj Das
>  Attachments: dfshealth.pdf, http_browsing_dfs.patch
>
> A web interface to view the DFS health/status (name and data nodes) is to be created. User can connect to the webserver on the namenode and a web page will be displayed. The web page will give some details about that namenode (startup time and the total cluster capacity). The web page will contain a table of 'live' and 'dead' datanodes. Each live datanode will be a link to the complete details of the datanode as given by DatanodeInfo (also see DataNodeReport).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 19:06:12 2006
Return-Path: 
 <hadoop-dev-return-1628-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37129 invoked from network); 24 May 2006 19:06:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 19:06:12 -0000
Received: (qmail 77513 invoked by uid 500); 24 May 2006 19:06:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77492 invoked by uid 500); 24 May 2006 19:06:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77482 invoked by uid 99); 24 May 2006 19:06:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 12:06:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 12:06:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9B7227141F6
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 19:05:30 +0000 (GMT)
Message-ID: <6101597.1148497530633.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 19:05:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12413166 ] 

Sameer Paranjpye commented on HADOOP-195:
-----------------------------------------

I'd agree that the callRaw stuff belongs in Client.java, I've copied the call dispatch code from Client.sendParam, but that's a violation of abstraction. Really wanted to get this off the ground so I didn't mess too much with the Client code. The approach you outline is the cleaner way to do it.

or

Owen's testing the parallel fetch against an HTTP server by having jetty serve the map outputs and it appears to be working a lot better than the RPC server. If we go that direction, we might decide we don't need 'callRaw' at all since this is the only use case so far.

Either way I can commit to cleaning this up.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls, parallel-copiers.txt
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 19:15:12 2006
Return-Path: 
 <hadoop-dev-return-1629-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39585 invoked from network); 24 May 2006 19:15:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 19:15:12 -0000
Received: (qmail 98154 invoked by uid 500); 24 May 2006 19:15:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98028 invoked by uid 500); 24 May 2006 19:15:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98019 invoked by uid 99); 24 May 2006 19:15:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 12:15:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 12:15:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 83EC17141F9
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 19:14:30 +0000 (GMT)
Message-ID: <7007569.1148498070537.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 19:14:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12413168 ] 

Doug Cutting commented on HADOOP-195:
-------------------------------------

So you'd prefer we commit this as-is & clean it up later?  Or should we hold off a bit & wait for Owen's HTTP-based map output collector?

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls, parallel-copiers.txt
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 19:30:12 2006
Return-Path: 
 <hadoop-dev-return-1630-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56623 invoked from network); 24 May 2006 19:30:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 19:30:12 -0000
Received: (qmail 35047 invoked by uid 500); 24 May 2006 19:30:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35030 invoked by uid 500); 24 May 2006 19:30:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35021 invoked by uid 99); 24 May 2006 19:30:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 12:30:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 12:30:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9F1AF7141F9
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 19:29:30 +0000 (GMT)
Message-ID: <18860794.1148498970648.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 19:29:30 +0000 (GMT+00:00)
From: "Sanjay Dahiya (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12413170 ] 

Sanjay Dahiya commented on HADOOP-211:
--------------------------------------

On default Log4J configuration format - 

Some points - 
1. Logging caller class information like - originating method/line no, File name are known to be expensive operations. Also they may not be supported by All JVMs. Do we want these in default config ? 
2. For namenode I added an option %X{client}, this enables logging client identification along with msg but needs the code to supply that information using MDC.put("client", clientName)
3. We could do a seperate logger per client but thats a bad idea as there will be too many loggers. 
4. We can have logger hierarchy based on packages/classes and/or some logical hierarchy like - namenode.block.allocation, namenode.block.removal etc. Any comments on what type of log hierarchy you would like to see for the modules you worked on ? 
5. We can use MDC for categorizing logs on some criterion other than clients - like blocks, file system. Anythng you would like to see here ? 

A log4J format to start with - default is a RollingFile ( based on size, can make it based on time also ). Pls let me know your requirements if any and I will keep updating this file, once this done migrate codebase to log4j. 
-------------------------------------------------
# remove DEBUG if not needed. 
log4j.rootLogger=DEBUG, RFA
log4j.threshhold=ALL

# Rolling File appender configuration
log4j.appender.RFA=org.apache.log4j.RollingFileAppender
log4j.appender.RFA.File=${HANDDOP_HOME}/hadoop.log

# change file size 
log4j.appender.RFA.MaxFileSize=1MB
log4j.appender.RFA.MaxBackupIndex=10

log4j.appender.RFA.layout=org.apache.log4j.PatternLayout
log4j.appender.RFA.layout.ConversionPattern=%d{ISO8601} %-5p %c{2} (%F:%M(%L)) - %m%n

# logically seperated logger configurations
log4j.logger.namenode=RFA
log4j.appender.RFA.layout=org.apache.log4j.PatternLayout
log4j.appender.RFA.layout.ConversionPattern=%d{ISO8601} %-5p %X{client} %c{2} (%F:%M(%L)) - %m%n



> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: commons_logging_patch
>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 20:31:18 2006
Return-Path: 
 <hadoop-dev-return-1631-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83674 invoked from network); 24 May 2006 20:31:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 20:31:18 -0000
Received: (qmail 54863 invoked by uid 500); 24 May 2006 20:31:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54829 invoked by uid 500); 24 May 2006 20:31:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54775 invoked by uid 99); 24 May 2006 20:31:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 13:31:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 13:31:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8EE267141FA
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 20:30:30 +0000 (GMT)
Message-ID: <31675117.1148502630581.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 20:30:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-195) transfer map output transfer with
 http instead of rpc
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-195?page=comments#action_12413173 ] 

Sameer Paranjpye commented on HADOOP-195:
-----------------------------------------

Talked to Owen. The agreement is that you should go ahead and commit this and we'll have it cleaned up in a subsequent patch.

> transfer map output transfer with http instead of rpc
> -----------------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls, parallel-copiers.txt
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 20:48:50 2006
Return-Path: 
 <hadoop-dev-return-1632-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93713 invoked from network); 24 May 2006 20:48:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 20:48:50 -0000
Received: (qmail 84026 invoked by uid 500); 24 May 2006 20:48:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83999 invoked by uid 500); 24 May 2006 20:48:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83988 invoked by uid 99); 24 May 2006 20:48:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 13:48:49 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [74.0.0.77] (HELO linuxfly.dragonflymc.com) (74.0.0.77)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 13:48:48 -0700
Received: from [192.168.1.246] (unknown [63.133.162.98])
	by linuxfly.dragonflymc.com (Postfix) with ESMTP id 333DBC2006C
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 15:49:18 -0500 (CDT)
Message-ID: <4474C69C.8010807@dragonflymc.com>
Date: Wed, 24 May 2006 15:48:28 -0500
From: Dennis Kubes <nutch-dev@dragonflymc.com>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: unprotectedRenameTo and Non-Existent Parent Directory
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Currently calls to unprotectedRenameTo in FSDirectory will not create 
parent directories of the rename path.  Should this behavior be changed 
to create the parent directories if they do not exist?

This is effecting the LinkDB install method.  For example if I am 
creating a linkdb by the name of crawl/linkdb the install method calls a 
rename from working directory (something like linkdb-1234...) to 
crawl/linkdb/current.  But if the crawl/linkdb directory does not 
already exist then the rename fails.

Dennis

From MAILER-DAEMON Wed May 24 20:59:09 2006
Return-Path: 
 <hadoop-dev-return-1633-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97265 invoked from network); 24 May 2006 20:59:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 20:59:09 -0000
Received: (qmail 93990 invoked by uid 500); 24 May 2006 20:59:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93942 invoked by uid 500); 24 May 2006 20:59:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93902 invoked by uid 99); 24 May 2006 20:59:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 13:59:00 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.28] (HELO mrout2-b.corp.dcn.yahoo.com)
 (216.109.112.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 13:58:59 -0700
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout2-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k4OKw4Ar047537
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 13:58:04 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=yaPjEbh9ijybtoultYzPGVWZBMS0LgUuS6yNx8Q44MrVr9/YJHYra+lSTUJA0CqB
Message-ID: <4474C8DC.2030301@yahoo-inc.com>
Date: Wed, 24 May 2006 13:58:04 -0700
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: unprotectedRenameTo and Non-Existent Parent Directory
References: <4474C69C.8010807@dragonflymc.com>
In-Reply-To: <4474C69C.8010807@dragonflymc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

This is a standard behavior of "mv". Don't think we should change it.
I think it is better to call mkdirs before renaming.

--Konst

Dennis Kubes wrote:

> Currently calls to unprotectedRenameTo in FSDirectory will not create 
> parent directories of the rename path.  Should this behavior be 
> changed to create the parent directories if they do not exist?
>
> This is effecting the LinkDB install method.  For example if I am 
> creating a linkdb by the name of crawl/linkdb the install method calls 
> a rename from working directory (something like linkdb-1234...) to 
> crawl/linkdb/current.  But if the crawl/linkdb directory does not 
> already exist then the rename fails.
>
> Dennis
>
>
>


From MAILER-DAEMON Wed May 24 21:01:44 2006
Return-Path: 
 <hadoop-dev-return-1634-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 98692 invoked from network); 24 May 2006 21:01:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 21:01:44 -0000
Received: (qmail 1006 invoked by uid 500); 24 May 2006 21:01:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 984 invoked by uid 500); 24 May 2006 21:01:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 975 invoked by uid 99); 24 May 2006 21:01:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 14:01:44 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [74.0.0.77] (HELO linuxfly.dragonflymc.com) (74.0.0.77)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 14:01:43 -0700
Received: from [192.168.1.246] (unknown [63.133.162.98])
	by linuxfly.dragonflymc.com (Postfix) with ESMTP id 7B4FDC2006C
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 16:02:13 -0500 (CDT)
Message-ID: <4474C9A4.2060201@dragonflymc.com>
Date: Wed, 24 May 2006 16:01:24 -0500
From: Dennis Kubes <nutch-dev@dragonflymc.com>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: unprotectedRenameTo and Non-Existent Parent Directory
References: <4474C69C.8010807@dragonflymc.com>
 <4474C8DC.2030301@yahoo-inc.com>
In-Reply-To: <4474C8DC.2030301@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

That is where I was headed as well.  I was thinking of adding something 
like fs.mkdirs(newLinkDb); in the install method.  I will submit a patch.

Dennis

Konstantin Shvachko wrote:
> This is a standard behavior of "mv". Don't think we should change it.
> I think it is better to call mkdirs before renaming.
>
> --Konst
>
> Dennis Kubes wrote:
>
>> Currently calls to unprotectedRenameTo in FSDirectory will not create 
>> parent directories of the rename path.  Should this behavior be 
>> changed to create the parent directories if they do not exist?
>>
>> This is effecting the LinkDB install method.  For example if I am 
>> creating a linkdb by the name of crawl/linkdb the install method 
>> calls a rename from working directory (something like linkdb-1234...) 
>> to crawl/linkdb/current.  But if the crawl/linkdb directory does not 
>> already exist then the rename fails.
>>
>> Dennis
>>
>>
>>
>

From MAILER-DAEMON Wed May 24 21:03:00 2006
Return-Path: 
 <hadoop-dev-return-1635-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99274 invoked from network); 24 May 2006 21:03:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 21:03:00 -0000
Received: (qmail 2485 invoked by uid 500); 24 May 2006 21:03:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 2355 invoked by uid 500); 24 May 2006 21:02:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 2346 invoked by uid 99); 24 May 2006 21:02:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 14:02:59 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [74.0.0.77] (HELO linuxfly.dragonflymc.com) (74.0.0.77)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 14:02:58 -0700
Received: from [192.168.1.246] (unknown [63.133.162.98])
	by linuxfly.dragonflymc.com (Postfix) with ESMTP id 19DABC2006C
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 16:03:28 -0500 (CDT)
Message-ID: <4474C9EE.3000808@dragonflymc.com>
Date: Wed, 24 May 2006 16:02:38 -0500
From: Dennis Kubes <nutch-dev@dragonflymc.com>
User-Agent: Thunderbird 1.5.0.2 (Windows/20060308)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: unprotectedRenameTo and Non-Existent Parent Directory
References: <4474C69C.8010807@dragonflymc.com>
 <4474C8DC.2030301@yahoo-inc.com>
In-Reply-To: <4474C8DC.2030301@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Sorry that should have been:

fs.mkdirs(current);

Konstantin Shvachko wrote:
> This is a standard behavior of "mv". Don't think we should change it.
> I think it is better to call mkdirs before renaming.
>
> --Konst
>
> Dennis Kubes wrote:
>
>> Currently calls to unprotectedRenameTo in FSDirectory will not create 
>> parent directories of the rename path.  Should this behavior be 
>> changed to create the parent directories if they do not exist?
>>
>> This is effecting the LinkDB install method.  For example if I am 
>> creating a linkdb by the name of crawl/linkdb the install method 
>> calls a rename from working directory (something like linkdb-1234...) 
>> to crawl/linkdb/current.  But if the crawl/linkdb directory does not 
>> already exist then the rename fails.
>>
>> Dennis
>>
>>
>>
>

From MAILER-DAEMON Wed May 24 21:43:11 2006
Return-Path: 
 <hadoop-dev-return-1636-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18159 invoked from network); 24 May 2006 21:43:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 21:43:11 -0000
Received: (qmail 71774 invoked by uid 500); 24 May 2006 21:43:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71761 invoked by uid 500); 24 May 2006 21:43:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71745 invoked by uid 99); 24 May 2006 21:43:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 14:43:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 14:43:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D0AAC7141FA
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 21:42:29 +0000 (GMT)
Message-ID: <23760059.1148506949851.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 21:42:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-251) progress report failures kill task
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

progress report failures kill task
----------------------------------

         Key: HADOOP-251
         URL: http://issues.apache.org/jira/browse/HADOOP-251
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3
 Attachments: no-progress-failure.patch

Communication problems in reporting progress to the task tracker kill the task because the exceptions are not caught. Since reporting progress is not critical, my patch catches the exception, logs it, and ignores it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 21:43:17 2006
Return-Path: 
 <hadoop-dev-return-1637-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18193 invoked from network); 24 May 2006 21:43:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 21:43:17 -0000
Received: (qmail 71972 invoked by uid 500); 24 May 2006 21:43:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71952 invoked by uid 500); 24 May 2006 21:43:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71943 invoked by uid 99); 24 May 2006 21:43:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 14:43:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 14:43:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D1EBF714283
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 21:42:30 +0000 (GMT)
Message-ID: <32140942.1148506950857.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 21:42:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-251) progress report failures kill task
In-Reply-To: <23760059.1148506949851.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-251?page=all ]

Owen O'Malley updated HADOOP-251:
---------------------------------

    Attachment: no-progress-failure.patch

> progress report failures kill task
> ----------------------------------
>
>          Key: HADOOP-251
>          URL: http://issues.apache.org/jira/browse/HADOOP-251
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: no-progress-failure.patch
>
> Communication problems in reporting progress to the task tracker kill the task because the exceptions are not caught. Since reporting progress is not critical, my patch catches the exception, logs it, and ignores it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 22:39:12 2006
Return-Path: 
 <hadoop-dev-return-1638-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35958 invoked from network); 24 May 2006 22:39:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 22:39:12 -0000
Received: (qmail 46639 invoked by uid 500); 24 May 2006 22:39:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46510 invoked by uid 500); 24 May 2006 22:39:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46501 invoked by uid 99); 24 May 2006 22:39:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 15:39:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 15:39:10 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DB7267141FA
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 22:38:29 +0000 (GMT)
Message-ID: <23799650.1148510309896.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 22:38:29 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-252) add versioning to RPC
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

add versioning to RPC
---------------------

         Key: HADOOP-252
         URL: http://issues.apache.org/jira/browse/HADOOP-252
     Project: Hadoop
        Type: Improvement

  Components: ipc  
    Reporter: Yoram Arnon


currently, any change to any rpc message breaks the protocol, with mysterious exceptions occurring at run time.
a versioning sceme would have two benefits:
- intelligent error messages, indicating that an upgrade is required
- backwards compatibility could be supported.

the proposal is to add a "const version" for each protocol, and a method: int getVersion(int version) that sends the client's version and receives the server's version. This would be the first method invoked on connection. Both sides then either agree on the lowest version number, providing backwards compatibility support, or abort the connection as "unsupported version".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 22:39:13 2006
Return-Path: 
 <hadoop-dev-return-1639-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35995 invoked from network); 24 May 2006 22:39:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 22:39:13 -0000
Received: (qmail 46747 invoked by uid 500); 24 May 2006 22:39:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46664 invoked by uid 500); 24 May 2006 22:39:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46655 invoked by uid 99); 24 May 2006 22:39:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 15:39:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 15:39:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C2C327141F9
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 22:38:30 +0000 (GMT)
Message-ID: <30192484.1148510310795.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 22:38:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-195) improve performance of map output
 transfers
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-195?page=all ]

Doug Cutting updated HADOOP-195:
--------------------------------

    Summary: improve performance of map output transfers  (was: transfer map output transfer with http instead of rpc)

> improve performance of map output transfers
> -------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls, parallel-copiers.txt
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 22:39:13 2006
Return-Path: 
 <hadoop-dev-return-1640-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36029 invoked from network); 24 May 2006 22:39:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 22:39:13 -0000
Received: (qmail 46835 invoked by uid 500); 24 May 2006 22:39:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46815 invoked by uid 500); 24 May 2006 22:39:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46773 invoked by uid 99); 24 May 2006 22:39:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 15:39:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 15:39:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9C18071428E
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 22:38:31 +0000 (GMT)
Message-ID: <22881485.1148510311636.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 22:38:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-195) improve performance of map output
 transfers
In-Reply-To: <6413697.1146765138386.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-195?page=all ]
     
Doug Cutting resolved HADOOP-195:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Sameer!

> improve performance of map output transfers
> -------------------------------------------
>
>          Key: HADOOP-195
>          URL: http://issues.apache.org/jira/browse/HADOOP-195
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: MapFileSimulator.java, data-transfer-chart.pdf, mapfilesimulator-big.txt, mapfilesimulator-sort2.txt, netstat.log, netstat.xls, parallel-copiers.txt
>
> The data transfer of the map output should be transfered via http instead rpc, because rpc is very slow for this application and the timeout behavior is suboptimal. (server sends data and client ignores it because it took more than 10 seconds to be received.)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 22:53:12 2006
Return-Path: 
 <hadoop-dev-return-1641-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40147 invoked from network); 24 May 2006 22:53:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 22:53:12 -0000
Received: (qmail 59938 invoked by uid 500); 24 May 2006 22:53:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59919 invoked by uid 500); 24 May 2006 22:53:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59910 invoked by uid 99); 24 May 2006 22:53:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 15:53:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 15:53:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ACA4271423B
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 22:52:30 +0000 (GMT)
Message-ID: <18213881.1148511150627.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 22:52:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-252) add versioning to RPC
In-Reply-To: <23799650.1148510309896.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-252?page=comments#action_12413191 ] 

Doug Cutting commented on HADOOP-252:
-------------------------------------

One complication is that different RPC protocols share common connections, in order to minimize the number of per-connection threads and sockets.  So the versions would really need to be transmitted with each request, or perhaps with the first request of each protocol over a given connection.

> add versioning to RPC
> ---------------------
>
>          Key: HADOOP-252
>          URL: http://issues.apache.org/jira/browse/HADOOP-252
>      Project: Hadoop
>         Type: Improvement

>   Components: ipc
>     Reporter: Yoram Arnon

>
> currently, any change to any rpc message breaks the protocol, with mysterious exceptions occurring at run time.
> a versioning sceme would have two benefits:
> - intelligent error messages, indicating that an upgrade is required
> - backwards compatibility could be supported.
> the proposal is to add a "const version" for each protocol, and a method: int getVersion(int version) that sends the client's version and receives the server's version. This would be the first method invoked on connection. Both sides then either agree on the lowest version number, providing backwards compatibility support, or abort the connection as "unsupported version".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 23:00:12 2006
Return-Path: 
 <hadoop-dev-return-1642-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43744 invoked from network); 24 May 2006 23:00:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 23:00:12 -0000
Received: (qmail 71376 invoked by uid 500); 24 May 2006 23:00:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71357 invoked by uid 500); 24 May 2006 23:00:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71347 invoked by uid 99); 24 May 2006 23:00:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:00:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:00:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9D0517141FA
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 22:59:30 +0000 (GMT)
Message-ID: <15498283.1148511570640.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 22:59:30 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12413192 ] 

alan wootton commented on HADOOP-210:
-------------------------------------

It's looking clear to me that we need to change the RPC server to use java.nio.channels.ServerSocketChannel instead of the current connection/thread model.
Is that what we're talking about?

Who is the nio expert here? :-)

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 23:08:12 2006
Return-Path: 
 <hadoop-dev-return-1643-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45793 invoked from network); 24 May 2006 23:08:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 23:08:12 -0000
Received: (qmail 84421 invoked by uid 500); 24 May 2006 23:08:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84293 invoked by uid 500); 24 May 2006 23:08:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84284 invoked by uid 99); 24 May 2006 23:08:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:08:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:08:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9DA307141F9
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 23:07:30 +0000 (GMT)
Message-ID: <9688366.1148512050641.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 23:07:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-224) Allow simplified versioning for
 namenode and datanode metadata.
In-Reply-To: <3300836.1147816565914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-224?page=comments#action_12413194 ] 

Doug Cutting commented on HADOOP-224:
-------------------------------------

+0  If folks would like, I will commit this, but it seems a bit like a solution in search of a problem.  It introduces, for example, some potentially big, temporary datastructures which could bite us later, without really providing any new useful functionality.  Yes, we will probably alter the file format, and this will probably be able to handle those changes, but it might not.  Personally I'd wait until I was changing the file format to add this.  But that's a matter of style.  I will commit this if others strongly feel it is ready and now is the time.

> Allow simplified versioning for namenode and datanode metadata.
> ---------------------------------------------------------------
>
>          Key: HADOOP-224
>          URL: http://issues.apache.org/jira/browse/HADOOP-224
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>  Environment: All
>     Reporter: Milind Bhandarkar
>  Attachments: hadoop-224.patch
>
> Currently namenode has two types of metadata: The FSImage, and FSEdits. FSImage contains information abut Inodes, and FSEdits contains a list of operations that were not saved to FSImage. Datanode currently does not have any metadata, but would have it some day. 
> The file formats used for storing these metadata will evolve over time. It is important for the file-system to be backward compatible. That is, the metadata readers need to be able to identify which version of the file-format we are using, and need to be able to read information therein. As we add information to these metadata, the complexity of the reader increases dramatically.
> I propose a versioning scheme with a major and minor version number, where a different reader class is associated with a major number, and that class interprets the minor number internally. The readers essentially form a chain starting with the latest version. Each version-reader looks at the file and if it does not recognize the version number, passes it to the version reader next to it by calling the parse method, returnng the results of the parse method up the chain (In case of the namenode, the parse result is an array of Inodes.
> This scheme has an advantage that every time a new major version is added, the new reader only needs to know about the reader for its immediately previous version, and every reader needs to know only about which major version numbers it can read.
> The writer is not so versioned, because metadata is always written in the most current version format.
> One more change that is needed for simplified versioning is that the "struct-surping" of dfs.Block needs to be removed. Block's contents will change in later versions, and older versions should still be able to readFields properly. This is more general than Block of course, and in general only basic datatypes should be used as Writables in DFS metadata.
> For edits, the reader should return <opcode, ArrayWritable> pairs' array. This will also remove the limitation of two operands for very opcodes, and will be more extensible.
> Even with this new versioning scheme, the last Reader in the reader-chain would recognize current format, thus maintaining full backward compatibility.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 23:12:12 2006
Return-Path: 
 <hadoop-dev-return-1644-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46168 invoked from network); 24 May 2006 23:12:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 23:12:12 -0000
Received: (qmail 87890 invoked by uid 500); 24 May 2006 23:12:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87873 invoked by uid 500); 24 May 2006 23:12:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87864 invoked by uid 99); 24 May 2006 23:12:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:12:11 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:12:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8EDAC7141ED
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 23:11:30 +0000 (GMT)
Message-ID: <1072269.1148512290582.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 23:11:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-210) Namenode not able to accept
 connections
In-Reply-To: <22832248.1147306205708.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-210?page=comments#action_12413195 ] 

Doug Cutting commented on HADOOP-210:
-------------------------------------

Alan, yes, changing Server.java to use nio's Selector is what's under discussion, using a single thread on the server to buffer requests until they are complete, then dispatching each request to a worker thread.  Client.java must also be modified to buffer request objects so that they can be written preceded by their size, permitting Server.java to determine when each request has fully arrived.

> Namenode not able to accept connections
> ---------------------------------------
>
>          Key: HADOOP-210
>          URL: http://issues.apache.org/jira/browse/HADOOP-210
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>  Environment: linux
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar

>
> I am running owen's random writer on a 627 node cluster (writing 10GB/node).  After running for a while (map 12% reduce 1%) I get the following error on the Namenode:
> Exception in thread "Server listener on port 60000" java.lang.OutOfMemoryError: unable to create new native thread
>         at java.lang.Thread.start0(Native Method)
>         at java.lang.Thread.start(Thread.java:574)
>         at org.apache.hadoop.ipc.Server$Listener.run(Server.java:105)
> After this, the namenode does not seem to be accepting connections from any of the clients. All the DFSClient calls get timeout. Here is a trace for one of them:
> java.net.SocketTimeoutException: timed out waiting for rpc response
> 	at org.apache.hadoop.ipc.Client.call(Client.java:305)
> 	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:149)
> 	at org.apache.hadoop.dfs.$Proxy1.open(Unknown Source)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:419)
> 	at org.apache.hadoop.dfs.DFSClient$DFSInputStream.(DFSClient.java:406)
> 	at org.apache.hadoop.dfs.DFSClient.open(DFSClient.java:171)
> 	at org.apache.hadoop.dfs.DistributedFileSystem.openRaw(DistributedFileSystem.java:78)
> 	at org.apache.hadoop.fs.FSDataInputStream$Checker.(FSDataInputStream.java:46)
> 	at org.apache.hadoop.fs.FSDataInputStream.(FSDataInputStream.java:228)
> 	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
> 	at org.apache.hadoop.mapred.TextInputFormat.getRecordReader(TextInputFormat.java:43)
> 	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:105)
> 	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:785).
> The namenode then has around 1% CPU utilization at this time (after the outofmemory exception has been thrown). I have profiled the NameNode and it seems to be using around a maixmum heap size of 57MB (which is not much). So, heap size does not seem to be a problem. It might be happening due to lack of Stack space? Any pointers?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 23:18:12 2006
Return-Path: 
 <hadoop-dev-return-1645-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47937 invoked from network); 24 May 2006 23:18:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 23:18:12 -0000
Received: (qmail 96360 invoked by uid 500); 24 May 2006 23:18:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96226 invoked by uid 500); 24 May 2006 23:18:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96211 invoked by uid 99); 24 May 2006 23:18:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:18:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:18:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9B73F71423B
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 23:17:30 +0000 (GMT)
Message-ID: <22207248.1148512650633.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 23:17:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-251) progress report failures kill task
In-Reply-To: <23760059.1148506949851.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-251?page=all ]
     
Doug Cutting resolved HADOOP-251:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks!

> progress report failures kill task
> ----------------------------------
>
>          Key: HADOOP-251
>          URL: http://issues.apache.org/jira/browse/HADOOP-251
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: no-progress-failure.patch
>
> Communication problems in reporting progress to the task tracker kill the task because the exceptions are not caught. Since reporting progress is not critical, my patch catches the exception, logs it, and ignores it.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 24 23:26:13 2006
Return-Path: 
 <hadoop-dev-return-1646-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51459 invoked from network); 24 May 2006 23:26:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 May 2006 23:26:13 -0000
Received: (qmail 4327 invoked by uid 500); 24 May 2006 23:26:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4306 invoked by uid 500); 24 May 2006 23:26:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4297 invoked by uid 99); 24 May 2006 23:26:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:26:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 16:26:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0B7907141FA
	for <hadoop-dev@lucene.apache.org>; Wed, 24 May 2006 23:25:31 +0000 (GMT)
Message-ID: <4639498.1148513131044.JavaMail.jira@brutus>
Date: Wed, 24 May 2006 23:25:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12413197 ] 

Doug Cutting commented on HADOOP-124:
-------------------------------------

+1, except the exceptions should not be in a separate package, but in the dfs package.  If you make that change then I'd be happy to commit this, since it fixes a very critical bug.  Thanks!

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, DirNotSharing.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 06:18:13 2006
Return-Path: 
 <hadoop-dev-return-1647-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50473 invoked from network); 25 May 2006 06:18:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 06:18:13 -0000
Received: (qmail 42757 invoked by uid 500); 25 May 2006 06:18:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42728 invoked by uid 500); 25 May 2006 06:18:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42714 invoked by uid 99); 25 May 2006 06:18:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 23:18:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 23:18:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D80F07141F6
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 06:17:29 +0000 (GMT)
Message-ID: <6201480.1148537849882.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 06:17:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-253) we need speculative execution for
 reduces
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

we need speculative execution for reduces
-----------------------------------------

         Key: HADOOP-253
         URL: http://issues.apache.org/jira/browse/HADOOP-253
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


With my new http-based shuffle (on top of the svn head including sameer's parallel fetch), I just finished sorting 2010 g on 200 nodes in 8:49 with 9 reduce failures. However, the amusing part is that the replacement reduces were _not_ the slow ones. 8 of the original reduces were the only things running for the last hour. The job timings looked like:

Job 0001
  Total:
    Tasks: 16551
    Total: 10056104 secs
    Average: 607 secs
    Worst: task_0001_r_000291_0
    Worst time: 31050 secs
    Best: task_0001_m_013597_0
    Best time: 20 secs
  Maps:
    Tasks: 16151
    Total: 2762635 secs
    Average: 171 secs
    Worst: task_0001_m_002290_0
    Worst time: 2663 secs
    Best: task_0001_m_013597_0
    Best time: 20 secs
  Reduces:
    Tasks: 400
    Total: 7293469 secs
    Average: 18233 secs
    Worst: task_0001_r_000291_0
    Worst time: 31050 secs
    Best: task_0001_r_000263_1
    Best time: 5591 secs

And the number of tasks run per a node was very uneven:

#tasks node
124 node1161
117 node1307
117 node1124
116 node1253
114 node1310
111 node1302
111 node1299
111 node1298
111 node1249
111 node1221
110 node1288
110 node1286
110 node1211
109 node1268
108 node1292
108 node1202
108 node1200
107 node1313
107 node1277
107 node1246
107 node1242
107 node1231
107 node1214
106 node1243
105 node1251
105 node1212
105 node1205
104 node1272
104 node1269
104 node1210
104 node1203
104 node1193
104 node1128
103 node1300
103 node1285
103 node1279
103 node1209
103 node1173
103 node1165
102 node1276
102 node1239
102 node1228
102 node1204
102 node1188
101 node1314
101 node1303
100 node1301
100 node1252
99 node1287
99 node1213
99 node1206
98 node1295
98 node1186
97 node1293
97 node1265
97 node1262
97 node1260
97 node1258
97 node1235
97 node1229
97 node1226
97 node1215
97 node1208
97 node1187
97 node1175
97 node1171
96 node1291
96 node1248
96 node1224
96 node1216
95 node1305
95 node1280
95 node1263
95 node1254
95 node1153
95 node1115
94 node1271
94 node1261
94 node1234
94 node1233
94 node1227
94 node1225
94 node1217
94 node1142
93 node1275
93 node1198
93 node1107
92 node1266
92 node1220
92 node1219
91 node1309
91 node1289
91 node1270
91 node1259
91 node1256
91 node1232
91 node1179
89 node1290
89 node1255
89 node1247
89 node1207
89 node1201
89 node1190
89 node1154
89 node1141
88 node1306
88 node1282
88 node1250
88 node1222
88 node1184
88 node1149
88 node1117
87 node1278
87 node1257
87 node1191
87 node1185
87 node1180
86 node1297
86 node1178
85 node1195
85 node1143
85 node1112
84 node1281
84 node1274
84 node1264
83 node1296
83 node1148
82 node1218
82 node1168
82 node1167
81 node1311
81 node1240
81 node1223
81 node1196
81 node1164
81 node1116
80 node1267
80 node1230
80 node1177
80 node1119
79 node1294
79 node1199
79 node1181
79 node1170
79 node1166
79 node1103
78 node1244
78 node1189
78 node1157
77 node1304
77 node1172
74 node1182
71 node1160
71 node1147
68 node1236
68 node1183
67 node1245
59 node1139
58 node1312
57 node1162
56 node1308
56 node1197
55 node1146
54 node1106
53 node1111
53 node1105
49 node1145
49 node1123
48 node1176
46 node1136
44 node1132
44 node1125
44 node1122
44 node1108
43 node1192
43 node1121
42 node1194
42 node1138
42 node1104
41 node1155
41 node1126
41 node1114
40 node1158
40 node1151
40 node1137
40 node1110
40 node1100
39 node1156
38 node1140
38 node1135
38 node1109
37 node1144
37 node1120
36 node1118
34 node1133
34 node1113
31 node1134
26 node1127
23 node1101
20 node1131

And it should not surprise us that the last 8 reduces were running on nodes 1134, 1127,1101, and 1131. This really demonstrates the need to run speculative reduce runs. 

I propose that when the list of reduce jobs running is down to 1/2 the cluster size that we start running speculative reduces. I estimate that it would have saved around an hour on this run. Does that sound like a reasonable heuristic?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 06:27:19 2006
Return-Path: 
 <hadoop-dev-return-1648-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52196 invoked from network); 25 May 2006 06:27:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 06:27:19 -0000
Received: (qmail 54342 invoked by uid 500); 25 May 2006 06:27:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54212 invoked by uid 500); 25 May 2006 06:27:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54203 invoked by uid 99); 25 May 2006 06:27:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 23:27:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 24 May 2006 23:27:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 72D9D7141F6
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 06:26:35 +0000 (GMT)
Message-ID: <19278787.1148538395467.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 06:26:35 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-253) we need speculative execution for
 reduces
In-Reply-To: <6201480.1148537849882.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-253?page=comments#action_12413219 ] 

Owen O'Malley commented on HADOOP-253:
--------------------------------------

Minor correction, the sort took 8:39 instead of 8:49.

> we need speculative execution for reduces
> -----------------------------------------
>
>          Key: HADOOP-253
>          URL: http://issues.apache.org/jira/browse/HADOOP-253
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> With my new http-based shuffle (on top of the svn head including sameer's parallel fetch), I just finished sorting 2010 g on 200 nodes in 8:49 with 9 reduce failures. However, the amusing part is that the replacement reduces were _not_ the slow ones. 8 of the original reduces were the only things running for the last hour. The job timings looked like:
> Job 0001
>   Total:
>     Tasks: 16551
>     Total: 10056104 secs
>     Average: 607 secs
>     Worst: task_0001_r_000291_0
>     Worst time: 31050 secs
>     Best: task_0001_m_013597_0
>     Best time: 20 secs
>   Maps:
>     Tasks: 16151
>     Total: 2762635 secs
>     Average: 171 secs
>     Worst: task_0001_m_002290_0
>     Worst time: 2663 secs
>     Best: task_0001_m_013597_0
>     Best time: 20 secs
>   Reduces:
>     Tasks: 400
>     Total: 7293469 secs
>     Average: 18233 secs
>     Worst: task_0001_r_000291_0
>     Worst time: 31050 secs
>     Best: task_0001_r_000263_1
>     Best time: 5591 secs
> And the number of tasks run per a node was very uneven:
> #tasks node
> 124 node1161
> 117 node1307
> 117 node1124
> 116 node1253
> 114 node1310
> 111 node1302
> 111 node1299
> 111 node1298
> 111 node1249
> 111 node1221
> 110 node1288
> 110 node1286
> 110 node1211
> 109 node1268
> 108 node1292
> 108 node1202
> 108 node1200
> 107 node1313
> 107 node1277
> 107 node1246
> 107 node1242
> 107 node1231
> 107 node1214
> 106 node1243
> 105 node1251
> 105 node1212
> 105 node1205
> 104 node1272
> 104 node1269
> 104 node1210
> 104 node1203
> 104 node1193
> 104 node1128
> 103 node1300
> 103 node1285
> 103 node1279
> 103 node1209
> 103 node1173
> 103 node1165
> 102 node1276
> 102 node1239
> 102 node1228
> 102 node1204
> 102 node1188
> 101 node1314
> 101 node1303
> 100 node1301
> 100 node1252
> 99 node1287
> 99 node1213
> 99 node1206
> 98 node1295
> 98 node1186
> 97 node1293
> 97 node1265
> 97 node1262
> 97 node1260
> 97 node1258
> 97 node1235
> 97 node1229
> 97 node1226
> 97 node1215
> 97 node1208
> 97 node1187
> 97 node1175
> 97 node1171
> 96 node1291
> 96 node1248
> 96 node1224
> 96 node1216
> 95 node1305
> 95 node1280
> 95 node1263
> 95 node1254
> 95 node1153
> 95 node1115
> 94 node1271
> 94 node1261
> 94 node1234
> 94 node1233
> 94 node1227
> 94 node1225
> 94 node1217
> 94 node1142
> 93 node1275
> 93 node1198
> 93 node1107
> 92 node1266
> 92 node1220
> 92 node1219
> 91 node1309
> 91 node1289
> 91 node1270
> 91 node1259
> 91 node1256
> 91 node1232
> 91 node1179
> 89 node1290
> 89 node1255
> 89 node1247
> 89 node1207
> 89 node1201
> 89 node1190
> 89 node1154
> 89 node1141
> 88 node1306
> 88 node1282
> 88 node1250
> 88 node1222
> 88 node1184
> 88 node1149
> 88 node1117
> 87 node1278
> 87 node1257
> 87 node1191
> 87 node1185
> 87 node1180
> 86 node1297
> 86 node1178
> 85 node1195
> 85 node1143
> 85 node1112
> 84 node1281
> 84 node1274
> 84 node1264
> 83 node1296
> 83 node1148
> 82 node1218
> 82 node1168
> 82 node1167
> 81 node1311
> 81 node1240
> 81 node1223
> 81 node1196
> 81 node1164
> 81 node1116
> 80 node1267
> 80 node1230
> 80 node1177
> 80 node1119
> 79 node1294
> 79 node1199
> 79 node1181
> 79 node1170
> 79 node1166
> 79 node1103
> 78 node1244
> 78 node1189
> 78 node1157
> 77 node1304
> 77 node1172
> 74 node1182
> 71 node1160
> 71 node1147
> 68 node1236
> 68 node1183
> 67 node1245
> 59 node1139
> 58 node1312
> 57 node1162
> 56 node1308
> 56 node1197
> 55 node1146
> 54 node1106
> 53 node1111
> 53 node1105
> 49 node1145
> 49 node1123
> 48 node1176
> 46 node1136
> 44 node1132
> 44 node1125
> 44 node1122
> 44 node1108
> 43 node1192
> 43 node1121
> 42 node1194
> 42 node1138
> 42 node1104
> 41 node1155
> 41 node1126
> 41 node1114
> 40 node1158
> 40 node1151
> 40 node1137
> 40 node1110
> 40 node1100
> 39 node1156
> 38 node1140
> 38 node1135
> 38 node1109
> 37 node1144
> 37 node1120
> 36 node1118
> 34 node1133
> 34 node1113
> 31 node1134
> 26 node1127
> 23 node1101
> 20 node1131
> And it should not surprise us that the last 8 reduces were running on nodes 1134, 1127,1101, and 1131. This really demonstrates the need to run speculative reduce runs. 
> I propose that when the list of reduce jobs running is down to 1/2 the cluster size that we start running speculative reduces. I estimate that it would have saved around an hour on this run. Does that sound like a reasonable heuristic?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 07:32:07 2006
Return-Path: 
 <hadoop-dev-return-1649-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74437 invoked from network); 25 May 2006 07:32:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 07:32:07 -0000
Received: (qmail 7545 invoked by uid 500); 25 May 2006 07:32:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7521 invoked by uid 500); 25 May 2006 07:32:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7512 invoked by uid 99); 25 May 2006 07:32:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 00:32:06 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 00:32:04 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A53587141F2
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 06:59:30 +0000 (GMT)
Message-ID: <13365806.1148540370673.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 06:59:30 +0000 (GMT+00:00)
From: "Devaraj Das (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-250) HTTP Browsing interface for DFS
 Health/Status
In-Reply-To: <29976966.1148448150061.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-250?page=all ]

Devaraj Das updated HADOOP-250:
-------------------------------

    Attachment: http_browsing_dfs.patch

Thanks Doug for the comments. Attached is the revised patch where I call DataNode.createSocketAddr directly.

> HTTP Browsing interface for DFS Health/Status
> ---------------------------------------------
>
>          Key: HADOOP-250
>          URL: http://issues.apache.org/jira/browse/HADOOP-250
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Devaraj Das
>  Attachments: dfshealth.pdf, http_browsing_dfs.patch, http_browsing_dfs.patch
>
> A web interface to view the DFS health/status (name and data nodes) is to be created. User can connect to the webserver on the namenode and a web page will be displayed. The web page will give some details about that namenode (startup time and the total cluster capacity). The web page will contain a table of 'live' and 'dead' datanodes. Each live datanode will be a link to the complete details of the datanode as given by DatanodeInfo (also see DataNodeReport).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 16:07:14 2006
Return-Path: 
 <hadoop-dev-return-1650-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32007 invoked from network); 25 May 2006 16:07:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 16:07:14 -0000
Received: (qmail 6544 invoked by uid 500); 25 May 2006 16:07:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6521 invoked by uid 500); 25 May 2006 16:07:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6511 invoked by uid 99); 25 May 2006 16:07:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 09:07:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 09:07:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CD9871423B
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 16:06:30 +0000 (GMT)
Message-ID: <4306436.1148573190574.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 16:06:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-253) we need speculative execution for
 reduces
In-Reply-To: <6201480.1148537849882.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-253?page=comments#action_12413270 ] 

Doug Cutting commented on HADOOP-253:
-------------------------------------

+1

As before, it must be possible to disable speculative execution for reduces with side-effects.  Also, some of the support needs to be in the output format implementations.  In particular, these should first write to a temporary name, then rename the output when the task completes, but only if the output does not already exist.  We should note that this is the expected behavior for output formats in the interface javadoc, and put as much of the implementation as possible in the base class.


> we need speculative execution for reduces
> -----------------------------------------
>
>          Key: HADOOP-253
>          URL: http://issues.apache.org/jira/browse/HADOOP-253
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> With my new http-based shuffle (on top of the svn head including sameer's parallel fetch), I just finished sorting 2010 g on 200 nodes in 8:49 with 9 reduce failures. However, the amusing part is that the replacement reduces were _not_ the slow ones. 8 of the original reduces were the only things running for the last hour. The job timings looked like:
> Job 0001
>   Total:
>     Tasks: 16551
>     Total: 10056104 secs
>     Average: 607 secs
>     Worst: task_0001_r_000291_0
>     Worst time: 31050 secs
>     Best: task_0001_m_013597_0
>     Best time: 20 secs
>   Maps:
>     Tasks: 16151
>     Total: 2762635 secs
>     Average: 171 secs
>     Worst: task_0001_m_002290_0
>     Worst time: 2663 secs
>     Best: task_0001_m_013597_0
>     Best time: 20 secs
>   Reduces:
>     Tasks: 400
>     Total: 7293469 secs
>     Average: 18233 secs
>     Worst: task_0001_r_000291_0
>     Worst time: 31050 secs
>     Best: task_0001_r_000263_1
>     Best time: 5591 secs
> And the number of tasks run per a node was very uneven:
> #tasks node
> 124 node1161
> 117 node1307
> 117 node1124
> 116 node1253
> 114 node1310
> 111 node1302
> 111 node1299
> 111 node1298
> 111 node1249
> 111 node1221
> 110 node1288
> 110 node1286
> 110 node1211
> 109 node1268
> 108 node1292
> 108 node1202
> 108 node1200
> 107 node1313
> 107 node1277
> 107 node1246
> 107 node1242
> 107 node1231
> 107 node1214
> 106 node1243
> 105 node1251
> 105 node1212
> 105 node1205
> 104 node1272
> 104 node1269
> 104 node1210
> 104 node1203
> 104 node1193
> 104 node1128
> 103 node1300
> 103 node1285
> 103 node1279
> 103 node1209
> 103 node1173
> 103 node1165
> 102 node1276
> 102 node1239
> 102 node1228
> 102 node1204
> 102 node1188
> 101 node1314
> 101 node1303
> 100 node1301
> 100 node1252
> 99 node1287
> 99 node1213
> 99 node1206
> 98 node1295
> 98 node1186
> 97 node1293
> 97 node1265
> 97 node1262
> 97 node1260
> 97 node1258
> 97 node1235
> 97 node1229
> 97 node1226
> 97 node1215
> 97 node1208
> 97 node1187
> 97 node1175
> 97 node1171
> 96 node1291
> 96 node1248
> 96 node1224
> 96 node1216
> 95 node1305
> 95 node1280
> 95 node1263
> 95 node1254
> 95 node1153
> 95 node1115
> 94 node1271
> 94 node1261
> 94 node1234
> 94 node1233
> 94 node1227
> 94 node1225
> 94 node1217
> 94 node1142
> 93 node1275
> 93 node1198
> 93 node1107
> 92 node1266
> 92 node1220
> 92 node1219
> 91 node1309
> 91 node1289
> 91 node1270
> 91 node1259
> 91 node1256
> 91 node1232
> 91 node1179
> 89 node1290
> 89 node1255
> 89 node1247
> 89 node1207
> 89 node1201
> 89 node1190
> 89 node1154
> 89 node1141
> 88 node1306
> 88 node1282
> 88 node1250
> 88 node1222
> 88 node1184
> 88 node1149
> 88 node1117
> 87 node1278
> 87 node1257
> 87 node1191
> 87 node1185
> 87 node1180
> 86 node1297
> 86 node1178
> 85 node1195
> 85 node1143
> 85 node1112
> 84 node1281
> 84 node1274
> 84 node1264
> 83 node1296
> 83 node1148
> 82 node1218
> 82 node1168
> 82 node1167
> 81 node1311
> 81 node1240
> 81 node1223
> 81 node1196
> 81 node1164
> 81 node1116
> 80 node1267
> 80 node1230
> 80 node1177
> 80 node1119
> 79 node1294
> 79 node1199
> 79 node1181
> 79 node1170
> 79 node1166
> 79 node1103
> 78 node1244
> 78 node1189
> 78 node1157
> 77 node1304
> 77 node1172
> 74 node1182
> 71 node1160
> 71 node1147
> 68 node1236
> 68 node1183
> 67 node1245
> 59 node1139
> 58 node1312
> 57 node1162
> 56 node1308
> 56 node1197
> 55 node1146
> 54 node1106
> 53 node1111
> 53 node1105
> 49 node1145
> 49 node1123
> 48 node1176
> 46 node1136
> 44 node1132
> 44 node1125
> 44 node1122
> 44 node1108
> 43 node1192
> 43 node1121
> 42 node1194
> 42 node1138
> 42 node1104
> 41 node1155
> 41 node1126
> 41 node1114
> 40 node1158
> 40 node1151
> 40 node1137
> 40 node1110
> 40 node1100
> 39 node1156
> 38 node1140
> 38 node1135
> 38 node1109
> 37 node1144
> 37 node1120
> 36 node1118
> 34 node1133
> 34 node1113
> 31 node1134
> 26 node1127
> 23 node1101
> 20 node1131
> And it should not surprise us that the last 8 reduces were running on nodes 1134, 1127,1101, and 1131. This really demonstrates the need to run speculative reduce runs. 
> I propose that when the list of reduce jobs running is down to 1/2 the cluster size that we start running speculative reduces. I estimate that it would have saved around an hour on this run. Does that sound like a reasonable heuristic?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 16:56:13 2006
Return-Path: 
 <hadoop-dev-return-1651-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45749 invoked from network); 25 May 2006 16:56:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 16:56:13 -0000
Received: (qmail 4130 invoked by uid 500); 25 May 2006 16:56:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4113 invoked by uid 500); 25 May 2006 16:56:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4100 invoked by uid 99); 25 May 2006 16:56:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 09:56:12 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 09:56:11 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D038571423B
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 16:55:29 +0000 (GMT)
Message-ID: <30577878.1148576129850.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 16:55:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-254) use http to shuffle data between the
 maps and the reduces
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

use http to shuffle data between the maps and the reduces
---------------------------------------------------------

         Key: HADOOP-254
         URL: http://issues.apache.org/jira/browse/HADOOP-254
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3


To speed up the shuffle time, I'll use http (via the task tracker's jetty server) to send the map outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 17:00:13 2006
Return-Path: 
 <hadoop-dev-return-1652-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46802 invoked from network); 25 May 2006 17:00:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 17:00:13 -0000
Received: (qmail 10879 invoked by uid 500); 25 May 2006 17:00:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10854 invoked by uid 500); 25 May 2006 17:00:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10844 invoked by uid 99); 25 May 2006 17:00:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 10:00:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 10:00:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 991C071423B
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 16:59:30 +0000 (GMT)
Message-ID: <13975214.1148576370624.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 16:59:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-254) use http to shuffle data between the
 maps and the reduces
In-Reply-To: <30577878.1148576129850.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-254?page=all ]

Owen O'Malley updated HADOOP-254:
---------------------------------

    Attachment: http-shuffle.patch

This patch introduces the use of http to shuffle the data from maps to reduces. Using this patch, the shuffle mostly keeps up with the maps during my sort benchmark.

This patch also allows the task tracker's http servers to try multiple ports until it finds one that works.

> use http to shuffle data between the maps and the reduces
> ---------------------------------------------------------
>
>          Key: HADOOP-254
>          URL: http://issues.apache.org/jira/browse/HADOOP-254
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: http-shuffle.patch
>
> To speed up the shuffle time, I'll use http (via the task tracker's jetty server) to send the map outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 17:00:15 2006
Return-Path: 
 <hadoop-dev-return-1653-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46826 invoked from network); 25 May 2006 17:00:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 17:00:15 -0000
Received: (qmail 11023 invoked by uid 500); 25 May 2006 17:00:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11000 invoked by uid 500); 25 May 2006 17:00:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10990 invoked by uid 99); 25 May 2006 17:00:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 10:00:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 10:00:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 83610714283
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 16:59:31 +0000 (GMT)
Message-ID: <28217009.1148576371535.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 16:59:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-249) Improving Map -> Reduce performance
 and Task JVM reuse
In-Reply-To: <12945804.1148431829854.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-249?page=comments#action_12413277 ] 

Doug Cutting commented on HADOOP-249:
-------------------------------------

I have not yet had a chance to look closely at your patches, but these are clearly optimizations that we badly need.  Thanks!

> Improving Map -> Reduce performance and Task JVM reuse
> ------------------------------------------------------
>
>          Key: HADOOP-249
>          URL: http://issues.apache.org/jira/browse/HADOOP-249
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.3
>     Reporter: Benjamin Reed
>  Attachments: disk_zoom.patch, image001.png, task_zoom.patch
>
> These patches are really just to make Hadoop start trotting. It is still at least an order of magnitude slower than it should be, but I think these patches are a good start.
> I've created two patches for clarity. They are not independent, but could easily be made so.
> The disk-zoom patch is a performance trifecta: less disk IO, less disk space, less CPU, and overall a tremendous improvement. The patch is based on the following observation: every piece of data from a map hits the disk once on the mapper, and 3 (+plus sorting) times on the reducer. Further, the entire input for the reduce step is sorted together maximizing the sort time. This patch causes:
> 1)  the mapper to sort the relatively small fragments at the mapper which causes two hits to the disk, but they are smaller files.
> 2) the reducer copies the map output and may merge (if more than 100 outputs are present) with a couple of other outputs at copy time. No sorting is done since the map outputs are sorted.
> 3) the reducer  will merge the map outputs on the fly in memory at reduce time.
> I'm attaching the performance graph (with just the disk-zoom patch) to show the results. This benchmark uses a random input and null output to remove any DFS performance influences. The cluster of 49 machines I was running on had limited disk space, so I was only able to run to a certain size on unmodified Hadoop. With the patch we use 1/3 the amount of disk space.
> The second patch allows the task tracker to reuse processes to avoid the over-head of starting the JVM. While JVM startup is relatively fast, restarting a Task causes disk IO and DFS operations that have a negative impact on the rest of the system. When a Task finishes, rather than exiting, it reads the next task to run from stdin. We still isolate the Task runtime from TaskTracker, but we only pay the startup penalty once.
> This second patch also fixes two performance issues not related to JVM reuse. (The reuse just makes the problems glaring.) First, the JobTracker counts all jobs not just the running jobs to decide the load on a tracker. Second, the TaskTracker should really ask for a new Task as soon as one finishes rather than wait the 10 secs.
> I've been benchmarking the code alot, but I don't have access to a really good cluster to try the code out on, so please treat it as experimental. I would love to feedback.
> There is another obvious thing to change: ReduceTasks should start after the first batch of MapTasks complete, so that 1) they have something to do, and 2) they are running on the fastest machines.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 19:56:14 2006
Return-Path: 
 <hadoop-dev-return-1654-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15156 invoked from network); 25 May 2006 19:56:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 19:56:14 -0000
Received: (qmail 73263 invoked by uid 500); 25 May 2006 19:56:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73240 invoked by uid 500); 25 May 2006 19:56:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73231 invoked by uid 99); 25 May 2006 19:56:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 12:56:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 12:56:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 033457141FA
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 19:55:31 +0000 (GMT)
Message-ID: <10780592.1148586931010.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 19:55:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12413296 ] 

Doug Cutting commented on HADOOP-124:
-------------------------------------

I just applied this to trunk and unit tests failed with UnregisteredDatanodeExceptions.

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, DirNotSharing.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 20:04:14 2006
Return-Path: 
 <hadoop-dev-return-1655-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17609 invoked from network); 25 May 2006 20:04:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 20:04:14 -0000
Received: (qmail 96437 invoked by uid 500); 25 May 2006 20:04:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96420 invoked by uid 500); 25 May 2006 20:04:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96411 invoked by uid 99); 25 May 2006 20:04:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 13:04:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 13:04:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 850317141FA
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 20:03:30 +0000 (GMT)
Message-ID: <23599942.1148587410541.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 20:03:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-235) LocalFileSystem.openRaw() throws the
 wrong string for FileNotFoundException
In-Reply-To: <10557622.1148064449849.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-235?page=all ]
     
Doug Cutting resolved HADOOP-235:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

I just committed this.  Thanks, Ben!

> LocalFileSystem.openRaw() throws the wrong string for FileNotFoundException
> ---------------------------------------------------------------------------
>
>          Key: HADOOP-235
>          URL: http://issues.apache.org/jira/browse/HADOOP-235
>      Project: Hadoop
>         Type: Bug

>     Reporter: Benjamin Reed
>      Fix For: 0.3
>  Attachments: missing-f.patch
>
> openRaw should throw f.toString() on an error, not toString().

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 20:26:14 2006
Return-Path: 
 <hadoop-dev-return-1656-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23617 invoked from network); 25 May 2006 20:26:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 20:26:14 -0000
Received: (qmail 35544 invoked by uid 500); 25 May 2006 20:26:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35524 invoked by uid 500); 25 May 2006 20:26:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35515 invoked by uid 99); 25 May 2006 20:26:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 13:26:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 13:26:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 97BAA71423B
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 20:25:30 +0000 (GMT)
Message-ID: <28618116.1148588730618.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 20:25:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-254) use http to shuffle data between the
 maps and the reduces
In-Reply-To: <30577878.1148576129850.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-254?page=comments#action_12413298 ] 

Doug Cutting commented on HADOOP-254:
-------------------------------------

This looks great!

A couple of improvements:

1. in MapOutputLocation.getFile(), shouldn't things be closed in a 'finally' clause?
2. does MapOutputFile still need to be a Writable?  I don't think so.  We should remove its write & readFields implementations & any other methods that are no longer called.
3. do we have any way to detect when map outputs are lost or corrupted?  that was a useful mechanism that i'd hate to lose.
4. Sameer promised that you'd remove RPC.callRaw() in this patch.


> use http to shuffle data between the maps and the reduces
> ---------------------------------------------------------
>
>          Key: HADOOP-254
>          URL: http://issues.apache.org/jira/browse/HADOOP-254
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: http-shuffle.patch
>
> To speed up the shuffle time, I'll use http (via the task tracker's jetty server) to send the map outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 20:30:14 2006
Return-Path: 
 <hadoop-dev-return-1657-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24802 invoked from network); 25 May 2006 20:30:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 20:30:14 -0000
Received: (qmail 48226 invoked by uid 500); 25 May 2006 20:30:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48079 invoked by uid 500); 25 May 2006 20:30:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48064 invoked by uid 99); 25 May 2006 20:30:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 13:30:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 13:30:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9353271423B
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 20:29:30 +0000 (GMT)
Message-ID: <15955033.1148588970600.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 20:29:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-254) use http to shuffle data between the
 maps and the reduces
In-Reply-To: <30577878.1148576129850.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-254?page=comments#action_12413300 ] 

Doug Cutting commented on HADOOP-254:
-------------------------------------

Also, we should remove MapOutputProtocol.

> use http to shuffle data between the maps and the reduces
> ---------------------------------------------------------
>
>          Key: HADOOP-254
>          URL: http://issues.apache.org/jira/browse/HADOOP-254
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: http-shuffle.patch
>
> To speed up the shuffle time, I'll use http (via the task tracker's jetty server) to send the map outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 22:32:18 2006
Return-Path: 
 <hadoop-dev-return-1658-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53858 invoked from network); 25 May 2006 22:32:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 22:32:18 -0000
Received: (qmail 37346 invoked by uid 500); 25 May 2006 22:32:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37212 invoked by uid 500); 25 May 2006 22:32:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37202 invoked by uid 99); 25 May 2006 22:32:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 15:32:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 15:32:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CF69B7141FA
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 22:31:29 +0000 (GMT)
Message-ID: <1746800.1148596289846.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 22:31:29 +0000 (GMT+00:00)
From: "Naveen Nalam (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-255) Client Calls are not cancelled after a
 call timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Client Calls are not cancelled after a call timeout
---------------------------------------------------

         Key: HADOOP-255
         URL: http://issues.apache.org/jira/browse/HADOOP-255
     Project: Hadoop
        Type: Bug

  Components: ipc  
    Versions: 0.2.1    
 Environment: Tested on Linux 2.6
    Reporter: Naveen Nalam


In ipc/Client.java, if a call times out, a SocketTimeoutException is thrown but the Call object still exists on the queue.

What I found was that when transferring very large amounts of data, it's common for queued up calls to timeout. Yet even though the caller has is no longer waiting, the request is still serviced on the server and the data is sent to the client. The client after receiving the full response calls callComplete() which is a noop since nobody is waiting.

The problem is that the calls that timeout will retry and the system gets into a situation where data is being transferred around, but it's all data for timed out requests and no progress is ever made.

My quick solution to this was to add a "boolean timedout" to the Call object which I set to true whenever the queued caller times out. And then when the client starts to pull over the response data (in Connection::run) to first check if the Call is timedout and immediately close the connection.

I think a good fix for this is to queue requests on the client, and do a single sendParam only when there is no outstanding request. This will allow closing the connection when receiving a response for a request we no longer have pending, reopen the connection, and resend the next queued request. I can provide a patch for this, but I've seen a lot of recent activity in this area so I'd like to get some feedback first.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 23:23:15 2006
Return-Path: 
 <hadoop-dev-return-1659-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70390 invoked from network); 25 May 2006 23:23:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 23:23:15 -0000
Received: (qmail 42627 invoked by uid 500); 25 May 2006 23:23:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42604 invoked by uid 500); 25 May 2006 23:23:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42594 invoked by uid 99); 25 May 2006 23:23:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 16:23:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 16:23:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1046B71423B
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 23:22:31 +0000 (GMT)
Message-ID: <28635993.1148599351063.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 23:22:31 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12413315 ] 

alan wootton commented on HADOOP-90:
------------------------------------


I changed my mind. Now I'm looking for the smallest possible solution.

I just want a config to enable writing the edits to more than one place. The default config works exactly the same way as the existin code.

All the other details of backing up the NameNode image and edits can be handled outside of the code.

Here's the patch. 
 

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>  Attachments: multipleEditsDest.patch
>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu May 25 23:23:16 2006
Return-Path: 
 <hadoop-dev-return-1660-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70422 invoked from network); 25 May 2006 23:23:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 May 2006 23:23:16 -0000
Received: (qmail 42780 invoked by uid 500); 25 May 2006 23:23:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42756 invoked by uid 500); 25 May 2006 23:23:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42747 invoked by uid 99); 25 May 2006 23:23:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 16:23:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 16:23:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 6586F410005
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 23:22:32 +0000 (GMT)
Message-ID: <3058856.1148599352412.JavaMail.jira@brutus>
Date: Thu, 25 May 2006 23:22:32 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-90) DFS is succeptible to data loss in case
 of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-90?page=all ]

alan wootton updated HADOOP-90:
-------------------------------

    Attachment: multipleEditsDest.patch

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>  Attachments: multipleEditsDest.patch
>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 00:19:16 2006
Return-Path: 
 <hadoop-dev-return-1661-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85000 invoked from network); 26 May 2006 00:19:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 00:19:16 -0000
Received: (qmail 97909 invoked by uid 500); 26 May 2006 00:19:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97859 invoked by uid 500); 26 May 2006 00:19:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97827 invoked by uid 99); 26 May 2006 00:19:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 17:19:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 17:19:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E71B671428E
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 00:18:31 +0000 (GMT)
Message-ID: <21295115.1148602711943.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 00:18:31 +0000 (GMT+00:00)
From: "Sanjay Dahiya (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
In-Reply-To: <6140265.1148030971246.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-234?page=all ]

Sanjay Dahiya updated HADOOP-234:
---------------------------------

    Attachment: Hadoop MaReduce Developer doc.pdf

I am not sure if I am following correctly here, I am new to the codebase and so I took some time to document the MapReduce flow in the system. There are some things I am not clear about (bold italics in attachment). would be great if you could clarify. It may help others new to the project. 

In this specific case, RecordReader.next() is called by the framework (MapTask) and next() method knows  the boundry of the next Record in the File. In case it is a complex RecordIO type the boundry wont be known to anyone except the generated object, which contains code for reading and writing the object. This is the part which is not clear how a generic SequenceFile would know size/boundries of RecordIO objects. If the generated code contains code for reading the next record in a ByteWritable in addition to Record, this will be easy to implement. 
I think I am missing something here, can you please clarify ? 

> Support for writing Map/Reduce functions in C++
> -----------------------------------------------
>
>          Key: HADOOP-234
>          URL: http://issues.apache.org/jira/browse/HADOOP-234
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Sanjay Dahiya
>  Attachments: Hadoop MaReduce Developer doc.pdf
>
> MapReduce C++ support
> Requirements 
> 1. Allow users to write Map and Reduce functions in C++, rest of the 
> infrastructure already present in Java should be reused. 
> 2. Avoid users having to write both Java and C++ for this to work. 
> 3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
> 4. Use Record IO for describing record format, both MR java framework and C++ should 
> 	use the same format to work seemlessly. 
> 5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
> 	simple strings. 
> Implementation notes
> - If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
> 	mapper and reducer methods in C++. 
> - For composite Record IO types user starts with defining a record format using Record IO DDL. 
> - User generates Java and C++ classes from the DDL using record IO. 
> - Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
> - User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
>   makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
>   generated C++ record IO classes. 
> - User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 
> Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 
> Native(JNI) Java proxy for the Mapper : 
> ---------------------------------------
> Without Record IO :-
> --------------------
> public class SimpleNativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	  * Works on simple strings. 
> 	  **/
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		mapNative(key.toString().getBytes()
> 				, value.toString().getBytes(), output, reporter); 
> 	}
> 	
> 	/**
> 	  * Native implementation. 
> 	  **/
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> With Record IO :- 
> ------------------
> public class RecordIONativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	 * Implementation of map method, this acts as a JNI proxy for actual map 
> 	 * method implemented in C++. Works for Record IO based records. 
> 	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
> 	 */
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		
> 		byte[] keyBytes = null ;
> 		byte[] valueBytes = null ;
> 		
> 		try{
> 			// we need to serialize the key and record and pass the serialized 
> 			// format to C++ / JNI methods so they can interpret it using appropriate 
> 			// record IO classes. 
> 			{
> 				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				keyBytes = keyStream.toByteArray();
> 			}
> 			{
> 				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				valueBytes = valueStream.toByteArray();
> 			}
> 		}catch(ClassCastException e){
> 			// throw better exceptions
> 			throw new IOException("Input record must be of Record IO Type"); 
> 		}
> 		// pass the serialized byte[] to C++ implementation. 
> 		mapNative(keyBytes, valueBytes, output, reporter); 
> 	}
> 	/**
> 	 * Implementation in C++.
> 	 */
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> OutputCollector Proxy for C++
> ------------------------------
> public class NativeOutputCollector implements OutputCollector {
> 	// standard method from interface
> 	public void collect(WritableComparable key, Writable value)
> 			throws IOException {
> 	}
> 	
> 	// deserializes key and value and calls collect(WritableComparable, Writable)
> 	public void collectFromNative(byte[]key, byte[]value){
> 		// deserialize key and value to java types ( as configured in JobConf )
> 		// call actual collect method 
> 	}
> }
> Core Native functions ( helper for user provided Mapper and Reducer ) 
> ---------------------------------------------------------------------
> #include "org_apache_hadoop_mapred_NativeMapper.h"
> #include "UserMapper.h"
> /**
> 	* A C++ proxy method, calls actual implementation of the Mapper. This method 
> 	signature is generated by javah.
> **/
> JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
>   (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
>   	jobject output_collector, jobject reporter);
> {
>  
>  	// convert char* and pass on to user defined map method. 
>  	// user's map method should take care of converting it to correct record IO 
>  	// type.
>  	int keyLen = (*env)->GetArrayLength(env, key) ;
>  	int valueLen = (*env)->GetArrayLength(env, valueLen) ;
>  	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
>  	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
>  	
>  	// Call User defined method 
>  	user_map(keyBuf, valueBuf, output_collector, reporter) ;
>  	
>  	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
>  	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
> }
> /**
> 	Helper method, acts as a proxy to OutputCollector in java. key and value 
> 	must be serialized forms of records as specified in JobConf. 
> **/
> void output_collector(const char * key, const char *value,
> 	jobject output_collector, jobject reporter){
> 	
> 	// invoke java NativeOutputCollector.collect with key and value. 
> }
> User defined Mapper ( and Reducer ) 
> ------------------------------------
> /**
> 	implements user defined map operation. 
> **/
> void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {
> 	//1. deserialize key/value in the appropriate format using record IO. 
> 	
> 	//2. process key/value and generate the intermediate key/values in record IO format. 
> 	
> 	//3. Deserialize intermediate key/values to intermed_key and intermed_value
> 	
> 	//4. pass intermed_key/intermed_value using helper function - 
> 	// 		output_collector(intermed_key, intermed_value, collector, recorder);
> 	
> 	
> }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 01:38:13 2006
Return-Path: 
 <hadoop-dev-return-1662-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14159 invoked from network); 26 May 2006 01:38:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 01:38:13 -0000
Received: (qmail 74261 invoked by uid 500); 26 May 2006 01:38:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74235 invoked by uid 500); 26 May 2006 01:38:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74223 invoked by uid 99); 26 May 2006 01:38:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 18:38:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 18:38:12 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2B6D67141F9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 01:37:30 +0000 (GMT)
Message-ID: <24507604.1148607450153.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 01:37:30 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-50) dfs datanode should store blocks in
 multiple directories
In-Reply-To: <133992549.1140560804844.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-50?page=comments#action_12413330 ] 

alan wootton commented on HADOOP-50:
------------------------------------

+1
I didn't look at the patch, but I carefully read the commented out code. I vote yes. (is it already in? - close this issue).

> dfs datanode should store blocks in multiple directories
> --------------------------------------------------------
>
>          Key: HADOOP-50
>          URL: http://issues.apache.org/jira/browse/HADOOP-50
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Mike Cafarella
>      Fix For: 0.3
>  Attachments: hadoop.50.patch.1
>
> The datanode currently stores all file blocks in a single directory.  With 32MB blocks and terabyte filesystems, this will create too many files in a single directory for many filesystems.  Thus blocks should be stored in multiple directories, perhaps even a shallow hierarchy.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 01:48:14 2006
Return-Path: 
 <hadoop-dev-return-1663-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16660 invoked from network); 26 May 2006 01:48:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 01:48:14 -0000
Received: (qmail 82535 invoked by uid 500); 26 May 2006 01:48:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82513 invoked by uid 500); 26 May 2006 01:48:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82504 invoked by uid 99); 26 May 2006 01:48:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 18:48:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 18:48:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A4EEE7141F9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 01:47:30 +0000 (GMT)
Message-ID: <16005967.1148608050671.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 01:47:30 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-227) Namespace check pointing is not
 performed until the namenode restarts.
In-Reply-To: <17890828.1147909205885.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-227?page=comments#action_12413332 ] 

alan wootton commented on HADOOP-227:
-------------------------------------

Does anyone have a clever idea of how to take a snapshot of a running, very active, and very large, NameNode? Without things timing out like crazy? We're ok with the idea of just stopping everything once in a while and restarting the namenode. Still.... 

> Namespace check pointing is not performed until the namenode restarts.
> ----------------------------------------------------------------------
>
>          Key: HADOOP-227
>          URL: http://issues.apache.org/jira/browse/HADOOP-227
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Reporter: Konstantin Shvachko

>
> In current implementation when the name node starts, it reads its image file, then
> the edits file, and then saves the updated image back into the image file.
> The image file is never updated after that.
> In order to provide the system reliability reliability the namespace information should
> be check pointed periodically, and the edits file should be kept relatively small.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 02:51:43 2006
Return-Path: 
 <hadoop-dev-return-1664-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34432 invoked from network); 26 May 2006 02:51:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 02:51:43 -0000
Received: (qmail 48841 invoked by uid 500); 26 May 2006 02:51:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48819 invoked by uid 500); 26 May 2006 02:51:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48808 invoked by uid 99); 26 May 2006 02:51:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 19:51:42 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 19:51:42 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k4Q2pIum004933
	for <hadoop-dev@lucene.apache.org>; Thu, 25 May 2006 22:51:18 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k4Q2pJgC270900;
	Thu, 25 May 2006 22:51:20 -0400
Message-ID: <44766D27.10201@apache.org>
Date: Thu, 25 May 2006 19:51:19 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.8 (X11/20060502)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: ongoing =?ISO-8859-1?Q?=B7_On_Grids?=
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

We got some good press today from Tim Bray.

http://www.tbray.org/ongoing/When/200x/2006/05/24/On-Grids

Doug

From MAILER-DAEMON Fri May 26 03:40:15 2006
Return-Path: 
 <hadoop-dev-return-1665-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47832 invoked from network); 26 May 2006 03:40:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 03:40:15 -0000
Received: (qmail 81126 invoked by uid 500); 26 May 2006 03:40:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80999 invoked by uid 500); 26 May 2006 03:40:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80990 invoked by uid 99); 26 May 2006 03:40:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 20:40:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 20:40:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0B01771428E
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 03:39:31 +0000 (GMT)
Message-ID: <28228017.1148614771042.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 03:39:31 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-124) don't permit two datanodes to run from
 same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]

Konstantin Shvachko updated HADOOP-124:
---------------------------------------

    Attachment:     (was: DirNotSharing.patch)

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 03:45:19 2006
Return-Path: 
 <hadoop-dev-return-1666-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48890 invoked from network); 26 May 2006 03:45:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 03:45:19 -0000
Received: (qmail 85042 invoked by uid 500); 26 May 2006 03:45:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85019 invoked by uid 500); 26 May 2006 03:45:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85009 invoked by uid 99); 26 May 2006 03:45:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 20:45:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 20:45:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1122671429B
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 03:44:31 +0000 (GMT)
Message-ID: <6401203.1148615071067.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 03:44:31 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-124) don't permit two datanodes to run from
 same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]

Konstantin Shvachko updated HADOOP-124:
---------------------------------------

    Attachment: Hadoop-124.patch

Yes, that was a MiniDFSCluster incomatibility.
Fixed that, merged with the current version,
removed the exception package.


> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, Hadoop-124.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 06:52:15 2006
Return-Path: 
 <hadoop-dev-return-1667-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83029 invoked from network); 26 May 2006 06:52:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 06:52:15 -0000
Received: (qmail 30219 invoked by uid 500); 26 May 2006 06:52:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30091 invoked by uid 500); 26 May 2006 06:52:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30082 invoked by uid 99); 26 May 2006 06:52:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 23:52:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 25 May 2006 23:52:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8E5A97142C9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 06:51:30 +0000 (GMT)
Message-ID: <9946923.1148626290580.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 06:51:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-255) Client Calls are not cancelled after
 a call timeout
In-Reply-To: <1746800.1148596289846.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-255?page=comments#action_12413382 ] 

Owen O'Malley commented on HADOOP-255:
--------------------------------------

There are three parts to this. The first part is that I'm just about done with converting the map output to use http rather than rpc. So that aspect of this problem will go away.

The second part is that this behavior happens on all of the rpc's, not just map output transfer. However, sending a message now to potentially prevent a future message is not necessarily a winning game. If you did send a "cancel call" message, you'd probably want to remove the call from the server's work queue if it is still waiting to be processed.

It is tempting to try a strategy where you check the age of a call when you start processing it on the server and reject messages that are too old, but the problem is that it is _not_ 10 seconds from the start of the call, but rather 10 seconds with no data received on the socket, which is hard for the server to estimate. 

The final part is that this characteristic that the server can not assume that the return message from the rpc call was received is a problem. For example, I had a problem with pollForNewTask timing out and dropping tasks. I fixed that by adding a timeout so that after a task is assigned to a task tracker, it it does not show up in a task tracker status message within 10 minutes it is considered lost. However, this applies to _all_ of the rpc messages. You always need to make sure that if the return value of the rpc call were to disappear into thin air that the problem would be detected eventually. There are other instances of this ind of problem that still exist in the code that need to be identified and fixed.

> Client Calls are not cancelled after a call timeout
> ---------------------------------------------------
>
>          Key: HADOOP-255
>          URL: http://issues.apache.org/jira/browse/HADOOP-255
>      Project: Hadoop
>         Type: Bug

>   Components: ipc
>     Versions: 0.2.1
>  Environment: Tested on Linux 2.6
>     Reporter: Naveen Nalam

>
> In ipc/Client.java, if a call times out, a SocketTimeoutException is thrown but the Call object still exists on the queue.
> What I found was that when transferring very large amounts of data, it's common for queued up calls to timeout. Yet even though the caller has is no longer waiting, the request is still serviced on the server and the data is sent to the client. The client after receiving the full response calls callComplete() which is a noop since nobody is waiting.
> The problem is that the calls that timeout will retry and the system gets into a situation where data is being transferred around, but it's all data for timed out requests and no progress is ever made.
> My quick solution to this was to add a "boolean timedout" to the Call object which I set to true whenever the queued caller times out. And then when the client starts to pull over the response data (in Connection::run) to first check if the Call is timedout and immediately close the connection.
> I think a good fix for this is to queue requests on the client, and do a single sendParam only when there is no outstanding request. This will allow closing the connection when receiving a response for a request we no longer have pending, reopen the connection, and resend the next queued request. I can provide a patch for this, but I've seen a lot of recent activity in this area so I'd like to get some feedback first.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 15:56:18 2006
Return-Path: 
 <hadoop-dev-return-1668-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66833 invoked from network); 26 May 2006 15:56:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 15:56:18 -0000
Received: (qmail 24831 invoked by uid 500); 26 May 2006 15:56:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24755 invoked by uid 500); 26 May 2006 15:56:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24680 invoked by uid 99); 26 May 2006 15:56:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 08:56:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 08:56:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 91EF97142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 15:55:30 +0000 (GMT)
Message-ID: <17737154.1148658930594.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 15:55:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-255) Client Calls are not cancelled after
 a call timeout
In-Reply-To: <1746800.1148596289846.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-255?page=comments#action_12413490 ] 

Doug Cutting commented on HADOOP-255:
-------------------------------------

I think this is, in general, something that we won't fix.  It might be possible to improve things, but we cannot, without elaborate handshake protocols, guarantee that RPC responses are received by clients.  As Owen has indicated, we must instead make our applications tolerant of that.

Note that this is generally a problem for HTTP-based services too.  When someone hits "stop" in their browser for a slow request, the server generally continues to compute the request and only discovers that the connection has been closed when it attempts to write the response, if at all.  If the client times out after the server has flushed the response, then there's no way for the server to know this.

You sugguest that we might queue requests on the client so that only a single request to a particular server is outstanding at a time.  That would not work well for distributed search (Nutch's original IPC application).  In distributed search a front end typically has many queries outstanding.  Each query is broadcast to a number of back end servers.  Different queries take different amounts of time.  We do not want to make fast queries wait for slow queries, as that would make all queries slow and increase the burden on the front end servers.

Would folks object if I resolve this as a WONTFIX bug?

> Client Calls are not cancelled after a call timeout
> ---------------------------------------------------
>
>          Key: HADOOP-255
>          URL: http://issues.apache.org/jira/browse/HADOOP-255
>      Project: Hadoop
>         Type: Bug

>   Components: ipc
>     Versions: 0.2.1
>  Environment: Tested on Linux 2.6
>     Reporter: Naveen Nalam

>
> In ipc/Client.java, if a call times out, a SocketTimeoutException is thrown but the Call object still exists on the queue.
> What I found was that when transferring very large amounts of data, it's common for queued up calls to timeout. Yet even though the caller has is no longer waiting, the request is still serviced on the server and the data is sent to the client. The client after receiving the full response calls callComplete() which is a noop since nobody is waiting.
> The problem is that the calls that timeout will retry and the system gets into a situation where data is being transferred around, but it's all data for timed out requests and no progress is ever made.
> My quick solution to this was to add a "boolean timedout" to the Call object which I set to true whenever the queued caller times out. And then when the client starts to pull over the response data (in Connection::run) to first check if the Call is timedout and immediately close the connection.
> I think a good fix for this is to queue requests on the client, and do a single sendParam only when there is no outstanding request. This will allow closing the connection when receiving a response for a request we no longer have pending, reopen the connection, and resend the next queued request. I can provide a patch for this, but I've seen a lot of recent activity in this area so I'd like to get some feedback first.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 17:17:16 2006
Return-Path: 
 <hadoop-dev-return-1669-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88767 invoked from network); 26 May 2006 17:17:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 17:17:16 -0000
Received: (qmail 65240 invoked by uid 500); 26 May 2006 17:17:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65216 invoked by uid 500); 26 May 2006 17:17:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65202 invoked by uid 99); 26 May 2006 17:17:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 10:17:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 10:17:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A2A617142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 17:16:30 +0000 (GMT)
Message-ID: <13734562.1148663790663.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 17:16:30 +0000 (GMT+00:00)
From: "Naveen Nalam (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-255) Client Calls are not cancelled after
 a call timeout
In-Reply-To: <1746800.1148596289846.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-255?page=comments#action_12413498 ] 

Naveen Nalam commented on HADOOP-255:
-------------------------------------

Well the problem I was seeing is that a getFile RPC request for say 1GB was issued, but then the Call object timedout on the client. Yet the 1GB was still transferred fully to the client and then discarded since there was no waiting Call object. My system got into a situation where 1000s of getFile requests were queued up per node in the server's tcp receive buffers. So you can see how no progress would have ever been made.

Are you suggesting that this is not going to be a problem because all the large response body RPCs will now be done over HTTP?  I can't see how leaving the code as it is would be fine, unless all RPCs are going to be very quick to service and have small response bodies.

You mentioned that search queries is an example of an RPC that could be broadcast out. What would happen if the queries were taking too long to service and the client side rpc request was already timing out. I could see it get into a similar situation where the servers would become busy processing stale query requests.

So if all the RPCs will be small response bodies, then it seems fine to keep the connection always open and just read in the response and throw it away. And then why not add a CANCEL-RPC request type that can get sent over whenever the client request has timed out?

> Client Calls are not cancelled after a call timeout
> ---------------------------------------------------
>
>          Key: HADOOP-255
>          URL: http://issues.apache.org/jira/browse/HADOOP-255
>      Project: Hadoop
>         Type: Bug

>   Components: ipc
>     Versions: 0.2.1
>  Environment: Tested on Linux 2.6
>     Reporter: Naveen Nalam

>
> In ipc/Client.java, if a call times out, a SocketTimeoutException is thrown but the Call object still exists on the queue.
> What I found was that when transferring very large amounts of data, it's common for queued up calls to timeout. Yet even though the caller has is no longer waiting, the request is still serviced on the server and the data is sent to the client. The client after receiving the full response calls callComplete() which is a noop since nobody is waiting.
> The problem is that the calls that timeout will retry and the system gets into a situation where data is being transferred around, but it's all data for timed out requests and no progress is ever made.
> My quick solution to this was to add a "boolean timedout" to the Call object which I set to true whenever the queued caller times out. And then when the client starts to pull over the response data (in Connection::run) to first check if the Call is timedout and immediately close the connection.
> I think a good fix for this is to queue requests on the client, and do a single sendParam only when there is no outstanding request. This will allow closing the connection when receiving a response for a request we no longer have pending, reopen the connection, and resend the next queued request. I can provide a patch for this, but I've seen a lot of recent activity in this area so I'd like to get some feedback first.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 18:11:15 2006
Return-Path: 
 <hadoop-dev-return-1670-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3346 invoked from network); 26 May 2006 18:11:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 18:11:15 -0000
Received: (qmail 39865 invoked by uid 500); 26 May 2006 18:11:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39734 invoked by uid 500); 26 May 2006 18:11:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39725 invoked by uid 99); 26 May 2006 18:11:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 11:11:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 11:11:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9BCF57142EB
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 18:10:30 +0000 (GMT)
Message-ID: <11213289.1148667030635.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 18:10:30 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-255) Client Calls are not cancelled after
 a call timeout
In-Reply-To: <1746800.1148596289846.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-255?page=comments#action_12413505 ] 

paul sutter commented on HADOOP-255:
------------------------------------


Doug,

We realize all of this will change with all the great copy/sort-path work being done at Yahoo, but here's what we're seeing: When our individual map output files get large, like >1GB, we get endless cascading timeouts.

Naveen found the actual cause of this:

- The map output response capacity of each tasktracker is equal to the _average_ number of concurrent requests sent to each tasktracker. Eg, with two tasks per node, the capacity is two tasks. The average number of requests is two, but that means some nodes get 4 requests and some nodes get 0.

- Tasktrackers queue up over-the-limit requests. When the files are large, the time it takes to complete the previous requests exceeds the timeout interval. This means the client stops waiting for the file, and requests it again.

- Meanwhile, the old request for thr file is eventually processed, and it runs to completion, snce the current clicnt RPC code merrily receives it although nobody is waiting for it.. Since that file is over a gigabyte, it holds up the works for a long time, long enough that waiting tasks timeout, causing more additional requests.

So what happens is, you get an endless cycle of timed-out requests, that are eventually satisfied, causing useless transfers of >1GB, which cause more timeouts, etc.

Obviously, the new efforts at Yahoo will change this considerably, for example _not_ multiplexing these transfers within a single TCP session will allow termination of the TCP session on a timeout, which will prevent large, useless transfers from happening.

But I just wanted to explain what we were seeing, and why it is definitely uncool to proceed with large transfers when nobody will use the results.

We'll try out the new Yahoo code, and see what we get. I suspect that this will help a lot.

> Client Calls are not cancelled after a call timeout
> ---------------------------------------------------
>
>          Key: HADOOP-255
>          URL: http://issues.apache.org/jira/browse/HADOOP-255
>      Project: Hadoop
>         Type: Bug

>   Components: ipc
>     Versions: 0.2.1
>  Environment: Tested on Linux 2.6
>     Reporter: Naveen Nalam

>
> In ipc/Client.java, if a call times out, a SocketTimeoutException is thrown but the Call object still exists on the queue.
> What I found was that when transferring very large amounts of data, it's common for queued up calls to timeout. Yet even though the caller has is no longer waiting, the request is still serviced on the server and the data is sent to the client. The client after receiving the full response calls callComplete() which is a noop since nobody is waiting.
> The problem is that the calls that timeout will retry and the system gets into a situation where data is being transferred around, but it's all data for timed out requests and no progress is ever made.
> My quick solution to this was to add a "boolean timedout" to the Call object which I set to true whenever the queued caller times out. And then when the client starts to pull over the response data (in Connection::run) to first check if the Call is timedout and immediately close the connection.
> I think a good fix for this is to queue requests on the client, and do a single sendParam only when there is no outstanding request. This will allow closing the connection when receiving a response for a request we no longer have pending, reopen the connection, and resend the next queued request. I can provide a patch for this, but I've seen a lot of recent activity in this area so I'd like to get some feedback first.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 18:38:20 2006
Return-Path: 
 <hadoop-dev-return-1671-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11517 invoked from network); 26 May 2006 18:38:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 18:38:20 -0000
Received: (qmail 96418 invoked by uid 500); 26 May 2006 18:38:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96388 invoked by uid 500); 26 May 2006 18:38:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96379 invoked by uid 99); 26 May 2006 18:38:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 11:38:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 11:38:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B990E7142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 18:37:33 +0000 (GMT)
Message-ID: <12009467.1148668653756.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 18:37:33 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-108) EOFException in
 DataNode$DataXceiver.run
In-Reply-To: <252030003.1143587841245.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-108?page=all ]

Sameer Paranjpye updated HADOOP-108:
------------------------------------

    Fix Version: 0.2
        Version: 0.1.1

> EOFException in DataNode$DataXceiver.run
> ----------------------------------------
>
>          Key: HADOOP-108
>          URL: http://issues.apache.org/jira/browse/HADOOP-108
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Igor Bolotin
>      Fix For: 0.2

>
> This morning - after upgrade of the system - something got wrong and we started to get lot of exceptions.
> Situation didn't change after removing everything and creating new file system. 
> Multiple exceptions on all data nodes:
> 060328 145922 108 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:448)
>         at java.lang.Thread.run(Thread.java:595)
> No errors on the name node.
> DFS clients report following:
> 060328 150923 task_r_2twzsl  Error while writing.
> 060328 150923 task_r_2twzsl java.net.SocketTimeoutException: Read timed out
> 060328 150923 task_r_2twzsl     at java.net.SocketInputStream.socketRead0(Native Method)
> 060328 150923 task_r_2twzsl     at java.net.SocketInputStream.read(SocketInputStream.java:129)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
> 060328 150923 task_r_2twzsl     at java.io.DataInputStream.readFully(DataInputStream.java:176)
> 060328 150923 task_r_2twzsl     at java.io.DataInputStream.readLong(DataInputStream.java:380)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:776)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.endBlock(DFSClient.java:751)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.close(DFSClient.java:814)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.fs.FileSystem.createNewFile(FileSystem.java:202)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 18:40:19 2006
Return-Path: 
 <hadoop-dev-return-1672-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11738 invoked from network); 26 May 2006 18:40:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 18:40:19 -0000
Received: (qmail 228 invoked by uid 500); 26 May 2006 18:40:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 206 invoked by uid 500); 26 May 2006 18:40:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 197 invoked by uid 99); 26 May 2006 18:40:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 11:40:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 11:40:18 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BF7947142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 18:39:32 +0000 (GMT)
Message-ID: <8325512.1148668772781.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 18:39:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-108) EOFException in
 DataNode$DataXceiver.run
In-Reply-To: <252030003.1143587841245.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-108?page=all ]
     
Sameer Paranjpye resolved HADOOP-108:
-------------------------------------

    Resolution: Duplicate

Duplicate of HADOOP-128

> EOFException in DataNode$DataXceiver.run
> ----------------------------------------
>
>          Key: HADOOP-108
>          URL: http://issues.apache.org/jira/browse/HADOOP-108
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Igor Bolotin
>      Fix For: 0.2

>
> This morning - after upgrade of the system - something got wrong and we started to get lot of exceptions.
> Situation didn't change after removing everything and creating new file system. 
> Multiple exceptions on all data nodes:
> 060328 145922 108 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:448)
>         at java.lang.Thread.run(Thread.java:595)
> No errors on the name node.
> DFS clients report following:
> 060328 150923 task_r_2twzsl  Error while writing.
> 060328 150923 task_r_2twzsl java.net.SocketTimeoutException: Read timed out
> 060328 150923 task_r_2twzsl     at java.net.SocketInputStream.socketRead0(Native Method)
> 060328 150923 task_r_2twzsl     at java.net.SocketInputStream.read(SocketInputStream.java:129)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
> 060328 150923 task_r_2twzsl     at java.io.DataInputStream.readFully(DataInputStream.java:176)
> 060328 150923 task_r_2twzsl     at java.io.DataInputStream.readLong(DataInputStream.java:380)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:776)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.endBlock(DFSClient.java:751)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.close(DFSClient.java:814)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.fs.FileSystem.createNewFile(FileSystem.java:202)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 18:42:18 2006
Return-Path: 
 <hadoop-dev-return-1673-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12216 invoked from network); 26 May 2006 18:42:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 18:42:18 -0000
Received: (qmail 7411 invoked by uid 500); 26 May 2006 18:42:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7354 invoked by uid 500); 26 May 2006 18:42:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7312 invoked by uid 99); 26 May 2006 18:42:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 11:42:16 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 11:42:15 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7923A7142ED
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 18:41:31 +0000 (GMT)
Message-ID: <25842179.1148668891493.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 18:41:31 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-254) use http to shuffle data between the
 maps and the reduces
In-Reply-To: <30577878.1148576129850.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-254?page=all ]

Owen O'Malley updated HADOOP-254:
---------------------------------

    Attachment: http-shuffle-2.patch

Ok, here is an updated patch that addresses Doug's concerns.

1. Local file system is now used for reading and writing the map output files. Hopefully, this won't hurt our performance too much.

2. Exceptions reading the map outputs call TaskTracker.lostMapOutput so the map is marked as failed. (I tested this by manually changing a character in one of the map output files and making sure that the map reran.)

3. I removed the assumption that the TaskTracker is a singleton.

4. I added set/getAttribute on the StatusHttpServer so that the user can pass objects to the jsp code.

5. I removed more of the dead code (RPC.callRaw, MapOutputFile)

> use http to shuffle data between the maps and the reduces
> ---------------------------------------------------------
>
>          Key: HADOOP-254
>          URL: http://issues.apache.org/jira/browse/HADOOP-254
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: http-shuffle-2.patch, http-shuffle.patch
>
> To speed up the shuffle time, I'll use http (via the task tracker's jetty server) to send the map outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 19:46:21 2006
Return-Path: 
 <hadoop-dev-return-1674-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40767 invoked from network); 26 May 2006 19:46:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 19:46:21 -0000
Received: (qmail 91919 invoked by uid 500); 26 May 2006 19:46:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91845 invoked by uid 500); 26 May 2006 19:46:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91784 invoked by uid 99); 26 May 2006 19:46:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 12:46:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 12:46:16 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1093641000B
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 19:45:33 +0000 (GMT)
Message-ID: <28533074.1148672733065.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 19:45:33 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-254) use http to shuffle data between the
 maps and the reduces
In-Reply-To: <30577878.1148576129850.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-254?page=all ]
     
Doug Cutting resolved HADOOP-254:
---------------------------------

    Resolution: Fixed

I just committed this. You rock, Owen.

> use http to shuffle data between the maps and the reduces
> ---------------------------------------------------------
>
>          Key: HADOOP-254
>          URL: http://issues.apache.org/jira/browse/HADOOP-254
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: http-shuffle-2.patch, http-shuffle.patch
>
> To speed up the shuffle time, I'll use http (via the task tracker's jetty server) to send the map outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 20:35:14 2006
Return-Path: 
 <hadoop-dev-return-1675-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54076 invoked from network); 26 May 2006 20:35:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 20:35:14 -0000
Received: (qmail 65610 invoked by uid 500); 26 May 2006 20:35:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65482 invoked by uid 500); 26 May 2006 20:35:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65473 invoked by uid 99); 26 May 2006 20:35:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 13:35:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 13:35:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D39C57142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 20:34:29 +0000 (GMT)
Message-ID: <6195280.1148675669863.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 20:34:29 +0000 (GMT+00:00)
From: "Arun C Murthy (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-256) Implement a C api for hadoop dfs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Implement a C api for hadoop dfs
--------------------------------

         Key: HADOOP-256
         URL: http://issues.apache.org/jira/browse/HADOOP-256
     Project: Hadoop
        Type: New Feature

  Components: dfs  
    Reporter: Arun C Murthy


Implement a C api for hadoop dfs to ease talking to hadoop's dfs from native C/C++ applications.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 21:12:16 2006
Return-Path: 
 <hadoop-dev-return-1676-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62393 invoked from network); 26 May 2006 21:12:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 21:12:16 -0000
Received: (qmail 1719 invoked by uid 500); 26 May 2006 21:12:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1698 invoked by uid 500); 26 May 2006 21:12:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1689 invoked by uid 99); 26 May 2006 21:12:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:12:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:12:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 05CA67142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 21:11:31 +0000 (GMT)
Message-ID: <8848291.1148677891020.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 21:11:31 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12413532 ] 

Yoram Arnon commented on HADOOP-90:
-----------------------------------

seems like all the extra copies will be on the same node, right?
so if it dies, so does the filesystem...
perhaps the bug should be cloned, with the patch resolving a bug, but leaving the current bug open until it's more fully addressed.

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>  Attachments: multipleEditsDest.patch
>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 21:19:16 2006
Return-Path: 
 <hadoop-dev-return-1677-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62838 invoked from network); 26 May 2006 21:19:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 21:19:16 -0000
Received: (qmail 5076 invoked by uid 500); 26 May 2006 21:19:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5056 invoked by uid 500); 26 May 2006 21:19:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5047 invoked by uid 99); 26 May 2006 21:19:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:19:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:19:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F03D07142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 21:18:30 +0000 (GMT)
Message-ID: <26985399.1148678310981.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 21:18:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12413533 ] 

Doug Cutting commented on HADOOP-90:
------------------------------------

The low-tech thing I've done that's saved me when the namenode dies is simply to have a cron entry that rsyncs the namenode's files to another node every few minutes.  If the namenode dies, you lose at most a few minutes of computation.  It's not perfect, and its not a long-term solution, but it is a pretty effective workaround in my experience.

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>  Attachments: multipleEditsDest.patch
>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 21:32:16 2006
Return-Path: 
 <hadoop-dev-return-1678-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66997 invoked from network); 26 May 2006 21:32:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 21:32:16 -0000
Received: (qmail 16500 invoked by uid 500); 26 May 2006 21:32:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16483 invoked by uid 500); 26 May 2006 21:32:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16473 invoked by uid 99); 26 May 2006 21:32:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:32:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:32:15 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2BA567142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 21:31:31 +0000 (GMT)
Message-ID: <11577309.1148679091175.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 21:31:31 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12413534 ] 

Yoram Arnon commented on HADOOP-90:
-----------------------------------

I've done the same, alternating between two backup nodes.
it's band-aid, until a real solution is devised.

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>  Attachments: multipleEditsDest.patch
>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 21:36:18 2006
Return-Path: 
 <hadoop-dev-return-1679-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68405 invoked from network); 26 May 2006 21:36:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 21:36:18 -0000
Received: (qmail 19286 invoked by uid 500); 26 May 2006 21:36:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19253 invoked by uid 500); 26 May 2006 21:36:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19210 invoked by uid 99); 26 May 2006 21:36:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:36:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:36:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CB4D07142E8
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 21:35:30 +0000 (GMT)
Message-ID: <20671270.1148679330830.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 21:35:30 +0000 (GMT+00:00)
From: "Anonymous (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-256) Implement a C api for hadoop dfs
In-Reply-To: <6195280.1148675669863.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-256?page=all ]

 updated HADOOP-256:
--------------------

    Attachment: libhdfs.patch

> Implement a C api for hadoop dfs
> --------------------------------
>
>          Key: HADOOP-256
>          URL: http://issues.apache.org/jira/browse/HADOOP-256
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Reporter: Arun C Murthy
>  Attachments: libhdfs.patch
>
> Implement a C api for hadoop dfs to ease talking to hadoop's dfs from native C/C++ applications.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 21:41:20 2006
Return-Path: 
 <hadoop-dev-return-1680-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71500 invoked from network); 26 May 2006 21:41:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 21:41:20 -0000
Received: (qmail 24423 invoked by uid 500); 26 May 2006 21:41:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24391 invoked by uid 500); 26 May 2006 21:41:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24362 invoked by uid 99); 26 May 2006 21:41:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:41:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 14:41:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1D9F27142ED
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 21:40:34 +0000 (GMT)
Message-ID: <11673485.1148679634118.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 21:40:34 +0000 (GMT+00:00)
From: "Arun C Murthy (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-256) Implement a C api for hadoop dfs
In-Reply-To: <6195280.1148675669863.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-256?page=comments#action_12413538 ] 

Arun C Murthy commented on HADOOP-256:
--------------------------------------

I have attached libhdfs.patch...

It creates a new sub-dir: hadoop/src/c++/libhdfs and also a port of hadoop/src/test/org/apache/hadoop/fs/TestDFSIO.java called src/test/org/apache/hadoop/fs/TestDFSCIO.java which I have added to src/test/org/apache/hadoop/test/AllTestDriver.java.

thanks,
Arun

> Implement a C api for hadoop dfs
> --------------------------------
>
>          Key: HADOOP-256
>          URL: http://issues.apache.org/jira/browse/HADOOP-256
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Reporter: Arun C Murthy
>  Attachments: libhdfs.patch
>
> Implement a C api for hadoop dfs to ease talking to hadoop's dfs from native C/C++ applications.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 22:08:15 2006
Return-Path: 
 <hadoop-dev-return-1681-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76729 invoked from network); 26 May 2006 22:08:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 22:08:15 -0000
Received: (qmail 50124 invoked by uid 500); 26 May 2006 22:08:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50095 invoked by uid 500); 26 May 2006 22:08:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50084 invoked by uid 99); 26 May 2006 22:08:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 15:08:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 15:08:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 966E47142E8
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 22:07:30 +0000 (GMT)
Message-ID: <18167124.1148681250613.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 22:07:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-256) Implement a C api for hadoop dfs
In-Reply-To: <6195280.1148675669863.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-256?page=comments#action_12413540 ] 

Doug Cutting commented on HADOOP-256:
-------------------------------------

This looks good, but the build still needs some work.

I tried to run 'make' in the source directory, but had to first add $(LDFLAGS) to a number of the targets to stop complaints about finding libjvm.so.  Also, it would be best to add a target to build.xml that builds this.  Builds should not write files in the source tree: it would be better to have all of the compiler outputs placed in the top-level build directory (e.g., in ../../../build/libhdfs, or as specified in an environment variable passed from build.xml).

Most of the above are also valid complaints about librecordio.  I must not have been paying enough attention when I committed that!

The tests depend on executables in /tmp, but, as far as I can see, there's nothing that puts them there.

The goal is that one should be able to check things out of subversion and run something like:

  ant test-libhdfs

And have the code build and run.  It is safe to assume that folks have gcc, make, etc. installed and available.  Ideally this would work on Cygwin as well as linux, but that's a lower priority.

Thanks!

> Implement a C api for hadoop dfs
> --------------------------------
>
>          Key: HADOOP-256
>          URL: http://issues.apache.org/jira/browse/HADOOP-256
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Reporter: Arun C Murthy
>  Attachments: libhdfs.patch
>
> Implement a C api for hadoop dfs to ease talking to hadoop's dfs from native C/C++ applications.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 22:24:16 2006
Return-Path: 
 <hadoop-dev-return-1682-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78661 invoked from network); 26 May 2006 22:24:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 22:24:16 -0000
Received: (qmail 63785 invoked by uid 500); 26 May 2006 22:24:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63764 invoked by uid 500); 26 May 2006 22:24:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63755 invoked by uid 99); 26 May 2006 22:24:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 15:24:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 15:24:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0F95B7142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 22:23:31 +0000 (GMT)
Message-ID: <33046592.1148682211061.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 22:23:31 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-163?page=all ]

Hairong Kuang updated HADOOP-163:
---------------------------------

    Attachment: disk.patch

In this patch, if a data node finds that its data directory becomes not readable or writable, it logs the error and reports the problem to its namen ode and shut down itself. When the name node receives the error report, it lots the error and removes the data node info.

A data node detects disk problem at startup time, when it receives a r/w request, after it receives a command from its name node, and before it sends out a block report. A data node will not start up if its data dir is not readable or writable. 

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Runping Qi
>     Assignee: Hairong Kuang
>      Fix For: 0.3
>  Attachments: disk.patch
>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 22:43:16 2006
Return-Path: 
 <hadoop-dev-return-1683-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81782 invoked from network); 26 May 2006 22:43:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 22:43:16 -0000
Received: (qmail 80520 invoked by uid 500); 26 May 2006 22:43:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80501 invoked by uid 500); 26 May 2006 22:43:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80492 invoked by uid 99); 26 May 2006 22:43:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 15:43:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 15:43:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0F29E7142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 22:42:31 +0000 (GMT)
Message-ID: <31446965.1148683351059.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 22:42:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-163) If a DFS datanode cannot write onto
 its file system. it should tell the name node not to assign new blocks to
 it.
In-Reply-To: <12688000.1145915542692.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-163?page=all ]
     
Doug Cutting resolved HADOOP-163:
---------------------------------

    Resolution: Fixed

This looks great!  I just committed it.  Thanks, Hairong!

> If a DFS datanode cannot write onto its file system. it should tell the name node not to assign new blocks to it.
> -----------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-163
>          URL: http://issues.apache.org/jira/browse/HADOOP-163
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Runping Qi
>     Assignee: Hairong Kuang
>      Fix For: 0.3
>  Attachments: disk.patch
>
> I observed that sometime, if a file of a data node is not mounted properly, it may not be writable. In this case, any data writes will fail. The name node should stop assigning new blocks to that data node. The webpage should show that node is in an abnormal state.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri May 26 23:08:15 2006
Return-Path: 
 <hadoop-dev-return-1684-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87701 invoked from network); 26 May 2006 23:08:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 May 2006 23:08:15 -0000
Received: (qmail 5253 invoked by uid 500); 26 May 2006 23:08:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5235 invoked by uid 500); 26 May 2006 23:08:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5226 invoked by uid 99); 26 May 2006 23:08:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 16:08:14 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 26 May 2006 16:08:13 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D338F7142E9
	for <hadoop-dev@lucene.apache.org>; Fri, 26 May 2006 23:07:29 +0000 (GMT)
Message-ID: <9587378.1148684849862.JavaMail.jira@brutus>
Date: Fri, 26 May 2006 23:07:29 +0000 (GMT+00:00)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-257) starting one data node thread to
 manage multiple data directories
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

starting one data node thread to manage multiple data directories
-----------------------------------------------------------------

         Key: HADOOP-257
         URL: http://issues.apache.org/jira/browse/HADOOP-257
     Project: Hadoop
        Type: Improvement

  Components: dfs  
    Reporter: Hairong Kuang


If a data node is configured with multiple data directories, current implementation of dfs will start multiple data node threads, each of which manages one data directory and talks to its name node independently. From the name node's point of view, it sees multiple data nodes instead of one.

I feel that a more scalable solution should be to start one data node thread that manages multiple data diretories. But the one data node thread needs to take care of the block allocation problem.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat May 27 07:18:16 2006
Return-Path: 
 <hadoop-dev-return-1685-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59323 invoked from network); 27 May 2006 07:18:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 May 2006 07:18:16 -0000
Received: (qmail 27489 invoked by uid 500); 27 May 2006 07:18:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27456 invoked by uid 500); 27 May 2006 07:18:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27442 invoked by uid 99); 27 May 2006 07:18:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 27 May 2006 00:18:15 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 27 May 2006 00:18:14 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D04E17142E9
	for <hadoop-dev@lucene.apache.org>; Sat, 27 May 2006 07:17:29 +0000 (GMT)
Message-ID: <27132555.1148714249850.JavaMail.jira@brutus>
Date: Sat, 27 May 2006 07:17:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-258) Cannot obtain block errors
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Cannot obtain block errors
--------------------------

         Key: HADOOP-258
         URL: http://issues.apache.org/jira/browse/HADOOP-258
     Project: Hadoop
        Type: Bug

  Components: dfs =20
    Versions: 0.3   =20
    Reporter: Owen O'Malley
 Assigned to: Sameer Paranjpye=20


I've been seeing a lot of errors from dfs for the last couple days. The exc=
eption that I see is:

java.io.IOException: Could not obtain block: blk_2867431916903738534 file=
=3D/user/oom/big-rand/part000271 offset=3D0 at org.apache.hadoop.dfs.DFSCli=
ent$DFSInputStream.blockSeekTo(DFSClient.java:532) at org.apache.hadoop.dfs=
.DFSClient$DFSInputStream.read(DFSClient.java:641) at org.apache.hadoop.fs.=
FSDataInputStream$Checker.read(FSDataInputStream.java:83) at org.apache.had=
oop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158) at =
java.io.BufferedInputStream.fill(BufferedInputStream.java:218) at java.io.B=
ufferedInputStream.read1(BufferedInputStream.java:256) at java.io.BufferedI=
nputStream.read(BufferedInputStream.java:313) at java.io.DataInputStream.re=
adFully(DataInputStream.java:176) at java.io.DataInputStream.readFully(Data=
InputStream.java:152) at org.apache.hadoop.io.SequenceFile$Reader.init(Sequ=
enceFile.java:264) at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFil=
e.java:248) at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:=
238) at org.apache.hadoop.mapred.SequenceFileRecordReader.(SequenceFileReco=
rdReader.java:36) at org.apache.hadoop.mapred.SequenceFileInputFormat.getRe=
cordReader(SequenceFileInputFormat.java:53) at org.apache.hadoop.mapred.Map=
Task.run(MapTask.java:105) at org.apache.hadoop.mapred.TaskTracker$Child.ma=
in(TaskTracker.java:866)

I haven't had my fingers in that code recently, does it ring any bells for =
anyone?

--=20
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 29 03:24:19 2006
Return-Path: 
 <hadoop-dev-return-1686-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72204 invoked from network); 29 May 2006 03:24:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 May 2006 03:24:19 -0000
Received: (qmail 464 invoked by uid 500); 29 May 2006 03:24:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 327 invoked by uid 500); 29 May 2006 03:24:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 318 invoked by uid 99); 29 May 2006 03:24:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 28 May 2006 20:24:18 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 28 May 2006 20:24:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8F9C87142A1
	for <hadoop-dev@lucene.apache.org>; Mon, 29 May 2006 03:23:30 +0000 (GMT)
Message-ID: <2726529.1148873010585.JavaMail.jira@brutus>
Date: Mon, 29 May 2006 03:23:30 +0000 (GMT+00:00)
From: "Arun C Murthy (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-256) Implement a C api for hadoop dfs
In-Reply-To: <6195280.1148675669863.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-256?page=comments#action_12413660 ] 

Arun C Murthy commented on HADOOP-256:
--------------------------------------

Doug,

  Appreciate your feedback... some minor queries/responses:

    a) I'm working on getting the whole thing integrated with build.xml/ant and also about putting all outputs in the top-level build directory. librecordio led me down the wrong garden path.
    
    b) Can you please elaborate on the issues you had with LDFLAGS? On my system (Gentoo GNU/Linux - 2.6.16.11) make/makeclean works for me i.e. there are no issues building it.  I'm relying on $JAVA_HOME in my Makefile (it's set to /opt/sun-jdk-1.5.0.06 on my box - afaik it's the recommended way?) to point me libjvm.so. This isn't prefect (e.g. $(JAVA_HOME)/jre/lib/i386/server won't work on non i386 architectures??) Is there a better alternative?
       Since I wasn't clear which system path to dump the .so I'm building (any suggestions?), I just used LD_PRELOAD to run my executable (hdfs_test) - admit I should have clearly pointed this out. 
       For the same reason I had to resort to --rpath tricks to get TestDFSCIO to work (i.e. both hdfs_read & hdfs_write executables have an --rpath for libhdfs.so.1). This was very necessary for getting the hdfs_{read|write} to work with map/reduce. Appreciate any suggestions...
    
    c) Does it make sense to just copy the executables from $(HADOOP_HOME)/libhdfs to /tmp/TestDFSCIO from the client (initialization phase) on which the tests are initiated? Admit this completely slipped my mind, glaringly. My bad. 

thanks,
Arun
        

> Implement a C api for hadoop dfs
> --------------------------------
>
>          Key: HADOOP-256
>          URL: http://issues.apache.org/jira/browse/HADOOP-256
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Reporter: Arun C Murthy
>  Attachments: libhdfs.patch
>
> Implement a C api for hadoop dfs to ease talking to hadoop's dfs from native C/C++ applications.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 29 06:17:18 2006
Return-Path: 
 <hadoop-dev-return-1687-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 98579 invoked from network); 29 May 2006 06:17:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 May 2006 06:17:18 -0000
Received: (qmail 14275 invoked by uid 500); 29 May 2006 06:17:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14235 invoked by uid 500); 29 May 2006 06:17:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14212 invoked by uid 99); 29 May 2006 06:17:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 28 May 2006 23:17:17 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 28 May 2006 23:17:17 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CB1337142E9
	for <hadoop-dev@lucene.apache.org>; Mon, 29 May 2006 06:16:29 +0000 (GMT)
Message-ID: <30473871.1148883389827.JavaMail.jira@brutus>
Date: Mon, 29 May 2006 06:16:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-259) map output http client does not
 timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

map output http client does not timeout
---------------------------------------

         Key: HADOOP-259
         URL: http://issues.apache.org/jira/browse/HADOOP-259
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.3    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.3


The new map output http client uses java.net.URLConnection to fetch the data file. However under Java 1.4 there is no way to specify a timeout and it is set to infinite (or if not infinite at least 12 hours).  This causes reduce tasks to get "stuck" in the "reduce > copy" phase even after the "Task failed to report status for 600 seconds. Killing." message.

I will add the code in the ReduceTaskRunner to make sure that copies in-flight don't get stuck, but this is another point where a switch to java 1.5 would be helpful. Under 1.5 I could set the timeout on the connection and the read would timeout after the given interval and my entire change would be local to MapOutputLocation.copyFile.

For now, I'll assume that we need to maintain support for 1.4 and make the corresponding fix, but I'm grumbling...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 29 19:28:20 2006
Return-Path: 
 <hadoop-dev-return-1688-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44251 invoked from network); 29 May 2006 19:28:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 May 2006 19:28:20 -0000
Received: (qmail 10197 invoked by uid 500); 29 May 2006 19:28:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10064 invoked by uid 500); 29 May 2006 19:28:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10055 invoked by uid 99); 29 May 2006 19:28:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 29 May 2006 12:28:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 29 May 2006 12:28:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 937857142F1
	for <hadoop-dev@lucene.apache.org>; Mon, 29 May 2006 19:27:30 +0000 (GMT)
Message-ID: <19047647.1148930850600.JavaMail.jira@brutus>
Date: Mon, 29 May 2006 19:27:30 +0000 (GMT+00:00)
From: "Arun C Murthy (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-256) Implement a C api for hadoop dfs
In-Reply-To: <6195280.1148675669863.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-256?page=all ]

Arun C Murthy updated HADOOP-256:
---------------------------------

    Attachment: libhdfs-new.patch.tgz

Doug,

  Please find attached a new patch incorporating your feedback. Specifically: libhdfs is now integrated with build.xml, fixed TestDFSCIO.java to automatically copy the executables to /tmp/TestDFSCIO on the remoted filesystem and some minor enhancements to the Makefile.

thanks,
Arun

> Implement a C api for hadoop dfs
> --------------------------------
>
>          Key: HADOOP-256
>          URL: http://issues.apache.org/jira/browse/HADOOP-256
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Reporter: Arun C Murthy
>  Attachments: libhdfs-new.patch.tgz, libhdfs.patch
>
> Implement a C api for hadoop dfs to ease talking to hadoop's dfs from native C/C++ applications.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 29 21:37:20 2006
Return-Path: 
 <hadoop-dev-return-1689-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70434 invoked from network); 29 May 2006 21:37:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 May 2006 21:37:20 -0000
Received: (qmail 32854 invoked by uid 500); 29 May 2006 21:37:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32720 invoked by uid 500); 29 May 2006 21:37:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32711 invoked by uid 99); 29 May 2006 21:37:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 29 May 2006 14:37:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 29 May 2006 14:37:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B03667142EF
	for <hadoop-dev@lucene.apache.org>; Mon, 29 May 2006 21:36:30 +0000 (GMT)
Message-ID: <18537755.1148938590719.JavaMail.jira@brutus>
Date: Mon, 29 May 2006 21:36:30 +0000 (GMT+00:00)
From: "Johan Oskarson (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-222?page=comments#action_12413746 ] 

Johan Oskarson commented on HADOOP-222:
---------------------------------------

I finally had some time to fix the issues in the previous patch.
Posting new patch that shouldn't throw any nasty exceptions if the user doesn't provide all the needed input

> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>  Attachments: setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon May 29 21:39:20 2006
Return-Path: 
 <hadoop-dev-return-1690-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72088 invoked from network); 29 May 2006 21:39:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 May 2006 21:39:20 -0000
Received: (qmail 35377 invoked by uid 500); 29 May 2006 21:39:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35240 invoked by uid 500); 29 May 2006 21:39:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35231 invoked by uid 99); 29 May 2006 21:39:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 29 May 2006 14:39:19 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 29 May 2006 14:39:19 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 991087142EF
	for <hadoop-dev@lucene.apache.org>; Mon, 29 May 2006 21:38:30 +0000 (GMT)
Message-ID: <28361934.1148938710624.JavaMail.jira@brutus>
Date: Mon, 29 May 2006 21:38:30 +0000 (GMT+00:00)
From: "Johan Oskarson (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-222?page=all ]

Johan Oskarson updated HADOOP-222:
----------------------------------

    Attachment: setrep-v2.patch

New version with error handling etc

> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>  Attachments: setrep-v2.patch, setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 12:01:21 2006
Return-Path: 
 <hadoop-dev-return-1691-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70109 invoked from network); 30 May 2006 12:01:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 12:01:21 -0000
Received: (qmail 48837 invoked by uid 500); 30 May 2006 12:01:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48811 invoked by uid 500); 30 May 2006 12:01:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48802 invoked by uid 99); 30 May 2006 12:01:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 05:01:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 05:01:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 90CF1714294
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 12:00:30 +0000 (GMT)
Message-ID: <19237455.1148990430590.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 12:00:30 +0000 (GMT+00:00)
From: "Sanjay Dahiya (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
In-Reply-To: <6140265.1148030971246.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-234?page=all ]

Sanjay Dahiya updated HADOOP-234:
---------------------------------

    Attachment: Hadoop MaReduce Developer doc.pdf

Updated ... 

> Support for writing Map/Reduce functions in C++
> -----------------------------------------------
>
>          Key: HADOOP-234
>          URL: http://issues.apache.org/jira/browse/HADOOP-234
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Sanjay Dahiya
>  Attachments: Hadoop MaReduce Developer doc.pdf, Hadoop MaReduce Developer doc.pdf
>
> MapReduce C++ support
> Requirements 
> 1. Allow users to write Map and Reduce functions in C++, rest of the 
> infrastructure already present in Java should be reused. 
> 2. Avoid users having to write both Java and C++ for this to work. 
> 3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
> 4. Use Record IO for describing record format, both MR java framework and C++ should 
> 	use the same format to work seemlessly. 
> 5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
> 	simple strings. 
> Implementation notes
> - If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
> 	mapper and reducer methods in C++. 
> - For composite Record IO types user starts with defining a record format using Record IO DDL. 
> - User generates Java and C++ classes from the DDL using record IO. 
> - Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
> - User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
>   makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
>   generated C++ record IO classes. 
> - User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 
> Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 
> Native(JNI) Java proxy for the Mapper : 
> ---------------------------------------
> Without Record IO :-
> --------------------
> public class SimpleNativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	  * Works on simple strings. 
> 	  **/
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		mapNative(key.toString().getBytes()
> 				, value.toString().getBytes(), output, reporter); 
> 	}
> 	
> 	/**
> 	  * Native implementation. 
> 	  **/
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> With Record IO :- 
> ------------------
> public class RecordIONativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	 * Implementation of map method, this acts as a JNI proxy for actual map 
> 	 * method implemented in C++. Works for Record IO based records. 
> 	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
> 	 */
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		
> 		byte[] keyBytes = null ;
> 		byte[] valueBytes = null ;
> 		
> 		try{
> 			// we need to serialize the key and record and pass the serialized 
> 			// format to C++ / JNI methods so they can interpret it using appropriate 
> 			// record IO classes. 
> 			{
> 				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				keyBytes = keyStream.toByteArray();
> 			}
> 			{
> 				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				valueBytes = valueStream.toByteArray();
> 			}
> 		}catch(ClassCastException e){
> 			// throw better exceptions
> 			throw new IOException("Input record must be of Record IO Type"); 
> 		}
> 		// pass the serialized byte[] to C++ implementation. 
> 		mapNative(keyBytes, valueBytes, output, reporter); 
> 	}
> 	/**
> 	 * Implementation in C++.
> 	 */
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> OutputCollector Proxy for C++
> ------------------------------
> public class NativeOutputCollector implements OutputCollector {
> 	// standard method from interface
> 	public void collect(WritableComparable key, Writable value)
> 			throws IOException {
> 	}
> 	
> 	// deserializes key and value and calls collect(WritableComparable, Writable)
> 	public void collectFromNative(byte[]key, byte[]value){
> 		// deserialize key and value to java types ( as configured in JobConf )
> 		// call actual collect method 
> 	}
> }
> Core Native functions ( helper for user provided Mapper and Reducer ) 
> ---------------------------------------------------------------------
> #include "org_apache_hadoop_mapred_NativeMapper.h"
> #include "UserMapper.h"
> /**
> 	* A C++ proxy method, calls actual implementation of the Mapper. This method 
> 	signature is generated by javah.
> **/
> JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
>   (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
>   	jobject output_collector, jobject reporter);
> {
>  
>  	// convert char* and pass on to user defined map method. 
>  	// user's map method should take care of converting it to correct record IO 
>  	// type.
>  	int keyLen = (*env)->GetArrayLength(env, key) ;
>  	int valueLen = (*env)->GetArrayLength(env, valueLen) ;
>  	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
>  	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
>  	
>  	// Call User defined method 
>  	user_map(keyBuf, valueBuf, output_collector, reporter) ;
>  	
>  	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
>  	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
> }
> /**
> 	Helper method, acts as a proxy to OutputCollector in java. key and value 
> 	must be serialized forms of records as specified in JobConf. 
> **/
> void output_collector(const char * key, const char *value,
> 	jobject output_collector, jobject reporter){
> 	
> 	// invoke java NativeOutputCollector.collect with key and value. 
> }
> User defined Mapper ( and Reducer ) 
> ------------------------------------
> /**
> 	implements user defined map operation. 
> **/
> void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {
> 	//1. deserialize key/value in the appropriate format using record IO. 
> 	
> 	//2. process key/value and generate the intermediate key/values in record IO format. 
> 	
> 	//3. Deserialize intermediate key/values to intermed_key and intermed_value
> 	
> 	//4. pass intermed_key/intermed_value using helper function - 
> 	// 		output_collector(intermed_key, intermed_value, collector, recorder);
> 	
> 	
> }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 17:49:02 2006
Return-Path: 
 <hadoop-dev-return-1693-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13252 invoked from network); 30 May 2006 17:49:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 17:49:02 -0000
Received: (qmail 69021 invoked by uid 500); 30 May 2006 17:48:57 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68821 invoked by uid 500); 30 May 2006 17:48:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68801 invoked by uid 99); 30 May 2006 17:48:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 10:48:55 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 10:48:54 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9B9D6714416
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 15:50:30 +0000 (GMT)
Message-ID: <9569630.1149004230634.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 15:50:30 +0000 (GMT+00:00)
From: "paul sutter (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-259) map output http client does not
 timeout
In-Reply-To: <30473871.1148883389827.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-259?page=comments#action_12413846 ] 

paul sutter commented on HADOOP-259:
------------------------------------


Moving to 1.5 is fine for us, in fact I recommend it.

> map output http client does not timeout
> ---------------------------------------
>
>          Key: HADOOP-259
>          URL: http://issues.apache.org/jira/browse/HADOOP-259
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3

>
> The new map output http client uses java.net.URLConnection to fetch the data file. However under Java 1.4 there is no way to specify a timeout and it is set to infinite (or if not infinite at least 12 hours).  This causes reduce tasks to get "stuck" in the "reduce > copy" phase even after the "Task failed to report status for 600 seconds. Killing." message.
> I will add the code in the ReduceTaskRunner to make sure that copies in-flight don't get stuck, but this is another point where a switch to java 1.5 would be helpful. Under 1.5 I could set the timeout on the connection and the read would timeout after the given interval and my entire change would be local to MapOutputLocation.copyFile.
> For now, I'll assume that we need to maintain support for 1.4 and make the corresponding fix, but I'm grumbling...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 17:37:30 2006
Return-Path: 
 <hadoop-dev-return-1692-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10289 invoked from network); 30 May 2006 17:37:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 17:37:30 -0000
Received: (qmail 52443 invoked by uid 500); 30 May 2006 17:37:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52249 invoked by uid 500); 30 May 2006 17:37:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52129 invoked by uid 99); 30 May 2006 17:37:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 10:37:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 10:37:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 182037142FD
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 17:36:32 +0000 (GMT)
Message-ID: <21500410.1149010592096.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 17:36:32 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-242) job fails because of "No valid local
 directories in property: " exception
In-Reply-To: <13734662.1148411729914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-242?page=all ]

Owen O'Malley updated HADOOP-242:
---------------------------------

    Attachment: no-local.patch

Here is a patch that increases the logging associated with this failure. It also tries to switch the condition around based on the possibility of multiple processes or threads. So it does:

fs.mkdirs(dir) || fs.exists(dir)

instead of:

fs.exists(dir) || fs.mkdirs(dir)

> job fails because of "No valid local directories in property: " exception
> -------------------------------------------------------------------------
>
>          Key: HADOOP-242
>          URL: http://issues.apache.org/jira/browse/HADOOP-242
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>  Attachments: no-local.patch
>
> when running a fairly large job, of 70+K map tasks, I get many exceptions as shown below, and eventually the job failes when a task fails four times.
> The exception doesn't really tell us enough information to debug this properly, so the first thing to do would be to add more information (path) to the exception.
> The path indicated in the config file exists, is writable and valid, though 'path' may be anything.
> the exception:
> java.io.IOException: No valid local directories in property: mapred.local.dir at org.apache.hadoop.conf.Configuration.getLocalPath(Configuration.java:293) at org.apache.hadoop.mapred.JobConf.getLocalPath(JobConf.java:153) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:523) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.launchTask(TaskTracker.java:572) at org.apache.hadoop.mapred.TaskTracker.startNewTask(TaskTracker.java:389) at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:303) at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:418) at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:920)
> the code:
>   public Path getLocalPath(String dirsProp, String path)
>     throws IOException {
>     String[] dirs = getStrings(dirsProp);
>     int hashCode = path.hashCode();
>     FileSystem fs = FileSystem.getNamed("local", this);
>     for (int i = 0; i < dirs.length; i++) {  // try each local dir
>       int index = (hashCode+i & Integer.MAX_VALUE) % dirs.length;
>       Path file = new Path(dirs[index], path);
>       Path dir = file.getParent();
>       if (fs.exists(dir) || fs.mkdirs(dir)) {
>         return file;
>       }
>     }
>     throw new IOException("No valid local directories in property: "+dirsProp);
>   }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 17:51:21 2006
Return-Path: 
 <hadoop-dev-return-1694-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14421 invoked from network); 30 May 2006 17:51:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 17:51:21 -0000
Received: (qmail 80578 invoked by uid 500); 30 May 2006 17:51:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80556 invoked by uid 500); 30 May 2006 17:51:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80547 invoked by uid 99); 30 May 2006 17:51:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 10:51:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 10:51:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9DB16714301
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 17:50:30 +0000 (GMT)
Message-ID: <29407944.1149011430643.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 17:50:30 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-222?page=comments#action_12413863 ] 

Konstantin Shvachko commented on HADOOP-222:
--------------------------------------------

+1

> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>  Attachments: setrep-v2.patch, setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:35:26 2006
Return-Path: 
 <hadoop-dev-return-1695-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37932 invoked from network); 30 May 2006 18:35:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:35:26 -0000
Received: (qmail 61488 invoked by uid 500); 30 May 2006 18:35:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61392 invoked by uid 500); 30 May 2006 18:35:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61176 invoked by uid 99); 30 May 2006 18:35:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:35:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:35:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9AC4E7141E3
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:34:31 +0000 (GMT)
Message-ID: <16723581.1149014071631.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:34:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-53) MapReduce log files should be storable
 in dfs.
In-Reply-To: <13654009.1140640359390.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-53?page=all ]

Sameer Paranjpye updated HADOOP-53:
-----------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> MapReduce log files should be storable in dfs.
> ----------------------------------------------
>
>          Key: HADOOP-53
>          URL: http://issues.apache.org/jira/browse/HADOOP-53
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Sameer Paranjpye
>      Fix For: 0.4

>
> It should be possible to cause a job's log output to be stored in dfs.  The jobtracker's log output and (optionally) all tasktracker log output related to a job should be storable in a job-specified dfs directory.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:41:23 2006
Return-Path: 
 <hadoop-dev-return-1696-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40897 invoked from network); 30 May 2006 18:41:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:41:23 -0000
Received: (qmail 73529 invoked by uid 500); 30 May 2006 18:41:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73509 invoked by uid 500); 30 May 2006 18:41:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73500 invoked by uid 99); 30 May 2006 18:41:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:41:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:41:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8BD787141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:40:30 +0000 (GMT)
Message-ID: <14584511.1149014430570.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:40:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-59) support generic command-line options
In-Reply-To: <321463887.1140733957324.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-59?page=comments#action_12413874 ] 

Sameer Paranjpye commented on HADOOP-59:
----------------------------------------

This looks like it has been addressed by the refactoring done in HADOOP-59. Does this need to stay open?

> support generic command-line options
> ------------------------------------
>
>          Key: HADOOP-59
>          URL: http://issues.apache.org/jira/browse/HADOOP-59
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Michel Tourn
>      Fix For: 0.4
>  Attachments: Tool.java, ToolBase.java, bashfile.patch, toolbase.patch
>
> Hadoop commands should all support some common options.  For example, it should be possible to specify the namenode, datanode, and, for that matter, any config option, in a generic way.
> This could be implemented with code like:
> public interface Tool extends Configurable {
>   void run(String[] args) throws Exception;
> }
> public class ToolBase implements Tool extends Configured {
>   public final void main(String[] args) throws Exception {
>     Configuration conf = new Configuration();
>     ... parse config options from args into conf ...
>     this.configure(conf);
>     this.run();
>   }
> }
> public MyTool extends ExcecutableBase {
>   public static void main(String[] args) throws Exception {
>     new MyTool().main(args);
>   }
> }
> The general command line syntax could be:
> bin/hadoop [generalOptions] command [commandOptions]
> Where generalOptions are things that ToolBase handles, and only the commandOptions are passed to Tool.run().  The most important generalOption would be '-D', which would define name/value pairs that are set in the configuration.  This alone would permit folks to set the namenode, datanode, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:41:28 2006
Return-Path: 
 <hadoop-dev-return-1697-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40989 invoked from network); 30 May 2006 18:41:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:41:28 -0000
Received: (qmail 73733 invoked by uid 500); 30 May 2006 18:41:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73711 invoked by uid 500); 30 May 2006 18:41:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73702 invoked by uid 99); 30 May 2006 18:41:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:41:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:41:26 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CE599714219
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:40:31 +0000 (GMT)
Message-ID: <21273777.1149014431842.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:40:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-59) support generic command-line options
In-Reply-To: <321463887.1140733957324.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-59?page=all ]

Sameer Paranjpye updated HADOOP-59:
-----------------------------------

    Fix Version: 0.4
                     (was: 0.3)
       Priority: Minor  (was: Major)

> support generic command-line options
> ------------------------------------
>
>          Key: HADOOP-59
>          URL: http://issues.apache.org/jira/browse/HADOOP-59
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Michel Tourn
>     Priority: Minor
>      Fix For: 0.4
>  Attachments: Tool.java, ToolBase.java, bashfile.patch, toolbase.patch
>
> Hadoop commands should all support some common options.  For example, it should be possible to specify the namenode, datanode, and, for that matter, any config option, in a generic way.
> This could be implemented with code like:
> public interface Tool extends Configurable {
>   void run(String[] args) throws Exception;
> }
> public class ToolBase implements Tool extends Configured {
>   public final void main(String[] args) throws Exception {
>     Configuration conf = new Configuration();
>     ... parse config options from args into conf ...
>     this.configure(conf);
>     this.run();
>   }
> }
> public MyTool extends ExcecutableBase {
>   public static void main(String[] args) throws Exception {
>     new MyTool().main(args);
>   }
> }
> The general command line syntax could be:
> bin/hadoop [generalOptions] command [commandOptions]
> Where generalOptions are things that ToolBase handles, and only the commandOptions are passed to Tool.run().  The most important generalOption would be '-D', which would define name/value pairs that are set in the configuration.  This alone would permit folks to set the namenode, datanode, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:43:22 2006
Return-Path: 
 <hadoop-dev-return-1698-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41487 invoked from network); 30 May 2006 18:43:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:43:22 -0000
Received: (qmail 76340 invoked by uid 500); 30 May 2006 18:43:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76298 invoked by uid 500); 30 May 2006 18:43:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76289 invoked by uid 99); 30 May 2006 18:43:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:43:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:43:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B235D7141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:42:30 +0000 (GMT)
Message-ID: <29219404.1149014550727.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:42:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-109) Blocks are not replicated when...
In-Reply-To: <985692887.1143603799440.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-109?page=all ]

Sameer Paranjpye updated HADOOP-109:
------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> Blocks are not replicated when...
> ---------------------------------
>
>          Key: HADOOP-109
>          URL: http://issues.apache.org/jira/browse/HADOOP-109
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> When the block is under-replicated the namenode places it into
> FSNamesystem.neededReplications list.
> When a datanode D1 sends getBlockwork() request to the namenode, the namenode
> selects another node D2 (which it thinks is up and running) where the new replica of the
> under-replicated block will be stored.
> Then namenode removes the block from the neededReplications list and places it to
> the pendingReplications list, and then asks D1 to replicate the block to D2.
> If D2 is in fact down, then replication will fail and will never be retried later, because
> the block is not in the neededReplications list, but rather in the pendingReplications list,
> which namenode never checks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:43:22 2006
Return-Path: 
 <hadoop-dev-return-1699-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41488 invoked from network); 30 May 2006 18:43:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:43:22 -0000
Received: (qmail 76413 invoked by uid 500); 30 May 2006 18:43:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76316 invoked by uid 500); 30 May 2006 18:43:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76299 invoked by uid 99); 30 May 2006 18:43:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:43:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:43:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D7945714204
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:42:30 +0000 (GMT)
Message-ID: <32103939.1149014550880.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:42:30 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-260) the start up scripts should take a
 command line parameter --config making it easy to run multiple hadoop
 installation on same machines
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

the start up scripts should take a command line parameter --config making it easy to run multiple hadoop installation on same machines
--------------------------------------------------------------------------------------------------------------------------------------

         Key: HADOOP-260
         URL: http://issues.apache.org/jira/browse/HADOOP-260
     Project: Hadoop
        Type: Improvement

    Reporter: Mahadev konar
 Assigned to: Mahadev konar 
    Priority: Minor


--config paramter would allow getting rid of SSH_OPTS.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:45:21 2006
Return-Path: 
 <hadoop-dev-return-1700-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42234 invoked from network); 30 May 2006 18:45:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:45:21 -0000
Received: (qmail 81628 invoked by uid 500); 30 May 2006 18:45:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81609 invoked by uid 500); 30 May 2006 18:45:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81600 invoked by uid 99); 30 May 2006 18:45:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:45:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:45:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 95C8A7141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:44:30 +0000 (GMT)
Message-ID: <12697943.1149014670610.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:44:30 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-260) the start up scripts should take a
 command line parameter --config making it easy to run multiple hadoop
 installation on same machines
In-Reply-To: <32103939.1149014550880.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-260?page=all ]

Mahadev konar updated HADOOP-260:
---------------------------------

    Attachment: config.patch

This patch allows for a --config command line argument to all the scripts. It still works if HADOOP_CONF_DIR env variable is set and --config is not specified.

> the start up scripts should take a command line parameter --config making it easy to run multiple hadoop installation on same machines
> --------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-260
>          URL: http://issues.apache.org/jira/browse/HADOOP-260
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>  Attachments: config.patch
>
> --config paramter would allow getting rid of SSH_OPTS.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:49:26 2006
Return-Path: 
 <hadoop-dev-return-1701-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44042 invoked from network); 30 May 2006 18:49:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:49:26 -0000
Received: (qmail 86732 invoked by uid 500); 30 May 2006 18:49:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86712 invoked by uid 500); 30 May 2006 18:49:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86700 invoked by uid 99); 30 May 2006 18:49:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:49:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:49:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D42017141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:48:29 +0000 (GMT)
Message-ID: <18552838.1149014909866.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:48:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-261) when map outputs are lost, nothing is
 shown in the webapp about why the map task failed
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

when map outputs are lost, nothing is shown in the webapp about why the map task failed
---------------------------------------------------------------------------------------

         Key: HADOOP-261
         URL: http://issues.apache.org/jira/browse/HADOOP-261
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


When a task tracker invokes mapOutputLost, it does not include a diagnostic that lets the user (or the web app) know what failed in the map. I want to add a diagnostic message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:51:27 2006
Return-Path: 
 <hadoop-dev-return-1703-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44591 invoked from network); 30 May 2006 18:51:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:51:27 -0000
Received: (qmail 92008 invoked by uid 500); 30 May 2006 18:51:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91944 invoked by uid 500); 30 May 2006 18:51:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91934 invoked by uid 99); 30 May 2006 18:51:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:51:26 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:51:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AB1257141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:50:30 +0000 (GMT)
Message-ID: <29312201.1149015030698.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:50:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-147) MapTask removed mapout files before
 the reduce tasks copy them
In-Reply-To: <27888818.1145408057411.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-147?page=all ]
     
Sameer Paranjpye resolved HADOOP-147:
-------------------------------------

    Fix Version: 0.2
                     (was: 0.3)
     Resolution: Duplicate

The fix to HADOOP-150 addresses conflicts in job and task ids.

> MapTask removed mapout files before the reduce tasks copy them
> --------------------------------------------------------------
>
>          Key: HADOOP-147
>          URL: http://issues.apache.org/jira/browse/HADOOP-147
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Runping Qi
>      Fix For: 0.2

>
> I was running a job on a cluster of 138 nodes. The job had 1050 map tasks and 128 reduce tasks. It stucked at the reduce stage.
> All the reduce tasks were trying to copy file from a map task with the following status show on the web interface:
> reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
> However, the log on the machine node1262 (where the map task task_m_ehz5q1 ran) showed that the map task finished even before the 
> reduce tasks copied the map output files:
> 060417 103554 Server connection on port 60050 from 72.30.117.220: starting
> 060417 103554 task_m_ehz5q1  Client connection to 0.0.0.0:60050: starting
> 060417 103554 task_m_ehz5q1 1.0% /user/runping/runping/proj/part-00039:0+71
> 060417 103554 Task task_m_ehz5q1 is done.
> 060417 103554 parsing file:/local/hadoop/conf2/hadoop-default.xml
> ......................
> 060417 103613 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 103623 task_m_ehz5q1 done; removing files.
> 060417 103633 parsing file:/local/hadoop/conf2/hadoop-default.xml
> 060417 103633 parsing file:/local/hadoop/conf2/mapred-default.xml
> 060417 103633 parsing file:/local/hadoop/conf2/hadoop-site.xml
> ...........................................
> 060417 190241 SEVERE Can't open map output:/local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
> java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
> 060417 190241 Unknown child with bad map output: task_m_ehz5q1. Ignored.
> 060417 190241 Server handler 2 on 60040 caught: java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
> java.io.FileNotFoundException: /local/hadoop/mapred/local/task_m_ehz5q1/part-32.out
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:115)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:154)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:231)
> 060417 190241 parsing file:/local/hadoop/conf2/hadoop-default.xml
> 060417 190241 parsing file:/local/hadoop/conf2/mapred-default.xml
> And the above exceptions repeated for many (not sure whether it is tru for all the reduce task) other reduce tasks.
> Another strange thing noticed from the logs.
> On another machine's log, I saw:
> 060417 190528 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 190528 task_r_24d8k4 copy failed: task_m_ehz5q1 from node1262.foo.com/72.30.117.220:60040
> java.io.IOException: timed out waiting for response
>         at org.apache.hadoop.ipc.Client.call(Client.java:305)
>         at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:141)
>         at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
>         at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:110)
>         at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:66)
> 060417 190528 task_r_24d8k4 0.11523809% reduce > copy > task_m_ehz5q1@node1262.foo.com:60040
> 060417 190528 task_r_24d8k4 Copying task_m_epatk8 output from node1387.foo.com.
>                                
> which is expected. However, before this line, 
> I saw another copy activity in the log:
> 060417 103608 parsing file:/local/hadoop/conf2/hadoop-site.xml
> 060417 103608 task_r_a4yl3t Copying task_m_ehz5q1 output from node1262.foo.com.
> 060417 103608 parsing file:/local/hadoop/conf2/hadoop-default.xml
> And the task task_r_a4yl3t does not belong to the concerned job, 
> according to the Web interface. That is strange.
> And I checked a few other machines where some reduce tasks ran, 
> and I saw the same thing.
> I suspect there was a conflict in job ID. If two jobs had the same ID, 
> when one closes, it may also mark the other as "closed" too, thus trggering map tasks
> to clean up prematurely.
> A simple way to avoid potential jobid conflict is to use sequential numbers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:51:24 2006
Return-Path: 
 <hadoop-dev-return-1702-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44529 invoked from network); 30 May 2006 18:51:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:51:24 -0000
Received: (qmail 91750 invoked by uid 500); 30 May 2006 18:51:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91718 invoked by uid 500); 30 May 2006 18:51:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91705 invoked by uid 99); 30 May 2006 18:51:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:51:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:51:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 437B371428D
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:50:33 +0000 (GMT)
Message-ID: <15108223.1149015033273.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:50:33 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-165) long response times from task trackers
 under load
In-Reply-To: <28414302.1145982857680.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-165?page=all ]

Sameer Paranjpye updated HADOOP-165:
------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> long response times from task trackers under load
> -------------------------------------------------
>
>          Key: HADOOP-165
>          URL: http://issues.apache.org/jira/browse/HADOOP-165
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>  Environment: 190 redhat linux boxes, each with 2 hyperthreaded cpus, 2gb memory
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> we are seeing very slow response times from the task tracker. I put in some instrumentation to measure how long each call took for the RPC.Sever code to run the method (so it does not include serialization/deserialization time). The top of the list (in ms) looks like:
> 7581 progress node1192
> 7022 ping node1192
> 5393 ping node1162
> 4854 progress node1162
> 4749 progress node1194
> 4709 ping node1194
> 3813 ping node1100
> 3486 ping node1190
> 3266 progress node1190
> 3187 progress node1265
> 3078 ping node1203
> 2972 progress node1203
> 2947 progress node1240
> 2889 progress node1100
> 2875 ping node1116
> 2843 ping node1189
> 2772 ping node1183
> 2737 ping node1110
> 2727 progress node1183
> 2710 ping node1123
> 2563 ping node1304
> 2527 progress node1144
> 2479 ping node1137
> 2476 progress node1304
> 2430 ping node1240
> 2416 ping node1144
> 2377 progress node1176
> 2339 ping node1109
> 2321 progress node1114
> 2311 ping node1157
> 2185 ping node1265
> 2185 ping node1109
> 2172 ping node1114
> 2145 progress node1109
> 2127 ping node1176
> 2083 progress node1189
> 2076 ping node1229
> 2073 progress node1188
> 2072 progress node1123
> 2048 ping node1161
> 2003 progress node1110
> 1989 ping node1180
> 1963 ping node1114

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:53:22 2006
Return-Path: 
 <hadoop-dev-return-1704-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45302 invoked from network); 30 May 2006 18:53:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:53:22 -0000
Received: (qmail 94614 invoked by uid 500); 30 May 2006 18:53:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94594 invoked by uid 500); 30 May 2006 18:53:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94585 invoked by uid 99); 30 May 2006 18:53:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:53:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:53:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 952917141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:52:30 +0000 (GMT)
Message-ID: <32672943.1149015150608.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:52:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-75) dfs should check full file
 availability only at close
In-Reply-To: <873621841.1142030138809.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-75?page=comments#action_12413878 ] 

Sameer Paranjpye commented on HADOOP-75:
----------------------------------------

Doug, can this be committed for the 0.3 release?

> dfs should check full file availability only at close
> -----------------------------------------------------
>
>          Key: HADOOP-75
>          URL: http://issues.apache.org/jira/browse/HADOOP-75
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: hadoop-75.patch
>
> Currently it appears that dfs checks that the namenode knows about all blocks in a file as each block is written.  It would be more efficient to only check that all blocks are stored somewhere when the file is closed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:57:21 2006
Return-Path: 
 <hadoop-dev-return-1705-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45875 invoked from network); 30 May 2006 18:57:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:57:21 -0000
Received: (qmail 96989 invoked by uid 500); 30 May 2006 18:57:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96966 invoked by uid 500); 30 May 2006 18:57:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96957 invoked by uid 99); 30 May 2006 18:57:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:57:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:57:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id B2BE07141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:56:30 +0000 (GMT)
Message-ID: <22781378.1149015390729.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:56:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-76) Implement speculative re-execution of
 reduces
In-Reply-To: <1176204687.1142031469402.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-76?page=all ]

Sameer Paranjpye updated HADOOP-76:
-----------------------------------

        Summary: Implement speculative re-execution of reduces  (was: reduce output should first be written to a temporary file name, then moved into place)
    Fix Version: 0.4
                     (was: 0.3)
    Description: 
As a first step, reduce task outputs should go to temporary files which are renamed when the task completes.


  was:This would permit speculative execution of reduce tasks.


> Implement speculative re-execution of reduces
> ---------------------------------------------
>
>          Key: HADOOP-76
>          URL: http://issues.apache.org/jira/browse/HADOOP-76
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.4

>
> As a first step, reduce task outputs should go to temporary files which are renamed when the task completes.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:59:22 2006
Return-Path: 
 <hadoop-dev-return-1706-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46080 invoked from network); 30 May 2006 18:59:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:59:22 -0000
Received: (qmail 97768 invoked by uid 500); 30 May 2006 18:59:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97631 invoked by uid 500); 30 May 2006 18:59:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97622 invoked by uid 99); 30 May 2006 18:59:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:59:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:59:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 225957141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:58:31 +0000 (GMT)
Message-ID: <19346731.1149015511137.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:58:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-248) locating map outputs via random
 probing is inefficient
In-Reply-To: <7950094.1148426849904.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-248?page=all ]

Sameer Paranjpye updated HADOOP-248:
------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> locating map outputs via random probing is inefficient
> ------------------------------------------------------
>
>          Key: HADOOP-248
>          URL: http://issues.apache.org/jira/browse/HADOOP-248
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> Currently the ReduceTaskRunner polls the JobTracker for a random list of map tasks asking for their output locations. It would be better if the JobTracker kept an ordered log and the interface was changed to:
> class MapLocationResults {
>    public int getTimestamp();
>    public MapOutputLocation[] getLocations();
> }
> interface InterTrackerProtocol {
>   ...
>   MapLocationResults locateMapOutputs(int prevTimestamp);
> } 
> with the intention that each time a ReduceTaskRunner calls locateMapOutputs, it passes back the "timestamp" that it got from the previous result. That way, reduces can easily find the new MapOutputs. This should help the "ramp up" when the maps first start finishing.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 18:59:29 2006
Return-Path: 
 <hadoop-dev-return-1707-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46384 invoked from network); 30 May 2006 18:59:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 18:59:29 -0000
Received: (qmail 98432 invoked by uid 500); 30 May 2006 18:59:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98166 invoked by uid 500); 30 May 2006 18:59:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97967 invoked by uid 99); 30 May 2006 18:59:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:59:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 11:59:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E395571421B
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 18:58:32 +0000 (GMT)
Message-ID: <23188746.1149015512929.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 18:58:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-99) task trackers can only be assigned one
 task every heartbeat
In-Reply-To: <1017503414.1143102720520.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-99?page=all ]

Sameer Paranjpye updated HADOOP-99:
-----------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> task trackers can only be assigned one task every heartbeat
> -----------------------------------------------------------
>
>          Key: HADOOP-99
>          URL: http://issues.apache.org/jira/browse/HADOOP-99
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> Task trackers only call pollForNewTask once per a heartbeat (10 seconds) rather than when a task finishes. Especially for quick maps this means that the cluster is under utilized, because each map finishes in a cycle and the task tracker never gets a second, third or fourth task to run.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 19:03:26 2006
Return-Path: 
 <hadoop-dev-return-1708-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48832 invoked from network); 30 May 2006 19:03:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 19:03:26 -0000
Received: (qmail 6747 invoked by uid 500); 30 May 2006 19:03:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 6719 invoked by uid 500); 30 May 2006 19:03:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 6710 invoked by uid 99); 30 May 2006 19:03:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:03:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:03:25 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CF6C17141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 19:02:29 +0000 (GMT)
Message-ID: <2702206.1149015749846.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 19:02:29 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-262) the reduce tasks do not report
 progress if they the map output locations is empty.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

the reduce tasks do not report progress if they the map output locations is empty.
----------------------------------------------------------------------------------

         Key: HADOOP-262
         URL: http://issues.apache.org/jira/browse/HADOOP-262
     Project: Hadoop
        Type: Bug

  Components: mapred  
    Reporter: Mahadev konar
 Assigned to: Mahadev konar 


The ReduceTaskRunner should report progress even if the number of ouput locations to copy is empty. In case, the last few maps are running on a tasktracker that goes down, all the reduce tasks waiting for these mapoutputs would fail.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 19:05:22 2006
Return-Path: 
 <hadoop-dev-return-1709-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49595 invoked from network); 30 May 2006 19:05:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 19:05:22 -0000
Received: (qmail 8567 invoked by uid 500); 30 May 2006 19:05:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8434 invoked by uid 500); 30 May 2006 19:05:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8424 invoked by uid 99); 30 May 2006 19:05:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:05:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:05:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A345C7141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 19:04:30 +0000 (GMT)
Message-ID: <18011365.1149015870665.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 19:04:30 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-262) the reduce tasks do not report
 progress if they the map output locations is empty.
In-Reply-To: <2702206.1149015749846.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-262?page=all ]

Mahadev konar updated HADOOP-262:
---------------------------------

    Attachment: reduce_sleep.patch

here is a patch that reports progress while its sleeping and waiting for more map outputs.

> the reduce tasks do not report progress if they the map output locations is empty.
> ----------------------------------------------------------------------------------
>
>          Key: HADOOP-262
>          URL: http://issues.apache.org/jira/browse/HADOOP-262
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>  Attachments: reduce_sleep.patch
>
> The ReduceTaskRunner should report progress even if the number of ouput locations to copy is empty. In case, the last few maps are running on a tasktracker that goes down, all the reduce tasks waiting for these mapoutputs would fail.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 19:07:22 2006
Return-Path: 
 <hadoop-dev-return-1710-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50647 invoked from network); 30 May 2006 19:07:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 19:07:22 -0000
Received: (qmail 10785 invoked by uid 500); 30 May 2006 19:07:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10762 invoked by uid 500); 30 May 2006 19:07:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10753 invoked by uid 99); 30 May 2006 19:07:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:07:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:07:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9BEBF7141F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 19:06:30 +0000 (GMT)
Message-ID: <15170090.1149015990635.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 19:06:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-159) name node at 100% cpu, making
 redundant replications
In-Reply-To: <929695.1145660285762.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-159?page=all ]
     
Sameer Paranjpye resolved HADOOP-159:
-------------------------------------

    Fix Version: 0.2
                     (was: 0.3)
     Resolution: Duplicate

Looks like HADOOP-178 addresses this. Let's monitor and re-open if it manifests again.

> name node at 100% cpu, making redundant replications
> ----------------------------------------------------
>
>          Key: HADOOP-159
>          URL: http://issues.apache.org/jira/browse/HADOOP-159
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.1
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>     Priority: Blocker
>      Fix For: 0.2

>
> some hours after adding some new nodes to the cluster, the name node went into a state where it's consuming 100% cpu.
> The log file keeps logging messages of the forms
> 060421 155049 Obsoleting block blk_8093115169359854355
> 060421 155049 Pending transfer (block blk_-6965677235456960523) from node1383:50010 to 2 destinations
> 060421 155049 Block report from node1283:50010: 2140 blocks.
> 060421 155049 Redundant addStoredBlock request received for block blk_-6836937139917042917 on node node1143:50010
> many DFS operations time out, making useful work impossible.
> restarting dfs solved the problem for a while, but it came back within an hour.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 19:07:23 2006
Return-Path: 
 <hadoop-dev-return-1711-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50689 invoked from network); 30 May 2006 19:07:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 19:07:23 -0000
Received: (qmail 11059 invoked by uid 500); 30 May 2006 19:07:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10923 invoked by uid 500); 30 May 2006 19:07:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10907 invoked by uid 99); 30 May 2006 19:07:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:07:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:07:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CAF6714204
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 19:06:32 +0000 (GMT)
Message-ID: <747933.1149015992573.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 19:06:32 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12413882 ] 

Doug Cutting commented on HADOOP-124:
-------------------------------------

This patch does not apply to the current trunk.  Can you please update your sources to the current trunk, resolving any conflicts, and re-generate the patch?  Thanks!

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, Hadoop-124.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 19:11:23 2006
Return-Path: 
 <hadoop-dev-return-1712-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52315 invoked from network); 30 May 2006 19:11:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 19:11:23 -0000
Received: (qmail 22852 invoked by uid 500); 30 May 2006 19:11:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22823 invoked by uid 500); 30 May 2006 19:11:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22809 invoked by uid 99); 30 May 2006 19:11:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:11:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:11:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 10744714204
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 19:10:31 +0000 (GMT)
Message-ID: <1325031.1149016231064.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 19:10:31 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12413885 ] 

alan wootton commented on HADOOP-90:
------------------------------------

What we plan is to securely backup the 'snapshot' (the image file) after the NameNode is started. So that takes care of that part.  Now it's all about saving the edit log in a safe way. I don't like the idea of the backup being even one minute old.

The failure mode is the loss of a hard drive on the NameNode server. Simply writing, ALL the time, the edit log to more than one path, and therefore to more than one drive, goes a long way towards making the data secure. If the node dies you would still have to retreive one of the edit files from one of the drives, but at least one of the drives should still work (there are 3 on our namenode). Someone needs to pull the drives and mount them on another machine before recovery can happen, but hey, it's going to be a rare event.

If you are using Solaris, as we are, then sun nfs is available (or so they tell me). We mount an nfs drive, and write the edit log to that drive also. In this case recovery can happen by copying the image, and the edits, from nfs to another node, changing DNS for the name of the namenode, and starting a new namenode. 

I feel, at least for us, that this IS a real solution, and not just a band-aid. 

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>  Attachments: multipleEditsDest.patch
>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 19:31:27 2006
Return-Path: 
 <hadoop-dev-return-1713-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65774 invoked from network); 30 May 2006 19:31:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 19:31:27 -0000
Received: (qmail 51725 invoked by uid 500); 30 May 2006 19:31:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51668 invoked by uid 500); 30 May 2006 19:31:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51527 invoked by uid 99); 30 May 2006 19:31:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:31:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 12:31:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 09CAA7142F7
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 19:30:31 +0000 (GMT)
Message-ID: <24907796.1149017431037.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 19:30:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12413887 ] 

Doug Cutting commented on HADOOP-90:
------------------------------------

Alan,  I didn't mean to argue that cron+rsync was an ideal solution.  Yes, streaming the edits to multiple locations is the plan.  I personally don't think we should rely on NFS, but rather we should develop our own network protocol and service by which edits are sync'd, but I might be convinced otherwise.

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>  Attachments: multipleEditsDest.patch
>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 20:05:22 2006
Return-Path: 
 <hadoop-dev-return-1714-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77334 invoked from network); 30 May 2006 20:05:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 20:05:22 -0000
Received: (qmail 5856 invoked by uid 500); 30 May 2006 20:05:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5835 invoked by uid 500); 30 May 2006 20:05:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5826 invoked by uid 99); 30 May 2006 20:05:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:05:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:05:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8A5B77142F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 20:04:30 +0000 (GMT)
Message-ID: <4694197.1149019470563.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 20:04:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-158) dfs should allocate a random blockid
 range to a file, then assign ids sequentially to blocks in the file
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-158?page=all ]

Sameer Paranjpye updated HADOOP-158:
------------------------------------

        Summary: dfs should allocate a random blockid range to a file, then assign ids sequentially to blocks in the file  (was: dfs block ids sometimes collide)
    Fix Version: 0.4
                     (was: 0.3)
        Version: 0.1.0

Block id collisions have largely beed addressed by the fix in HADOOP-146. The namenode first checks for the presence of a randomly generated blockid before assigning it to a block.

Longer term, we should implement a scheme where the namenode allocates large blockid ranges to files. When a file is created the namenode generates a 5-byte integer, a range-id, for the file, checking for collisions and re-generating the range-id if necessary. Blocks for the new file are then assigned 8-byte block ids sequentially, where the high 5-bytes are the range-id and the low 3-bytes correspond to the block number within the file. Blocks in a file then get the ids rangeid-0, rangeid-1, ..., rangeid-(N-1), where N is the number of blocks in the file. This lets us assign upto a trillion ranges and lets each file grow to 0.5, 1, 2 ... petabytes depending on whether the block size is 32, 64, 128 ... MB. The scheme has the additional benefit of saving some memory per block at the namenode.

There is the scenario of a file being deleted while a node holding some of its blocks is down, having the files range-id re-assigned to another file and seeing collisions when the node later comes back. To get around this, the namenode tags each block in a file with the creation time of the file. When a collision occurs the timestamps will be different, the most recent timestamp wins and old blocks are discarded.



> dfs should allocate a random blockid range to a file, then assign ids sequentially to blocks in the file
> --------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:42:42 2006
Return-Path: 
 <hadoop-dev-return-1730-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11748 invoked from network); 30 May 2006 21:42:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:42:42 -0000
Received: (qmail 51288 invoked by uid 500); 30 May 2006 21:42:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51152 invoked by uid 500); 30 May 2006 21:42:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51143 invoked by uid 99); 30 May 2006 21:42:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:42:41 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [80.64.182.137] (HELO mslinux.media-style.com) (80.64.182.137)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:42:40 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 6BFC514462D
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:20:23 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 12838-01 for <hadoop-dev@lucene.apache.org>;
	Tue, 30 May 2006 23:20:23 +0200 (CEST)
Received: from [192.168.0.162] (unknown [212.122.41.253])
	by mslinux.media-style.com (Postfix) with ESMTP id 21627144629
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:20:23 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <8a8b9f3f0605152154q2f219948ieb997284b69e6854@mail.gmail.com>
References: <8a8b9f3f0605152154q2f219948ieb997284b69e6854@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <F3F3EA58-6A5C-4D97-9133-A3232E24C2DC@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: HBase Design Ideas, Part II
Date: Tue, 30 May 2006 22:33:11 +0200
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Michael,

> However, BigTable still leaves some things on the table.  Items to
> improve include a query language and multi-row locking, among
> other things.

In my project we do not need to have multi row locking at all. I need  
to write and read as fast as possible into many rows - column pairs  
but each of them is atomically.
I'm little bit worry that the goals are to big for now and having  
such difficult to implement functionality will slow down a general  
hadoop kind of big table implementation.
I really would love to start small and grow may be later with each  
release.

> Also, how useful do you think a general-purpose query language
> would be for HBase?  It would be fairly straightforward to implement,
> for example, a poor man's version of SQL that has different locking
> and update behavior (and which chucks out the more exotic elements).
> This might be compiled into a piece of code that is executed
> immediately, or it might be transformed into a long-lasting mapreduce
> job.

I personal don't like query languages at all - especially sql. :-)
They are only really usefully if you work on a admin gui tool and  
want to check your data, from my point of view.
Since some years I really prefer api based query mechanisms as   
hibernate or db4o provide.
For example query by example is just easy to use and can be powerful.

A query is any time a string in your code you need to maintain  
queries separately. You need to scan and update your code as soon  
your change just one column name etc.
But having a API based Query mechanism allows to develop faster from  
my experience. Keywords in my mind are  test driven development,  
refactoring, refactoring tools like eclipse etc.

Just my 2  cents. :-)
However I would love to see a big table.
Cheers,
Stefan


































From MAILER-DAEMON Tue May 30 20:34:22 2006
Return-Path: 
 <hadoop-dev-return-1715-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84760 invoked from network); 30 May 2006 20:34:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 20:34:22 -0000
Received: (qmail 50027 invoked by uid 500); 30 May 2006 20:34:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49896 invoked by uid 500); 30 May 2006 20:34:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49886 invoked by uid 99); 30 May 2006 20:34:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:34:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:34:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A72EA7142F7
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 20:33:30 +0000 (GMT)
Message-ID: <22994255.1149021210681.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 20:33:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-158) dfs should allocate a random blockid
 range to a file, then assign ids sequentially to blocks in the file
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-158?page=comments#action_12413893 ] 

Doug Cutting commented on HADOOP-158:
-------------------------------------

Why must the file-id part of the block id be random?  Can't that be sequential?

> dfs should allocate a random blockid range to a file, then assign ids sequentially to blocks in the file
> --------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:42:43 2006
Return-Path: 
 <hadoop-dev-return-1731-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11777 invoked from network); 30 May 2006 21:42:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:42:43 -0000
Received: (qmail 51436 invoked by uid 500); 30 May 2006 21:42:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51304 invoked by uid 500); 30 May 2006 21:42:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51295 invoked by uid 99); 30 May 2006 21:42:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:42:42 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [80.64.182.137] (HELO mslinux.media-style.com) (80.64.182.137)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:42:41 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 2841C14462E
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:20:25 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 12762-06 for <hadoop-dev@lucene.apache.org>;
	Tue, 30 May 2006 23:20:25 +0200 (CEST)
Received: from [192.168.0.162] (unknown [212.122.41.253])
	by mslinux.media-style.com (Postfix) with ESMTP id EE8E5144629
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:20:24 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v750)
Content-Transfer-Encoding: 7bit
Message-Id: <A059A39F-5DAB-49EC-8C9F-7A0C2FF24E35@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: HBase Design Ideas, terminology 
Date: Tue, 30 May 2006 22:42:57 +0200
X-Mailer: Apple Mail (2.750)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Michael,

what you think are the next steps?
I really would love to help in the implementation,
ideally we define interfaces or create lists of functionality and may  
be people can provide implementations for the different components.
Or is your idea to provide a first implementation and continue on a  
patch file kind of development?

What you think to create a wiki page were we at least list all  
components within a short description and list of functionalities.
We can start with your emails and discuss each component in detail  
here in the list.

Makes that sense?

BTW,
Yoram and me discussed that a kind of big table could be a  
interesting storage for data that are hold in memory in jobtracker  
and namenode and cause some scalability problems.
What you think?


Greetings,
Stefan



From MAILER-DAEMON Tue May 30 20:44:23 2006
Return-Path: 
 <hadoop-dev-return-1716-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87804 invoked from network); 30 May 2006 20:44:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 20:44:23 -0000
Received: (qmail 59948 invoked by uid 500); 30 May 2006 20:44:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59920 invoked by uid 500); 30 May 2006 20:44:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59911 invoked by uid 99); 30 May 2006 20:44:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:44:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:44:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id D09B97142F7
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 20:43:30 +0000 (GMT)
Message-ID: <4272263.1149021810851.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 20:43:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-47) include records/second and bytes/second
 in  task reports
In-Reply-To: <579254540.1140560374384.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-47?page=all ]

Sameer Paranjpye updated HADOOP-47:
-----------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> include records/second and bytes/second in  task reports
> --------------------------------------------------------
>
>          Key: HADOOP-47
>          URL: http://issues.apache.org/jira/browse/HADOOP-47
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> TaskReport should include fields for total records processed, total bytes processed and total seconds of task execution.  These should also be reported in the web ui, as bytes/second and records/second.  The job display could sum these to report total bytes/second and records/second for map and reduce.  Better yet would be a graph displaying the total rates over the course of the job...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 20:44:24 2006
Return-Path: 
 <hadoop-dev-return-1717-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87843 invoked from network); 30 May 2006 20:44:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 20:44:24 -0000
Received: (qmail 60213 invoked by uid 500); 30 May 2006 20:44:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60080 invoked by uid 500); 30 May 2006 20:44:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60068 invoked by uid 99); 30 May 2006 20:44:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:44:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:44:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CEBDD7142FA
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 20:43:32 +0000 (GMT)
Message-ID: <31724954.1149021812843.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 20:43:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-181) task trackers should not restart for
 having a late heartbeat
In-Reply-To: <701484.1146509206378.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-181?page=all ]

Sameer Paranjpye updated HADOOP-181:
------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> task trackers should not restart for having a late heartbeat
> ------------------------------------------------------------
>
>          Key: HADOOP-181
>          URL: http://issues.apache.org/jira/browse/HADOOP-181
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> TaskTrackers should not close and restart themselves for having a late heartbeat. The JobTracker should just accept their current status.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 20:46:22 2006
Return-Path: 
 <hadoop-dev-return-1718-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88372 invoked from network); 30 May 2006 20:46:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 20:46:22 -0000
Received: (qmail 62117 invoked by uid 500); 30 May 2006 20:46:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62098 invoked by uid 500); 30 May 2006 20:46:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62089 invoked by uid 99); 30 May 2006 20:46:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:46:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:46:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ACAD17142F7
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 20:45:30 +0000 (GMT)
Message-ID: <30794427.1149021930703.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 20:45:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-88) Configuration: separate client config
 from server config (and from other-server config)
In-Reply-To: <1512399529.1142558161467.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-88?page=all ]

Sameer Paranjpye updated HADOOP-88:
-----------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> Configuration: separate client config from server config (and from other-server config)
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-88
>          URL: http://issues.apache.org/jira/browse/HADOOP-88
>      Project: Hadoop
>         Type: Wish

>   Components: conf
>     Reporter: Michel Tourn
>     Priority: Minor
>      Fix For: 0.4

>
> servers = JobTracker, NameNode, TaskTracker, DataNode
> clients =  runs JobClient (to submit MapReduce jobs), or runs DFSShell (to browse )
> Server machines are administered together.
> So it is OK to have all server config together (esp file paths and network ports).
> This is stored in hadoop-default.xml or hadoop-mycluster.xml
> Client machines:
> there may be as many client machines as there are MapRed developers.
> the temp space for DFS needs to be writable by the active user.
> So it should be possible to select the client temp space directory for the machine and for the user.
> (The global /tmp is not an option as discussed elsewhere: partition may be full)
> Current situation: 
> Both the server and the clients have a copy of the server config: hadoop-default.xml
> But the XML property  "dfs.data.dir" is being used as a LOCAL directory path 
> on both the server machines (Data nodes) and the client machines.
> Effect:
> Exception in thread "main" java.io.IOException: No valid local directories in property: dfs.data.dir
>  at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:286)
>  at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.newBackupFile(DFSClient.java:560)
>  ...
>  at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:267)
> Current Workaround:
> On the client use hadoop-site.xml to override dfs.data.dir
> One proposed solution:
> For the purpose of JobClient operations, use a different property in place of dfs.data.dir.
> (Ex: dfs.client.data.dir) 
> On the client, set this property in hadoop-site.xml so that it will override hadoop-default.xml 
> Another proposed solution:
> Handle the fact that the world is made of a federation of independant Hadoop systems.
> They can talk to each other (as peers) but they are administered separately.
> Each Hadoop system should have its own separate XML config file.
> Clients should be able to specify the Hadoop system they want to talk to.
> An advantage is that clients can then easily sync their local copy of a given Hadoop system config:
>  just pull its config file
> In this view of the world, a Job client is also a kind of independant (serverless) Hadoop system
> In this case the client config file may have its own dfs.data.dir, which is 
> separate from the dfs.data.dir in the server config file.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 20:46:28 2006
Return-Path: 
 <hadoop-dev-return-1719-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88461 invoked from network); 30 May 2006 20:46:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 20:46:28 -0000
Received: (qmail 62357 invoked by uid 500); 30 May 2006 20:46:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 62326 invoked by uid 500); 30 May 2006 20:46:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 62317 invoked by uid 99); 30 May 2006 20:46:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:46:27 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:46:27 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2A53E7142FB
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 20:45:32 +0000 (GMT)
Message-ID: <24343950.1149021932169.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 20:45:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-135) Potential deadlock in JobTracker.
In-Reply-To: <69894223.1144974540263.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-135?page=all ]

Sameer Paranjpye updated HADOOP-135:
------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> Potential deadlock in JobTracker.
> ---------------------------------
>
>          Key: HADOOP-135
>          URL: http://issues.apache.org/jira/browse/HADOOP-135
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Konstantin Shvachko
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> org.apache.hadoop.mapred.JobTracker.RetireJobs.run()
> locks resources in this order
>                 synchronized (jobs) {
>                     synchronized (jobInitQueue) {
>                         synchronized (jobsByArrival) {
> org.apache.hadoop.mapred.JobTracker.submitJob()
> locks resources in a different order
>         synchronized (jobs) {
>             synchronized (jobsByArrival) {
>                 synchronized (jobInitQueue) {
> This potentially can lead to a deadlock.
> Unless there is common lock on top of it in which case these
> three locks are redundant.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 20:49:25 2006
Return-Path: 
 <hadoop-dev-return-1720-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89848 invoked from network); 30 May 2006 20:49:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 20:49:25 -0000
Received: (qmail 68348 invoked by uid 500); 30 May 2006 20:49:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68323 invoked by uid 500); 30 May 2006 20:49:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68314 invoked by uid 99); 30 May 2006 20:49:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:49:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:49:24 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 670377142F7
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 20:48:34 +0000 (GMT)
Message-ID: <22861423.1149022114418.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 20:48:34 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-130) Should be able to specify "wide" or
 "full" replication
In-Reply-To: <1115698231.1144702080037.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-130?page=all ]

Sameer Paranjpye reassigned HADOOP-130:
---------------------------------------

    Assign To: Konstantin Shvachko

> Should be able to specify "wide" or "full" replication
> ------------------------------------------------------
>
>          Key: HADOOP-130
>          URL: http://issues.apache.org/jira/browse/HADOOP-130
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>  Environment: N/A
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.3

>
> Should be able to specify that a file be "fully" or "widely" replicated, rather than an explicit replication count. This would be useful for job configuration and jar files, and probably other files whose use is wide enough to necessitate reducing latency to access them.
> The current implementation will also complain if you specify replication that is wider than the system's maximum replication value, and has no facility to enable "full" replication should the number of datanodes exceed the current maximum settable value of 32k.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 20:51:22 2006
Return-Path: 
 <hadoop-dev-return-1721-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90446 invoked from network); 30 May 2006 20:51:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 20:51:22 -0000
Received: (qmail 72757 invoked by uid 500); 30 May 2006 20:51:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72623 invoked by uid 500); 30 May 2006 20:51:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72613 invoked by uid 99); 30 May 2006 20:51:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:51:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 13:51:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0F3087142F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 20:50:31 +0000 (GMT)
Message-ID: <13262188.1149022231059.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 20:50:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-130) Should be able to specify "wide" or
 "full" replication
In-Reply-To: <1115698231.1144702080037.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-130?page=all ]

Sameer Paranjpye updated HADOOP-130:
------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> Should be able to specify "wide" or "full" replication
> ------------------------------------------------------
>
>          Key: HADOOP-130
>          URL: http://issues.apache.org/jira/browse/HADOOP-130
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>  Environment: N/A
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.4

>
> Should be able to specify that a file be "fully" or "widely" replicated, rather than an explicit replication count. This would be useful for job configuration and jar files, and probably other files whose use is wide enough to necessitate reducing latency to access them.
> The current implementation will also complain if you specify replication that is wider than the system's maximum replication value, and has no facility to enable "full" replication should the number of datanodes exceed the current maximum settable value of 32k.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:01:22 2006
Return-Path: 
 <hadoop-dev-return-1722-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94467 invoked from network); 30 May 2006 21:01:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:01:22 -0000
Received: (qmail 92230 invoked by uid 500); 30 May 2006 21:01:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92200 invoked by uid 500); 30 May 2006 21:01:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92190 invoked by uid 99); 30 May 2006 21:01:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:01:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:01:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CE2D37142F7
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:00:30 +0000 (GMT)
Message-ID: <17729456.1149022830841.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 21:00:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-217) IllegalAcessException when creating
 a Block object via WritableFactories
In-Reply-To: <1616267.1147481890143.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-217?page=comments#action_12413899 ] 

Sameer Paranjpye commented on HADOOP-217:
-----------------------------------------

This does not appear to hamper normal DFS operation in any way. Looks like the Block constructor is registered as a writable factory but is not public. Does it need to be? Should Block objects ever be constructed this way?

This needs further investigation, making the constructor public just addresses the symptom, not the problem IMO. Need to figure out what part of the code is trying to create blocks through a writable factory, and should it be doing that or something different?



> IllegalAcessException when creating a Block object via WritableFactories
> ------------------------------------------------------------------------
>
>          Key: HADOOP-217
>          URL: http://issues.apache.org/jira/browse/HADOOP-217
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.3
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>      Fix For: 0.4
>  Attachments: access.patch
>
> When I ran the dfs namenode, I received an error message listed below. Changing Block class to be public will be able to fix the problem.
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:226)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:163)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:211)
>         at org.apache.hadoop.ipc.RPC$Invocation.readFields(RPC.java:88)
>         at org.apache.hadoop.ipc.Server$Connection.run(Server.java:154)
> Caused by: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
>         at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:65)
>         at java.lang.Class.newInstance0(Class.java:344)
>         at java.lang.Class.newInstance(Class.java:303)
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:45)
>         ... 5 more

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:01:23 2006
Return-Path: 
 <hadoop-dev-return-1723-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94497 invoked from network); 30 May 2006 21:01:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:01:23 -0000
Received: (qmail 92486 invoked by uid 500); 30 May 2006 21:01:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92353 invoked by uid 500); 30 May 2006 21:01:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92344 invoked by uid 99); 30 May 2006 21:01:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:01:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:01:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id E99A17142F8
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:00:31 +0000 (GMT)
Message-ID: <33274542.1149022831952.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 21:00:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-217) IllegalAcessException when creating a
 Block object via WritableFactories
In-Reply-To: <1616267.1147481890143.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-217?page=all ]

Sameer Paranjpye updated HADOOP-217:
------------------------------------

    Fix Version: 0.4
                     (was: 0.3)

> IllegalAcessException when creating a Block object via WritableFactories
> ------------------------------------------------------------------------
>
>          Key: HADOOP-217
>          URL: http://issues.apache.org/jira/browse/HADOOP-217
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.3
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>      Fix For: 0.4
>  Attachments: access.patch
>
> When I ran the dfs namenode, I received an error message listed below. Changing Block class to be public will be able to fix the problem.
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:226)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:163)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:211)
>         at org.apache.hadoop.ipc.RPC$Invocation.readFields(RPC.java:88)
>         at org.apache.hadoop.ipc.Server$Connection.run(Server.java:154)
> Caused by: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
>         at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:65)
>         at java.lang.Class.newInstance0(Class.java:344)
>         at java.lang.Class.newInstance(Class.java:303)
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:45)
>         ... 5 more

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:04:22 2006
Return-Path: 
 <hadoop-dev-return-1724-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95405 invoked from network); 30 May 2006 21:04:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:04:22 -0000
Received: (qmail 97384 invoked by uid 500); 30 May 2006 21:04:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97356 invoked by uid 500); 30 May 2006 21:04:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97347 invoked by uid 99); 30 May 2006 21:04:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:04:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:04:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 641BE7142F8
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:03:31 +0000 (GMT)
Message-ID: <25622926.1149023011407.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 21:03:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-43) JobTracker dumps TaskTrackers if it
 takes too long to service an RPC call
In-Reply-To: <522645548.1140501144699.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-43?page=all ]

Sameer Paranjpye updated HADOOP-43:
-----------------------------------

         type: Improvement  (was: Bug)
      Version: 0.1.0
    Assign To: Owen O'Malley

> JobTracker dumps TaskTrackers if it takes too long to service an RPC call
> -------------------------------------------------------------------------
>
>          Key: HADOOP-43
>          URL: http://issues.apache.org/jira/browse/HADOOP-43
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Bryan Pendleton
>     Assignee: Owen O'Malley

>
> If the JobTracker takes too long to service any RPC request, it is unable to receive emitHeartBeat calls from TaskTrackers. The monitoring thread thus dumps the TaskTracker, losing any incomplete work and forcing a slow reconnect process to begin before it starts assigning work again.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:06:22 2006
Return-Path: 
 <hadoop-dev-return-1725-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96483 invoked from network); 30 May 2006 21:06:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:06:22 -0000
Received: (qmail 5146 invoked by uid 500); 30 May 2006 21:06:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5120 invoked by uid 500); 30 May 2006 21:06:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5111 invoked by uid 99); 30 May 2006 21:06:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:06:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:06:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 15D2B7142F8
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:05:31 +0000 (GMT)
Message-ID: <9615165.1149023131086.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 21:05:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-43) JobTracker dumps TaskTrackers if it
 takes too long to service an RPC call
In-Reply-To: <522645548.1140501144699.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-43?page=all ]
     
Sameer Paranjpye resolved HADOOP-43:
------------------------------------

    Resolution: Duplicate

Duplicate of HADOOP-181.

> JobTracker dumps TaskTrackers if it takes too long to service an RPC call
> -------------------------------------------------------------------------
>
>          Key: HADOOP-43
>          URL: http://issues.apache.org/jira/browse/HADOOP-43
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Bryan Pendleton
>     Assignee: Owen O'Malley

>
> If the JobTracker takes too long to service any RPC request, it is unable to receive emitHeartBeat calls from TaskTrackers. The monitoring thread thus dumps the TaskTracker, losing any incomplete work and forcing a slow reconnect process to begin before it starts assigning work again.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:12:22 2006
Return-Path: 
 <hadoop-dev-return-1726-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 98561 invoked from network); 30 May 2006 21:12:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:12:22 -0000
Received: (qmail 12046 invoked by uid 500); 30 May 2006 21:12:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12026 invoked by uid 500); 30 May 2006 21:12:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12017 invoked by uid 99); 30 May 2006 21:12:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:12:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:12:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 885047142F7
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:11:30 +0000 (GMT)
Message-ID: <8578658.1149023490555.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 21:11:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-217) IllegalAcessException when creating
 a Block object via WritableFactories
In-Reply-To: <1616267.1147481890143.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-217?page=comments#action_12413905 ] 

Doug Cutting commented on HADOOP-217:
-------------------------------------

I think this has been fixed, no?

The problem is that, when we modified Hadoop to use a classloader the writable factory stuff partially broke.  In particular, one can now obtain a reference to a Class instance when the static initializers of that class have not yet been run.  In particular, the RPC code calls something like 'WritableFactories.newInstance(ClassLoader.findClass("foo.bar.Baz")), and foo.bar.Baz's static initializer, which registers the writable factory, has not yet run, and the call to newInstance fails as above.  The work-around we've been using thus far is to, in the RPC client code, add a 'static { new Baz(); }' to force the static initializers of Baz to run.  Long-term we should find a better solution.

We'd like to be able to pass objects in RPCs that are not public classes.  This means that the RPC code needs to be able to construct an instance.  The WritableFactory mechanism was created to solve this, but, as described above, it mysteriously broke when we stopped using the bootstrap classloader.

> IllegalAcessException when creating a Block object via WritableFactories
> ------------------------------------------------------------------------
>
>          Key: HADOOP-217
>          URL: http://issues.apache.org/jira/browse/HADOOP-217
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.3
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>      Fix For: 0.4
>  Attachments: access.patch
>
> When I ran the dfs namenode, I received an error message listed below. Changing Block class to be public will be able to fix the problem.
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
> java.lang.RuntimeException: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:226)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:163)
>         at org.apache.hadoop.io.ObjectWritable.readObject(ObjectWritable.java:211)
>         at org.apache.hadoop.ipc.RPC$Invocation.readFields(RPC.java:88)
>         at org.apache.hadoop.ipc.Server$Connection.run(Server.java:154)
> Caused by: java.lang.IllegalAccessException: Class org.apache.hadoop.io.WritableFactories can not access a member of class org.apache.hadoop.dfs.Block with modifiers "public"
>         at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:65)
>         at java.lang.Class.newInstance0(Class.java:344)
>         at java.lang.Class.newInstance(Class.java:303)
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:45)
>         ... 5 more

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:27:25 2006
Return-Path: 
 <hadoop-dev-return-1727-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 5601 invoked from network); 30 May 2006 21:27:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:27:25 -0000
Received: (qmail 33774 invoked by uid 500); 30 May 2006 21:27:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33691 invoked by uid 500); 30 May 2006 21:27:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33471 invoked by uid 99); 30 May 2006 21:27:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:27:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:27:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 17B167142FA
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:26:32 +0000 (GMT)
Message-ID: <10593569.1149024392094.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 21:26:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-158) dfs should allocate a random blockid
 range to a file, then assign ids sequentially to blocks in the file
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-158?page=comments#action_12413909 ] 

Sameer Paranjpye commented on HADOOP-158:
-----------------------------------------

It can be sequential. In that case, the namenode would need to determine the lowest unused file-id at startup and start file-id assignments from that point. 

Even sequential allocation of file-ids should probably do the collision check because you don't need a trillion files in the system before you wrap around, you only need a trillion file creation events. If you're doing the collision check in both schemes the random file-id assignment keeps things simpler.

The possibility of collision with sequential assignment of file-ids is very remote, but why expose ourselves? I'm probably being paranoid so ignore me on this one if you want.





> dfs should allocate a random blockid range to a file, then assign ids sequentially to blocks in the file
> --------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:31:22 2006
Return-Path: 
 <hadoop-dev-return-1728-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7367 invoked from network); 30 May 2006 21:31:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:31:22 -0000
Received: (qmail 38048 invoked by uid 500); 30 May 2006 21:31:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38024 invoked by uid 500); 30 May 2006 21:31:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38015 invoked by uid 99); 30 May 2006 21:31:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:31:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:31:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8CAFA7142F8
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:30:30 +0000 (GMT)
Message-ID: <3392882.1149024630573.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 21:30:30 +0000 (GMT+00:00)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-158) dfs should allocate a random blockid
 range to a file, then assign ids sequentially to blocks in the file
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-158?page=comments#action_12413910 ] 

Yoram Arnon commented on HADOOP-158:
------------------------------------

It could, but that would make upgrading an existing file system harder: one would have to "compress" the id's before upgrading, then keep track of the high-water-mark file id. The upgrade wouldn't be as smooth as when selecting 'clean' ranges randomly, and would require metadata conversion. Blocks on individual datanodes may even need to change their ids.
OR, one could copy/move the entire filesystem to a new, clean one.
The selected method allows for a seamless upgrade, requiring no conversion, and would work equally well with a 2^64 id address space.

> dfs should allocate a random blockid range to a file, then assign ids sequentially to blocks in the file
> --------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:38:21 2006
Return-Path: 
 <hadoop-dev-return-1729-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8895 invoked from network); 30 May 2006 21:38:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:38:21 -0000
Received: (qmail 45248 invoked by uid 500); 30 May 2006 21:38:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 45222 invoked by uid 500); 30 May 2006 21:38:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 45213 invoked by uid 99); 30 May 2006 21:38:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:38:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:38:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8BF347142F8
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:37:30 +0000 (GMT)
Message-ID: <7461439.1149025050570.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 21:37:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-158) dfs should allocate a random blockid
 range to a file, then assign ids sequentially to blocks in the file
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-158?page=comments#action_12413911 ] 

Doug Cutting commented on HADOOP-158:
-------------------------------------

I would think that random allocation would make collisions more likely, not less.  We always know which block ids are used by complete files.  The concern is only about block ids which have been recently allocated to a file, but the file is somehow not yet complete.  So, with sequential allocation, a collision can only happen if the probe key (the next block id to allocate) wraps all the way around before a file is completed, while with random allocation it can happen much more frequently.  We simply have to make sure that probe key increments are logged to the edits file along with other file system changes.  Am I missing something?

> dfs should allocate a random blockid range to a file, then assign ids sequentially to blocks in the file
> --------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 21:45:00 2006
Return-Path: 
 <hadoop-dev-return-1732-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13361 invoked from network); 30 May 2006 21:45:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 21:45:00 -0000
Received: (qmail 59948 invoked by uid 500); 30 May 2006 21:44:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59880 invoked by uid 500); 30 May 2006 21:44:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59840 invoked by uid 99); 30 May 2006 21:44:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:44:58 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [80.64.182.137] (HELO mslinux.media-style.com) (80.64.182.137)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 14:44:56 -0700
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 39EEE14462D
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:22:39 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 12937-03 for <hadoop-dev@lucene.apache.org>;
	Tue, 30 May 2006 23:22:38 +0200 (CEST)
Received: from [192.168.0.162] (unknown [212.122.41.253])
	by mslinux.media-style.com (Postfix) with ESMTP id AA657144629
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:22:38 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v750)
In-Reply-To: <8a8b9f3f0605152122l47c34c51gcc16cc7dbe9138de@mail.gmail.com>
References: <8a8b9f3f0605141500n6575b73dgca3b7965ca71b22f@mail.gmail.com>
 <1C4AA81B-4C69-42B0-8B40-E1598CCB8E77@media-style.com>
 <8a8b9f3f0605152122l47c34c51gcc16cc7dbe9138de@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <F0736C9B-BC1D-4F23-90AF-7D8D397E0841@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: HBase Design Ideas, Part I
Date: Tue, 30 May 2006 23:44:31 +0200
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.750)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
sorry for the delay in responding...

>> I already posted a mail about this issue.
>> What we may be need is a Writer that can seek first for row key and
>> than for column keys.
>> In general I agree with  sparse structure.
>
>
> What about this: don't store explicit "column" fields anywhere.   
> Rather,
> each row is stored as a series of key-value pairs, where the key is  
> the
> column name.
I didn't got this.
How you want to associate than one key - value pair ( let's name it  
cell) to a row key?
As mentioned I see a object "rowKey - columnName - value" or one  
rowKey - columnKey-Value[]
>
> True, if there are a huge number of columns and you are interested in
> just one, there will be unnecessary processing.  This is especially  
> bad
> if one column is a 2-char string and another column is a video file.
>
> So we should actually keep a family of files, segmented by object  
> size.
> But in the general case, it shouldn't be possible to "seek to a  
> column".
> Instead, you seek to a row and unpack all its key/val (col/cell)  
> pairs.
Hmm, I'm not sure if I like the idea of having size based separated  
files of columns.
I don't think there are many use cases where people will store lets  
say locales and video files associated to the same url row key.
In such a case it makes more sense to have separated tables.
 From my point of view the best way would be to have a kind of column  
seek mechanism, what will require a other kind of sequence writer and  
reader.
As far I remember the google system has all columns of a row in one  
tablet.
What you think about to beeing able have one row in different tablets  
but each tablet has different rows?
So not just distribute the rows but also columns.

>
>
>> My idea was to have the lock on the HRegionServer level, my ideas was
>> that the client itself take care about replication,
>> means write the value to n servers that have the same replicatins of
>> HRegions.
>
>
> Do you mean that a lock applies to an entire server at once?  Or
> that an HRegionServer is responsible for all locks?  (I'd like to do
> the latter, at least in the short-term.)
Yes, the later is better from my point of view.
>
> I'd like to avoid having an HRegion that's hosted by multiple servers,
> because then it's unclear which HRegionServer should own the lock.
> I suppose the HRegionServers for a given HRegion could hold an
> election, but this seems like a lot of work.
>
> If there's a row that's really "hot" and wanted by a lot of  
> clients, I could
> imagine starting a series of "read-only" HRegionServers that field  
> read
> requests.  That way you avoid having an election for the lock but can
> still scale capacity if necessary.
That is a good idea.
>>
>> > The HBase system can repartition an HTable at any time.  For
>> > example, many
>> > repeated inserts at a single location may cause a single HRegion to
>> > grow
>> > very large.  The HBase would then try to split that into multiple
>> > HRegions.
>> > Those HRegions may be served by the same HRegionServer as the
>> > original or may be served by a different one.
>> Would the node send out a message to request a split or does the
>> master decide based on heart beat messages?
>
>
> There are two ways that an HRegionServer might offer brand-new
> service for an HRegion:
> 1) The HRegion's old HRegionServer died.  A new HRegionServer
> offers the exact same HRegion, loaded from a DFS file.  This will
> have to be initiated by the HBaseMaster, because it is the only  
> node that
> knows about heartbeats.
Make sense.
>
> 2) An HRegion is getting too big, and must be split into two.  I
> imagine that this can be initiated by the local HRegionServer,
> which then asks the master for various hints (like where there
> is another lightly-loaded HRegionServer that could take a new
> Region).
May be the local Region Server just request to be spitted and the  
master handle the split itself.
My concern is that just using heart beats to announce regions to the  
master is not fast enough.
Means when region is splitted all rows need to be read only during  
the process. The master need to know the two new regions before we  
remove the write lock.

>
> My idea was to simply download the data to the node and read any time
>> locally, but write into the dfs, since in my case write access can be
>> slower but I needer very fast read access.
>
>
> You mean just keep a local cache of the DFS file?  That might be
> a good idea for a feature we add into DFS as a performance  
> enhancement.

Yes, reading files from DFS is too slow,
we ran into the same performance problem to often in the several  
projects.

For example reading a lucene index file - as nutch does - from dfs is  
just useless. But loading a copy to the local hdd is fast enough  
during startup.
In general I don't think disk space is an issue these days, so I have  
no problem to have data replicated in the dfs and on a local hdd.



From MAILER-DAEMON Tue May 30 22:22:31 2006
Return-Path: 
 <hadoop-dev-return-1733-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41328 invoked from network); 30 May 2006 22:22:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 22:22:31 -0000
Received: (qmail 22162 invoked by uid 500); 30 May 2006 22:22:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22115 invoked by uid 500); 30 May 2006 22:22:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22096 invoked by uid 99); 30 May 2006 22:22:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:22:30 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:22:29 -0700
Received: from [207.126.231.161] (oom-mac.corp.yahoo.com [207.126.231.161])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k4UMKdRJ044824;
	Tue, 30 May 2006 15:20:39 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:content-transfer-encoding:message-id:
	content-type:to:from:subject:date:x-mailer;
	b=IVSEXc1J9yiq50UMqAcHjRGRpFQIC+VlQyKZIurh1i/9yfdoIBQEC75EeiaTXBZa
Mime-Version: 1.0 (Apple Message framework v624)
Content-Transfer-Encoding: 7bit
Message-Id: <6576b8459b29602803a33c6249ec1480@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
To: hadoop-dev@lucene.apache.org, nutch-dev@lucene.apache.org
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: java 1.4 versus 1.5
Date: Tue, 30 May 2006 15:21:00 -0700
X-Mailer: Apple Mail (2.624)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Java 1.5 has been out for a couple of years now and has some nice 
improvements in the libraries. In particular, I wish I had access to 
the timeout settings on UrlConnections. Would anyone object if starting 
with the 0.3 release this week, we required java 1.5 to compile and run 
Hadoop?

-- Owen


From MAILER-DAEMON Tue May 30 22:24:23 2006
Return-Path: 
 <hadoop-dev-return-1734-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42809 invoked from network); 30 May 2006 22:24:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 22:24:23 -0000
Received: (qmail 23606 invoked by uid 500); 30 May 2006 22:24:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23586 invoked by uid 500); 30 May 2006 22:24:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23577 invoked by uid 99); 30 May 2006 22:24:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:24:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:24:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id C8D6C7142F8
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 22:23:30 +0000 (GMT)
Message-ID: <30197415.1149027810818.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 22:23:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-158) dfs should allocate a random blockid
 range to a file, then assign ids sequentially to blocks in the file
In-Reply-To: <886043.1145639285840.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-158?page=comments#action_12413922 ] 

Sameer Paranjpye commented on HADOOP-158:
-----------------------------------------

Yes, random assignment of file-ids makes collisions more likely. However, collisions are possible even with sequential assignment, and if they are possible they need to be detected. Since, collision detection code is needed with both random and sequential assignment, random assignment makes the system simpler because the namenode doesn't have to track the 'high watermark' file-id.

Don't think recently assigned file-ids that belong to incomplete files are a concern, since the namenode will be aware of all file-ids used, whether they belong to incomplete files or not.

Wrap around before a file completes is not the only collision scenario. In the sequential assignment scheme, suppose, the first million files in the system get the file-ids, 0-999999. These files archival data of some kind, so are never deleted. Life goes on, lots of files are created and removed, at any given time there are only a few million files total (complete + incomplete) in the system. At some point, the system will have gone through a trillion file creation events, the file-ids will wrap and start to collide with the first million files.


> dfs should allocate a random blockid range to a file, then assign ids sequentially to blocks in the file
> --------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-158
>          URL: http://issues.apache.org/jira/browse/HADOOP-158
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.1.0
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> A random number generator is used to allocate block ids in dfs.  Sometimes a block id is allocated that is already used in the filesystem, which causes filesystem corruption.
> A short-term fix for this is to simply check when allocating block ids whether any file is already using the newly allocated id, and, if it is, generate another one.  There can still be collisions in some rare conditions, but these are harder to fix and will wait, since this simple fix will handle the vast majority of collisions.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 22:44:22 2006
Return-Path: 
 <hadoop-dev-return-1735-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51219 invoked from network); 30 May 2006 22:44:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 22:44:22 -0000
Received: (qmail 53660 invoked by uid 500); 30 May 2006 22:44:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53470 invoked by uid 500); 30 May 2006 22:44:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53460 invoked by uid 99); 30 May 2006 22:44:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:44:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:44:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 98C287142F1
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 22:43:30 +0000 (GMT)
Message-ID: <32872990.1149029010622.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 22:43:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-222) Set replication from dfsshell
In-Reply-To: <12449154.1147778285869.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-222?page=all ]
     
Doug Cutting resolved HADOOP-222:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

I just committed this.  Thanks, Johan!

> Set replication from dfsshell
> -----------------------------
>
>          Key: HADOOP-222
>          URL: http://issues.apache.org/jira/browse/HADOOP-222
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Johan Oskarson
>     Priority: Trivial
>      Fix For: 0.3
>  Attachments: setrep-v2.patch, setrep.patch
>
> Added ability to set replication for a directory/file from the command line.
> Not heavily tested...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 22:52:21 2006
Return-Path: 
 <hadoop-dev-return-1736-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54385 invoked from network); 30 May 2006 22:52:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 22:52:21 -0000
Received: (qmail 61883 invoked by uid 500); 30 May 2006 22:52:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61853 invoked by uid 500); 30 May 2006 22:52:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61844 invoked by uid 99); 30 May 2006 22:52:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:52:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:52:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 922EE7142F1
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 22:51:30 +0000 (GMT)
Message-ID: <14331603.1149029490595.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 22:51:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-260) the start up scripts should take a
 command line parameter --config making it easy to run multiple hadoop
 installation on same machines
In-Reply-To: <32103939.1149014550880.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-260?page=comments#action_12413930 ] 

Doug Cutting commented on HADOOP-260:
-------------------------------------

I like what this does, but not particularly the way it is done.  Having the same 20 lines repeated in 10 files seems fragile to me.  Can we somehow instead put this logic in a single file that's included in all of the scripts?

> the start up scripts should take a command line parameter --config making it easy to run multiple hadoop installation on same machines
> --------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-260
>          URL: http://issues.apache.org/jira/browse/HADOOP-260
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>  Attachments: config.patch
>
> --config paramter would allow getting rid of SSH_OPTS.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 22:57:22 2006
Return-Path: 
 <hadoop-dev-return-1737-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55179 invoked from network); 30 May 2006 22:57:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 22:57:22 -0000
Received: (qmail 69200 invoked by uid 500); 30 May 2006 22:57:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69084 invoked by uid 500); 30 May 2006 22:57:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69075 invoked by uid 99); 30 May 2006 22:57:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:57:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 15:57:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F25AE7142F7
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 22:56:30 +0000 (GMT)
Message-ID: <1012998.1149029790990.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 22:56:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-242) job fails because of "No valid local
 directories in property: " exception
In-Reply-To: <13734662.1148411729914.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-242?page=all ]
     
Doug Cutting resolved HADOOP-242:
---------------------------------

    Fix Version: 0.3
     Resolution: Fixed

I just committed this.  Thanks, Owen.

> job fails because of "No valid local directories in property: " exception
> -------------------------------------------------------------------------
>
>          Key: HADOOP-242
>          URL: http://issues.apache.org/jira/browse/HADOOP-242
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>      Fix For: 0.3
>  Attachments: no-local.patch
>
> when running a fairly large job, of 70+K map tasks, I get many exceptions as shown below, and eventually the job failes when a task fails four times.
> The exception doesn't really tell us enough information to debug this properly, so the first thing to do would be to add more information (path) to the exception.
> The path indicated in the config file exists, is writable and valid, though 'path' may be anything.
> the exception:
> java.io.IOException: No valid local directories in property: mapred.local.dir at org.apache.hadoop.conf.Configuration.getLocalPath(Configuration.java:293) at org.apache.hadoop.mapred.JobConf.getLocalPath(JobConf.java:153) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.localizeTask(TaskTracker.java:523) at org.apache.hadoop.mapred.TaskTracker$TaskInProgress.launchTask(TaskTracker.java:572) at org.apache.hadoop.mapred.TaskTracker.startNewTask(TaskTracker.java:389) at org.apache.hadoop.mapred.TaskTracker.offerService(TaskTracker.java:303) at org.apache.hadoop.mapred.TaskTracker.run(TaskTracker.java:418) at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:920)
> the code:
>   public Path getLocalPath(String dirsProp, String path)
>     throws IOException {
>     String[] dirs = getStrings(dirsProp);
>     int hashCode = path.hashCode();
>     FileSystem fs = FileSystem.getNamed("local", this);
>     for (int i = 0; i < dirs.length; i++) {  // try each local dir
>       int index = (hashCode+i & Integer.MAX_VALUE) % dirs.length;
>       Path file = new Path(dirs[index], path);
>       Path dir = file.getParent();
>       if (fs.exists(dir) || fs.mkdirs(dir)) {
>         return file;
>       }
>     }
>     throw new IOException("No valid local directories in property: "+dirsProp);
>   }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 23:03:22 2006
Return-Path: 
 <hadoop-dev-return-1738-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56976 invoked from network); 30 May 2006 23:03:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 23:03:22 -0000
Received: (qmail 76889 invoked by uid 500); 30 May 2006 23:03:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76867 invoked by uid 500); 30 May 2006 23:03:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76858 invoked by uid 99); 30 May 2006 23:03:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:03:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:03:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A0FF07142F1
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:02:30 +0000 (GMT)
Message-ID: <29443529.1149030150656.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 23:02:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-75) dfs should check full file
 availability only at close
In-Reply-To: <873621841.1142030138809.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-75?page=all ]
     
Doug Cutting resolved HADOOP-75:
--------------------------------

    Resolution: Fixed
     Assign To: Milind Bhandarkar  (was: Konstantin Shvachko)

I just committed this.  Thanks, Milind!

> dfs should check full file availability only at close
> -----------------------------------------------------
>
>          Key: HADOOP-75
>          URL: http://issues.apache.org/jira/browse/HADOOP-75
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: hadoop-75.patch
>
> Currently it appears that dfs checks that the namenode knows about all blocks in a file as each block is written.  It would be more efficient to only check that all blocks are stored somewhere when the file is closed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 23:09:22 2006
Return-Path: 
 <hadoop-dev-return-1739-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60584 invoked from network); 30 May 2006 23:09:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 23:09:22 -0000
Received: (qmail 90987 invoked by uid 500); 30 May 2006 23:09:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90850 invoked by uid 500); 30 May 2006 23:09:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90838 invoked by uid 99); 30 May 2006 23:09:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:09:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:09:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id AA3D77142F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:08:30 +0000 (GMT)
Message-ID: <6546612.1149030510694.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 23:08:30 +0000 (GMT+00:00)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-260) the start up scripts should take a
 command line parameter --config making it easy to run multiple hadoop
 installation on same machines
In-Reply-To: <32103939.1149014550880.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-260?page=comments#action_12413937 ] 

Mahadev konar commented on HADOOP-260:
--------------------------------------

you are right Doug. I will factor it out., so that it looks much cleaner. Thanks for the input.


> the start up scripts should take a command line parameter --config making it easy to run multiple hadoop installation on same machines
> --------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-260
>          URL: http://issues.apache.org/jira/browse/HADOOP-260
>      Project: Hadoop
>         Type: Improvement

>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>  Attachments: config.patch
>
> --config paramter would allow getting rid of SSH_OPTS.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 23:34:21 2006
Return-Path: 
 <hadoop-dev-return-1740-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69278 invoked from network); 30 May 2006 23:34:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 23:34:21 -0000
Received: (qmail 19475 invoked by uid 500); 30 May 2006 23:34:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19445 invoked by uid 500); 30 May 2006 23:34:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19436 invoked by uid 99); 30 May 2006 23:34:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:34:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:34:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8DAB27142F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:33:30 +0000 (GMT)
Message-ID: <33302217.1149032010577.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 23:33:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-123) mini map/reduce cluster for junit
 tests
In-Reply-To: <927904038.1144348524414.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-123?page=all ]

Sameer Paranjpye updated HADOOP-123:
------------------------------------

    Fix Version: 0.4
        Version: 0.3

> mini map/reduce cluster for junit tests
> ---------------------------------------
>
>          Key: HADOOP-123
>          URL: http://issues.apache.org/jira/browse/HADOOP-123
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> I would like a single process map-reduce pseduo-distributed cluster that can be used for unit tests. We should add a unit test with a word count map/reduce.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 23:36:22 2006
Return-Path: 
 <hadoop-dev-return-1741-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69932 invoked from network); 30 May 2006 23:36:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 23:36:22 -0000
Received: (qmail 21372 invoked by uid 500); 30 May 2006 23:36:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 21349 invoked by uid 500); 30 May 2006 23:36:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 21340 invoked by uid 99); 30 May 2006 23:36:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:36:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:36:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 86D5A7142F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:35:30 +0000 (GMT)
Message-ID: <5912146.1149032130549.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 23:35:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-156) Reducer  threw IOEOFException
In-Reply-To: <6737684.1145567465749.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-156?page=all ]

Sameer Paranjpye updated HADOOP-156:
------------------------------------

    Fix Version: 0.4
        Version: 0.3
    Description: 
A job was running with all the map tasks completed.
The reducers were appending the intermediate files into the large intermediate file.
java.io.EOFException was thrown when the record reader tried to read the version number
during initialization. Here is the stack trace:

java.io.EOFException 
    at java.io.DataInputStream.readFully(DataInputStream.java:178) 
    at java.io.DataInputStream.readFully(DataInputStream.java:152) 
    at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:251) 
    at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:236) 
    at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:226) 
    at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:205) 
    at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709) 

Appearantly, the intermediate file was empty. I suspect that one map task
generated empty intermidiate files for all the reducers, since all the reducers
failed at the same place, and failed at the same place during retries.

Unfortunately, we cannot know which map task generated the empty files,
since the exception does not offer any clue.

One simple enhancement is that the record reader should catch IOException and re-throw it with additional 
information, such as the file name.



  was:

A job was running with all the map tasks completed.
The reducers were appending the intermediate files into the large intermediate file.
java.io.EOFException was thrown when the record reader tried to read the version number
during initialization. Here is the stack trace:

java.io.EOFException 
    at java.io.DataInputStream.readFully(DataInputStream.java:178) 
    at java.io.DataInputStream.readFully(DataInputStream.java:152) 
    at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:251) 
    at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:236) 
    at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:226) 
    at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:205) 
    at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709) 

Appearantly, the intermediate file was empty. I suspect that one map task
generated empty intermidiate files for all the reducers, since all the reducers
failed at the same place, and failed at the same place during retries.

Unfortunately, we cannot know which map task generated the empty files,
since the exception does not offer any clue.

One simple enhancement is that the record reader should catch IOException and re-throw it with additional 
information, such as the file name.




> Reducer  threw IOEOFException
> -----------------------------
>
>          Key: HADOOP-156
>          URL: http://issues.apache.org/jira/browse/HADOOP-156
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.3
>     Reporter: Runping Qi
>      Fix For: 0.4

>
> A job was running with all the map tasks completed.
> The reducers were appending the intermediate files into the large intermediate file.
> java.io.EOFException was thrown when the record reader tried to read the version number
> during initialization. Here is the stack trace:
> java.io.EOFException 
>     at java.io.DataInputStream.readFully(DataInputStream.java:178) 
>     at java.io.DataInputStream.readFully(DataInputStream.java:152) 
>     at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:251) 
>     at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:236) 
>     at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:226) 
>     at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:205) 
>     at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709) 
> Appearantly, the intermediate file was empty. I suspect that one map task
> generated empty intermidiate files for all the reducers, since all the reducers
> failed at the same place, and failed at the same place during retries.
> Unfortunately, we cannot know which map task generated the empty files,
> since the exception does not offer any clue.
> One simple enhancement is that the record reader should catch IOException and re-throw it with additional 
> information, such as the file name.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 23:38:21 2006
Return-Path: 
 <hadoop-dev-return-1742-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71834 invoked from network); 30 May 2006 23:38:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 23:38:21 -0000
Received: (qmail 22888 invoked by uid 500); 30 May 2006 23:38:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22860 invoked by uid 500); 30 May 2006 23:38:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22851 invoked by uid 99); 30 May 2006 23:38:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:38:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:38:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8DEA87142F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:37:30 +0000 (GMT)
Message-ID: <23940363.1149032250578.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 23:37:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-236) job tracker should refuse connection
 from a task tracker with a different version number
In-Reply-To: <22977378.1148066309828.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-236?page=all ]

Sameer Paranjpye updated HADOOP-236:
------------------------------------

    Fix Version: 0.4

> job tracker should refuse connection from a task tracker with a different version number
> ----------------------------------------------------------------------------------------
>
>          Key: HADOOP-236
>          URL: http://issues.apache.org/jira/browse/HADOOP-236
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Hairong Kuang
>      Fix For: 0.4

>
> After one mapred system upgrade, we noticed that all tasks assigned to one task tracker failed. It turned out that for some reason the task tracker was not upgraded.
> To avoid this, a task tracker should reports its version # when it registers itsself with a job tracker. If the job tracker receives an inconsistent version #, it should refuse the connection.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 23:40:21 2006
Return-Path: 
 <hadoop-dev-return-1743-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72154 invoked from network); 30 May 2006 23:40:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 23:40:21 -0000
Received: (qmail 24647 invoked by uid 500); 30 May 2006 23:40:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24625 invoked by uid 500); 30 May 2006 23:40:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24612 invoked by uid 99); 30 May 2006 23:40:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:40:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:40:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8DAD87142F1
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:39:30 +0000 (GMT)
Message-ID: <30405925.1149032370577.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 23:39:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-250) HTTP Browsing interface for DFS
 Health/Status
In-Reply-To: <29976966.1148448150061.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-250?page=all ]

Sameer Paranjpye updated HADOOP-250:
------------------------------------

    Fix Version: 0.3

> HTTP Browsing interface for DFS Health/Status
> ---------------------------------------------
>
>          Key: HADOOP-250
>          URL: http://issues.apache.org/jira/browse/HADOOP-250
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Versions: 0.3
>     Reporter: Devaraj Das
>      Fix For: 0.3
>  Attachments: dfshealth.pdf, http_browsing_dfs.patch, http_browsing_dfs.patch
>
> A web interface to view the DFS health/status (name and data nodes) is to be created. User can connect to the webserver on the namenode and a web page will be displayed. The web page will give some details about that namenode (startup time and the total cluster capacity). The web page will contain a table of 'live' and 'dead' datanodes. Each live datanode will be a link to the complete details of the datanode as given by DatanodeInfo (also see DataNodeReport).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue May 30 23:42:22 2006
Return-Path: 
 <hadoop-dev-return-1744-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72341 invoked from network); 30 May 2006 23:42:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 May 2006 23:42:22 -0000
Received: (qmail 26128 invoked by uid 500); 30 May 2006 23:42:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26108 invoked by uid 500); 30 May 2006 23:42:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26099 invoked by uid 99); 30 May 2006 23:42:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:42:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 16:42:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 979AC7142F4
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 23:41:30 +0000 (GMT)
Message-ID: <6415602.1149032490618.JavaMail.jira@brutus>
Date: Tue, 30 May 2006 23:41:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-262) the reduce tasks do not report
 progress if they the map output locations is empty.
In-Reply-To: <2702206.1149015749846.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-262?page=all ]

Sameer Paranjpye updated HADOOP-262:
------------------------------------

    Fix Version: 0.3
        Version: 0.3

> the reduce tasks do not report progress if they the map output locations is empty.
> ----------------------------------------------------------------------------------
>
>          Key: HADOOP-262
>          URL: http://issues.apache.org/jira/browse/HADOOP-262
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.3
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>      Fix For: 0.3
>  Attachments: reduce_sleep.patch
>
> The ReduceTaskRunner should report progress even if the number of ouput locations to copy is empty. In case, the last few maps are running on a tasktracker that goes down, all the reduce tasks waiting for these mapoutputs would fail.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:16:22 2006
Return-Path: 
 <hadoop-dev-return-1745-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78331 invoked from network); 31 May 2006 00:16:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:16:22 -0000
Received: (qmail 51700 invoked by uid 500); 31 May 2006 00:16:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51667 invoked by uid 500); 31 May 2006 00:16:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51658 invoked by uid 99); 31 May 2006 00:16:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:16:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:16:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9F19D7142F4
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:15:30 +0000 (GMT)
Message-ID: <27692244.1149034530648.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:15:30 +0000 (GMT+00:00)
From: "alan wootton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-123) mini map/reduce cluster for junit
 tests
In-Reply-To: <927904038.1144348524414.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-123?page=comments#action_12413942 ] 

alan wootton commented on HADOOP-123:
-------------------------------------

I have code for this already. A couple of small changes are needed to make it work. Some config fixes, a fix to override the places where the code gets the hostname, etc.

> mini map/reduce cluster for junit tests
> ---------------------------------------
>
>          Key: HADOOP-123
>          URL: http://issues.apache.org/jira/browse/HADOOP-123
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> I would like a single process map-reduce pseduo-distributed cluster that can be used for unit tests. We should add a unit test with a word count map/reduce.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:18:22 2006
Return-Path: 
 <hadoop-dev-return-1746-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78468 invoked from network); 31 May 2006 00:18:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:18:22 -0000
Received: (qmail 52749 invoked by uid 500); 31 May 2006 00:18:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52723 invoked by uid 500); 31 May 2006 00:18:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52714 invoked by uid 99); 31 May 2006 00:18:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:18:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:18:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A0DF47142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:17:30 +0000 (GMT)
Message-ID: <22341304.1149034650656.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:17:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-63) problem with webapp when start a
 jobtracker
In-Reply-To: <1306920605.1141349984316.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-63?page=all ]
     
Sameer Paranjpye resolved HADOOP-63:
------------------------------------

    Fix Version: 0.2
     Resolution: Fixed

As stated, Hadoop startup scripts work around this issue.

> problem with webapp when start a jobtracker
> -------------------------------------------
>
>          Key: HADOOP-63
>          URL: http://issues.apache.org/jira/browse/HADOOP-63
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>  Environment: RHL4
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor
>      Fix For: 0.2

>
> there exist two issues with starting up webapp
> 1. webapp is not be able to be loaded from a jar file.
> 2. web.xml can not be parsed properly using java 1.4

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:20:22 2006
Return-Path: 
 <hadoop-dev-return-1747-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79698 invoked from network); 31 May 2006 00:20:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:20:22 -0000
Received: (qmail 54832 invoked by uid 500); 31 May 2006 00:20:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54809 invoked by uid 500); 31 May 2006 00:20:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54800 invoked by uid 99); 31 May 2006 00:20:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:20:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:20:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A406A7142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:19:30 +0000 (GMT)
Message-ID: <25142090.1149034770669.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:19:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-225) tasks are left over when a job fails
In-Reply-To: <14555788.1147888325909.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-225?page=all ]

Sameer Paranjpye updated HADOOP-225:
------------------------------------

    Fix Version: 0.4
        Version: 0.2

> tasks are left over when a job fails
> ------------------------------------
>
>          Key: HADOOP-225
>          URL: http://issues.apache.org/jira/browse/HADOOP-225
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Yoram Arnon
>     Priority: Minor
>      Fix For: 0.4

>
> when jobs are stopped or otherwise fail, tasks are often left around.
> the job tracker shows that there are map or reduce (mostly reduce) tasks running, when no job is running.
> these accumulate over time.
> eventually there are so many of those, that the job tracker can't launch new tasks, requiring a restart of the MR cluster.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:20:23 2006
Return-Path: 
 <hadoop-dev-return-1748-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79725 invoked from network); 31 May 2006 00:20:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:20:23 -0000
Received: (qmail 55097 invoked by uid 500); 31 May 2006 00:20:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54965 invoked by uid 500); 31 May 2006 00:20:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54956 invoked by uid 99); 31 May 2006 00:20:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:20:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:20:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 97B987142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:19:31 +0000 (GMT)
Message-ID: <28626153.1149034771619.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:19:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-244) very long cleanup after a job fails
In-Reply-To: <10706543.1148412329817.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-244?page=all ]

Sameer Paranjpye updated HADOOP-244:
------------------------------------

    Fix Version: 0.4
        Version: 0.2

> very long cleanup after a job fails
> -----------------------------------
>
>          Key: HADOOP-244
>          URL: http://issues.apache.org/jira/browse/HADOOP-244
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>      Fix For: 0.4

>
> Eight hours after a job failed (it executed for about 14 hours prior to failing), many task trackers keep throwing the exceptions below:
> 060523 121732 Server handler 0 on 50040 caught: java.io.FileNotFoundException: LocalFS
> java.io.FileNotFoundException: LocalFS
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
> 060523 121814 task_0006_r_000123_0 copy failed: task_0006_m_046105_0 from node5:50040
> java.net.SocketTimeoutException: timed out waiting for rpc response
>         at org.apache.hadoop.ipc.Client.call(Client.java:305)
>         at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:150)
>         at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
>         at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:112)
>         at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:67)
> 060523 121814 task_0006_r_000123_0 0.13023989% reduce > copy > task_0006_m_046105_0@node5:50040
> 060523 121814 task_0006_r_000123_0 Copying task_0006_m_048815_0 output from node6
> 060523 121817 SEVERE Can't open map output:/hadoop/mapred/local/task_0006_m_031921_0/part-152.out
> java.io.FileNotFoundException: LocalFS
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
> 060523 121817 Unknown child with bad map output: task_0006_m_031921_0. Ignored.
> 060523 121817 Server handler 1 on 50040 caught: java.io.FileNotFoundException: LocalFS
> java.io.FileNotFoundException: LocalFS
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
> 060523 121914 task_0006_r_000123_0 copy failed: task_0006_m_048815_0 from node6:50040
> java.net.SocketTimeoutException: timed out waiting for rpc response
>         at org.apache.hadoop.ipc.Client.call(Client.java:305)
>         at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:150)
>         at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
>         at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:112)
>         at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:67)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:22:22 2006
Return-Path: 
 <hadoop-dev-return-1749-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79989 invoked from network); 31 May 2006 00:22:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:22:22 -0000
Received: (qmail 55634 invoked by uid 500); 31 May 2006 00:22:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55607 invoked by uid 500); 31 May 2006 00:22:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55598 invoked by uid 99); 31 May 2006 00:22:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:22:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:22:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A84ED7142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:21:30 +0000 (GMT)
Message-ID: <25657093.1149034890686.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:21:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-244) very long cleanup after a job fails
In-Reply-To: <10706543.1148412329817.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-244?page=all ]
     
Sameer Paranjpye resolved HADOOP-244:
-------------------------------------

    Resolution: Duplicate

Duplicate of HADOOP-225

> very long cleanup after a job fails
> -----------------------------------
>
>          Key: HADOOP-244
>          URL: http://issues.apache.org/jira/browse/HADOOP-244
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>      Fix For: 0.4

>
> Eight hours after a job failed (it executed for about 14 hours prior to failing), many task trackers keep throwing the exceptions below:
> 060523 121732 Server handler 0 on 50040 caught: java.io.FileNotFoundException: LocalFS
> java.io.FileNotFoundException: LocalFS
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
> 060523 121814 task_0006_r_000123_0 copy failed: task_0006_m_046105_0 from node5:50040
> java.net.SocketTimeoutException: timed out waiting for rpc response
>         at org.apache.hadoop.ipc.Client.call(Client.java:305)
>         at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:150)
>         at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
>         at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:112)
>         at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:67)
> 060523 121814 task_0006_r_000123_0 0.13023989% reduce > copy > task_0006_m_046105_0@node5:50040
> 060523 121814 task_0006_r_000123_0 Copying task_0006_m_048815_0 output from node6
> 060523 121817 SEVERE Can't open map output:/hadoop/mapred/local/task_0006_m_031921_0/part-152.out
> java.io.FileNotFoundException: LocalFS
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
> 060523 121817 Unknown child with bad map output: task_0006_m_031921_0. Ignored.
> 060523 121817 Server handler 1 on 50040 caught: java.io.FileNotFoundException: LocalFS
> java.io.FileNotFoundException: LocalFS
>         at org.apache.hadoop.fs.LocalFileSystem.openRaw(LocalFileSystem.java:123)
>         at org.apache.hadoop.fs.FSDataInputStream$Checker.<init>(FSDataInputStream.java:46)
>         at org.apache.hadoop.fs.FSDataInputStream.<init>(FSDataInputStream.java:228)
>         at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:157)
>         at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:116)
>         at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:151)
>         at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:230)
> 060523 121914 task_0006_r_000123_0 copy failed: task_0006_m_048815_0 from node6:50040
> java.net.SocketTimeoutException: timed out waiting for rpc response
>         at org.apache.hadoop.ipc.Client.call(Client.java:305)
>         at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:150)
>         at org.apache.hadoop.mapred.$Proxy2.getFile(Unknown Source)
>         at org.apache.hadoop.mapred.ReduceTaskRunner.prepare(ReduceTaskRunner.java:112)
>         at org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:67)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:22:24 2006
Return-Path: 
 <hadoop-dev-return-1750-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80023 invoked from network); 31 May 2006 00:22:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:22:24 -0000
Received: (qmail 55913 invoked by uid 500); 31 May 2006 00:22:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 55766 invoked by uid 500); 31 May 2006 00:22:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 55757 invoked by uid 99); 31 May 2006 00:22:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:22:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:22:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 939737142F8
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:21:32 +0000 (GMT)
Message-ID: <17321934.1149034892602.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:21:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-245) record io translator doesn't strip
 path names
In-Reply-To: <13294037.1148416949918.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-245?page=all ]

Sameer Paranjpye updated HADOOP-245:
------------------------------------

    Fix Version: 0.3

> record io translator doesn't strip path names
> ---------------------------------------------
>
>          Key: HADOOP-245
>          URL: http://issues.apache.org/jira/browse/HADOOP-245
>      Project: Hadoop
>         Type: Bug

>   Components: record
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Milind Bhandarkar
>      Fix For: 0.3
>  Attachments: hadoop-245-246.patch
>
> When I run the record translator with a pathname, the path name is not stripped. So for example:
> % bin/rcc --language c++ foo/bar/bat.jr
> generates:
> foo/bar/bat.jr.hh (instead of ./bat.jr.hh)
> and the first line is #ifndef __FOO/BAR/BAT_JR_HH__
> the first was unexpected and the second is clearly wrong.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:24:23 2006
Return-Path: 
 <hadoop-dev-return-1751-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81386 invoked from network); 31 May 2006 00:24:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:24:23 -0000
Received: (qmail 57399 invoked by uid 500); 31 May 2006 00:24:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57303 invoked by uid 500); 31 May 2006 00:24:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57293 invoked by uid 99); 31 May 2006 00:24:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:24:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:24:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 173177142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:23:32 +0000 (GMT)
Message-ID: <30828445.1149035012092.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:23:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-246) the record-io generated c++ has wrong
 comments
In-Reply-To: <3975508.1148417189940.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-246?page=all ]

Sameer Paranjpye updated HADOOP-246:
------------------------------------

    Fix Version: 0.3

> the record-io generated c++ has wrong comments
> ----------------------------------------------
>
>          Key: HADOOP-246
>          URL: http://issues.apache.org/jira/browse/HADOOP-246
>      Project: Hadoop
>         Type: Bug

>   Components: record
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Milind Bhandarkar
>      Fix For: 0.3

>
> The comments on the namespaces on the closing come out backward:
> } // end namespace org
> } // end namespace apache
> } // end namespace hadoop
> } // end namespace record
> } // end namespace test

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:24:24 2006
Return-Path: 
 <hadoop-dev-return-1752-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81430 invoked from network); 31 May 2006 00:24:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:24:24 -0000
Received: (qmail 57492 invoked by uid 500); 31 May 2006 00:24:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57460 invoked by uid 500); 31 May 2006 00:24:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57451 invoked by uid 99); 31 May 2006 00:24:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:24:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:24:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7924B7142F9
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:23:33 +0000 (GMT)
Message-ID: <1578075.1149035013493.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:23:33 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-246) the record-io generated c++ has wrong
 comments
In-Reply-To: <3975508.1148417189940.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-246?page=all ]
     
Sameer Paranjpye resolved HADOOP-246:
-------------------------------------

    Resolution: Duplicate

Fix is part of patch in HADOOP-245

> the record-io generated c++ has wrong comments
> ----------------------------------------------
>
>          Key: HADOOP-246
>          URL: http://issues.apache.org/jira/browse/HADOOP-246
>      Project: Hadoop
>         Type: Bug

>   Components: record
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Milind Bhandarkar
>      Fix For: 0.3

>
> The comments on the namespaces on the closing come out backward:
> } // end namespace org
> } // end namespace apache
> } // end namespace hadoop
> } // end namespace record
> } // end namespace test

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:26:22 2006
Return-Path: 
 <hadoop-dev-return-1753-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81719 invoked from network); 31 May 2006 00:26:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:26:22 -0000
Received: (qmail 58844 invoked by uid 500); 31 May 2006 00:26:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58814 invoked by uid 500); 31 May 2006 00:26:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58805 invoked by uid 99); 31 May 2006 00:26:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:26:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:26:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id ACFCE7142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:25:30 +0000 (GMT)
Message-ID: <7514986.1149035130705.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:25:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-227) Namespace check pointing is not
 performed until the namenode restarts.
In-Reply-To: <17890828.1147909205885.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-227?page=all ]

Sameer Paranjpye updated HADOOP-227:
------------------------------------

    Fix Version: 0.4
        Version: 0.2

> Namespace check pointing is not performed until the namenode restarts.
> ----------------------------------------------------------------------
>
>          Key: HADOOP-227
>          URL: http://issues.apache.org/jira/browse/HADOOP-227
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>     Reporter: Konstantin Shvachko
>      Fix For: 0.4

>
> In current implementation when the name node starts, it reads its image file, then
> the edits file, and then saves the updated image back into the image file.
> The image file is never updated after that.
> In order to provide the system reliability reliability the namespace information should
> be check pointed periodically, and the edits file should be kept relatively small.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:26:23 2006
Return-Path: 
 <hadoop-dev-return-1754-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81745 invoked from network); 31 May 2006 00:26:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:26:23 -0000
Received: (qmail 59100 invoked by uid 500); 31 May 2006 00:26:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58966 invoked by uid 500); 31 May 2006 00:26:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58957 invoked by uid 99); 31 May 2006 00:26:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:26:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:26:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1E6597142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:25:32 +0000 (GMT)
Message-ID: <24222834.1149035132121.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:25:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-237) Standard set of Performance Metrics
 for Hadoop
In-Reply-To: <14919853.1148078609860.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-237?page=all ]

Sameer Paranjpye updated HADOOP-237:
------------------------------------

    Fix Version: 0.3

> Standard set of Performance Metrics for Hadoop
> ----------------------------------------------
>
>          Key: HADOOP-237
>          URL: http://issues.apache.org/jira/browse/HADOOP-237
>      Project: Hadoop
>         Type: Improvement

>   Components: metrics
>     Versions: 0.3
>  Environment: All
>     Reporter: Milind Bhandarkar
>     Assignee: Milind Bhandarkar
>      Fix For: 0.3

>
> I am starting to use Hadoop's shiny new Metrics API to publish performance (and other) Metrics of running jobs and other daemons.
> Which performance metrics are people interested in seeing ? If possible, please group them according to modules, such as map-reduce, dfs, general-cluster-related etc. I will follow this process:
> 1. collect this list
> 2. assess feasibility of obtaining metric
> 3. assign context/record/metrics names
> 4. seek approval for names
> 5. instrument the code.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:26:24 2006
Return-Path: 
 <hadoop-dev-return-1755-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81777 invoked from network); 31 May 2006 00:26:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:26:24 -0000
Received: (qmail 59235 invoked by uid 500); 31 May 2006 00:26:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59118 invoked by uid 500); 31 May 2006 00:26:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59109 invoked by uid 99); 31 May 2006 00:26:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:26:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:26:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 125077142FA
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:25:33 +0000 (GMT)
Message-ID: <6936102.1149035133072.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:25:33 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-256) Implement a C api for hadoop dfs
In-Reply-To: <6195280.1148675669863.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-256?page=all ]

Sameer Paranjpye updated HADOOP-256:
------------------------------------

    Fix Version: 0.3

> Implement a C api for hadoop dfs
> --------------------------------
>
>          Key: HADOOP-256
>          URL: http://issues.apache.org/jira/browse/HADOOP-256
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Reporter: Arun C Murthy
>      Fix For: 0.3
>  Attachments: libhdfs-new.patch.tgz, libhdfs.patch
>
> Implement a C api for hadoop dfs to ease talking to hadoop's dfs from native C/C++ applications.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:28:22 2006
Return-Path: 
 <hadoop-dev-return-1756-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82120 invoked from network); 31 May 2006 00:28:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:28:22 -0000
Received: (qmail 60268 invoked by uid 500); 31 May 2006 00:28:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60125 invoked by uid 500); 31 May 2006 00:28:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60116 invoked by uid 99); 31 May 2006 00:28:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:28:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:28:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A53717142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:27:30 +0000 (GMT)
Message-ID: <18862221.1149035250673.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:27:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-234) Support for writing Map/Reduce
 functions in C++
In-Reply-To: <6140265.1148030971246.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-234?page=all ]

Sameer Paranjpye updated HADOOP-234:
------------------------------------

    Fix Version: 0.4

> Support for writing Map/Reduce functions in C++
> -----------------------------------------------
>
>          Key: HADOOP-234
>          URL: http://issues.apache.org/jira/browse/HADOOP-234
>      Project: Hadoop
>         Type: New Feature

>   Components: mapred
>     Reporter: Sanjay Dahiya
>      Fix For: 0.4
>  Attachments: Hadoop MaReduce Developer doc.pdf, Hadoop MaReduce Developer doc.pdf
>
> MapReduce C++ support
> Requirements 
> 1. Allow users to write Map and Reduce functions in C++, rest of the 
> infrastructure already present in Java should be reused. 
> 2. Avoid users having to write both Java and C++ for this to work. 
> 3. Avoid users having to work with JNI methods directly by wrapping them in helper functions. 
> 4. Use Record IO for describing record format, both MR java framework and C++ should 
> 	use the same format to work seemlessly. 
> 5. Allow users to write simple map reduce tasks without learning record IO if keys and values are 
> 	simple strings. 
> Implementation notes
> - If keys and values are simple strings then user passes SimpleNativeMapper in JobConf and implements 
> 	mapper and reducer methods in C++. 
> - For composite Record IO types user starts with defining a record format using Record IO DDL. 
> - User generates Java and C++ classes from the DDL using record IO. 
> - Users configures JobConf to use the generated Java classes as the MR input/output, key/value classes. 
> - User writes Map and Reduce functions in C++ using a standard interface ( given below ) , this interface 
>   makes a serialized record IO format available to the C++ function which should be deserialized in corrosponding
>   generated C++ record IO classes. 
> - User uses the helper functions to pass the serialized format of generated output key/value pairs to output collector. 
> Following is a pseudocode for the Mapper ( Reducer can be implemented similarly ) - 
> Native(JNI) Java proxy for the Mapper : 
> ---------------------------------------
> Without Record IO :-
> --------------------
> public class SimpleNativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	  * Works on simple strings. 
> 	  **/
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		mapNative(key.toString().getBytes()
> 				, value.toString().getBytes(), output, reporter); 
> 	}
> 	
> 	/**
> 	  * Native implementation. 
> 	  **/
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> With Record IO :- 
> ------------------
> public class RecordIONativeMapper extends MapReduceBase implements Mapper {
> 	/**
> 	 * Implementation of map method, this acts as a JNI proxy for actual map 
> 	 * method implemented in C++. Works for Record IO based records. 
> 	 * @see map(byte[] , byte[],	OutputCollector, Reporter)
> 	 */
> 	public void map(WritableComparable key, Writable value,
> 			OutputCollector output, Reporter reporter) throws IOException {
> 		
> 		byte[] keyBytes = null ;
> 		byte[] valueBytes = null ;
> 		
> 		try{
> 			// we need to serialize the key and record and pass the serialized 
> 			// format to C++ / JNI methods so they can interpret it using appropriate 
> 			// record IO classes. 
> 			{
> 				ByteArrayOutputStream keyStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(keyStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				keyBytes = keyStream.toByteArray();
> 			}
> 			{
> 				ByteArrayOutputStream valueStream = new ByteArrayOutputStream() ; 
> 				BinaryOutputArchive boa = new BinaryOutputArchive(new DataOutputStream(valueStream)) ;
> 				
> 				((Record)key).serialize(boa, "WhatIsTag");
> 				valueBytes = valueStream.toByteArray();
> 			}
> 		}catch(ClassCastException e){
> 			// throw better exceptions
> 			throw new IOException("Input record must be of Record IO Type"); 
> 		}
> 		// pass the serialized byte[] to C++ implementation. 
> 		mapNative(keyBytes, valueBytes, output, reporter); 
> 	}
> 	/**
> 	 * Implementation in C++.
> 	 */
> 	private native void mapNative(byte[] key, byte[] value, 
> 			OutputCollector output, Reporter reporter) throws IOException;
> }
> OutputCollector Proxy for C++
> ------------------------------
> public class NativeOutputCollector implements OutputCollector {
> 	// standard method from interface
> 	public void collect(WritableComparable key, Writable value)
> 			throws IOException {
> 	}
> 	
> 	// deserializes key and value and calls collect(WritableComparable, Writable)
> 	public void collectFromNative(byte[]key, byte[]value){
> 		// deserialize key and value to java types ( as configured in JobConf )
> 		// call actual collect method 
> 	}
> }
> Core Native functions ( helper for user provided Mapper and Reducer ) 
> ---------------------------------------------------------------------
> #include "org_apache_hadoop_mapred_NativeMapper.h"
> #include "UserMapper.h"
> /**
> 	* A C++ proxy method, calls actual implementation of the Mapper. This method 
> 	signature is generated by javah.
> **/
> JNIEXPORT void JNICALL Java_org_apache_hadoop_mapred_NativeMapper_mapNative
>   (JNIEnv *env, jobject thisObj, jbyteArray key, jbyteArray value, 
>   	jobject output_collector, jobject reporter);
> {
>  
>  	// convert char* and pass on to user defined map method. 
>  	// user's map method should take care of converting it to correct record IO 
>  	// type.
>  	int keyLen = (*env)->GetArrayLength(env, key) ;
>  	int valueLen = (*env)->GetArrayLength(env, valueLen) ;
>  	const char *keyBuf = (*env)->GetByteArrayElements(env,key, keyLen, JNI_FALSE) ;
>  	const char *valueuf = (*env)->GetByteArrayElements(env,value, valueLen, JNI_FALSE) ;
>  	
>  	// Call User defined method 
>  	user_map(keyBuf, valueBuf, output_collector, reporter) ;
>  	
>  	(*env)->ReleaseByteArrayElements(env, key, keyBuf,  JNI_ABORT) ; 
>  	(*env)->ReleaseByteArrayElements(env, value, ValueBuf, JNI_ABORT) ; 
> }
> /**
> 	Helper method, acts as a proxy to OutputCollector in java. key and value 
> 	must be serialized forms of records as specified in JobConf. 
> **/
> void output_collector(const char * key, const char *value,
> 	jobject output_collector, jobject reporter){
> 	
> 	// invoke java NativeOutputCollector.collect with key and value. 
> }
> User defined Mapper ( and Reducer ) 
> ------------------------------------
> /**
> 	implements user defined map operation. 
> **/
> void user_mapper(const char *key, const char *value, jobject collector, jobject recorder) {
> 	//1. deserialize key/value in the appropriate format using record IO. 
> 	
> 	//2. process key/value and generate the intermediate key/values in record IO format. 
> 	
> 	//3. Deserialize intermediate key/values to intermed_key and intermed_value
> 	
> 	//4. pass intermed_key/intermed_value using helper function - 
> 	// 		output_collector(intermed_key, intermed_value, collector, recorder);
> 	
> 	
> }

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:28:23 2006
Return-Path: 
 <hadoop-dev-return-1757-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82159 invoked from network); 31 May 2006 00:28:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:28:23 -0000
Received: (qmail 60418 invoked by uid 500); 31 May 2006 00:28:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60287 invoked by uid 500); 31 May 2006 00:28:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60272 invoked by uid 99); 31 May 2006 00:28:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:28:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:28:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9B4D57142F8
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:27:31 +0000 (GMT)
Message-ID: <14695430.1149035251633.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:27:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-261) when map outputs are lost, nothing is
 shown in the webapp about why the map task failed
In-Reply-To: <18552838.1149014909866.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-261?page=all ]

Sameer Paranjpye updated HADOOP-261:
------------------------------------

    Fix Version: 0.4

> when map outputs are lost, nothing is shown in the webapp about why the map task failed
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-261
>          URL: http://issues.apache.org/jira/browse/HADOOP-261
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> When a task tracker invokes mapOutputLost, it does not include a diagnostic that lets the user (or the web app) know what failed in the map. I want to add a diagnostic message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:30:22 2006
Return-Path: 
 <hadoop-dev-return-1758-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82410 invoked from network); 31 May 2006 00:30:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:30:22 -0000
Received: (qmail 60961 invoked by uid 500); 31 May 2006 00:30:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60935 invoked by uid 500); 31 May 2006 00:30:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60926 invoked by uid 99); 31 May 2006 00:30:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:30:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:30:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A06997142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:29:30 +0000 (GMT)
Message-ID: <20108277.1149035370654.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:29:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-260) the start up scripts should take a
 command line parameter --config making it easy to run multiple hadoop
 installation on same machines
In-Reply-To: <32103939.1149014550880.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-260?page=all ]

Sameer Paranjpye updated HADOOP-260:
------------------------------------

    Fix Version: 0.3
        Version: 0.2

> the start up scripts should take a command line parameter --config making it easy to run multiple hadoop installation on same machines
> --------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-260
>          URL: http://issues.apache.org/jira/browse/HADOOP-260
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Mahadev konar
>     Assignee: Mahadev konar
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: config.patch
>
> --config paramter would allow getting rid of SSH_OPTS.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:30:23 2006
Return-Path: 
 <hadoop-dev-return-1759-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82449 invoked from network); 31 May 2006 00:30:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:30:23 -0000
Received: (qmail 61227 invoked by uid 500); 31 May 2006 00:30:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61094 invoked by uid 500); 31 May 2006 00:30:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61084 invoked by uid 99); 31 May 2006 00:30:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:30:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:30:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0F97F7142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:29:32 +0000 (GMT)
Message-ID: <9789436.1149035372061.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:29:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-155) Add a conf dir parameter to the
 scripts
In-Reply-To: <15786097.1145564465714.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-155?page=all ]

Sameer Paranjpye updated HADOOP-155:
------------------------------------

    Fix Version: 0.3
        Version: 0.2
      Assign To: Mahadev konar

> Add a conf dir parameter to the scripts
> ---------------------------------------
>
>          Key: HADOOP-155
>          URL: http://issues.apache.org/jira/browse/HADOOP-155
>      Project: Hadoop
>         Type: Improvement

>   Components: conf
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Mahadev konar
>      Fix For: 0.3

>
> We'd like a conf_dir parameter on the startup scripts (ie. "-c <confdif>"). In particular, it would be nice if it propagated down from hadoop-daemons.sh to slaves.sh to hadoop-daemon.sh using the command line rather than using the ssh -o SendEnv=HADOOP_CONF_DIR, which is not supported in many environments.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:32:22 2006
Return-Path: 
 <hadoop-dev-return-1760-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82648 invoked from network); 31 May 2006 00:32:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:32:22 -0000
Received: (qmail 63326 invoked by uid 500); 31 May 2006 00:32:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63304 invoked by uid 500); 31 May 2006 00:32:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63294 invoked by uid 99); 31 May 2006 00:32:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:32:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:32:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id A86297142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:31:30 +0000 (GMT)
Message-ID: <19103288.1149035490653.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:31:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-252) add versioning to RPC
In-Reply-To: <23799650.1148510309896.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-252?page=all ]

Sameer Paranjpye updated HADOOP-252:
------------------------------------

    Fix Version: 0.4
        Version: 0.3

> add versioning to RPC
> ---------------------
>
>          Key: HADOOP-252
>          URL: http://issues.apache.org/jira/browse/HADOOP-252
>      Project: Hadoop
>         Type: Improvement

>   Components: ipc
>     Versions: 0.3
>     Reporter: Yoram Arnon
>      Fix For: 0.4

>
> currently, any change to any rpc message breaks the protocol, with mysterious exceptions occurring at run time.
> a versioning sceme would have two benefits:
> - intelligent error messages, indicating that an upgrade is required
> - backwards compatibility could be supported.
> the proposal is to add a "const version" for each protocol, and a method: int getVersion(int version) that sends the client's version and receives the server's version. This would be the first method invoked on connection. Both sides then either agree on the lowest version number, providing backwards compatibility support, or abort the connection as "unsupported version".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:32:23 2006
Return-Path: 
 <hadoop-dev-return-1761-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82692 invoked from network); 31 May 2006 00:32:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:32:23 -0000
Received: (qmail 63595 invoked by uid 500); 31 May 2006 00:32:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63464 invoked by uid 500); 31 May 2006 00:32:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63455 invoked by uid 99); 31 May 2006 00:32:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:32:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:32:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 974857142F8
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:31:31 +0000 (GMT)
Message-ID: <709986.1149035491617.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:31:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-258) Cannot obtain block errors
In-Reply-To: <27132555.1148714249850.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-258?page=3Dall ]

Sameer Paranjpye updated HADOOP-258:
------------------------------------

    Fix Version: 0.4

> Cannot obtain block errors
> --------------------------
>
>          Key: HADOOP-258
>          URL: http://issues.apache.org/jira/browse/HADOOP-258
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Sameer Paranjpye
>      Fix For: 0.4

>
> I've been seeing a lot of errors from dfs for the last couple days. The e=
xception that I see is:
> java.io.IOException: Could not obtain block: blk_2867431916903738534 file=
=3D/user/oom/big-rand/part000271 offset=3D0 at org.apache.hadoop.dfs.DFSCli=
ent$DFSInputStream.blockSeekTo(DFSClient.java:532) at org.apache.hadoop.dfs=
.DFSClient$DFSInputStream.read(DFSClient.java:641) at org.apache.hadoop.fs.=
FSDataInputStream$Checker.read(FSDataInputStream.java:83) at org.apache.had=
oop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158) at =
java.io.BufferedInputStream.fill(BufferedInputStream.java:218) at java.io.B=
ufferedInputStream.read1(BufferedInputStream.java:256) at java.io.BufferedI=
nputStream.read(BufferedInputStream.java:313) at java.io.DataInputStream.re=
adFully(DataInputStream.java:176) at java.io.DataInputStream.readFully(Data=
InputStream.java:152) at org.apache.hadoop.io.SequenceFile$Reader.init(Sequ=
enceFile.java:264) at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFil=
e.java:248) at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:=
238) at org.apache.hadoop.mapred.SequenceFileRecordReader.(SequenceFileReco=
rdReader.java:36) at org.apache.hadoop.mapred.SequenceFileInputFormat.getRe=
cordReader(SequenceFileInputFormat.java:53) at org.apache.hadoop.mapred.Map=
Task.run(MapTask.java:105) at org.apache.hadoop.mapred.TaskTracker$Child.ma=
in(TaskTracker.java:866)
> I haven't had my fingers in that code recently, does it ring any bells fo=
r anyone?

--=20
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:34:22 2006
Return-Path: 
 <hadoop-dev-return-1762-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82908 invoked from network); 31 May 2006 00:34:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:34:22 -0000
Received: (qmail 64410 invoked by uid 500); 31 May 2006 00:34:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64387 invoked by uid 500); 31 May 2006 00:34:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64377 invoked by uid 99); 31 May 2006 00:34:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:34:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:34:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DD18C7142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:33:30 +0000 (GMT)
Message-ID: <5481584.1149035610901.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:33:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-231) DFSShell Improvement wish list
In-Reply-To: <19513987.1147981445911.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-231?page=all ]

Sameer Paranjpye updated HADOOP-231:
------------------------------------

    Fix Version: 0.4
        Version: 0.3

> DFSShell Improvement wish list
> ------------------------------
>
>          Key: HADOOP-231
>          URL: http://issues.apache.org/jira/browse/HADOOP-231
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred, dfs, util
>     Versions: 0.3
>     Reporter: Konstantin Shvachko
>      Fix For: 0.4

>
> This is to discuss general DFSShell improvements, standardization, conventions, etc.
> Here are links to assorted ideas on this issue from previous issues.
> We need to generalize them at some point.
> HADOOP-59
> HADOOP-226
> HADOOP-222#action_12412326
> HADOOP-230

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:34:23 2006
Return-Path: 
 <hadoop-dev-return-1763-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82936 invoked from network); 31 May 2006 00:34:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:34:23 -0000
Received: (qmail 64691 invoked by uid 500); 31 May 2006 00:34:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64555 invoked by uid 500); 31 May 2006 00:34:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64546 invoked by uid 99); 31 May 2006 00:34:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:34:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:34:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 5BC2D7142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:33:32 +0000 (GMT)
Message-ID: <12797088.1149035612373.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:33:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-213) add/change TestDFSIO command line
 arguments
In-Reply-To: <16272983.1147460768545.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-213?page=all ]

Sameer Paranjpye updated HADOOP-213:
------------------------------------

    Fix Version: 0.4
        Version: 0.3

> add/change TestDFSIO command line arguments
> -------------------------------------------
>
>          Key: HADOOP-213
>          URL: http://issues.apache.org/jira/browse/HADOOP-213
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.3
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.4

>
> TestDFSIO would benefit from the follwing changes on the command line:
> 1. allow a "-dfs <dfs>" option, to specify which dfs to test. Just like the hadoop dfs command.
> 2. allow a "-jt <job tracker>" option, to specify a job tracker. Just like the hadoop job command.
> 3. allign the file size units with the dfs block size. Using MB (2^20) when the dfs uses 10^6 skews the results a bit.
> 4. add a "-replication <replication>" option, to specify files' replication factor.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:34:24 2006
Return-Path: 
 <hadoop-dev-return-1764-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82971 invoked from network); 31 May 2006 00:34:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:34:24 -0000
Received: (qmail 64770 invoked by uid 500); 31 May 2006 00:34:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64708 invoked by uid 500); 31 May 2006 00:34:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64699 invoked by uid 99); 31 May 2006 00:34:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:34:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:34:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 4C94B7142F8
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:33:33 +0000 (GMT)
Message-ID: <2970849.1149035613311.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:33:33 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-226) DFSShell problems. Incorrect block
 replication detection in fsck.
In-Reply-To: <24430703.1147903865906.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-226?page=all ]

Sameer Paranjpye updated HADOOP-226:
------------------------------------

    Fix Version: 0.4
        Version: 0.2

> DFSShell problems. Incorrect block replication detection in fsck.
> -----------------------------------------------------------------
>
>          Key: HADOOP-226
>          URL: http://issues.apache.org/jira/browse/HADOOP-226
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: All
>     Reporter: Konstantin Shvachko
>      Fix For: 0.4

>
> 1. We need to adjust Dfsck to the new per-file replication feature.
> fsck checks block replication based on the configured global replication parameter.
> Which is now just the default. The actual file replication is returned in DFSFileInfo.
> So at least the reporting is screwed by that, although I didn't check what will happen with
> other options -move and -delete.
> 2. fsck throws NullPointerException if you type
> bin/hadoop fsck -files /doc
> instead of
> bin/hadoop fsck /doc -files
> 3. Unfortunately, there are several commands that throw different kinds of Exceptions
> rather than at least printing the usage info, when some of its arguments are missing or
> misplaced. ArrayIndexOutOfBoundsException is one them. Try
> bin/hadoop dfs -mv
> bin/hadoop dfs -cp
> bin/hadoop dfs -rm
> 4. In general the shell is growing and getting more sophisticated.
> Should we work out a general convention on how the parameters should be structured, named,
> short/long version of the keywords, help, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:36:22 2006
Return-Path: 
 <hadoop-dev-return-1765-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83980 invoked from network); 31 May 2006 00:36:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:36:22 -0000
Received: (qmail 67476 invoked by uid 500); 31 May 2006 00:36:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67343 invoked by uid 500); 31 May 2006 00:36:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67334 invoked by uid 99); 31 May 2006 00:36:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:36:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:36:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2E4677142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:35:31 +0000 (GMT)
Message-ID: <24113563.1149035731186.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:35:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-257) starting one data node thread to
 manage multiple data directories
In-Reply-To: <9587378.1148684849862.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-257?page=all ]

Sameer Paranjpye updated HADOOP-257:
------------------------------------

    Fix Version: 0.4
        Version: 0.2
      Assign To: Konstantin Shvachko

> starting one data node thread to manage multiple data directories
> -----------------------------------------------------------------
>
>          Key: HADOOP-257
>          URL: http://issues.apache.org/jira/browse/HADOOP-257
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Hairong Kuang
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> If a data node is configured with multiple data directories, current implementation of dfs will start multiple data node threads, each of which manages one data directory and talks to its name node independently. From the name node's point of view, it sees multiple data nodes instead of one.
> I feel that a more scalable solution should be to start one data node thread that manages multiple data diretories. But the one data node thread needs to take care of the block allocation problem.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:36:24 2006
Return-Path: 
 <hadoop-dev-return-1766-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84004 invoked from network); 31 May 2006 00:36:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:36:24 -0000
Received: (qmail 67627 invoked by uid 500); 31 May 2006 00:36:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67496 invoked by uid 500); 31 May 2006 00:36:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67487 invoked by uid 99); 31 May 2006 00:36:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:36:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:36:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 7B6D77142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:35:32 +0000 (GMT)
Message-ID: <19573820.1149035732503.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:35:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-257) starting one data node thread to
 manage multiple data directories
In-Reply-To: <9587378.1148684849862.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-257?page=all ]
     
Sameer Paranjpye resolved HADOOP-257:
-------------------------------------

    Resolution: Duplicate

Duplicate of HADOOP-64

> starting one data node thread to manage multiple data directories
> -----------------------------------------------------------------
>
>          Key: HADOOP-257
>          URL: http://issues.apache.org/jira/browse/HADOOP-257
>      Project: Hadoop
>         Type: Improvement

>   Components: dfs
>     Versions: 0.2
>     Reporter: Hairong Kuang
>     Assignee: Konstantin Shvachko
>      Fix For: 0.4

>
> If a data node is configured with multiple data directories, current implementation of dfs will start multiple data node threads, each of which manages one data directory and talks to its name node independently. From the name node's point of view, it sees multiple data nodes instead of one.
> I feel that a more scalable solution should be to start one data node thread that manages multiple data diretories. But the one data node thread needs to take care of the block allocation problem.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:38:22 2006
Return-Path: 
 <hadoop-dev-return-1767-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84577 invoked from network); 31 May 2006 00:38:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:38:22 -0000
Received: (qmail 70185 invoked by uid 500); 31 May 2006 00:38:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70151 invoked by uid 500); 31 May 2006 00:38:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70142 invoked by uid 99); 31 May 2006 00:38:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:38:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:38:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 078D67142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:37:31 +0000 (GMT)
Message-ID: <22750344.1149035851028.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:37:31 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-124) don't permit two datanodes to run from
 same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]

Konstantin Shvachko updated HADOOP-124:
---------------------------------------

    Attachment: Hadoop-124-v3.patch

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, Hadoop-124-v3.patch, Hadoop-124.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:40:24 2006
Return-Path: 
 <hadoop-dev-return-1768-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85291 invoked from network); 31 May 2006 00:40:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:40:24 -0000
Received: (qmail 72327 invoked by uid 500); 31 May 2006 00:40:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72187 invoked by uid 500); 31 May 2006 00:40:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72173 invoked by uid 99); 31 May 2006 00:40:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:40:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:40:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DB1307142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:39:30 +0000 (GMT)
Message-ID: <21921997.1149035970893.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:39:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-253) we need speculative execution for
 reduces
In-Reply-To: <6201480.1148537849882.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-253?page=all ]

Sameer Paranjpye updated HADOOP-253:
------------------------------------

    Fix Version: 0.4

> we need speculative execution for reduces
> -----------------------------------------
>
>          Key: HADOOP-253
>          URL: http://issues.apache.org/jira/browse/HADOOP-253
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> With my new http-based shuffle (on top of the svn head including sameer's parallel fetch), I just finished sorting 2010 g on 200 nodes in 8:49 with 9 reduce failures. However, the amusing part is that the replacement reduces were _not_ the slow ones. 8 of the original reduces were the only things running for the last hour. The job timings looked like:
> Job 0001
>   Total:
>     Tasks: 16551
>     Total: 10056104 secs
>     Average: 607 secs
>     Worst: task_0001_r_000291_0
>     Worst time: 31050 secs
>     Best: task_0001_m_013597_0
>     Best time: 20 secs
>   Maps:
>     Tasks: 16151
>     Total: 2762635 secs
>     Average: 171 secs
>     Worst: task_0001_m_002290_0
>     Worst time: 2663 secs
>     Best: task_0001_m_013597_0
>     Best time: 20 secs
>   Reduces:
>     Tasks: 400
>     Total: 7293469 secs
>     Average: 18233 secs
>     Worst: task_0001_r_000291_0
>     Worst time: 31050 secs
>     Best: task_0001_r_000263_1
>     Best time: 5591 secs
> And the number of tasks run per a node was very uneven:
> #tasks node
> 124 node1161
> 117 node1307
> 117 node1124
> 116 node1253
> 114 node1310
> 111 node1302
> 111 node1299
> 111 node1298
> 111 node1249
> 111 node1221
> 110 node1288
> 110 node1286
> 110 node1211
> 109 node1268
> 108 node1292
> 108 node1202
> 108 node1200
> 107 node1313
> 107 node1277
> 107 node1246
> 107 node1242
> 107 node1231
> 107 node1214
> 106 node1243
> 105 node1251
> 105 node1212
> 105 node1205
> 104 node1272
> 104 node1269
> 104 node1210
> 104 node1203
> 104 node1193
> 104 node1128
> 103 node1300
> 103 node1285
> 103 node1279
> 103 node1209
> 103 node1173
> 103 node1165
> 102 node1276
> 102 node1239
> 102 node1228
> 102 node1204
> 102 node1188
> 101 node1314
> 101 node1303
> 100 node1301
> 100 node1252
> 99 node1287
> 99 node1213
> 99 node1206
> 98 node1295
> 98 node1186
> 97 node1293
> 97 node1265
> 97 node1262
> 97 node1260
> 97 node1258
> 97 node1235
> 97 node1229
> 97 node1226
> 97 node1215
> 97 node1208
> 97 node1187
> 97 node1175
> 97 node1171
> 96 node1291
> 96 node1248
> 96 node1224
> 96 node1216
> 95 node1305
> 95 node1280
> 95 node1263
> 95 node1254
> 95 node1153
> 95 node1115
> 94 node1271
> 94 node1261
> 94 node1234
> 94 node1233
> 94 node1227
> 94 node1225
> 94 node1217
> 94 node1142
> 93 node1275
> 93 node1198
> 93 node1107
> 92 node1266
> 92 node1220
> 92 node1219
> 91 node1309
> 91 node1289
> 91 node1270
> 91 node1259
> 91 node1256
> 91 node1232
> 91 node1179
> 89 node1290
> 89 node1255
> 89 node1247
> 89 node1207
> 89 node1201
> 89 node1190
> 89 node1154
> 89 node1141
> 88 node1306
> 88 node1282
> 88 node1250
> 88 node1222
> 88 node1184
> 88 node1149
> 88 node1117
> 87 node1278
> 87 node1257
> 87 node1191
> 87 node1185
> 87 node1180
> 86 node1297
> 86 node1178
> 85 node1195
> 85 node1143
> 85 node1112
> 84 node1281
> 84 node1274
> 84 node1264
> 83 node1296
> 83 node1148
> 82 node1218
> 82 node1168
> 82 node1167
> 81 node1311
> 81 node1240
> 81 node1223
> 81 node1196
> 81 node1164
> 81 node1116
> 80 node1267
> 80 node1230
> 80 node1177
> 80 node1119
> 79 node1294
> 79 node1199
> 79 node1181
> 79 node1170
> 79 node1166
> 79 node1103
> 78 node1244
> 78 node1189
> 78 node1157
> 77 node1304
> 77 node1172
> 74 node1182
> 71 node1160
> 71 node1147
> 68 node1236
> 68 node1183
> 67 node1245
> 59 node1139
> 58 node1312
> 57 node1162
> 56 node1308
> 56 node1197
> 55 node1146
> 54 node1106
> 53 node1111
> 53 node1105
> 49 node1145
> 49 node1123
> 48 node1176
> 46 node1136
> 44 node1132
> 44 node1125
> 44 node1122
> 44 node1108
> 43 node1192
> 43 node1121
> 42 node1194
> 42 node1138
> 42 node1104
> 41 node1155
> 41 node1126
> 41 node1114
> 40 node1158
> 40 node1151
> 40 node1137
> 40 node1110
> 40 node1100
> 39 node1156
> 38 node1140
> 38 node1135
> 38 node1109
> 37 node1144
> 37 node1120
> 36 node1118
> 34 node1133
> 34 node1113
> 31 node1134
> 26 node1127
> 23 node1101
> 20 node1131
> And it should not surprise us that the last 8 reduces were running on nodes 1134, 1127,1101, and 1131. This really demonstrates the need to run speculative reduce runs. 
> I propose that when the list of reduce jobs running is down to 1/2 the cluster size that we start running speculative reduces. I estimate that it would have saved around an hour on this run. Does that sound like a reasonable heuristic?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:40:25 2006
Return-Path: 
 <hadoop-dev-return-1769-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85316 invoked from network); 31 May 2006 00:40:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:40:25 -0000
Received: (qmail 72376 invoked by uid 500); 31 May 2006 00:40:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72344 invoked by uid 500); 31 May 2006 00:40:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72321 invoked by uid 99); 31 May 2006 00:40:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:40:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:40:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CFFA07142FA
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:39:31 +0000 (GMT)
Message-ID: <21165371.1149035971848.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:39:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-253) we need speculative execution for
 reduces
In-Reply-To: <6201480.1148537849882.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-253?page=all ]
     
Sameer Paranjpye resolved HADOOP-253:
-------------------------------------

    Resolution: Duplicate

Duplicate of HADOOP-76

> we need speculative execution for reduces
> -----------------------------------------
>
>          Key: HADOOP-253
>          URL: http://issues.apache.org/jira/browse/HADOOP-253
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.4

>
> With my new http-based shuffle (on top of the svn head including sameer's parallel fetch), I just finished sorting 2010 g on 200 nodes in 8:49 with 9 reduce failures. However, the amusing part is that the replacement reduces were _not_ the slow ones. 8 of the original reduces were the only things running for the last hour. The job timings looked like:
> Job 0001
>   Total:
>     Tasks: 16551
>     Total: 10056104 secs
>     Average: 607 secs
>     Worst: task_0001_r_000291_0
>     Worst time: 31050 secs
>     Best: task_0001_m_013597_0
>     Best time: 20 secs
>   Maps:
>     Tasks: 16151
>     Total: 2762635 secs
>     Average: 171 secs
>     Worst: task_0001_m_002290_0
>     Worst time: 2663 secs
>     Best: task_0001_m_013597_0
>     Best time: 20 secs
>   Reduces:
>     Tasks: 400
>     Total: 7293469 secs
>     Average: 18233 secs
>     Worst: task_0001_r_000291_0
>     Worst time: 31050 secs
>     Best: task_0001_r_000263_1
>     Best time: 5591 secs
> And the number of tasks run per a node was very uneven:
> #tasks node
> 124 node1161
> 117 node1307
> 117 node1124
> 116 node1253
> 114 node1310
> 111 node1302
> 111 node1299
> 111 node1298
> 111 node1249
> 111 node1221
> 110 node1288
> 110 node1286
> 110 node1211
> 109 node1268
> 108 node1292
> 108 node1202
> 108 node1200
> 107 node1313
> 107 node1277
> 107 node1246
> 107 node1242
> 107 node1231
> 107 node1214
> 106 node1243
> 105 node1251
> 105 node1212
> 105 node1205
> 104 node1272
> 104 node1269
> 104 node1210
> 104 node1203
> 104 node1193
> 104 node1128
> 103 node1300
> 103 node1285
> 103 node1279
> 103 node1209
> 103 node1173
> 103 node1165
> 102 node1276
> 102 node1239
> 102 node1228
> 102 node1204
> 102 node1188
> 101 node1314
> 101 node1303
> 100 node1301
> 100 node1252
> 99 node1287
> 99 node1213
> 99 node1206
> 98 node1295
> 98 node1186
> 97 node1293
> 97 node1265
> 97 node1262
> 97 node1260
> 97 node1258
> 97 node1235
> 97 node1229
> 97 node1226
> 97 node1215
> 97 node1208
> 97 node1187
> 97 node1175
> 97 node1171
> 96 node1291
> 96 node1248
> 96 node1224
> 96 node1216
> 95 node1305
> 95 node1280
> 95 node1263
> 95 node1254
> 95 node1153
> 95 node1115
> 94 node1271
> 94 node1261
> 94 node1234
> 94 node1233
> 94 node1227
> 94 node1225
> 94 node1217
> 94 node1142
> 93 node1275
> 93 node1198
> 93 node1107
> 92 node1266
> 92 node1220
> 92 node1219
> 91 node1309
> 91 node1289
> 91 node1270
> 91 node1259
> 91 node1256
> 91 node1232
> 91 node1179
> 89 node1290
> 89 node1255
> 89 node1247
> 89 node1207
> 89 node1201
> 89 node1190
> 89 node1154
> 89 node1141
> 88 node1306
> 88 node1282
> 88 node1250
> 88 node1222
> 88 node1184
> 88 node1149
> 88 node1117
> 87 node1278
> 87 node1257
> 87 node1191
> 87 node1185
> 87 node1180
> 86 node1297
> 86 node1178
> 85 node1195
> 85 node1143
> 85 node1112
> 84 node1281
> 84 node1274
> 84 node1264
> 83 node1296
> 83 node1148
> 82 node1218
> 82 node1168
> 82 node1167
> 81 node1311
> 81 node1240
> 81 node1223
> 81 node1196
> 81 node1164
> 81 node1116
> 80 node1267
> 80 node1230
> 80 node1177
> 80 node1119
> 79 node1294
> 79 node1199
> 79 node1181
> 79 node1170
> 79 node1166
> 79 node1103
> 78 node1244
> 78 node1189
> 78 node1157
> 77 node1304
> 77 node1172
> 74 node1182
> 71 node1160
> 71 node1147
> 68 node1236
> 68 node1183
> 67 node1245
> 59 node1139
> 58 node1312
> 57 node1162
> 56 node1308
> 56 node1197
> 55 node1146
> 54 node1106
> 53 node1111
> 53 node1105
> 49 node1145
> 49 node1123
> 48 node1176
> 46 node1136
> 44 node1132
> 44 node1125
> 44 node1122
> 44 node1108
> 43 node1192
> 43 node1121
> 42 node1194
> 42 node1138
> 42 node1104
> 41 node1155
> 41 node1126
> 41 node1114
> 40 node1158
> 40 node1151
> 40 node1137
> 40 node1110
> 40 node1100
> 39 node1156
> 38 node1140
> 38 node1135
> 38 node1109
> 37 node1144
> 37 node1120
> 36 node1118
> 34 node1133
> 34 node1113
> 31 node1134
> 26 node1127
> 23 node1101
> 20 node1131
> And it should not surprise us that the last 8 reduces were running on nodes 1134, 1127,1101, and 1131. This really demonstrates the need to run speculative reduce runs. 
> I propose that when the list of reduce jobs running is down to 1/2 the cluster size that we start running speculative reduces. I estimate that it would have saved around an hour on this run. Does that sound like a reasonable heuristic?

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:40:25 2006
Return-Path: 
 <hadoop-dev-return-1770-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85351 invoked from network); 31 May 2006 00:40:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:40:25 -0000
Received: (qmail 72513 invoked by uid 500); 31 May 2006 00:40:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72453 invoked by uid 500); 31 May 2006 00:40:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72383 invoked by uid 99); 31 May 2006 00:40:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:40:24 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:40:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 32EC87142FB
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:39:33 +0000 (GMT)
Message-ID: <26589859.1149035973205.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:39:33 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-249) Improving Map -> Reduce performance
 and Task JVM reuse
In-Reply-To: <12945804.1148431829854.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-249?page=all ]

Sameer Paranjpye updated HADOOP-249:
------------------------------------

    Fix Version: 0.4

> Improving Map -> Reduce performance and Task JVM reuse
> ------------------------------------------------------
>
>          Key: HADOOP-249
>          URL: http://issues.apache.org/jira/browse/HADOOP-249
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.3
>     Reporter: Benjamin Reed
>      Fix For: 0.4
>  Attachments: disk_zoom.patch, image001.png, task_zoom.patch
>
> These patches are really just to make Hadoop start trotting. It is still at least an order of magnitude slower than it should be, but I think these patches are a good start.
> I've created two patches for clarity. They are not independent, but could easily be made so.
> The disk-zoom patch is a performance trifecta: less disk IO, less disk space, less CPU, and overall a tremendous improvement. The patch is based on the following observation: every piece of data from a map hits the disk once on the mapper, and 3 (+plus sorting) times on the reducer. Further, the entire input for the reduce step is sorted together maximizing the sort time. This patch causes:
> 1)  the mapper to sort the relatively small fragments at the mapper which causes two hits to the disk, but they are smaller files.
> 2) the reducer copies the map output and may merge (if more than 100 outputs are present) with a couple of other outputs at copy time. No sorting is done since the map outputs are sorted.
> 3) the reducer  will merge the map outputs on the fly in memory at reduce time.
> I'm attaching the performance graph (with just the disk-zoom patch) to show the results. This benchmark uses a random input and null output to remove any DFS performance influences. The cluster of 49 machines I was running on had limited disk space, so I was only able to run to a certain size on unmodified Hadoop. With the patch we use 1/3 the amount of disk space.
> The second patch allows the task tracker to reuse processes to avoid the over-head of starting the JVM. While JVM startup is relatively fast, restarting a Task causes disk IO and DFS operations that have a negative impact on the rest of the system. When a Task finishes, rather than exiting, it reads the next task to run from stdin. We still isolate the Task runtime from TaskTracker, but we only pay the startup penalty once.
> This second patch also fixes two performance issues not related to JVM reuse. (The reuse just makes the problems glaring.) First, the JobTracker counts all jobs not just the running jobs to decide the load on a tracker. Second, the TaskTracker should really ask for a new Task as soon as one finishes rather than wait the 10 secs.
> I've been benchmarking the code alot, but I don't have access to a really good cluster to try the code out on, so please treat it as experimental. I would love to feedback.
> There is another obvious thing to change: ReduceTasks should start after the first batch of MapTasks complete, so that 1) they have something to do, and 2) they are running on the fastest machines.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:42:22 2006
Return-Path: 
 <hadoop-dev-return-1771-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85656 invoked from network); 31 May 2006 00:42:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:42:22 -0000
Received: (qmail 73784 invoked by uid 500); 31 May 2006 00:42:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73733 invoked by uid 500); 31 May 2006 00:42:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73721 invoked by uid 99); 31 May 2006 00:42:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:42:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:42:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 087217142F8
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:41:31 +0000 (GMT)
Message-ID: <7630416.1149036091031.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:41:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-232) jar files sent to task tracker should
 override existing jar
In-Reply-To: <25736722.1147990685938.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-232?page=all ]

Sameer Paranjpye updated HADOOP-232:
------------------------------------

    Fix Version: 0.4
        Version: 0.2

> jar files sent to task tracker should override existing jar
> -----------------------------------------------------------
>
>          Key: HADOOP-232
>          URL: http://issues.apache.org/jira/browse/HADOOP-232
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Yoram Arnon
>     Assignee: Milind Bhandarkar
>     Priority: Minor
>      Fix For: 0.4
>  Attachments: hadoop-232.patch
>
> jar files sent to task tracker are appended to list, rather than prepended to it.
> this results in the original jar getting executed, although a new one was sent  - not the intent.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:44:21 2006
Return-Path: 
 <hadoop-dev-return-1772-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86554 invoked from network); 31 May 2006 00:44:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:44:21 -0000
Received: (qmail 77182 invoked by uid 500); 31 May 2006 00:44:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77151 invoked by uid 500); 31 May 2006 00:44:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77142 invoked by uid 99); 31 May 2006 00:44:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:44:20 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:44:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 2A0827142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:43:30 +0000 (GMT)
Message-ID: <28328682.1149036210153.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:43:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-136?page=all ]

Sameer Paranjpye updated HADOOP-136:
------------------------------------

    Fix Version: 0.4
        Version: 0.2

> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Versions: 0.2
>     Reporter: Dick King
>     Priority: Minor
>      Fix For: 0.4
>  Attachments: largeutf8.patch
>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:44:23 2006
Return-Path: 
 <hadoop-dev-return-1773-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86584 invoked from network); 31 May 2006 00:44:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:44:23 -0000
Received: (qmail 77438 invoked by uid 500); 31 May 2006 00:44:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77305 invoked by uid 500); 31 May 2006 00:44:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77296 invoked by uid 99); 31 May 2006 00:44:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:44:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:44:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 853387142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:43:31 +0000 (GMT)
Message-ID: <18536370.1149036211542.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:43:31 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-136) Overlong UTF8's not handled well
In-Reply-To: <64235546.1145045520182.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-136?page=all ]

Sameer Paranjpye reassigned HADOOP-136:
---------------------------------------

    Assign To: Michel Tourn

> Overlong UTF8's not handled well
> --------------------------------
>
>          Key: HADOOP-136
>          URL: http://issues.apache.org/jira/browse/HADOOP-136
>      Project: Hadoop
>         Type: Bug

>   Components: io
>     Versions: 0.2
>     Reporter: Dick King
>     Assignee: Michel Tourn
>     Priority: Minor
>      Fix For: 0.4
>  Attachments: largeutf8.patch
>
> When we feed an overlong string to the UTF8 constructor, two suboptimal things happen.
> First, we truncate to 0xffff/3 characters on the assumption that every character takes three bytes in UTF8.  This can truncate strings that don't need it, and it can be overoptimistic since there are characters that render as four bytes in UTF8.
> Second, the code doesn't actually handle four-byte characters.
> Third, there's a behavioral discontinuity.  If the string is "discovered" to be overlong by the arbitrary limit described above, we truncate with a log message, otherwise we signal a RuntimeException.  One feels that both forms of truncation should be treated alike.  However, this issue is concealed by the second issue; the exception will never be thrown because UTF8.utf8Length can't return more than three times the length of its input.
> I would recommend changing UTF8.utf8Length to let its caller know how many characters of the input string will actually fit if there's an overflow [perhaps by returning the negative of that number] and doing the truncation accurately as needed.
> -dk

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:44:24 2006
Return-Path: 
 <hadoop-dev-return-1774-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86613 invoked from network); 31 May 2006 00:44:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:44:24 -0000
Received: (qmail 77489 invoked by uid 500); 31 May 2006 00:44:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77458 invoked by uid 500); 31 May 2006 00:44:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77449 invoked by uid 99); 31 May 2006 00:44:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:44:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:44:23 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id EB7127142F8
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:43:32 +0000 (GMT)
Message-ID: <26786431.1149036212961.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:43:32 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-240) namenode should not log failed mkdirs
 at warning level
In-Reply-To: <10933304.1148404889830.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-240?page=all ]

Sameer Paranjpye updated HADOOP-240:
------------------------------------

    Fix Version: 0.3

> namenode should not log failed mkdirs at warning level
> ------------------------------------------------------
>
>          Key: HADOOP-240
>          URL: http://issues.apache.org/jira/browse/HADOOP-240
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2.1
>     Reporter: Hairong Kuang
>     Assignee: Hairong Kuang
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: mkdir.patch, mkdir_new.patch
>
> when a namenode creates a directory, it also recursively tries to creates its parent directories. If they already exist, the lastSuccess is  false and the "error" is logged at the warning level.
> The right approach is to set the logging leve lower to fine or simply ignore the the "error".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:46:21 2006
Return-Path: 
 <hadoop-dev-return-1775-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86778 invoked from network); 31 May 2006 00:46:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:46:21 -0000
Received: (qmail 78211 invoked by uid 500); 31 May 2006 00:46:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78188 invoked by uid 500); 31 May 2006 00:46:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78179 invoked by uid 99); 31 May 2006 00:46:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:46:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:46:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8B8A57142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:45:30 +0000 (GMT)
Message-ID: <15115650.1149036330568.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:45:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-243) WI shows progress as 100.00% before
 actual completion (rounding error)
In-Reply-To: <32908038.1148411909849.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-243?page=all ]

Sameer Paranjpye updated HADOOP-243:
------------------------------------

    Fix Version: 0.4
        Version: 0.1.0

> WI shows progress as 100.00% before actual completion (rounding error)
> ----------------------------------------------------------------------
>
>          Key: HADOOP-243
>          URL: http://issues.apache.org/jira/browse/HADOOP-243
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.1.0
>     Reporter: Yoram Arnon
>     Priority: Trivial
>      Fix For: 0.4

>
> For jobs of over 50000 tasks, the rounding error in the WI is confusing.
> When less than 0.005% of the map (or reduce) tasks remain to execute, the WI shows progress as 100.00%, which is misleading.
> Rounding down to the nearest .01% would be better.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 00:49:21 2006
Return-Path: 
 <hadoop-dev-return-1776-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87434 invoked from network); 31 May 2006 00:49:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 00:49:21 -0000
Received: (qmail 81226 invoked by uid 500); 31 May 2006 00:49:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81196 invoked by uid 500); 31 May 2006 00:49:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81186 invoked by uid 99); 31 May 2006 00:49:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:49:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 17:49:20 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 88ABA7142F7
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 00:48:30 +0000 (GMT)
Message-ID: <30368801.1149036510557.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 00:48:30 +0000 (GMT+00:00)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-55) map-reduce job overhead is too high
In-Reply-To: <1224793629.1140650148939.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-55?page=all ]

Sameer Paranjpye updated HADOOP-55:
-----------------------------------

    Fix Version: 0.5

> map-reduce job overhead is too high
> -----------------------------------
>
>          Key: HADOOP-55
>          URL: http://issues.apache.org/jira/browse/HADOOP-55
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.2
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.5

>
> map-reduce job overhead is too high. Running a null map-reduce job, with no input, no intermediate data and no output, on a several-hundred node cluster, takes several minutes, rather than several seconds.
> Enhanced distribution, launching and monitoring mechanisms should reduce the overhead to levels that match human online patience for short jobs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 03:55:22 2006
Return-Path: 
 <hadoop-dev-return-1777-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51618 invoked from network); 31 May 2006 03:55:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 03:55:22 -0000
Received: (qmail 38730 invoked by uid 500); 31 May 2006 03:55:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38693 invoked by uid 500); 31 May 2006 03:55:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38684 invoked by uid 99); 31 May 2006 03:55:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 20:55:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 20:55:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 86E507142F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 03:54:30 +0000 (GMT)
Message-ID: <23331425.1149047670549.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 03:54:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-221) make the number of map output
 configurable
In-Reply-To: <9402608.1147750732522.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-221?page=all ]
     
Owen O'Malley resolved HADOOP-221:
----------------------------------

    Resolution: Duplicate

This functionality was superceded by the fix for HADOOP-254 (transfering map output files via http).

> make the number of map output configurable
> ------------------------------------------
>
>          Key: HADOOP-221
>          URL: http://issues.apache.org/jira/browse/HADOOP-221
>      Project: Hadoop
>         Type: Improvement

>   Components: mapred
>     Versions: 0.2
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: more-map-output-servers.patch
>
> The number of map output server threads in each task tracker is currently set to the number of task slots. Since the optimum setting depends on the network, it would be nice to have more threads serving map output files than reduces.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 04:26:39 2006
Return-Path: 
 <hadoop-dev-return-1778-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57520 invoked from network); 31 May 2006 04:26:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 04:26:39 -0000
Received: (qmail 58356 invoked by uid 500); 31 May 2006 04:26:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58331 invoked by uid 500); 31 May 2006 04:26:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58322 invoked by uid 99); 31 May 2006 04:26:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 21:26:38 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.28] (HELO mrout2-b.corp.dcn.yahoo.com)
 (216.109.112.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 21:26:38 -0700
Received: from [IPv6:::1] (proxy7.corp.yahoo.com [216.145.48.98])
	by mrout2-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k4V4Q07B051936
	for <hadoop-dev@lucene.apache.org>; Tue, 30 May 2006 21:26:00 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=mime-version:content-transfer-encoding:message-id:
	content-type:to:from:subject:date:x-mailer;
	b=GSIbrja8dm1rPSLTFJAocOgUGoE4TIMaEo909VCZTMEG3m1HcUmTchvOjil7AVl3
Mime-Version: 1.0 (Apple Message framework v624)
Content-Transfer-Encoding: 7bit
Message-Id: <ecee304db44d90cbf5f6befe207bd1ab@yahoo-inc.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
To: hadoop-dev@lucene.apache.org
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: benchmark on my 200 node cluster
Date: Tue, 30 May 2006 21:26:21 -0700
X-Mailer: Apple Mail (2.624)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

After observing the speed differential on my 200 node cluster between 
the fast and slow nodes as seen in HADOOP-253, I wanted to try running 
more smaller reduces. So instead of the default 400 reduces, which 
could all start at the beginning of execution, I used 700 instead. This 
means that all of the nodes run at least 2 reduces and the fastest 150 
nodes run an additional 2 reduces each.  Clearly, in a case where all 
of the nodes are well balanced, that will lose because the second round 
of data shuffling doesn't overlap the maps. However, in the presence of 
failures or uneven hardware, it will be a win.

That brought down my run time on sorting my 2010 gigabyte dataset from 
8.5 hours to 6.6 hours. For those of you who are keeping score, that 
means that at the start of the month the sort benchmark was taking 47 
hours and is now taking 6.6 hours on the same hardware.

Note that it would have also made sense to double the block size on the 
inputs, so that the size of data on each of the M*R data paths stays 
constant, but I wanted to try the changes independently. As for my 
other config choices, the only non-default ones are:

dfs.block.size=134217728
io.sort.factor=100
io.file.buffer.size=65536
mapred.reduce.parallel.copies=10

I'm also looking forward to trying out Ben Reed's patches to reduce the 
number of trips to disk in the reduces.

-- Owen


From MAILER-DAEMON Wed May 31 06:32:22 2006
Return-Path: 
 <hadoop-dev-return-1779-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86315 invoked from network); 31 May 2006 06:32:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 06:32:22 -0000
Received: (qmail 60996 invoked by uid 500); 31 May 2006 06:32:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60860 invoked by uid 500); 31 May 2006 06:32:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60851 invoked by uid 99); 31 May 2006 06:32:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 23:32:21 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 30 May 2006 23:32:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8F1A271428E
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 06:31:30 +0000 (GMT)
Message-ID: <9376505.1149057090583.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 06:31:30 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-259) map output http client does not
 timeout
In-Reply-To: <30473871.1148883389827.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-259?page=all ]

Owen O'Malley updated HADOOP-259:
---------------------------------

    Attachment: http-client-timeout.patch

Ok, this patch adds a timer for the map output copy threads. If they don't make progress often enough. (Progress is defined as receiving a block of data from the http server.) I've been testing it for the last two days and it seems to be working, but if we go to java 1.5 we should probably use the socket timeouts.

> map output http client does not timeout
> ---------------------------------------
>
>          Key: HADOOP-259
>          URL: http://issues.apache.org/jira/browse/HADOOP-259
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: http-client-timeout.patch
>
> The new map output http client uses java.net.URLConnection to fetch the data file. However under Java 1.4 there is no way to specify a timeout and it is set to infinite (or if not infinite at least 12 hours).  This causes reduce tasks to get "stuck" in the "reduce > copy" phase even after the "Task failed to report status for 600 seconds. Killing." message.
> I will add the code in the ReduceTaskRunner to make sure that copies in-flight don't get stuck, but this is another point where a switch to java 1.5 would be helpful. Under 1.5 I could set the timeout on the connection and the read would timeout after the given interval and my entire change would be local to MapOutputLocation.copyFile.
> For now, I'll assume that we need to maintain support for 1.4 and make the corresponding fix, but I'm grumbling...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 12:23:24 2006
Return-Path: 
 <hadoop-dev-return-1780-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95356 invoked from network); 31 May 2006 12:23:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 12:23:24 -0000
Received: (qmail 73008 invoked by uid 500); 31 May 2006 12:23:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72969 invoked by uid 500); 31 May 2006 12:23:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72960 invoked by uid 99); 31 May 2006 12:23:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 05:23:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 05:23:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3CAC17141F2
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 12:22:31 +0000 (GMT)
Message-ID: <33259965.1149078151245.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 12:22:31 +0000 (GMT+00:00)
From: "Arun C Murthy (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-211?page=all ]

Arun C Murthy updated HADOOP-211:
---------------------------------

    Attachment: acl-log4j.patch

Here's attached the patch for switching to commons logging with log4j as the logging framework.

Notes:

a) Hopefully this can be incorporated asap into hadoop svn since any further commits will entail us to patch anew.

b) The conf/log4j.properties file uses DailyRollingFileAppender which rolls over at midnight. Another choice is to use RollingFileAppender which will rollover every 1MB and maintain 30 backups, which is currently commented out.

c) There are some parts of code for e.g. those configuring the log-file, loog-levels etc. in the code which we have had to comment out since they aren't supported by Commons Logging. They should now be configured via the .properties file.

d) The framework as in the patch creates 4 separate logfiles i.e. 
  > $HADOOP_HOME/logs/namenode.log
  > $HADOOP_HOME/logs/datanode.log
  > $HADOOP_HOME/logs/jobtracker.log
  > $HADOOP_HOME/logs/tasktracker.log

   This is done by passing -Dhadoop.log.file=<logfilename>.log via the bin/hadoop startup script and referenced in log4j.properties.

thanks,
Arun

PS: This will have to be committed *before* the libhdfs patch, and after that I will go ahead and create a 2 line patch for TestDFSCIO.java (switch java.util.logging to commons logging).

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: acl-log4j.patch, commons_logging_patch
>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 18:11:31 2006
Return-Path: 
 <hadoop-dev-return-1781-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40293 invoked from network); 31 May 2006 18:11:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 18:11:31 -0000
Received: (qmail 12776 invoked by uid 500); 31 May 2006 18:11:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12691 invoked by uid 500); 31 May 2006 18:11:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12497 invoked by uid 99); 31 May 2006 18:11:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 11:11:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 11:11:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 0CF527141F3
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 18:10:31 +0000 (GMT)
Message-ID: <18169436.1149099031050.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 18:10:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12414118 ] 

Doug Cutting commented on HADOOP-124:
-------------------------------------

This adds a number of new public classes that I'm not certain should be public.  Should user code ever need to access a DataStorage, DatanodeID or DatanodeRegistration, or are these only used internally?  Also, several of these exceptions appear only to be used internally, but I'm not certain about all of them.  Would you object if I simply make all of these new classes package-private?  Then, if we need, we can reveal more later as needed.

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, Hadoop-124-v3.patch, Hadoop-124.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 18:55:24 2006
Return-Path: 
 <hadoop-dev-return-1782-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57409 invoked from network); 31 May 2006 18:55:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 18:55:24 -0000
Received: (qmail 86782 invoked by uid 500); 31 May 2006 18:55:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86761 invoked by uid 500); 31 May 2006 18:55:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86751 invoked by uid 99); 31 May 2006 18:55:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 11:55:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 11:55:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 3FFA97141F2
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 18:54:31 +0000 (GMT)
Message-ID: <24074086.1149101671259.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 18:54:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-124?page=all ]
     
Doug Cutting resolved HADOOP-124:
---------------------------------

    Resolution: Fixed

I just committed this, modified to make most of the new classes package-private rather than public.  Thanks, Konstantin!

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, Hadoop-124-v3.patch, Hadoop-124.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 19:02:23 2006
Return-Path: 
 <hadoop-dev-return-1783-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60218 invoked from network); 31 May 2006 19:02:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 19:02:23 -0000
Received: (qmail 97603 invoked by uid 500); 31 May 2006 19:02:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97470 invoked by uid 500); 31 May 2006 19:02:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97456 invoked by uid 99); 31 May 2006 19:02:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:02:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:02:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 1B7007141F1
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 19:01:31 +0000 (GMT)
Message-ID: <20243114.1149102091109.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 19:01:31 +0000 (GMT+00:00)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-124) don't permit two datanodes to run
 from same dfs.data.dir
In-Reply-To: <464550433.1144431983681.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-124?page=comments#action_12414130 ] 

Konstantin Shvachko commented on HADOOP-124:
--------------------------------------------

Yes, I think it is ok to make the classes unaccessible from the outside of the project.
Exceptions are different, they are returned to a client in the form of IOException right now, 
but if the client wants to distinguish between them then we need to keep them public.

> don't permit two datanodes to run from same dfs.data.dir
> --------------------------------------------------------
>
>          Key: HADOOP-124
>          URL: http://issues.apache.org/jira/browse/HADOOP-124
>      Project: Hadoop
>         Type: Bug

>   Components: dfs
>     Versions: 0.2
>  Environment: ~30 node cluster
>     Reporter: Bryan Pendleton
>     Assignee: Konstantin Shvachko
>     Priority: Critical
>      Fix For: 0.3
>  Attachments: DatanodeRegister.txt, Hadoop-124-v3.patch, Hadoop-124.patch
>
> DFS files are still rotting.
> I suspect that there's a problem with block accounting/detecting identical hosts in the namenode. I have 30 physical nodes, with various numbers of local disks, meaning that my current 'bin/hadoop dfs -report" shows 80 nodes after a full restart. However, when I discovered the  problem (which resulted in losing about 500gb worth of temporary data because of missing blocks in some of the larger chunks) -report showed 96 nodes. I suspect somehow there were extra datanodes running against the same paths, and that the namenode was counting those as replicated instances, which then showed up over-replicated, and one of them was told to delete its local block, leading to the block actually getting lost.
> I will debug it more the next time the situation arises. This is at least the 5th time I've had a large amount of file data "rot" in DFS since January.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 19:10:24 2006
Return-Path: 
 <hadoop-dev-return-1784-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62265 invoked from network); 31 May 2006 19:10:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 19:10:24 -0000
Received: (qmail 8251 invoked by uid 500); 31 May 2006 19:10:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8224 invoked by uid 500); 31 May 2006 19:10:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8214 invoked by uid 99); 31 May 2006 19:10:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:10:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:10:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 9182B7141F2
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 19:09:30 +0000 (GMT)
Message-ID: <23372567.1149102570593.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 19:09:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-256) Implement a C api for hadoop dfs
In-Reply-To: <6195280.1148675669863.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-256?page=comments#action_12414132 ] 

Doug Cutting commented on HADOOP-256:
-------------------------------------

I just committed this.  I changed the path to 'ld' from '/usr/bin/ld' to simply 'ld', since it's installed in /bin on my Ubuntu system.  Thanks, Arun!

> Implement a C api for hadoop dfs
> --------------------------------
>
>          Key: HADOOP-256
>          URL: http://issues.apache.org/jira/browse/HADOOP-256
>      Project: Hadoop
>         Type: New Feature

>   Components: dfs
>     Reporter: Arun C Murthy
>      Fix For: 0.3
>  Attachments: libhdfs-new.patch.tgz, libhdfs.patch
>
> Implement a C api for hadoop dfs to ease talking to hadoop's dfs from native C/C++ applications.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 19:15:23 2006
Return-Path: 
 <hadoop-dev-return-1785-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63246 invoked from network); 31 May 2006 19:15:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 19:15:23 -0000
Received: (qmail 12745 invoked by uid 500); 31 May 2006 19:15:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12601 invoked by uid 500); 31 May 2006 19:15:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12589 invoked by uid 99); 31 May 2006 19:15:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:15:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:15:21 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id CDF5E7141F3
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 19:14:29 +0000 (GMT)
Message-ID: <6879018.1149102869840.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 19:14:29 +0000 (GMT+00:00)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-263) task status should include timestamps
 for when a job transitions
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

task status should include timestamps for when a job transitions
----------------------------------------------------------------

         Key: HADOOP-263
         URL: http://issues.apache.org/jira/browse/HADOOP-263
     Project: Hadoop
        Type: Improvement

  Components: mapred  
    Versions: 0.2.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.4


It would help users to understand what happened if the task status included information about when the task transitioned:

Map:
   started
   finished

Reduce:
   started
   shuffle finished
   sort finished
   finished

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 19:28:26 2006
Return-Path: 
 <hadoop-dev-return-1786-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77258 invoked from network); 31 May 2006 19:28:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 19:28:26 -0000
Received: (qmail 27630 invoked by uid 500); 31 May 2006 19:28:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27602 invoked by uid 500); 31 May 2006 19:28:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27593 invoked by uid 99); 31 May 2006 19:28:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:28:25 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:28:24 -0700
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k4VJR4Vw009274
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 15:27:05 -0400
X-ORBL: [69.228.218.244]
Received: from [192.168.168.15] (adsl-69-228-218-244.dsl.pltn13.pacbell.net
 [69.228.218.244])
	by pimout5-ext.prodigy.net (8.13.6 out.dk/8.13.6) with ESMTP id
 k4VJS0fR270008;
	Wed, 31 May 2006 15:28:00 -0400
Message-ID: <447DEE3F.2000909@apache.org>
Date: Wed, 31 May 2006 12:27:59 -0700
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.8 (X11/20060502)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: java 1.4 versus 1.5
References: <6576b8459b29602803a33c6249ec1480@yahoo-inc.com>
In-Reply-To: <6576b8459b29602803a33c6249ec1480@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Owen O'Malley wrote:
> Java 1.5 has been out for a couple of years now and has some nice 
> improvements in the libraries. In particular, I wish I had access to the 
> timeout settings on UrlConnections. Would anyone object if starting with 
> the 0.3 release this week, we required java 1.5 to compile and run Hadoop?

Since you contributed a non-Java-1.5 patch for HADOOP-259, let's go 
ahead and release 0.3 without a Java 1.5 requirement, then start 
permitting Java 1.5 in changes for 0.4.  That way we give folks a bit 
more notice and a bit more time to object.  I doubt we'll hear many 
objections, but I don't want to surprise folks too much with this kind 
of change.

Does this sound like a reasonable plan?

Doug

From MAILER-DAEMON Wed May 31 19:55:23 2006
Return-Path: 
 <hadoop-dev-return-1787-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85039 invoked from network); 31 May 2006 19:55:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 19:55:23 -0000
Received: (qmail 70085 invoked by uid 500); 31 May 2006 19:55:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69951 invoked by uid 500); 31 May 2006 19:55:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69941 invoked by uid 99); 31 May 2006 19:55:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:55:22 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 12:55:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 8D35A7141F2
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 19:54:30 +0000 (GMT)
Message-ID: <8145997.1149105270575.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 19:54:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-259) map output http client does not
 timeout
In-Reply-To: <30473871.1148883389827.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-259?page=comments#action_12414139 ] 

Doug Cutting commented on HADOOP-259:
-------------------------------------

Does Pingable really need to be a public interface in the util package?  The util package could easily get cluttered with stuff that's only used in one place.  Any objection if I make this a package-private interface in mapred, or perhaps even a nested class?

> map output http client does not timeout
> ---------------------------------------
>
>          Key: HADOOP-259
>          URL: http://issues.apache.org/jira/browse/HADOOP-259
>      Project: Hadoop
>         Type: Bug

>   Components: mapred
>     Versions: 0.3
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.3
>  Attachments: http-client-timeout.patch
>
> The new map output http client uses java.net.URLConnection to fetch the data file. However under Java 1.4 there is no way to specify a timeout and it is set to infinite (or if not infinite at least 12 hours).  This causes reduce tasks to get "stuck" in the "reduce > copy" phase even after the "Task failed to report status for 600 seconds. Killing." message.
> I will add the code in the ReduceTaskRunner to make sure that copies in-flight don't get stuck, but this is another point where a switch to java 1.5 would be helpful. Under 1.5 I could set the timeout on the connection and the read would timeout after the given interval and my entire change would be local to MapOutputLocation.copyFile.
> For now, I'll assume that we need to maintain support for 1.4 and make the corresponding fix, but I'm grumbling...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 21:02:30 2006
Return-Path: 
 <hadoop-dev-return-1788-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3036 invoked from network); 31 May 2006 21:02:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 21:02:30 -0000
Received: (qmail 67260 invoked by uid 500); 31 May 2006 21:02:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67228 invoked by uid 500); 31 May 2006 21:02:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67218 invoked by uid 99); 31 May 2006 21:02:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 14:02:29 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 14:02:28 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id DBE23714204
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 21:01:31 +0000 (GMT)
Message-ID: <14753099.1149109291897.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 21:01:31 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12414147 ] 

Doug Cutting commented on HADOOP-211:
-------------------------------------

Unfortunately this patch no longer applies cleanly.  Can you please update your source tree and re-generate this patch?  I try to process patches in the order they are submitted, but frequently there are conflicts in the queue.  Thanks!

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: acl-log4j.patch, commons_logging_patch
>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 21:08:24 2006
Return-Path: 
 <hadoop-dev-return-1789-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4134 invoked from network); 31 May 2006 21:08:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 21:08:24 -0000
Received: (qmail 73394 invoked by uid 500); 31 May 2006 21:08:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73261 invoked by uid 500); 31 May 2006 21:08:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73252 invoked by uid 99); 31 May 2006 21:08:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 14:08:23 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 14:08:22 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id F16097141F6
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 21:07:30 +0000 (GMT)
Message-ID: <21860587.1149109650986.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 21:07:30 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12414150 ] 

Doug Cutting commented on HADOOP-211:
-------------------------------------

Also, we should not yet remove LogFormatter, but only deprecate it, as user code (e.g., Nutch) may use this class.  A good test for back-compatibility of changes to Hadoop's public APIs is to check that Nutch still compiles and runs correctly with an updated Hadoop jar.

If we deprecate LogFormatter in 0.3 then we can remove it in Hadoop 0.4, but we should always give folks at least one release to remove dependencies on deprecated features.

Thanks again!

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: acl-log4j.patch, commons_logging_patch
>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed May 31 21:14:34 2006
Return-Path: 
 <hadoop-dev-return-1790-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7349 invoked from network); 31 May 2006 21:14:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 May 2006 21:14:34 -0000
Received: (qmail 86605 invoked by uid 500); 31 May 2006 21:14:30 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86563 invoked by uid 500); 31 May 2006 21:14:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86532 invoked by uid 99); 31 May 2006 21:14:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 14:14:29 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [209.237.227.198] (HELO brutus.apache.org) (209.237.227.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 May 2006 14:14:29 -0700
Received: from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 85A6A714219
	for <hadoop-dev@lucene.apache.org>; Wed, 31 May 2006 21:13:32 +0000 (GMT)
Message-ID: <25253202.1149110012544.JavaMail.jira@brutus>
Date: Wed, 31 May 2006 21:13:32 +0000 (GMT+00:00)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-211) logging improvements for Hadoop
In-Reply-To: <11693488.1147389488398.JavaMail.root@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-211?page=comments#action_12414155 ] 

Doug Cutting commented on HADOOP-211:
-------------------------------------

One more thing: please don't just comment out obsolete code; delete it.  Thanks.

http://wiki.apache.org/lucene-hadoop/HowToContribute

> logging improvements for Hadoop
> -------------------------------
>
>          Key: HADOOP-211
>          URL: http://issues.apache.org/jira/browse/HADOOP-211
>      Project: Hadoop
>         Type: Improvement

>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.3
>  Attachments: acl-log4j.patch, commons_logging_patch
>
> Here's a proposal for some impovements to the way Hadoop does logging. It advocates 3 
> broad changes to the way logging is currently done, these being:
> - The use of a uniform logging format by all Hadoop subsystems
> - The use of Apache commons logging as a facade above an underlying logging framework
> - The use of Log4J as the underlying logging framework instead of java.util.logging
> This is largely polishing work, but it seems like it would make log analysis and debugging
> easier in the short term. In the long term, it would future proof logging to the extent of
> allowing the logging framework used to change while requiring minimal code change. The 
> propos changes are motivated by the following requirements which we think Hadoops 
> logging should meet:
> - Hadoops logs should be amenable to analysis by tools like grep, sed, awk etc.
> - Log entries should be clearly annotated with a timestamp and a logging level
> - Log entries should be traceable to the subsystem from which they originated
> - The logging implementation should allow log entries to be annotated with source code 
> location information like classname, methodname, file and line number, without requiring
> code changes
> - It should be possible to change the logging implementation used without having to change
> thousands of lines of code
> - The mapping of loggers to destinations (files, directories, servers etc.) should be 
> specified and modifiable via configuration
> Uniform logging format:
> All Hadoop logs should have the following structure.
> <Header>\n
> <LogEntry>\n [<Exception>\n]
> .
> .
> .
> where the header line specifies the format of each log entry. The header line has the format:
> '# <Fieldname> <Fieldname>...\n'. 
> The default format of each log entry is: '# Timestamp Level LoggerName Message', where:
> - Timestamp is a date and time in the format MM/DD/YYYY:HH:MM:SS
> - Level is the logging level (FATAL, WARN, DEBUG, TRACE, etc.)
> - LoggerName is the short name of the logging subsystem from which the message originated e.g.
> fs.FSNamesystem, dfs.Datanode etc.
> - Message is the log message produced
> Why Apache commons logging and Log4J?
> Apache commons logging is a facade meant to be used as a wrapper around an underlying logging
> implementation. Bridges from Apache commons logging to popular logging implementations 
> (Java logging, Log4J, Avalon etc.) are implemented and available as part of the commons logging
> distribution. Implementing a bridge to an unsupported implementation is fairly striaghtforward
> and involves the implementation of subclasses of the commons logging LogFactory and Logger 
> classes. Using Apache commons logging and making all logging calls through it enables us to
> move to a different logging implementation by simply changing configuration in the best case.
> Even otherwise, it incurs minimal code churn overhead.
> Log4J offers a few benefits over java.util.logging that make it a more desirable choice for the
> logging back end.
> - Configuration Flexibility: The mapping of loggers to destinations (files, sockets etc.)
> can be completely specified in configuration. It is possible to do this with Java logging as
> well, however, configuration is a lot more restrictive. For instance, with Java logging all 
> log files must have names derived from the same pattern. For the namenode, log files could 
> be named with the pattern "%h/namenode%u.log" which would put log files in the user.home
> directory with names like namenode0.log etc. With Log4J it would be possible to configure
> the namenode to emit log files with different names, say heartbeats.log, namespace.log,
> clients.log etc. Configuration variables in Log4J can also have the values of system 
> properties embedded in them.
> - Takes wrappers into account: Log4J takes into account the possibility that an application
> may be invoking it via a wrapper, such as Apache commons logging. This is important because
> logging event objects must be able to infer the context of the logging call such as classname,
> methodname etc. Inferring context is a relatively expensive operation that involves creating
> an exception and examining the stack trace to find the frame just before the first frame 
> of the logging framework. It is therefore done lazily only when this information actually 
> needs to be logged. Log4J can be instructed to look for the frame corresponding to the wrapper
> class, Java logging cannot. In the case of Java logging this means that a) the bridge from 
> Apache commons logging is responsible for inferring the calling context and setting it in the 
> logging event and b) this inference has to be done on every logging call regardless of whether
> or not it is needed.
> - More handy features: Log4J has some handy features that Java logging doesn't. A couple
> of examples of these:
> a) Date based rolling of log files 
> b) Format control through configuration. Log4J has a PatternLayout class that can be 
> configured to generate logs with a user specified pattern. The logging format described
> above can be described as "%d{MM/dd/yyyy:HH:mm:SS} %c{2} %p %m". The format specifiers
> indicate that each log line should have the date and time followed by the logger name followed
> by the logging level or priority followed by the application generated message.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


