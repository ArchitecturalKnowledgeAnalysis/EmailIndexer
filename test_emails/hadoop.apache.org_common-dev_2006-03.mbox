From MAILER-DAEMON Tue Feb 28 23:53:10 2006
Return-Path: 
 <hadoop-dev-return-278-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29769 invoked from network); 28 Feb 2006 23:53:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Feb 2006 23:53:10 -0000
Received: (qmail 39939 invoked by uid 500); 28 Feb 2006 23:53:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39897 invoked by uid 500); 28 Feb 2006 23:53:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39866 invoked by uid 99); 28 Feb 2006 23:53:03 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Feb 2006 15:53:01 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 57BB818B
	for <hadoop-dev@lucene.apache.org>; Wed,  1 Mar 2006 00:52:40 +0100 (CET)
Message-ID: <2115131815.1141170760357.JavaMail.jira@ajax.apache.org>
Date: Wed, 1 Mar 2006 00:52:40 +0100 (CET)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-59) support generic command-line options
In-Reply-To: <321463887.1140733957324.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-59?page=comments#action_12368188 ] 

Doug Cutting commented on HADOOP-59:
------------------------------------

Michel,

I think that -D should define Hadoop configuration properties, not JVM system properties.  And I don't think Hadoop configurations should by default include all of the JVM's system properties.  Finally, please include good user-level javadoc on all public & protected items, attach Apache's license at the top of each file, try to bundle things into a single patch file, etc.  These kinds of things make it much easier for me to commit a patch.  Ideally all that I need to do is read the patch to see that it looks reasonable, apply it with 'patch -p 0 < patchFile', run unit tests and commit.  Including new unit tests is also a good idea.  If I need to clean up  javadoc, licenses, formatting, etc. before I can commit then I will be less inclined to process a contribution promptly.

Doug


> support generic command-line options
> ------------------------------------
>
>          Key: HADOOP-59
>          URL: http://issues.apache.org/jira/browse/HADOOP-59
>      Project: Hadoop
>         Type: Improvement
>   Components: conf
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Michel Tourn
>      Fix For: 0.1
>  Attachments: Tool.java, ToolBase.java, bashfile.patch, toolbase.patch
>
> Hadoop commands should all support some common options.  For example, it should be possible to specify the namenode, datanode, and, for that matter, any config option, in a generic way.
> This could be implemented with code like:
> public interface Tool extends Configurable {
>   void run(String[] args) throws Exception;
> }
> public class ToolBase implements Tool extends Configured {
>   public final void main(String[] args) throws Exception {
>     Configuration conf = new Configuration();
>     ... parse config options from args into conf ...
>     this.configure(conf);
>     this.run();
>   }
> }
> public MyTool extends ExcecutableBase {
>   public static void main(String[] args) throws Exception {
>     new MyTool().main(args);
>   }
> }
> The general command line syntax could be:
> bin/hadoop [generalOptions] command [commandOptions]
> Where generalOptions are things that ToolBase handles, and only the commandOptions are passed to Tool.run().  The most important generalOption would be '-D', which would define name/value pairs that are set in the configuration.  This alone would permit folks to set the namenode, datanode, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  1 22:17:18 2006
Return-Path: 
 <hadoop-dev-return-279-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47811 invoked from network); 1 Mar 2006 22:17:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Mar 2006 22:17:18 -0000
Received: (qmail 85880 invoked by uid 500); 1 Mar 2006 22:18:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85857 invoked by uid 500); 1 Mar 2006 22:18:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85848 invoked by uid 99); 1 Mar 2006 22:18:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 14:18:04 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 14:18:03 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id D33B214453C
	for <hadoop-dev@lucene.apache.org>; Wed,  1 Mar 2006 23:10:59 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 14634-07 for <hadoop-dev@lucene.apache.org>;
	Wed, 1 Mar 2006 23:10:59 +0100 (CET)
Received: from [192.168.8.4] (dslb-084-059-201-047.pools.arcor-ip.net
 [84.59.201.47])
	by mslinux.media-style.com (Postfix) with ESMTP id 494D51444F1
	for <hadoop-dev@lucene.apache.org>; Wed,  1 Mar 2006 23:10:59 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
Content-Transfer-Encoding: 7bit
Message-Id: <0C02C8B2-4C2F-4E49-B5D8-C84075C9CFC0@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: scalability limits getDetails, mapFile Readers?
Date: Wed, 1 Mar 2006 23:17:37 +0100
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

We run into a problem with nutch using  
MapFileOutputFormat#getReaders  and getEntry.
In detail this happens until summary generation where we open for  
each segment as much readers as much parts (part-0000 to part-n) we  
have.
Having 80 tasktracker and 80 segments means:
80 x 80 x 4 (parseData, parseText, content, crawl). A search server   
also needs to open as much files as required for the index searcher.
So the problem is a FileNotFoundException, (Too many open files).

Opening and closing Readers for each Detail makes no sense. We may  
can limit the number of readers somehow and close the readers that  
wasn't used since the longest time.
But I'm not that happy with this solution, so any thoughts how we can  
solve this problem in general?

Thanks.
Stefan


---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Wed Mar  1 23:08:23 2006
Return-Path: 
 <hadoop-dev-return-280-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78953 invoked from network); 1 Mar 2006 23:08:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Mar 2006 23:08:23 -0000
Received: (qmail 81326 invoked by uid 500); 1 Mar 2006 23:09:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81311 invoked by uid 500); 1 Mar 2006 23:09:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81302 invoked by uid 99); 1 Mar 2006 23:09:09 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 15:09:07 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D69ACDD
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 00:08:44 +0100 (CET)
Message-ID: <22165960.1141254524877.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 00:08:44 +0100 (CET)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-57) hadoop dfs -ls / does not show root
 of file system
In-Reply-To: <3280039.1140661146259.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-57?page=comments#action_12368391 ] 

Mahadev konar commented on HADOOP-57:
-------------------------------------

Here is a small patch that enables seeing the root file system.  The getDFSPath() function in DistributedFileSystem returns empty string in case of an ls on /. The patch below modifies it to return /.

264d263
<       path.append(DFSFile.DFS_FILE_SEPARATOR);
266a266
>         path.append(DFSFile.DFS_FILE_SEPARATOR);
268,270d267
<         if(i!=0){
<            path.append(DFSFile.DFS_FILE_SEPARATOR);
<       }


> hadoop dfs -ls / does not show root of file system
> --------------------------------------------------
>
>          Key: HADOOP-57
>          URL: http://issues.apache.org/jira/browse/HADOOP-57
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Priority: Minor

>
> hadoop dfs -ls / does not show root of file system - it shows the user's home directory.
> It's thus impossible to learn the contents of the root file system via the shell.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  1 23:25:30 2006
Return-Path: 
 <hadoop-dev-return-281-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85461 invoked from network); 1 Mar 2006 23:25:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Mar 2006 23:25:30 -0000
Received: (qmail 98648 invoked by uid 500); 1 Mar 2006 23:26:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98629 invoked by uid 500); 1 Mar 2006 23:26:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98620 invoked by uid 99); 1 Mar 2006 23:26:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 15:26:16 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 15:26:16 -0800
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k21NPvRR011681
	for <hadoop-dev@lucene.apache.org>; Wed, 1 Mar 2006 18:25:57 -0500
X-ORBL: [69.228.231.148]
Received: from [192.168.168.15] (adsl-69-228-231-148.dsl.pltn13.pacbell.net
 [69.228.231.148])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k21NPnaW066438;
	Wed, 1 Mar 2006 18:25:51 -0500
Message-ID: <44062D7C.8030604@apache.org>
Date: Wed, 01 Mar 2006 15:25:48 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: scalability limits getDetails, mapFile Readers?
References: <0C02C8B2-4C2F-4E49-B5D8-C84075C9CFC0@media-style.com>
In-Reply-To: <0C02C8B2-4C2F-4E49-B5D8-C84075C9CFC0@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Stefan,

I think you meant to send this to nutch-dev, not hadoop-dev.

Doug

Stefan Groschupf wrote:
> Hi,
> 
> We run into a problem with nutch using  MapFileOutputFormat#getReaders  
> and getEntry.
> In detail this happens until summary generation where we open for  each 
> segment as much readers as much parts (part-0000 to part-n) we  have.
> Having 80 tasktracker and 80 segments means:
> 80 x 80 x 4 (parseData, parseText, content, crawl). A search server   
> also needs to open as much files as required for the index searcher.
> So the problem is a FileNotFoundException, (Too many open files).
> 
> Opening and closing Readers for each Detail makes no sense. We may  can 
> limit the number of readers somehow and close the readers that  wasn't 
> used since the longest time.
> But I'm not that happy with this solution, so any thoughts how we can  
> solve this problem in general?
> 
> Thanks.
> Stefan
> 
> 
> ---------------------------------------------
> blog: http://www.find23.org
> company: http://www.media-style.com
> 
> 

From MAILER-DAEMON Wed Mar  1 23:28:18 2006
Return-Path: 
 <hadoop-dev-return-282-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86081 invoked from network); 1 Mar 2006 23:28:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Mar 2006 23:28:18 -0000
Received: (qmail 736 invoked by uid 500); 1 Mar 2006 23:29:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 716 invoked by uid 500); 1 Mar 2006 23:29:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 707 invoked by uid 99); 1 Mar 2006 23:29:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 15:29:04 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 15:29:02 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 218D61444C9
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 00:21:59 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 15085-03 for <hadoop-dev@lucene.apache.org>;
	Thu, 2 Mar 2006 00:21:58 +0100 (CET)
Received: from [192.168.8.4] (dslb-084-059-201-047.pools.arcor-ip.net
 [84.59.201.47])
	by mslinux.media-style.com (Postfix) with ESMTP id 294631444C0
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 00:21:58 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
In-Reply-To: <44062D7C.8030604@apache.org>
References: <0C02C8B2-4C2F-4E49-B5D8-C84075C9CFC0@media-style.com>
 <44062D7C.8030604@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <800C580F-8252-4F91-B4EF-E4B3F7D9B1C0@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: scalability limits getDetails, mapFile Readers?
Date: Thu, 2 Mar 2006 00:28:35 +0100
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

ups, sorry my mistake. I will post it in nutch- dev again.

Am 02.03.2006 um 00:25 schrieb Doug Cutting:

> Stefan,
>
> I think you meant to send this to nutch-dev, not hadoop-dev.
>
> Doug
>
> Stefan Groschupf wrote:
>> Hi,
>> We run into a problem with nutch using   
>> MapFileOutputFormat#getReaders  and getEntry.
>> In detail this happens until summary generation where we open for   
>> each segment as much readers as much parts (part-0000 to part-n)  
>> we  have.
>> Having 80 tasktracker and 80 segments means:
>> 80 x 80 x 4 (parseData, parseText, content, crawl). A search  
>> server   also needs to open as much files as required for the  
>> index searcher.
>> So the problem is a FileNotFoundException, (Too many open files).
>> Opening and closing Readers for each Detail makes no sense. We  
>> may  can limit the number of readers somehow and close the readers  
>> that  wasn't used since the longest time.
>> But I'm not that happy with this solution, so any thoughts how we  
>> can  solve this problem in general?
>> Thanks.
>> Stefan
>> ---------------------------------------------
>> blog: http://www.find23.org
>> company: http://www.media-style.com
>

---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Wed Mar  1 23:51:26 2006
Return-Path: 
 <hadoop-dev-return-283-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97351 invoked from network); 1 Mar 2006 23:51:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Mar 2006 23:51:26 -0000
Received: (qmail 38966 invoked by uid 500); 1 Mar 2006 23:52:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38945 invoked by uid 500); 1 Mar 2006 23:52:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38936 invoked by uid 99); 1 Mar 2006 23:52:13 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 15:52:11 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B0B5BDD
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 00:51:44 +0100 (CET)
Message-ID: <57329824.1141257104720.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 00:51:44 +0100 (CET)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-62) can't get environment variables from
 HADOOP_CONF_DIR
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

can't get environment variables from HADOOP_CONF_DIR
----------------------------------------------------

         Key: HADOOP-62
         URL: http://issues.apache.org/jira/browse/HADOOP-62
     Project: Hadoop
        Type: Bug
  Components: conf  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Minor


The bin/hadoop script doesn't use the HADOOP_CONF_DIR variable to find hadoop-env.sh.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  1 23:53:26 2006
Return-Path: 
 <hadoop-dev-return-284-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97681 invoked from network); 1 Mar 2006 23:53:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 1 Mar 2006 23:53:26 -0000
Received: (qmail 39488 invoked by uid 500); 1 Mar 2006 23:54:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39470 invoked by uid 500); 1 Mar 2006 23:54:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39461 invoked by uid 99); 1 Mar 2006 23:54:12 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 15:54:10 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 29E9CDD
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 00:53:45 +0100 (CET)
Message-ID: <1277904203.1141257225169.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 00:53:45 +0100 (CET)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-62) can't get environment variables from
 HADOOP_CONF_DIR
In-Reply-To: <57329824.1141257104720.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-62?page=all ]

Owen O'Malley updated HADOOP-62:
--------------------------------

    Attachment: conf_dir.patch

This patch fixes the problem by setting the HADOOP_CONF_DIR earlier in the script.

> can't get environment variables from HADOOP_CONF_DIR
> ----------------------------------------------------
>
>          Key: HADOOP-62
>          URL: http://issues.apache.org/jira/browse/HADOOP-62
>      Project: Hadoop
>         Type: Bug
>   Components: conf
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>  Attachments: conf_dir.patch
>
> The bin/hadoop script doesn't use the HADOOP_CONF_DIR variable to find hadoop-env.sh.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:12:20 2006
Return-Path: 
 <hadoop-dev-return-285-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 2956 invoked from network); 2 Mar 2006 00:12:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:12:20 -0000
Received: (qmail 61145 invoked by uid 500); 2 Mar 2006 00:13:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61094 invoked by uid 500); 2 Mar 2006 00:13:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61047 invoked by uid 99); 2 Mar 2006 00:13:06 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:13:03 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 99EA4E1
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:12:42 +0100 (CET)
Message-ID: <1077254989.1141258362627.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:12:42 +0100 (CET)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-33) DF enhancement: performance and win
 XP support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-33?page=comments#action_12368399 ] 

Konstantin Shvachko commented on HADOOP-33:
-------------------------------------------

This patch (DF2.patch) covers DF caching and reuse of the same instance of DF in FSDataset.
I removed main() from the DF class, and created class TestDF in the test directory.
Additionally, for those who want Windows XP/2003 df functionality without cygwin
I attach DF.java, which covers that and is ready for adding other OSs, if desired.
Just replace committed DF.java with the one attached.

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.patch, DFpatch.txt
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:14:16 2006
Return-Path: 
 <hadoop-dev-return-286-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3425 invoked from network); 2 Mar 2006 00:14:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:14:16 -0000
Received: (qmail 61951 invoked by uid 500); 2 Mar 2006 00:15:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 61934 invoked by uid 500); 2 Mar 2006 00:15:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 61925 invoked by uid 99); 2 Mar 2006 00:15:03 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:15:03 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 47A3CDF
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:14:42 +0100 (CET)
Message-ID: <2086709098.1141258482290.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:14:42 +0100 (CET)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment: DF2.patch

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.patch, DF2.patch, DFpatch.txt
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:16:17 2006
Return-Path: 
 <hadoop-dev-return-287-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4576 invoked from network); 2 Mar 2006 00:16:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:16:17 -0000
Received: (qmail 65722 invoked by uid 500); 2 Mar 2006 00:17:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65664 invoked by uid 500); 2 Mar 2006 00:17:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65655 invoked by uid 99); 2 Mar 2006 00:17:03 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:17:01 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8E235DD
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:16:40 +0100 (CET)
Message-ID: <1231319412.1141258600580.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:16:40 +0100 (CET)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment: DF.java

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.java, DF.patch, DF2.patch, DFpatch.txt
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:30:17 2006
Return-Path: 
 <hadoop-dev-return-288-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9860 invoked from network); 2 Mar 2006 00:30:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:30:17 -0000
Received: (qmail 88490 invoked by uid 500); 2 Mar 2006 00:31:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88469 invoked by uid 500); 2 Mar 2006 00:31:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88460 invoked by uid 99); 2 Mar 2006 00:31:04 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:31:02 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E7CD9DD
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:30:41 +0100 (CET)
Message-ID: <1355677599.1141259441947.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:30:41 +0100 (CET)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-62) can't get environment variables from
 HADOOP_CONF_DIR
In-Reply-To: <57329824.1141257104720.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-62?page=comments#action_12368402 ] 

Doug Cutting commented on HADOOP-62:
------------------------------------

Shouldn't we also make similar changes in the other scripts that source hadoop-env.sh?

Also, wouldn't it be cleaner to assign & default HADOOP_CONF_DIR in a separate line, rather than as a side-effect the first time its used?

Finally, why kill the comment about CLASSPATH?


> can't get environment variables from HADOOP_CONF_DIR
> ----------------------------------------------------
>
>          Key: HADOOP-62
>          URL: http://issues.apache.org/jira/browse/HADOOP-62
>      Project: Hadoop
>         Type: Bug
>   Components: conf
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>  Attachments: conf_dir.patch
>
> The bin/hadoop script doesn't use the HADOOP_CONF_DIR variable to find hadoop-env.sh.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:34:18 2006
Return-Path: 
 <hadoop-dev-return-289-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10639 invoked from network); 2 Mar 2006 00:34:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:34:18 -0000
Received: (qmail 91348 invoked by uid 500); 2 Mar 2006 00:35:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91290 invoked by uid 500); 2 Mar 2006 00:35:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91127 invoked by uid 99); 2 Mar 2006 00:35:03 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:35:03 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 51CA6126
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:34:42 +0100 (CET)
Message-ID: <391090899.1141259682332.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:34:42 +0100 (CET)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-62) can't get environment variables from
 HADOOP_CONF_DIR
In-Reply-To: <57329824.1141257104720.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-62?page=comments#action_12368404 ] 

stack@archive.org commented on HADOOP-62:
-----------------------------------------

HADOOP-60 does the above Owen patch and addresses the first Doug comment.

> can't get environment variables from HADOOP_CONF_DIR
> ----------------------------------------------------
>
>          Key: HADOOP-62
>          URL: http://issues.apache.org/jira/browse/HADOOP-62
>      Project: Hadoop
>         Type: Bug
>   Components: conf
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>  Attachments: conf_dir.patch
>
> The bin/hadoop script doesn't use the HADOOP_CONF_DIR variable to find hadoop-env.sh.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:43:17 2006
Return-Path: 
 <hadoop-dev-return-290-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12940 invoked from network); 2 Mar 2006 00:43:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:43:17 -0000
Received: (qmail 7498 invoked by uid 500); 2 Mar 2006 00:44:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7479 invoked by uid 500); 2 Mar 2006 00:44:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7470 invoked by uid 99); 2 Mar 2006 00:44:04 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:44:02 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0782EDD
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:43:42 +0100 (CET)
Message-ID: <621942537.1141260222027.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:43:42 +0100 (CET)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-62) can't get environment variables from
 HADOOP_CONF_DIR
In-Reply-To: <57329824.1141257104720.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-62?page=all ]
     
Doug Cutting resolved HADOOP-62:
--------------------------------

    Fix Version: 0.1
     Resolution: Duplicate

> can't get environment variables from HADOOP_CONF_DIR
> ----------------------------------------------------
>
>          Key: HADOOP-62
>          URL: http://issues.apache.org/jira/browse/HADOOP-62
>      Project: Hadoop
>         Type: Bug
>   Components: conf
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: conf_dir.patch
>
> The bin/hadoop script doesn't use the HADOOP_CONF_DIR variable to find hadoop-env.sh.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:45:47 2006
Return-Path: 
 <hadoop-dev-return-291-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13874 invoked from network); 2 Mar 2006 00:45:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:45:47 -0000
Received: (qmail 9092 invoked by uid 500); 2 Mar 2006 00:46:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8951 invoked by uid 500); 2 Mar 2006 00:46:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8857 invoked by uid 99); 2 Mar 2006 00:46:32 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:46:30 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B2AE2126
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:46:09 +0100 (CET)
Message-ID: <1717389947.1141260369729.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:46:09 +0100 (CET)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-60) Specification of alternate conf.
 directory
In-Reply-To: <1076910929.1141059406460.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-60?page=comments#action_12368408 ] 

Doug Cutting commented on HADOOP-60:
------------------------------------

I should have committed this yesterday, before I made a bunch of other changes to these scripts.  Now it no longer applies!

Michael, can you please regenerate this against the current sources?  Thanks!

> Specification of alternate conf. directory
> ------------------------------------------
>
>          Key: HADOOP-60
>          URL: http://issues.apache.org/jira/browse/HADOOP-60
>      Project: Hadoop
>         Type: Improvement
>     Reporter: stack@archive.org
>     Priority: Minor
>  Attachments: HADOOP_CONF_DIR.patch
>
> Currently, hadoop configuration must be done by making edits and addition to ${HADOOP_HOME}/conf.  Allowing specification of an alternate configuration directory will allow keeping configuration and binary distinct.  Benefits include: Binary can be made read-only; or binary is blanket-updateable with configuration undisturbed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:55:38 2006
Return-Path: 
 <hadoop-dev-return-292-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17892 invoked from network); 2 Mar 2006 00:55:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:55:38 -0000
Received: (qmail 17575 invoked by uid 500); 2 Mar 2006 00:56:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17559 invoked by uid 500); 2 Mar 2006 00:56:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17550 invoked by uid 99); 2 Mar 2006 00:56:24 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:56:22 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 6CEFCDD
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:56:01 +0100 (CET)
Message-ID: <70805053.1141260961444.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:56:01 +0100 (CET)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-62) can't get environment variables from
 HADOOP_CONF_DIR
In-Reply-To: <57329824.1141257104720.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-62?page=comments#action_12368409 ] 

Owen O'Malley commented on HADOOP-62:
-------------------------------------

> Shouldn't we also make similar changes in the other scripts that source hadoop-env.sh?

of course. I just missed the fact that they had similar mistakes in them.

> Also, wouldn't it be cleaner to assign & default HADOOP_CONF_DIR in a separate line, rather than as 
> a side-effect the first time its used?

I was just trying to copy your style, since it was your script.

> Finally, why kill the comment about CLASSPATH?

After the conditional assignment was removed, it seemed like a "add one to x" type comment.
A better comment would be:

# The configuration directory needs to be first in the classpath so that the config files are found by the 
# classloader.


> can't get environment variables from HADOOP_CONF_DIR
> ----------------------------------------------------
>
>          Key: HADOOP-62
>          URL: http://issues.apache.org/jira/browse/HADOOP-62
>      Project: Hadoop
>         Type: Bug
>   Components: conf
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: conf_dir.patch
>
> The bin/hadoop script doesn't use the HADOOP_CONF_DIR variable to find hadoop-env.sh.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 00:57:17 2006
Return-Path: 
 <hadoop-dev-return-293-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18187 invoked from network); 2 Mar 2006 00:57:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 00:57:17 -0000
Received: (qmail 18013 invoked by uid 500); 2 Mar 2006 00:58:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17955 invoked by uid 500); 2 Mar 2006 00:58:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17944 invoked by uid 99); 2 Mar 2006 00:58:04 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 16:58:01 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A03BDDE
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 01:57:40 +0100 (CET)
Message-ID: <639520847.1141261060654.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 01:57:40 +0100 (CET)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-60) Specification of alternate conf.
 directory
In-Reply-To: <1076910929.1141059406460.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-60?page=comments#action_12368411 ] 

Owen O'Malley commented on HADOOP-60:
-------------------------------------

Looking at your patch, I would change the setting line from:
HADOOP_CONF_DIR=${HADOOP_CONF_DIR:=$HADOOP_HOME/conf}
to:
HADOOP_CONF_DIR=${HADOOP_CONF_DIR:-$HADOOP_HOME/conf}
because you don't need the redundant assignment.

You also need to surround all of the file/directory names with quotes so that you support spaces in directory names.



> Specification of alternate conf. directory
> ------------------------------------------
>
>          Key: HADOOP-60
>          URL: http://issues.apache.org/jira/browse/HADOOP-60
>      Project: Hadoop
>         Type: Improvement
>     Reporter: stack@archive.org
>     Priority: Minor
>  Attachments: HADOOP_CONF_DIR.patch
>
> Currently, hadoop configuration must be done by making edits and addition to ${HADOOP_HOME}/conf.  Allowing specification of an alternate configuration directory will allow keeping configuration and binary distinct.  Benefits include: Binary can be made read-only; or binary is blanket-updateable with configuration undisturbed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 01:01:17 2006
Return-Path: 
 <hadoop-dev-return-294-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19665 invoked from network); 2 Mar 2006 01:01:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 01:01:17 -0000
Received: (qmail 20997 invoked by uid 500); 2 Mar 2006 01:02:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20914 invoked by uid 500); 2 Mar 2006 01:02:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20415 invoked by uid 99); 2 Mar 2006 01:02:01 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 17:02:01 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 382EFDE
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 02:01:40 +0100 (CET)
Message-ID: <1552924282.1141261300227.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 02:01:40 +0100 (CET)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-62) can't get environment variables from
 HADOOP_CONF_DIR
In-Reply-To: <57329824.1141257104720.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-62?page=comments#action_12368414 ] 

Doug Cutting commented on HADOOP-62:
------------------------------------

It's not my script, it's *our* script!  Which do you think is the better style?  I don't think I wrote that line anyway...

> can't get environment variables from HADOOP_CONF_DIR
> ----------------------------------------------------
>
>          Key: HADOOP-62
>          URL: http://issues.apache.org/jira/browse/HADOOP-62
>      Project: Hadoop
>         Type: Bug
>   Components: conf
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: conf_dir.patch
>
> The bin/hadoop script doesn't use the HADOOP_CONF_DIR variable to find hadoop-env.sh.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 01:41:17 2006
Return-Path: 
 <hadoop-dev-return-295-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44066 invoked from network); 2 Mar 2006 01:41:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 01:41:17 -0000
Received: (qmail 65922 invoked by uid 500); 2 Mar 2006 01:42:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65906 invoked by uid 500); 2 Mar 2006 01:42:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65897 invoked by uid 99); 2 Mar 2006 01:42:04 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Mar 2006 17:42:01 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A7214DC
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 02:41:40 +0100 (CET)
Message-ID: <1770501576.1141263700653.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 02:41:40 +0100 (CET)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-60) Specification of alternate conf.
 directory
In-Reply-To: <1076910929.1141059406460.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-60?page=all ]

stack@archive.org updated HADOOP-60:
------------------------------------

    Attachment: HADOOP_CONF_DIR-v2.patch

Version of patch that will go against 382230.

Thanks for the feedback Owen.  I integrated your comments into this version of the patch.

> Specification of alternate conf. directory
> ------------------------------------------
>
>          Key: HADOOP-60
>          URL: http://issues.apache.org/jira/browse/HADOOP-60
>      Project: Hadoop
>         Type: Improvement
>     Reporter: stack@archive.org
>     Priority: Minor
>  Attachments: HADOOP_CONF_DIR-v2.patch, HADOOP_CONF_DIR.patch
>
> Currently, hadoop configuration must be done by making edits and addition to ${HADOOP_HOME}/conf.  Allowing specification of an alternate configuration directory will allow keeping configuration and binary distinct.  Benefits include: Binary can be made read-only; or binary is blanket-updateable with configuration undisturbed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 17:40:25 2006
Return-Path: 
 <hadoop-dev-return-296-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26361 invoked from network); 2 Mar 2006 17:40:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 17:40:25 -0000
Received: (qmail 94448 invoked by uid 500); 2 Mar 2006 17:41:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94312 invoked by uid 500); 2 Mar 2006 17:41:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94266 invoked by uid 99); 2 Mar 2006 17:41:03 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 09:41:01 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DC66CDC
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 18:40:39 +0100 (CET)
Message-ID: <455081563.1141321239869.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 18:40:39 +0100 (CET)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-60) Specification of alternate conf.
 directory
In-Reply-To: <1076910929.1141059406460.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-60?page=all ]

stack@archive.org updated HADOOP-60:
------------------------------------

    Attachment: HADOOP_CONF_DIR-v3.patch

Version 3 is version 2 plus edit of hadoop-env.template modifying defaults for HADOOP_SSH_OPTS.

> Specification of alternate conf. directory
> ------------------------------------------
>
>          Key: HADOOP-60
>          URL: http://issues.apache.org/jira/browse/HADOOP-60
>      Project: Hadoop
>         Type: Improvement
>     Reporter: stack@archive.org
>     Priority: Minor
>  Attachments: HADOOP_CONF_DIR-v2.patch, HADOOP_CONF_DIR-v3.patch, HADOOP_CONF_DIR.patch
>
> Currently, hadoop configuration must be done by making edits and addition to ${HADOOP_HOME}/conf.  Allowing specification of an alternate configuration directory will allow keeping configuration and binary distinct.  Benefits include: Binary can be made read-only; or binary is blanket-updateable with configuration undisturbed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 18:52:21 2006
Return-Path: 
 <hadoop-dev-return-297-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62875 invoked from network); 2 Mar 2006 18:52:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 18:52:21 -0000
Received: (qmail 5152 invoked by uid 500); 2 Mar 2006 18:53:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5135 invoked by uid 500); 2 Mar 2006 18:53:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5126 invoked by uid 99); 2 Mar 2006 18:53:07 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 10:53:07 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A3504DC
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 19:52:45 +0100 (CET)
Message-ID: <993935421.1141325565236.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 19:52:45 +0100 (CET)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-60) Specification of alternate conf.
 directory
In-Reply-To: <1076910929.1141059406460.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-60?page=comments#action_12368567 ] 

Doug Cutting commented on HADOOP-60:
------------------------------------

I just committed this.  I had to add a few more quotes to get things to work correctly with spaces in directory names, removed a spurious variable setting on the 'nohup' line of hadoop-daemon.sh, and updated a comment.


> Specification of alternate conf. directory
> ------------------------------------------
>
>          Key: HADOOP-60
>          URL: http://issues.apache.org/jira/browse/HADOOP-60
>      Project: Hadoop
>         Type: Improvement
>     Reporter: stack@archive.org
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: HADOOP_CONF_DIR-v2.patch, HADOOP_CONF_DIR-v3.patch, HADOOP_CONF_DIR.patch
>
> Currently, hadoop configuration must be done by making edits and addition to ${HADOOP_HOME}/conf.  Allowing specification of an alternate configuration directory will allow keeping configuration and binary distinct.  Benefits include: Binary can be made read-only; or binary is blanket-updateable with configuration undisturbed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 18:52:25 2006
Return-Path: 
 <hadoop-dev-return-298-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62904 invoked from network); 2 Mar 2006 18:52:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 18:52:25 -0000
Received: (qmail 5249 invoked by uid 500); 2 Mar 2006 18:53:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5227 invoked by uid 500); 2 Mar 2006 18:53:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5217 invoked by uid 99); 2 Mar 2006 18:53:11 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 10:53:09 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 97799DE
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 19:52:47 +0100 (CET)
Message-ID: <70127570.1141325567618.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 19:52:47 +0100 (CET)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-60) Specification of alternate conf.
 directory
In-Reply-To: <1076910929.1141059406460.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-60?page=all ]
     
Doug Cutting resolved HADOOP-60:
--------------------------------

    Fix Version: 0.1
     Resolution: Fixed

Fixed!

> Specification of alternate conf. directory
> ------------------------------------------
>
>          Key: HADOOP-60
>          URL: http://issues.apache.org/jira/browse/HADOOP-60
>      Project: Hadoop
>         Type: Improvement
>     Reporter: stack@archive.org
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: HADOOP_CONF_DIR-v2.patch, HADOOP_CONF_DIR-v3.patch, HADOOP_CONF_DIR.patch
>
> Currently, hadoop configuration must be done by making edits and addition to ${HADOOP_HOME}/conf.  Allowing specification of an alternate configuration directory will allow keeping configuration and binary distinct.  Benefits include: Binary can be made read-only; or binary is blanket-updateable with configuration undisturbed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 19:46:19 2006
Return-Path: 
 <hadoop-dev-return-299-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90019 invoked from network); 2 Mar 2006 19:46:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 19:46:19 -0000
Received: (qmail 97737 invoked by uid 500); 2 Mar 2006 19:47:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 97653 invoked by uid 500); 2 Mar 2006 19:47:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 97634 invoked by uid 99); 2 Mar 2006 19:47:05 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 11:47:04 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CEA04182
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 20:46:43 +0100 (CET)
Message-ID: <69567632.1141328803844.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 20:46:43 +0100 (CET)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment:     (was: DFpatch.txt)

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.java, DF.patch, DF2.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 20:02:17 2006
Return-Path: 
 <hadoop-dev-return-300-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96492 invoked from network); 2 Mar 2006 20:02:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 20:02:17 -0000
Received: (qmail 29131 invoked by uid 500); 2 Mar 2006 20:03:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29114 invoked by uid 500); 2 Mar 2006 20:03:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29094 invoked by uid 99); 2 Mar 2006 20:03:03 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 12:03:02 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 02499E1
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 21:02:42 +0100 (CET)
Message-ID: <912448569.1141329762003.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 21:02:42 +0100 (CET)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment:     (was: DF.java)

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.patch, DF2.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 20:10:24 2006
Return-Path: 
 <hadoop-dev-return-301-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99988 invoked from network); 2 Mar 2006 20:10:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 20:10:24 -0000
Received: (qmail 43482 invoked by uid 500); 2 Mar 2006 20:11:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43461 invoked by uid 500); 2 Mar 2006 20:11:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43452 invoked by uid 99); 2 Mar 2006 20:11:10 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 12:11:07 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D7221182
	for <hadoop-dev@lucene.apache.org>; Thu,  2 Mar 2006 21:10:46 +0100 (CET)
Message-ID: <365936010.1141330246879.JavaMail.jira@ajax.apache.org>
Date: Thu, 2 Mar 2006 21:10:46 +0100 (CET)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment: DF3.patch
                DF.java

Done some code reduction.
DF3.patch is the latest version now.

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.java, DF.patch, DF2.patch, DF3.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  2 21:05:11 2006
Return-Path: 
 <hadoop-dev-return-302-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30702 invoked from network); 2 Mar 2006 21:05:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 21:05:11 -0000
Received: (qmail 16986 invoked by uid 500); 2 Mar 2006 21:05:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16969 invoked by uid 500); 2 Mar 2006 21:05:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16960 invoked by uid 99); 2 Mar 2006 21:05:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 13:05:58 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 13:05:57 -0800
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k22L5oZ20913
	for <hadoop-dev@lucene.apache.org>; Thu, 2 Mar 2006 15:05:51 -0600
Message-ID: <44075E24.2050702@getopt.org>
Date: Thu, 02 Mar 2006 22:05:40 +0100
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: svn commit: r382511 - in /lucene/hadoop/trunk/lib:
 lucene-core-1.9-final.jar
 lucene-core-1.9.1.jar
References: <20060302205753.28096.qmail@minotaur.apache.org>
In-Reply-To: <20060302205753.28096.qmail@minotaur.apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

cutting@apache.org wrote:
> Author: cutting
> Date: Thu Mar  2 12:57:51 2006
> New Revision: 382511
>
> URL: http://svn.apache.org/viewcvs?rev=382511&view=rev
> Log:
> Upgrade to Lucene 1.9.1.
>   

I wonder why do we need Lucene in hadoop... the only dependency I 
noticed is on the PriorityQueue. Perhaps it would be easier just to copy 
this class into hadoop?

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Thu Mar  2 23:10:18 2006
Return-Path: 
 <hadoop-dev-return-303-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78826 invoked from network); 2 Mar 2006 23:10:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 2 Mar 2006 23:10:18 -0000
Received: (qmail 92776 invoked by uid 500); 2 Mar 2006 23:11:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92757 invoked by uid 500); 2 Mar 2006 23:11:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92748 invoked by uid 99); 2 Mar 2006 23:11:04 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 15:11:03 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E1508DC
	for <hadoop-dev@lucene.apache.org>; Fri,  3 Mar 2006 00:10:39 +0100 (CET)
Message-ID: <1611512596.1141341039593.JavaMail.jira@ajax.apache.org>
Date: Fri, 3 Mar 2006 00:10:39 +0100 (CET)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-16) RPC call times out while indexing map
 task is computing splits
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-16?page=all ]
     
Doug Cutting resolved HADOOP-16:
--------------------------------

    Resolution: Fixed

I applied Mike's patch, with a few small changes, fixing an NPE and ArrayOutOfBounds in dfs.

There's still a bug where, with mapred.tasktracker.tasks.maximum=2, only a single map and a single reduce are running on each node.  I believe the intent is that there should be up to two of each related to a single job, so that the reduce tasks can be copying data while the maps are still running.

> RPC call times out while indexing map task is computing splits
> --------------------------------------------------------------
>
>          Key: HADOOP-16
>          URL: http://issues.apache.org/jira/browse/HADOOP-16
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>  Environment: MapReduce multi-computer crawl environment: 11 machines (1 master with JobTracker/NameNode, 10 slaves with TaskTrackers/DataNodes)
>     Reporter: Chris Schneider
>     Assignee: Mike Cafarella
>      Fix For: 0.1
>  Attachments: patch.16, patch_h16.v0
>
> We've been using Nutch 0.8 (MapReduce) to perform some internet crawling. Things seemed to be going well until...
> 060129 222409 Lost tracker 'tracker_56288'
> 060129 222409 Task 'task_m_10gs5f' has been lost.
> 060129 222409 Task 'task_m_10qhzr' has been lost.
>    ........
>    ........
> 060129 222409 Task 'task_r_zggbwu' has been lost.
> 060129 222409 Task 'task_r_zh8dao' has been lost.
> 060129 222455 Server handler 8 on 8010 caught: java.net.SocketException: Socket closed
> java.net.SocketException: Socket closed
>         at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:99)
>         at java.net.SocketOutputStream.write(SocketOutputStream.java:136)
>         at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)
>         at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)
>         at java.io.DataOutputStream.flush(DataOutputStream.java:106)
>         at org.apache.nutch.ipc.Server$Handler.run(Server.java:216)
> 060129 222455 Adding task 'task_m_cia5po' to set for tracker 'tracker_56288'
> 060129 223711 Adding task 'task_m_ffv59i' to set for tracker 'tracker_25647'
> I'm hoping that someone could explain why task_m_cia5po got added to tracker_56288 after this tracker was lost.
> The Crawl .main process died with the following output:
> 060129 221129 Indexer: adding segment: /user/crawler/crawl-20060129091444/segments/20060129200246
> Exception in thread "main" java.io.IOException: timed out waiting for response
>     at org.apache.nutch.ipc.Client.call(Client.java:296)
>     at org.apache.nutch.ipc.RPC$Invoker.invoke(RPC.java:127)
>     at $Proxy1.submitJob(Unknown Source)
>     at org.apache.nutch.mapred.JobClient.submitJob(JobClient.java:259)
>     at org.apache.nutch.mapred.JobClient.runJob(JobClient.java:288)
>     at org.apache.nutch.indexer.Indexer.index(Indexer.java:263)
>     at org.apache.nutch.crawl.Crawl.main(Crawl.java:127)
> However, it definitely seems as if the JobTracker is still waiting for the job to finish (no failed jobs).
> Doug Cutting's response:
> The bug here is that the RPC call times out while the map task is computing splits.  The fix is that the job tracker should not compute splits until after it has returned from the submitJob RPC.  Please submit a bug in Jira to help remind us to fix this.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar  3 01:39:26 2006
Return-Path: 
 <hadoop-dev-return-304-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35563 invoked from network); 3 Mar 2006 01:39:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Mar 2006 01:39:26 -0000
Received: (qmail 38700 invoked by uid 500); 3 Mar 2006 01:40:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38684 invoked by uid 500); 3 Mar 2006 01:40:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38675 invoked by uid 99); 3 Mar 2006 01:40:12 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Mar 2006 17:40:10 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4DBA0DC
	for <hadoop-dev@lucene.apache.org>; Fri,  3 Mar 2006 02:39:44 +0100 (CET)
Message-ID: <1306920605.1141349984316.JavaMail.jira@ajax.apache.org>
Date: Fri, 3 Mar 2006 02:39:44 +0100 (CET)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-63) problem with webapp when start a
 jobtracker
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

problem with webapp when start a jobtracker
-------------------------------------------

         Key: HADOOP-63
         URL: http://issues.apache.org/jira/browse/HADOOP-63
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Versions: 0.1    
 Environment: RHL4
    Reporter: Hairong Kuang
    Priority: Minor


there exist two issues with starting up webapp

1. webapp is not be able to be loaded from a jar file.
2. web.xml can not be parsed properly using java 1.4

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar  3 22:22:15 2006
Return-Path: 
 <hadoop-dev-return-305-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76667 invoked from network); 3 Mar 2006 22:22:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 3 Mar 2006 22:22:15 -0000
Received: (qmail 34650 invoked by uid 500); 3 Mar 2006 22:23:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34622 invoked by uid 500); 3 Mar 2006 22:23:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34613 invoked by uid 99); 3 Mar 2006 22:23:01 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Mar 2006 14:23:01 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4C63ADD
	for <hadoop-dev@lucene.apache.org>; Fri,  3 Mar 2006 23:22:40 +0100 (CET)
Message-ID: <213468370.1141424560310.JavaMail.jira@ajax.apache.org>
Date: Fri, 3 Mar 2006 23:22:40 +0100 (CET)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-2) Reused Keys and Values fail with a
 Combiner
In-Reply-To: <361890767.1139000103581.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-2?page=all ]

Sameer Paranjpye reassigned HADOOP-2:
-------------------------------------

    Assign To: Owen O'Malley

> Reused Keys and Values fail with a Combiner
> -------------------------------------------
>
>          Key: HADOOP-2
>          URL: http://issues.apache.org/jira/browse/HADOOP-2
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley

>
> If the map function reuses the key or value by destructively modifying it after the output.collect(key,value) call and your application uses a combiner, the data is corrupted by having lots of instances with the last key or value.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar  4 05:26:26 2006
Return-Path: 
 <hadoop-dev-return-306-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39501 invoked from network); 4 Mar 2006 05:26:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 4 Mar 2006 05:26:26 -0000
Received: (qmail 69390 invoked by uid 500); 4 Mar 2006 05:27:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69275 invoked by uid 500); 4 Mar 2006 05:27:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69252 invoked by uid 99); 4 Mar 2006 05:27:11 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Mar 2006 21:27:10 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3CFCE126
	for <hadoop-dev@lucene.apache.org>; Sat,  4 Mar 2006 06:26:49 +0100 (CET)
Message-ID: <1525618532.1141450009247.JavaMail.jira@ajax.apache.org>
Date: Sat, 4 Mar 2006 06:26:49 +0100 (CET)
From: "Rod Taylor (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-18) Crash with multiple temp directories
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-18?page=comments#action_12368835 ] 

Rod Taylor commented on HADOOP-18:
----------------------------------

Finally figured it out. One temp directory was filling up (different sizes) and the fetch was aborting BUT I didn't see this in the logs for the longest time.

The patch in NUTCH-143 helped track down the issue because it caused the error to be noticed be the scripts driving the code in a location close to where the error took place rather than several steps (possibly many hours) later..

Please close this bug.

> Crash with multiple temp directories
> ------------------------------------
>
>          Key: HADOOP-18
>          URL: http://issues.apache.org/jira/browse/HADOOP-18
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Rod Taylor
>     Priority: Critical

>
> A brief read of the code indicated it may be possible to use multiple local directories using something like the below:
>   <property>
>     <name>mapred.local.dir</name>
>     <value>/local,/local1,/local2</value>
>     <description>The local directory where MapReduce stores intermediate
>     data files.
>     </description>
>   </property>
> This failed with the below exception during either the generate or update phase (not entirely sure which).
> java.lang.ArrayIndexOutOfBoundsException
>         at java.util.zip.CRC32.update(CRC32.java:51)
>         at org.apache.nutch.fs.NFSDataInputStream$Checker.read(NFSDataInputStream.java:92)
>         at org.apache.nutch.fs.NFSDataInputStream$PositionCache.read(NFSDataInputStream.java:156)
>         at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
>         at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
>         at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
>         at java.io.DataInputStream.readFully(DataInputStream.java:176)
>         at org.apache.nutch.io.DataOutputBuffer$Buffer.write(DataOutputBuffer.java:55)
>         at org.apache.nutch.io.DataOutputBuffer.write(DataOutputBuffer.java:89)
>         at org.apache.nutch.io.SequenceFile$Reader.next(SequenceFile.java:378)
>         at org.apache.nutch.io.SequenceFile$Reader.next(SequenceFile.java:301)
>         at org.apache.nutch.io.SequenceFile$Reader.next(SequenceFile.java:323)
>         at org.apache.nutch.mapred.SequenceFileRecordReader.next(SequenceFileRecordReader.java:60)
>         at org.apache.nutch.segment.SegmentReader$InputFormat$1.next(SegmentReader.java:80)
>         at org.apache.nutch.mapred.MapTask$2.next(MapTask.java:106)
>         at org.apache.nutch.mapred.MapRunner.run(MapRunner.java:48)
>         at org.apache.nutch.mapred.MapTask.run(MapTask.java:116)
>         at org.apache.nutch.mapred.TaskTracker$Child.main(TaskTracker.java:604)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Mar  5 00:04:18 2006
Return-Path: 
 <hadoop-dev-return-307-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59234 invoked from network); 5 Mar 2006 00:04:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Mar 2006 00:04:18 -0000
Received: (qmail 64722 invoked by uid 500); 5 Mar 2006 00:05:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64700 invoked by uid 500); 5 Mar 2006 00:05:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64691 invoked by uid 99); 5 Mar 2006 00:05:04 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Mar 2006 16:05:02 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C045CDC
	for <hadoop-dev@lucene.apache.org>; Sun,  5 Mar 2006 01:04:41 +0100 (CET)
Message-ID: <886065131.1141517081785.JavaMail.jira@ajax.apache.org>
Date: Sun, 5 Mar 2006 01:04:41 +0100 (CET)
From: "Mike Cafarella (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-26) DFS node choice doesn't take available
 space into account effectively
In-Reply-To: <1437738270.1139335557543.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-26?page=all ]

Mike Cafarella updated HADOOP-26:
---------------------------------

    Attachment: patch.targetchoice


  Patch for this problem.


> DFS node choice doesn't take available space into account effectively
> ---------------------------------------------------------------------
>
>          Key: HADOOP-26
>          URL: http://issues.apache.org/jira/browse/HADOOP-26
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Mike Cafarella
>     Assignee: Mike Cafarella
>  Attachments: patch.targetchoice
>
>   We used to have node-allocation be sensitive to available disk space.  It turned out that
> this was a little accident-prone and hard to debug on then-available machines, so I removed it.
>   DFS is mature enough now that this needs to come back and work properly.  A node with less
> than X bytes should never accept a new block for allocation.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Mar  5 01:03:49 2006
Return-Path: 
 <hadoop-dev-return-308-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 75556 invoked from network); 5 Mar 2006 01:03:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 5 Mar 2006 01:03:49 -0000
Received: (qmail 11875 invoked by uid 500); 5 Mar 2006 01:04:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11818 invoked by uid 500); 5 Mar 2006 01:04:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11809 invoked by uid 99); 5 Mar 2006 01:04:36 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Mar 2006 17:04:34 -0800
Received: from ajax.apache.org (ajax.apache.org [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CB582DD
	for <hadoop-dev@lucene.apache.org>; Sun,  5 Mar 2006 02:04:13 +0100 (CET)
Message-ID: <8507369.1141520653830.JavaMail.jira@ajax.apache.org>
Date: Sun, 5 Mar 2006 02:04:13 +0100 (CET)
From: "Mike Cafarella (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-26) DFS node choice doesn't take available
 space into account effectively
In-Reply-To: <1437738270.1139335557543.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-26?page=all ]
     
Mike Cafarella closed HADOOP-26:
--------------------------------

    Resolution: Fixed

Tested and fixed, in revision 383247.

> DFS node choice doesn't take available space into account effectively
> ---------------------------------------------------------------------
>
>          Key: HADOOP-26
>          URL: http://issues.apache.org/jira/browse/HADOOP-26
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Mike Cafarella
>     Assignee: Mike Cafarella
>  Attachments: patch.targetchoice
>
>   We used to have node-allocation be sensitive to available disk space.  It turned out that
> this was a little accident-prone and hard to debug on then-available machines, so I removed it.
>   DFS is mature enough now that this needs to come back and work properly.  A node with less
> than X bytes should never accept a new block for allocation.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar  6 22:32:26 2006
Return-Path: 
 <hadoop-dev-return-309-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12971 invoked from network); 6 Mar 2006 22:32:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Mar 2006 22:32:26 -0000
Received: (qmail 20453 invoked by uid 500); 6 Mar 2006 22:32:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20433 invoked by uid 500); 6 Mar 2006 22:32:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20424 invoked by uid 99); 6 Mar 2006 22:32:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 14:32:25 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 14:32:24 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id BF0AA6ACA9
	for <hadoop-dev@lucene.apache.org>; Mon,  6 Mar 2006 22:32:03 +0000 (GMT)
Message-ID: <351541402.1141684323779.JavaMail.jira@ajax>
Date: Mon, 6 Mar 2006 22:32:03 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-18) Crash with multiple temp directories
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-18?page=all ]
     
Doug Cutting resolved HADOOP-18:
--------------------------------

    Resolution: Invalid

Resoving at Rod's request.

> Crash with multiple temp directories
> ------------------------------------
>
>          Key: HADOOP-18
>          URL: http://issues.apache.org/jira/browse/HADOOP-18
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Rod Taylor
>     Priority: Critical

>
> A brief read of the code indicated it may be possible to use multiple local directories using something like the below:
>   <property>
>     <name>mapred.local.dir</name>
>     <value>/local,/local1,/local2</value>
>     <description>The local directory where MapReduce stores intermediate
>     data files.
>     </description>
>   </property>
> This failed with the below exception during either the generate or update phase (not entirely sure which).
> java.lang.ArrayIndexOutOfBoundsException
>         at java.util.zip.CRC32.update(CRC32.java:51)
>         at org.apache.nutch.fs.NFSDataInputStream$Checker.read(NFSDataInputStream.java:92)
>         at org.apache.nutch.fs.NFSDataInputStream$PositionCache.read(NFSDataInputStream.java:156)
>         at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
>         at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
>         at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
>         at java.io.DataInputStream.readFully(DataInputStream.java:176)
>         at org.apache.nutch.io.DataOutputBuffer$Buffer.write(DataOutputBuffer.java:55)
>         at org.apache.nutch.io.DataOutputBuffer.write(DataOutputBuffer.java:89)
>         at org.apache.nutch.io.SequenceFile$Reader.next(SequenceFile.java:378)
>         at org.apache.nutch.io.SequenceFile$Reader.next(SequenceFile.java:301)
>         at org.apache.nutch.io.SequenceFile$Reader.next(SequenceFile.java:323)
>         at org.apache.nutch.mapred.SequenceFileRecordReader.next(SequenceFileRecordReader.java:60)
>         at org.apache.nutch.segment.SegmentReader$InputFormat$1.next(SegmentReader.java:80)
>         at org.apache.nutch.mapred.MapTask$2.next(MapTask.java:106)
>         at org.apache.nutch.mapred.MapRunner.run(MapRunner.java:48)
>         at org.apache.nutch.mapred.MapTask.run(MapTask.java:116)
>         at org.apache.nutch.mapred.TaskTracker$Child.main(TaskTracker.java:604)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar  6 23:06:26 2006
Return-Path: 
 <hadoop-dev-return-310-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33193 invoked from network); 6 Mar 2006 23:06:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Mar 2006 23:06:26 -0000
Received: (qmail 65593 invoked by uid 500); 6 Mar 2006 23:06:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65495 invoked by uid 500); 6 Mar 2006 23:06:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65411 invoked by uid 99); 6 Mar 2006 23:06:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 15:06:23 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 15:06:23 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 1BCDFD49FC
	for <hadoop-dev@lucene.apache.org>; Mon,  6 Mar 2006 23:06:02 +0000 (GMT)
Message-ID: <96561968.1141686362086.JavaMail.jira@ajax>
Date: Mon, 6 Mar 2006 23:06:02 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-64) DataNode should be capable of managing
 multiple volumes
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DataNode should be capable of managing multiple volumes
-------------------------------------------------------

         Key: HADOOP-64
         URL: http://issues.apache.org/jira/browse/HADOOP-64
     Project: Hadoop
        Type: Improvement
  Components: dfs  
    Versions: 0.2    
    Reporter: Sameer Paranjpye
    Priority: Minor
     Fix For: 0.2


The dfs Datanode can only store data on a single filesystem volume. When a node runs its disks JBOD this means running a Datanode per disk on the machine. While the scheme works reasonably well on small clusters, on larger installations (several 100 nodes) it implies a very large number of Datanodes with associated management overhead in the Namenode.

The Datanod should be enhanced to be able to handle multiple volumes on a single machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar  6 23:14:24 2006
Return-Path: 
 <hadoop-dev-return-311-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35995 invoked from network); 6 Mar 2006 23:14:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Mar 2006 23:14:24 -0000
Received: (qmail 73619 invoked by uid 500); 6 Mar 2006 23:14:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73603 invoked by uid 500); 6 Mar 2006 23:14:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73594 invoked by uid 99); 6 Mar 2006 23:14:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 15:14:23 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 15:14:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id EFABAD49F8
	for <hadoop-dev@lucene.apache.org>; Mon,  6 Mar 2006 23:14:01 +0000 (GMT)
Message-ID: <554934043.1141686841971.JavaMail.jira@ajax>
Date: Mon, 6 Mar 2006 23:14:01 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-65) add a record I/O framework to hadoop
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

add a record I/O framework to hadoop
------------------------------------

         Key: HADOOP-65
         URL: http://issues.apache.org/jira/browse/HADOOP-65
     Project: Hadoop
        Type: New Feature
  Components: io, ipc  
    Versions: 0.2    
    Reporter: Sameer Paranjpye
    Priority: Minor
     Fix For: 0.2


Hadoop could benefit greatly from a simple record I/O framework that enables the specification of simple record types and enables the generation of code for serialization/deserialization in multiple target languages. The framework would handle a small well understood set of primitive types and simple compositions of these (structs, vectors, maps) . It would be possible to leverage this framework to express I/O in MapReduce computations and to use this as the basis for Hadoops RPC implementation. This would make interfacing with code in languages other than Java much easier.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar  6 23:57:51 2006
Return-Path: 
 <hadoop-dev-return-312-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54564 invoked from network); 6 Mar 2006 23:57:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 6 Mar 2006 23:57:51 -0000
Received: (qmail 13921 invoked by uid 500); 6 Mar 2006 23:57:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13903 invoked by uid 500); 6 Mar 2006 23:57:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13891 invoked by uid 99); 6 Mar 2006 23:57:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 15:57:50 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 15:57:50 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 322F1D49F8
	for <hadoop-dev@lucene.apache.org>; Mon,  6 Mar 2006 23:57:29 +0000 (GMT)
Message-ID: <549957597.1141689449195.JavaMail.jira@ajax>
Date: Mon, 6 Mar 2006 23:57:29 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-66) dfs client writes all data for a chunk
 to /tmp
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

dfs client writes all data for a chunk to /tmp
----------------------------------------------

         Key: HADOOP-66
         URL: http://issues.apache.org/jira/browse/HADOOP-66
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Versions: 0.1    
    Reporter: Sameer Paranjpye
     Fix For: 0.1


The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 00:26:51 2006
Return-Path: 
 <hadoop-dev-return-313-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67946 invoked from network); 7 Mar 2006 00:26:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 00:26:51 -0000
Received: (qmail 50882 invoked by uid 500); 7 Mar 2006 00:26:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50861 invoked by uid 500); 7 Mar 2006 00:26:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50851 invoked by uid 99); 7 Mar 2006 00:26:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 16:26:50 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 16:26:50 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 782E3D49F8
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 00:26:29 +0000 (GMT)
Message-ID: <936783106.1141691189463.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 00:26:29 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-66) dfs client writes all data for a
 chunk to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-66?page=comments#action_12369110 ] 

Doug Cutting commented on HADOOP-66:
------------------------------------

It looks to me like the temp file is only in fact used when the connection to the datanode fails.  Normally the block is streamed to the datanode as it is written.  But if the connection to the datanode fails then an application exception is not thrown, instead the temp file is used to recover, by reconnecting to a datanode and trying to write the block again.

Data is bufferred in RAM first, just in chunks much smaller than the block.  I don't think we should buffer the entire block in RAM, as this would, e.g., prohibit applications which write lots of files in parallel.

We could get rid of the temp file and simply throw an application exception when we lose a connection to a datanode while writing.  What is the objection to the temp file?

> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1

>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 04:53:03 2006
Return-Path: 
 <hadoop-dev-return-314-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72378 invoked from network); 7 Mar 2006 04:53:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 04:53:03 -0000
Received: (qmail 94627 invoked by uid 500); 7 Mar 2006 04:53:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94510 invoked by uid 500); 7 Mar 2006 04:53:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94341 invoked by uid 99); 7 Mar 2006 04:53:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 20:53:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Mar 2006 20:53:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id EDAA16ACAB
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 04:52:39 +0000 (GMT)
Message-ID: <1501471532.1141707159970.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 04:52:39 +0000 (GMT)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-66) dfs client writes all data for a
 chunk to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-66?page=comments#action_12369159 ] 

eric baldeschwieler commented on HADOOP-66:
-------------------------------------------

So the problem with /tmp is that this can fill up and cause failures.  This is very config / install specific.  We almost never use /tmp because it gets blown out by something sometime, always when you least expect it.  Maybe we should throw by default and provide some config to do something else, such as provide a a file path for temp files?  This could be in /tmp if you chose, or map reduce could default to its temp directory where it is storing everything else.

Performance is clearly not an issue if this is truly an exceptional case.

> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1

>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 18:37:59 2006
Return-Path: 
 <hadoop-dev-return-315-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39481 invoked from network); 7 Mar 2006 18:37:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 18:37:59 -0000
Received: (qmail 87256 invoked by uid 500); 7 Mar 2006 18:37:59 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87230 invoked by uid 500); 7 Mar 2006 18:37:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87221 invoked by uid 99); 7 Mar 2006 18:37:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 10:37:58 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 10:37:57 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 9C361144464
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 19:29:55 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 10786-06 for <hadoop-dev@lucene.apache.org>;
	Tue, 7 Mar 2006 19:29:55 +0100 (CET)
Received: from [192.168.200.61] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id 78199144463
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 19:29:55 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v746.2)
Content-Transfer-Encoding: 7bit
Message-Id: <76202F75-7B65-407F-A9B7-5BC92B116A7C@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Marko Bauhardt <mb@media-style.com>
Subject: hidden classes in package mapred and dfs
Date: Tue, 7 Mar 2006 19:33:37 +0100
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi all,
i noticed that some classes like

+ DataNodeInfo
+ DFSClient
+ DistributedFileSystem (incl. method getClient())
+ JobInProgress
+ JobProfile
+ JobStatus
+ JobTrackerInfoServer
+ TaskTrackerStatus

are hidden for classes outside the package mapred and dfs. Exists a  
specified reason why this classes are hidden?

Marko


From MAILER-DAEMON Tue Mar  7 18:40:51 2006
Return-Path: 
 <hadoop-dev-return-316-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41534 invoked from network); 7 Mar 2006 18:40:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 18:40:51 -0000
Received: (qmail 91573 invoked by uid 500); 7 Mar 2006 18:40:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91553 invoked by uid 500); 7 Mar 2006 18:40:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91544 invoked by uid 99); 7 Mar 2006 18:40:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 10:40:50 -0800
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=NO_REAL_NAME,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of barry.kaplan@gmail.com
 designates 64.233.182.193 as permitted sender)
Received: from [64.233.182.193] (HELO nproxy.gmail.com) (64.233.182.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 10:40:50 -0800
Received: by nproxy.gmail.com with SMTP id y38so3794nfb
        for <hadoop-dev@lucene.apache.org>;
 Tue, 07 Mar 2006 10:40:28 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=GHKvmcHlQMDkgOVmZpyd/hfOQU00uYQnTNquIxlJOUxjBR03xW3r3L7Haws5taS/JdT/xFAMA47P51jxQqeBQVynberUxVhF2ItS1ApWCRSmrtqe475MPnzXH8cmv8mS3PMKVECMhFMlCfnFqA/W8BR9wt24fi0uUwTYghG1Js0=
Received: by 10.48.47.1 with SMTP id u1mr3094122nfu;
        Tue, 07 Mar 2006 10:40:28 -0800 (PST)
Received: by 10.49.30.5 with HTTP; Tue, 7 Mar 2006 10:40:28 -0800 (PST)
Message-ID: <cac652840603071040p5544fb87k577a31a821429227@mail.gmail.com>
Date: Tue, 7 Mar 2006 10:40:28 -0800
From: barry.kaplan@gmail.com
To: hadoop-dev@lucene.apache.org
Subject: Question about the "N"DFSClient
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I am going through my code and changing over from NDFS to DFS since I
was using Nutch primarily for the DFS. I noticed that the protection
of the DFSClient has changed along with things like DFSFile and
DataNodeInfo.Was the reason solely to make the JavaDoc simpler?

I was using those objects to have a jsp rendered status check, so
having them available would be nice.

-Barry

From MAILER-DAEMON Tue Mar  7 18:44:02 2006
Return-Path: 
 <hadoop-dev-return-317-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43751 invoked from network); 7 Mar 2006 18:44:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 18:44:02 -0000
Received: (qmail 5918 invoked by uid 500); 7 Mar 2006 18:44:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5902 invoked by uid 500); 7 Mar 2006 18:44:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5893 invoked by uid 99); 7 Mar 2006 18:44:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 10:44:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 10:44:00 -0800
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k27IhcO8029188
	for <hadoop-dev@lucene.apache.org>; Tue, 7 Mar 2006 13:43:38 -0500
X-ORBL: [69.228.231.148]
Received: from [192.168.168.15] (adsl-69-228-231-148.dsl.pltn13.pacbell.net
 [69.228.231.148])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k27IhccW100334;
	Tue, 7 Mar 2006 13:43:38 -0500
Message-ID: <440DD459.9030005@apache.org>
Date: Tue, 07 Mar 2006 10:43:37 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: hidden classes in package mapred and dfs
References: <76202F75-7B65-407F-A9B7-5BC92B116A7C@media-style.com>
In-Reply-To: <76202F75-7B65-407F-A9B7-5BC92B116A7C@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Marko Bauhardt wrote:
> Hi all,
> i noticed that some classes like
> 
> + DataNodeInfo
> + DFSClient
> + DistributedFileSystem (incl. method getClient())
> + JobInProgress
> + JobProfile
> + JobStatus
> + JobTrackerInfoServer
> + TaskTrackerStatus
> 
> are hidden for classes outside the package mapred and dfs. Exists a  
> specified reason why this classes are hidden?

These are implementation classes, and their use should not be required 
outside of the package.  Why do you need to access them?  If there is a 
good reason, then we should add public APIs to support that use.

Doug

From MAILER-DAEMON Tue Mar  7 18:47:37 2006
Return-Path: 
 <hadoop-dev-return-318-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45418 invoked from network); 7 Mar 2006 18:47:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 18:47:37 -0000
Received: (qmail 10919 invoked by uid 500); 7 Mar 2006 18:47:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10891 invoked by uid 500); 7 Mar 2006 18:47:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10881 invoked by uid 99); 7 Mar 2006 18:47:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 10:47:36 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 10:47:36 -0800
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k27IlBBf020300
	for <hadoop-dev@lucene.apache.org>; Tue, 7 Mar 2006 13:47:15 -0500
X-ORBL: [69.228.231.148]
Received: from [192.168.168.15] (adsl-69-228-231-148.dsl.pltn13.pacbell.net
 [69.228.231.148])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k27Il5AA032680;
	Tue, 7 Mar 2006 13:47:08 -0500
Message-ID: <440DD529.1000106@apache.org>
Date: Tue, 07 Mar 2006 10:47:05 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Question about the "N"DFSClient
References: <cac652840603071040p5544fb87k577a31a821429227@mail.gmail.com>
In-Reply-To: <cac652840603071040p5544fb87k577a31a821429227@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

barry.kaplan@gmail.com wrote:
> I am going through my code and changing over from NDFS to DFS since I
> was using Nutch primarily for the DFS. I noticed that the protection
> of the DFSClient has changed along with things like DFSFile and
> DataNodeInfo.Was the reason solely to make the JavaDoc simpler?

Improving the javadoc is nice, but is a side-effect of trying to 
separate the public API from the implementation.  A smaller public API 
makes it easier to evolve the implementation without breaking folks 
(like you!).

> I was using those objects to have a jsp rendered status check, so
> having them available would be nice.

What methods do you need from DFSClient that are not generically 
available on FileSystem and/or DistributedFilesystem?

Doug

From MAILER-DAEMON Tue Mar  7 19:11:17 2006
Return-Path: 
 <hadoop-dev-return-320-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60866 invoked from network); 7 Mar 2006 19:11:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 19:11:17 -0000
Received: (qmail 70540 invoked by uid 500); 7 Mar 2006 19:11:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70522 invoked by uid 500); 7 Mar 2006 19:11:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70512 invoked by uid 99); 7 Mar 2006 19:11:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 11:11:17 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 11:11:15 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 9A1DF14446F
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 20:03:13 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 10975-10 for <hadoop-dev@lucene.apache.org>;
	Tue, 7 Mar 2006 20:03:13 +0100 (CET)
Received: from [192.168.8.2] (dslb-088-073-223-120.pools.arcor-ip.net
 [88.73.223.120])
	by mslinux.media-style.com (Postfix) with ESMTP id 3BEC9144464
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 20:03:13 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
In-Reply-To: <440DD459.9030005@apache.org>
References: <76202F75-7B65-407F-A9B7-5BC92B116A7C@media-style.com>
 <440DD459.9030005@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <79A5C7F5-94B4-4562-8188-5CF9E7CA4212@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: hidden classes in package mapred and dfs
Date: Tue, 7 Mar 2006 20:10:37 +0100
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug,
Am 07.03.2006 um 19:43 schrieb Doug Cutting:
>   If there is a good reason, then we should add public APIs to  
> support that use.
DFS InfoServer ala JobtrackerInfo Server, is  that sounds like a good  
reason? :-)
http://www.media-style.com/gfx/nutchadmin/systemStatus.html

Stefan 

From MAILER-DAEMON Tue Mar  7 19:11:10 2006
Return-Path: 
 <hadoop-dev-return-319-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60814 invoked from network); 7 Mar 2006 19:11:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 19:11:10 -0000
Received: (qmail 70405 invoked by uid 500); 7 Mar 2006 19:11:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 70386 invoked by uid 500); 7 Mar 2006 19:11:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 70370 invoked by uid 99); 7 Mar 2006 19:11:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 11:11:09 -0800
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=NO_REAL_NAME,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of barry.kaplan@gmail.com
 designates 64.233.182.207 as permitted sender)
Received: from [64.233.182.207] (HELO nproxy.gmail.com) (64.233.182.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 11:11:09 -0800
Received: by nproxy.gmail.com with SMTP id o63so6638nfa
        for <hadoop-dev@lucene.apache.org>;
 Tue, 07 Mar 2006 11:10:47 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=XX+itJwcIpN4kBpYRykF3WCGLhhkUPQaXl3T15jx9sZgJtXUYbnfLe7tcCgLRkKTlkhHc35V20cVXO9/WUD2stJHLwBGXJ5GwDKOdRixYchmRxFllzYfkC7pFNS5tKLE99drw7JLk3TprTrwWkyoxwUBCp3pCBD8Icizd0y5DXo=
Received: by 10.48.203.19 with SMTP id a19mr3094864nfg;
        Tue, 07 Mar 2006 11:10:46 -0800 (PST)
Received: by 10.49.30.5 with HTTP; Tue, 7 Mar 2006 11:10:46 -0800 (PST)
Message-ID: <cac652840603071110s678dc875v2205500d0b86cdc8@mail.gmail.com>
Date: Tue, 7 Mar 2006 11:10:46 -0800
From: barry.kaplan@gmail.com
To: hadoop-dev@lucene.apache.org
Subject: Re: Question about the "N"DFSClient
In-Reply-To: <440DD529.1000106@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <cac652840603071040p5544fb87k577a31a821429227@mail.gmail.com>
	 <440DD529.1000106@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I would like to be able to see the capacity, used, and effective bytes
of the DFS, as well as a DataNode breakdown listing name, capacity,
and remaining.

How would you feel about adding the following to DistributedFileSystem:

    public long getCapacity() throws IOException{
        return dfs.totalRawCapacity();
    }

    public long getUsed() throws IOException{
        return dfs.totalRawUsed();
    }

    public long getEffectiveBytes()throws IOException{
        long totalEffectiveBytes =3D 0;
        DFSFileInfo dfsFiles[] =3D dfs.listFiles(getPath(new File("/")));
        for (DFSFileInfo dfsFileInfo : dfsFiles) {
            totalEffectiveBytes +=3D dfsFileInfo.getContentsLen();
        }
        return totalEffectiveBytes;
    }

    public DatanodeStats[] getDataNodeStats() throws IOException{
        DatanodeInfo[]  dnReport =3D dfs.datanodeReport();
        DatanodeStats[] stats =3D new DatnodeStats[dnReport.length];
        int i =3D0;

        for (DatanodeInfo datanodeInfo : dnReport) {
            stats[i].name =3D datanodeInfo.getName();
            stats[i].capacity =3D datanodeInfo.getCapacity();
            stats[i].remaining =3D datanodeInfo.getRemaining();
            i++;
        }
        return stats;
    }

On 3/7/06, Doug Cutting <cutting@apache.org> wrote:
> barry.kaplan@gmail.com wrote:
> > I am going through my code and changing over from NDFS to DFS since I
> > was using Nutch primarily for the DFS. I noticed that the protection
> > of the DFSClient has changed along with things like DFSFile and
> > DataNodeInfo.Was the reason solely to make the JavaDoc simpler?
>
> Improving the javadoc is nice, but is a side-effect of trying to
> separate the public API from the implementation.  A smaller public API
> makes it easier to evolve the implementation without breaking folks
> (like you!).
>
> > I was using those objects to have a jsp rendered status check, so
> > having them available would be nice.
>
> What methods do you need from DFSClient that are not generically
> available on FileSystem and/or DistributedFilesystem?
>
> Doug
>

From MAILER-DAEMON Tue Mar  7 19:18:41 2006
Return-Path: 
 <hadoop-dev-return-321-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65930 invoked from network); 7 Mar 2006 19:18:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 19:18:41 -0000
Received: (qmail 88672 invoked by uid 500); 7 Mar 2006 19:18:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88614 invoked by uid 500); 7 Mar 2006 19:18:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88603 invoked by uid 99); 7 Mar 2006 19:18:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 11:18:41 -0800
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=NO_REAL_NAME,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of barry.kaplan@gmail.com
 designates 64.233.182.198 as permitted sender)
Received: from [64.233.182.198] (HELO nproxy.gmail.com) (64.233.182.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 11:18:40 -0800
Received: by nproxy.gmail.com with SMTP id k27so8400nfc
        for <hadoop-dev@lucene.apache.org>;
 Tue, 07 Mar 2006 11:18:18 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=BM0HBsDA6y2aIYY7znzpvY1o3eR+QsUzvkgpqIfq61t665wF5MP73oRRrEWYYLjq3D9w1zJ6eIq9+0tV6KyApR+P0dYt4AYC0ZB4PcMZA4+mVRAH8/9paL2MEQ/lhOTGG/ewPz3iaSeon2NIeyulM/DTRVF8toARDr7dUgemFeU=
Received: by 10.49.18.14 with SMTP id v14mr3092325nfi;
        Tue, 07 Mar 2006 11:18:17 -0800 (PST)
Received: by 10.49.30.5 with HTTP; Tue, 7 Mar 2006 11:18:17 -0800 (PST)
Message-ID: <cac652840603071118r26cc3f7h15eaaf3112ec93cb@mail.gmail.com>
Date: Tue, 7 Mar 2006 11:18:17 -0800
From: barry.kaplan@gmail.com
To: hadoop-dev@lucene.apache.org
Subject: Re: Question about the "N"DFSClient
In-Reply-To: <cac652840603071110s678dc875v2205500d0b86cdc8@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <cac652840603071040p5544fb87k577a31a821429227@mail.gmail.com>
	 <440DD529.1000106@apache.org>
	 <cac652840603071110s678dc875v2205500d0b86cdc8@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Woops... I didn't realize this was being compiled under 1.4 which
doesn't have the fancy loops.

On 3/7/06, barry.kaplan@gmail.com <barry.kaplan@gmail.com> wrote:
> I would like to be able to see the capacity, used, and effective bytes
> of the DFS, as well as a DataNode breakdown listing name, capacity,
> and remaining.
>
> How would you feel about adding the following to DistributedFileSystem:
>
>     public long getCapacity() throws IOException{
>         return dfs.totalRawCapacity();
>     }
>
>     public long getUsed() throws IOException{
>         return dfs.totalRawUsed();
>     }
>
>     public long getEffectiveBytes()throws IOException{
>         long totalEffectiveBytes =3D 0;
>         DFSFileInfo dfsFiles[] =3D dfs.listFiles(getPath(new File("/")));
>         for (DFSFileInfo dfsFileInfo : dfsFiles) {
>             totalEffectiveBytes +=3D dfsFileInfo.getContentsLen();
>         }
>         return totalEffectiveBytes;
>     }
>
>     public DatanodeStats[] getDataNodeStats() throws IOException{
>         DatanodeInfo[]  dnReport =3D dfs.datanodeReport();
>         DatanodeStats[] stats =3D new DatnodeStats[dnReport.length];
>         int i =3D0;
>
>         for (DatanodeInfo datanodeInfo : dnReport) {
>             stats[i].name =3D datanodeInfo.getName();
>             stats[i].capacity =3D datanodeInfo.getCapacity();
>             stats[i].remaining =3D datanodeInfo.getRemaining();
>             i++;
>         }
>         return stats;
>     }
>
> On 3/7/06, Doug Cutting <cutting@apache.org> wrote:
> > barry.kaplan@gmail.com wrote:
> > > I am going through my code and changing over from NDFS to DFS since I
> > > was using Nutch primarily for the DFS. I noticed that the protection
> > > of the DFSClient has changed along with things like DFSFile and
> > > DataNodeInfo.Was the reason solely to make the JavaDoc simpler?
> >
> > Improving the javadoc is nice, but is a side-effect of trying to
> > separate the public API from the implementation.  A smaller public API
> > makes it easier to evolve the implementation without breaking folks
> > (like you!).
> >
> > > I was using those objects to have a jsp rendered status check, so
> > > having them available would be nice.
> >
> > What methods do you need from DFSClient that are not generically
> > available on FileSystem and/or DistributedFilesystem?
> >
> > Doug
> >
>

From MAILER-DAEMON Tue Mar  7 20:01:42 2006
Return-Path: 
 <hadoop-dev-return-322-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91271 invoked from network); 7 Mar 2006 20:01:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 20:01:42 -0000
Received: (qmail 90601 invoked by uid 500); 7 Mar 2006 20:01:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90585 invoked by uid 500); 7 Mar 2006 20:01:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90576 invoked by uid 99); 7 Mar 2006 20:01:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 12:01:36 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 12:01:34 -0800
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k27K19bL014358
	for <hadoop-dev@lucene.apache.org>; Tue, 7 Mar 2006 15:01:10 -0500
X-ORBL: [69.228.231.148]
Received: from [192.168.168.15] (adsl-69-228-231-148.dsl.pltn13.pacbell.net
 [69.228.231.148])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k27K1606251952;
	Tue, 7 Mar 2006 15:01:09 -0500
Message-ID: <440DE682.6050509@apache.org>
Date: Tue, 07 Mar 2006 12:01:06 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Question about the "N"DFSClient
References: <cac652840603071040p5544fb87k577a31a821429227@mail.gmail.com>
	 <440DD529.1000106@apache.org>
 <cac652840603071110s678dc875v2205500d0b86cdc8@mail.gmail.com>
In-Reply-To: <cac652840603071110s678dc875v2205500d0b86cdc8@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

This looks good to me.  +1

Can you start a bug report and add this as a patch file?

DatanodeStats looks a lot like DatanodeInfo.  Was that your intent?  I 
wouldn't mind if this was a separate class, or we could try to sanitize 
DatanodeInfo, so it does not expose, e.g., the block-related methods.

We'll also need some javadoc comments.  And we should probably re-write 
DFSShell.report() to be implemented in terms of these new methods.

Thanks,

Doug

barry.kaplan@gmail.com wrote:
> I would like to be able to see the capacity, used, and effective bytes
> of the DFS, as well as a DataNode breakdown listing name, capacity,
> and remaining.
> 
> How would you feel about adding the following to DistributedFileSystem:
> 
>     public long getCapacity() throws IOException{
>         return dfs.totalRawCapacity();
>     }
> 
>     public long getUsed() throws IOException{
>         return dfs.totalRawUsed();
>     }
> 
>     public long getEffectiveBytes()throws IOException{
>         long totalEffectiveBytes = 0;
>         DFSFileInfo dfsFiles[] = dfs.listFiles(getPath(new File("/")));
>         for (DFSFileInfo dfsFileInfo : dfsFiles) {
>             totalEffectiveBytes += dfsFileInfo.getContentsLen();
>         }
>         return totalEffectiveBytes;
>     }
> 
>     public DatanodeStats[] getDataNodeStats() throws IOException{
>         DatanodeInfo[]  dnReport = dfs.datanodeReport();
>         DatanodeStats[] stats = new DatnodeStats[dnReport.length];
>         int i =0;
> 
>         for (DatanodeInfo datanodeInfo : dnReport) {
>             stats[i].name = datanodeInfo.getName();
>             stats[i].capacity = datanodeInfo.getCapacity();
>             stats[i].remaining = datanodeInfo.getRemaining();
>             i++;
>         }
>         return stats;
>     }
> 
> On 3/7/06, Doug Cutting <cutting@apache.org> wrote:
> 
>>barry.kaplan@gmail.com wrote:
>>
>>>I am going through my code and changing over from NDFS to DFS since I
>>>was using Nutch primarily for the DFS. I noticed that the protection
>>>of the DFSClient has changed along with things like DFSFile and
>>>DataNodeInfo.Was the reason solely to make the JavaDoc simpler?
>>
>>Improving the javadoc is nice, but is a side-effect of trying to
>>separate the public API from the implementation.  A smaller public API
>>makes it easier to evolve the implementation without breaking folks
>>(like you!).
>>
>>
>>>I was using those objects to have a jsp rendered status check, so
>>>having them available would be nice.
>>
>>What methods do you need from DFSClient that are not generically
>>available on FileSystem and/or DistributedFilesystem?
>>
>>Doug
>>

From MAILER-DAEMON Tue Mar  7 20:06:01 2006
Return-Path: 
 <hadoop-dev-return-323-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93132 invoked from network); 7 Mar 2006 20:06:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 20:06:01 -0000
Received: (qmail 94865 invoked by uid 500); 7 Mar 2006 20:06:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94849 invoked by uid 500); 7 Mar 2006 20:06:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94838 invoked by uid 99); 7 Mar 2006 20:06:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 12:06:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 12:06:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 2EEC4D49F9
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 20:05:39 +0000 (GMT)
Message-ID: <471192424.1141761939174.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 20:05:39 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-66) dfs client writes all data for a
 chunk to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-66?page=comments#action_12369293 ] 

Doug Cutting commented on HADOOP-66:
------------------------------------

Eric: I agree.  We should probably change this use a temp directory under dfs.data.dir instead of /tmp.

> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1

>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 20:15:08 2006
Return-Path: 
 <hadoop-dev-return-324-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99702 invoked from network); 7 Mar 2006 20:15:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 20:15:08 -0000
Received: (qmail 14956 invoked by uid 500); 7 Mar 2006 20:15:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14938 invoked by uid 500); 7 Mar 2006 20:15:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14929 invoked by uid 99); 7 Mar 2006 20:15:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 12:15:06 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 12:15:06 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id EDCC36ACAA
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 20:14:44 +0000 (GMT)
Message-ID: <1338507728.1141762484971.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 20:14:44 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-66) dfs client writes all data for a
 chunk to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-66?page=comments#action_12369299 ] 

Sameer Paranjpye commented on HADOOP-66:
----------------------------------------

It doesn't make a lot of sense to buffer the entire block in RAM. On the other hand, an application ought to be able to control the buffering strategy to some extent. Most stream implementations have a setBufferSize() or equivalent method that allow programmers to do this. The default buffer size is reasonably small so that many files can be opened without worrying too much about buffering.

Besides the issues with filling up /tmp (32MB is a pretty large chunk to be writing there), it's unclear that the scheme adds a lot of value, it may even be detrimental. If a connection to a Datanode fails then why not try to recover by re-connecting and throw an exception if that fails. If it's just the connection that has failed the client should be able to reconnect pretty easily. If the Datanode is down for the count the odds are low (or are they?) that it'll come back by the time the client finishes writing the block and the write will fail anyway, so why write to a temp file. If it's common for Datanodes to bounce and come back then Datanode stability is an problem that we should be working on. In that case, the temp file is only a workaround and not a real solution, it might even be masking the problem in many cases.


> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1

>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 20:34:03 2006
Return-Path: 
 <hadoop-dev-return-325-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17561 invoked from network); 7 Mar 2006 20:34:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 20:34:03 -0000
Received: (qmail 65772 invoked by uid 500); 7 Mar 2006 20:34:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65741 invoked by uid 500); 7 Mar 2006 20:34:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65732 invoked by uid 99); 7 Mar 2006 20:34:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 12:34:02 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 12:34:01 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 02189D49F9
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 20:33:40 +0000 (GMT)
Message-ID: <280249707.1141763620888.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 20:33:40 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-66) dfs client writes all data for a
 chunk to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-66?page=comments#action_12369308 ] 

Doug Cutting commented on HADOOP-66:
------------------------------------

It's hard to resume writing a block when a connection fails, since you don't know how much of the previous write succeeded.  Currently the block is streamed over TCP connections.  We could instead write it as a series of length-prefixed buffers, and query the remote datanode on reconnect about which buffers it had recieved, etc.  But that seems like reinventing a lot of TCP.

If the datanode goes down then currently the entire block is in a temp file so that it can instead be written to a different datanode.  Thus if datanodes die during, e.g., a reduce, then the reduce task does not have to restart.  But if reduce tasks are running on the same pool of machines as datanodes, then, when a node fails, some reduce tasks will need to be restarted anyway.  So I agree that this may not be helping us much.  I think throwing an exception when the connection to the datanode fails would be fine.

> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1

>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 21:05:06 2006
Return-Path: 
 <hadoop-dev-return-326-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35983 invoked from network); 7 Mar 2006 21:05:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 21:05:06 -0000
Received: (qmail 28552 invoked by uid 500); 7 Mar 2006 21:05:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28533 invoked by uid 500); 7 Mar 2006 21:05:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28524 invoked by uid 99); 7 Mar 2006 21:05:05 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 13:05:05 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 13:05:05 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 6CB12D49FA
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 21:04:44 +0000 (GMT)
Message-ID: <253434909.1141765484442.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 21:04:44 +0000 (GMT)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-57) hadoop dfs -ls / does not show root
 of file system
In-Reply-To: <3280039.1140661146259.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-57?page=comments#action_12369313 ] 

Mahadev konar commented on HADOOP-57:
-------------------------------------

here is a better fix:

268a269,271
>       if (path.toString().equals("")){
>           return DFSFile.DFS_FILE_SEPARATOR;
>       }

This one solves the problem and defaults to /user/username in case of non-absolute path.

> hadoop dfs -ls / does not show root of file system
> --------------------------------------------------
>
>          Key: HADOOP-57
>          URL: http://issues.apache.org/jira/browse/HADOOP-57
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Priority: Minor

>
> hadoop dfs -ls / does not show root of file system - it shows the user's home directory.
> It's thus impossible to learn the contents of the root file system via the shell.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 21:07:01 2006
Return-Path: 
 <hadoop-dev-return-327-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37537 invoked from network); 7 Mar 2006 21:07:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 21:07:01 -0000
Received: (qmail 29668 invoked by uid 500); 7 Mar 2006 21:07:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29651 invoked by uid 500); 7 Mar 2006 21:07:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29640 invoked by uid 99); 7 Mar 2006 21:07:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 13:07:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 13:07:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 8167E6ACA9
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 21:06:39 +0000 (GMT)
Message-ID: <171266798.1141765599523.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 21:06:39 +0000 (GMT)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-57) hadoop dfs -ls / does not show root
 of file system
In-Reply-To: <3280039.1140661146259.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-57?page=comments#action_12369314 ] 

Mahadev konar commented on HADOOP-57:
-------------------------------------

I forgot to mention the file:

the file with changes is DistributedFileSystem.java.



> hadoop dfs -ls / does not show root of file system
> --------------------------------------------------
>
>          Key: HADOOP-57
>          URL: http://issues.apache.org/jira/browse/HADOOP-57
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Priority: Minor

>
> hadoop dfs -ls / does not show root of file system - it shows the user's home directory.
> It's thus impossible to learn the contents of the root file system via the shell.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 21:24:01 2006
Return-Path: 
 <hadoop-dev-return-328-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46939 invoked from network); 7 Mar 2006 21:24:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 21:24:01 -0000
Received: (qmail 56853 invoked by uid 500); 7 Mar 2006 21:24:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56831 invoked by uid 500); 7 Mar 2006 21:24:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56816 invoked by uid 99); 7 Mar 2006 21:24:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 13:24:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 13:24:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 8E188D49FA
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 21:23:39 +0000 (GMT)
Message-ID: <859647985.1141766619579.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 21:23:39 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-57) hadoop dfs -ls / does not show root of
 file system
In-Reply-To: <3280039.1140661146259.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-57?page=all ]
     
Doug Cutting resolved HADOOP-57:
--------------------------------

    Fix Version: 0.1
     Resolution: Fixed

Fixed.  Thanks!

> hadoop dfs -ls / does not show root of file system
> --------------------------------------------------
>
>          Key: HADOOP-57
>          URL: http://issues.apache.org/jira/browse/HADOOP-57
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Priority: Minor
>      Fix For: 0.1

>
> hadoop dfs -ls / does not show root of file system - it shows the user's home directory.
> It's thus impossible to learn the contents of the root file system via the shell.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 21:59:29 2006
Return-Path: 
 <hadoop-dev-return-329-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64344 invoked from network); 7 Mar 2006 21:59:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 21:59:29 -0000
Received: (qmail 10565 invoked by uid 500); 7 Mar 2006 21:59:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10549 invoked by uid 500); 7 Mar 2006 21:59:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10540 invoked by uid 99); 7 Mar 2006 21:59:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 13:59:28 -0800
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=NO_REAL_NAME,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of barry.kaplan@gmail.com
 designates 64.233.182.194 as permitted sender)
Received: from [64.233.182.194] (HELO nproxy.gmail.com) (64.233.182.194)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 13:59:28 -0800
Received: by nproxy.gmail.com with SMTP id l36so27175nfa
        for <hadoop-dev@lucene.apache.org>;
 Tue, 07 Mar 2006 13:59:06 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=PDrPaCuKfvjZ5ihJGZUMxTMU4zdSMXcPHFEknt9j3nUukRbz7/t3fb+vh6iKCYTt6xWD6FQ6I/UCwdx+Ln+9h12gx/qiI+h8qrYLl5DE8qnh0hK0bj+j+5x1hr/PiWFcgxcmDxqhMeeWpthfKTXXy4HjEViV7P/pZCrUR4niezk=
Received: by 10.49.87.6 with SMTP id p6mr3179378nfl;
        Tue, 07 Mar 2006 13:59:05 -0800 (PST)
Received: by 10.49.30.5 with HTTP; Tue, 7 Mar 2006 13:59:05 -0800 (PST)
Message-ID: <cac652840603071359m5e52583fr1eb1f8d66dcc4b0a@mail.gmail.com>
Date: Tue, 7 Mar 2006 13:59:05 -0800
From: barry.kaplan@gmail.com
To: hadoop-dev@lucene.apache.org
Subject: Re: Question about the "N"DFSClient
In-Reply-To: <440DE682.6050509@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <cac652840603071040p5544fb87k577a31a821429227@mail.gmail.com>
	 <440DD529.1000106@apache.org>
	 <cac652840603071110s678dc875v2205500d0b86cdc8@mail.gmail.com>
	 <440DE682.6050509@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

That was my intent as the two are almost the same, the issue with just
using DataNodeInfo though is write and readFields would essentially
become public via the Writable interface. This does beg the question
as to why it is called DataNodeInfo vs DataNodeManager, as it is not
really an "info" object.

I think at the end of the day it probably doesn't really matter as it
will be impossible for an outside developer to get an instance of
DataNodeInfo based on the current design, but it does expose the
methods. I think it would simply be safer, especially for a read-only
stat object like this, to have a new object created.

-Barry

On 3/7/06, Doug Cutting <cutting@apache.org> wrote:
> This looks good to me.  +1
>
> Can you start a bug report and add this as a patch file?
>
> DatanodeStats looks a lot like DatanodeInfo.  Was that your intent?  I
> wouldn't mind if this was a separate class, or we could try to sanitize
> DatanodeInfo, so it does not expose, e.g., the block-related methods.
>
> We'll also need some javadoc comments.  And we should probably re-write
> DFSShell.report() to be implemented in terms of these new methods.
>
> Thanks,
>
> Doug
>
> barry.kaplan@gmail.com wrote:
> > I would like to be able to see the capacity, used, and effective bytes
> > of the DFS, as well as a DataNode breakdown listing name, capacity,
> > and remaining.
> >
> > How would you feel about adding the following to DistributedFileSystem:
> >
> >     public long getCapacity() throws IOException{
> >         return dfs.totalRawCapacity();
> >     }
> >
> >     public long getUsed() throws IOException{
> >         return dfs.totalRawUsed();
> >     }
> >
> >     public long getEffectiveBytes()throws IOException{
> >         long totalEffectiveBytes =3D 0;
> >         DFSFileInfo dfsFiles[] =3D dfs.listFiles(getPath(new File("/"))=
);
> >         for (DFSFileInfo dfsFileInfo : dfsFiles) {
> >             totalEffectiveBytes +=3D dfsFileInfo.getContentsLen();
> >         }
> >         return totalEffectiveBytes;
> >     }
> >
> >     public DatanodeStats[] getDataNodeStats() throws IOException{
> >         DatanodeInfo[]  dnReport =3D dfs.datanodeReport();
> >         DatanodeStats[] stats =3D new DatnodeStats[dnReport.length];
> >         int i =3D0;
> >
> >         for (DatanodeInfo datanodeInfo : dnReport) {
> >             stats[i].name =3D datanodeInfo.getName();
> >             stats[i].capacity =3D datanodeInfo.getCapacity();
> >             stats[i].remaining =3D datanodeInfo.getRemaining();
> >             i++;
> >         }
> >         return stats;
> >     }
> >
> > On 3/7/06, Doug Cutting <cutting@apache.org> wrote:
> >
> >>barry.kaplan@gmail.com wrote:
> >>
> >>>I am going through my code and changing over from NDFS to DFS since I
> >>>was using Nutch primarily for the DFS. I noticed that the protection
> >>>of the DFSClient has changed along with things like DFSFile and
> >>>DataNodeInfo.Was the reason solely to make the JavaDoc simpler?
> >>
> >>Improving the javadoc is nice, but is a side-effect of trying to
> >>separate the public API from the implementation.  A smaller public API
> >>makes it easier to evolve the implementation without breaking folks
> >>(like you!).
> >>
> >>
> >>>I was using those objects to have a jsp rendered status check, so
> >>>having them available would be nice.
> >>
> >>What methods do you need from DFSClient that are not generically
> >>available on FileSystem and/or DistributedFilesystem?
> >>
> >>Doug
> >>
>

From MAILER-DAEMON Tue Mar  7 22:19:18 2006
Return-Path: 
 <hadoop-dev-return-330-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76969 invoked from network); 7 Mar 2006 22:19:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 22:19:18 -0000
Received: (qmail 49824 invoked by uid 500); 7 Mar 2006 22:19:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49764 invoked by uid 500); 7 Mar 2006 22:19:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49747 invoked by uid 99); 7 Mar 2006 22:19:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 14:19:18 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 14:19:17 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 9A142D49FB
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 22:18:56 +0000 (GMT)
Message-ID: <1955843292.1141769936628.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 22:18:56 +0000 (GMT)
From: "Barry Kaplan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-67) Added statistic/reporting info to DFS
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Added statistic/reporting info to DFS
-------------------------------------

         Key: HADOOP-67
         URL: http://issues.apache.org/jira/browse/HADOOP-67
     Project: Hadoop
        Type: Improvement
  Components: dfs  
 Environment: n/a
    Reporter: Barry Kaplan
    Priority: Trivial


The DatanodInfo, DFSFileInfo, and DFSClient were recently changed to package level protection, this hampers the ability to get some useful reporting data that can be used for DataNode and DFS health/performance.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar  7 22:28:21 2006
Return-Path: 
 <hadoop-dev-return-331-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81367 invoked from network); 7 Mar 2006 22:28:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 7 Mar 2006 22:28:21 -0000
Received: (qmail 63611 invoked by uid 500); 7 Mar 2006 22:28:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63592 invoked by uid 500); 7 Mar 2006 22:28:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63576 invoked by uid 99); 7 Mar 2006 22:28:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 14:28:21 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 14:28:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id CC37D6ACAC
	for <hadoop-dev@lucene.apache.org>; Tue,  7 Mar 2006 22:27:59 +0000 (GMT)
Message-ID: <1178687321.1141770479833.JavaMail.jira@ajax>
Date: Tue, 7 Mar 2006 22:27:59 +0000 (GMT)
From: "Barry Kaplan (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-67) Added statistic/reporting info to DFS
In-Reply-To: <1955843292.1141769936628.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-67?page=all ]

Barry Kaplan updated HADOOP-67:
-------------------------------

    Attachment: dfsPatch.txt

my implementation...

> Added statistic/reporting info to DFS
> -------------------------------------
>
>          Key: HADOOP-67
>          URL: http://issues.apache.org/jira/browse/HADOOP-67
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>  Environment: n/a
>     Reporter: Barry Kaplan
>     Priority: Trivial
>  Attachments: dfsPatch.txt
>
> The DatanodInfo, DFSFileInfo, and DFSClient were recently changed to package level protection, this hampers the ability to get some useful reporting data that can be used for DataNode and DFS health/performance.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 00:12:01 2006
Return-Path: 
 <hadoop-dev-return-332-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30332 invoked from network); 8 Mar 2006 00:12:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 00:12:01 -0000
Received: (qmail 19514 invoked by uid 500); 8 Mar 2006 00:12:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19449 invoked by uid 500); 8 Mar 2006 00:12:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19440 invoked by uid 99); 8 Mar 2006 00:12:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:12:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:12:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 1432BD49FA
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 00:11:39 +0000 (GMT)
Message-ID: <1706495279.1141776699080.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 00:11:39 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-68) "Cannot abandon block during write to
 <file>" and "Cannot obtain additional block for file <file>" errors during
 dfs write test
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

"Cannot abandon block during write to <file>" and "Cannot obtain additional block for file <file>" errors during dfs write test
-------------------------------------------------------------------------------------------------------------------------------

         Key: HADOOP-68
         URL: http://issues.apache.org/jira/browse/HADOOP-68
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Versions: 0.1    
 Environment: linux 2.6, redhat, 180 machines
    Reporter: Owen O'Malley


In the namenode's log file, when trying to run my writer benchmark, I get a bunch of messages like:

060307 112402 Server handler 2 on 9020 call error: java.io.IOException: Cannot a
bandon block during write to /user/oom/random/.part001389.crc
java.io.IOException: Cannot abandon block during write to /user/oom/random/.part
001389.crc
        at org.apache.hadoop.dfs.NameNode.abandonBlock(NameNode.java:188)
        at sun.reflect.GeneratedMethodAccessor14.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.ipc.RPC$1.call(RPC.java:208)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:200)

and 

060307 112402 Server handler 1 on 9020 call error: java.io.IOException: Cannot a
bandon block during write to /user/oom/random/part001695
java.io.IOException: Cannot abandon block during write to /user/oom/random/part0
01695
        at org.apache.hadoop.dfs.NameNode.abandonBlock(NameNode.java:188)
        at sun.reflect.GeneratedMethodAccessor14.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.ipc.RPC$1.call(RPC.java:208)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:200)

and

060307 112402 Server handler 2 on 9020 call error: java.io.IOException: Cannot obtain additional block for file /user/oom/random/part001274
java.io.IOException: Cannot obtain additional block for file /user/oom/random/pa
rt001274
        at org.apache.hadoop.dfs.NameNode.addBlock(NameNode.java:160)
        at sun.reflect.GeneratedMethodAccessor13.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.ipc.RPC$1.call(RPC.java:208)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:200)



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 00:17:06 2006
Return-Path: 
 <hadoop-dev-return-333-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32167 invoked from network); 8 Mar 2006 00:17:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 00:17:06 -0000
Received: (qmail 24301 invoked by uid 500); 8 Mar 2006 00:17:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24242 invoked by uid 500); 8 Mar 2006 00:17:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24233 invoked by uid 99); 8 Mar 2006 00:17:06 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:17:06 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:17:05 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id E0C55D49FA
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 00:16:44 +0000 (GMT)
Message-ID: <258811899.1141777004917.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 00:16:44 +0000 (GMT)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-44) RPC exceptions should include remote
 stack trace
In-Reply-To: <50328208.1140559768195.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-44?page=comments#action_12369332 ] 

Bryan Pendleton commented on HADOOP-44:
---------------------------------------

I've attached one possible fix.

> RPC exceptions should include remote stack trace
> ------------------------------------------------
>
>          Key: HADOOP-44
>          URL: http://issues.apache.org/jira/browse/HADOOP-44
>      Project: Hadoop
>         Type: New Feature
>   Components: ipc
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1

>
> Remote exceptions currently only report the exception string.  Instead they should report the entire remote stack trace, as a string, to facilitate debugging.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 00:17:09 2006
Return-Path: 
 <hadoop-dev-return-334-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 32200 invoked from network); 8 Mar 2006 00:17:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 00:17:09 -0000
Received: (qmail 24590 invoked by uid 500); 8 Mar 2006 00:17:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24442 invoked by uid 500); 8 Mar 2006 00:17:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24354 invoked by uid 99); 8 Mar 2006 00:17:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:17:08 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:17:07 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id BE088D49FB
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 00:16:46 +0000 (GMT)
Message-ID: <911984746.1141777006775.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 00:16:46 +0000 (GMT)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-44) RPC exceptions should include remote
 stack trace
In-Reply-To: <50328208.1140559768195.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-44?page=all ]

Bryan Pendleton updated HADOOP-44:
----------------------------------

    Attachment: patch.txt

> RPC exceptions should include remote stack trace
> ------------------------------------------------
>
>          Key: HADOOP-44
>          URL: http://issues.apache.org/jira/browse/HADOOP-44
>      Project: Hadoop
>         Type: New Feature
>   Components: ipc
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: patch.txt
>
> Remote exceptions currently only report the exception string.  Instead they should report the entire remote stack trace, as a string, to facilitate debugging.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 00:52:01 2006
Return-Path: 
 <hadoop-dev-return-335-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46548 invoked from network); 8 Mar 2006 00:52:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 00:52:01 -0000
Received: (qmail 71076 invoked by uid 500); 8 Mar 2006 00:52:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71046 invoked by uid 500); 8 Mar 2006 00:52:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71036 invoked by uid 99); 8 Mar 2006 00:52:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:52:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:52:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 21443D49F9
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 00:51:39 +0000 (GMT)
Message-ID: <2135230928.1141779099133.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 00:51:39 +0000 (GMT)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-16) RPC call times out while indexing map
 task is computing splits
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-16?page=comments#action_12369339 ] 

Bryan Pendleton commented on HADOOP-16:
---------------------------------------

This is great, and finally fixes my issues with a large job that would never start.

However, the way things are in this patch (and the current code), the job doesn't get started until the background thread finishes computing all of the cache hints. This takes far too long - it took 15 minutes on a recent run. During that time, of course, no other work was getting done. How about moving the cachedHints-filling-loop to the end of initTasks(), and go ahead and set the job to RUNNING and "tasksInited=true" in the meantime?

Doing this locally lets work commence immediately, while the cache hints continue to get filled in for future task allocations.

> RPC call times out while indexing map task is computing splits
> --------------------------------------------------------------
>
>          Key: HADOOP-16
>          URL: http://issues.apache.org/jira/browse/HADOOP-16
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>  Environment: MapReduce multi-computer crawl environment: 11 machines (1 master with JobTracker/NameNode, 10 slaves with TaskTrackers/DataNodes)
>     Reporter: Chris Schneider
>     Assignee: Mike Cafarella
>      Fix For: 0.1
>  Attachments: patch.16, patch_h16.v0
>
> We've been using Nutch 0.8 (MapReduce) to perform some internet crawling. Things seemed to be going well until...
> 060129 222409 Lost tracker 'tracker_56288'
> 060129 222409 Task 'task_m_10gs5f' has been lost.
> 060129 222409 Task 'task_m_10qhzr' has been lost.
>    ........
>    ........
> 060129 222409 Task 'task_r_zggbwu' has been lost.
> 060129 222409 Task 'task_r_zh8dao' has been lost.
> 060129 222455 Server handler 8 on 8010 caught: java.net.SocketException: Socket closed
> java.net.SocketException: Socket closed
>         at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:99)
>         at java.net.SocketOutputStream.write(SocketOutputStream.java:136)
>         at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)
>         at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)
>         at java.io.DataOutputStream.flush(DataOutputStream.java:106)
>         at org.apache.nutch.ipc.Server$Handler.run(Server.java:216)
> 060129 222455 Adding task 'task_m_cia5po' to set for tracker 'tracker_56288'
> 060129 223711 Adding task 'task_m_ffv59i' to set for tracker 'tracker_25647'
> I'm hoping that someone could explain why task_m_cia5po got added to tracker_56288 after this tracker was lost.
> The Crawl .main process died with the following output:
> 060129 221129 Indexer: adding segment: /user/crawler/crawl-20060129091444/segments/20060129200246
> Exception in thread "main" java.io.IOException: timed out waiting for response
>     at org.apache.nutch.ipc.Client.call(Client.java:296)
>     at org.apache.nutch.ipc.RPC$Invoker.invoke(RPC.java:127)
>     at $Proxy1.submitJob(Unknown Source)
>     at org.apache.nutch.mapred.JobClient.submitJob(JobClient.java:259)
>     at org.apache.nutch.mapred.JobClient.runJob(JobClient.java:288)
>     at org.apache.nutch.indexer.Indexer.index(Indexer.java:263)
>     at org.apache.nutch.crawl.Crawl.main(Crawl.java:127)
> However, it definitely seems as if the JobTracker is still waiting for the job to finish (no failed jobs).
> Doug Cutting's response:
> The bug here is that the RPC call times out while the map task is computing splits.  The fix is that the job tracker should not compute splits until after it has returned from the submitJob RPC.  Please submit a bug in Jira to help remind us to fix this.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 00:52:02 2006
Return-Path: 
 <hadoop-dev-return-336-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46565 invoked from network); 8 Mar 2006 00:52:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 00:52:02 -0000
Received: (qmail 71150 invoked by uid 500); 8 Mar 2006 00:52:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71129 invoked by uid 500); 8 Mar 2006 00:52:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71120 invoked by uid 99); 8 Mar 2006 00:52:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:52:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:52:01 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 23DF2D49FD
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 00:51:40 +0000 (GMT)
Message-ID: <619464289.1141779100144.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 00:51:40 +0000 (GMT)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-69) Unchecked lookup value causes NPE in
 FSNamesystemgetDatanodeHints
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Unchecked lookup value causes NPE in FSNamesystemgetDatanodeHints
-----------------------------------------------------------------

         Key: HADOOP-69
         URL: http://issues.apache.org/jira/browse/HADOOP-69
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Reporter: Bryan Pendleton




-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 00:56:16 2006
Return-Path: 
 <hadoop-dev-return-337-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47848 invoked from network); 8 Mar 2006 00:56:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 00:56:16 -0000
Received: (qmail 73228 invoked by uid 500); 8 Mar 2006 00:56:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73207 invoked by uid 500); 8 Mar 2006 00:56:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73196 invoked by uid 99); 8 Mar 2006 00:56:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:56:15 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Mar 2006 16:56:15 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 52EB66ACA9
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 00:55:54 +0000 (GMT)
Message-ID: <342383636.1141779354330.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 00:55:54 +0000 (GMT)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-69) Unchecked lookup value causes NPE in
 FSNamesystemgetDatanodeHints
In-Reply-To: <619464289.1141779100144.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-69?page=all ]

Bryan Pendleton updated HADOOP-69:
----------------------------------

    Attachment: patch.txt

Check for null value after looking up blocks (ie, no known node has the block). Should prevent the NPE. The correct value (no hints for unfound blocks) is returned.

> Unchecked lookup value causes NPE in FSNamesystemgetDatanodeHints
> -----------------------------------------------------------------
>
>          Key: HADOOP-69
>          URL: http://issues.apache.org/jira/browse/HADOOP-69
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Bryan Pendleton
>  Attachments: patch.txt
>


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 12:29:56 2006
Return-Path: 
 <hadoop-dev-return-338-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 71347 invoked from network); 8 Mar 2006 12:29:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 12:29:56 -0000
Received: (qmail 96040 invoked by uid 500); 8 Mar 2006 12:29:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96018 invoked by uid 500); 8 Mar 2006 12:29:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96004 invoked by uid 99); 8 Mar 2006 12:29:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 04:29:55 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 04:29:54 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 8EC14144458
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 13:21:44 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 16390-08 for <hadoop-dev@lucene.apache.org>;
	Wed, 8 Mar 2006 13:21:44 +0100 (CET)
Received: from [192.168.200.61] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id 63B2F144457
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 13:21:44 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <440DD459.9030005@apache.org>
References: <76202F75-7B65-407F-A9B7-5BC92B116A7C@media-style.com>
 <440DD459.9030005@apache.org>
Content-Type: multipart/alternative; boundary=Apple-Mail-1-304774911
Message-Id: <82029F61-2FFF-4B95-886E-00818CC1F775@media-style.com>
From: Marko Bauhardt <mb@media-style.com>
Subject: Re: hidden classes in package mapred and dfs
Date: Wed, 8 Mar 2006 13:25:32 +0100
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-1-304774911
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed


Am 07.03.2006 um 19:43 schrieb Doug Cutting:

> These are implementation classes, and their use should not be  
> required outside of the package.  Why do you need to access them?   
> If there is a good reason, then we should add public APIs to  
> support that use.

I work at the nutch gui and it would be great when i have access to  
this classes, because a statistic about the datanodes, tasktracker,  
jobs etc. would be nice.

Marko



--Apple-Mail-1-304774911--

From MAILER-DAEMON Wed Mar  8 15:52:54 2006
Return-Path: 
 <hadoop-dev-return-339-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16574 invoked from network); 8 Mar 2006 15:52:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 15:52:54 -0000
Received: (qmail 959 invoked by uid 500); 8 Mar 2006 15:52:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 683 invoked by uid 500); 8 Mar 2006 15:52:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 515 invoked by uid 99); 8 Mar 2006 15:52:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 07:52:46 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 07:52:45 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id A846F144450
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 16:44:34 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 17851-05 for <hadoop-dev@lucene.apache.org>;
	Wed, 8 Mar 2006 16:44:34 +0100 (CET)
Received: from [192.168.200.39] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id 87CF614441F
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 16:44:34 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v746.2)
Content-Transfer-Encoding: 7bit
Message-Id: <E8F55E56-5042-467D-BD0C-23A115974446@media-style.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: load Configuration files from dfs?
Date: Wed, 8 Mar 2006 16:52:23 +0100
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

wouldn't be useful to load configuration files from dfs?
Any plans to realize that?

Stefan


From MAILER-DAEMON Wed Mar  8 17:47:27 2006
Return-Path: 
 <hadoop-dev-return-340-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94607 invoked from network); 8 Mar 2006 17:47:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 17:47:27 -0000
Received: (qmail 1983 invoked by uid 500); 8 Mar 2006 17:47:06 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1234 invoked by uid 500); 8 Mar 2006 17:47:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1100 invoked by uid 99); 8 Mar 2006 17:47:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 09:47:02 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 09:47:01 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id C7562D49FD
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 17:46:40 +0000 (GMT)
Message-ID: <451563617.1141840000813.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 17:46:40 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-66) dfs client writes all data for a chunk
 to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-66?page=all ]

Doug Cutting updated HADOOP-66:
-------------------------------

    Attachment: no-tmp.patch

Here's a minimally-tested patch that removes the use of temp files.

> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1
>  Attachments: no-tmp.patch
>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 23:32:01 2006
Return-Path: 
 <hadoop-dev-return-341-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96787 invoked from network); 8 Mar 2006 23:32:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 23:32:01 -0000
Received: (qmail 9682 invoked by uid 500); 8 Mar 2006 23:32:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9606 invoked by uid 500); 8 Mar 2006 23:32:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9592 invoked by uid 99); 8 Mar 2006 23:32:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 15:32:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 15:31:59 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id E0F1E6ACA9
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 23:31:38 +0000 (GMT)
Message-ID: <1531661681.1141860698913.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 23:31:38 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

the two file system tests TestDFS and TestFileSystem take too long
------------------------------------------------------------------

         Key: HADOOP-70
         URL: http://issues.apache.org/jira/browse/HADOOP-70
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Reporter: Owen O'Malley


Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.

I propose that we split rename the test classes from

src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java

and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar  8 23:38:19 2006
Return-Path: 
 <hadoop-dev-return-342-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99382 invoked from network); 8 Mar 2006 23:38:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 8 Mar 2006 23:38:19 -0000
Received: (qmail 12927 invoked by uid 500); 8 Mar 2006 23:38:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12910 invoked by uid 500); 8 Mar 2006 23:38:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12901 invoked by uid 99); 8 Mar 2006 23:38:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 15:38:18 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 15:38:18 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 69516D49FC
	for <hadoop-dev@lucene.apache.org>; Wed,  8 Mar 2006 23:37:57 +0000 (GMT)
Message-ID: <662233199.1141861077428.JavaMail.jira@ajax>
Date: Wed, 8 Mar 2006 23:37:57 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-70?page=comments#action_12369567 ] 

Doug Cutting commented on HADOOP-70:
------------------------------------

TestFileSystem only takes 4 seconds for me, but TestDFS is too slow.  So I'm +1 for moving TestDFS to a test-long target.  Then we should make the "nightly" target depend on test-long.


> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley

>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 00:19:01 2006
Return-Path: 
 <hadoop-dev-return-343-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20317 invoked from network); 9 Mar 2006 00:19:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 00:19:01 -0000
Received: (qmail 57238 invoked by uid 500); 9 Mar 2006 00:19:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57175 invoked by uid 500); 9 Mar 2006 00:19:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57166 invoked by uid 99); 9 Mar 2006 00:19:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:19:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:19:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 572A76ACA9
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 00:18:39 +0000 (GMT)
Message-ID: <539883049.1141863519345.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 00:18:39 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-71) The SequenceFileRecordReader uses the
 default FileSystem rather than the supplied one
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

The SequenceFileRecordReader uses the default FileSystem rather than the supplied one
-------------------------------------------------------------------------------------

         Key: HADOOP-71
         URL: http://issues.apache.org/jira/browse/HADOOP-71
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


The mapred.TestSequenceFileInputFormat test was failing when run with a conf directory that pointed to a dfs cluster. The reason was that SequenceFileRecordReader was using the default FileSystem from the config, while the test program was assuming the "local" file system was being used.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 00:19:03 2006
Return-Path: 
 <hadoop-dev-return-344-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20341 invoked from network); 9 Mar 2006 00:19:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 00:19:03 -0000
Received: (qmail 57324 invoked by uid 500); 9 Mar 2006 00:19:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57263 invoked by uid 500); 9 Mar 2006 00:19:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57254 invoked by uid 99); 9 Mar 2006 00:19:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:19:02 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:19:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 407CFD49F9
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 00:18:41 +0000 (GMT)
Message-ID: <402184842.1141863521260.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 00:18:41 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-66) dfs client writes all data for a chunk
 to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-66?page=all ]
     
Doug Cutting resolved HADOOP-66:
--------------------------------

    Resolution: Fixed
     Assign To: Doug Cutting

I just committed a fix for this and some problems that it was hiding.

> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: no-tmp.patch
>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 00:21:01 2006
Return-Path: 
 <hadoop-dev-return-345-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21231 invoked from network); 9 Mar 2006 00:21:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 00:21:01 -0000
Received: (qmail 58260 invoked by uid 500); 9 Mar 2006 00:21:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58241 invoked by uid 500); 9 Mar 2006 00:21:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58232 invoked by uid 99); 9 Mar 2006 00:21:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:21:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:21:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 8F40FD49FA
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 00:20:39 +0000 (GMT)
Message-ID: <1236990513.1141863639583.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 00:20:39 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-71) The SequenceFileRecordReader uses the
 default FileSystem rather than the supplied one
In-Reply-To: <539883049.1141863519345.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-71?page=all ]

Owen O'Malley updated HADOOP-71:
--------------------------------

    Attachment: explicit-fs.patch

Here is a patch that adds the FileSystem as an argument to the constructor.

> The SequenceFileRecordReader uses the default FileSystem rather than the supplied one
> -------------------------------------------------------------------------------------
>
>          Key: HADOOP-71
>          URL: http://issues.apache.org/jira/browse/HADOOP-71
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: explicit-fs.patch
>
> The mapred.TestSequenceFileInputFormat test was failing when run with a conf directory that pointed to a dfs cluster. The reason was that SequenceFileRecordReader was using the default FileSystem from the config, while the test program was assuming the "local" file system was being used.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 00:27:43 2006
Return-Path: 
 <hadoop-dev-return-346-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24567 invoked from network); 9 Mar 2006 00:27:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 00:27:43 -0000
Received: (qmail 63713 invoked by uid 500); 9 Mar 2006 00:27:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63653 invoked by uid 500); 9 Mar 2006 00:27:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63644 invoked by uid 99); 9 Mar 2006 00:27:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:27:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:27:42 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id AC3FE1444C0
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 01:19:27 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 20632-09 for <hadoop-dev@lucene.apache.org>;
	Thu, 9 Mar 2006 01:19:27 +0100 (CET)
Received: from [192.168.8.2] (dslb-088-073-210-247.pools.arcor-ip.net
 [88.73.210.247])
	by mslinux.media-style.com (Postfix) with ESMTP id 4CEAF144462
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 01:19:27 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
Content-Transfer-Encoding: 7bit
Message-Id: <0A43C8B0-B862-4012-BE61-6A056A0A8ACD@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: map tasks < reduce task 
Date: Thu, 9 Mar 2006 01:27:14 +0100
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi developers,

It looks like  hadoop hangs for ever when there are less map tasks  
than reduce tasks.
I had generate a nutch segment using a setup that configured 12 map  
and 6 reducers but fetched this segment with a setup running with 18  
map tasks and 9 reduces. (on 9 boxes),
Now hadoop hangs with reduce > copy > task_m_22fc8c@box09:50040.

Is that a known problem? Should I open a bug or there may something  
other that froze my hadoop?

Thanks for any hints
Stefan

---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Thu Mar  9 00:31:17 2006
Return-Path: 
 <hadoop-dev-return-347-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26716 invoked from network); 9 Mar 2006 00:31:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 00:31:17 -0000
Received: (qmail 69853 invoked by uid 500); 9 Mar 2006 00:31:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69792 invoked by uid 500); 9 Mar 2006 00:31:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69772 invoked by uid 99); 9 Mar 2006 00:31:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:31:16 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:31:15 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id C3D06D49FB
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 00:30:54 +0000 (GMT)
Message-ID: <1437481122.1141864254799.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 00:30:54 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-70?page=comments#action_12369577 ] 

Owen O'Malley commented on HADOOP-70:
-------------------------------------

TestFileSystem connects to the default FileSystem in the conf directory. Would it be ok to make TestFileSystem always use local? Otherwise it can be really slow (10 minutes before I killed it) or fail if the cluster happens to be down.

I'd like to have "ant test" take minutes and not depend on the cluster being available, so that I can use it during development.


> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley

>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 00:38:21 2006
Return-Path: 
 <hadoop-dev-return-348-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30244 invoked from network); 9 Mar 2006 00:38:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 00:38:21 -0000
Received: (qmail 79078 invoked by uid 500); 9 Mar 2006 00:38:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79057 invoked by uid 500); 9 Mar 2006 00:38:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79048 invoked by uid 99); 9 Mar 2006 00:38:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:38:21 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:38:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id E71A66ACA9
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 00:37:59 +0000 (GMT)
Message-ID: <1934306925.1141864679939.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 00:37:59 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-70?page=comments#action_12369578 ] 

Doug Cutting commented on HADOOP-70:
------------------------------------

I'm okay with having it always run local when run as a unit test, but not from the command line.  From the command line it should use the configured filesystem, no?  But unit tests should probably be config-independent, explicitly testing different config options.

> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley

>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 00:39:29 2006
Return-Path: 
 <hadoop-dev-return-349-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30675 invoked from network); 9 Mar 2006 00:39:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 00:39:29 -0000
Received: (qmail 79546 invoked by uid 500); 9 Mar 2006 00:39:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79528 invoked by uid 500); 9 Mar 2006 00:39:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79519 invoked by uid 99); 9 Mar 2006 00:39:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:39:28 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:39:28 -0800
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k290d2O8008131
	for <hadoop-dev@lucene.apache.org>; Wed, 8 Mar 2006 19:39:04 -0500
X-ORBL: [69.228.231.148]
Received: from [192.168.168.15] (adsl-69-228-231-148.dsl.pltn13.pacbell.net
 [69.228.231.148])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k290cwiC128774;
	Wed, 8 Mar 2006 19:39:01 -0500
Message-ID: <440F7922.6070203@apache.org>
Date: Wed, 08 Mar 2006 16:38:58 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: map tasks < reduce task
References: <0A43C8B0-B862-4012-BE61-6A056A0A8ACD@media-style.com>
In-Reply-To: <0A43C8B0-B862-4012-BE61-6A056A0A8ACD@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Stefan Groschupf wrote:
> It looks like  hadoop hangs for ever when there are less map tasks  than 
> reduce tasks.
> I had generate a nutch segment using a setup that configured 12 map  and 
> 6 reducers but fetched this segment with a setup running with 18  map 
> tasks and 9 reduces. (on 9 boxes),

That should work fine.

> Now hadoop hangs with reduce > copy > task_m_22fc8c@box09:50040.

That sounds like the same problem Michael Stack reported earlier today.

> Is that a known problem? Should I open a bug or there may something  
> other that froze my hadoop?

Sounds like a bug.

Doug

From MAILER-DAEMON Thu Mar  9 00:46:39 2006
Return-Path: 
 <hadoop-dev-return-350-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36118 invoked from network); 9 Mar 2006 00:46:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 00:46:39 -0000
Received: (qmail 91296 invoked by uid 500); 9 Mar 2006 00:46:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91276 invoked by uid 500); 9 Mar 2006 00:46:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91267 invoked by uid 99); 9 Mar 2006 00:46:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:46:38 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Mar 2006 16:46:37 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 4ED7A1444C0
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 01:38:23 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 20811-06 for <hadoop-dev@lucene.apache.org>;
	Thu, 9 Mar 2006 01:38:23 +0100 (CET)
Received: from [192.168.8.2] (dslb-088-073-210-247.pools.arcor-ip.net
 [88.73.210.247])
	by mslinux.media-style.com (Postfix) with ESMTP id CDE4A144462
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 01:38:22 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
In-Reply-To: <440F7922.6070203@apache.org>
References: <0A43C8B0-B862-4012-BE61-6A056A0A8ACD@media-style.com>
 <440F7922.6070203@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <1740E6A8-A8D8-450F-A7B0-1F56181B91B8@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: map tasks < reduce task
Date: Thu, 9 Mar 2006 01:46:10 +0100
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

May be  interesting for you is that there is a heavy io on my  
"box09",  329megabit/sec out  and 36megabit/sec in.
A kind of ping pong effect? ...



Am 09.03.2006 um 01:38 schrieb Doug Cutting:

> Stefan Groschupf wrote:
>> It looks like  hadoop hangs for ever when there are less map  
>> tasks  than reduce tasks.
>> I had generate a nutch segment using a setup that configured 12  
>> map  and 6 reducers but fetched this segment with a setup running  
>> with 18  map tasks and 9 reduces. (on 9 boxes),
>
> That should work fine.
>
>> Now hadoop hangs with reduce > copy > task_m_22fc8c@box09:50040.
>
> That sounds like the same problem Michael Stack reported earlier  
> today.
>
>> Is that a known problem? Should I open a bug or there may  
>> something  other that froze my hadoop?
>
> Sounds like a bug.
>
> Doug
>

---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Thu Mar  9 18:31:01 2006
Return-Path: 
 <hadoop-dev-return-351-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74846 invoked from network); 9 Mar 2006 18:31:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 18:31:01 -0000
Received: (qmail 42402 invoked by uid 500); 9 Mar 2006 18:31:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42372 invoked by uid 500); 9 Mar 2006 18:31:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42358 invoked by uid 99); 9 Mar 2006 18:31:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 10:31:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 10:31:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 7E4666ACAB
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 18:30:39 +0000 (GMT)
Message-ID: <720111688.1141929039514.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 18:30:39 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-70?page=comments#action_12369698 ] 

Owen O'Malley commented on HADOOP-70:
-------------------------------------

That sounds reasonable. 

I think we need to go the next step and create a conf directory that is used for junit tests. How about 
a conf/junit that contains hadoop-site.xml and mapred-defaults.xml. I'll change the test classpath to include the real conf directory to pick up the hadoop-default.xml so that it doesn't need to be duplicated.

Maybe instead of a "test-long" target it should be a "cluster-test" and it uses the real conf directory.

In all cases, the command line version of the test should use the real conf directory.

> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley

>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 19:58:42 2006
Return-Path: 
 <hadoop-dev-return-352-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34986 invoked from network); 9 Mar 2006 19:58:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 19:58:42 -0000
Received: (qmail 12244 invoked by uid 500); 9 Mar 2006 19:58:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12222 invoked by uid 500); 9 Mar 2006 19:58:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12213 invoked by uid 99); 9 Mar 2006 19:58:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 11:58:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 11:58:39 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 63F1114445C
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 20:50:15 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 26044-06 for <hadoop-dev@lucene.apache.org>;
	Thu, 9 Mar 2006 20:50:15 +0100 (CET)
Received: from [192.168.200.39] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id 0A668144456
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 20:50:15 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v746.2)
To: hadoop-dev@lucene.apache.org
Message-Id: <931A4AAD-7B08-4A02-A1FA-A8E4E75D481E@media-style.com>
Content-Type: multipart/alternative; boundary=Apple-Mail-44-418339161
From: Stefan Groschupf <sg@media-style.com>
Subject: crashing in job initializing block other jobs
Date: Thu, 9 Mar 2006 20:58:16 +0100
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-44-418339161
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed

Hi Developers,

I run in situations where it a failed job blocked all new jobs.

in may case I had a exception  in the InputFormat. E.g. no data in  
the defined input folder.
This clauses a exception in the JobInProgress#initTasks.
In this case the fields 'maps' and 'reduces' of JobInProgress are  
still null.

After that the jobtracker tries to kill the job but this fails also  
with a NPE, so the job is never killed and runs for ever and blocks  
other jobs in my case.

I see two ways to solve that:
1.) check if maps and reduces are null in the JobInProgress object ala:
if(maps != null){
               for (int i = 0; i < maps.length; i++) {
                   maps[i].kill();
               }
similar for the reduces.

2.) 	add a exception to taskInProgress#kill and JobInProgress#kill  
and handle this in the Jobtracker.

3.) stop the JobInitThread in case the initialization fails.


Any thoughts? Should I submit a patch?

Find the exceptions below.
Greetings,
Stefan



java.io.IOException: No input directories specified in:  
Configuration: defaults: hadoop-default.xml , mapred-default.xml , / 
tmp/hadoop/mapred/local/jobTracker/job_bwq6vj.xmlfinal: hadoop-site.xml
	at org.apache.hadoop.mapred.InputFormatBase.listFiles 
(InputFormatBase.java:84)
	at org.apache.hadoop.mapred.InputFormatBase.getSplits 
(InputFormatBase.java:94)
	at org.apache.hadoop.mapred.JobInProgress.initTasks 
(JobInProgress.java:127)
	at org.apache.hadoop.mapred.JobTracker$JobInitThread.run 
(JobTracker.java:208)
	at java.lang.Thread.run(Thread.java:613)

Exception in thread "Thread-25" java.lang.NullPointerException
	at org.apache.hadoop.mapred.JobInProgress.kill(JobInProgress.java:437)
	at org.apache.hadoop.mapred.JobTracker$JobInitThread.run 
(JobTracker.java:212)
	at java.lang.Thread.run(Thread.java:613)



---------------------------------------------------------------
company:        http://www.media-style.com
forum:        http://www.text-mining.org
blog:            http://www.find23.net



--Apple-Mail-44-418339161--

From MAILER-DAEMON Thu Mar  9 20:03:25 2006
Return-Path: 
 <hadoop-dev-return-353-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38468 invoked from network); 9 Mar 2006 20:03:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 20:03:25 -0000
Received: (qmail 18749 invoked by uid 500); 9 Mar 2006 20:03:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18611 invoked by uid 500); 9 Mar 2006 20:03:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18576 invoked by uid 99); 9 Mar 2006 20:03:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 12:03:21 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 12:03:18 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id B347614445C
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 20:54:54 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 26103-04 for <hadoop-dev@lucene.apache.org>;
	Thu, 9 Mar 2006 20:54:54 +0100 (CET)
Received: from [192.168.200.39] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id 595AB144456
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 20:54:54 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <931A4AAD-7B08-4A02-A1FA-A8E4E75D481E@media-style.com>
References: <931A4AAD-7B08-4A02-A1FA-A8E4E75D481E@media-style.com>
Content-Type: multipart/alternative; boundary=Apple-Mail-45-418618406
Message-Id: <C5E396EC-45DB-4018-90C0-A90843D738BF@media-style.com>
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: crashing in job initializing block other jobs
Date: Thu, 9 Mar 2006 21:02:55 +0100
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-45-418618406
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed

May be also a solution:
4.) initialize the maps and reduces fields with an array length 0.


Am 09.03.2006 um 20:58 schrieb Stefan Groschupf:

> Hi Developers,
>
> I run in situations where it a failed job blocked all new jobs.
>
> in may case I had a exception  in the InputFormat. E.g. no data in  
> the defined input folder.
> This clauses a exception in the JobInProgress#initTasks.
> In this case the fields 'maps' and 'reduces' of JobInProgress are  
> still null.
>
> After that the jobtracker tries to kill the job but this fails also  
> with a NPE, so the job is never killed and runs for ever and blocks  
> other jobs in my case.
>
> I see two ways to solve that:
> 1.) check if maps and reduces are null in the JobInProgress object  
> ala:
> if(maps != null){
>               for (int i = 0; i < maps.length; i++) {
>                   maps[i].kill();
>               }
> similar for the reduces.
>
> 2.) 	add a exception to taskInProgress#kill and JobInProgress#kill  
> and handle this in the Jobtracker.
>
> 3.) stop the JobInitThread in case the initialization fails.
>
>
> Any thoughts? Should I submit a patch?
>
> Find the exceptions below.
> Greetings,
> Stefan
>
>
>
> java.io.IOException: No input directories specified in:  
> Configuration: defaults: hadoop-default.xml , mapred-default.xml , / 
> tmp/hadoop/mapred/local/jobTracker/job_bwq6vj.xmlfinal: hadoop- 
> site.xml
> 	at org.apache.hadoop.mapred.InputFormatBase.listFiles 
> (InputFormatBase.java:84)
> 	at org.apache.hadoop.mapred.InputFormatBase.getSplits 
> (InputFormatBase.java:94)
> 	at org.apache.hadoop.mapred.JobInProgress.initTasks 
> (JobInProgress.java:127)
> 	at org.apache.hadoop.mapred.JobTracker$JobInitThread.run 
> (JobTracker.java:208)
> 	at java.lang.Thread.run(Thread.java:613)
>
> Exception in thread "Thread-25" java.lang.NullPointerException
> 	at org.apache.hadoop.mapred.JobInProgress.kill(JobInProgress.java: 
> 437)
> 	at org.apache.hadoop.mapred.JobTracker$JobInitThread.run 
> (JobTracker.java:212)
> 	at java.lang.Thread.run(Thread.java:613)
>
>
>
> ---------------------------------------------------------------
> company:        http://www.media-style.com
> forum:        http://www.text-mining.org
> blog:            http://www.find23.net
>
>

---------------------------------------------------------------
company:        http://www.media-style.com
forum:        http://www.text-mining.org
blog:            http://www.find23.net



--Apple-Mail-45-418618406--

From MAILER-DAEMON Thu Mar  9 20:41:05 2006
Return-Path: 
 <hadoop-dev-return-354-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66634 invoked from network); 9 Mar 2006 20:41:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 20:41:05 -0000
Received: (qmail 72999 invoked by uid 500); 9 Mar 2006 20:41:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72981 invoked by uid 500); 9 Mar 2006 20:41:05 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72972 invoked by uid 99); 9 Mar 2006 20:41:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 12:41:04 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 12:41:04 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 791C46ACAB
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 20:40:43 +0000 (GMT)
Message-ID: <1258597127.1141936843493.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 20:40:43 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-72) hadoop doesn't take advatage of
 distributed compiting in TestDFSIO
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

hadoop doesn't take advatage of distributed compiting in TestDFSIO
------------------------------------------------------------------

         Key: HADOOP-72
         URL: http://issues.apache.org/jira/browse/HADOOP-72
     Project: Hadoop
        Type: Test
  Components: dfs, fs, mapred  
 Environment: 200 node cluster
    Reporter: Konstantin Shvachko


TestDFSIO runs N map jobs, each either writing to or reading from a separate file of the same size, 
and collects statistical information on its performance. 
The reducer further calculates the overall statistics for all maps. 
It outputs the following data:
- read or write test
- date and time the test finished   
- number of files
- total number of bytes processed
- overall throughput in mb/sec
- average IO rate in mb/sec per file

__Results__
I run 7 iterations of the test one after another on a cluster of ~200 nodes. 
The file size is the same in all cases 320Mb. 
The number of files tried is 1,2,4,8,16,32,64.
The log file with statistics is attached.
It looks like we don't have any distributed computing here at all.
The total execution time increases proportionally to the total size of data both for writes and reads.
Another thing is that the io ratio for read is higher than the write rate just gradually.
For comparison I attach time measuring for the same ios performed on the same cluster but sequentially in a simple loop.
This is the summary:

Files	map/red time	sequential time
 1		49			  34 
 2		86			  69
 4		158			131
 8		299			266
16		569			532
32		1131
64		2218

This doesn't look good, unless there is something wrong with my test (attached) or the cluster settings.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 20:44:06 2006
Return-Path: 
 <hadoop-dev-return-355-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68824 invoked from network); 9 Mar 2006 20:44:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 20:44:06 -0000
Received: (qmail 77688 invoked by uid 500); 9 Mar 2006 20:44:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77583 invoked by uid 500); 9 Mar 2006 20:44:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77393 invoked by uid 99); 9 Mar 2006 20:44:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 12:44:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 12:44:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax (Postfix) with ESMTP id 7638E6ACAB
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 20:43:41 +0000 (GMT)
Message-ID: <1447551830.1141937021481.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 20:43:41 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-72) hadoop doesn't take advatage of
 distributed compiting in TestDFSIO
In-Reply-To: <1258597127.1141936843493.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-72?page=all ]

Konstantin Shvachko updated HADOOP-72:
--------------------------------------

    Attachment: TestDFSIO.java
                TestDFSIO_results_200_node_cluster.log
                TestDFSIO_results_sequential.log

> hadoop doesn't take advatage of distributed compiting in TestDFSIO
> ------------------------------------------------------------------
>
>          Key: HADOOP-72
>          URL: http://issues.apache.org/jira/browse/HADOOP-72
>      Project: Hadoop
>         Type: Test
>   Components: dfs, fs, mapred
>  Environment: 200 node cluster
>     Reporter: Konstantin Shvachko
>  Attachments: TestDFSIO.java, TestDFSIO_results_200_node_cluster.log, TestDFSIO_results_sequential.log
>
> TestDFSIO runs N map jobs, each either writing to or reading from a separate file of the same size, 
> and collects statistical information on its performance. 
> The reducer further calculates the overall statistics for all maps. 
> It outputs the following data:
> - read or write test
> - date and time the test finished   
> - number of files
> - total number of bytes processed
> - overall throughput in mb/sec
> - average IO rate in mb/sec per file
> __Results__
> I run 7 iterations of the test one after another on a cluster of ~200 nodes. 
> The file size is the same in all cases 320Mb. 
> The number of files tried is 1,2,4,8,16,32,64.
> The log file with statistics is attached.
> It looks like we don't have any distributed computing here at all.
> The total execution time increases proportionally to the total size of data both for writes and reads.
> Another thing is that the io ratio for read is higher than the write rate just gradually.
> For comparison I attach time measuring for the same ios performed on the same cluster but sequentially in a simple loop.
> This is the summary:
> Files	map/red time	sequential time
>  1		49			  34 
>  2		86			  69
>  4		158			131
>  8		299			266
> 16		569			532
> 32		1131
> 64		2218
> This doesn't look good, unless there is something wrong with my test (attached) or the cluster settings.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 23:01:44 2006
Return-Path: 
 <hadoop-dev-return-356-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38556 invoked from network); 9 Mar 2006 23:01:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 23:01:44 -0000
Received: (qmail 57537 invoked by uid 500); 9 Mar 2006 23:01:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57519 invoked by uid 500); 9 Mar 2006 23:01:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57510 invoked by uid 99); 9 Mar 2006 23:01:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 15:01:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 15:01:43 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id EDE9FD49F9
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 23:01:21 +0000 (GMT)
Message-ID: <612422050.1141945281971.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 23:01:21 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-72) hadoop doesn't take advatage of
 distributed compiting in TestDFSIO
In-Reply-To: <1258597127.1141936843493.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-72?page=comments#action_12369754 ] 

Doug Cutting commented on HADOOP-72:
------------------------------------

Did you look at the web ui to see how many map tasks were used to execute this?  My suspicion is that only a single map task is used.  A SequenceFile cannot be split into chunks smaller than 2k.  With less than 64 files, your single input file is probably less than 2k.  You could instead use a text input file, which can be split into smaller chunks, or you could use a custom getSplits() implementation that actually parses the input file, or you could use a much larger number of files.

> hadoop doesn't take advatage of distributed compiting in TestDFSIO
> ------------------------------------------------------------------
>
>          Key: HADOOP-72
>          URL: http://issues.apache.org/jira/browse/HADOOP-72
>      Project: Hadoop
>         Type: Test
>   Components: dfs, fs, mapred
>  Environment: 200 node cluster
>     Reporter: Konstantin Shvachko
>  Attachments: TestDFSIO.java, TestDFSIO_results_200_node_cluster.log, TestDFSIO_results_sequential.log
>
> TestDFSIO runs N map jobs, each either writing to or reading from a separate file of the same size, 
> and collects statistical information on its performance. 
> The reducer further calculates the overall statistics for all maps. 
> It outputs the following data:
> - read or write test
> - date and time the test finished   
> - number of files
> - total number of bytes processed
> - overall throughput in mb/sec
> - average IO rate in mb/sec per file
> __Results__
> I run 7 iterations of the test one after another on a cluster of ~200 nodes. 
> The file size is the same in all cases 320Mb. 
> The number of files tried is 1,2,4,8,16,32,64.
> The log file with statistics is attached.
> It looks like we don't have any distributed computing here at all.
> The total execution time increases proportionally to the total size of data both for writes and reads.
> Another thing is that the io ratio for read is higher than the write rate just gradually.
> For comparison I attach time measuring for the same ios performed on the same cluster but sequentially in a simple loop.
> This is the summary:
> Files	map/red time	sequential time
>  1		49			  34 
>  2		86			  69
>  4		158			131
>  8		299			266
> 16		569			532
> 32		1131
> 64		2218
> This doesn't look good, unless there is something wrong with my test (attached) or the cluster settings.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar  9 23:48:18 2006
Return-Path: 
 <hadoop-dev-return-357-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62703 invoked from network); 9 Mar 2006 23:48:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 9 Mar 2006 23:48:18 -0000
Received: (qmail 10504 invoked by uid 500); 9 Mar 2006 23:48:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10484 invoked by uid 500); 9 Mar 2006 23:48:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10475 invoked by uid 99); 9 Mar 2006 23:48:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 15:48:18 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 15:48:17 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E530D6ACA9
	for <hadoop-dev@lucene.apache.org>; Thu,  9 Mar 2006 23:47:56 +0000 (GMT)
Message-ID: <161615899.1141948076933.JavaMail.jira@ajax>
Date: Thu, 9 Mar 2006 23:47:56 +0000 (GMT)
From: "Stefan Groschupf (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-73) bin/hadoop dfs -rm works only for
 absolute paths
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

bin/hadoop dfs -rm works only for absolute paths
------------------------------------------------

         Key: HADOOP-73
         URL: http://issues.apache.org/jira/browse/HADOOP-73
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Reporter: Stefan Groschupf
    Priority: Trivial


every dfs command like -du works with relative paths but remove only works only for absolute paths. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 00:25:01 2006
Return-Path: 
 <hadoop-dev-return-358-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84259 invoked from network); 10 Mar 2006 00:25:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 00:25:01 -0000
Received: (qmail 64746 invoked by uid 500); 10 Mar 2006 00:25:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64730 invoked by uid 500); 10 Mar 2006 00:25:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64715 invoked by uid 99); 10 Mar 2006 00:25:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 16:25:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 16:25:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8399CD49FA
	for <hadoop-dev@lucene.apache.org>; Fri, 10 Mar 2006 00:24:39 +0000 (GMT)
Message-ID: <1330510466.1141950279536.JavaMail.jira@ajax>
Date: Fri, 10 Mar 2006 00:24:39 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-70?page=all ]

Owen O'Malley updated HADOOP-70:
--------------------------------

    Attachment: junit-conf.patch

This patch creates a config directory for the junit tests that forces mapreduce and dfs to "local". It also renames TestDFS to ClusterTestDFS and creates a new ant target "cluster-test" that runs with the real config directory instead of the junit config.

> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley
>  Attachments: junit-conf.patch
>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 00:27:02 2006
Return-Path: 
 <hadoop-dev-return-359-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85483 invoked from network); 10 Mar 2006 00:27:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 00:27:02 -0000
Received: (qmail 68031 invoked by uid 500); 10 Mar 2006 00:27:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68010 invoked by uid 500); 10 Mar 2006 00:27:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68001 invoked by uid 99); 10 Mar 2006 00:27:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 16:27:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 16:27:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7F515D49FA
	for <hadoop-dev@lucene.apache.org>; Fri, 10 Mar 2006 00:26:39 +0000 (GMT)
Message-ID: <335173235.1141950399518.JavaMail.jira@ajax>
Date: Fri, 10 Mar 2006 00:26:39 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-70?page=all ]

Owen O'Malley reassigned HADOOP-70:
-----------------------------------

    Assign To: Owen O'Malley

> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: junit-conf.patch
>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 01:03:49 2006
Return-Path: 
 <hadoop-dev-return-360-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3183 invoked from network); 10 Mar 2006 01:03:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 01:03:49 -0000
Received: (qmail 5878 invoked by uid 500); 10 Mar 2006 01:03:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 5856 invoked by uid 500); 10 Mar 2006 01:03:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 5838 invoked by uid 99); 10 Mar 2006 01:03:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 17:03:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.32] (HELO ylpvm01.prodigy.net) (207.115.57.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Mar 2006 17:03:47 -0800
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm01.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2A13PO8025270
	for <hadoop-dev@lucene.apache.org>; Thu, 9 Mar 2006 20:03:25 -0500
X-ORBL: [69.228.231.148]
Received: from [192.168.168.15] (adsl-69-228-231-148.dsl.pltn13.pacbell.net
 [69.228.231.148])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2A13Ed2219556;
	Thu, 9 Mar 2006 20:03:19 -0500
Message-ID: <4410D052.20704@apache.org>
Date: Thu, 09 Mar 2006 17:03:14 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: [Fwd: [jira] Resolved: (INFRA-701) new wiki request: hadoop]
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

FYI, the wiki now exists!

Doug

-------- Original Message --------
Subject: [jira] Resolved: (INFRA-701) new wiki request: hadoop
Date: Fri, 10 Mar 2006 00:54:40 +0000 (GMT)
From: Garrett Rooney (JIRA) <jira@apache.org>
To: cutting@nutch.org

      [ http://issues.apache.org/jira/browse/INFRA-701?page=all ]

Garrett Rooney resolved INFRA-701:
----------------------------------

     Resolution: Fixed

Mads created this earlier today, although he used 
http://wiki.apache.org/lucene-hadoop/ as the URL to better match the way 
most other wikis have been created.

> new wiki request: hadoop
> ------------------------
>
>          Key: INFRA-701
>          URL: http://issues.apache.org/jira/browse/INFRA-701
>      Project: Infrastructure
>         Type: Task
>   Components: Wiki
>     Reporter: Doug Cutting
>     Priority: Blocker

>
> The Lucene PMC has voted to split part of Nutch into a new sub-project named Hadoop.
> We thus need a new wiki at:
> http://wiki.apache.org/hadoop/
> Thanks!

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
    http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
    http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 19:21:47 2006
Return-Path: 
 <hadoop-dev-return-361-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99460 invoked from network); 10 Mar 2006 19:21:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 19:21:47 -0000
Received: (qmail 85012 invoked by uid 500); 10 Mar 2006 19:21:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84982 invoked by uid 500); 10 Mar 2006 19:21:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84966 invoked by uid 99); 10 Mar 2006 19:21:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 11:21:46 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [207.241.224.171] (HELO ia00524.archive.org) (207.241.224.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 11:21:45 -0800
Received: (qmail 19737 invoked by uid 100); 10 Mar 2006 19:13:38 -0000
Received: from adsl-71-130-102-77.dsl.pltn13.pacbell.net (HELO
 ?192.168.1.197?) (stack@archive.org@71.130.102.77)
  by mail-dev.archive.org with SMTP; 10 Mar 2006 19:13:38 -0000
Message-ID: <4411D1E5.3080807@archive.org>
Date: Fri, 10 Mar 2006 11:22:13 -0800
From: stack <stack@archive.org>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US;
 rv:1.8) Gecko/20051219 SeaMonkey/1.0b
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Hung job
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Spam-DCC: : 
X-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org
X-Spam-Level: 
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-97.2 required=7.0 tests=AWL,USER_IN_WHITELIST
	autolearn=no version=2.63
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

On hadoop-users, I've described two recent hangs.  I'm writing here to 
dev because I'm looking for pointers on how best to conjure a fix with 
perhaps pointers to any existing facility I might exploit (I do not know 
the codebase well).

In synopsis the problem goes as follows:

If a reduce cannot pick up map outputs -- for example, the output has 
been moved aside because of a ChecksumException (See below stack trace) 
-- then the job gets stuck with the reduce task trying and failing every 
ten seconds or so to pick up the non-existent map output part.

Somehow the reduce needs to give up and the jobtracker needs to rerun 
the map just as it would if the tasktracker had died completely.

Thanks in advance for any pointers,
St.Ack


060309 014426 Moving bad file /0/hadoop/tmp/task_m_bq2g76/part-20.out to
/0/bad_files/part-20.out.2002824050
060309 014426 Server handler 0 on 50040 caught:
org.apache.hadoop.fs.ChecksumException: Checksum error:
/0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
org.apache.hadoop.fs.ChecksumException: Checksum error:
/0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
      at
org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122)
      at
org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98)
      at
org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158)
      at java.io.BufferedInputStream.read1(BufferedInputStream.java:254)
      at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
      at java.io.DataInputStream.read(DataInputStream.java:80)
      at 
org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:110)
      at
org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
      at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
      at org.apache.hadoop.ipc.Server$Handler.run(Server.java:215)



From MAILER-DAEMON Fri Mar 10 22:34:16 2006
Return-Path: 
 <hadoop-dev-return-362-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93643 invoked from network); 10 Mar 2006 22:34:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 22:34:16 -0000
Received: (qmail 96498 invoked by uid 500); 10 Mar 2006 22:34:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96474 invoked by uid 500); 10 Mar 2006 22:34:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96463 invoked by uid 99); 10 Mar 2006 22:34:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:34:15 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:34:15 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 6CFB6D49FB
	for <hadoop-dev@lucene.apache.org>; Fri, 10 Mar 2006 22:33:54 +0000 (GMT)
Message-ID: <2139698490.1142030034444.JavaMail.jira@ajax>
Date: Fri, 10 Mar 2006 22:33:54 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-74) hash blocks into dfs.data.dirs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

hash blocks into dfs.data.dirs
------------------------------

         Key: HADOOP-74
         URL: http://issues.apache.org/jira/browse/HADOOP-74
     Project: Hadoop
        Type: Improvement
  Components: dfs  
    Versions: 0.1    
 Environment: large clusters
    Reporter: Doug Cutting
 Assigned to: Konstantin Shvachko 
     Fix For: 0.1


When dfs.data.dir has multiple values, we currently start a DataNode for each (all in the same JVM).  Instead we should run a single DataNode that stores block files into the different directories.  This will reduce the number of connections to the namenode.  We cannot hash because different devices might be different amounts full.  So the datanode will need to keep a table mapping from block id to file location, and add new blocks to less full devices.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 22:36:00 2006
Return-Path: 
 <hadoop-dev-return-363-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93968 invoked from network); 10 Mar 2006 22:36:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 22:36:00 -0000
Received: (qmail 97001 invoked by uid 500); 10 Mar 2006 22:36:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96978 invoked by uid 500); 10 Mar 2006 22:36:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96969 invoked by uid 99); 10 Mar 2006 22:36:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:36:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:35:59 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CB4A2D49F9
	for <hadoop-dev@lucene.apache.org>; Fri, 10 Mar 2006 22:35:38 +0000 (GMT)
Message-ID: <873621841.1142030138809.JavaMail.jira@ajax>
Date: Fri, 10 Mar 2006 22:35:38 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-75) dfs should check full file availability
 only at close
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

dfs should check full file availability only at close
-----------------------------------------------------

         Key: HADOOP-75
         URL: http://issues.apache.org/jira/browse/HADOOP-75
     Project: Hadoop
        Type: Improvement
  Components: dfs  
    Versions: 0.1    
    Reporter: Doug Cutting
    Priority: Minor
     Fix For: 0.1


Currently it appears that dfs checks that the namenode knows about all blocks in a file as each block is written.  It would be more efficient to only check that all blocks are stored somewhere when the file is closed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 22:51:15 2006
Return-Path: 
 <hadoop-dev-return-364-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99001 invoked from network); 10 Mar 2006 22:51:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 22:51:15 -0000
Received: (qmail 7595 invoked by uid 500); 10 Mar 2006 22:51:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7534 invoked by uid 500); 10 Mar 2006 22:51:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7524 invoked by uid 99); 10 Mar 2006 22:51:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:51:15 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:51:14 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8CF91D49FA
	for <hadoop-dev@lucene.apache.org>; Fri, 10 Mar 2006 22:50:53 +0000 (GMT)
Message-ID: <2124500063.1142031053574.JavaMail.jira@ajax>
Date: Fri, 10 Mar 2006 22:50:53 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-3) Output directories are not cleaned up
 before the reduces run
In-Reply-To: <859498351.1139000372103.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-3?page=all ]

Sameer Paranjpye reassigned HADOOP-3:
-------------------------------------

    Assign To: Owen O'Malley

> Output directories are not cleaned up before the reduces run
> ------------------------------------------------------------
>
>          Key: HADOOP-3
>          URL: http://issues.apache.org/jira/browse/HADOOP-3
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>  Attachments: clean-out-dir.patch
>
> The output directory for the reduces is not cleaned up and therefore if you can see left overs from previous runs, if they had more reduces. For example, if you run the application once with reduces=10 and then rerun with reduces=8, your output directory will have frag00000 to frag00009 with the first 8 fragments from the second run and the last 2 fragments from the first run.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 22:51:16 2006
Return-Path: 
 <hadoop-dev-return-365-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99017 invoked from network); 10 Mar 2006 22:51:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 22:51:16 -0000
Received: (qmail 7669 invoked by uid 500); 10 Mar 2006 22:51:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7608 invoked by uid 500); 10 Mar 2006 22:51:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7599 invoked by uid 99); 10 Mar 2006 22:51:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:51:15 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:51:15 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 5A4B2D49F9
	for <hadoop-dev@lucene.apache.org>; Fri, 10 Mar 2006 22:50:54 +0000 (GMT)
Message-ID: <194494268.1142031054367.JavaMail.jira@ajax>
Date: Fri, 10 Mar 2006 22:50:54 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-3) Output directories are not cleaned up
 before the reduces run
In-Reply-To: <859498351.1139000372103.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-3?page=all ]

Sameer Paranjpye updated HADOOP-3:
----------------------------------

    Fix Version: 0.1
        Version: 0.1

> Output directories are not cleaned up before the reduces run
> ------------------------------------------------------------
>
>          Key: HADOOP-3
>          URL: http://issues.apache.org/jira/browse/HADOOP-3
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: clean-out-dir.patch
>
> The output directory for the reduces is not cleaned up and therefore if you can see left overs from previous runs, if they had more reduces. For example, if you run the application once with reduces=10 and then rerun with reduces=8, your output directory will have frag00000 to frag00009 with the first 8 fragments from the second run and the last 2 fragments from the first run.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 22:53:01 2006
Return-Path: 
 <hadoop-dev-return-366-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1610 invoked from network); 10 Mar 2006 22:53:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 22:53:01 -0000
Received: (qmail 11238 invoked by uid 500); 10 Mar 2006 22:53:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11176 invoked by uid 500); 10 Mar 2006 22:53:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11165 invoked by uid 99); 10 Mar 2006 22:53:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:53:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:53:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 81B0AD49FA
	for <hadoop-dev@lucene.apache.org>; Fri, 10 Mar 2006 22:52:39 +0000 (GMT)
Message-ID: <1182760328.1142031159528.JavaMail.jira@ajax>
Date: Fri, 10 Mar 2006 22:52:39 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-2) Reused Keys and Values fail with a
 Combiner
In-Reply-To: <361890767.1139000103581.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-2?page=all ]

Sameer Paranjpye updated HADOOP-2:
----------------------------------

    Fix Version: 0.1

> Reused Keys and Values fail with a Combiner
> -------------------------------------------
>
>          Key: HADOOP-2
>          URL: http://issues.apache.org/jira/browse/HADOOP-2
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1

>
> If the map function reuses the key or value by destructively modifying it after the output.collect(key,value) call and your application uses a combiner, the data is corrupted by having lots of instances with the last key or value.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 10 22:58:11 2006
Return-Path: 
 <hadoop-dev-return-367-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3813 invoked from network); 10 Mar 2006 22:58:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 10 Mar 2006 22:58:11 -0000
Received: (qmail 13648 invoked by uid 500); 10 Mar 2006 22:58:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13626 invoked by uid 500); 10 Mar 2006 22:58:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13617 invoked by uid 99); 10 Mar 2006 22:58:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:58:10 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 14:58:10 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 640D66ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 10 Mar 2006 22:57:49 +0000 (GMT)
Message-ID: <1176204687.1142031469402.JavaMail.jira@ajax>
Date: Fri, 10 Mar 2006 22:57:49 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-76) reduce output should first be written
 to a temporary file name, then moved into place
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

reduce output should first be written to a temporary file name, then moved into place
-------------------------------------------------------------------------------------

         Key: HADOOP-76
         URL: http://issues.apache.org/jira/browse/HADOOP-76
     Project: Hadoop
        Type: Improvement
  Components: mapred  
    Versions: 0.1    
    Reporter: Doug Cutting
 Assigned to: Owen O'Malley 
    Priority: Minor
     Fix For: 0.2


This would permit speculative execution of reduce tasks.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 11 02:33:02 2006
Return-Path: 
 <hadoop-dev-return-368-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72009 invoked from network); 11 Mar 2006 02:33:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Mar 2006 02:33:02 -0000
Received: (qmail 69209 invoked by uid 500); 11 Mar 2006 02:33:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69189 invoked by uid 500); 11 Mar 2006 02:33:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69180 invoked by uid 99); 11 Mar 2006 02:33:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 18:33:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 18:33:01 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 01ABD6ACA9
	for <hadoop-dev@lucene.apache.org>; Sat, 11 Mar 2006 02:32:40 +0000 (GMT)
Message-ID: <1579015167.1142044359998.JavaMail.jira@ajax>
Date: Sat, 11 Mar 2006 02:32:39 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-72) hadoop doesn't take advatage of
 distributed compiting in TestDFSIO
In-Reply-To: <1258597127.1141936843493.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-72?page=all ]

Konstantin Shvachko updated HADOOP-72:
--------------------------------------

    Attachment:     (was: TestDFSIO.java)

> hadoop doesn't take advatage of distributed compiting in TestDFSIO
> ------------------------------------------------------------------
>
>          Key: HADOOP-72
>          URL: http://issues.apache.org/jira/browse/HADOOP-72
>      Project: Hadoop
>         Type: Test
>   Components: dfs, fs, mapred
>  Environment: 200 node cluster
>     Reporter: Konstantin Shvachko
>  Attachments: TestDFSIO_results_200_node_cluster.log, TestDFSIO_results_sequential.log
>
> TestDFSIO runs N map jobs, each either writing to or reading from a separate file of the same size, 
> and collects statistical information on its performance. 
> The reducer further calculates the overall statistics for all maps. 
> It outputs the following data:
> - read or write test
> - date and time the test finished   
> - number of files
> - total number of bytes processed
> - overall throughput in mb/sec
> - average IO rate in mb/sec per file
> __Results__
> I run 7 iterations of the test one after another on a cluster of ~200 nodes. 
> The file size is the same in all cases 320Mb. 
> The number of files tried is 1,2,4,8,16,32,64.
> The log file with statistics is attached.
> It looks like we don't have any distributed computing here at all.
> The total execution time increases proportionally to the total size of data both for writes and reads.
> Another thing is that the io ratio for read is higher than the write rate just gradually.
> For comparison I attach time measuring for the same ios performed on the same cluster but sequentially in a simple loop.
> This is the summary:
> Files	map/red time	sequential time
>  1		49			  34 
>  2		86			  69
>  4		158			131
>  8		299			266
> 16		569			532
> 32		1131
> 64		2218
> This doesn't look good, unless there is something wrong with my test (attached) or the cluster settings.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 11 02:39:27 2006
Return-Path: 
 <hadoop-dev-return-369-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73466 invoked from network); 11 Mar 2006 02:39:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 11 Mar 2006 02:39:27 -0000
Received: (qmail 73303 invoked by uid 500); 11 Mar 2006 02:39:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73280 invoked by uid 500); 11 Mar 2006 02:39:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73269 invoked by uid 99); 11 Mar 2006 02:39:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 18:39:27 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Mar 2006 18:39:26 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CA1BA6ACA9
	for <hadoop-dev@lucene.apache.org>; Sat, 11 Mar 2006 02:39:05 +0000 (GMT)
Message-ID: <895637219.1142044745823.JavaMail.jira@ajax>
Date: Sat, 11 Mar 2006 02:39:05 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-72) hadoop doesn't take advatage of
 distributed compiting in TestDFSIO
In-Reply-To: <1258597127.1141936843493.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-72?page=all ]

Konstantin Shvachko updated HADOOP-72:
--------------------------------------

    Attachment: TestDFSIO.java
                TestDFSIO_results.log

TestDFSIO is modified to create one input file for each map task.
That way it works in parallel.
Everything is getting very slow when the the number of writes is close to or 
larger than the size of the cluster.


> hadoop doesn't take advatage of distributed compiting in TestDFSIO
> ------------------------------------------------------------------
>
>          Key: HADOOP-72
>          URL: http://issues.apache.org/jira/browse/HADOOP-72
>      Project: Hadoop
>         Type: Test
>   Components: dfs, fs, mapred
>  Environment: 200 node cluster
>     Reporter: Konstantin Shvachko
>  Attachments: TestDFSIO.java, TestDFSIO_results.log, TestDFSIO_results_200_node_cluster.log, TestDFSIO_results_sequential.log
>
> TestDFSIO runs N map jobs, each either writing to or reading from a separate file of the same size, 
> and collects statistical information on its performance. 
> The reducer further calculates the overall statistics for all maps. 
> It outputs the following data:
> - read or write test
> - date and time the test finished   
> - number of files
> - total number of bytes processed
> - overall throughput in mb/sec
> - average IO rate in mb/sec per file
> __Results__
> I run 7 iterations of the test one after another on a cluster of ~200 nodes. 
> The file size is the same in all cases 320Mb. 
> The number of files tried is 1,2,4,8,16,32,64.
> The log file with statistics is attached.
> It looks like we don't have any distributed computing here at all.
> The total execution time increases proportionally to the total size of data both for writes and reads.
> Another thing is that the io ratio for read is higher than the write rate just gradually.
> For comparison I attach time measuring for the same ios performed on the same cluster but sequentially in a simple loop.
> This is the summary:
> Files	map/red time	sequential time
>  1		49			  34 
>  2		86			  69
>  4		158			131
>  8		299			266
> 16		569			532
> 32		1131
> 64		2218
> This doesn't look good, unless there is something wrong with my test (attached) or the cluster settings.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Mar 12 02:34:12 2006
Return-Path: 
 <hadoop-dev-return-370-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10878 invoked from network); 12 Mar 2006 02:34:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 12 Mar 2006 02:34:12 -0000
Received: (qmail 80034 invoked by uid 500); 12 Mar 2006 02:34:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80011 invoked by uid 500); 12 Mar 2006 02:34:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80002 invoked by uid 99); 12 Mar 2006 02:34:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Mar 2006 18:34:11 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Mar 2006 18:34:10 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 777A71443EA
	for <hadoop-dev@lucene.apache.org>; Sun, 12 Mar 2006 03:25:22 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 07571-10 for <hadoop-dev@lucene.apache.org>;
	Sun, 12 Mar 2006 03:25:22 +0100 (CET)
Received: from [192.168.8.2] (dslb-088-073-214-064.pools.arcor-ip.net
 [88.73.214.64])
	by mslinux.media-style.com (Postfix) with ESMTP id D6B9F1443DF
	for <hadoop-dev@lucene.apache.org>; Sun, 12 Mar 2006 03:25:21 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
In-Reply-To: <4411D1E5.3080807@archive.org>
References: <4411D1E5.3080807@archive.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <35108254-44A9-4526-940C-058A3371F216@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: io.skip.checksum.errors was: Re: Hung job
Date: Sun, 12 Mar 2006 03:33:44 +0100
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Stack,

try set the io.skip.checksum.errors to true in your hadoop-site.xml

<property>
   <name>io.skip.checksum.errors</name>
   <value>false</value>
   <description>If true, when a checksum error is encountered while
   reading a sequence file, entries are skipped, instead of throwing an
   exception.</description>
</property>

This may be solve your problem but I agree that there should be a  
smarter way than just ignoring it. :)

Stefan


Am 10.03.2006 um 20:22 schrieb stack:

> On hadoop-users, I've described two recent hangs.  I'm writing here  
> to dev because I'm looking for pointers on how best to conjure a  
> fix with perhaps pointers to any existing facility I might exploit  
> (I do not know the codebase well).
>
> In synopsis the problem goes as follows:
>
> If a reduce cannot pick up map outputs -- for example, the output  
> has been moved aside because of a ChecksumException (See below  
> stack trace) -- then the job gets stuck with the reduce task trying  
> and failing every ten seconds or so to pick up the non-existent map  
> output part.
>
> Somehow the reduce needs to give up and the jobtracker needs to  
> rerun the map just as it would if the tasktracker had died completely.
>
> Thanks in advance for any pointers,
> St.Ack
>
>
> 060309 014426 Moving bad file /0/hadoop/tmp/task_m_bq2g76/ 
> part-20.out to
> /0/bad_files/part-20.out.2002824050
> 060309 014426 Server handler 0 on 50040 caught:
> org.apache.hadoop.fs.ChecksumException: Checksum error:
> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
> org.apache.hadoop.fs.ChecksumException: Checksum error:
> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>      at
> org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum 
> (FSDataInputStream.java:122)
>      at
> org.apache.hadoop.fs.FSDataInputStream$Checker.read 
> (FSDataInputStream.java:98)
>      at
> org.apache.hadoop.fs.FSDataInputStream$PositionCache.read 
> (FSDataInputStream.java:158)
>      at java.io.BufferedInputStream.read1(BufferedInputStream.java: 
> 254)
>      at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
>      at java.io.DataInputStream.read(DataInputStream.java:80)
>      at org.apache.hadoop.mapred.MapOutputFile.write 
> (MapOutputFile.java:110)
>      at
> org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java: 
> 117)
>      at org.apache.hadoop.io.ObjectWritable.write 
> (ObjectWritable.java:64)
>      at org.apache.hadoop.ipc.Server$Handler.run(Server.java:215)
>
>
>

---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Mon Mar 13 02:00:13 2006
Return-Path: 
 <hadoop-dev-return-371-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36336 invoked from network); 13 Mar 2006 02:00:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 02:00:13 -0000
Received: (qmail 52899 invoked by uid 500); 13 Mar 2006 02:00:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 52877 invoked by uid 500); 13 Mar 2006 02:00:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 52867 invoked by uid 99); 13 Mar 2006 02:00:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Mar 2006 18:00:12 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Mar 2006 18:00:11 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id D98EC144400
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 02:51:12 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 12638-05 for <hadoop-dev@lucene.apache.org>;
	Mon, 13 Mar 2006 02:51:12 +0100 (CET)
Received: from [192.168.8.2] (dslb-088-073-201-227.pools.arcor-ip.net
 [88.73.201.227])
	by mslinux.media-style.com (Postfix) with ESMTP id 22AFE1443FF
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 02:51:12 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
In-Reply-To: <35108254-44A9-4526-940C-058A3371F216@media-style.com>
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: io.skip.checksum.errors was: Re: Hung job
Date: Mon, 13 Mar 2006 02:59:45 +0100
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi Stack,
I tried that but sorry to say it does not solve the problem - also  
with the very latest hadoop update to nutch.

@Doug as far I understand the latest update already contains this  
rollback "Reverted changes from 384385"?

To summarize I'm not able to run just one larger hadoop job e.g.  
nutch fetching never worked.
Always one tasktracker hangs in the last 10 % of doing a reduce (some  
times it arrived 98 % ) than the task runs into a time out and is  
restarted again, fails, restarted, fails ...
After 4 fails the task in progress crash the complete job.

There is just nothing in the log files, that gives any hint also I  
configured to ignore check sum exceptions.

Any ideas where to search for the problem? It is very sad to throw a  
fetched segment with several million documents just to trash,
  since the last 3 % of reducing of one tasktracker fail.

Thanks for any comments.
Stefan


Am 12.03.2006 um 03:33 schrieb Stefan Groschupf:

> Hi Stack,
>
> try set the io.skip.checksum.errors to true in your hadoop-site.xml
>
> <property>
>   <name>io.skip.checksum.errors</name>
>   <value>false</value>
>   <description>If true, when a checksum error is encountered while
>   reading a sequence file, entries are skipped, instead of throwing an
>   exception.</description>
> </property>
>
> This may be solve your problem but I agree that there should be a  
> smarter way than just ignoring it. :)
>
> Stefan
>
>
> Am 10.03.2006 um 20:22 schrieb stack:
>
>> On hadoop-users, I've described two recent hangs.  I'm writing  
>> here to dev because I'm looking for pointers on how best to  
>> conjure a fix with perhaps pointers to any existing facility I  
>> might exploit (I do not know the codebase well).
>>
>> In synopsis the problem goes as follows:
>>
>> If a reduce cannot pick up map outputs -- for example, the output  
>> has been moved aside because of a ChecksumException (See below  
>> stack trace) -- then the job gets stuck with the reduce task  
>> trying and failing every ten seconds or so to pick up the non- 
>> existent map output part.
>>
>> Somehow the reduce needs to give up and the jobtracker needs to  
>> rerun the map just as it would if the tasktracker had died  
>> completely.
>>
>> Thanks in advance for any pointers,
>> St.Ack
>>
>>
>> 060309 014426 Moving bad file /0/hadoop/tmp/task_m_bq2g76/ 
>> part-20.out to
>> /0/bad_files/part-20.out.2002824050
>> 060309 014426 Server handler 0 on 50040 caught:
>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>      at
>> org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum 
>> (FSDataInputStream.java:122)
>>      at
>> org.apache.hadoop.fs.FSDataInputStream$Checker.read 
>> (FSDataInputStream.java:98)
>>      at
>> org.apache.hadoop.fs.FSDataInputStream$PositionCache.read 
>> (FSDataInputStream.java:158)
>>      at java.io.BufferedInputStream.read1(BufferedInputStream.java: 
>> 254)
>>      at java.io.BufferedInputStream.read(BufferedInputStream.java: 
>> 313)
>>      at java.io.DataInputStream.read(DataInputStream.java:80)
>>      at org.apache.hadoop.mapred.MapOutputFile.write 
>> (MapOutputFile.java:110)
>>      at
>> org.apache.hadoop.io.ObjectWritable.writeObject 
>> (ObjectWritable.java:117)
>>      at org.apache.hadoop.io.ObjectWritable.write 
>> (ObjectWritable.java:64)
>>      at org.apache.hadoop.ipc.Server$Handler.run(Server.java:215)
>>
>>
>>
>
> ---------------------------------------------
> blog: http://www.find23.org
> company: http://www.media-style.com
>
>
>

---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Mon Mar 13 02:07:01 2006
Return-Path: 
 <hadoop-dev-return-372-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38725 invoked from network); 13 Mar 2006 02:07:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 02:07:01 -0000
Received: (qmail 58463 invoked by uid 500); 13 Mar 2006 02:07:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 58441 invoked by uid 500); 13 Mar 2006 02:07:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58429 invoked by uid 99); 13 Mar 2006 02:07:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Mar 2006 18:07:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Mar 2006 18:07:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3268E6ACAB
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 02:06:39 +0000 (GMT)
Message-ID: <762600013.1142215599202.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 02:06:39 +0000 (GMT)
From: "Stefan Groschupf (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-77) hang / crash when input folder does not
 exists.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

hang / crash when input folder does not exists.
-----------------------------------------------

         Key: HADOOP-77
         URL: http://issues.apache.org/jira/browse/HADOOP-77
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Versions: 0.1    
    Reporter: Stefan Groschupf
    Priority: Critical


The jobtracker hangs and jobtracker info server throws Internal Server Error when until task initialization a exception will be thrown. 
Future jobs will no processed and also the job info server does not show any information since it throws a a http 500.

This is a show blocker especially when hadoop is shell script driven. 


060312 235707 TaskInProgress tip_6jd6g8 has failed 4 times.
060312 235707 Aborting job job_hsg7y8
060312 235708 Server connection on port 50020 from  XX.100.XXX.2: exiting
060312 235709 Server connection on port 50020 from  XX.100.XXX.2: starting
060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
060312 235710 parsing /u1/hadoop-data/tmp/hadoop/mapred/local/jobTracker/job_2p6ywq.xml
060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
060312 235711 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
060312 235711 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
060312 235711 parsing /u1/hadoop-data/tmp/hadoop/mapred/local/jobTracker/job_2p6ywq.xml
060312 235711 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
060312 235712 job init failed
java.io.IOException: Not a file: /user/myuser/segments/20060312214035/crawl_fetch/part-00001/data
        at org.apache.hadoop.mapred.InputFormatBase.getSplits(InputFormatBase.java:99)
        at org.apache.hadoop.mapred.JobInProgress.initTasks(JobInProgress.java:127)
        at org.apache.hadoop.mapred.JobTracker$JobInitThread.run(JobTracker.java:208)
        at java.lang.Thread.run(Thread.java:595)
Exception in thread "Thread-20" java.lang.NullPointerException
        at org.apache.hadoop.mapred.JobInProgress.kill(JobInProgress.java:437)
        at org.apache.hadoop.mapred.JobTracker$JobInitThread.run(JobTracker.java:212)
        at java.lang.Thread.run(Thread.java:595)
060312 235713 Server connection on port 50020 from  XX.100.XXX.2: exiting

...


60312 235715 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
060312 235755 /jobtracker.jsp: 
java.lang.NullPointerException
        at org.apache.hadoop.mapred.JobInProgress.finishedMaps(JobInProgress.java:205)
        at org.apache.hadoop.mapred.jobtracker_jsp.generateJobTable(jobtracker_jsp.java:67)
        at org.apache.hadoop.mapred.jobtracker_jsp._jspService(jobtracker_jsp.java:130)
        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
        at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:427)
        at org.mortbay.jetty.servlet.WebApplicationHandler.dispatch(WebApplicationHandler.java:475)
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:567)
        at org.mortbay.http.HttpContext.handle(HttpContext.java:1565)
        at org.mortbay.jetty.servlet.WebApplicationContext.handle(WebApplicationContext.java:635)
        at org.mortbay.http.HttpContext.handle(HttpContext.java:1517)
        at org.mortbay.http.HttpServer.service(HttpServer.java:954)
        at org.mortbay.http.HttpConnection.service(HttpConnection.java:814)
        at org.mortbay.http.HttpConnection.handleNext(HttpConnection.java:981)
        at org.mortbay.http.HttpConnection.handle(HttpConnection.java:831)
        at org.mortbay.http.SocketListener.handleConnection(SocketListener.java:244)
        at org.mortbay.util.ThreadedServer.handle(ThreadedServer.java:357)
        at org.mortbay.util.ThreadPool$PoolThread.run(ThreadPool.java:534)
060313 014526 /jobtracker.jsp: 


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 02:09:05 2006
Return-Path: 
 <hadoop-dev-return-373-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39776 invoked from network); 13 Mar 2006 02:09:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 02:09:05 -0000
Received: (qmail 60445 invoked by uid 500); 13 Mar 2006 02:09:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60382 invoked by uid 500); 13 Mar 2006 02:09:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60373 invoked by uid 99); 13 Mar 2006 02:09:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Mar 2006 18:09:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Mar 2006 18:09:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 6F24FD49FD
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 02:08:41 +0000 (GMT)
Message-ID: <1688305331.1142215721452.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 02:08:41 +0000 (GMT)
From: "Stefan Groschupf (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-77) hang / crash when input folder does not
 exists.
In-Reply-To: <762600013.1142215599202.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-77?page=all ]

Stefan Groschupf updated HADOOP-77:
-----------------------------------

    Attachment: noNullMaps_AND_Reduces.patch

This patch solves the problem for me.

> hang / crash when input folder does not exists.
> -----------------------------------------------
>
>          Key: HADOOP-77
>          URL: http://issues.apache.org/jira/browse/HADOOP-77
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Stefan Groschupf
>     Priority: Critical
>  Attachments: noNullMaps_AND_Reduces.patch
>
> The jobtracker hangs and jobtracker info server throws Internal Server Error when until task initialization a exception will be thrown. 
> Future jobs will no processed and also the job info server does not show any information since it throws a a http 500.
> This is a show blocker especially when hadoop is shell script driven. 
> 060312 235707 TaskInProgress tip_6jd6g8 has failed 4 times.
> 060312 235707 Aborting job job_hsg7y8
> 060312 235708 Server connection on port 50020 from  XX.100.XXX.2: exiting
> 060312 235709 Server connection on port 50020 from  XX.100.XXX.2: starting
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
> 060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
> 060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
> 060312 235710 parsing /u1/hadoop-data/tmp/hadoop/mapred/local/jobTracker/job_2p6ywq.xml
> 060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235711 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
> 060312 235711 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
> 060312 235711 parsing /u1/hadoop-data/tmp/hadoop/mapred/local/jobTracker/job_2p6ywq.xml
> 060312 235711 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235712 job init failed
> java.io.IOException: Not a file: /user/myuser/segments/20060312214035/crawl_fetch/part-00001/data
>         at org.apache.hadoop.mapred.InputFormatBase.getSplits(InputFormatBase.java:99)
>         at org.apache.hadoop.mapred.JobInProgress.initTasks(JobInProgress.java:127)
>         at org.apache.hadoop.mapred.JobTracker$JobInitThread.run(JobTracker.java:208)
>         at java.lang.Thread.run(Thread.java:595)
> Exception in thread "Thread-20" java.lang.NullPointerException
>         at org.apache.hadoop.mapred.JobInProgress.kill(JobInProgress.java:437)
>         at org.apache.hadoop.mapred.JobTracker$JobInitThread.run(JobTracker.java:212)
>         at java.lang.Thread.run(Thread.java:595)
> 060312 235713 Server connection on port 50020 from  XX.100.XXX.2: exiting
> ...
> 60312 235715 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235755 /jobtracker.jsp: 
> java.lang.NullPointerException
>         at org.apache.hadoop.mapred.JobInProgress.finishedMaps(JobInProgress.java:205)
>         at org.apache.hadoop.mapred.jobtracker_jsp.generateJobTable(jobtracker_jsp.java:67)
>         at org.apache.hadoop.mapred.jobtracker_jsp._jspService(jobtracker_jsp.java:130)
>         at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)
>         at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
>         at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:427)
>         at org.mortbay.jetty.servlet.WebApplicationHandler.dispatch(WebApplicationHandler.java:475)
>         at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:567)
>         at org.mortbay.http.HttpContext.handle(HttpContext.java:1565)
>         at org.mortbay.jetty.servlet.WebApplicationContext.handle(WebApplicationContext.java:635)
>         at org.mortbay.http.HttpContext.handle(HttpContext.java:1517)
>         at org.mortbay.http.HttpServer.service(HttpServer.java:954)
>         at org.mortbay.http.HttpConnection.service(HttpConnection.java:814)
>         at org.mortbay.http.HttpConnection.handleNext(HttpConnection.java:981)
>         at org.mortbay.http.HttpConnection.handle(HttpConnection.java:831)
>         at org.mortbay.http.SocketListener.handleConnection(SocketListener.java:244)
>         at org.mortbay.util.ThreadedServer.handle(ThreadedServer.java:357)
>         at org.mortbay.util.ThreadPool$PoolThread.run(ThreadPool.java:534)
> 060313 014526 /jobtracker.jsp: 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 20:32:02 2006
Return-Path: 
 <hadoop-dev-return-374-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99662 invoked from network); 13 Mar 2006 20:32:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 20:32:02 -0000
Received: (qmail 68214 invoked by uid 500); 13 Mar 2006 20:32:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68143 invoked by uid 500); 13 Mar 2006 20:32:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68132 invoked by uid 99); 13 Mar 2006 20:32:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 12:32:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 12:32:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A5182D49FC
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 20:31:39 +0000 (GMT)
Message-ID: <1489036913.1142281899667.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 20:31:39 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-70?page=all ]
     
Doug Cutting resolved HADOOP-70:
--------------------------------

    Fix Version: 0.1
     Resolution: Fixed

I just committed this.

I changed things so that the test config files are in src/test rather than conf/junit.  That's the way Nutch does something similar, and it also requires a less classpath manipulation, since src/test is already on the test classpath (although I had to reorder things, to make sure it came ahead of conf/).  I also changed the conf files in src/test to be empty, forcing defaults to be used for unit tests.  Finally, to implement the test-cluster task, instead of copying the test task I parameterized the test task a bit and call it.

> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: junit-conf.patch
>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 20:41:19 2006
Return-Path: 
 <hadoop-dev-return-375-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3666 invoked from network); 13 Mar 2006 20:41:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 20:41:19 -0000
Received: (qmail 88057 invoked by uid 500); 13 Mar 2006 20:41:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88039 invoked by uid 500); 13 Mar 2006 20:41:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88030 invoked by uid 99); 13 Mar 2006 20:41:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 12:41:19 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 12:41:18 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 91F436ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 20:40:57 +0000 (GMT)
Message-ID: <338684052.1142282457590.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 20:40:57 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-77) hang / crash when input folder does
 not exists.
In-Reply-To: <762600013.1142215599202.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-77?page=all ]
     
Doug Cutting resolved HADOOP-77:
--------------------------------

    Fix Version: 0.1
     Resolution: Fixed

I have applied this patch.  Thanks, Stefan.

> hang / crash when input folder does not exists.
> -----------------------------------------------
>
>          Key: HADOOP-77
>          URL: http://issues.apache.org/jira/browse/HADOOP-77
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Stefan Groschupf
>     Priority: Critical
>      Fix For: 0.1
>  Attachments: noNullMaps_AND_Reduces.patch
>
> The jobtracker hangs and jobtracker info server throws Internal Server Error when until task initialization a exception will be thrown. 
> Future jobs will no processed and also the job info server does not show any information since it throws a a http 500.
> This is a show blocker especially when hadoop is shell script driven. 
> 060312 235707 TaskInProgress tip_6jd6g8 has failed 4 times.
> 060312 235707 Aborting job job_hsg7y8
> 060312 235708 Server connection on port 50020 from  XX.100.XXX.2: exiting
> 060312 235709 Server connection on port 50020 from  XX.100.XXX.2: starting
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
> 060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
> 060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
> 060312 235710 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
> 060312 235710 parsing /u1/hadoop-data/tmp/hadoop/mapred/local/jobTracker/job_2p6ywq.xml
> 060312 235710 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235711 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/hadoop-default.xml
> 060312 235711 parsing jar:file:/home/myuser/nutch/lib/hadoop-0.1-dev.jar!/mapred-default.xml
> 060312 235711 parsing /u1/hadoop-data/tmp/hadoop/mapred/local/jobTracker/job_2p6ywq.xml
> 060312 235711 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235712 job init failed
> java.io.IOException: Not a file: /user/myuser/segments/20060312214035/crawl_fetch/part-00001/data
>         at org.apache.hadoop.mapred.InputFormatBase.getSplits(InputFormatBase.java:99)
>         at org.apache.hadoop.mapred.JobInProgress.initTasks(JobInProgress.java:127)
>         at org.apache.hadoop.mapred.JobTracker$JobInitThread.run(JobTracker.java:208)
>         at java.lang.Thread.run(Thread.java:595)
> Exception in thread "Thread-20" java.lang.NullPointerException
>         at org.apache.hadoop.mapred.JobInProgress.kill(JobInProgress.java:437)
>         at org.apache.hadoop.mapred.JobTracker$JobInitThread.run(JobTracker.java:212)
>         at java.lang.Thread.run(Thread.java:595)
> 060312 235713 Server connection on port 50020 from  XX.100.XXX.2: exiting
> ...
> 60312 235715 parsing file:/home/myuser/nutch/conf/hadoop-site.xml
> 060312 235755 /jobtracker.jsp: 
> java.lang.NullPointerException
>         at org.apache.hadoop.mapred.JobInProgress.finishedMaps(JobInProgress.java:205)
>         at org.apache.hadoop.mapred.jobtracker_jsp.generateJobTable(jobtracker_jsp.java:67)
>         at org.apache.hadoop.mapred.jobtracker_jsp._jspService(jobtracker_jsp.java:130)
>         at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)
>         at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
>         at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:427)
>         at org.mortbay.jetty.servlet.WebApplicationHandler.dispatch(WebApplicationHandler.java:475)
>         at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:567)
>         at org.mortbay.http.HttpContext.handle(HttpContext.java:1565)
>         at org.mortbay.jetty.servlet.WebApplicationContext.handle(WebApplicationContext.java:635)
>         at org.mortbay.http.HttpContext.handle(HttpContext.java:1517)
>         at org.mortbay.http.HttpServer.service(HttpServer.java:954)
>         at org.mortbay.http.HttpConnection.service(HttpConnection.java:814)
>         at org.mortbay.http.HttpConnection.handleNext(HttpConnection.java:981)
>         at org.mortbay.http.HttpConnection.handle(HttpConnection.java:831)
>         at org.mortbay.http.SocketListener.handleConnection(SocketListener.java:244)
>         at org.mortbay.util.ThreadedServer.handle(ThreadedServer.java:357)
>         at org.mortbay.util.ThreadPool$PoolThread.run(ThreadPool.java:534)
> 060313 014526 /jobtracker.jsp: 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 20:43:01 2006
Return-Path: 
 <hadoop-dev-return-376-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4515 invoked from network); 13 Mar 2006 20:43:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 20:43:01 -0000
Received: (qmail 92886 invoked by uid 500); 13 Mar 2006 20:43:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92869 invoked by uid 500); 13 Mar 2006 20:43:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92860 invoked by uid 99); 13 Mar 2006 20:43:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 12:43:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 12:43:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9983B6ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 20:42:39 +0000 (GMT)
Message-ID: <655232577.1142282559626.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 20:42:39 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-70?page=comments#action_12370238 ] 

Owen O'Malley commented on HADOOP-70:
-------------------------------------

The unit tests should not be using /tmp for their data, because it won't be cleaned up and could conflict between users. By setting the config files to put the directories under build/test/data/run you are sure that it will be cleared at least the next time you run the test and each user has their own.

> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: junit-conf.patch
>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 22:06:36 2006
Return-Path: 
 <hadoop-dev-return-377-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48667 invoked from network); 13 Mar 2006 22:06:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 22:06:36 -0000
Received: (qmail 10720 invoked by uid 500); 13 Mar 2006 22:06:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10282 invoked by uid 500); 13 Mar 2006 22:06:06 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10152 invoked by uid 99); 13 Mar 2006 22:06:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 14:06:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 14:06:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 5F6606ACAE
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 22:05:41 +0000 (GMT)
Message-ID: <541511550.1142287541387.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 22:05:41 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-70?page=comments#action_12370252 ] 

Doug Cutting commented on HADOOP-70:
------------------------------------

Okay, I set the test configuration to write things to build/test instead of /tmp.  But, if temp really makes things fragile, then perhaps we should really change the default, rather than change the test, no?  Personally I slightly prefer /tmp for unit tests, since it is much faster when you're developing in an nfs-mounted home directory...

> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: junit-conf.patch
>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 22:44:15 2006
Return-Path: 
 <hadoop-dev-return-378-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72452 invoked from network); 13 Mar 2006 22:44:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 22:44:15 -0000
Received: (qmail 79411 invoked by uid 500); 13 Mar 2006 22:44:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79392 invoked by uid 500); 13 Mar 2006 22:44:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79380 invoked by uid 99); 13 Mar 2006 22:44:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 14:44:15 -0800
X-ASF-Spam-Status: No, hits=2.1 required=10.0
	tests=INFO_TLD,RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 14:44:14 -0800
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2DMhsYC001797
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 17:43:54 -0500
X-ORBL: [69.228.206.232]
Received: from [192.168.168.15] (adsl-69-228-206-232.dsl.pltn13.pacbell.net
 [69.228.206.232])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2DMhiSM130766;
	Mon, 13 Mar 2006 17:43:49 -0500
Message-ID: <4415F5A0.7050308@apache.org>
Date: Mon, 13 Mar 2006 14:43:44 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Hung job
References: <4411D1E5.3080807@archive.org>
In-Reply-To: <4411D1E5.3080807@archive.org>
Content-Type: multipart/mixed;
 boundary="------------070900040402010903020101"
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--------------070900040402010903020101
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

stack wrote:
> In synopsis the problem goes as follows:
> 
> If a reduce cannot pick up map outputs -- for example, the output has 
> been moved aside because of a ChecksumException (See below stack trace) 
> -- then the job gets stuck with the reduce task trying and failing every 
> ten seconds or so to pick up the non-existent map output part.
> 
> Somehow the reduce needs to give up and the jobtracker needs to rerun 
> the map just as it would if the tasktracker had died completely.

Perhaps what should happen is that the TaskTracker should exit when it 
encounters errors reading map output.  That way the jobtracker will 
re-schedule the map, and the reduce task will wait until that map is 
re-done.

I've attached a patch.  The TaskTracker will restart, but with a new id, 
so all of its tasks will be considered lost.  This will unfortunately 
lose other map tasks done by this tasktracker, but at least things will 
keep going.

Does this look right to you?

Doug

--------------070900040402010903020101
Content-Type: text/x-patch;
 name="mapout.patch"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="mapout.patch"

Index: src/java/org/apache/hadoop/mapred/TaskTracker.java
===================================================================
--- src/java/org/apache/hadoop/mapred/TaskTracker.java	(revision 385629)
+++ src/java/org/apache/hadoop/mapred/TaskTracker.java	(working copy)
@@ -305,6 +305,11 @@
               }
             }
             lastHeartbeat = now;
+
+            if (LogFormatter.hasLoggedSevere()) {
+              LOG.info("Severe problem detected.  TaskTracker exiting.");
+              return STALE_STATE;
+            }
         }
 
         return 0;
Index: src/java/org/apache/hadoop/mapred/MapOutputFile.java
===================================================================
--- src/java/org/apache/hadoop/mapred/MapOutputFile.java	(revision 385629)
+++ src/java/org/apache/hadoop/mapred/MapOutputFile.java	(working copy)
@@ -17,6 +17,7 @@
 package org.apache.hadoop.mapred;
 
 import java.io.IOException;
+import java.util.logging.Level;
 
 import java.io.*;
 import org.apache.hadoop.io.*;
@@ -108,12 +109,26 @@
     // write the length-prefixed file content to the wire
     File file = getOutputFile(mapTaskId, partition);
     out.writeLong(file.length());
-    FSDataInputStream in = FileSystem.getNamed("local", this.jobConf).open(file);
+
+    FSDataInputStream in = null;
     try {
+      in = FileSystem.getNamed("local", this.jobConf).open(file);
+    } catch (IOException e) {
+      // log a SEVERE exception in order to cause TaskTracker to exit
+      TaskTracker.LOG.log(Level.SEVERE, "Can't open map output:" + file, e);
+    }
+    try {
       byte[] buffer = new byte[8192];
-      int l;
-      while ((l = in.read(buffer)) != -1) {
+      int l  = 0;
+      
+      while (l != -1) {
         out.write(buffer, 0, l);
+        try {
+          l = in.read(buffer);
+        } catch (IOException e) {
+          // log a SEVERE exception in order to cause TaskTracker to exit
+          TaskTracker.LOG.log(Level.SEVERE,"Can't read map output:" + file, e);
+        }
       }
     } finally {
       in.close();

--------------070900040402010903020101--

From MAILER-DAEMON Mon Mar 13 22:49:01 2006
Return-Path: 
 <hadoop-dev-return-379-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74813 invoked from network); 13 Mar 2006 22:49:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 22:49:01 -0000
Received: (qmail 85128 invoked by uid 500); 13 Mar 2006 22:49:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85112 invoked by uid 500); 13 Mar 2006 22:49:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85100 invoked by uid 99); 13 Mar 2006 22:49:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 14:49:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 14:48:59 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DBA156ACAB
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 22:48:38 +0000 (GMT)
Message-ID: <1033369116.1142290118897.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 22:48:38 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-78) rpc commands not buffered
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

rpc commands not buffered
-------------------------

         Key: HADOOP-78
         URL: http://issues.apache.org/jira/browse/HADOOP-78
     Project: Hadoop
        Type: Bug
  Components: ipc  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.1


Calls using Hadoop's RPC framework get sent across the network byte by byte.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 22:55:49 2006
Return-Path: 
 <hadoop-dev-return-380-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77999 invoked from network); 13 Mar 2006 22:55:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 22:55:49 -0000
Received: (qmail 94556 invoked by uid 500); 13 Mar 2006 22:55:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94535 invoked by uid 500); 13 Mar 2006 22:55:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94526 invoked by uid 99); 13 Mar 2006 22:55:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 14:55:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 14:55:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 82964D49FC
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 22:55:27 +0000 (GMT)
Message-ID: <1097912282.1142290527532.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 22:55:27 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-78) rpc commands not buffered
In-Reply-To: <1033369116.1142290118897.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-78?page=all ]

Owen O'Malley updated HADOOP-78:
--------------------------------

    Attachment: rpc-buffer.patch

The problem is that the Connection object was doing:

out = new BufferedOutputStream(new FilteredOutputStream(sock.getOutputStream()) { 
// definition of write(byte[], int offset, int length)
});

The problem is that the write definition called super.write(byte[], int, int), which did a loop calling write(byte) for each byte. So I changed the definition to call out.write(byte[], int,int), which will send the array in a single call.

> rpc commands not buffered
> -------------------------
>
>          Key: HADOOP-78
>          URL: http://issues.apache.org/jira/browse/HADOOP-78
>      Project: Hadoop
>         Type: Bug
>   Components: ipc
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: rpc-buffer.patch
>
> Calls using Hadoop's RPC framework get sent across the network byte by byte.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 23:19:27 2006
Return-Path: 
 <hadoop-dev-return-381-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 86301 invoked from network); 13 Mar 2006 23:19:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 23:19:27 -0000
Received: (qmail 12203 invoked by uid 500); 13 Mar 2006 23:19:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12129 invoked by uid 500); 13 Mar 2006 23:19:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12099 invoked by uid 99); 13 Mar 2006 23:19:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 15:19:26 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 15:19:25 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 779DFD49FF
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 23:19:04 +0000 (GMT)
Message-ID: <1493250847.1142291944487.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 23:19:04 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-78) rpc commands not buffered
In-Reply-To: <1033369116.1142290118897.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-78?page=all ]
     
Doug Cutting resolved HADOOP-78:
--------------------------------

    Resolution: Fixed

Thanks for catching this, Owen!  This can make a big performance difference!

> rpc commands not buffered
> -------------------------
>
>          Key: HADOOP-78
>          URL: http://issues.apache.org/jira/browse/HADOOP-78
>      Project: Hadoop
>         Type: Bug
>   Components: ipc
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: rpc-buffer.patch
>
> Calls using Hadoop's RPC framework get sent across the network byte by byte.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 23:43:21 2006
Return-Path: 
 <hadoop-dev-return-382-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96661 invoked from network); 13 Mar 2006 23:43:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 23:43:21 -0000
Received: (qmail 35407 invoked by uid 500); 13 Mar 2006 23:43:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35337 invoked by uid 500); 13 Mar 2006 23:43:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35328 invoked by uid 99); 13 Mar 2006 23:43:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 15:43:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [207.241.224.171] (HELO ia00524.archive.org) (207.241.224.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 15:43:19 -0800
Received: (qmail 10772 invoked by uid 100); 13 Mar 2006 23:35:04 -0000
Received: from adsl-71-130-102-77.dsl.pltn13.pacbell.net (HELO
 ?192.168.1.197?) (stack@archive.org@71.130.102.77)
  by mail-dev.archive.org with SMTP; 13 Mar 2006 23:35:04 -0000
Message-ID: <441603B7.9080809@archive.org>
Date: Mon, 13 Mar 2006 15:43:51 -0800
From: stack <stack@archive.org>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US;
 rv:1.8) Gecko/20051219 SeaMonkey/1.0b
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Hung job
References: <4411D1E5.3080807@archive.org> <4415F5A0.7050308@apache.org>
In-Reply-To: <4415F5A0.7050308@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Spam-DCC: : 
X-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org
X-Spam-Level: 
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-97.2 required=7.0 tests=AWL,USER_IN_WHITELIST
	autolearn=no version=2.63
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> stack wrote:
>> ...
>>
>> Somehow the reduce needs to give up and the jobtracker needs to rerun 
>> the map just as it would if the tasktracker had died completely.
> 
> Perhaps what should happen is that the TaskTracker should exit when it 
> encounters errors reading map output.....
> 
> I've attached a patch.  The TaskTracker will restart, but with a new id, 
> so all of its tasks will be considered lost.  This will unfortunately 
> lose other map tasks done by this tasktracker, but at least things will 
> keep going.
> 
> Does this look right to you?
> 

Yes. Sounds like right thing to do. Minor comments in the below. 
Meantime, let me try it.
Thanks,
St.Ack


> Doug
> 
> 
...

>  
>          return 0;
> Index: src/java/org/apache/hadoop/mapred/MapOutputFile.java
> ===================================================================
> --- src/java/org/apache/hadoop/mapred/MapOutputFile.java	(revision 385629)
> +++ src/java/org/apache/hadoop/mapred/MapOutputFile.java	(working copy)
> @@ -17,6 +17,7 @@
>  package org.apache.hadoop.mapred;
>  
>  import java.io.IOException;
> +import java.util.logging.Level;
>  
>  import java.io.*;
>  import org.apache.hadoop.io.*;
> @@ -108,12 +109,26 @@
>      // write the length-prefixed file content to the wire
>      File file = getOutputFile(mapTaskId, partition);
>      out.writeLong(file.length());
> -    FSDataInputStream in = FileSystem.getNamed("local", this.jobConf).open(file);
> +
> +    FSDataInputStream in = null;
>      try {
> +      in = FileSystem.getNamed("local", this.jobConf).open(file);
> +    } catch (IOException e) {
> +      // log a SEVERE exception in order to cause TaskTracker to exit
> +      TaskTracker.LOG.log(Level.SEVERE, "Can't open map output:" + file, e);
> +

Should there be a 'throw e;' after TaskTracker.LOG.log above?



     }
> +    try {
>        byte[] buffer = new byte[8192];
> -      int l;
> -      while ((l = in.read(buffer)) != -1) {
> +      int l  = 0;
> +      
> +      while (l != -1) {
>          out.write(buffer, 0, l);
> +        try {
> +          l = in.read(buffer);
> +        } catch (IOException e) {
> +          // log a SEVERE exception in order to cause TaskTracker to exit
> +          TaskTracker.LOG.log(Level.SEVERE,"Can't read map output:" + file, e);


And same here.


> +        }
>        }
>      } finally {
>        in.close();


From MAILER-DAEMON Mon Mar 13 23:54:29 2006
Return-Path: 
 <hadoop-dev-return-383-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1951 invoked from network); 13 Mar 2006 23:54:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 23:54:29 -0000
Received: (qmail 50615 invoked by uid 500); 13 Mar 2006 23:54:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50563 invoked by uid 500); 13 Mar 2006 23:54:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50043 invoked by uid 99); 13 Mar 2006 23:54:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 15:54:24 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 15:54:24 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 1D533D49F9
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 23:54:03 +0000 (GMT)
Message-ID: <545017918.1142294043118.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 23:54:03 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-79) listFiles optimization
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

listFiles optimization
----------------------

         Key: HADOOP-79
         URL: http://issues.apache.org/jira/browse/HADOOP-79
     Project: Hadoop
        Type: Improvement
  Components: dfs  
    Reporter: Konstantin Shvachko


In FSDirectory.getListing() looking at line
listing[i] = new DFSFileInfo(curName, cur.computeFileLength(), cur.computeContentsLength(), isDir(curName));

1. computeContentsLength() is actually calling computeFileLength(), so this is called twice,
meaning that file length is calculated twice.
2. isDir() is looking for the INode (starting from the rootDir) that has actually been obtained
just two lines above, note that the tree is locked by that time.

I propose a simple optimization for this, see attachment.

3. A related question: Why DFSFileInfo needs 2 separate fields len for file length and
contentsLen for directory contents size? It looks like these fields are mutually exclusive,
and we can use just one, interpreting it one way or another with respect to the value of isDir.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 13 23:56:06 2006
Return-Path: 
 <hadoop-dev-return-384-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 2470 invoked from network); 13 Mar 2006 23:56:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 13 Mar 2006 23:56:06 -0000
Received: (qmail 51132 invoked by uid 500); 13 Mar 2006 23:56:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51066 invoked by uid 500); 13 Mar 2006 23:56:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51057 invoked by uid 99); 13 Mar 2006 23:56:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 15:56:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 15:56:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 74DF0D49FC
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 23:55:39 +0000 (GMT)
Message-ID: <1074572359.1142294139476.JavaMail.jira@ajax>
Date: Mon, 13 Mar 2006 23:55:39 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-79) listFiles optimization
In-Reply-To: <545017918.1142294043118.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-79?page=all ]

Konstantin Shvachko updated HADOOP-79:
--------------------------------------

    Attachment: DFSFileInfo.patch

> listFiles optimization
> ----------------------
>
>          Key: HADOOP-79
>          URL: http://issues.apache.org/jira/browse/HADOOP-79
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Reporter: Konstantin Shvachko
>  Attachments: DFSFileInfo.patch
>
> In FSDirectory.getListing() looking at line
> listing[i] = new DFSFileInfo(curName, cur.computeFileLength(), cur.computeContentsLength(), isDir(curName));
> 1. computeContentsLength() is actually calling computeFileLength(), so this is called twice,
> meaning that file length is calculated twice.
> 2. isDir() is looking for the INode (starting from the rootDir) that has actually been obtained
> just two lines above, note that the tree is locked by that time.
> I propose a simple optimization for this, see attachment.
> 3. A related question: Why DFSFileInfo needs 2 separate fields len for file length and
> contentsLen for directory contents size? It looks like these fields are mutually exclusive,
> and we can use just one, interpreting it one way or another with respect to the value of isDir.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 14 00:46:30 2006
Return-Path: 
 <hadoop-dev-return-385-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 25897 invoked from network); 14 Mar 2006 00:46:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 00:46:30 -0000
Received: (qmail 12522 invoked by uid 500); 14 Mar 2006 00:46:30 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12455 invoked by uid 500); 14 Mar 2006 00:46:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12446 invoked by uid 99); 14 Mar 2006 00:46:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 16:46:30 -0800
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 16:46:26 -0800
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2E0k1bL019146
	for <hadoop-dev@lucene.apache.org>; Mon, 13 Mar 2006 19:46:02 -0500
X-ORBL: [69.228.206.232]
Received: from [192.168.168.15] (adsl-69-228-206-232.dsl.pltn13.pacbell.net
 [69.228.206.232])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2E0jwMo048414;
	Mon, 13 Mar 2006 19:46:02 -0500
Message-ID: <44161245.8060301@apache.org>
Date: Mon, 13 Mar 2006 16:45:57 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Hung job
References: <4411D1E5.3080807@archive.org> <4415F5A0.7050308@apache.org>
 <441603B7.9080809@archive.org>
In-Reply-To: <441603B7.9080809@archive.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

stack wrote:
> Yes. Sounds like right thing to do. Minor comments in the below. 
> Meantime, let me try it.

Great.  Please report on whether this works for you.

> Should there be a 'throw e;' after TaskTracker.LOG.log above?

Yes.  You're right, there should be.

Cheers,

Doug

From MAILER-DAEMON Tue Mar 14 02:11:14 2006
Return-Path: 
 <hadoop-dev-return-386-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68071 invoked from network); 14 Mar 2006 02:11:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 02:11:14 -0000
Received: (qmail 94307 invoked by uid 500); 14 Mar 2006 02:11:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94240 invoked by uid 500); 14 Mar 2006 02:11:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94231 invoked by uid 99); 14 Mar 2006 02:11:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 18:11:07 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 18:11:06 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 775D0144407
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 03:01:59 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 24201-09 for <hadoop-dev@lucene.apache.org>;
	Tue, 14 Mar 2006 03:01:59 +0100 (CET)
Received: from [192.168.8.2] (dslb-088-073-207-055.pools.arcor-ip.net
 [88.73.207.55])
	by mslinux.media-style.com (Postfix) with ESMTP id 1D5EE144405
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 03:01:58 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
Content-Transfer-Encoding: 7bit
Message-Id: <D8343EB6-27A4-411F-8F0E-0D84B558A682@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: reduce phase never completed
Date: Tue, 14 Mar 2006 03:10:38 +0100
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
why the reducePhase in the ReduceTask is never completed  
(  reducePhase.complete()) ? As far I see all other will cleanly  
completed.
As far I understand this is just cosmetic and have no meaning for the  
processing itself, right?

Thanks for comments.
Stefan


---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Tue Mar 14 03:16:17 2006
Return-Path: 
 <hadoop-dev-return-387-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 737 invoked from network); 14 Mar 2006 03:16:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 03:16:17 -0000
Received: (qmail 44161 invoked by uid 500); 14 Mar 2006 03:16:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44140 invoked by uid 500); 14 Mar 2006 03:16:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44131 invoked by uid 99); 14 Mar 2006 03:16:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 19:16:16 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 19:16:14 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 18589144407
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 04:07:08 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 24376-09 for <hadoop-dev@lucene.apache.org>;
	Tue, 14 Mar 2006 04:07:07 +0100 (CET)
Received: from [192.168.8.2] (dslb-088-073-207-055.pools.arcor-ip.net
 [88.73.207.55])
	by mslinux.media-style.com (Postfix) with ESMTP id 932DA144405
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 04:07:07 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749)
Content-Transfer-Encoding: 7bit
Message-Id: <BEAB1FB8-82D6-4DEF-A656-80DC09067603@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: reducing hang: does size matter?
Date: Tue, 14 Mar 2006 04:15:50 +0100
X-Mailer: Apple Mail (2.749)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
I opened a new thread since I'm not sure if this related to Michael  
Stack' problem.
I tried the patch from Doug without throwing the exception and it  
does not solve the problem.
However with a set of changes like catch exception inside the reduce  
iteration of the method run,  I was able to get my job running but  
with a much smaller size as the other that failed.
I now started again a bigger job, but crawling  1 mio  take some  
time. ;-(

I'm asking my self if size matters?

I notice following:
+ the reduce task that is the slowest crash in the end (my since it  
is the largest ? )
+ it crash in the last 2 % of of reducing (so it is not related to  
copy map output files ? )
+ all writes that are used have a XX.close(Reporter reporter) method  
but never use the reporter.
I didn't find any processing intensive close implementation but may  
be in the end a set of writers need to be closed, may be that takes  
that long?
The only thing I found is that in DFSOutputStream#close is a   
Thread.sleep(400) may since there is a set of writer using dfs that  
could be an issue. In general working with timeouts and having a  
sleep could be difficult.
Since there is also a namenode.complete call done, can this may block  
the closing of writers since replication need to be created?

Any thoughts are very welcome!!

Thanks!
Stefan




---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Tue Mar 14 05:25:26 2006
Return-Path: 
 <hadoop-dev-return-388-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47675 invoked from network); 14 Mar 2006 05:25:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 05:25:26 -0000
Received: (qmail 44104 invoked by uid 500); 14 Mar 2006 05:25:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 44079 invoked by uid 500); 14 Mar 2006 05:25:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 44070 invoked by uid 99); 14 Mar 2006 05:25:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 21:25:25 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 21:25:24 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id ED739D49FE
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 05:25:03 +0000 (GMT)
Message-ID: <649114010.1142313903969.JavaMail.jira@ajax>
Date: Tue, 14 Mar 2006 05:25:03 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-23) single node cluster gets one reducer
In-Reply-To: <311066960.1139255217392.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-23?page=all ]
     
Owen O'Malley resolved HADOOP-23:
---------------------------------

    Resolution: Won't Fix

> single node cluster gets one reducer
> ------------------------------------
>
>          Key: HADOOP-23
>          URL: http://issues.apache.org/jira/browse/HADOOP-23
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Owen O'Malley
>     Priority: Minor

>
> Running on a single node cluster (it runs a job tracker and a single task tracker), even though my application asks for 7 reduces, it only gets one. I haven't tracked down what is happening yet.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 14 05:41:08 2006
Return-Path: 
 <hadoop-dev-return-389-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52927 invoked from network); 14 Mar 2006 05:41:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 05:41:08 -0000
Received: (qmail 51245 invoked by uid 500); 14 Mar 2006 05:41:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51228 invoked by uid 500); 14 Mar 2006 05:41:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51218 invoked by uid 99); 14 Mar 2006 05:41:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 21:41:07 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 21:41:07 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 6665ED49F9
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 05:40:46 +0000 (GMT)
Message-ID: <1471671223.1142314846409.JavaMail.jira@ajax>
Date: Tue, 14 Mar 2006 05:40:46 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-66) dfs client writes all data for a chunk
 to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-66?page=all ]

Owen O'Malley updated HADOOP-66:
--------------------------------

    Attachment: tmp-delete.patch

There is a method on File to delete the file when the jvm exits. Here is a patch that calls the method on the temporary block files. Apparently there is a bug in the jvm under windows so that the files are only deleted if they are closed. For linux or solaris users, this should make sure that no block files end up being dropped by the application.

> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: no-tmp.patch, tmp-delete.patch
>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 14 07:20:19 2006
Return-Path: 
 <hadoop-dev-return-390-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93151 invoked from network); 14 Mar 2006 07:20:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 07:20:19 -0000
Received: (qmail 51873 invoked by uid 500); 14 Mar 2006 07:20:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51805 invoked by uid 500); 14 Mar 2006 07:20:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51790 invoked by uid 99); 14 Mar 2006 07:20:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 23:20:18 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 23:20:18 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3C0396ACAA
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 07:19:57 +0000 (GMT)
Message-ID: <870267772.1142320797243.JavaMail.jira@ajax>
Date: Tue, 14 Mar 2006 07:19:57 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-80) binary key
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

binary key
----------

         Key: HADOOP-80
         URL: http://issues.apache.org/jira/browse/HADOOP-80
     Project: Hadoop
        Type: New Feature
  Components: io  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.1
 Attachments: binary-key.patch

I needed a binary key type, so I extended BytesWritable to be comparable also.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 14 07:20:21 2006
Return-Path: 
 <hadoop-dev-return-391-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93172 invoked from network); 14 Mar 2006 07:20:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 07:20:21 -0000
Received: (qmail 51902 invoked by uid 500); 14 Mar 2006 07:20:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51889 invoked by uid 500); 14 Mar 2006 07:20:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51879 invoked by uid 99); 14 Mar 2006 07:20:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 23:20:21 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Mar 2006 23:20:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9756CD49FE
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 07:19:59 +0000 (GMT)
Message-ID: <700896832.1142320799617.JavaMail.jira@ajax>
Date: Tue, 14 Mar 2006 07:19:59 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-80) binary key
In-Reply-To: <870267772.1142320797243.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-80?page=all ]

Owen O'Malley updated HADOOP-80:
--------------------------------

    Attachment: binary-key.patch

> binary key
> ----------
>
>          Key: HADOOP-80
>          URL: http://issues.apache.org/jira/browse/HADOOP-80
>      Project: Hadoop
>         Type: New Feature
>   Components: io
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: binary-key.patch
>
> I needed a binary key type, so I extended BytesWritable to be comparable also.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 14 16:27:10 2006
Return-Path: 
 <hadoop-dev-return-392-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80811 invoked from network); 14 Mar 2006 16:27:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 16:27:10 -0000
Received: (qmail 9824 invoked by uid 500); 14 Mar 2006 16:27:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9798 invoked by uid 500); 14 Mar 2006 16:27:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9789 invoked by uid 99); 14 Mar 2006 16:27:09 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 08:27:09 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of toelen@gmail.com designates
 64.233.182.198 as permitted sender)
Received: from [64.233.182.198] (HELO nproxy.gmail.com) (64.233.182.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 08:27:07 -0800
Received: by nproxy.gmail.com with SMTP id b2so1095402nfe
        for <hadoop-dev@lucene.apache.org>;
 Tue, 14 Mar 2006 08:26:46 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=b30hoQpwrdQADQwXzHFBLGxmbCKsXZSRqv4nrmKaGnXqdBZ1GOzbv/1sQNea5S4iP+snn0eKmpduzzMwCPA0R/J+ELH4gJXguasxgab00TyQsrlGihZy8A2odq6mB1vYBMWIQZXM331j+7iSXisI4WK63+7S0mpwFYPBgEa2H5w=
Received: by 10.49.67.17 with SMTP id u17mr2274719nfk;
        Tue, 14 Mar 2006 08:26:46 -0800 (PST)
Received: by 10.49.60.20 with HTTP; Tue, 14 Mar 2006 08:26:46 -0800 (PST)
Message-ID: <a494a0bc0603140826s5bca8556k5b62fb27577b19ff@mail.gmail.com>
Date: Tue, 14 Mar 2006 17:26:46 +0100
From: "Leen Toelen" <toelen@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Code examples
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

could someone point me to some code examples to use Hadoo? Something
like a distributed grep would be great.

Regards,
Leen Toelen

From MAILER-DAEMON Tue Mar 14 16:38:49 2006
Return-Path: 
 <hadoop-dev-return-393-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87926 invoked from network); 14 Mar 2006 16:38:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 16:38:49 -0000
Received: (qmail 40414 invoked by uid 500); 14 Mar 2006 16:38:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40370 invoked by uid 500); 14 Mar 2006 16:38:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40318 invoked by uid 99); 14 Mar 2006 16:38:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 08:38:38 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 08:38:36 -0800
Received: from [207.126.231.161] (oom-mac.corp.yahoo.com [207.126.231.161])
	by mrout3.yahoo.com (8.13.4/8.13.4/y.out) with ESMTP id k2EGbNnH091626;
	Tue, 14 Mar 2006 08:37:23 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=in-reply-to:references:mime-version:content-type:message-id:
	content-transfer-encoding:cc:from:subject:date:to:x-mailer;
	b=D4gpsGMOA+Tge4pW5Ti3jpiq4vu9Oav1oiIuKOrfL58YZ5vLo9fNTOeSRC5NNDtl
In-Reply-To: <a494a0bc0603140826s5bca8556k5b62fb27577b19ff@mail.gmail.com>
References: <a494a0bc0603140826s5bca8556k5b62fb27577b19ff@mail.gmail.com>
Mime-Version: 1.0 (Apple Message framework v623)
Content-Type: text/plain; charset=US-ASCII; format=flowed
Message-Id: <9dc170df027c1394ba8df4bd3169112a@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
Cc: hadoop-dev@lucene.apache.org
From: "Owen O'Malley" <owen@yahoo-inc.com>
Subject: Re: Code examples
Date: Tue, 14 Mar 2006 08:37:24 -0800
To: Leen Toelen <toelen@gmail.com>
X-Mailer: Apple Mail (2.623)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


On Mar 14, 2006, at 8:26 AM, Leen Toelen wrote:

> Hi,
>
> could someone point me to some code examples to use Hadoo? Something
> like a distributed grep would be great.

There are word count and grep examples in src/examples. I also have the 
trivial sort example with IdentityMap and IdentityReduce that I'll 
submit this week.

-- Owen


From MAILER-DAEMON Tue Mar 14 17:24:33 2006
Return-Path: 
 <hadoop-dev-return-394-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20212 invoked from network); 14 Mar 2006 17:24:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 17:24:33 -0000
Received: (qmail 40109 invoked by uid 500); 14 Mar 2006 17:24:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40042 invoked by uid 500); 14 Mar 2006 17:24:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40033 invoked by uid 99); 14 Mar 2006 17:24:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 09:24:32 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 09:24:31 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 06829144405
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 18:15:18 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 28548-10 for <hadoop-dev@lucene.apache.org>;
	Tue, 14 Mar 2006 18:15:17 +0100 (CET)
Received: from [192.168.200.61] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id D5827144403
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 18:15:17 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v746.2)
Content-Transfer-Encoding: 7bit
Message-Id: <62B6B2A9-48DB-4D85-86EB-DF763DCF5437@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Marko Bauhardt <mb@media-style.com>
Subject: killing a local job never worked?
Date: Tue, 14 Mar 2006 18:19:54 +0100
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi developers.
How to kill a local running job?

I use hadoop localrunner integrated in a virtual machine.
The api allows to kill a local job but looks like this had never  
worked as killing a distributed job works today.
The problem I see is that in the LocaljobRunner the stop method of  
the private inner class job (what is a thread) is triggered.
But this method only kills the job but never kills the running map  
and reduce tasks that still use job resources.
The result is when trigger kill job in a localJobRunner the tasks  
throws tons for NPE's.

What people think about implementing a  clean kill method instead  
using Thread.stop in the inner class job of the LocaljobRunner?

Thanks for any comments.
Marko.





From MAILER-DAEMON Tue Mar 14 17:56:05 2006
Return-Path: 
 <hadoop-dev-return-395-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37759 invoked from network); 14 Mar 2006 17:56:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 17:56:05 -0000
Received: (qmail 84311 invoked by uid 500); 14 Mar 2006 17:56:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84289 invoked by uid 500); 14 Mar 2006 17:56:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84280 invoked by uid 99); 14 Mar 2006 17:56:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 09:56:04 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.74] (HELO ylpvm43.prodigy.net) (207.115.57.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 09:56:03 -0800
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm43.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2EHtjBf031861
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 12:55:46 -0500
X-ORBL: [69.228.206.232]
Received: from [192.168.168.15] (adsl-69-228-206-232.dsl.pltn13.pacbell.net
 [69.228.206.232])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2EHtXRl039416;
	Tue, 14 Mar 2006 12:55:35 -0500
Message-ID: <44170394.8070103@apache.org>
Date: Tue, 14 Mar 2006 09:55:32 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: killing a local job never worked?
References: <62B6B2A9-48DB-4D85-86EB-DF763DCF5437@media-style.com>
In-Reply-To: <62B6B2A9-48DB-4D85-86EB-DF763DCF5437@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Marko Bauhardt wrote:
> How to kill a local running job?
> 
> I use hadoop localrunner integrated in a virtual machine.
> The api allows to kill a local job but looks like this had never  worked 
> as killing a distributed job works today.
> The problem I see is that in the LocaljobRunner the stop method of  the 
> private inner class job (what is a thread) is triggered.
> But this method only kills the job but never kills the running map  and 
> reduce tasks that still use job resources.

The map and reduce tasks are run in the job thread, and so should be 
killed by thread.stop() too, no?  Unless the map or reduce have threads 
of their own (like Nutch's Fetcher).  In that case we should probably 
fix the mapper or reducer to exit when the mapper or reducer parent 
thread exits, no?

> The result is when trigger kill job in a localJobRunner the tasks  
> throws tons for NPE's.
> 
> What people think about implementing a  clean kill method instead  using 
> Thread.stop in the inner class job of the LocaljobRunner?

In a distributed configuration, map and reduce tasks discover that 
they're parent tasktracker has been killed when the ping() method throws 
an exception.  This causes the child JVM to exit, killing all its 
threads.  So we should make ping() and all other callback methods in 
LocalJobRunner throw an exception once the job has been killed.  But the 
framework can have no knowledge of threads started by the mapper or 
reducer.  These threads must be somehow stopped by the mapper or reducer 
itself when the job thread is killed.  In a distributed configuration 
this is automatic, since they're in a separate JVM that exits, but with 
LocalJobRunner the mapper and reducer must become more responsible.

You might argue that we should support a cleaner shutdown protocol.  But 
we must be able to handle unclean shutdowns anyway, when, e.g., JVMs 
exit unexpectedly.  Since we need to be able to handle such unclean 
shutdowns, there's really no point in also supporting a clean shutdown 
too, it just adds complexity.  So, in LocalJobRunner, I think 
thread.stop() on the job thread is sufficient.  Does that make sense?

Doug

From MAILER-DAEMON Tue Mar 14 19:16:52 2006
Return-Path: 
 <hadoop-dev-return-396-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83348 invoked from network); 14 Mar 2006 19:16:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 19:16:52 -0000
Received: (qmail 11734 invoked by uid 500); 14 Mar 2006 19:16:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11716 invoked by uid 500); 14 Mar 2006 19:16:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11707 invoked by uid 99); 14 Mar 2006 19:16:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 11:16:51 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [207.241.224.171] (HELO ia00524.archive.org) (207.241.224.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 11:16:50 -0800
Received: (qmail 31861 invoked by uid 100); 14 Mar 2006 19:08:33 -0000
Received: from adsl-71-130-102-77.dsl.pltn13.pacbell.net (HELO
 ?192.168.1.197?) (stack@archive.org@71.130.102.77)
  by mail-dev.archive.org with SMTP; 14 Mar 2006 19:08:33 -0000
Message-ID: <441716C4.3020106@archive.org>
Date: Tue, 14 Mar 2006 11:17:24 -0800
From: stack <stack@archive.org>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US;
 rv:1.8) Gecko/20051219 SeaMonkey/1.0b
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Hung job
References: <4411D1E5.3080807@archive.org> <4415F5A0.7050308@apache.org>
 <441603B7.9080809@archive.org> <44161245.8060301@apache.org>
In-Reply-To: <44161245.8060301@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Spam-DCC: : 
X-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org
X-Spam-Level: 
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-97.2 required=7.0 tests=AWL,USER_IN_WHITELIST
	autolearn=no version=2.63
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> stack wrote:
>> Yes. Sounds like right thing to do. Minor comments in the below. 
>> Meantime, let me try it.
> 
> Great.  Please report on whether this works for you.
> 
>> Should there be a 'throw e;' after TaskTracker.LOG.log above?
> 
> Yes.  You're right, there should be.

I ran overnight and had the same issue where map output had been moved 
aside because of a Checksum error -- looks like I have bad memory in one 
of my slaves -- only this time, when a reducer tried to pick up the 
mangled output, the tasktracker was restarted... so the patch looks like 
its doing the right thing (I lost a lot of jobs unfortunately but, at 
least we keep going).

Thanks,
St.Ack


> 
> Cheers,
> 
> Doug


From MAILER-DAEMON Tue Mar 14 20:11:03 2006
Return-Path: 
 <hadoop-dev-return-397-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7432 invoked from network); 14 Mar 2006 20:11:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 20:11:03 -0000
Received: (qmail 79233 invoked by uid 500); 14 Mar 2006 20:11:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79163 invoked by uid 500); 14 Mar 2006 20:11:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79150 invoked by uid 99); 14 Mar 2006 20:11:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 12:11:02 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 12:11:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3A3A26ACA9
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 20:10:41 +0000 (GMT)
Message-ID: <1639770950.1142367041235.JavaMail.jira@ajax>
Date: Tue, 14 Mar 2006 20:10:41 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-80) binary key
In-Reply-To: <870267772.1142320797243.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-80?page=comments#action_12370406 ] 

Doug Cutting commented on HADOOP-80:
------------------------------------

Overall this looks good.  A couple of questions:

1. Why call setSize(0) in read()?  This looks like a no-op.  Am I missing something?

2. Why bother to use md5 for hashCode()?  That could be expensive.  Why not implement this like java.util.Arrays.hashCode() and UTF8.hashCode():

  public int hashCode() {
    int hash = 1;
    for (int i = 0; i < size; i++)
      hash = (31 * hash) + (int)bytes[i];
    return hash;
  }



> binary key
> ----------
>
>          Key: HADOOP-80
>          URL: http://issues.apache.org/jira/browse/HADOOP-80
>      Project: Hadoop
>         Type: New Feature
>   Components: io
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: binary-key.patch
>
> I needed a binary key type, so I extended BytesWritable to be comparable also.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 14 20:29:02 2006
Return-Path: 
 <hadoop-dev-return-398-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24815 invoked from network); 14 Mar 2006 20:29:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 20:29:02 -0000
Received: (qmail 11922 invoked by uid 500); 14 Mar 2006 20:29:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 11903 invoked by uid 500); 14 Mar 2006 20:29:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 11894 invoked by uid 99); 14 Mar 2006 20:29:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 12:29:02 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 12:29:01 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D2AF2D49FC
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 20:28:40 +0000 (GMT)
Message-ID: <313497596.1142368120859.JavaMail.jira@ajax>
Date: Tue, 14 Mar 2006 20:28:40 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-66) dfs client writes all data for a
 chunk to /tmp
In-Reply-To: <549957597.1141689449195.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-66?page=comments#action_12370407 ] 

Doug Cutting commented on HADOOP-66:
------------------------------------

Should we worry about the space this consumes?  For each block a client writes there will be memory allocated containing the path name to the temporary file that cannot be gc'd.  If that's 100 bytes, then 1M blocks would generate 100MB, which would be a big leak.  But writing 1M blocks means writing 32TB from a single JVM, which would take around a month (at current dfs speeds).  If we increase the block size (as has been discussed) then the rate is slowed proportionally.  So I guess we don't worry about this "leak"?

> dfs client writes all data for a chunk to /tmp
> ----------------------------------------------
>
>          Key: HADOOP-66
>          URL: http://issues.apache.org/jira/browse/HADOOP-66
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: no-tmp.patch, tmp-delete.patch
>
> The dfs client writes all the data for the current chunk to a file in /tmp, when the chunk is complete it is shipped out to the Datanodes. This can cause /tmp to fill up fast when a lot of files are being written. A potentially better scheme is to buffer the written data in RAM (application code can set the buffer size) and flush it to the Datanodes when the buffer fills up.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 14 20:58:07 2006
Return-Path: 
 <hadoop-dev-return-399-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41602 invoked from network); 14 Mar 2006 20:58:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 14 Mar 2006 20:58:07 -0000
Received: (qmail 56400 invoked by uid 500); 14 Mar 2006 20:58:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56377 invoked by uid 500); 14 Mar 2006 20:58:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56367 invoked by uid 99); 14 Mar 2006 20:58:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 12:58:07 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 12:58:06 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 674FDD49FD
	for <hadoop-dev@lucene.apache.org>; Tue, 14 Mar 2006 20:57:45 +0000 (GMT)
Message-ID: <275193024.1142369865420.JavaMail.jira@ajax>
Date: Tue, 14 Mar 2006 20:57:45 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-79) listFiles optimization
In-Reply-To: <545017918.1142294043118.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-79?page=all ]
     
Doug Cutting resolved HADOOP-79:
--------------------------------

    Fix Version: 0.1
     Resolution: Fixed
      Assign To: Konstantin Shvachko

This looks fine to me.  I simplified FSDirectory.isDir() a bit more & committed this.

Did you find this to be a bottleneck in benchmarks?  BTW, I have had some success profiling Hadoop daemons using Sun's built-in sampling profiler.  I simply set HADOOP_OPTS to  '-agentlib:hprof=cpu=samples,interval=20' before starting a daemon.  Then, when I stop that daemon, it dumps profile data to a text file.

And, finally, yes, DFSFileInfo could re-use the length field for both purposes.  But this class is only used for interchange, right?, so making it small will only serve to make RPC's a bit faster and won't save a lot of memory.

> listFiles optimization
> ----------------------
>
>          Key: HADOOP-79
>          URL: http://issues.apache.org/jira/browse/HADOOP-79
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.1
>  Attachments: DFSFileInfo.patch
>
> In FSDirectory.getListing() looking at line
> listing[i] = new DFSFileInfo(curName, cur.computeFileLength(), cur.computeContentsLength(), isDir(curName));
> 1. computeContentsLength() is actually calling computeFileLength(), so this is called twice,
> meaning that file length is calculated twice.
> 2. isDir() is looking for the INode (starting from the rootDir) that has actually been obtained
> just two lines above, note that the tree is locked by that time.
> I propose a simple optimization for this, see attachment.
> 3. A related question: Why DFSFileInfo needs 2 separate fields len for file length and
> contentsLen for directory contents size? It looks like these fields are mutually exclusive,
> and we can use just one, interpreting it one way or another with respect to the value of isDir.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 00:56:47 2006
Return-Path: 
 <hadoop-dev-return-400-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53973 invoked from network); 15 Mar 2006 00:56:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 00:56:47 -0000
Received: (qmail 76859 invoked by uid 500); 15 Mar 2006 00:56:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76834 invoked by uid 500); 15 Mar 2006 00:56:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76825 invoked by uid 99); 15 Mar 2006 00:56:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 16:56:47 -0800
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [207.241.224.171] (HELO ia00524.archive.org) (207.241.224.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 16:56:46 -0800
Received: (qmail 18379 invoked by uid 100); 15 Mar 2006 00:48:28 -0000
Received: from adsl-71-130-102-77.dsl.pltn13.pacbell.net (HELO
 ?192.168.1.197?) (stack@archive.org@71.130.102.77)
  by mail-dev.archive.org with SMTP; 15 Mar 2006 00:48:28 -0000
Message-ID: <44176670.1020903@archive.org>
Date: Tue, 14 Mar 2006 16:57:20 -0800
From: stack <stack@archive.org>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US;
 rv:1.8) Gecko/20051219 SeaMonkey/1.0b
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Hung job
References: <4411D1E5.3080807@archive.org> <4415F5A0.7050308@apache.org>
 <441603B7.9080809@archive.org>
In-Reply-To: <441603B7.9080809@archive.org>
Content-Type: multipart/mixed;
 boundary="------------000204030208010702020400"
X-Spam-DCC: : 
X-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org
X-Spam-Level: 
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-97.3 required=7.0 tests=AWL,USER_IN_WHITELIST
	autolearn=no version=2.63
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--------------000204030208010702020400
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Whoops.

Need a means of resetting the LogFormatter loggedSevere flag when doing 
a STALE_STATE soft restart of TaskTracker otherwise, TaskTracker comes 
back up, checks loggedSevere, its set (still), so we restart again... ad 
infinitum.  Suggested patch attached.

Thanks,
St.Ack






stack wrote:
> Doug Cutting wrote:
>> stack wrote:
>>> ...
>>>
>>> Somehow the reduce needs to give up and the jobtracker needs to rerun 
>>> the map just as it would if the tasktracker had died completely.
>>
>> Perhaps what should happen is that the TaskTracker should exit when it 
>> encounters errors reading map output.....
>>
>> I've attached a patch.  The TaskTracker will restart, but with a new 
>> id, so all of its tasks will be considered lost.  This will 
>> unfortunately lose other map tasks done by this tasktracker, but at 
>> least things will keep going.
>>
>> Does this look right to you?
>>
> 
> Yes. Sounds like right thing to do. Minor comments in the below. 
> Meantime, let me try it.
> Thanks,
> St.Ack
> 
> 
>> Doug
>>
>>
> ...
> 
>>  
>>          return 0;
>> Index: src/java/org/apache/hadoop/mapred/MapOutputFile.java
>> ===================================================================
>> --- src/java/org/apache/hadoop/mapred/MapOutputFile.java    (revision 
>> 385629)
>> +++ src/java/org/apache/hadoop/mapred/MapOutputFile.java    (working 
>> copy)
>> @@ -17,6 +17,7 @@
>>  package org.apache.hadoop.mapred;
>>  
>>  import java.io.IOException;
>> +import java.util.logging.Level;
>>  
>>  import java.io.*;
>>  import org.apache.hadoop.io.*;
>> @@ -108,12 +109,26 @@
>>      // write the length-prefixed file content to the wire
>>      File file = getOutputFile(mapTaskId, partition);
>>      out.writeLong(file.length());
>> -    FSDataInputStream in = FileSystem.getNamed("local", 
>> this.jobConf).open(file);
>> +
>> +    FSDataInputStream in = null;
>>      try {
>> +      in = FileSystem.getNamed("local", this.jobConf).open(file);
>> +    } catch (IOException e) {
>> +      // log a SEVERE exception in order to cause TaskTracker to exit
>> +      TaskTracker.LOG.log(Level.SEVERE, "Can't open map output:" + 
>> file, e);
>> +
> 
> Should there be a 'throw e;' after TaskTracker.LOG.log above?
> 
> 
> 
>     }
>> +    try {
>>        byte[] buffer = new byte[8192];
>> -      int l;
>> -      while ((l = in.read(buffer)) != -1) {
>> +      int l  = 0;
>> +      +      while (l != -1) {
>>          out.write(buffer, 0, l);
>> +        try {
>> +          l = in.read(buffer);
>> +        } catch (IOException e) {
>> +          // log a SEVERE exception in order to cause TaskTracker to 
>> exit
>> +          TaskTracker.LOG.log(Level.SEVERE,"Can't read map output:" + 
>> file, e);
> 
> 
> And same here.
> 
> 
>> +        }
>>        }
>>      } finally {
>>        in.close();
> 


--------------000204030208010702020400
Content-Type: text/plain;
 name="reset-logformatter-severe-flag.patch"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="reset-logformatter-severe-flag.patch"

Index: src/java/org/apache/hadoop/mapred/TaskTracker.java
===================================================================
--- src/java/org/apache/hadoop/mapred/TaskTracker.java	(revision 385860)
+++ src/java/org/apache/hadoop/mapred/TaskTracker.java	(working copy)
@@ -308,6 +308,7 @@
 
             if (LogFormatter.hasLoggedSevere()) {
               LOG.info("Severe problem detected.  TaskTracker exiting.");
+              LogFormatter.resetLoggedSevere();
               return STALE_STATE;
             }
         }
Index: src/java/org/apache/hadoop/util/LogFormatter.java
===================================================================
--- src/java/org/apache/hadoop/util/LogFormatter.java	(revision 385860)
+++ src/java/org/apache/hadoop/util/LogFormatter.java	(working copy)
@@ -113,6 +113,10 @@
   public static boolean hasLoggedSevere() {
     return loggedSevere;
   }
+  
+  public static void resetLoggedSevere() {
+      loggedSevere = false;
+  }
 
   /** Returns a stream that, when written to, adds log lines. */
   public static PrintStream getLogStream(final Logger logger,

--------------000204030208010702020400--

From MAILER-DAEMON Wed Mar 15 02:42:18 2006
Return-Path: 
 <hadoop-dev-return-401-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 2783 invoked from network); 15 Mar 2006 02:42:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 02:42:18 -0000
Received: (qmail 26476 invoked by uid 500); 15 Mar 2006 02:42:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26453 invoked by uid 500); 15 Mar 2006 02:42:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26444 invoked by uid 99); 15 Mar 2006 02:42:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 18:42:17 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 18:42:17 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3DF9E6ACA9
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 02:41:56 +0000 (GMT)
Message-ID: <761823543.1142390516251.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 02:41:56 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-79) listFiles optimization
In-Reply-To: <545017918.1142294043118.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-79?page=comments#action_12370447 ] 

Konstantin Shvachko commented on HADOOP-79:
-------------------------------------------

No, it was not really a bottleneck.
Interesting about the profiling. Is it JMX or something else?
Yes, DFSFileInfo is for reporting only, so it does not save space.
It might save some code though, since when you have one field you 
probably don't need two different finctions to extract it.

> listFiles optimization
> ----------------------
>
>          Key: HADOOP-79
>          URL: http://issues.apache.org/jira/browse/HADOOP-79
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.1
>  Attachments: DFSFileInfo.patch
>
> In FSDirectory.getListing() looking at line
> listing[i] = new DFSFileInfo(curName, cur.computeFileLength(), cur.computeContentsLength(), isDir(curName));
> 1. computeContentsLength() is actually calling computeFileLength(), so this is called twice,
> meaning that file length is calculated twice.
> 2. isDir() is looking for the INode (starting from the rootDir) that has actually been obtained
> just two lines above, note that the tree is locked by that time.
> I propose a simple optimization for this, see attachment.
> 3. A related question: Why DFSFileInfo needs 2 separate fields len for file length and
> contentsLen for directory contents size? It looks like these fields are mutually exclusive,
> and we can use just one, interpreting it one way or another with respect to the value of isDir.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 04:26:04 2006
Return-Path: 
 <hadoop-dev-return-402-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41785 invoked from network); 15 Mar 2006 04:26:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 04:26:04 -0000
Received: (qmail 24308 invoked by uid 500); 15 Mar 2006 04:26:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24252 invoked by uid 500); 15 Mar 2006 04:26:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24218 invoked by uid 99); 15 Mar 2006 04:26:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 20:26:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 20:26:03 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 20C796ACAD
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 04:25:42 +0000 (GMT)
Message-ID: <939071396.1142396742131.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 04:25:42 +0000 (GMT)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-70) the two file system tests TestDFS and
 TestFileSystem take too long
In-Reply-To: <1531661681.1141860698913.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-70?page=comments#action_12370462 ] 

eric baldeschwieler commented on HADOOP-70:
-------------------------------------------

I vote for changing the default.  If using /tmp makes sense in your setup, you should be free to change the default.  We should making doing so globally easy.  But we should steer free of using /tmp unless asked to.  It is one of those things that just bites folks over and over and over again.

> the two file system tests TestDFS and TestFileSystem take too long
> ------------------------------------------------------------------
>
>          Key: HADOOP-70
>          URL: http://issues.apache.org/jira/browse/HADOOP-70
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: junit-conf.patch
>
> Running "ant test" takes hours and uses the conf directory, which forces it to run on the real cluster.
> I propose that we split rename the test classes from
> src/test/org/apache/hadoop/dfs/TestDFS.java to LongTestDFS.java
> src/test/org/apache/hadoop/fs/TestFileSystem.java to LongTestFileSystem.java
> and then we set up a new ant target "long-test" that runs all tests that match "**/LongTest*.java".

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 07:23:21 2006
Return-Path: 
 <hadoop-dev-return-403-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9450 invoked from network); 15 Mar 2006 07:23:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 07:23:21 -0000
Received: (qmail 59125 invoked by uid 500); 15 Mar 2006 07:23:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59077 invoked by uid 500); 15 Mar 2006 07:23:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 58804 invoked by uid 99); 15 Mar 2006 07:23:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 23:23:17 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 23:23:17 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2C31DD4A00
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 07:22:56 +0000 (GMT)
Message-ID: <1176660641.1142407376177.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 07:22:56 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-80) binary key
In-Reply-To: <870267772.1142320797243.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-80?page=comments#action_12370477 ] 

Owen O'Malley commented on HADOOP-80:
-------------------------------------

> 1. Why call setSize(0) in read()? This looks like a no-op. Am I missing something?

Yeah, that is a little subtle and I should have commented it better. Basically, when I do the second setSize, it may call setCapacity, which will copy the current data. If the current size is 0, then it won't copy anything. It won't change the user visible behavior, but will save a useless copy.

> 2. Why bother to use md5 for hashCode()?  That could be expensive.  Why not implement this like 
> java.util.Arrays.hashCode() and UTF8.hashCode():

Yeah, I considered doing something lighter than md5, but using md5 prevents pathological cases from doing bad things. We also use md5 a lot around here, so it is a really useful default for us, but it might make sense to have a lighter hash alternative. However, since in map/reduce the hash function is only used for partitioning the map output, it seemed better to use a known good hash function than taking a chance on a fast but sloppy hash function.


> binary key
> ----------
>
>          Key: HADOOP-80
>          URL: http://issues.apache.org/jira/browse/HADOOP-80
>      Project: Hadoop
>         Type: New Feature
>   Components: io
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: binary-key.patch
>
> I needed a binary key type, so I extended BytesWritable to be comparable also.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 07:27:01 2006
Return-Path: 
 <hadoop-dev-return-404-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13341 invoked from network); 15 Mar 2006 07:27:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 07:27:01 -0000
Received: (qmail 66271 invoked by uid 500); 15 Mar 2006 07:27:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66249 invoked by uid 500); 15 Mar 2006 07:27:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66240 invoked by uid 99); 15 Mar 2006 07:27:00 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 23:27:00 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 23:27:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 242A0D49FE
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 07:26:39 +0000 (GMT)
Message-ID: <27190139.1142407599145.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 07:26:39 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-81) speculative execution is only
 controllable from the default config
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

speculative execution is only controllable from the default config
------------------------------------------------------------------

         Key: HADOOP-81
         URL: http://issues.apache.org/jira/browse/HADOOP-81
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.1


The application's JobConf is not consulted when checking whether speculative execution should be used.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 07:38:23 2006
Return-Path: 
 <hadoop-dev-return-405-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20496 invoked from network); 15 Mar 2006 07:38:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 07:38:23 -0000
Received: (qmail 83321 invoked by uid 500); 15 Mar 2006 07:38:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83267 invoked by uid 500); 15 Mar 2006 07:38:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83189 invoked by uid 99); 15 Mar 2006 07:38:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 23:38:14 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Mar 2006 23:38:12 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B3F2BD49FE
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 07:37:51 +0000 (GMT)
Message-ID: <1909278952.1142408271734.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 07:37:51 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-81) speculative execution is only
 controllable from the default config
In-Reply-To: <27190139.1142407599145.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-81?page=all ]

Owen O'Malley updated HADOOP-81:
--------------------------------

    Attachment: local-spec-exec.patch

This patch does:

Changes the JobInProgress and TaskInProgress to keep the JobConf, which is the job specific configuration,
rather than the system-wide configuration.
Adds set/get speculative execution methods to the JobConf, so that applications don't need to get the string literal right.
On a side note, I also made all of the fields in TaskInProgress private rather than package-local.

> speculative execution is only controllable from the default config
> ------------------------------------------------------------------
>
>          Key: HADOOP-81
>          URL: http://issues.apache.org/jira/browse/HADOOP-81
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: local-spec-exec.patch
>
> The application's JobConf is not consulted when checking whether speculative execution should be used.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 08:03:03 2006
Return-Path: 
 <hadoop-dev-return-406-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37066 invoked from network); 15 Mar 2006 08:03:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 08:03:03 -0000
Received: (qmail 8275 invoked by uid 500); 15 Mar 2006 08:03:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8258 invoked by uid 500); 15 Mar 2006 08:03:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8249 invoked by uid 99); 15 Mar 2006 08:03:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 00:03:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 00:03:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 937CBD49FD
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 08:02:41 +0000 (GMT)
Message-ID: <220823489.1142409761601.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 08:02:41 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-80) binary key
In-Reply-To: <870267772.1142320797243.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-80?page=all ]

Owen O'Malley updated HADOOP-80:
--------------------------------

    Attachment: binary-key-2.patch

This updated patch handles the case of shrinking the buffer's capacity. It also adds testing code for that situation into the unit test.

> binary key
> ----------
>
>          Key: HADOOP-80
>          URL: http://issues.apache.org/jira/browse/HADOOP-80
>      Project: Hadoop
>         Type: New Feature
>   Components: io
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: binary-key-2.patch, binary-key.patch
>
> I needed a binary key type, so I extended BytesWritable to be comparable also.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 08:12:30 2006
Return-Path: 
 <hadoop-dev-return-407-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42191 invoked from network); 15 Mar 2006 08:12:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 08:12:30 -0000
Received: (qmail 17461 invoked by uid 500); 15 Mar 2006 08:12:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 17444 invoked by uid 500); 15 Mar 2006 08:12:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 17435 invoked by uid 99); 15 Mar 2006 08:12:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 00:12:28 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 00:12:28 -0800
Received: from [10.10.16.233] ([64.71.164.125])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k2F8C7M19171
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 02:12:08 -0600
Message-ID: <4417CCAC.5060306@getopt.org>
Date: Wed, 15 Mar 2006 09:13:32 +0100
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Commented: (HADOOP-80) binary key
References: <1176660641.1142407376177.JavaMail.jira@ajax>
In-Reply-To: <1176660641.1142407376177.JavaMail.jira@ajax>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Owen O'Malley (JIRA) wrote:
>> 2. Why bother to use md5 for hashCode()?  That could be expensive.  Why not implement this like 
>> java.util.Arrays.hashCode() and UTF8.hashCode():
>>     
>
> Yeah, I considered doing something lighter than md5, but using md5 prevents pathological cases from doing bad things. We also use md5 a lot around here, so it is a really useful default for us, but it might make sense to have a lighter hash alternative. However, since in map/reduce the hash function is only used for partitioning the map output, it seemed better to use a known good hash function than taking a chance on a fast but sloppy hash function.
>   

You can find an FNV hash implementation here: http://www.getopt.org 
(Apache license). Computationally it's similar in complexity to the 
above hashing schemes, but gives much better distribution. Perhaps worth 
a try.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Wed Mar 15 16:19:39 2006
Return-Path: 
 <hadoop-dev-return-408-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 58522 invoked from network); 15 Mar 2006 16:19:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 16:19:39 -0000
Received: (qmail 14597 invoked by uid 500); 15 Mar 2006 16:19:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14557 invoked by uid 500); 15 Mar 2006 16:19:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14547 invoked by uid 99); 15 Mar 2006 16:19:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 08:19:34 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 08:19:34 -0800
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k2FF9LZ20474;
	Wed, 15 Mar 2006 07:09:21 -0800
Message-ID: <44183E80.7090604@archive.org>
Date: Wed, 15 Mar 2006 08:19:12 -0800
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Hung job
References: <4411D1E5.3080807@archive.org> <4415F5A0.7050308@apache.org>
 <441603B7.9080809@archive.org> <44161245.8060301@apache.org>
In-Reply-To: <44161245.8060301@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I ran overnight with the patch submitted to this list yesterday that 
adds a LogFormatter.resetLoggedSevere.  Twice during the night the 
TaskTracker was restarted because map outputs failed checksum when 
reducer came in to pick up map output parts.  Each time TaskTracker came 
back up... eventually.  The interesting thing was that it took 9 and 12 
restarts respectively as TaskTracker would restart anew because we 
didn't have the map output an incoming reducer was asking for (I'm 
assuming the incoming reducer has not yet been updated by jobtracker of 
the new state of affairs).

This situation is a big improvement over how things used work but seems 
as though we should try and avoid the TaskTracker start/stop churn.  
Possibilities:

1. Add a damper so TaskTracker keeps its head down a while so its not 
around when Reducer's come looking for missing map outputs, or
2. Not have map output file log severe if taskid map part being 
requested is not one the TaskTracker knows about.

Neither of the above is very pretty.  Any other suggestions?  Otherwise 
I'll look into a patch to do a variation on 2. above.

Thanks,
St.Ack


Doug Cutting wrote:
> stack wrote:
>> Yes. Sounds like right thing to do. Minor comments in the below. 
>> Meantime, let me try it.
>
> Great.  Please report on whether this works for you.
>
>> Should there be a 'throw e;' after TaskTracker.LOG.log above?
>
> Yes.  You're right, there should be.
>
> Cheers,
>
> Doug


From MAILER-DAEMON Wed Mar 15 17:16:20 2006
Return-Path: 
 <hadoop-dev-return-409-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96859 invoked from network); 15 Mar 2006 17:16:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 17:16:20 -0000
Received: (qmail 29304 invoked by uid 500); 15 Mar 2006 17:16:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29234 invoked by uid 500); 15 Mar 2006 17:16:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29218 invoked by uid 99); 15 Mar 2006 17:16:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 09:16:19 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 09:16:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2622BD49FC
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 17:15:58 +0000 (GMT)
Message-ID: <945994663.1142442958144.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 17:15:58 +0000 (GMT)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-82) JobTracker loses it:
 NoSuchElementException
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

JobTracker loses it: NoSuchElementException
-------------------------------------------

         Key: HADOOP-82
         URL: http://issues.apache.org/jira/browse/HADOOP-82
     Project: Hadoop
        Type: Bug
    Reporter: stack@archive.org
    Priority: Minor


On a number of occasions, JobTracker goes into a loop that it never recovers from.  Over and over it prints the below to the jobtracker log.

060304 124522 Server handler 5 on 8010 call error: java.io.IOException: java.util.NoSuchElementException
java.io.IOException: java.util.NoSuchElementException
   at java.util.TreeMap.key(TreeMap.java:433)
   at java.util.TreeMap.firstKey(TreeMap.java:287)
   at java.util.TreeSet.first(TreeSet.java:407)
   at org.apache.hadoop.mapred.TaskInProgress.getTaskToRun(TaskInProgress.java:428Timed out.org.apache.hadoop.fs.ChecksumException: Checksum error:/2/hadoop/nara/data/tmp/task_r_m80hob/all.1 at 1554810368 at
org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122)
at org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98)
at org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158)
at java.io.BufferedInputStream.fill(BufferedInputStream.java:218) at
java.io.BufferedInputStream.read(BufferedInputStream.java:235) at
org.apache.hadoop.fs.FSDataInputStream$Buffer.read(FSDataInputStream.java:210)
at java.io.DataInputStream.readInt(DataInputStream.java:353) at
org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:367) at
org.apache.hadoop.io.SequenceFile$Sorter$SortPass.run(SequenceFile.java:557)
at org.apache.hadoop.io.SequenceFile$Sorter.sortPass(SequenceFile.java:523)
at org.apache.hadoop.io.SequenceFile$Sorter.sort(SequenceFile.java:511)
at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:254) at
org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:666)

I added debug to TIP#getTaskToRun so i could tell which TIP had empted its allotment of tasks.  Below is extract from jobtracker log that shows sequence of events for TIP tip_fizr7m that lead up to JT losing it:

060314 203637 Adding task 'task_m_4d6ht0' to tip tip_fizr7m, for tracker 'tracker_41791' on ia109314.archive.org 
060314 204758 Task 'task_m_4d6ht0' has been lost.
060314 204811 Adding task 'task_m_fb0wf0' to tip tip_fizr7m, for tracker 'tracker_70065' on ia109314.archive.org
060314 210118 Task 'task_m_fb0wf0' has been lost.
060314 210119 Adding task 'task_m_irar47' to tip tip_fizr7m, for tracker 'tracker_82285' on ia109324.archive.org
060314 211541 Taskid 'task_m_irar47' has finished successfully.
060314 211541 Task 'task_m_irar47' has completed.
060314 211543 Adding task 'task_m_qo1g69' to tip tip_fizr7m, for tracker 'tracker_97839' on ia109306.archive.org
060314 213004 Taskid 'task_m_qo1g69' has finished successfully.
060314 213004 Task 'task_m_qo1g69' has completed.
060314 213005 Adding task 'task_m_t0lnzk' to tip tip_fizr7m, for tracker 'tracker_57273' on ia109314.archive.org
060314 214118 Task 'task_m_t0lnzk' has been lost.

So, we lose two, complete two, then lose a third.

TIP should have been done on first completion.

TIP accounting is off.




-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 17:19:23 2006
Return-Path: 
 <hadoop-dev-return-410-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99149 invoked from network); 15 Mar 2006 17:19:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 17:19:23 -0000
Received: (qmail 43484 invoked by uid 500); 15 Mar 2006 17:19:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43466 invoked by uid 500); 15 Mar 2006 17:19:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43457 invoked by uid 99); 15 Mar 2006 17:19:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 09:19:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 09:19:21 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id AD98FD49FC
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 17:19:00 +0000 (GMT)
Message-ID: <907585125.1142443140679.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 17:19:00 +0000 (GMT)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-82) JobTracker loses it:
 NoSuchElementException
In-Reply-To: <945994663.1142442958144.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-82?page=all ]

stack@archive.org updated HADOOP-82:
------------------------------------

    Attachment: completes.patch

Patch that stops completes going < 0.

> JobTracker loses it: NoSuchElementException
> -------------------------------------------
>
>          Key: HADOOP-82
>          URL: http://issues.apache.org/jira/browse/HADOOP-82
>      Project: Hadoop
>         Type: Bug
>     Reporter: stack@archive.org
>     Priority: Minor
>  Attachments: completes.patch
>
> On a number of occasions, JobTracker goes into a loop that it never recovers from.  Over and over it prints the below to the jobtracker log.
> 060304 124522 Server handler 5 on 8010 call error: java.io.IOException: java.util.NoSuchElementException
> java.io.IOException: java.util.NoSuchElementException
>    at java.util.TreeMap.key(TreeMap.java:433)
>    at java.util.TreeMap.firstKey(TreeMap.java:287)
>    at java.util.TreeSet.first(TreeSet.java:407)
>    at org.apache.hadoop.mapred.TaskInProgress.getTaskToRun(TaskInProgress.java:428Timed out.org.apache.hadoop.fs.ChecksumException: Checksum error:/2/hadoop/nara/data/tmp/task_r_m80hob/all.1 at 1554810368 at
> org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122)
> at org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98)
> at org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158)
> at java.io.BufferedInputStream.fill(BufferedInputStream.java:218) at
> java.io.BufferedInputStream.read(BufferedInputStream.java:235) at
> org.apache.hadoop.fs.FSDataInputStream$Buffer.read(FSDataInputStream.java:210)
> at java.io.DataInputStream.readInt(DataInputStream.java:353) at
> org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:367) at
> org.apache.hadoop.io.SequenceFile$Sorter$SortPass.run(SequenceFile.java:557)
> at org.apache.hadoop.io.SequenceFile$Sorter.sortPass(SequenceFile.java:523)
> at org.apache.hadoop.io.SequenceFile$Sorter.sort(SequenceFile.java:511)
> at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:254) at
> org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:666)
> I added debug to TIP#getTaskToRun so i could tell which TIP had empted its allotment of tasks.  Below is extract from jobtracker log that shows sequence of events for TIP tip_fizr7m that lead up to JT losing it:
> 060314 203637 Adding task 'task_m_4d6ht0' to tip tip_fizr7m, for tracker 'tracker_41791' on ia109314.archive.org 
> 060314 204758 Task 'task_m_4d6ht0' has been lost.
> 060314 204811 Adding task 'task_m_fb0wf0' to tip tip_fizr7m, for tracker 'tracker_70065' on ia109314.archive.org
> 060314 210118 Task 'task_m_fb0wf0' has been lost.
> 060314 210119 Adding task 'task_m_irar47' to tip tip_fizr7m, for tracker 'tracker_82285' on ia109324.archive.org
> 060314 211541 Taskid 'task_m_irar47' has finished successfully.
> 060314 211541 Task 'task_m_irar47' has completed.
> 060314 211543 Adding task 'task_m_qo1g69' to tip tip_fizr7m, for tracker 'tracker_97839' on ia109306.archive.org
> 060314 213004 Taskid 'task_m_qo1g69' has finished successfully.
> 060314 213004 Task 'task_m_qo1g69' has completed.
> 060314 213005 Adding task 'task_m_t0lnzk' to tip tip_fizr7m, for tracker 'tracker_57273' on ia109314.archive.org
> 060314 214118 Task 'task_m_t0lnzk' has been lost.
> So, we lose two, complete two, then lose a third.
> TIP should have been done on first completion.
> TIP accounting is off.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 19:00:25 2006
Return-Path: 
 <hadoop-dev-return-411-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73058 invoked from network); 15 Mar 2006 19:00:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 19:00:25 -0000
Received: (qmail 75741 invoked by uid 500); 15 Mar 2006 19:00:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75721 invoked by uid 500); 15 Mar 2006 19:00:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75712 invoked by uid 99); 15 Mar 2006 19:00:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 11:00:24 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 11:00:23 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 445B1D49FD
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 19:00:02 +0000 (GMT)
Message-ID: <671256830.1142449198957.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 18:59:58 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-83) infinite retries accessing a missing
 block
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

infinite retries accessing a missing block
------------------------------------------

         Key: HADOOP-83
         URL: http://issues.apache.org/jira/browse/HADOOP-83
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Versions: 0.1    
    Reporter: Yoram Arnon


A file in the DFS got corrupted - the reason for that is unknown, but might be justified.

when accessing the file, I get an infinite stream of error messages from the client - attached below.
The client aparently increments an error counter, but never checks it.

Correct behaviour is for the client to retry a few times, then abort.


060315 105436 No node available for block blk_2690692619196463439
060315 105436 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105446 No node available for block blk_2690692619196463439
060315 105446 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105456 No node available for block blk_2690692619196463439
060315 105456 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105506 No node available for block blk_2690692619196463439
060315 105506 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105516 No node available for block blk_2690692619196463439
060315 105516 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105526 No node available for block blk_2690692619196463439
060315 105526 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105536 No node available for block blk_2690692619196463439
060315 105536 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105546 No node available for block blk_2690692619196463439
060315 105546 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105556 No node available for block blk_2690692619196463439
060315 105556 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105606 No node available for block blk_2690692619196463439
060315 105606 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105616 No node available for block blk_2690692619196463439
060315 105616 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105626 No node available for block blk_2690692619196463439
060315 105626 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105636 No node available for block blk_2690692619196463439
060315 105636 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105646 No node available for block blk_2690692619196463439
060315 105646 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105657 No node available for block blk_2690692619196463439
060315 105657 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105707 No node available for block blk_2690692619196463439
060315 105707 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105717 No node available for block blk_2690692619196463439
060315 105717 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105727 No node available for block blk_2690692619196463439
060315 105727 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105737 No node available for block blk_2690692619196463439
060315 105737 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105747 No node available for block blk_2690692619196463439
060315 105747 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105757 No node available for block blk_2690692619196463439
060315 105757 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105807 No node available for block blk_2690692619196463439
060315 105807 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105817 No node available for block blk_2690692619196463439


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 19:02:33 2006
Return-Path: 
 <hadoop-dev-return-412-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76361 invoked from network); 15 Mar 2006 19:02:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 19:02:33 -0000
Received: (qmail 78220 invoked by uid 500); 15 Mar 2006 19:02:30 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78179 invoked by uid 500); 15 Mar 2006 19:02:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78058 invoked by uid 99); 15 Mar 2006 19:02:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 11:02:26 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 11:02:24 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0E0B36ACAD
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 19:02:04 +0000 (GMT)
Message-ID: <555225226.1142449324055.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 19:02:04 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-84) client should report file name in which
 IO exception occurs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

client should report file name in which IO exception occurs
-----------------------------------------------------------

         Key: HADOOP-84
         URL: http://issues.apache.org/jira/browse/HADOOP-84
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Versions: 0.1    
    Reporter: Yoram Arnon
    Priority: Minor


A file in the DFS got corrupted somehow.
The client gets an exception accessing a block in the file:

060315 105907 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
060315 105917 No node available for block blk_2690692619196463439

It could (and should) report the file in which the error occurred, together with the block information.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 19:49:25 2006
Return-Path: 
 <hadoop-dev-return-413-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10855 invoked from network); 15 Mar 2006 19:49:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 19:49:25 -0000
Received: (qmail 45490 invoked by uid 500); 15 Mar 2006 19:49:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 45469 invoked by uid 500); 15 Mar 2006 19:49:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Delivered-To: moderator for hadoop-dev@lucene.apache.org
Received: (qmail 22723 invoked by uid 99); 15 Mar 2006 19:28:58 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Message-ID: <44186B1B.50008@duboce.net>
Date: Wed, 15 Mar 2006 11:29:31 -0800
From: "stack@duboce.net" <stack@duboce.net>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US;
 rv:1.8) Gecko/20051219 SeaMonkey/1.0b
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: issue tracking link is wrong
Content-Type: multipart/mixed;
 boundary="------------050207040009080600050406"
X-Spam-DCC: : 
X-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org
X-Spam-Level: 
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=0.3 required=7.0 tests=HTML_MESSAGE,
	HTML_TAG_BALANCE_BODY autolearn=no version=2.63
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--------------050207040009080600050406
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Points at nagoya.apache.org.  It works if I change page to point at 
issues.apache.org.  Patch attached.
St.Ack

--------------050207040009080600050406
Content-Type: text/plain;
 name="issue_tracking_link.patch"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="issue_tracking_link.patch"

Index: src/site/src/documentation/content/xdocs/issue_tracking.xml
===================================================================
--- src/site/src/documentation/content/xdocs/issue_tracking.xml	(revision 385860)
+++ src/site/src/documentation/content/xdocs/issue_tracking.xml	(working copy)
@@ -11,7 +11,7 @@
   <body>
     <p>
       Hadoop issues (bugs, as well as enhancement requests) are tracked in 
-      Apache JIRA <a href="http://nagoya.apache.org/jira/browse/HADOOP">here</a>.
+      Apache JIRA <a href="http://issues.apache.org/jira/browse/HADOOP">here</a>.
       If you aren't sure whether something is a bug, post a question on the
       Hadoop user <a href="mailing_lists.html">mailing list</a>.
     </p>

--------------050207040009080600050406--

From MAILER-DAEMON Wed Mar 15 21:45:21 2006
Return-Path: 
 <hadoop-dev-return-414-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93432 invoked from network); 15 Mar 2006 21:45:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 21:45:21 -0000
Received: (qmail 19023 invoked by uid 500); 15 Mar 2006 21:45:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18953 invoked by uid 500); 15 Mar 2006 21:45:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18944 invoked by uid 99); 15 Mar 2006 21:45:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 13:45:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 13:45:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 119766ACA9
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 21:44:59 +0000 (GMT)
Message-ID: <1854913738.1142459099064.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 21:44:59 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-85) a single client stuck in a loop blocks
 all clients on same machine
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

a single client stuck in a loop blocks all clients on same machine
------------------------------------------------------------------

         Key: HADOOP-85
         URL: http://issues.apache.org/jira/browse/HADOOP-85
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Versions: 0.1    
    Reporter: Yoram Arnon


I was running a set of clients, running cp from one dfs to another dfs using fuse, one file per cp process.
One client got stuck in a loop because of a bad block in one of the files (separate bug filed).
The other clients, running in parallel in the background, all stopped making progress on their respective files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 23:42:22 2006
Return-Path: 
 <hadoop-dev-return-415-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54681 invoked from network); 15 Mar 2006 23:42:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 23:42:22 -0000
Received: (qmail 16619 invoked by uid 500); 15 Mar 2006 23:42:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16547 invoked by uid 500); 15 Mar 2006 23:42:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16531 invoked by uid 99); 15 Mar 2006 23:42:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 15:42:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 15:42:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DCC5A6ACA9
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 23:41:58 +0000 (GMT)
Message-ID: <310043566.1142466118898.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 23:41:58 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-80) binary key
In-Reply-To: <870267772.1142320797243.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-80?page=comments#action_12370606 ] 

Doug Cutting commented on HADOOP-80:
------------------------------------

If we think that the default java hash function is bad, then we should probably switch it in all of the places where we hash, e.g., in UTF8, here, etc.  For now I will: (a) add a static hashBytes() method to WritableComparable, use it in BytesWritable().  Then, if we someday decide to change the hash function then we'll have a single place to do it.  Allocating a new digester per call to hashCode() seems expensive (although I have not benchmarked this).

MapReduce does use the hash function by default for partitioning, but HashMaps will also use it, so MapReduce is not the only client.

> binary key
> ----------
>
>          Key: HADOOP-80
>          URL: http://issues.apache.org/jira/browse/HADOOP-80
>      Project: Hadoop
>         Type: New Feature
>   Components: io
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: binary-key-2.patch, binary-key.patch
>
> I needed a binary key type, so I extended BytesWritable to be comparable also.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 15 23:53:21 2006
Return-Path: 
 <hadoop-dev-return-416-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59764 invoked from network); 15 Mar 2006 23:53:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 15 Mar 2006 23:53:21 -0000
Received: (qmail 34735 invoked by uid 500); 15 Mar 2006 23:53:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 34703 invoked by uid 500); 15 Mar 2006 23:53:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 34691 invoked by uid 99); 15 Mar 2006 23:53:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 15:53:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 15:53:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CE66ED49FE
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 23:52:58 +0000 (GMT)
Message-ID: <1619589632.1142466778842.JavaMail.jira@ajax>
Date: Wed, 15 Mar 2006 23:52:58 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-80) binary key
In-Reply-To: <870267772.1142320797243.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-80?page=comments#action_12370609 ] 

Doug Cutting commented on HADOOP-80:
------------------------------------

I just committed this as r386219.

> binary key
> ----------
>
>          Key: HADOOP-80
>          URL: http://issues.apache.org/jira/browse/HADOOP-80
>      Project: Hadoop
>         Type: New Feature
>   Components: io
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: binary-key-2.patch, binary-key.patch
>
> I needed a binary key type, so I extended BytesWritable to be comparable also.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 16 00:04:20 2006
Return-Path: 
 <hadoop-dev-return-417-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64969 invoked from network); 16 Mar 2006 00:04:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 00:04:20 -0000
Received: (qmail 46943 invoked by uid 500); 16 Mar 2006 00:04:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46873 invoked by uid 500); 16 Mar 2006 00:04:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46864 invoked by uid 99); 16 Mar 2006 00:04:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 16:04:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 16:04:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C24746ACA9
	for <hadoop-dev@lucene.apache.org>; Thu, 16 Mar 2006 00:03:58 +0000 (GMT)
Message-ID: <840026105.1142467438793.JavaMail.jira@ajax>
Date: Thu, 16 Mar 2006 00:03:58 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-81) speculative execution is only
 controllable from the default config
In-Reply-To: <27190139.1142407599145.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-81?page=all ]
     
Doug Cutting resolved HADOOP-81:
--------------------------------

    Resolution: Fixed

I committed this in 386224.  Thanks, Owen!

> speculative execution is only controllable from the default config
> ------------------------------------------------------------------
>
>          Key: HADOOP-81
>          URL: http://issues.apache.org/jira/browse/HADOOP-81
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: local-spec-exec.patch
>
> The application's JobConf is not consulted when checking whether speculative execution should be used.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 16 00:06:24 2006
Return-Path: 
 <hadoop-dev-return-418-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65692 invoked from network); 16 Mar 2006 00:06:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 00:06:24 -0000
Received: (qmail 50525 invoked by uid 500); 16 Mar 2006 00:06:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50476 invoked by uid 500); 16 Mar 2006 00:06:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50326 invoked by uid 99); 16 Mar 2006 00:06:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 16:06:21 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 16:06:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3E537D49FF
	for <hadoop-dev@lucene.apache.org>; Thu, 16 Mar 2006 00:05:59 +0000 (GMT)
Message-ID: <283873150.1142467559252.JavaMail.jira@ajax>
Date: Thu, 16 Mar 2006 00:05:59 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-82) JobTracker loses it:
 NoSuchElementException
In-Reply-To: <945994663.1142442958144.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-82?page=all ]
     
Doug Cutting resolved HADOOP-82:
--------------------------------

    Fix Version: 0.1
     Resolution: Fixed

I just committed this.  Thanks, Michael!

> JobTracker loses it: NoSuchElementException
> -------------------------------------------
>
>          Key: HADOOP-82
>          URL: http://issues.apache.org/jira/browse/HADOOP-82
>      Project: Hadoop
>         Type: Bug
>     Reporter: stack@archive.org
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: completes.patch
>
> On a number of occasions, JobTracker goes into a loop that it never recovers from.  Over and over it prints the below to the jobtracker log.
> 060304 124522 Server handler 5 on 8010 call error: java.io.IOException: java.util.NoSuchElementException
> java.io.IOException: java.util.NoSuchElementException
>    at java.util.TreeMap.key(TreeMap.java:433)
>    at java.util.TreeMap.firstKey(TreeMap.java:287)
>    at java.util.TreeSet.first(TreeSet.java:407)
>    at org.apache.hadoop.mapred.TaskInProgress.getTaskToRun(TaskInProgress.java:428Timed out.org.apache.hadoop.fs.ChecksumException: Checksum error:/2/hadoop/nara/data/tmp/task_r_m80hob/all.1 at 1554810368 at
> org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122)
> at org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98)
> at org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158)
> at java.io.BufferedInputStream.fill(BufferedInputStream.java:218) at
> java.io.BufferedInputStream.read(BufferedInputStream.java:235) at
> org.apache.hadoop.fs.FSDataInputStream$Buffer.read(FSDataInputStream.java:210)
> at java.io.DataInputStream.readInt(DataInputStream.java:353) at
> org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:367) at
> org.apache.hadoop.io.SequenceFile$Sorter$SortPass.run(SequenceFile.java:557)
> at org.apache.hadoop.io.SequenceFile$Sorter.sortPass(SequenceFile.java:523)
> at org.apache.hadoop.io.SequenceFile$Sorter.sort(SequenceFile.java:511)
> at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:254) at
> org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:666)
> I added debug to TIP#getTaskToRun so i could tell which TIP had empted its allotment of tasks.  Below is extract from jobtracker log that shows sequence of events for TIP tip_fizr7m that lead up to JT losing it:
> 060314 203637 Adding task 'task_m_4d6ht0' to tip tip_fizr7m, for tracker 'tracker_41791' on ia109314.archive.org 
> 060314 204758 Task 'task_m_4d6ht0' has been lost.
> 060314 204811 Adding task 'task_m_fb0wf0' to tip tip_fizr7m, for tracker 'tracker_70065' on ia109314.archive.org
> 060314 210118 Task 'task_m_fb0wf0' has been lost.
> 060314 210119 Adding task 'task_m_irar47' to tip tip_fizr7m, for tracker 'tracker_82285' on ia109324.archive.org
> 060314 211541 Taskid 'task_m_irar47' has finished successfully.
> 060314 211541 Task 'task_m_irar47' has completed.
> 060314 211543 Adding task 'task_m_qo1g69' to tip tip_fizr7m, for tracker 'tracker_97839' on ia109306.archive.org
> 060314 213004 Taskid 'task_m_qo1g69' has finished successfully.
> 060314 213004 Task 'task_m_qo1g69' has completed.
> 060314 213005 Adding task 'task_m_t0lnzk' to tip tip_fizr7m, for tracker 'tracker_57273' on ia109314.archive.org
> 060314 214118 Task 'task_m_t0lnzk' has been lost.
> So, we lose two, complete two, then lose a third.
> TIP should have been done on first completion.
> TIP accounting is off.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 16 01:06:20 2006
Return-Path: 
 <hadoop-dev-return-419-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 90889 invoked from network); 16 Mar 2006 01:06:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 01:06:20 -0000
Received: (qmail 18464 invoked by uid 500); 16 Mar 2006 01:06:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18445 invoked by uid 500); 16 Mar 2006 01:06:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18435 invoked by uid 99); 16 Mar 2006 01:06:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 17:06:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 17:06:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CEF5DD49FE
	for <hadoop-dev@lucene.apache.org>; Thu, 16 Mar 2006 01:05:58 +0000 (GMT)
Message-ID: <768362642.1142471158845.JavaMail.jira@ajax>
Date: Thu, 16 Mar 2006 01:05:58 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-33) DF enhancement: performance and win
 XP support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-33?page=comments#action_12370627 ] 

Doug Cutting commented on HADOOP-33:
------------------------------------

This still needs a few improvements.

- why are all the fields protected?  shouldn't they be private?
- the test case isn't a junit test.
- the toString() method now needs to call to doDF().
- the javadoc now says it uses a windows command, but it doesn't



> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.java, DF.patch, DF2.patch, DF3.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 16 03:14:54 2006
Return-Path: 
 <hadoop-dev-return-421-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47428 invoked from network); 16 Mar 2006 03:14:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 03:14:54 -0000
Received: (qmail 30133 invoked by uid 500); 16 Mar 2006 03:14:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30112 invoked by uid 500); 16 Mar 2006 03:14:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30102 invoked by uid 99); 16 Mar 2006 03:14:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 19:14:53 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 19:14:52 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout3.yahoo.com (8.13.4/8.13.4/y.out) with ESMTP id k2G3DvTO062585
	for <hadoop-dev@lucene.apache.org>; Wed, 15 Mar 2006 19:13:57 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=TxGEozMDcl0+Pa05UgabHSQdahVd7LThFTBRxxC42a36e3Z2Fcxdh8t+AJZSeh9p
Received: from [10.0.1.4] ([172.21.179.136]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 15 Mar 2006 19:13:57 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <1854913738.1142459099064.JavaMail.jira@ajax>
References: <1854913738.1142459099064.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <68D0965B-99CD-4C07-A957-E120D26384F9@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Created: (HADOOP-85) a single client stuck in a loop
 blocks all clients on same machine
Date: Wed, 15 Mar 2006 17:22:15 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 16 Mar 2006 03:13:57.0504 (UTC)
 FILETIME=[A9F8F000:01C648A7]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

What is the failure mode?  How does one client looping in client code  
block the node?  This is in the server, not in fuse, right?

From MAILER-DAEMON Thu Mar 16 02:20:24 2006
Return-Path: 
 <hadoop-dev-return-420-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29142 invoked from network); 16 Mar 2006 02:20:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 02:20:24 -0000
Received: (qmail 75345 invoked by uid 500); 16 Mar 2006 02:20:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75325 invoked by uid 500); 16 Mar 2006 02:20:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75316 invoked by uid 99); 16 Mar 2006 02:20:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 18:20:24 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Mar 2006 18:20:23 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B1FB7D49FE
	for <hadoop-dev@lucene.apache.org>; Thu, 16 Mar 2006 02:20:02 +0000 (GMT)
Message-ID: <1856249659.1142475602725.JavaMail.jira@ajax>
Date: Thu, 16 Mar 2006 02:20:02 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-33) DF enhancement: performance and win
 XP support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-33?page=comments#action_12370631 ] 

Konstantin Shvachko commented on HADOOP-33:
-------------------------------------------

- The fields are protected rather than private in order to keep the class extensible, if anybody
  would want to support other OSs, like I did in the attached version of DF.java
- I would remove this test entirely, don't see any reason to test DF outside the file system.
- Don't think toString() should call doDF(). We probably want toString to reflect the current
  state of the class, rather the current state of the disk drive.
- The Javadoc should say exactly the same it was originally saying, my mistake.

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.java, DF.patch, DF2.patch, DF3.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 16 17:59:27 2006
Return-Path: 
 <hadoop-dev-return-422-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 61101 invoked from network); 16 Mar 2006 17:59:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 17:59:27 -0000
Received: (qmail 54051 invoked by uid 500); 16 Mar 2006 17:59:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54035 invoked by uid 500); 16 Mar 2006 17:59:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54026 invoked by uid 99); 16 Mar 2006 17:59:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 09:59:19 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 09:59:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 24C08D49FB
	for <hadoop-dev@lucene.apache.org>; Thu, 16 Mar 2006 17:58:58 +0000 (GMT)
Message-ID: <1757119049.1142531938115.JavaMail.jira@ajax>
Date: Thu, 16 Mar 2006 17:58:58 +0000 (GMT)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-86) If corrupted map outputs, reducers get
 stuck fetching forever
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

If corrupted map outputs, reducers get stuck fetching forever
-------------------------------------------------------------

         Key: HADOOP-86
         URL: http://issues.apache.org/jira/browse/HADOOP-86
     Project: Hadoop
        Type: Bug
    Reporter: stack@archive.org


In our rack, there is a machine that reliably corrupts map output parts.  When reducers try to pickup the map output, Server#Handler checks the checksum, notices corruption, moves the bad map output part aside and throws a ChecksumException.  Undeterred, the reducer comes back again minutes later only this time it gets a FileNotFoundException out of Server#Handler (Because the part was moved aside).  And so it goes till the cows come home.

Doug applied a patch that in map output  file, when it notices a fatal exception, it logs a severe error on the TaskTracker#LOG. Then in TT, if a severe logging has occurred, TT does a soft restart (TT stays up but closes down all services and then goes through init again).  This patch was committed (after I suggested it was working), only, later, I noticed the severe log flag is not cleared across TT restart so TT goes into a cycle of continuous restarts.  

A further patch that clears the severe flag was posted to the list.  This improves things but has issues too in that on revival, the TT continues to be plagued by reducers looking for parts no longer available for a period of ten minutes or so until the JobTracker gets around to updating them about change in where to go get map outputs.  During this period, the TT gets restarted 5-10 times -- but eventually comes back on line (There may have been too much damage done during this period of flux making it so the job will fail).

This issue covers implementing a better solution.  

Suggestions include having the TT stay down a period to avoid the incoming reducers or somehow examining the incoming reducer request, checking its list of tasks to see if it knows anything of the reducers' request and rejecting it with a non-severe error if not a map of the currently running TT.  A little birdie (named DC) suggests a better soln. is probably an addition to intertrackerprotocol so either the TT or the reducer updates JT when corrupted map output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 16 21:29:23 2006
Return-Path: 
 <hadoop-dev-return-423-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 93986 invoked from network); 16 Mar 2006 21:29:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 21:29:23 -0000
Received: (qmail 98190 invoked by uid 500); 16 Mar 2006 21:29:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98163 invoked by uid 500); 16 Mar 2006 21:29:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98151 invoked by uid 99); 16 Mar 2006 21:29:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 13:29:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 13:29:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D63B3D49FE
	for <hadoop-dev@lucene.apache.org>; Thu, 16 Mar 2006 21:29:00 +0000 (GMT)
Message-ID: <1311239103.1142544540829.JavaMail.jira@ajax>
Date: Thu, 16 Mar 2006 21:29:00 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-86) If corrupted map outputs, reducers
 get stuck fetching forever
In-Reply-To: <1757119049.1142531938115.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-86?page=comments#action_12370751 ] 

Doug Cutting commented on HADOOP-86:
------------------------------------

I just committed something that should help tremendously in fixing this.  One can now get the RPC server context in code that runs under a server.  This will let us, when we encounter an error in MapOutputFile, instead of using LOG.severe(), to get a pointer to the TaskTracker instance and call a method that will propagate the error back (over the InterTrackerProtocol) to the JobTracker, where it belongs.

> If corrupted map outputs, reducers get stuck fetching forever
> -------------------------------------------------------------
>
>          Key: HADOOP-86
>          URL: http://issues.apache.org/jira/browse/HADOOP-86
>      Project: Hadoop
>         Type: Bug
>     Reporter: stack@archive.org

>
> In our rack, there is a machine that reliably corrupts map output parts.  When reducers try to pickup the map output, Server#Handler checks the checksum, notices corruption, moves the bad map output part aside and throws a ChecksumException.  Undeterred, the reducer comes back again minutes later only this time it gets a FileNotFoundException out of Server#Handler (Because the part was moved aside).  And so it goes till the cows come home.
> Doug applied a patch that in map output  file, when it notices a fatal exception, it logs a severe error on the TaskTracker#LOG. Then in TT, if a severe logging has occurred, TT does a soft restart (TT stays up but closes down all services and then goes through init again).  This patch was committed (after I suggested it was working), only, later, I noticed the severe log flag is not cleared across TT restart so TT goes into a cycle of continuous restarts.  
> A further patch that clears the severe flag was posted to the list.  This improves things but has issues too in that on revival, the TT continues to be plagued by reducers looking for parts no longer available for a period of ten minutes or so until the JobTracker gets around to updating them about change in where to go get map outputs.  During this period, the TT gets restarted 5-10 times -- but eventually comes back on line (There may have been too much damage done during this period of flux making it so the job will fail).
> This issue covers implementing a better solution.  
> Suggestions include having the TT stay down a period to avoid the incoming reducers or somehow examining the incoming reducer request, checking its list of tasks to see if it knows anything of the reducers' request and rejecting it with a non-severe error if not a map of the currently running TT.  A little birdie (named DC) suggests a better soln. is probably an addition to intertrackerprotocol so either the TT or the reducer updates JT when corrupted map output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 16 22:30:36 2006
Return-Path: 
 <hadoop-dev-return-424-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27473 invoked from network); 16 Mar 2006 22:30:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 22:30:36 -0000
Received: (qmail 75802 invoked by uid 500); 16 Mar 2006 22:30:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75732 invoked by uid 500); 16 Mar 2006 22:30:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75722 invoked by uid 99); 16 Mar 2006 22:30:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 14:30:34 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 14:30:34 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 08DCED49FE
	for <hadoop-dev@lucene.apache.org>; Thu, 16 Mar 2006 22:30:13 +0000 (GMT)
Message-ID: <460543637.1142548212937.JavaMail.jira@ajax>
Date: Thu, 16 Mar 2006 22:30:12 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-86) If corrupted map outputs, reducers get
 stuck fetching forever
In-Reply-To: <1757119049.1142531938115.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-86?page=all ]

Doug Cutting updated HADOOP-86:
-------------------------------

    Attachment: mapout.patch

Here's a completely untested patch.  It does compile!

I don't think we need to add a new method to the InterTrackerProtocol, rather we just need to get the failure propagated in the next heartbeat to the TaskTracker.


> If corrupted map outputs, reducers get stuck fetching forever
> -------------------------------------------------------------
>
>          Key: HADOOP-86
>          URL: http://issues.apache.org/jira/browse/HADOOP-86
>      Project: Hadoop
>         Type: Bug
>     Reporter: stack@archive.org
>  Attachments: mapout.patch
>
> In our rack, there is a machine that reliably corrupts map output parts.  When reducers try to pickup the map output, Server#Handler checks the checksum, notices corruption, moves the bad map output part aside and throws a ChecksumException.  Undeterred, the reducer comes back again minutes later only this time it gets a FileNotFoundException out of Server#Handler (Because the part was moved aside).  And so it goes till the cows come home.
> Doug applied a patch that in map output  file, when it notices a fatal exception, it logs a severe error on the TaskTracker#LOG. Then in TT, if a severe logging has occurred, TT does a soft restart (TT stays up but closes down all services and then goes through init again).  This patch was committed (after I suggested it was working), only, later, I noticed the severe log flag is not cleared across TT restart so TT goes into a cycle of continuous restarts.  
> A further patch that clears the severe flag was posted to the list.  This improves things but has issues too in that on revival, the TT continues to be plagued by reducers looking for parts no longer available for a period of ten minutes or so until the JobTracker gets around to updating them about change in where to go get map outputs.  During this period, the TT gets restarted 5-10 times -- but eventually comes back on line (There may have been too much damage done during this period of flux making it so the job will fail).
> This issue covers implementing a better solution.  
> Suggestions include having the TT stay down a period to avoid the incoming reducers or somehow examining the incoming reducer request, checking its list of tasks to see if it knows anything of the reducers' request and rejecting it with a non-severe error if not a map of the currently running TT.  A little birdie (named DC) suggests a better soln. is probably an addition to intertrackerprotocol so either the TT or the reducer updates JT when corrupted map output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 16 22:51:32 2006
Return-Path: 
 <hadoop-dev-return-425-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37269 invoked from network); 16 Mar 2006 22:51:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 16 Mar 2006 22:51:32 -0000
Received: (qmail 10178 invoked by uid 500); 16 Mar 2006 22:51:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10161 invoked by uid 500); 16 Mar 2006 22:51:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10151 invoked by uid 99); 16 Mar 2006 22:51:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 14:51:25 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 14:51:24 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0803CD49FD
	for <hadoop-dev@lucene.apache.org>; Thu, 16 Mar 2006 22:51:02 +0000 (GMT)
Message-ID: <210558648.1142549462664.JavaMail.jira@ajax>
Date: Thu, 16 Mar 2006 22:51:02 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

SequenceFile performance degrades substantially compression is on and large values are encountered
--------------------------------------------------------------------------------------------------

         Key: HADOOP-87
         URL: http://issues.apache.org/jira/browse/HADOOP-87
     Project: Hadoop
        Type: Improvement
  Components: io  
    Versions: 0.1    
    Reporter: Sameer Paranjpye
     Fix For: 0.1


The code snippet in quesiton is:

     if (deflateValues) {
        deflateIn.reset();
        val.write(deflateIn);
        deflater.reset();
        deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
        deflater.finish();
        while (!deflater.finished()) {
          int count = deflater.deflate(deflateOut);
          buffer.write(deflateOut, 0, count);
        }
      } else {
  
A couple of issues with this code:

1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.

2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.


Proposed fix:

1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.

2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.




-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 01:11:22 2006
Return-Path: 
 <hadoop-dev-return-426-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1844 invoked from network); 17 Mar 2006 01:11:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 01:11:22 -0000
Received: (qmail 75143 invoked by uid 500); 17 Mar 2006 01:11:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75073 invoked by uid 500); 17 Mar 2006 01:11:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75064 invoked by uid 99); 17 Mar 2006 01:11:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 17:11:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 17:11:21 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 97DA9D49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 01:11:00 +0000 (GMT)
Message-ID: <122769591.1142557860619.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 01:11:00 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment: DF4.patch

DF4.path

- made fields private
- made test junit
- left toString() unchanged
- removed WinXp comment

Is there anything else holding us?

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Priority: Minor
>  Attachments: DF.java, DF.patch, DF2.patch, DF3.patch, DF4.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 01:16:23 2006
Return-Path: 
 <hadoop-dev-return-427-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 4040 invoked from network); 17 Mar 2006 01:16:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 01:16:23 -0000
Received: (qmail 77434 invoked by uid 500); 17 Mar 2006 01:16:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77402 invoked by uid 500); 17 Mar 2006 01:16:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77393 invoked by uid 99); 17 Mar 2006 01:16:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 17:16:23 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 17:16:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7324FD49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 01:16:01 +0000 (GMT)
Message-ID: <1512399529.1142558161467.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 01:16:01 +0000 (GMT)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-88) Configuration: separate client config
 from server config (and from other-server config)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Configuration: separate client config from server config (and from other-server config)
---------------------------------------------------------------------------------------

         Key: HADOOP-88
         URL: http://issues.apache.org/jira/browse/HADOOP-88
     Project: Hadoop
        Type: Wish
    Reporter: Michel Tourn
 Assigned to: Doug Cutting 


servers = JobTracker, NameNode, TaskTracker, DataNode
clients =  runs JobClient (to submit MapReduce jobs), or runs DFSShell (to browse )

Server machines are administered together.
So it is OK to have all server config together (esp file paths and network ports).
This is stored in hadoop-default.xml or hadoop-mycluster.xml

Client machines:
there may be as many client machines as there are MapRed developers.
the temp space for DFS needs to be writable by the active user.
So it should be possible to select the client temp space directory for the machine and for the user.
(The global /tmp is not an option as discussed elsewhere: partition may be full)

Current situation: 
Both the server and the clients have a copy of the server config: hadoop-default.xml
But the XML property  "dfs.data.dir" is being used as a LOCAL directory path 
on both the server machines (Data nodes) and the client machines.

Effect:
Exception in thread "main" java.io.IOException: No valid local directories in property: dfs.data.dir
 at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:286)
 at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.newBackupFile(DFSClient.java:560)
 ...
 at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:267)


Current Workaround:
On the client use hadoop-site.xml to override dfs.data.dir

One proposed solution:

For the purpose of JobClient operations, use a different property in place of dfs.data.dir.
(Ex: dfs.client.data.dir) 
On the client, set this property in hadoop-site.xml so that it will override hadoop-default.xml 

Another proposed solution:

Handle the fact that the world is made of a federation of independant Hadoop systems.
They can talk to each other (as peers) but they are administered separately.
Each Hadoop system should have its own separate XML config file.
Clients should be able to specify the Hadoop system they want to talk to.
An advantage is that clients can then easily sync their local copy of a given Hadoop system config:
 just pull its config file

In this view of the world, a Job client is also a kind of independant (serverless) Hadoop system
In this case the client config file may have its own dfs.data.dir, which is 
separate from the dfs.data.dir in the server config file.



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 02:17:34 2006
Return-Path: 
 <hadoop-dev-return-428-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33112 invoked from network); 17 Mar 2006 02:17:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 02:17:34 -0000
Received: (qmail 34005 invoked by uid 500); 17 Mar 2006 02:17:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33986 invoked by uid 500); 17 Mar 2006 02:17:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33977 invoked by uid 99); 17 Mar 2006 02:17:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 18:17:34 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 18:17:33 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 02E5CD49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 02:17:13 +0000 (GMT)
Message-ID: <1845748515.1142561833009.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 02:17:13 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-89) files are not visible until they are
 closed
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

files are not visible until they are closed
-------------------------------------------

         Key: HADOOP-89
         URL: http://issues.apache.org/jira/browse/HADOOP-89
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Versions: 0.1    
    Reporter: Yoram Arnon
    Priority: Critical


the current behaviour, whereby a file is not visible until it is closed has several flaws,including:
1. no practical way to know if a file/job is progressing
2. no way to implement files that never close, such as log files
3. failure to close a file results in loss of the file

The part of the file that's written should be visible.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 02:51:38 2006
Return-Path: 
 <hadoop-dev-return-429-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53918 invoked from network); 17 Mar 2006 02:51:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 02:51:38 -0000
Received: (qmail 56856 invoked by uid 500); 17 Mar 2006 02:51:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56836 invoked by uid 500); 17 Mar 2006 02:51:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56823 invoked by uid 99); 17 Mar 2006 02:51:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 18:51:37 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 18:51:36 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 511E0D49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 02:51:15 +0000 (GMT)
Message-ID: <726654166.1142563875329.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 02:51:15 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-90) DFS is succeptible to data loss in case
 of name node failure
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DFS is succeptible to data loss in case of name node failure
------------------------------------------------------------

         Key: HADOOP-90
         URL: http://issues.apache.org/jira/browse/HADOOP-90
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Versions: 0.1    
    Reporter: Yoram Arnon


Currently, DFS name node stores its log and state in local files.
This has the disadvantage that a hardware failure of the name node causes a total data loss. 
Several approaches may be used to address this flaw:
1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.

solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.

1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 04:06:23 2006
Return-Path: 
 <hadoop-dev-return-430-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83231 invoked from network); 17 Mar 2006 04:06:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 04:06:23 -0000
Received: (qmail 16349 invoked by uid 500); 17 Mar 2006 04:06:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 16331 invoked by uid 500); 17 Mar 2006 04:06:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 16322 invoked by uid 99); 17 Mar 2006 04:06:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 20:06:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 20:06:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 130C4D49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 04:06:01 +0000 (GMT)
Message-ID: <1935284433.1142568361075.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 04:06:01 +0000 (GMT)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12370780 ] 

eric baldeschwieler commented on HADOOP-90:
-------------------------------------------

I like the idea.  We have something very similar running in some of our other apps.

I'm a bit concerned about using two blocks.  What if the name server only finds one of them?  I'd use block one to stage new versions and then support an operation to make it block zero "atomically".  Then there should be no confusion.  You still need to worry about generations of block zero though.

Interesting problem space.

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon

>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 04:27:33 2006
Return-Path: 
 <hadoop-dev-return-431-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 92262 invoked from network); 17 Mar 2006 04:27:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 04:27:33 -0000
Received: (qmail 29862 invoked by uid 500); 17 Mar 2006 04:27:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29844 invoked by uid 500); 17 Mar 2006 04:27:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29831 invoked by uid 99); 17 Mar 2006 04:27:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 20:27:33 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 20:27:32 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A6CFAD49FF
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 04:27:11 +0000 (GMT)
Message-ID: <1161369672.1142569631679.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 04:27:11 +0000 (GMT)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-91) snapshot a map-reduce to DFS ... and
 restore
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

snapshot a map-reduce to DFS ... and restore
--------------------------------------------

         Key: HADOOP-91
         URL: http://issues.apache.org/jira/browse/HADOOP-91
     Project: Hadoop
        Type: New Feature
  Components: mapred  
    Reporter: eric baldeschwieler
    Priority: Minor


The idea is to be able to issue a command to the job tracker that
will halt a map-reduce and archive it to a directory in such a way
that it can later be restarted.

We could also set a mode that would cause this to happen to a job
when it fails.  This would allow one to debug and restart a failing
job reasonably, which might be important, for long running jobs.  It
has certainly been important in similar systems I've seen before.  One 
could restart with a new jar or work bench a single failing map or reduce.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 04:49:37 2006
Return-Path: 
 <hadoop-dev-return-432-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 513 invoked from network); 17 Mar 2006 04:49:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 04:49:37 -0000
Received: (qmail 38262 invoked by uid 500); 17 Mar 2006 04:49:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38174 invoked by uid 500); 17 Mar 2006 04:49:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38153 invoked by uid 99); 17 Mar 2006 04:49:33 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 20:49:33 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 20:49:33 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7BF7ED4A00
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 04:49:12 +0000 (GMT)
Message-ID: <136202795.1142570952505.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 04:49:12 +0000 (GMT)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-92) Error Reporting/logging in MapReduce
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Error Reporting/logging in MapReduce
------------------------------------

         Key: HADOOP-92
         URL: http://issues.apache.org/jira/browse/HADOOP-92
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Reporter: Mahadev konar
    Priority: Minor


Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 05:19:22 2006
Return-Path: 
 <hadoop-dev-return-433-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 12512 invoked from network); 17 Mar 2006 05:19:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 05:19:22 -0000
Received: (qmail 57397 invoked by uid 500); 17 Mar 2006 05:19:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57379 invoked by uid 500); 17 Mar 2006 05:19:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57370 invoked by uid 99); 17 Mar 2006 05:19:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 21:19:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Mar 2006 21:19:21 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 020E4D49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 05:19:01 +0000 (GMT)
Message-ID: <1931718259.1142572741005.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 05:19:01 +0000 (GMT)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-92) Error Reporting/logging in MapReduce
In-Reply-To: <136202795.1142570952505.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-92?page=comments#action_12370786 ] 

eric baldeschwieler commented on HADOOP-92:
-------------------------------------------

specifically, I'm hoping that we can create a well known file in the output directory with a log of all interesting job output.

Perhaps we should put it in a subdirectory /INFO/ of the output directory, so that when the directory is used for future input, it is not confused with data?  This will also allow us to add other things later.

> Error Reporting/logging in MapReduce
> ------------------------------------
>
>          Key: HADOOP-92
>          URL: http://issues.apache.org/jira/browse/HADOOP-92
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Mahadev konar
>     Priority: Minor

>
> Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 17:20:24 2006
Return-Path: 
 <hadoop-dev-return-434-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51837 invoked from network); 17 Mar 2006 17:20:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 17:20:24 -0000
Received: (qmail 90335 invoked by uid 500); 17 Mar 2006 17:20:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90316 invoked by uid 500); 17 Mar 2006 17:20:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90307 invoked by uid 99); 17 Mar 2006 17:20:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 09:20:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 09:20:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 05277D49FF
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 17:20:01 +0000 (GMT)
Message-ID: <851342434.1142616001018.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 17:20:01 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-90) DFS is succeptible to data loss in
 case of name node failure
In-Reply-To: <726654166.1142563875329.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-90?page=comments#action_12370845 ] 

Yoram Arnon commented on HADOOP-90:
-----------------------------------

adding functionality for atomic transfers of blocks is non trivial, and unnecessary in this case.
both block 0 and 1 are replicated as many times as required to achieve any desired level of reliability.
the generations part is straightforward - read both blocks, verify they're valid via their CRC. If just one is valid - select it, the other one hasn't been written successfully; if they're both valid, they'll have consecutive generation numbers (with rollover, so 0 follows 255), so select the larger one. Noteworty is the fact that a state file with its corresponding log file are completely equivalent to the next generation state file at the time it's created, so the name node is safe in any type of failure while writing the new state: until it's valid and safe the old state+log are there.

> DFS is succeptible to data loss in case of name node failure
> ------------------------------------------------------------
>
>          Key: HADOOP-90
>          URL: http://issues.apache.org/jira/browse/HADOOP-90
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon

>
> Currently, DFS name node stores its log and state in local files.
> This has the disadvantage that a hardware failure of the name node causes a total data loss. 
> Several approaches may be used to address this flaw:
> 1. replicate the name server state files using copy or rsync once in a while, either manually or using a cron job.
> 2. set up secondary name servers and a protocol whereby the primary updates the secondaries. In case of failure, a secondary can take over.
> 3. store the state files as distributed, replicated files in the DFS itself. The difficulty is that it becomes a bootstrap problem, where the name node needs some information, typically stored in its state files, in order to read those same state files.
> solution 1 is fine for non critical systems, but for systems that need to guarantee no data loss it's insufficient.
> Solutions 2 and 3 both seem valid; 3 seems more elegant in that it doesn't require an extra protocol, it leverages the DFS and allows any level of replication for robustness. Below is a proposition for  solution 3.
> 1.	The name node, when it starts up, needs some basic information. That information is not large and can easily be stored in a single block of DFS. We hard code the block location, using block id 0. Block 0 will contain the list of blocks that contain the name node metadata - not the metadata itself (file names, servers, blocks etc), just the list of blocks that contain it. With a block identified by 8 bytes, and 32 MB blocks, we can fit 256K block id's in block 0. 256K blocks of 32MB each can hold 8TB of metadata, which can map a large enough file system, so a single block of block_ids is sufficient.
> 2.	The name node writes his state basically the same way as now: log file plus occasional full state. DFS needs to change to commit changes to open files while allowing continued writing to them, or else the log file wouldn't be valid on name server failure, before the file is closed. 
> 3.	The name node will use double buffering for its state, using blocks 0 and 1. Starting with block 0, it writes its state, then a log of changes. When it's time to write a new state it writes it to node 1. The state includes a generation number, a single byte starting at 0, to enable the name server to identify the valid state. A CRC is written at the end of the block to mark its validity and completeness. The log file is identified by the same generation number as the state it relates to. 
> 4.	The log file will be limited to a single block as well. When that block fills up a new state is written. 32MB of transaction logs should suffice. If not, we could set aside a set of blocks, and set aside a few locations in the super-block (block 0/1) to store that set of block ids.
> 5.	The super-block, the log and the metadata blocks may be exposed as read only files in reserved files in the DFS: /.metadata/* or something.
> 6.	When a name nodes starts, it waits for data nodes to connect to it to report their blocks. It waits until it gets a report about blocks 0 and 1, from which it can continue to read its entire state. After that it continues normally.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 19:28:14 2006
Return-Path: 
 <hadoop-dev-return-435-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42512 invoked from network); 17 Mar 2006 19:28:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 19:28:14 -0000
Received: (qmail 2064 invoked by uid 500); 17 Mar 2006 19:28:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1943 invoked by uid 500); 17 Mar 2006 19:28:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1784 invoked by uid 99); 17 Mar 2006 19:28:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 11:28:12 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 11:28:11 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A74D9D49FD
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 19:27:50 +0000 (GMT)
Message-ID: <1381591578.1142623670682.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 19:27:50 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-65) add a record I/O framework to hadoop
In-Reply-To: <554934043.1141686841971.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-65?page=all ]

Hairong Kuang updated HADOOP-65:
--------------------------------

    Attachment: hadoop_65.fix

> add a record I/O framework to hadoop
> ------------------------------------
>
>          Key: HADOOP-65
>          URL: http://issues.apache.org/jira/browse/HADOOP-65
>      Project: Hadoop
>         Type: New Feature
>   Components: io, ipc
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.2
>  Attachments: hadoop_65.fix
>
> Hadoop could benefit greatly from a simple record I/O framework that enables the specification of simple record types and enables the generation of code for serialization/deserialization in multiple target languages. The framework would handle a small well understood set of primitive types and simple compositions of these (structs, vectors, maps) . It would be possible to leverage this framework to express I/O in MapReduce computations and to use this as the basis for Hadoops RPC implementation. This would make interfacing with code in languages other than Java much easier.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 19:31:23 2006
Return-Path: 
 <hadoop-dev-return-436-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44750 invoked from network); 17 Mar 2006 19:31:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 19:31:23 -0000
Received: (qmail 12321 invoked by uid 500); 17 Mar 2006 19:31:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12248 invoked by uid 500); 17 Mar 2006 19:31:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12239 invoked by uid 99); 17 Mar 2006 19:31:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 11:31:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 11:31:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 48ED6D49FF
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 19:31:01 +0000 (GMT)
Message-ID: <1824891850.1142623861295.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 19:31:01 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
In-Reply-To: <210558648.1142549462664.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-87?page=all ]

Hairong Kuang updated HADOOP-87:
--------------------------------

    Attachment: hadoop_87.fix

> SequenceFile performance degrades substantially compression is on and large values are encountered
> --------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-87
>          URL: http://issues.apache.org/jira/browse/HADOOP-87
>      Project: Hadoop
>         Type: Improvement
>   Components: io
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1
>  Attachments: hadoop_87.fix
>
> The code snippet in quesiton is:
>      if (deflateValues) {
>         deflateIn.reset();
>         val.write(deflateIn);
>         deflater.reset();
>         deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
>         deflater.finish();
>         while (!deflater.finished()) {
>           int count = deflater.deflate(deflateOut);
>           buffer.write(deflateOut, 0, count);
>         }
>       } else {
>   
> A couple of issues with this code:
> 1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.
> 2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.
> Proposed fix:
> 1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.
> 2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 19:49:42 2006
Return-Path: 
 <hadoop-dev-return-437-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56035 invoked from network); 17 Mar 2006 19:49:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 19:49:42 -0000
Received: (qmail 57930 invoked by uid 500); 17 Mar 2006 19:49:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57911 invoked by uid 500); 17 Mar 2006 19:49:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57901 invoked by uid 99); 17 Mar 2006 19:49:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 11:49:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 11:49:41 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 21887D49FD
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 19:49:20 +0000 (GMT)
Message-ID: <968185535.1142624959956.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 19:49:19 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-65) add a record I/O framework to hadoop
In-Reply-To: <554934043.1141686841971.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-65?page=all ]

Owen O'Malley updated HADOOP-65:
--------------------------------

    Attachment:     (was: hadoop_65.fix)

> add a record I/O framework to hadoop
> ------------------------------------
>
>          Key: HADOOP-65
>          URL: http://issues.apache.org/jira/browse/HADOOP-65
>      Project: Hadoop
>         Type: New Feature
>   Components: io, ipc
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Priority: Minor
>      Fix For: 0.2

>
> Hadoop could benefit greatly from a simple record I/O framework that enables the specification of simple record types and enables the generation of code for serialization/deserialization in multiple target languages. The framework would handle a small well understood set of primitive types and simple compositions of these (structs, vectors, maps) . It would be possible to leverage this framework to express I/O in MapReduce computations and to use this as the basis for Hadoops RPC implementation. This would make interfacing with code in languages other than Java much easier.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 20:01:42 2006
Return-Path: 
 <hadoop-dev-return-438-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65076 invoked from network); 17 Mar 2006 20:01:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 20:01:42 -0000
Received: (qmail 82963 invoked by uid 500); 17 Mar 2006 20:01:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 82936 invoked by uid 500); 17 Mar 2006 20:01:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 82926 invoked by uid 99); 17 Mar 2006 20:01:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 12:01:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 12:01:41 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 572FAD49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 20:01:20 +0000 (GMT)
Message-ID: <1640550924.1142625680354.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 20:01:20 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-93) allow minimum split size configurable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

allow minimum split size configurable
-------------------------------------

         Key: HADOOP-93
         URL: http://issues.apache.org/jira/browse/HADOOP-93
     Project: Hadoop
        Type: Bug
    Reporter: Hairong Kuang


The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!

The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 20:06:44 2006
Return-Path: 
 <hadoop-dev-return-439-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68901 invoked from network); 17 Mar 2006 20:06:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 20:06:44 -0000
Received: (qmail 92991 invoked by uid 500); 17 Mar 2006 20:06:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92974 invoked by uid 500); 17 Mar 2006 20:06:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92963 invoked by uid 99); 17 Mar 2006 20:06:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 12:06:44 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 12:06:43 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 60377D49FD
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 20:06:22 +0000 (GMT)
Message-ID: <1029654670.1142625982352.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 20:06:22 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
In-Reply-To: <210558648.1142549462664.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-87?page=comments#action_12370876 ] 

Doug Cutting commented on HADOOP-87:
------------------------------------

There's a lot of commented-out code added by this patch.  Can you remove that, or is it important that it remain?  You also add a new public append() method, but nothing calls it outside of this file.  So it probably doesn't need to be public.  But it replicates a lot of the logic from another append() method.  Can't we somehow implement this with the old append method, or define the old public append method in terms of this new private method?  Replicating logic is not good.  Finally, there are some spurious whitespace changes in your patch.

> SequenceFile performance degrades substantially compression is on and large values are encountered
> --------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-87
>          URL: http://issues.apache.org/jira/browse/HADOOP-87
>      Project: Hadoop
>         Type: Improvement
>   Components: io
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1
>  Attachments: hadoop_87.fix
>
> The code snippet in quesiton is:
>      if (deflateValues) {
>         deflateIn.reset();
>         val.write(deflateIn);
>         deflater.reset();
>         deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
>         deflater.finish();
>         while (!deflater.finished()) {
>           int count = deflater.deflate(deflateOut);
>           buffer.write(deflateOut, 0, count);
>         }
>       } else {
>   
> A couple of issues with this code:
> 1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.
> 2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.
> Proposed fix:
> 1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.
> 2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 20:14:26 2006
Return-Path: 
 <hadoop-dev-return-440-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 72887 invoked from network); 17 Mar 2006 20:14:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 20:14:26 -0000
Received: (qmail 1786 invoked by uid 500); 17 Mar 2006 20:14:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1740 invoked by uid 500); 17 Mar 2006 20:14:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1712 invoked by uid 99); 17 Mar 2006 20:14:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 12:14:23 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 12:14:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 1B2456ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 20:14:02 +0000 (GMT)
Message-ID: <1266531440.1142626442106.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 20:14:02 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-93) allow minimum split size configurable
In-Reply-To: <1640550924.1142625680354.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-93?page=all ]

Hairong Kuang updated HADOOP-93:
--------------------------------

    Attachment: hadoop-93.fix

> allow minimum split size configurable
> -------------------------------------
>
>          Key: HADOOP-93
>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>      Project: Hadoop
>         Type: Bug
>     Reporter: Hairong Kuang
>  Attachments: hadoop-93.fix
>
> The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!
> The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 21:17:24 2006
Return-Path: 
 <hadoop-dev-return-441-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13300 invoked from network); 17 Mar 2006 21:17:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 21:17:24 -0000
Received: (qmail 8347 invoked by uid 500); 17 Mar 2006 21:17:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8273 invoked by uid 500); 17 Mar 2006 21:17:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8063 invoked by uid 99); 17 Mar 2006 21:17:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 13:17:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 13:17:21 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8F73CD4A02
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 21:17:00 +0000 (GMT)
Message-ID: <64956136.1142630220584.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 21:17:00 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-93) allow minimum split size configurable
In-Reply-To: <1640550924.1142625680354.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-93?page=comments#action_12370887 ] 

Doug Cutting commented on HADOOP-93:
------------------------------------

With such big input files the default logic should split things into dfs block-sized splits.  Smaller splits should only be used if this would result in fewer than mapred.map.tasks splits.  What value do you have for mapred.map.tasks in your mapred-default.xml?  Let's make sure that is working before we add a new min.split.size feature.  I don't oppose the feature, but it should be generating 356*30G/32M splits, not 356*30G/2K splits as you claim.  That's still a lot of splits.  If it is too many then we should add the feature you're adding.

Note that, as a workaround, it is also easy to implement this w/o patching by defining an InputFormat that subclasses InputFormatBase and specifies a different minSplitSize.  But making that a long is a good idea.

So, in summary, can you please confirm that the actual number of splits that you object to is 356*30G/32M splits, not 356*30G/2K?  Thanks.

> allow minimum split size configurable
> -------------------------------------
>
>          Key: HADOOP-93
>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>      Project: Hadoop
>         Type: Bug
>     Reporter: Hairong Kuang
>  Attachments: hadoop-93.fix
>
> The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!
> The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 22:01:54 2006
Return-Path: 
 <hadoop-dev-return-442-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37066 invoked from network); 17 Mar 2006 22:01:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 22:01:54 -0000
Received: (qmail 79033 invoked by uid 500); 17 Mar 2006 22:01:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79013 invoked by uid 500); 17 Mar 2006 22:01:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79004 invoked by uid 99); 17 Mar 2006 22:01:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:01:53 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:01:53 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 21455D49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 22:01:32 +0000 (GMT)
Message-ID: <1746766779.1142632892086.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 22:01:32 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
In-Reply-To: <210558648.1142549462664.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-87?page=comments#action_12370892 ] 

Sameer Paranjpye commented on HADOOP-87:
----------------------------------------

The commented out code is spurious and should be cut. As for the multiple append methods, it's hard to implement
the new append methods functionality in terms of the old method, the reverse is doable with a small modification.
The old append method expects takes a single array which contains both the key and value. So if the new methods signature was changed to:

append(byte[] key, int keystart, int keylen, byte[] val, int valstart, int vallen) 

the old one could be implemented in terms of the new private one. I dislike methods with this many parameters but don't have a better idea.

> SequenceFile performance degrades substantially compression is on and large values are encountered
> --------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-87
>          URL: http://issues.apache.org/jira/browse/HADOOP-87
>      Project: Hadoop
>         Type: Improvement
>   Components: io
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1
>  Attachments: hadoop_87.fix
>
> The code snippet in quesiton is:
>      if (deflateValues) {
>         deflateIn.reset();
>         val.write(deflateIn);
>         deflater.reset();
>         deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
>         deflater.finish();
>         while (!deflater.finished()) {
>           int count = deflater.deflate(deflateOut);
>           buffer.write(deflateOut, 0, count);
>         }
>       } else {
>   
> A couple of issues with this code:
> 1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.
> 2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.
> Proposed fix:
> 1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.
> 2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 22:05:22 2006
Return-Path: 
 <hadoop-dev-return-443-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38633 invoked from network); 17 Mar 2006 22:05:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 22:05:22 -0000
Received: (qmail 88253 invoked by uid 500); 17 Mar 2006 22:05:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88229 invoked by uid 500); 17 Mar 2006 22:05:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88217 invoked by uid 99); 17 Mar 2006 22:05:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:05:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:05:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C7DF1D4A00
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 22:04:58 +0000 (GMT)
Message-ID: <1194068956.1142633098816.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 22:04:58 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-93) allow minimum split size configurable
In-Reply-To: <1640550924.1142625680354.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-93?page=comments#action_12370894 ] 

Owen O'Malley commented on HADOOP-93:
-------------------------------------

>>From what I've seen, it is always 32M fragments, but that is still 300k input splits/maps, which is a lot. We'd like to be able to drop that by an order of magnitude. (I think in this case that the input splitter never finished, so we don't know.)

> allow minimum split size configurable
> -------------------------------------
>
>          Key: HADOOP-93
>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>      Project: Hadoop
>         Type: Bug
>     Reporter: Hairong Kuang
>  Attachments: hadoop-93.fix
>
> The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!
> The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 22:06:13 2006
Return-Path: 
 <hadoop-dev-return-444-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39220 invoked from network); 17 Mar 2006 22:06:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 22:06:13 -0000
Received: (qmail 88573 invoked by uid 500); 17 Mar 2006 22:06:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88498 invoked by uid 500); 17 Mar 2006 22:06:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88489 invoked by uid 99); 17 Mar 2006 22:06:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:06:12 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:06:12 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id F28301443D1
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 22:56:24 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 20939-08 for <hadoop-dev@lucene.apache.org>;
	Fri, 17 Mar 2006 22:56:24 +0100 (CET)
Received: from [192.168.8.2] (dslb-088-073-196-174.pools.arcor-ip.net
 [88.73.196.174])
	by mslinux.media-style.com (Postfix) with ESMTP id 31F221443C7
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 22:56:24 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v749.3)
Content-Transfer-Encoding: 7bit
Message-Id: <D3B59BA8-94DB-4A0E-B829-47118A75C73E@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: mapoutputs from killed job are reduced.
Date: Fri, 17 Mar 2006 23:05:44 +0100
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

I note a strange behavior but I can not find any code that is  
responsible for that.
I had very many killed jobs that successful map but never reduced  
completely.
So I had many files like /hadoop/mapred/local/task_m_5zta35.out. Now  
I note when running a reduce task it happen that all boxes try to  
download such map files from one specific box.
First of all it make no sense to process old map data in a new job in  
combination with the new mapoutput data.
Second it happen that the one box is that much under load the the  
other reduces task crash with a connection timeout.

Wouldn't be a good idea to clean up /hadoop/mapred/local/ until  
tasktracker start up.
Also I do not clearly understand how the map ouput files are  
collected but this should be may be improved in a way that it can not  
happen that a newer job tries to process also the map output of a  
older job.

Any hints where to search for the problem?

Thanks.
Stefan


---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Fri Mar 17 22:24:25 2006
Return-Path: 
 <hadoop-dev-return-445-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47819 invoked from network); 17 Mar 2006 22:24:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 22:24:25 -0000
Received: (qmail 14955 invoked by uid 500); 17 Mar 2006 22:24:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14932 invoked by uid 500); 17 Mar 2006 22:24:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14923 invoked by uid 99); 17 Mar 2006 22:24:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:24:24 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:24:24 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 39A4ED49FD
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 22:24:03 +0000 (GMT)
Message-ID: <1605788136.1142634243187.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 22:24:03 +0000 (GMT)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-86) If corrupted map outputs, reducers
 get stuck fetching forever
In-Reply-To: <1757119049.1142531938115.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-86?page=comments#action_12370898 ] 

stack@archive.org commented on HADOOP-86:
-----------------------------------------

Testing over w/e.

> If corrupted map outputs, reducers get stuck fetching forever
> -------------------------------------------------------------
>
>          Key: HADOOP-86
>          URL: http://issues.apache.org/jira/browse/HADOOP-86
>      Project: Hadoop
>         Type: Bug
>     Reporter: stack@archive.org
>  Attachments: mapout.patch
>
> In our rack, there is a machine that reliably corrupts map output parts.  When reducers try to pickup the map output, Server#Handler checks the checksum, notices corruption, moves the bad map output part aside and throws a ChecksumException.  Undeterred, the reducer comes back again minutes later only this time it gets a FileNotFoundException out of Server#Handler (Because the part was moved aside).  And so it goes till the cows come home.
> Doug applied a patch that in map output  file, when it notices a fatal exception, it logs a severe error on the TaskTracker#LOG. Then in TT, if a severe logging has occurred, TT does a soft restart (TT stays up but closes down all services and then goes through init again).  This patch was committed (after I suggested it was working), only, later, I noticed the severe log flag is not cleared across TT restart so TT goes into a cycle of continuous restarts.  
> A further patch that clears the severe flag was posted to the list.  This improves things but has issues too in that on revival, the TT continues to be plagued by reducers looking for parts no longer available for a period of ten minutes or so until the JobTracker gets around to updating them about change in where to go get map outputs.  During this period, the TT gets restarted 5-10 times -- but eventually comes back on line (There may have been too much damage done during this period of flux making it so the job will fail).
> This issue covers implementing a better solution.  
> Suggestions include having the TT stay down a period to avoid the incoming reducers or somehow examining the incoming reducer request, checking its list of tasks to see if it knows anything of the reducers' request and rejecting it with a non-severe error if not a map of the currently running TT.  A little birdie (named DC) suggests a better soln. is probably an addition to intertrackerprotocol so either the TT or the reducer updates JT when corrupted map output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 22:35:37 2006
Return-Path: 
 <hadoop-dev-return-446-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52784 invoked from network); 17 Mar 2006 22:35:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 22:35:37 -0000
Received: (qmail 32232 invoked by uid 500); 17 Mar 2006 22:35:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32212 invoked by uid 500); 17 Mar 2006 22:35:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32203 invoked by uid 99); 17 Mar 2006 22:35:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:35:37 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:35:36 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0C25BD49FF
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 22:35:16 +0000 (GMT)
Message-ID: <1455414816.1142634916046.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 22:35:16 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-93) allow minimum split size configurable
In-Reply-To: <1640550924.1142625680354.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-93?page=all ]

Owen O'Malley updated HADOOP-93:
--------------------------------

      Component: mapred
    Fix Version: 0.1
        Version: 0.1

> allow minimum split size configurable
> -------------------------------------
>
>          Key: HADOOP-93
>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Hairong Kuang
>      Fix For: 0.1
>  Attachments: hadoop-93.fix
>
> The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!
> The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 22:44:21 2006
Return-Path: 
 <hadoop-dev-return-447-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57557 invoked from network); 17 Mar 2006 22:44:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 22:44:21 -0000
Received: (qmail 37806 invoked by uid 500); 17 Mar 2006 22:44:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 37782 invoked by uid 500); 17 Mar 2006 22:44:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 37773 invoked by uid 99); 17 Mar 2006 22:44:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:44:21 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 14:44:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B3291D49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 22:43:59 +0000 (GMT)
Message-ID: <103367827.1142635439730.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 22:43:59 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-93) allow minimum split size configurable
In-Reply-To: <1640550924.1142625680354.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-93?page=comments#action_12370899 ] 

Hairong Kuang commented on HADOOP-93:
-------------------------------------

Doug, you are right. The number of splits we got was 356*30G/32M, but still too many.

> allow minimum split size configurable
> -------------------------------------
>
>          Key: HADOOP-93
>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Hairong Kuang
>      Fix For: 0.1
>  Attachments: hadoop-93.fix
>
> The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!
> The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 23:29:49 2006
Return-Path: 
 <hadoop-dev-return-448-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81894 invoked from network); 17 Mar 2006 23:29:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 23:29:49 -0000
Received: (qmail 99259 invoked by uid 500); 17 Mar 2006 23:29:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99242 invoked by uid 500); 17 Mar 2006 23:29:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99233 invoked by uid 99); 17 Mar 2006 23:29:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 15:29:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 15:29:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D5DF76ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 23:29:27 +0000 (GMT)
Message-ID: <1364865503.1142638167870.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 23:29:27 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-93) allow minimum split size configurable
In-Reply-To: <1640550924.1142625680354.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-93?page=all ]

Hairong Kuang updated HADOOP-93:
--------------------------------

    Attachment: hadoop_87.fix

Updated patch

> allow minimum split size configurable
> -------------------------------------
>
>          Key: HADOOP-93
>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Hairong Kuang
>      Fix For: 0.1
>  Attachments: hadoop-93.fix, hadoop_87.fix
>
> The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!
> The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 23:31:23 2006
Return-Path: 
 <hadoop-dev-return-449-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 82673 invoked from network); 17 Mar 2006 23:31:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 23:31:23 -0000
Received: (qmail 1396 invoked by uid 500); 17 Mar 2006 23:31:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 1376 invoked by uid 500); 17 Mar 2006 23:31:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 1070 invoked by uid 99); 17 Mar 2006 23:31:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 15:31:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 15:31:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 600D4D49FE
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 23:30:58 +0000 (GMT)
Message-ID: <1158154413.1142638258390.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 23:30:58 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
In-Reply-To: <210558648.1142549462664.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-87?page=all ]

Hairong Kuang updated HADOOP-87:
--------------------------------

    Attachment: hadoop-87.fix

> SequenceFile performance degrades substantially compression is on and large values are encountered
> --------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-87
>          URL: http://issues.apache.org/jira/browse/HADOOP-87
>      Project: Hadoop
>         Type: Improvement
>   Components: io
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1
>  Attachments: hadoop-87.fix, hadoop_87.fix
>
> The code snippet in quesiton is:
>      if (deflateValues) {
>         deflateIn.reset();
>         val.write(deflateIn);
>         deflater.reset();
>         deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
>         deflater.finish();
>         while (!deflater.finished()) {
>           int count = deflater.deflate(deflateOut);
>           buffer.write(deflateOut, 0, count);
>         }
>       } else {
>   
> A couple of issues with this code:
> 1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.
> 2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.
> Proposed fix:
> 1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.
> 2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 17 23:35:23 2006
Return-Path: 
 <hadoop-dev-return-450-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84652 invoked from network); 17 Mar 2006 23:35:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 17 Mar 2006 23:35:23 -0000
Received: (qmail 4062 invoked by uid 500); 17 Mar 2006 23:35:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4045 invoked by uid 500); 17 Mar 2006 23:35:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4036 invoked by uid 99); 17 Mar 2006 23:35:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 15:35:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 15:35:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 41E80D49FF
	for <hadoop-dev@lucene.apache.org>; Fri, 17 Mar 2006 23:35:01 +0000 (GMT)
Message-ID: <1936156638.1142638501267.JavaMail.jira@ajax>
Date: Fri, 17 Mar 2006 23:35:01 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-93) allow minimum split size configurable
In-Reply-To: <1640550924.1142625680354.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-93?page=all ]

Owen O'Malley updated HADOOP-93:
--------------------------------

    Attachment:     (was: hadoop_87.fix)

> allow minimum split size configurable
> -------------------------------------
>
>          Key: HADOOP-93
>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Hairong Kuang
>      Fix For: 0.1
>  Attachments: hadoop-93.fix
>
> The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!
> The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 18 01:26:41 2006
Return-Path: 
 <hadoop-dev-return-451-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28006 invoked from network); 18 Mar 2006 01:26:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Mar 2006 01:26:41 -0000
Received: (qmail 91184 invoked by uid 500); 18 Mar 2006 01:26:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91168 invoked by uid 500); 18 Mar 2006 01:26:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91156 invoked by uid 99); 18 Mar 2006 01:26:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 17:26:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 17:26:39 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0ED00D49FF
	for <hadoop-dev@lucene.apache.org>; Sat, 18 Mar 2006 01:26:19 +0000 (GMT)
Message-ID: <1264551394.1142645179057.JavaMail.jira@ajax>
Date: Sat, 18 Mar 2006 01:26:19 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-94) disallow more than one datanode running
 on one computing sharing the same data directory
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

disallow more than one datanode running on one computing sharing the same data directory
----------------------------------------------------------------------------------------

         Key: HADOOP-94
         URL: http://issues.apache.org/jira/browse/HADOOP-94
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Versions: 0.1    
    Reporter: Hairong Kuang


Currently dfs disallows more one datanode to run on the same computer if they are started up using the same hadoop conf dir. However, this does not prevent more than one data node gets started, each using a different conf dir (strickly speaking, a different pid file). If every machine has two such datanodes running, namenode will be busy on deleting and replicating blocks or eventually lead to block loss.

Suggested solution: put pid file in  the data directory and disallow configuration.



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 18 01:36:01 2006
Return-Path: 
 <hadoop-dev-return-452-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 31145 invoked from network); 18 Mar 2006 01:36:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 18 Mar 2006 01:36:01 -0000
Received: (qmail 98841 invoked by uid 500); 18 Mar 2006 01:36:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98826 invoked by uid 500); 18 Mar 2006 01:36:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98817 invoked by uid 99); 18 Mar 2006 01:36:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 17:36:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Mar 2006 17:36:00 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id ACB81D49FF
	for <hadoop-dev@lucene.apache.org>; Sat, 18 Mar 2006 01:35:39 +0000 (GMT)
Message-ID: <20690330.1142645739705.JavaMail.jira@ajax>
Date: Sat, 18 Mar 2006 01:35:39 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-95) dfs validation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

dfs validation
--------------

         Key: HADOOP-95
         URL: http://issues.apache.org/jira/browse/HADOOP-95
     Project: Hadoop
        Type: Improvement
  Components: dfs  
    Versions: 0.1    
    Reporter: Hairong Kuang


Dfs needs a validation operation similiar to fsck, so that we get to know the files that are corrupted and which data blocks are missing.

Dfs namenode also needs to log more specific information such as which block is replication or is deleted. So when something goes wrong, we have a clue what has happened.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 20 18:06:22 2006
Return-Path: 
 <hadoop-dev-return-453-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16453 invoked from network); 20 Mar 2006 18:06:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Mar 2006 18:06:22 -0000
Received: (qmail 43538 invoked by uid 500); 20 Mar 2006 18:06:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43188 invoked by uid 500); 20 Mar 2006 18:06:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43062 invoked by uid 99); 20 Mar 2006 18:06:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 10:06:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 10:06:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CDD4CD49FE
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 18:05:58 +0000 (GMT)
Message-ID: <1001552071.1142877958816.JavaMail.jira@ajax>
Date: Mon, 20 Mar 2006 18:05:58 +0000 (GMT)
From: "stack@archive.org (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-86) If corrupted map outputs, reducers
 get stuck fetching forever
In-Reply-To: <1757119049.1142531938115.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-86?page=comments#action_12371117 ] 

stack@archive.org commented on HADOOP-86:
-----------------------------------------

+1 on patch.  It works for me.

Here is failure over on a tasktracker:

060318 190019 Moving bad file /0/hadoop/tmp/part-24.out/task_m_4eop89 to /0/bad_files/task_m_4eop89.-1553185447
060318 190019 Can't read map output:/0/hadoop/tmp/part-24.out/task_m_4eop89
org.apache.hadoop.fs.ChecksumException: Checksum error: /0/hadoop/tmp/part-24.out/task_m_4eop89 at 1598464
    at org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122)
    at org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98)
    at org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158)
    at java.io.BufferedInputStream.read1(BufferedInputStream.java:254)
    at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
    at java.io.DataInputStream.read(DataInputStream.java:80)
    at org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:129)
    at org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117)
    at org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
    at org.apache.hadoop.ipc.Server$Handler.run(Server.java:229)
060318 190019 Reporting output lost:task_m_4eop89

Reducers must be getting the message fast because after above  no one else comes looking for the corrupted part (No FileNotFoundExceptions in TT log).

Meanwhile over on jobtracker I see following sequence....

060318 184356 Adding task 'task_m_4eop89' to tip tip_ccbgb1, for tracker 'tracker_14754' on ia109307.archive.org
...
060318 184716 Taskid 'task_m_4eop89' has finished successfully.
...
060318 184716 Task 'task_m_4eop89' has completed.
...
060318 190028 Task 'task_m_4eop89' has been lost.
...
060318 190029 Adding task 'task_m_7mdx9h' to tip tip_ccbgb1, for tracker 'tracker_61554' on ia109333.archive.org
...
060318 190329 Taskid 'task_m_7mdx9h' has finished successfully.
...
060318 190329 Task 'task_m_7mdx9h' has completed.
...

i.e. Task completes successfully.  Subsequently a message comes in that its been lost and a new task is scheduled which in turn completes.



> If corrupted map outputs, reducers get stuck fetching forever
> -------------------------------------------------------------
>
>          Key: HADOOP-86
>          URL: http://issues.apache.org/jira/browse/HADOOP-86
>      Project: Hadoop
>         Type: Bug
>     Reporter: stack@archive.org
>  Attachments: mapout.patch
>
> In our rack, there is a machine that reliably corrupts map output parts.  When reducers try to pickup the map output, Server#Handler checks the checksum, notices corruption, moves the bad map output part aside and throws a ChecksumException.  Undeterred, the reducer comes back again minutes later only this time it gets a FileNotFoundException out of Server#Handler (Because the part was moved aside).  And so it goes till the cows come home.
> Doug applied a patch that in map output  file, when it notices a fatal exception, it logs a severe error on the TaskTracker#LOG. Then in TT, if a severe logging has occurred, TT does a soft restart (TT stays up but closes down all services and then goes through init again).  This patch was committed (after I suggested it was working), only, later, I noticed the severe log flag is not cleared across TT restart so TT goes into a cycle of continuous restarts.  
> A further patch that clears the severe flag was posted to the list.  This improves things but has issues too in that on revival, the TT continues to be plagued by reducers looking for parts no longer available for a period of ten minutes or so until the JobTracker gets around to updating them about change in where to go get map outputs.  During this period, the TT gets restarted 5-10 times -- but eventually comes back on line (There may have been too much damage done during this period of flux making it so the job will fail).
> This issue covers implementing a better solution.  
> Suggestions include having the TT stay down a period to avoid the incoming reducers or somehow examining the incoming reducer request, checking its list of tasks to see if it knows anything of the reducers' request and rejecting it with a non-severe error if not a map of the currently running TT.  A little birdie (named DC) suggests a better soln. is probably an addition to intertrackerprotocol so either the TT or the reducer updates JT when corrupted map output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 20 18:49:21 2006
Return-Path: 
 <hadoop-dev-return-454-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47013 invoked from network); 20 Mar 2006 18:49:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Mar 2006 18:49:21 -0000
Received: (qmail 43288 invoked by uid 500); 20 Mar 2006 18:49:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43272 invoked by uid 500); 20 Mar 2006 18:49:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43263 invoked by uid 99); 20 Mar 2006 18:49:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 10:49:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 10:49:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D7740D49FF
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 18:48:58 +0000 (GMT)
Message-ID: <2146382742.1142880538879.JavaMail.jira@ajax>
Date: Mon, 20 Mar 2006 18:48:58 +0000 (GMT)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-95) dfs validation
In-Reply-To: <20690330.1142645739705.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-95?page=comments#action_12371125 ] 

Bryan Pendleton commented on HADOOP-95:
---------------------------------------

I posted a similar complaint in HADOOP-35, including a patch to make it possible to report on individual file health from the dfs -ls command. I agree that something needs to be added, if only to facilitate debugging of the various block-loss problems I've been seeing.

> dfs validation
> --------------
>
>          Key: HADOOP-95
>          URL: http://issues.apache.org/jira/browse/HADOOP-95
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Hairong Kuang

>
> Dfs needs a validation operation similiar to fsck, so that we get to know the files that are corrupted and which data blocks are missing.
> Dfs namenode also needs to log more specific information such as which block is replication or is deleted. So when something goes wrong, we have a clue what has happened.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 20 18:54:20 2006
Return-Path: 
 <hadoop-dev-return-455-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49648 invoked from network); 20 Mar 2006 18:54:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Mar 2006 18:54:20 -0000
Received: (qmail 51394 invoked by uid 500); 20 Mar 2006 18:54:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51378 invoked by uid 500); 20 Mar 2006 18:54:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 51368 invoked by uid 99); 20 Mar 2006 18:54:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 10:54:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 10:54:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BE13D6ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 18:53:58 +0000 (GMT)
Message-ID: <318439407.1142880838776.JavaMail.jira@ajax>
Date: Mon, 20 Mar 2006 18:53:58 +0000 (GMT)
From: "Bryan Pendleton (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-91) snapshot a map-reduce to DFS ... and
 restore
In-Reply-To: <1161369672.1142569631679.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-91?page=comments#action_12371127 ] 

Bryan Pendleton commented on HADOOP-91:
---------------------------------------

This would be very useful, although, it should be noted that snapshotting a job to DFS means that it will take as much extra space to store as the replication (well, replication+1) level. If you're running jobs that produce large intermediate results, then attempting to checkpoint with, say, the default 3x replication, requires 4 times as much space as the job would, otherwise. For no-side-effect jobs, perhaps the default should be to checkpoint but with replication of 1 (assuming per-file replication gets added to DFS), and just let lost blocks turn into lost tasks that just get re-run. Hadoop should minimize space usage wherever possible, if it's really going to scale up to huge workloads.

> snapshot a map-reduce to DFS ... and restore
> --------------------------------------------
>
>          Key: HADOOP-91
>          URL: http://issues.apache.org/jira/browse/HADOOP-91
>      Project: Hadoop
>         Type: New Feature
>   Components: mapred
>     Reporter: eric baldeschwieler
>     Priority: Minor

>
> The idea is to be able to issue a command to the job tracker that
> will halt a map-reduce and archive it to a directory in such a way
> that it can later be restarted.
> We could also set a mode that would cause this to happen to a job
> when it fails.  This would allow one to debug and restart a failing
> job reasonably, which might be important, for long running jobs.  It
> has certainly been important in similar systems I've seen before.  One 
> could restart with a new jar or work bench a single failing map or reduce.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 20 19:10:21 2006
Return-Path: 
 <hadoop-dev-return-456-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59098 invoked from network); 20 Mar 2006 19:10:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Mar 2006 19:10:21 -0000
Received: (qmail 90979 invoked by uid 500); 20 Mar 2006 19:10:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90898 invoked by uid 500); 20 Mar 2006 19:10:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90889 invoked by uid 99); 20 Mar 2006 19:10:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 11:10:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 11:10:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3A45FD49FE
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 19:09:59 +0000 (GMT)
Message-ID: <2003320920.1142881799213.JavaMail.jira@ajax>
Date: Mon, 20 Mar 2006 19:09:59 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-86) If corrupted map outputs, reducers get
 stuck fetching forever
In-Reply-To: <1757119049.1142531938115.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-86?page=all ]
     
Doug Cutting resolved HADOOP-86:
--------------------------------

    Fix Version: 0.1
     Resolution: Fixed
      Assign To: Doug Cutting

I just committed the fix for this.  Thanks, Michael, for helping to debug it.

> If corrupted map outputs, reducers get stuck fetching forever
> -------------------------------------------------------------
>
>          Key: HADOOP-86
>          URL: http://issues.apache.org/jira/browse/HADOOP-86
>      Project: Hadoop
>         Type: Bug
>     Reporter: stack@archive.org
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: mapout.patch
>
> In our rack, there is a machine that reliably corrupts map output parts.  When reducers try to pickup the map output, Server#Handler checks the checksum, notices corruption, moves the bad map output part aside and throws a ChecksumException.  Undeterred, the reducer comes back again minutes later only this time it gets a FileNotFoundException out of Server#Handler (Because the part was moved aside).  And so it goes till the cows come home.
> Doug applied a patch that in map output  file, when it notices a fatal exception, it logs a severe error on the TaskTracker#LOG. Then in TT, if a severe logging has occurred, TT does a soft restart (TT stays up but closes down all services and then goes through init again).  This patch was committed (after I suggested it was working), only, later, I noticed the severe log flag is not cleared across TT restart so TT goes into a cycle of continuous restarts.  
> A further patch that clears the severe flag was posted to the list.  This improves things but has issues too in that on revival, the TT continues to be plagued by reducers looking for parts no longer available for a period of ten minutes or so until the JobTracker gets around to updating them about change in where to go get map outputs.  During this period, the TT gets restarted 5-10 times -- but eventually comes back on line (There may have been too much damage done during this period of flux making it so the job will fail).
> This issue covers implementing a better solution.  
> Suggestions include having the TT stay down a period to avoid the incoming reducers or somehow examining the incoming reducer request, checking its list of tasks to see if it knows anything of the reducers' request and rejecting it with a non-severe error if not a map of the currently running TT.  A little birdie (named DC) suggests a better soln. is probably an addition to intertrackerprotocol so either the TT or the reducer updates JT when corrupted map output.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 20 19:21:28 2006
Return-Path: 
 <hadoop-dev-return-457-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67076 invoked from network); 20 Mar 2006 19:21:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Mar 2006 19:21:28 -0000
Received: (qmail 9503 invoked by uid 500); 20 Mar 2006 19:21:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9490 invoked by uid 500); 20 Mar 2006 19:21:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9481 invoked by uid 99); 20 Mar 2006 19:21:27 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 11:21:27 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 11:21:26 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DDE356ACAB
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 19:21:05 +0000 (GMT)
Message-ID: <610921566.1142882465906.JavaMail.jira@ajax>
Date: Mon, 20 Mar 2006 19:21:05 +0000 (GMT)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-91) snapshot a map-reduce to DFS ... and
 restore
In-Reply-To: <1161369672.1142569631679.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-91?page=comments#action_12371131 ] 

eric baldeschwieler commented on HADOOP-91:
-------------------------------------------

Good points.  Adding an option to specify replication level would be a good addition.  Some of this data will be automatically regeneratable, only meta-data may really need high level replication.

> snapshot a map-reduce to DFS ... and restore
> --------------------------------------------
>
>          Key: HADOOP-91
>          URL: http://issues.apache.org/jira/browse/HADOOP-91
>      Project: Hadoop
>         Type: New Feature
>   Components: mapred
>     Reporter: eric baldeschwieler
>     Priority: Minor

>
> The idea is to be able to issue a command to the job tracker that
> will halt a map-reduce and archive it to a directory in such a way
> that it can later be restarted.
> We could also set a mode that would cause this to happen to a job
> when it fails.  This would allow one to debug and restart a failing
> job reasonably, which might be important, for long running jobs.  It
> has certainly been important in similar systems I've seen before.  One 
> could restart with a new jar or work bench a single failing map or reduce.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 20 21:33:27 2006
Return-Path: 
 <hadoop-dev-return-458-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43541 invoked from network); 20 Mar 2006 21:33:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Mar 2006 21:33:27 -0000
Received: (qmail 9864 invoked by uid 500); 20 Mar 2006 21:33:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 9843 invoked by uid 500); 20 Mar 2006 21:33:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 9829 invoked by uid 99); 20 Mar 2006 21:33:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 13:33:26 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.28] (HELO mrout2-b.corp.dcn.yahoo.com)
 (216.109.112.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 13:33:25 -0800
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout2-b.corp.dcn.yahoo.com (8.13.4/8.13.4/y.out) with ESMTP id
 k2KLWhd2061678
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 13:32:44 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	x-mailer:thread-index:x-mimeole;
	b=nta2tx1ck18XyRPrl1i/Mjx353u3YhmxWVMAcEsdmj8xe6R/64LYrXOlZhafEgJf
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: data loss using hadoop
Date: Mon, 20 Mar 2006 13:33:45 -0800
Message-ID: <021401c64c65$f8003990$496715ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0215_01C64C22.E9DCF990"
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcZMZfeEclrlR88UQ1usQ7IKed0grw==
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_NextPart_000_0215_01C64C22.E9DCF990
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

While playing around with a hadoop dfs cluster, we've observed data loss.
This may be related to our having stopped and restarted the DFS a couple of
times, possibly with nodes not all going online and offline at just the
right timing, but many of our files, ranging in size from less than 1GB to
multi GB each, have at least one block missing. Blocks are missing from
relatively new files, generated within the last two weeks, the file system
was never more than 25% full, and there's no outstanding reason why this
loss should have happened.
In the upcoming days/weeks we'll be looking into the reasons, and for ways
of making the DFS more robust against this kind of loss.

Yoram 

------=_NextPart_000_0215_01C64C22.E9DCF990--


From MAILER-DAEMON Mon Mar 20 22:56:20 2006
Return-Path: 
 <hadoop-dev-return-459-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66920 invoked from network); 20 Mar 2006 22:56:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Mar 2006 22:56:20 -0000
Received: (qmail 66113 invoked by uid 500); 20 Mar 2006 22:56:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66033 invoked by uid 500); 20 Mar 2006 22:56:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66024 invoked by uid 99); 20 Mar 2006 22:56:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 14:56:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 14:56:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 91ABED49FC
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 22:55:58 +0000 (GMT)
Message-ID: <490932526.1142895358593.JavaMail.jira@ajax>
Date: Mon, 20 Mar 2006 22:55:58 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
In-Reply-To: <210558648.1142549462664.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-87?page=comments#action_12371158 ] 

Sameer Paranjpye commented on HADOOP-87:
----------------------------------------

Doug, any issues with the new patch?

> SequenceFile performance degrades substantially compression is on and large values are encountered
> --------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-87
>          URL: http://issues.apache.org/jira/browse/HADOOP-87
>      Project: Hadoop
>         Type: Improvement
>   Components: io
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1
>  Attachments: hadoop-87.fix, hadoop_87.fix
>
> The code snippet in quesiton is:
>      if (deflateValues) {
>         deflateIn.reset();
>         val.write(deflateIn);
>         deflater.reset();
>         deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
>         deflater.finish();
>         while (!deflater.finished()) {
>           int count = deflater.deflate(deflateOut);
>           buffer.write(deflateOut, 0, count);
>         }
>       } else {
>   
> A couple of issues with this code:
> 1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.
> 2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.
> Proposed fix:
> 1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.
> 2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 20 22:58:22 2006
Return-Path: 
 <hadoop-dev-return-460-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69777 invoked from network); 20 Mar 2006 22:58:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 20 Mar 2006 22:58:22 -0000
Received: (qmail 67687 invoked by uid 500); 20 Mar 2006 22:58:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67665 invoked by uid 500); 20 Mar 2006 22:58:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67656 invoked by uid 99); 20 Mar 2006 22:58:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 14:58:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 14:58:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C3ACFD49FF
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 22:57:59 +0000 (GMT)
Message-ID: <1124763322.1142895479799.JavaMail.jira@ajax>
Date: Mon, 20 Mar 2006 22:57:59 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-83) infinite retries accessing a missing
 block
In-Reply-To: <671256830.1142449198957.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-83?page=all ]

Sameer Paranjpye reassigned HADOOP-83:
--------------------------------------

    Assign To: Konstantin Shvachko

> infinite retries accessing a missing block
> ------------------------------------------
>
>          Key: HADOOP-83
>          URL: http://issues.apache.org/jira/browse/HADOOP-83
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko

>
> A file in the DFS got corrupted - the reason for that is unknown, but might be justified.
> when accessing the file, I get an infinite stream of error messages from the client - attached below.
> The client aparently increments an error counter, but never checks it.
> Correct behaviour is for the client to retry a few times, then abort.
> 060315 105436 No node available for block blk_2690692619196463439
> 060315 105436 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105446 No node available for block blk_2690692619196463439
> 060315 105446 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105456 No node available for block blk_2690692619196463439
> 060315 105456 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105506 No node available for block blk_2690692619196463439
> 060315 105506 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105516 No node available for block blk_2690692619196463439
> 060315 105516 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105526 No node available for block blk_2690692619196463439
> 060315 105526 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105536 No node available for block blk_2690692619196463439
> 060315 105536 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105546 No node available for block blk_2690692619196463439
> 060315 105546 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105556 No node available for block blk_2690692619196463439
> 060315 105556 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105606 No node available for block blk_2690692619196463439
> 060315 105606 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105616 No node available for block blk_2690692619196463439
> 060315 105616 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105626 No node available for block blk_2690692619196463439
> 060315 105626 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105636 No node available for block blk_2690692619196463439
> 060315 105636 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105646 No node available for block blk_2690692619196463439
> 060315 105646 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105657 No node available for block blk_2690692619196463439
> 060315 105657 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105707 No node available for block blk_2690692619196463439
> 060315 105707 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105717 No node available for block blk_2690692619196463439
> 060315 105717 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105727 No node available for block blk_2690692619196463439
> 060315 105727 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105737 No node available for block blk_2690692619196463439
> 060315 105737 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105747 No node available for block blk_2690692619196463439
> 060315 105747 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105757 No node available for block blk_2690692619196463439
> 060315 105757 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105807 No node available for block blk_2690692619196463439
> 060315 105807 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105817 No node available for block blk_2690692619196463439

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 00:31:21 2006
Return-Path: 
 <hadoop-dev-return-461-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81345 invoked from network); 21 Mar 2006 00:31:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 00:31:21 -0000
Received: (qmail 72683 invoked by uid 500); 21 Mar 2006 00:31:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72664 invoked by uid 500); 21 Mar 2006 00:31:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72655 invoked by uid 99); 21 Mar 2006 00:31:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 16:31:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 16:31:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 146E9D49FC
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 00:30:59 +0000 (GMT)
Message-ID: <1751646348.1142901059066.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 00:30:59 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
In-Reply-To: <210558648.1142549462664.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-87?page=all ]

Doug Cutting updated HADOOP-87:
-------------------------------

    Attachment: hadoop-87-3.txt

Here's a simpler version.  This copies less and never passes large, unused buffers over JNI.  It doesn't require changes to any other APIs, nor does it assume that items are typically smaller than 64k.

> SequenceFile performance degrades substantially compression is on and large values are encountered
> --------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-87
>          URL: http://issues.apache.org/jira/browse/HADOOP-87
>      Project: Hadoop
>         Type: Improvement
>   Components: io
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>      Fix For: 0.1
>  Attachments: hadoop-87-3.txt, hadoop-87.fix, hadoop_87.fix
>
> The code snippet in quesiton is:
>      if (deflateValues) {
>         deflateIn.reset();
>         val.write(deflateIn);
>         deflater.reset();
>         deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
>         deflater.finish();
>         while (!deflater.finished()) {
>           int count = deflater.deflate(deflateOut);
>           buffer.write(deflateOut, 0, count);
>         }
>       } else {
>   
> A couple of issues with this code:
> 1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.
> 2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.
> Proposed fix:
> 1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.
> 2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 02:02:47 2006
Return-Path: 
 <hadoop-dev-return-462-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 10097 invoked from network); 21 Mar 2006 02:02:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 02:02:47 -0000
Received: (qmail 59788 invoked by uid 500); 21 Mar 2006 02:02:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59771 invoked by uid 500); 21 Mar 2006 02:02:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59745 invoked by uid 99); 21 Mar 2006 02:02:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 18:02:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 18:02:21 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 795A8D49FE
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 02:02:00 +0000 (GMT)
Message-ID: <2088571061.1142906520493.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 02:02:00 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-88) Configuration: separate client config
 from server config (and from other-server config)
In-Reply-To: <1512399529.1142558161467.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-88?page=comments#action_12371177 ] 

Yoram Arnon commented on HADOOP-88:
-----------------------------------

I'd also separate the dfs config from the map-reduce config - they have nothing in common, and dfs has a life of its own in that it could support apps other than map-reduce.

Taking this one step further, I'd separate name node config from data node config, and job tracker config from task tracker config. While useful to have them all bunled up when running on a single node, they're typically running on distinct nodes in a real system, and definitely in different processes, so separate configs make sense.

As for the client config, it should be really really easy:
 config file, rather than directory
 config file can reside anywhere, including the same directory as the application, and can have any name
 no reliance on environment variables
 specify the config file on the command line (client -f <file>) allowing concurrent clients for multiple hadoop clusters
 as few knobs as possible, simple to configure manually

> Configuration: separate client config from server config (and from other-server config)
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-88
>          URL: http://issues.apache.org/jira/browse/HADOOP-88
>      Project: Hadoop
>         Type: Wish
>     Reporter: Michel Tourn
>     Assignee: Doug Cutting

>
> servers = JobTracker, NameNode, TaskTracker, DataNode
> clients =  runs JobClient (to submit MapReduce jobs), or runs DFSShell (to browse )
> Server machines are administered together.
> So it is OK to have all server config together (esp file paths and network ports).
> This is stored in hadoop-default.xml or hadoop-mycluster.xml
> Client machines:
> there may be as many client machines as there are MapRed developers.
> the temp space for DFS needs to be writable by the active user.
> So it should be possible to select the client temp space directory for the machine and for the user.
> (The global /tmp is not an option as discussed elsewhere: partition may be full)
> Current situation: 
> Both the server and the clients have a copy of the server config: hadoop-default.xml
> But the XML property  "dfs.data.dir" is being used as a LOCAL directory path 
> on both the server machines (Data nodes) and the client machines.
> Effect:
> Exception in thread "main" java.io.IOException: No valid local directories in property: dfs.data.dir
>  at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:286)
>  at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.newBackupFile(DFSClient.java:560)
>  ...
>  at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:267)
> Current Workaround:
> On the client use hadoop-site.xml to override dfs.data.dir
> One proposed solution:
> For the purpose of JobClient operations, use a different property in place of dfs.data.dir.
> (Ex: dfs.client.data.dir) 
> On the client, set this property in hadoop-site.xml so that it will override hadoop-default.xml 
> Another proposed solution:
> Handle the fact that the world is made of a federation of independant Hadoop systems.
> They can talk to each other (as peers) but they are administered separately.
> Each Hadoop system should have its own separate XML config file.
> Clients should be able to specify the Hadoop system they want to talk to.
> An advantage is that clients can then easily sync their local copy of a given Hadoop system config:
>  just pull its config file
> In this view of the world, a Job client is also a kind of independant (serverless) Hadoop system
> In this case the client config file may have its own dfs.data.dir, which is 
> separate from the dfs.data.dir in the server config file.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 02:16:20 2006
Return-Path: 
 <hadoop-dev-return-463-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51517 invoked from network); 21 Mar 2006 02:16:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 02:16:20 -0000
Received: (qmail 77688 invoked by uid 500); 21 Mar 2006 02:16:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77672 invoked by uid 500); 21 Mar 2006 02:16:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77663 invoked by uid 99); 21 Mar 2006 02:16:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 18:16:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 18:16:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DB941D49FF
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 02:15:58 +0000 (GMT)
Message-ID: <2034641399.1142907358895.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 02:15:58 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-95) dfs validation
In-Reply-To: <20690330.1142645739705.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-95?page=comments#action_12371179 ] 

Yoram Arnon commented on HADOOP-95:
-----------------------------------

we're thinking to have a name-server call that:
1. checks internal consistency
2. for each block, verifies that it actually exists on some data node
3. (optional, perhaps later) ask each data node to actually read its blocks and check their validity

> dfs validation
> --------------
>
>          Key: HADOOP-95
>          URL: http://issues.apache.org/jira/browse/HADOOP-95
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Hairong Kuang

>
> Dfs needs a validation operation similiar to fsck, so that we get to know the files that are corrupted and which data blocks are missing.
> Dfs namenode also needs to log more specific information such as which block is replication or is deleted. So when something goes wrong, we have a clue what has happened.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 05:34:15 2006
Return-Path: 
 <hadoop-dev-return-464-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30271 invoked from network); 21 Mar 2006 05:34:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 05:34:15 -0000
Received: (qmail 7528 invoked by uid 500); 21 Mar 2006 05:34:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7503 invoked by uid 500); 21 Mar 2006 05:34:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7485 invoked by uid 99); 21 Mar 2006 05:34:14 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 21:34:14 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 21:34:13 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout3.yahoo.com (8.13.4/8.13.4/y.out) with ESMTP id k2L5X0KR032784
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 21:33:00 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=yTwriB2AHZ5DtAD+qbSCNR5bKvuEXQKrI4BhqscTC/sIUfBN6K44l6p5XAmATbMy
Received: from [10.0.1.4] ([172.21.179.141]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 20 Mar 2006 21:33:01 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <1936156638.1142638501267.JavaMail.jira@ajax>
References: <1936156638.1142638501267.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <36AC6992-1519-48A7-A902-7995C4CDA9B4@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: a comment on HADOOP-93 -- allow minimum split size configurable
Date: Mon, 20 Mar 2006 21:21:33 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 21 Mar 2006 05:33:01.0310 (UTC)
 FILETIME=[EB5571E0:01C64CA8]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

It doesn't seem like we are going to get exactly what we want by  
simply going with bigger splits.  What we really want is to read all  
of the information locally if possible.  We loose control of that by  
increasing the split beyond the block size.  This is relevant because  
we'll have more tasks like this in the future.  The simple  
aggregations and samples that keep coming up in user asks will all  
look like this.

It seems to me there are two ways to deal with this:

1) Make 300k task map jobs work efficiently.  How possible /  
impossible is this?

2) Make jobs which consume a set of blocks which are all local to a  
node.  This seems possible, but will require a fair rethink on APIs /  
abstractions.

---

Which way should we push things?  Seems that giving up node / switch  
locality on reads is not the right decision.  Which is where we just  
went with by allowing input sizes > the block.

PS Increasing the block size to 64M or 128M would clearly help some,  
but it does not handle the overall issue.  Although maybe 256M might  
prove an interesting size...

On Mar 17, 2006, at 3:35 PM, Owen O'Malley (JIRA) wrote:

>      [ http://issues.apache.org/jira/browse/HADOOP-93?page=all ]
>
> Owen O'Malley updated HADOOP-93:
> --------------------------------
>
>     Attachment:     (was: hadoop_87.fix)
>
>> allow minimum split size configurable
>> -------------------------------------
>>
>>          Key: HADOOP-93
>>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>>      Project: Hadoop
>>         Type: Bug
>>   Components: mapred
>>     Versions: 0.1
>>     Reporter: Hairong Kuang
>>      Fix For: 0.1
>>  Attachments: hadoop-93.fix
>>
>> The current default split size is the size of a block (32M) and a  
>> SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We  
>> currently have a Map/Reduce application working on crawled  
>> docuements. Its input data consists of 356 sequence files, each of  
>> which is of a size around 30G. A jobtracker takes forever to  
>> launch the job because it needs to generate 356*30G/2K map tasks!
>> The proposed solution is to let the minimum split size  
>> configurable so that the programmer can control the number of  
>> tasks to generate.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Tue Mar 21 05:45:23 2006
Return-Path: 
 <hadoop-dev-return-465-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 35306 invoked from network); 21 Mar 2006 05:45:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 05:45:23 -0000
Received: (qmail 13395 invoked by uid 500); 21 Mar 2006 05:45:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13316 invoked by uid 500); 21 Mar 2006 05:45:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13307 invoked by uid 99); 21 Mar 2006 05:45:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 21:45:16 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 21:45:16 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.4/8.13.4/y.out) with ESMTP id k2L5iHg8050616
	for <hadoop-dev@lucene.apache.org>; Mon, 20 Mar 2006 21:44:17 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=mTtXe1RfeOFun0Sy9rLXU0mLKFM/bN7zR+vbiXSNvdEBPQtK9nBVKpqbexnlCOrk
Received: from [10.0.1.4] ([172.21.179.141]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 20 Mar 2006 21:44:17 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <021401c64c65$f8003990$496715ac@ds.corp.yahoo.com>
References: <021401c64c65$f8003990$496715ac@ds.corp.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <4E3DEDA8-5DA6-4156-8A5B-960165FFE786@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: data loss using hadoop
Date: Mon, 20 Mar 2006 21:44:10 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 21 Mar 2006 05:44:18.0033 (UTC)
 FILETIME=[7EB12E10:01C64CAA]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


One discussion point...

In previous systems we've built, we've tended to have a master node  
configured with a list of all of its slaves.  Dead or inactive slaves  
are then listed as such in the config as well.  This let's the master  
know what nodes to expect.  It seems to me that since the HDFS relies  
on a stable (roughly) set of nodes to provide persistent storage,  
moving a node list to the master will allow simpler startup code and  
general error checking, without loosing any real freedom.

I'd not suggest this for the task tracker at this point, since it can  
actually use ad hoc nodes, but HDFS gains nothing but instability  
from ah hoc nodes showing up and dropping out.  Much better to have a  
configured list of servers IMO.

Thoughts?  Should we file a bug to make this so?

On Mar 20, 2006, at 1:33 PM, Yoram Arnon wrote:

> While playing around with a hadoop dfs cluster, we've observed data  
> loss.
> This may be related to our having stopped and restarted the DFS a  
> couple of
> times, possibly with nodes not all going online and offline at just  
> the
> right timing, but many of our files, ranging in size from less than  
> 1GB to
> multi GB each, have at least one block missing. Blocks are missing  
> from
> relatively new files, generated within the last two weeks, the file  
> system
> was never more than 25% full, and there's no outstanding reason why  
> this
> loss should have happened.
> In the upcoming days/weeks we'll be looking into the reasons, and  
> for ways
> of making the DFS more robust against this kind of loss.
>
> Yoram


From MAILER-DAEMON Tue Mar 21 06:00:32 2006
Return-Path: 
 <hadoop-dev-return-466-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42313 invoked from network); 21 Mar 2006 06:00:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 06:00:32 -0000
Received: (qmail 20244 invoked by uid 500); 21 Mar 2006 06:00:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 20222 invoked by uid 500); 21 Mar 2006 06:00:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 20213 invoked by uid 99); 21 Mar 2006 06:00:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 22:00:31 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Mar 2006 22:00:31 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 76CA1D49FE
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 06:00:10 +0000 (GMT)
Message-ID: <1063774889.1142920810483.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 06:00:10 +0000 (GMT)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-95) dfs validation
In-Reply-To: <20690330.1142645739705.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-95?page=comments#action_12371188 ] 

eric baldeschwieler commented on HADOOP-95:
-------------------------------------------

I vote for a dedicated thread on each name node using 1% of disk IO to validate blocks continuously.  Low cost and uncovering bad blocks is high value.  This would also let you collect disk stats reliability to determine if the disks were bad.

> dfs validation
> --------------
>
>          Key: HADOOP-95
>          URL: http://issues.apache.org/jira/browse/HADOOP-95
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Hairong Kuang

>
> Dfs needs a validation operation similiar to fsck, so that we get to know the files that are corrupted and which data blocks are missing.
> Dfs namenode also needs to log more specific information such as which block is replication or is deleted. So when something goes wrong, we have a clue what has happened.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 17:10:27 2006
Return-Path: 
 <hadoop-dev-return-467-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38247 invoked from network); 21 Mar 2006 17:10:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 17:10:27 -0000
Received: (qmail 96449 invoked by uid 500); 21 Mar 2006 17:10:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96424 invoked by uid 500); 21 Mar 2006 17:10:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96415 invoked by uid 99); 21 Mar 2006 17:10:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 09:10:24 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 09:10:23 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DAC3D6ACA9
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 17:10:02 +0000 (GMT)
Message-ID: <949326300.1142961002892.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 17:10:02 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

name server should log decisions that affect data: block creation, removal, replication
---------------------------------------------------------------------------------------

         Key: HADOOP-96
         URL: http://issues.apache.org/jira/browse/HADOOP-96
     Project: Hadoop
        Type: Improvement
  Components: dfs  
    Versions: 0.1    
    Reporter: Yoram Arnon
    Priority: Critical


currently, there's no way to analyze and debug DFS errors where blocks disapear.
name server should log its decisions that affect data, including block creation, removal, replication:
- block <b> created, assigned to datanodes A, B, ...
- datanode A dead, block <b> underreplicated(1), replicating to datanode C
- datanode B dead, block <b> underreplicated(2), replicating to datanode D
- datanode A alive, block <b> overreplicated, removing from datanode D
- block <removed> from datanodes C, D, ...

that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.

extra credit:
- rotate log file, as it might grow large
- make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 17:39:28 2006
Return-Path: 
 <hadoop-dev-return-468-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54692 invoked from network); 21 Mar 2006 17:39:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 17:39:28 -0000
Received: (qmail 63691 invoked by uid 500); 21 Mar 2006 17:39:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63653 invoked by uid 500); 21 Mar 2006 17:39:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63618 invoked by uid 99); 21 Mar 2006 17:39:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 09:39:21 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 09:39:21 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3A18BD49FE
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 17:39:00 +0000 (GMT)
Message-ID: <1405669744.1142962740235.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 17:39:00 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-93) allow minimum split size configurable
In-Reply-To: <1640550924.1142625680354.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-93?page=all ]
     
Doug Cutting resolved HADOOP-93:
--------------------------------

    Resolution: Fixed
     Assign To: Doug Cutting

Okay, I have applied this.

For the record, patches are easier to apply if they are made from the root of the project.  Also, new config properties should generally be added to hadoop-default.xml.  Finally, the cast added in SequenceFileInputFormat was not required.

> allow minimum split size configurable
> -------------------------------------
>
>          Key: HADOOP-93
>          URL: http://issues.apache.org/jira/browse/HADOOP-93
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Hairong Kuang
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: hadoop-93.fix
>
> The current default split size is the size of a block (32M) and a SequenceFile sets it to be SequenceFile.SYNC_INTERVAL(2K). We currently have a Map/Reduce application working on crawled docuements. Its input data consists of 356 sequence files, each of which is of a size around 30G. A jobtracker takes forever to launch the job because it needs to generate 356*30G/2K map tasks!
> The proposed solution is to let the minimum split size configurable so that the programmer can control the number of tasks to generate.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 18:48:20 2006
Return-Path: 
 <hadoop-dev-return-469-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94293 invoked from network); 21 Mar 2006 18:48:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 18:48:20 -0000
Received: (qmail 98156 invoked by uid 500); 21 Mar 2006 18:48:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98141 invoked by uid 500); 21 Mar 2006 18:48:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98131 invoked by uid 99); 21 Mar 2006 18:48:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 10:48:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 10:48:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C37106ACA9
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 18:47:58 +0000 (GMT)
Message-ID: <858170515.1142966878797.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 18:47:58 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-80) binary key
In-Reply-To: <870267772.1142320797243.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-80?page=all ]
     
Owen O'Malley closed HADOOP-80:
-------------------------------

    Resolution: Fixed

Doug committed this.

> binary key
> ----------
>
>          Key: HADOOP-80
>          URL: http://issues.apache.org/jira/browse/HADOOP-80
>      Project: Hadoop
>         Type: New Feature
>   Components: io
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: binary-key-2.patch, binary-key.patch
>
> I needed a binary key type, so I extended BytesWritable to be comparable also.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 20:28:21 2006
Return-Path: 
 <hadoop-dev-return-470-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48795 invoked from network); 21 Mar 2006 20:28:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 20:28:21 -0000
Received: (qmail 73879 invoked by uid 500); 21 Mar 2006 20:28:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73857 invoked by uid 500); 21 Mar 2006 20:28:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73847 invoked by uid 99); 21 Mar 2006 20:28:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 12:28:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 12:28:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 21534D49FE
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 20:27:59 +0000 (GMT)
Message-ID: <280002880.1142972879134.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 20:27:59 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-97) DFSShell.cat returns
 NullPointerException if file does not exist
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DFSShell.cat returns NullPointerException if file does not exist
----------------------------------------------------------------

         Key: HADOOP-97
         URL: http://issues.apache.org/jira/browse/HADOOP-97
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Reporter: Konstantin Shvachko
 Assigned to: Sameer Paranjpye 
 Attachments: DFSShell.patch

DFSShell.cat crashes with a NullPointerException if file to be displayed does not exist.
The bug is fixed in the attached patch, and the general exception handling in main() is added.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 20:28:25 2006
Return-Path: 
 <hadoop-dev-return-471-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 48839 invoked from network); 21 Mar 2006 20:28:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 20:28:25 -0000
Received: (qmail 74321 invoked by uid 500); 21 Mar 2006 20:28:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 74299 invoked by uid 500); 21 Mar 2006 20:28:24 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 74290 invoked by uid 99); 21 Mar 2006 20:28:24 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 12:28:24 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 12:28:23 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 08052D4A00
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 20:28:03 +0000 (GMT)
Message-ID: <1568287416.1142972883030.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 20:28:03 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-97) DFSShell.cat returns
 NullPointerException if file does not exist
In-Reply-To: <280002880.1142972879134.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-97?page=all ]

Konstantin Shvachko updated HADOOP-97:
--------------------------------------

    Attachment: DFSShell.patch

> DFSShell.cat returns NullPointerException if file does not exist
> ----------------------------------------------------------------
>
>          Key: HADOOP-97
>          URL: http://issues.apache.org/jira/browse/HADOOP-97
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Konstantin Shvachko
>     Assignee: Sameer Paranjpye
>  Attachments: DFSShell.patch
>
> DFSShell.cat crashes with a NullPointerException if file to be displayed does not exist.
> The bug is fixed in the attached patch, and the general exception handling in main() is added.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 21:07:43 2006
Return-Path: 
 <hadoop-dev-return-472-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67102 invoked from network); 21 Mar 2006 21:07:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 21:07:43 -0000
Received: (qmail 48383 invoked by uid 500); 21 Mar 2006 21:07:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48350 invoked by uid 500); 21 Mar 2006 21:07:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48328 invoked by uid 99); 21 Mar 2006 21:07:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 13:07:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 13:07:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0AAABD49FF
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 21:07:20 +0000 (GMT)
Message-ID: <1747523020.1142975240040.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 21:07:20 +0000 (GMT)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-92) Error Reporting/logging in MapReduce
In-Reply-To: <136202795.1142570952505.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-92?page=comments#action_12371296 ] 

Mahadev konar commented on HADOOP-92:
-------------------------------------

It could be done with a logs directory in output_dir. So, the output_dir/logs/tasks/  would contain all the information per task (a file per task). This file would contain information like -- machine name, start time, end time, result status, error messages. Also, there should be a file per job  output_dir/logs/job_id.log. This file would contains job specific data -- no of mapreduce tasks that were running at some time, number of machines it was running on, and the start time and end time of the job. This log could also contain information on which of the task failed, so that the user can take a look at the respective task log to know why it failed.

> Error Reporting/logging in MapReduce
> ------------------------------------
>
>          Key: HADOOP-92
>          URL: http://issues.apache.org/jira/browse/HADOOP-92
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Mahadev konar
>     Priority: Minor

>
> Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 21:44:08 2006
Return-Path: 
 <hadoop-dev-return-473-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87270 invoked from network); 21 Mar 2006 21:44:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 21:44:08 -0000
Received: (qmail 14463 invoked by uid 500); 21 Mar 2006 21:43:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14402 invoked by uid 500); 21 Mar 2006 21:43:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14381 invoked by uid 99); 21 Mar 2006 21:43:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 13:43:52 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 13:43:51 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 81982D49FC
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 21:43:30 +0000 (GMT)
Message-ID: <323198110.1142977410528.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 21:43:30 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
In-Reply-To: <210558648.1142549462664.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-87?page=all ]
     
Doug Cutting resolved HADOOP-87:
--------------------------------

    Resolution: Fixed
     Assign To: Doug Cutting

I just committed this.  I was unable to measure a performance difference, but it is less code and uses less memory, so it seems a safe change in any case.

> SequenceFile performance degrades substantially compression is on and large values are encountered
> --------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-87
>          URL: http://issues.apache.org/jira/browse/HADOOP-87
>      Project: Hadoop
>         Type: Improvement
>   Components: io
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: hadoop-87-3.txt, hadoop-87.fix, hadoop_87.fix
>
> The code snippet in quesiton is:
>      if (deflateValues) {
>         deflateIn.reset();
>         val.write(deflateIn);
>         deflater.reset();
>         deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
>         deflater.finish();
>         while (!deflater.finished()) {
>           int count = deflater.deflate(deflateOut);
>           buffer.write(deflateOut, 0, count);
>         }
>       } else {
>   
> A couple of issues with this code:
> 1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.
> 2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.
> Proposed fix:
> 1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.
> 2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 22:04:21 2006
Return-Path: 
 <hadoop-dev-return-474-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97532 invoked from network); 21 Mar 2006 22:04:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 22:04:21 -0000
Received: (qmail 48831 invoked by uid 500); 21 Mar 2006 22:04:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48816 invoked by uid 500); 21 Mar 2006 22:04:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48807 invoked by uid 99); 21 Mar 2006 22:04:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 14:04:21 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 14:04:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9B3F5D49FF
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 22:03:59 +0000 (GMT)
Message-ID: <1414845241.1142978639632.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 22:03:59 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-97) DFSShell.cat returns
 NullPointerException if file does not exist
In-Reply-To: <280002880.1142972879134.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-97?page=all ]
     
Doug Cutting resolved HADOOP-97:
--------------------------------

    Resolution: Fixed
     Assign To: Konstantin Shvachko  (was: Sameer Paranjpye)

I just committed this.  I also changed the error message to print to standard error rather than standard output, and changed the exit code to be 1 when there's an error.

> DFSShell.cat returns NullPointerException if file does not exist
> ----------------------------------------------------------------
>
>          Key: HADOOP-97
>          URL: http://issues.apache.org/jira/browse/HADOOP-97
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>  Attachments: DFSShell.patch
>
> DFSShell.cat crashes with a NullPointerException if file to be displayed does not exist.
> The bug is fixed in the attached patch, and the general exception handling in main() is added.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 22:52:35 2006
Return-Path: 
 <hadoop-dev-return-475-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21694 invoked from network); 21 Mar 2006 22:52:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 22:52:35 -0000
Received: (qmail 39949 invoked by uid 500); 21 Mar 2006 22:52:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39933 invoked by uid 500); 21 Mar 2006 22:52:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39924 invoked by uid 99); 21 Mar 2006 22:52:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 14:52:34 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 14:52:34 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 25CF5D49FC
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 22:52:13 +0000 (GMT)
Message-ID: <1275898622.1142981533083.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 22:52:13 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-44) RPC exceptions should include remote
 stack trace
In-Reply-To: <50328208.1140559768195.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-44?page=all ]
     
Doug Cutting resolved HADOOP-44:
--------------------------------

    Resolution: Fixed
     Assign To: Doug Cutting  (was: Owen O'Malley)

I just committed a fix for this.  The remote stack trace is now used as the exception message string in the re-thrown local exception.  The class of the local exception is now also RemoteException, so that it can be distinguished from other IOExceptions.

> RPC exceptions should include remote stack trace
> ------------------------------------------------
>
>          Key: HADOOP-44
>          URL: http://issues.apache.org/jira/browse/HADOOP-44
>      Project: Hadoop
>         Type: New Feature
>   Components: ipc
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: patch.txt
>
> Remote exceptions currently only report the exception string.  Instead they should report the entire remote stack trace, as a string, to facilitate debugging.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 21 23:21:38 2006
Return-Path: 
 <hadoop-dev-return-476-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37172 invoked from network); 21 Mar 2006 23:21:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 21 Mar 2006 23:21:38 -0000
Received: (qmail 3995 invoked by uid 500); 21 Mar 2006 23:21:28 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3926 invoked by uid 500); 21 Mar 2006 23:21:28 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3864 invoked by uid 99); 21 Mar 2006 23:21:28 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 15:21:28 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 15:21:26 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 117E76ACAD
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 23:21:06 +0000 (GMT)
Message-ID: <957920374.1142983266068.JavaMail.jira@ajax>
Date: Tue, 21 Mar 2006 23:21:06 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-45) JobTracker should log task errors
In-Reply-To: <413270226.1140559769984.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-45?page=all ]
     
Doug Cutting resolved HADOOP-45:
--------------------------------

    Resolution: Fixed
     Assign To: Doug Cutting  (was: Owen O'Malley)

I just fixed this.  When a tasktracker reports a task error, the jobtracker now logs it.  These messages were previously available in the web ui, but were not logged.

> JobTracker should log task errors
> ---------------------------------
>
>          Key: HADOOP-45
>          URL: http://issues.apache.org/jira/browse/HADOOP-45
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Doug Cutting
>      Fix For: 0.1

>
> Task errors are currently propagated to the JobTracker and viewable in the web interface but they are not logged.  These should be logged as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 04:56:22 2006
Return-Path: 
 <hadoop-dev-return-477-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67344 invoked from network); 22 Mar 2006 04:56:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 04:56:22 -0000
Received: (qmail 24995 invoked by uid 500); 22 Mar 2006 04:56:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24981 invoked by uid 500); 22 Mar 2006 04:56:21 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24972 invoked by uid 99); 22 Mar 2006 04:56:21 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 20:56:21 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 20:56:20 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.4/8.13.4/y.out) with ESMTP id k2M4rXak039471
	for <hadoop-dev@lucene.apache.org>; Tue, 21 Mar 2006 20:53:33 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=P0vzPZV9ZU4r+9fPSODOkaMFh69A0U6UIo2poBNqZ54GchV6QwkwNNO/N7O9U/b/
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Tue, 21 Mar 2006 20:53:33 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <1747523020.1142975240040.JavaMail.jira@ajax>
References: <1747523020.1142975240040.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <C2A983C3-D7BD-4EAA-9886-5DA8EFA2A0B1@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-92) Error Reporting/logging in
 MapReduce
Date: Tue, 21 Mar 2006 20:53:31 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 22 Mar 2006 04:53:33.0287 (UTC)
 FILETIME=[924B8F70:01C64D6C]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Will it really make sense to have 300,000 subdirectories with several  
log files?  Seems like a real loosing proposition.  I'd just go for a  
single log file with reasonable per line prefixes (time, job, ...).

Then you can grep out what you want.

From MAILER-DAEMON Wed Mar 22 06:55:41 2006
Return-Path: 
 <hadoop-dev-return-478-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16962 invoked from network); 22 Mar 2006 06:55:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 06:55:41 -0000
Received: (qmail 23010 invoked by uid 500); 22 Mar 2006 06:55:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22990 invoked by uid 500); 22 Mar 2006 06:55:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22981 invoked by uid 99); 22 Mar 2006 06:55:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 22:55:39 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Mar 2006 22:55:38 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8CEDD6ACA9
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 06:55:17 +0000 (GMT)
Message-ID: <1666253097.1143010517571.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 06:55:17 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-52?page=all ]

Owen O'Malley updated HADOOP-52:
--------------------------------

    Attachment: cwd.patch

Here is a patch that fixes the problem. 

It does:
   1. It adds {set,get}WorkingDirectory to FileSystem.
   2. It implements them in both LocalFileSystem and DFS.
   3. The LocalFileSystem implementation both sets the System property user.dir and does an explicit
        conversion to absolute filenames at the API.
   4. Added new junit test cases to test the WorkingDirectory functionality.
   5. Added a utility class in the test directory to create a single-process DFS cluster for junit tests.
   6. Added the user name into the JobConf.
   7. Added the user name into the JobProfile.
   8. Added the user name into the webapp, so you can see who ran the job.
   9. Added the working directory in the default file system to the JobConf.
   10. Set the job's working directory before starting the user's Map or Reduce code. (The input splitter is given an absolute pathname
          for the input directory, but the working directory is not set, since it is done in the context of the JobTracker.)
   11. Changed the format of the percentage complete in the webapp to be ##0.00 so that you don't get 16 digits of meaningless precision
          about your job status.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 17:07:38 2006
Return-Path: 
 <hadoop-dev-return-479-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65836 invoked from network); 22 Mar 2006 17:07:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 17:07:38 -0000
Received: (qmail 35386 invoked by uid 500); 22 Mar 2006 17:07:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 35367 invoked by uid 500); 22 Mar 2006 17:07:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 35357 invoked by uid 99); 22 Mar 2006 17:07:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 09:07:34 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 09:07:34 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 57C18D4A01
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 17:07:13 +0000 (GMT)
Message-ID: <41835758.1143047233356.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 17:07:13 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-71) The SequenceFileRecordReader uses the
 default FileSystem rather than the supplied one
In-Reply-To: <539883049.1141863519345.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-71?page=comments#action_12371434 ] 

Owen O'Malley commented on HADOOP-71:
-------------------------------------

Doug,
   This one seems to have dropped off your radar. The fix isn't mandatory any more, because we created a custom config for the junit tests. However, it still seems cleaner to use the provided FileSystem rather than fetching the default one.

> The SequenceFileRecordReader uses the default FileSystem rather than the supplied one
> -------------------------------------------------------------------------------------
>
>          Key: HADOOP-71
>          URL: http://issues.apache.org/jira/browse/HADOOP-71
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: explicit-fs.patch
>
> The mapred.TestSequenceFileInputFormat test was failing when run with a conf directory that pointed to a dfs cluster. The reason was that SequenceFileRecordReader was using the default FileSystem from the config, while the test program was assuming the "local" file system was being used.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 17:10:57 2006
Return-Path: 
 <hadoop-dev-return-480-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67104 invoked from network); 22 Mar 2006 17:10:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 17:10:57 -0000
Received: (qmail 41152 invoked by uid 500); 22 Mar 2006 17:10:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41137 invoked by uid 500); 22 Mar 2006 17:10:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41128 invoked by uid 99); 22 Mar 2006 17:10:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 09:10:56 -0800
X-ASF-Spam-Status: No, hits=1.6 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,MAILTO_TO_SPAM_ADDR
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 09:10:55 -0800
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout3.yahoo.com (8.13.4/8.13.4/y.out) with ESMTP id k2MH8oqF087572
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 09:08:50 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:thread-index:x-mimeole;
	b=juOwxXac3wF8/X3rYBZELZxKy7xkLHRyGkez9C/U7MzJ5VspSM9EuyTFAsguH0+S
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: [jira] Commented: (HADOOP-92) Error Reporting/logging in
 MapReduce
Date: Wed, 22 Mar 2006 09:10:45 -0800
Message-ID: <000b01c64dd3$8e94c330$496715ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <C2A983C3-D7BD-4EAA-9886-5DA8EFA2A0B1@yahoo-inc.com>
Thread-Index: AcZNbQqGGddQj07DRQGEBU+7VpC1qAAZfwiA
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DFS files can only be written once, and by a single writer.
Until that changes our hands are tied, as long as we require the output to
reside in the output directory.

Unless... we create a protocol whereby the task masters report up to the job
master, and it's only the job master that does the logging.
That might introduce unwanted overhead and some load on the job master.


> -----Original Message-----
> From: Eric Baldeschwieler [mailto:eric14@yahoo-inc.com]
> Sent: Tuesday, March 21, 2006 8:54 PM
> To: hadoop-dev@lucene.apache.org
> Subject: Re: [jira] Commented: (HADOOP-92) Error Reporting/logging in
> MapReduce
> 
> Will it really make sense to have 300,000 subdirectories with several
> log files?  Seems like a real loosing proposition.  I'd just go for a
> single log file with reasonable per line prefixes (time, job, ...).
> 
> Then you can grep out what you want.



From MAILER-DAEMON Wed Mar 22 17:22:34 2006
Return-Path: 
 <hadoop-dev-return-481-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73248 invoked from network); 22 Mar 2006 17:22:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 17:22:34 -0000
Received: (qmail 77351 invoked by uid 500); 22 Mar 2006 17:22:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77336 invoked by uid 500); 22 Mar 2006 17:22:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77327 invoked by uid 99); 22 Mar 2006 17:22:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 09:22:20 -0800
X-ASF-Spam-Status: No, hits=0.3 required=10.0
	tests=HTML_MESSAGE,MAILTO_TO_SPAM_ADDR
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 09:22:18 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 2B3FD144400
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 18:11:43 +0100 (CET)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 22228-08 for <hadoop-dev@lucene.apache.org>;
	Wed, 22 Mar 2006 18:11:42 +0100 (CET)
Received: from [192.168.200.39] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id D3DCD1443FE
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 18:11:42 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <000b01c64dd3$8e94c330$496715ac@ds.corp.yahoo.com>
References: <000b01c64dd3$8e94c330$496715ac@ds.corp.yahoo.com>
Content-Type: multipart/alternative; boundary=Apple-Mail-38--615326071
Message-Id: <30E9796D-8F15-4303-A83B-D9DEB8E83219@media-style.com>
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: [jira] Commented: (HADOOP-92) Error Reporting/logging in
 MapReduce
Date: Wed, 22 Mar 2006 18:21:54 +0100
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-38--615326071
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed

Hi,

In case we would be able to query a host that runs a specific  
maprunnable from the jobtracker,
we would be able to run one logging server as map task and  
tasktrackers can send log messages to this logging server.
 From my point of view this would be easier to implement than  
multiple writers to one dfs file.

Just my 2 cents.
Greetings,
Stefan


Am 22.03.2006 um 18:10 schrieb Yoram Arnon:

> DFS files can only be written once, and by a single writer.
> Until that changes our hands are tied, as long as we require the  
> output to
> reside in the output directory.
>
> Unless... we create a protocol whereby the task masters report up  
> to the job
> master, and it's only the job master that does the logging.
> That might introduce unwanted overhead and some load on the job  
> master.
>
>
>> -----Original Message-----
>> From: Eric Baldeschwieler [mailto:eric14@yahoo-inc.com]
>> Sent: Tuesday, March 21, 2006 8:54 PM
>> To: hadoop-dev@lucene.apache.org
>> Subject: Re: [jira] Commented: (HADOOP-92) Error Reporting/logging in
>> MapReduce
>>
>> Will it really make sense to have 300,000 subdirectories with several
>> log files?  Seems like a real loosing proposition.  I'd just go for a
>> single log file with reasonable per line prefixes (time, job, ...).
>>
>> Then you can grep out what you want.
>
>
>

---------------------------------------------------------------
company:        http://www.media-style.com
forum:        http://www.text-mining.org
blog:            http://www.find23.net



--Apple-Mail-38--615326071--

From MAILER-DAEMON Wed Mar 22 17:41:36 2006
Return-Path: 
 <hadoop-dev-return-482-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95362 invoked from network); 22 Mar 2006 17:41:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 17:41:36 -0000
Received: (qmail 29919 invoked by uid 500); 22 Mar 2006 17:41:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29901 invoked by uid 500); 22 Mar 2006 17:41:36 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29892 invoked by uid 99); 22 Mar 2006 17:41:36 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 09:41:36 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 09:41:35 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CA8F5D4A00
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 17:41:14 +0000 (GMT)
Message-ID: <1798976387.1143049274826.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 17:41:14 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-3) Output directories are not cleaned up
 before the reduces run
In-Reply-To: <859498351.1139000372103.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-3?page=all ]

Owen O'Malley updated HADOOP-3:
-------------------------------

    Attachment: noclobber.patch

Ok, this patch ensures that the output directory is set and does not exist.
If the application wants to clobber old data, they need to delete the files themselves.
I added the check for the output directory being set, because otherwise the job doesn't fail until
the reduces try to run. With the added check, they fail before they are submitted. 

I wasn't sure we wanted to support the no reduces case, but it was pretty easy to handle here by
not requiring an output directory.

> Output directories are not cleaned up before the reduces run
> ------------------------------------------------------------
>
>          Key: HADOOP-3
>          URL: http://issues.apache.org/jira/browse/HADOOP-3
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: clean-out-dir.patch, noclobber.patch
>
> The output directory for the reduces is not cleaned up and therefore if you can see left overs from previous runs, if they had more reduces. For example, if you run the application once with reduces=10 and then rerun with reduces=8, your output directory will have frag00000 to frag00009 with the first 8 fragments from the second run and the last 2 fragments from the first run.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 19:22:37 2006
Return-Path: 
 <hadoop-dev-return-483-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59109 invoked from network); 22 Mar 2006 19:22:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 19:22:37 -0000
Received: (qmail 43335 invoked by uid 500); 22 Mar 2006 19:22:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 43247 invoked by uid 500); 22 Mar 2006 19:22:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 43231 invoked by uid 99); 22 Mar 2006 19:22:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 11:22:31 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 11:22:30 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8347C6ACA9
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 19:22:09 +0000 (GMT)
Message-ID: <1089937382.1143055329534.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 19:22:09 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371451 ] 

Doug Cutting commented on HADOOP-52:
------------------------------------

Overall this looks great!  A few minor comments:

. your new local variables and non-static fields use underscores as word separators, rather than camelCase, as is both the Java convention and the convention used in the files you're changing.  Can you please switch these to use camelCase?

. In LocalJobRunner there are potentially multiple threads changing the working directory of a single fs.  Perhaps we should instead have a different fs instance for each job thread?  Should we make FileSystem support clone()?

Thanks!


> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 19:36:26 2006
Return-Path: 
 <hadoop-dev-return-484-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66719 invoked from network); 22 Mar 2006 19:36:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 19:36:26 -0000
Received: (qmail 68045 invoked by uid 500); 22 Mar 2006 19:36:26 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68028 invoked by uid 500); 22 Mar 2006 19:36:26 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68019 invoked by uid 99); 22 Mar 2006 19:36:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 11:36:25 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 11:36:25 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7991CD4A01
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 19:36:04 +0000 (GMT)
Message-ID: <1622487958.1143056164494.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 19:36:04 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-71) The SequenceFileRecordReader uses the
 default FileSystem rather than the supplied one
In-Reply-To: <539883049.1141863519345.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-71?page=comments#action_12371453 ] 

Doug Cutting commented on HADOOP-71:
------------------------------------

This looks good, although it makes an incompatible changes to a public APIs used by Nutch.  So we should probably continue to support the old method signatures too, or else make a co-ordinated change to Nutch.

> The SequenceFileRecordReader uses the default FileSystem rather than the supplied one
> -------------------------------------------------------------------------------------
>
>          Key: HADOOP-71
>          URL: http://issues.apache.org/jira/browse/HADOOP-71
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: explicit-fs.patch
>
> The mapred.TestSequenceFileInputFormat test was failing when run with a conf directory that pointed to a dfs cluster. The reason was that SequenceFileRecordReader was using the default FileSystem from the config, while the test program was assuming the "local" file system was being used.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 19:40:02 2006
Return-Path: 
 <hadoop-dev-return-485-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68001 invoked from network); 22 Mar 2006 19:40:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 19:40:02 -0000
Received: (qmail 72902 invoked by uid 500); 22 Mar 2006 19:40:02 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72881 invoked by uid 500); 22 Mar 2006 19:40:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72872 invoked by uid 99); 22 Mar 2006 19:40:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 11:40:02 -0800
X-ASF-Spam-Status: No, hits=1.6 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS,MAILTO_TO_SPAM_ADDR
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 11:40:01 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout3.yahoo.com (8.13.4/8.13.4/y.out) with ESMTP id k2MJdOht036218
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 11:39:24 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=DlHSefmueSBSbDYZY6umiSt7Nvn/oLpSpdiRCTaG2+DtpmjqECAc2jcv/tg1OvdT
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 22 Mar 2006 11:39:24 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <30E9796D-8F15-4303-A83B-D9DEB8E83219@media-style.com>
References: <000b01c64dd3$8e94c330$496715ac@ds.corp.yahoo.com>
 <30E9796D-8F15-4303-A83B-D9DEB8E83219@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <925BFA12-8CD7-481C-8BFC-57E40D2AE94A@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-92) Error Reporting/logging in
 MapReduce
Date: Wed, 22 Mar 2006 11:39:22 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 22 Mar 2006 19:39:24.0135 (UTC)
 FILETIME=[52AB5770:01C64DE8]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

this might be a reasonable short term solution.  Although it adds a  
lot of complexity.

I was assuming master aggregation.  This clearly could be a burden  
(good point), although if we simply log launch, completion and  
failure events, that should be ok.  Maybe we should stick to that?   
Or only record failure logs by default?

Another approach would be to launch a job to reap entries whenever  
there get to be a large number, and just concatenate them together.   
Say concatenate the smallest 100 together whenever we get to 200?

On Mar 22, 2006, at 9:21 AM, Stefan Groschupf wrote:

> Hi,
>
> In case we would be able to query a host that runs a specific  
> maprunnable from the jobtracker,
> we would be able to run one logging server as map task and  
> tasktrackers can send log messages to this logging server.
> From my point of view this would be easier to implement than  
> multiple writers to one dfs file.
>
> Just my 2 cents.
> Greetings,
> Stefan
>
>
> Am 22.03.2006 um 18:10 schrieb Yoram Arnon:
>
>> DFS files can only be written once, and by a single writer.
>> Until that changes our hands are tied, as long as we require the  
>> output to
>> reside in the output directory.
>>
>> Unless... we create a protocol whereby the task masters report up  
>> to the job
>> master, and it's only the job master that does the logging.
>> That might introduce unwanted overhead and some load on the job  
>> master.
>>
>>
>>> -----Original Message-----
>>> From: Eric Baldeschwieler [mailto:eric14@yahoo-inc.com]
>>> Sent: Tuesday, March 21, 2006 8:54 PM
>>> To: hadoop-dev@lucene.apache.org
>>> Subject: Re: [jira] Commented: (HADOOP-92) Error Reporting/ 
>>> logging in
>>> MapReduce
>>>
>>> Will it really make sense to have 300,000 subdirectories with  
>>> several
>>> log files?  Seems like a real loosing proposition.  I'd just go  
>>> for a
>>> single log file with reasonable per line prefixes (time, job, ...).
>>>
>>> Then you can grep out what you want.
>>
>>
>>
>
> ---------------------------------------------------------------
> company:        http://www.media-style.com
> forum:        http://www.text-mining.org
> blog:            http://www.find23.net
>
>


From MAILER-DAEMON Wed Mar 22 20:03:21 2006
Return-Path: 
 <hadoop-dev-return-486-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 78600 invoked from network); 22 Mar 2006 20:03:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 20:03:21 -0000
Received: (qmail 26526 invoked by uid 500); 22 Mar 2006 20:03:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26510 invoked by uid 500); 22 Mar 2006 20:03:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26501 invoked by uid 99); 22 Mar 2006 20:03:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 12:03:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 12:03:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CF415D4A01
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 20:02:58 +0000 (GMT)
Message-ID: <663898671.1143057778845.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 20:02:58 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-92) Error Reporting/logging in MapReduce
In-Reply-To: <136202795.1142570952505.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-92?page=comments#action_12371457 ] 

Doug Cutting commented on HADOOP-92:
------------------------------------

Another approach to this would be to expose this through the JobClient API.  Job-related events can be reported to the job client.  Events can be queued in the job tracker and the JobClient can retrieve them as it polls for job status.  Then the JobClient can decide where to log them.  By default they can be logged to standard error.

The events I think one might care about are:
  - task start (task_id, type & host)
  - task completion (task_id)
  - task failure (task_id, error message)

The jobtracker already tracks most of this, so I don't think this places a huge new burden on the jobtracker.

I don't like polluting the job's output directory with log data since it would require changes to the InputFormat implementations and other code to make them skip this specially named sub-directory (unless the name begins with a dot, which the fs code already ignores).

In any case, we could add an option to JobClient to log to the job's output fs.


> Error Reporting/logging in MapReduce
> ------------------------------------
>
>          Key: HADOOP-92
>          URL: http://issues.apache.org/jira/browse/HADOOP-92
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Mahadev konar
>     Priority: Minor

>
> Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 20:15:48 2006
Return-Path: 
 <hadoop-dev-return-487-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83697 invoked from network); 22 Mar 2006 20:15:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 20:15:48 -0000
Received: (qmail 50966 invoked by uid 500); 22 Mar 2006 20:15:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50951 invoked by uid 500); 22 Mar 2006 20:15:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50942 invoked by uid 99); 22 Mar 2006 20:15:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 12:15:46 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 12:15:46 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 37779D4A01
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 20:15:25 +0000 (GMT)
Message-ID: <891947220.1143058525224.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 20:15:25 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-3) Output directories are not cleaned up
 before the reduces run
In-Reply-To: <859498351.1139000372103.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-3?page=all ]
     
Doug Cutting resolved HADOOP-3:
-------------------------------

    Resolution: Fixed

I just committed this.  I converted under_scored variable names to camelCase.

> Output directories are not cleaned up before the reduces run
> ------------------------------------------------------------
>
>          Key: HADOOP-3
>          URL: http://issues.apache.org/jira/browse/HADOOP-3
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: clean-out-dir.patch, noclobber.patch
>
> The output directory for the reduces is not cleaned up and therefore if you can see left overs from previous runs, if they had more reduces. For example, if you run the application once with reduces=10 and then rerun with reduces=8, your output directory will have frag00000 to frag00009 with the first 8 fragments from the second run and the last 2 fragments from the first run.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 21:42:33 2006
Return-Path: 
 <hadoop-dev-return-488-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30824 invoked from network); 22 Mar 2006 21:42:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 21:42:33 -0000
Received: (qmail 13074 invoked by uid 500); 22 Mar 2006 21:42:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 13049 invoked by uid 500); 22 Mar 2006 21:42:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 13040 invoked by uid 99); 22 Mar 2006 21:42:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 13:42:32 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 13:42:32 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E0ADED4A01
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 21:42:10 +0000 (GMT)
Message-ID: <1928439752.1143063730917.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 21:42:10 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371466 ] 

Owen O'Malley commented on HADOOP-52:
-------------------------------------

I'll go ahead and update the variable names to camelCast.

The LocalJobRunner only has a problem when the user is submitting multiple jobs at the same time, right?

I knew I was opening a can of worms with local directories with respect to threads. There are lots of potential solutions including making the current directory thread local. (Although the LocalFileSystem would have discontinuities, because it also sets the system property, which is by definition global.) I think for now that we are better off following the unix semantics of treating the working directory as global.

For now, I'm proposing synchronizing on the file system, like:

        synchronize (fs) {
          setWorkingDirectory(job, fs);
          MapTask map = new MapTask(file, (String)mapIds.get(i), splits[i]);
        }

around each of the places where the LocalJobRunner sets the working directory.

On a side note, if we are worried about local runners with multiple jobs, we should put synchronization in around the updates of the jobs list and other fields of the LocalJobRunner.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 22:16:40 2006
Return-Path: 
 <hadoop-dev-return-489-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50898 invoked from network); 22 Mar 2006 22:16:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 22:16:40 -0000
Received: (qmail 72148 invoked by uid 500); 22 Mar 2006 22:16:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72127 invoked by uid 500); 22 Mar 2006 22:16:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72118 invoked by uid 99); 22 Mar 2006 22:16:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:16:38 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:16:37 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8364CD4A00
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 22:16:16 +0000 (GMT)
Message-ID: <1339426176.1143065776535.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 22:16:16 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371470 ] 

Owen O'Malley commented on HADOOP-52:
-------------------------------------

I'll go ahead and update the variable names to camelCast.

The LocalJobRunner only has a problem when the user is submitting multiple jobs at the same time, right?

I knew I was opening a can of worms with local directories with respect to threads. There are lots of potential solutions including making the current directory thread local. (Although the LocalFileSystem would have discontinuities, because it also sets the system property, which is by definition global.) I think for now that we are better off following the unix semantics of treating the working directory as global.

For now, I'm proposing synchronizing on the file system, like:

        synchronize (fs) {
          setWorkingDirectory(job, fs);
          MapTask map = new MapTask(file, (String)mapIds.get(i), splits[i]);
        }

around each of the places where the LocalJobRunner sets the working directory.

On a side note, if we are worried about local runners with multiple jobs, we should put synchronization in around the updates of the jobs list and other fields of the LocalJobRunner.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 22:16:46 2006
Return-Path: 
 <hadoop-dev-return-490-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50950 invoked from network); 22 Mar 2006 22:16:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 22:16:46 -0000
Received: (qmail 72319 invoked by uid 500); 22 Mar 2006 22:16:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72303 invoked by uid 500); 22 Mar 2006 22:16:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72294 invoked by uid 99); 22 Mar 2006 22:16:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:16:44 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:16:44 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2081AD4A02
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 22:16:23 +0000 (GMT)
Message-ID: <388072639.1143065783130.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 22:16:23 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-52?page=all ]

Owen O'Malley updated HADOOP-52:
--------------------------------

    Comment: was deleted

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 22:18:32 2006
Return-Path: 
 <hadoop-dev-return-491-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52370 invoked from network); 22 Mar 2006 22:18:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 22:18:32 -0000
Received: (qmail 75113 invoked by uid 500); 22 Mar 2006 22:18:32 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 75033 invoked by uid 500); 22 Mar 2006 22:18:31 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 75024 invoked by uid 99); 22 Mar 2006 22:18:31 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:18:31 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:18:31 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4557CD4A00
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 22:18:10 +0000 (GMT)
Message-ID: <631732451.1143065890281.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 22:18:10 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371471 ] 

Doug Cutting commented on HADOOP-52:
------------------------------------

The 'synchronize (fs) ...' is worthless unless everyone does it, which they don't, so I wouldn't bother.

I think you're right that my concern about LocalJobRunner is misplaced.  It is not a public class, and a new instance is created for each job, so there's currently no way to have multiple jobs sharing a LocalJobRunner.

Longer term, if this becomes an issue, I think making FileSystem cloneable is preferable to synchronization.


> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 22:20:20 2006
Return-Path: 
 <hadoop-dev-return-492-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53020 invoked from network); 22 Mar 2006 22:20:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 22:20:20 -0000
Received: (qmail 78020 invoked by uid 500); 22 Mar 2006 22:20:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78002 invoked by uid 500); 22 Mar 2006 22:20:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77993 invoked by uid 99); 22 Mar 2006 22:20:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:20:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:20:19 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id ED795D4A01
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 22:19:58 +0000 (GMT)
Message-ID: <1229259664.1143065998969.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 22:19:58 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-52?page=all ]

Owen O'Malley updated HADOOP-52:
--------------------------------

    Attachment: cwd2.patch

Ok, here is an updated patch that uses camelCase everywhere for variable names.

I also put in synchronization between the setWorkingDirectory and running the 
application code in the LocalJobRunner.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 22:32:23 2006
Return-Path: 
 <hadoop-dev-return-493-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60278 invoked from network); 22 Mar 2006 22:32:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 22:32:23 -0000
Received: (qmail 92672 invoked by uid 500); 22 Mar 2006 22:32:23 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92657 invoked by uid 500); 22 Mar 2006 22:32:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92647 invoked by uid 99); 22 Mar 2006 22:32:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:32:23 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:32:22 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A28566ACA9
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 22:32:01 +0000 (GMT)
Message-ID: <2140823563.1143066721663.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 22:32:01 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371476 ] 

Owen O'Malley commented on HADOOP-52:
-------------------------------------

The synchronized (fs) will help the case where the application submits two jobs to the LocalJobRunner with different working directories. Because the LocalJobRunner obeys the synchronization with respect to the file system object, it should work. (I don't have any parallel map/reduce job applications to test it with and testing for missing synchronization is almost impossible anyways.)

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 22:47:35 2006
Return-Path: 
 <hadoop-dev-return-494-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 70787 invoked from network); 22 Mar 2006 22:47:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 22:47:35 -0000
Received: (qmail 18787 invoked by uid 500); 22 Mar 2006 22:47:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18765 invoked by uid 500); 22 Mar 2006 22:47:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18756 invoked by uid 99); 22 Mar 2006 22:47:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:47:20 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 14:47:20 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2573ED4A01
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 22:46:59 +0000 (GMT)
Message-ID: <352001142.1143067619150.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 22:46:59 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371479 ] 

Doug Cutting commented on HADOOP-52:
------------------------------------

The synchronization fixes the problem, but causes everything to run sequentially.  I think with the same amount of code we could add a clone() method to FileSystem and provide a better fix.  Currently one cannot pass a FileSystem instance to JobClient, but if one could, then we would be changing the CWD of that filesystem underneath other processes that might be using it w/o synchronization.

If we want to be totally safe, we could make setWorkingDirectory return a clone, with no side-effects.  Cloning an FS should be cheap enough.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 23:07:36 2006
Return-Path: 
 <hadoop-dev-return-495-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80137 invoked from network); 22 Mar 2006 23:07:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 23:07:36 -0000
Received: (qmail 46821 invoked by uid 500); 22 Mar 2006 23:07:25 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 46771 invoked by uid 500); 22 Mar 2006 23:07:25 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 46706 invoked by uid 99); 22 Mar 2006 23:07:25 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 15:07:25 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 15:07:24 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9869AD4A02
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 23:07:03 +0000 (GMT)
Message-ID: <1539088410.1143068823621.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 23:07:03 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371483 ] 

Owen O'Malley commented on HADOOP-52:
-------------------------------------

By the way, i didn't see your comment from 10:17 when I submitted my patch at 10:18.

I'll go ahead and unsynchronize LocalJobRunner and roll a new patch.

I guess it does make sense to make FileSystem's clonable, even if LocalFileSystem sets the global system property. We can do that later.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 22 23:49:27 2006
Return-Path: 
 <hadoop-dev-return-496-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 729 invoked from network); 22 Mar 2006 23:49:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 22 Mar 2006 23:49:27 -0000
Received: (qmail 95568 invoked by uid 500); 22 Mar 2006 23:49:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 95552 invoked by uid 500); 22 Mar 2006 23:49:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 95542 invoked by uid 99); 22 Mar 2006 23:49:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 15:49:26 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 15:49:26 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 67BFBD4A00
	for <hadoop-dev@lucene.apache.org>; Wed, 22 Mar 2006 23:49:05 +0000 (GMT)
Message-ID: <155750624.1143071345422.JavaMail.jira@ajax>
Date: Wed, 22 Mar 2006 23:49:05 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-64) DataNode should be capable of managing
 multiple volumes
In-Reply-To: <96561968.1141686362086.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-64?page=all ]

Sameer Paranjpye reassigned HADOOP-64:
--------------------------------------

    Assign To: Konstantin Shvachko

> DataNode should be capable of managing multiple volumes
> -------------------------------------------------------
>
>          Key: HADOOP-64
>          URL: http://issues.apache.org/jira/browse/HADOOP-64
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.2

>
> The dfs Datanode can only store data on a single filesystem volume. When a node runs its disks JBOD this means running a Datanode per disk on the machine. While the scheme works reasonably well on small clusters, on larger installations (several 100 nodes) it implies a very large number of Datanodes with associated management overhead in the Namenode.
> The Datanod should be enhanced to be able to handle multiple volumes on a single machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 00:14:53 2006
Return-Path: 
 <hadoop-dev-return-497-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8597 invoked from network); 23 Mar 2006 00:14:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 00:14:53 -0000
Received: (qmail 18057 invoked by uid 500); 23 Mar 2006 00:14:53 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18036 invoked by uid 500); 23 Mar 2006 00:14:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18027 invoked by uid 99); 23 Mar 2006 00:14:53 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 16:14:53 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 16:14:52 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id F1310D4A00
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 00:14:31 +0000 (GMT)
Message-ID: <424815573.1143072871985.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 00:14:31 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-64) DataNode should be capable of
 managing multiple volumes
In-Reply-To: <96561968.1141686362086.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-64?page=comments#action_12371494 ] 

Doug Cutting commented on HADOOP-64:
------------------------------------

I am not convinced, w/o benchmarks, that this is required.  Multiple datanodes in the same JVM (as currently implemented) share a single TCP connection to the namenode.  However each currently sends separate heartbeats to the namenode.  Thus the primary impact of the proposed change would be that these heartbeats could be combined into a single RPC.  The processing on the server would be the same, only spread over fewer RPC calls.  So this change is primarily warranted if heartbeat RPC overhead dominates namenode performance.  Even if that's proven to be the case, then we can achieve a similar effect much more simply by increasing the heartbeat interval.


> DataNode should be capable of managing multiple volumes
> -------------------------------------------------------
>
>          Key: HADOOP-64
>          URL: http://issues.apache.org/jira/browse/HADOOP-64
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.2

>
> The dfs Datanode can only store data on a single filesystem volume. When a node runs its disks JBOD this means running a Datanode per disk on the machine. While the scheme works reasonably well on small clusters, on larger installations (several 100 nodes) it implies a very large number of Datanodes with associated management overhead in the Namenode.
> The Datanod should be enhanced to be able to handle multiple volumes on a single machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 01:03:55 2006
Return-Path: 
 <hadoop-dev-return-498-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26842 invoked from network); 23 Mar 2006 01:03:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 01:03:55 -0000
Received: (qmail 87808 invoked by uid 500); 23 Mar 2006 01:03:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87726 invoked by uid 500); 23 Mar 2006 01:03:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87717 invoked by uid 99); 23 Mar 2006 01:03:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 17:03:54 -0800
X-ASF-Spam-Status: No, hits=0.8 required=10.0
	tests=INFO_TLD
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 17:03:54 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3CE3ED4A02
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 01:03:33 +0000 (GMT)
Message-ID: <1276345462.1143075813246.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 01:03:33 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-83) infinite retries accessing a missing
 block
In-Reply-To: <671256830.1142449198957.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-83?page=comments#action_12371503 ] 

Konstantin Shvachko commented on HADOOP-83:
-------------------------------------------

In order to prevent the client from looping infinitely retrying to locate missing block the following line
-                   /**
                    if (failures >= MAX_BLOCK_ACQUIRE_FAILURES) {
                        throw new IOException("Could not obtain block " + blocks[targetBlock]);
                    }
-                   **/
in DFSClient.blockSeekTo(long) should be uncommented.
It is also desired to reduce the value of the MAX_BLOCK_ACQUIRE_FAILURES constant
which is set to 10 now. In current settings it will take at least 100 seconds to detect missing block.
So additionally to uncommenting the lines above I'd set
-   static int MAX_BLOCK_ACQUIRE_FAILURES = 10;
+   static int MAX_BLOCK_ACQUIRE_FAILURES = 3;
and reduce sleeping time between retries to 3 seconds from current 10
                    LOG.info("Could not obtain block from any node:  " + ie);
                    try {
-                       Thread.sleep(10000);
+                       Thread.sleep(3000);
                    } catch (InterruptedException iex) {
                    }


> infinite retries accessing a missing block
> ------------------------------------------
>
>          Key: HADOOP-83
>          URL: http://issues.apache.org/jira/browse/HADOOP-83
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko

>
> A file in the DFS got corrupted - the reason for that is unknown, but might be justified.
> when accessing the file, I get an infinite stream of error messages from the client - attached below.
> The client aparently increments an error counter, but never checks it.
> Correct behaviour is for the client to retry a few times, then abort.
> 060315 105436 No node available for block blk_2690692619196463439
> 060315 105436 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105446 No node available for block blk_2690692619196463439
> 060315 105446 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105456 No node available for block blk_2690692619196463439
> 060315 105456 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105506 No node available for block blk_2690692619196463439
> 060315 105506 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105516 No node available for block blk_2690692619196463439
> 060315 105516 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105526 No node available for block blk_2690692619196463439
> 060315 105526 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105536 No node available for block blk_2690692619196463439
> 060315 105536 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105546 No node available for block blk_2690692619196463439
> 060315 105546 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105556 No node available for block blk_2690692619196463439
> 060315 105556 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105606 No node available for block blk_2690692619196463439
> 060315 105606 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105616 No node available for block blk_2690692619196463439
> 060315 105616 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105626 No node available for block blk_2690692619196463439
> 060315 105626 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105636 No node available for block blk_2690692619196463439
> 060315 105636 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105646 No node available for block blk_2690692619196463439
> 060315 105646 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105657 No node available for block blk_2690692619196463439
> 060315 105657 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105707 No node available for block blk_2690692619196463439
> 060315 105707 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105717 No node available for block blk_2690692619196463439
> 060315 105717 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105727 No node available for block blk_2690692619196463439
> 060315 105727 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105737 No node available for block blk_2690692619196463439
> 060315 105737 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105747 No node available for block blk_2690692619196463439
> 060315 105747 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105757 No node available for block blk_2690692619196463439
> 060315 105757 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105807 No node available for block blk_2690692619196463439
> 060315 105807 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105817 No node available for block blk_2690692619196463439

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 01:28:48 2006
Return-Path: 
 <hadoop-dev-return-499-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 38579 invoked from network); 23 Mar 2006 01:28:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 01:28:48 -0000
Received: (qmail 14201 invoked by uid 500); 23 Mar 2006 01:28:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14179 invoked by uid 500); 23 Mar 2006 01:28:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14170 invoked by uid 99); 23 Mar 2006 01:28:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 17:28:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Mar 2006 17:28:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 96E41D4A01
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 01:28:26 +0000 (GMT)
Message-ID: <722156556.1143077306615.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 01:28:26 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-64) DataNode should be capable of
 managing multiple volumes
In-Reply-To: <96561968.1141686362086.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-64?page=comments#action_12371504 ] 

Sameer Paranjpye commented on HADOOP-64:
----------------------------------------

Heartbeat overhead aside, a second motivator for this change is the simplification of block placement logic. The namenode wouldn't have to track the datanode-machine mapping to ensure that replicas of a block don't end up on the same box. I don't know if this is currently done, but if not it could be a problem. Also, if block placement decisions are to be made based on some measure of load (number of blocks in being read/written, CPU usage etc.) the load needs to be tracked at a machine level. It's simpler to note have the namenode compute the aggregate load per machine.

> DataNode should be capable of managing multiple volumes
> -------------------------------------------------------
>
>          Key: HADOOP-64
>          URL: http://issues.apache.org/jira/browse/HADOOP-64
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.2
>     Reporter: Sameer Paranjpye
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.2

>
> The dfs Datanode can only store data on a single filesystem volume. When a node runs its disks JBOD this means running a Datanode per disk on the machine. While the scheme works reasonably well on small clusters, on larger installations (several 100 nodes) it implies a very large number of Datanodes with associated management overhead in the Namenode.
> The Datanod should be enhanced to be able to handle multiple volumes on a single machine.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 08:07:34 2006
Return-Path: 
 <hadoop-dev-return-500-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11182 invoked from network); 23 Mar 2006 08:07:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 08:07:34 -0000
Received: (qmail 73028 invoked by uid 500); 23 Mar 2006 08:07:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72945 invoked by uid 500); 23 Mar 2006 08:07:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72936 invoked by uid 99); 23 Mar 2006 08:07:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 00:07:32 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 00:07:32 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 477EE6ACA9
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 08:07:11 +0000 (GMT)
Message-ID: <1658060985.1143101231280.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 08:07:11 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Work started: (HADOOP-46) user-specified job names
In-Reply-To: <1072400095.1140559938030.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-46?page=all ]
     
Work on HADOOP-46 started by Owen O'Malley

> user-specified job names
> ------------------------
>
>          Key: HADOOP-46
>          URL: http://issues.apache.org/jira/browse/HADOOP-46
>      Project: Hadoop
>         Type: New Feature
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1

>
> It should be possible to supply a name when a job is submitted.  This can then be used in the web ui to describe the job.  Perhaps this should just be a job property (mapred.job.name).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 08:07:34 2006
Return-Path: 
 <hadoop-dev-return-501-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11199 invoked from network); 23 Mar 2006 08:07:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 08:07:34 -0000
Received: (qmail 73127 invoked by uid 500); 23 Mar 2006 08:07:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73044 invoked by uid 500); 23 Mar 2006 08:07:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73035 invoked by uid 99); 23 Mar 2006 08:07:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 00:07:34 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 00:07:33 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CE4A86ACAB
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 08:07:12 +0000 (GMT)
Message-ID: <561858998.1143101232842.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 08:07:12 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Work started: (HADOOP-52) mapred input and output dirs must
 be absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-52?page=all ]
     
Work on HADOOP-52 started by Owen O'Malley

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 08:14:35 2006
Return-Path: 
 <hadoop-dev-return-502-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 14222 invoked from network); 23 Mar 2006 08:14:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 08:14:35 -0000
Received: (qmail 83383 invoked by uid 500); 23 Mar 2006 08:14:35 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 83364 invoked by uid 500); 23 Mar 2006 08:14:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 83355 invoked by uid 99); 23 Mar 2006 08:14:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 00:14:34 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 00:14:34 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 5C1BCD4A00
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 08:14:13 +0000 (GMT)
Message-ID: <1952812446.1143101653374.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 08:14:13 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-98) The JobTracker's count of the number of
 running maps and reduces is wrong
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

The JobTracker's count of the number of running maps and reduces is wrong
-------------------------------------------------------------------------

         Key: HADOOP-98
         URL: http://issues.apache.org/jira/browse/HADOOP-98
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.1


When a heatbeat comes in from a task tracker, the job tracker just adds the number of currently running maps and reduces. The jobs from the previous heartbear are never subtracted. This causes the scheduling to misjudge the "loading" levels of the task trackers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 08:32:23 2006
Return-Path: 
 <hadoop-dev-return-503-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26265 invoked from network); 23 Mar 2006 08:32:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 08:32:23 -0000
Received: (qmail 22366 invoked by uid 500); 23 Mar 2006 08:32:22 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 22221 invoked by uid 500); 23 Mar 2006 08:32:22 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 22203 invoked by uid 99); 23 Mar 2006 08:32:22 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 00:32:22 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 00:32:21 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7FD3C6ACAC
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 08:32:00 +0000 (GMT)
Message-ID: <1017503414.1143102720520.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 08:32:00 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-99) task trackers can only be assigned one
 task every heartbeat
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

task trackers can only be assigned one task every heartbeat
-----------------------------------------------------------

         Key: HADOOP-99
         URL: http://issues.apache.org/jira/browse/HADOOP-99
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Versions: 0.1    
    Reporter: Owen O'Malley


Task trackers only call pollForNewTask once per a heartbeat (10 seconds) rather than when a task finishes. Especially for quick maps this means that the cluster is under utilized, because each map finishes in a cycle and the task tracker never gets a second, third or fourth task to run.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 11:46:10 2006
Return-Path: 
 <hadoop-dev-return-504-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 28707 invoked from network); 23 Mar 2006 11:46:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 11:46:10 -0000
Received: (qmail 60376 invoked by uid 500); 23 Mar 2006 11:46:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60300 invoked by uid 500); 23 Mar 2006 11:46:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 60251 invoked by uid 99); 23 Mar 2006 11:46:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 03:46:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 03:46:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 03FDBD4A01
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 11:45:42 +0000 (GMT)
Message-ID: <295547423.1143114342012.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 11:45:42 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-75) dfs should check full file
 availability only at close
In-Reply-To: <873621841.1142030138809.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-75?page=all ]

Sameer Paranjpye reassigned HADOOP-75:
--------------------------------------

    Assign To: Konstantin Shvachko

> dfs should check full file availability only at close
> -----------------------------------------------------
>
>          Key: HADOOP-75
>          URL: http://issues.apache.org/jira/browse/HADOOP-75
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1

>
> Currently it appears that dfs checks that the namenode knows about all blocks in a file as each block is written.  It would be more efficient to only check that all blocks are stored somewhere when the file is closed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 16:56:46 2006
Return-Path: 
 <hadoop-dev-return-505-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17532 invoked from network); 23 Mar 2006 16:56:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 16:56:46 -0000
Received: (qmail 71546 invoked by uid 500); 23 Mar 2006 16:56:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71458 invoked by uid 500); 23 Mar 2006 16:56:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71414 invoked by uid 99); 23 Mar 2006 16:56:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 08:56:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 08:56:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4F4DED4A01
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 16:56:19 +0000 (GMT)
Message-ID: <1575039653.1143132979322.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 16:56:19 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-52?page=all ]

Owen O'Malley updated HADOOP-52:
--------------------------------

    Attachment: cwd3.patch

Ok, this patch includes cwd2.patch with the synchronization in LocalJobRunner rolled back.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch, cwd3.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 17:09:43 2006
Return-Path: 
 <hadoop-dev-return-506-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23349 invoked from network); 23 Mar 2006 17:09:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 17:09:43 -0000
Received: (qmail 94677 invoked by uid 500); 23 Mar 2006 17:09:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94593 invoked by uid 500); 23 Mar 2006 17:09:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94584 invoked by uid 99); 23 Mar 2006 17:09:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 09:09:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 09:09:39 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D344ED4A03
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 17:09:18 +0000 (GMT)
Message-ID: <884327691.1143133758862.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 17:09:18 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-100) Inconsistent locking of the
 JobTracker.taskTrackers field
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Inconsistent locking of the JobTracker.taskTrackers field
---------------------------------------------------------

         Key: HADOOP-100
         URL: http://issues.apache.org/jira/browse/HADOOP-100
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
     Fix For: 0.1


The JobTracker is using an inconsistant lock for protecting taskTrackers, which is the list of current task trackers. Some of the routines lock the JobTracker and others lock the taskTrackers field.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 18:14:49 2006
Return-Path: 
 <hadoop-dev-return-507-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 59657 invoked from network); 23 Mar 2006 18:14:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 18:14:49 -0000
Received: (qmail 19526 invoked by uid 500); 23 Mar 2006 18:14:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 19500 invoked by uid 500); 23 Mar 2006 18:14:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 19491 invoked by uid 99); 23 Mar 2006 18:14:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:14:42 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:14:41 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7C1E0D4A02
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 18:14:20 +0000 (GMT)
Message-ID: <67766809.1143137660505.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 18:14:20 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-83) infinite retries accessing a missing
 block
In-Reply-To: <671256830.1142449198957.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-83?page=all ]
     
Doug Cutting resolved HADOOP-83:
--------------------------------

    Resolution: Fixed

Okay, I've commited this.

Note that this situation can occur while a dfs system is starting up.  If one lanuches the namenode prior to the datanodes then the namenode will know about files but not yet know wherre their blocks are, until the datanodes check in for the first time.  I recently changed the bin/start-all.sh script to start the namenode first, so that datanodes would not all initially report problems connecting to the namenode.  I knew there was a reason that it was done in the other order, but could not remember what the reason was.  Now I remember!  I switched that back and added a comment.

Also, next time, can you please attach a patch file, so that I don't have to manually make your suggested changes?  Thanks!


> infinite retries accessing a missing block
> ------------------------------------------
>
>          Key: HADOOP-83
>          URL: http://issues.apache.org/jira/browse/HADOOP-83
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko

>
> A file in the DFS got corrupted - the reason for that is unknown, but might be justified.
> when accessing the file, I get an infinite stream of error messages from the client - attached below.
> The client aparently increments an error counter, but never checks it.
> Correct behaviour is for the client to retry a few times, then abort.
> 060315 105436 No node available for block blk_2690692619196463439
> 060315 105436 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105446 No node available for block blk_2690692619196463439
> 060315 105446 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105456 No node available for block blk_2690692619196463439
> 060315 105456 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105506 No node available for block blk_2690692619196463439
> 060315 105506 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105516 No node available for block blk_2690692619196463439
> 060315 105516 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105526 No node available for block blk_2690692619196463439
> 060315 105526 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105536 No node available for block blk_2690692619196463439
> 060315 105536 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105546 No node available for block blk_2690692619196463439
> 060315 105546 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105556 No node available for block blk_2690692619196463439
> 060315 105556 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105606 No node available for block blk_2690692619196463439
> 060315 105606 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105616 No node available for block blk_2690692619196463439
> 060315 105616 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105626 No node available for block blk_2690692619196463439
> 060315 105626 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105636 No node available for block blk_2690692619196463439
> 060315 105636 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105646 No node available for block blk_2690692619196463439
> 060315 105646 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105657 No node available for block blk_2690692619196463439
> 060315 105657 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105707 No node available for block blk_2690692619196463439
> 060315 105707 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105717 No node available for block blk_2690692619196463439
> 060315 105717 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105727 No node available for block blk_2690692619196463439
> 060315 105727 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105737 No node available for block blk_2690692619196463439
> 060315 105737 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105747 No node available for block blk_2690692619196463439
> 060315 105747 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105757 No node available for block blk_2690692619196463439
> 060315 105757 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105807 No node available for block blk_2690692619196463439
> 060315 105807 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105817 No node available for block blk_2690692619196463439

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 18:42:53 2006
Return-Path: 
 <hadoop-dev-return-508-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74811 invoked from network); 23 Mar 2006 18:42:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 18:42:53 -0000
Received: (qmail 59949 invoked by uid 500); 23 Mar 2006 18:42:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59896 invoked by uid 500); 23 Mar 2006 18:42:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59847 invoked by uid 99); 23 Mar 2006 18:42:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:42:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:42:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DCD08D4A01
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 18:42:21 +0000 (GMT)
Message-ID: <69967710.1143139341901.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 18:42:21 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-52?page=all ]
     
Doug Cutting resolved HADOOP-52:
--------------------------------

    Resolution: Fixed

I have committed this.  Thanks for adding unit tests! I had to add a Thread.sleep(1000) to the dfs test code before the tests would pass, to give the datanode a chance to introduce itself to the namenode before the client code started using the fs.  Perhaps this is just masking a bug.  Perhaps DFSClient should sleep and retry when NameNode.create() throws an exception?

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch, cwd3.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 18:52:40 2006
Return-Path: 
 <hadoop-dev-return-509-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79356 invoked from network); 23 Mar 2006 18:52:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 18:52:40 -0000
Received: (qmail 76090 invoked by uid 500); 23 Mar 2006 18:52:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76066 invoked by uid 500); 23 Mar 2006 18:52:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76050 invoked by uid 99); 23 Mar 2006 18:52:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:52:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:52:39 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id AF3E56ACA9
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 18:52:18 +0000 (GMT)
Message-ID: <958365348.1143139938715.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 18:52:18 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-101) DFSck - fsck-like utility for checking
 DFS volumes
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DFSck - fsck-like utility for checking DFS volumes
--------------------------------------------------

         Key: HADOOP-101
         URL: http://issues.apache.org/jira/browse/HADOOP-101
     Project: Hadoop
        Type: New Feature
  Components: dfs  
    Versions: 0.2    
    Reporter: Andrzej Bialecki 
 Assigned to: Andrzej Bialecki  
 Attachments: DFSck.java

This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 18:52:42 2006
Return-Path: 
 <hadoop-dev-return-511-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79392 invoked from network); 23 Mar 2006 18:52:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 18:52:42 -0000
Received: (qmail 76361 invoked by uid 500); 23 Mar 2006 18:52:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76276 invoked by uid 500); 23 Mar 2006 18:52:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76183 invoked by uid 99); 23 Mar 2006 18:52:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:52:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:52:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D20AF6ACAC
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 18:52:19 +0000 (GMT)
Message-ID: <1055400278.1143139939857.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 18:52:19 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-87) SequenceFile performance degrades
 substantially compression is on and large values are encountered
In-Reply-To: <210558648.1142549462664.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-87?page=comments#action_12371611 ] 

Sameer Paranjpye commented on HADOOP-87:
----------------------------------------

It is less code and memory and is more elegant than the other fix. We were unable to measure a performance difference either, although I'm at a loss to explain why. It looks like under the hood the streaming implementation is pretty close to the old implementation. 

Internally, the DeflaterOutputStream passes a bytearray to the Deflater and compresses it in small chunks of 512 bytes (compressed), making a JNI call for each such chunk. So, in theory we should see poor performance for large values.

Large unused buffers don't persist however, which is nice. All in all, it appears to work great.




> SequenceFile performance degrades substantially compression is on and large values are encountered
> --------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-87
>          URL: http://issues.apache.org/jira/browse/HADOOP-87
>      Project: Hadoop
>         Type: Improvement
>   Components: io
>     Versions: 0.1
>     Reporter: Sameer Paranjpye
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: hadoop-87-3.txt, hadoop-87.fix, hadoop_87.fix
>
> The code snippet in quesiton is:
>      if (deflateValues) {
>         deflateIn.reset();
>         val.write(deflateIn);
>         deflater.reset();
>         deflater.setInput(deflateIn.getData(), 0, deflateIn.getLength());
>         deflater.finish();
>         while (!deflater.finished()) {
>           int count = deflater.deflate(deflateOut);
>           buffer.write(deflateOut, 0, count);
>         }
>       } else {
>   
> A couple of issues with this code:
> 1. The value is serialized to the 'deflateIn' buffer which is an instance of 'DataOutputBuffer', this grows as large as needed to store the serialized value and stays as large as the largest serialized value encountered. If, for instance a stream has a single 8MB value followed by several 8KB values the size of the buffer stays at 8MB. The problem is that the *entire* 8MB buffer is always copied over the JNI boundary regardless of the size of the value. We've observed this over several runs where compression performance degrades by a couple of orders of magnitude when a very large value is encountered. Shrinking the buffer fixes the problem.
> 2. Data is copied lots of times. First the value is serialized into 'deflateIn'. Second, the value is copied over the JNI boundary in *every* iteration of the while loop. Third, the compressed data is copied piecemeal into 'deflateOut'. Finally, it is appended to 'buffer'.
> Proposed fix:
> 1. Don't let big buffers persist. Allow 'deflateIn' to grow to a *persistent* maximum reasonable size, say 64KB. If a larger value is encountered, grow the buffer in order to process the value, then shrink it back to the maximum size. To do this, we add a 'reset' method which takes a buffer size.
> 2. Don't use a loop to deflate. The maximum size of the output can be determined by 'maxOutputSize = inputSize * 1.01 + 12'. This is the maximum output size that zlib will produce. We allocate a large enough output buffer and compress everything in 1 pass. The output buffer, of course, needs to shrink as well.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 18:52:41 2006
Return-Path: 
 <hadoop-dev-return-510-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 79378 invoked from network); 23 Mar 2006 18:52:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 18:52:41 -0000
Received: (qmail 76268 invoked by uid 500); 23 Mar 2006 18:52:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76182 invoked by uid 500); 23 Mar 2006 18:52:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76162 invoked by uid 99); 23 Mar 2006 18:52:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:52:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 10:52:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 735246ACAB
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 18:52:19 +0000 (GMT)
Message-ID: <2125842249.1143139939469.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 18:52:19 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-101) DFSck - fsck-like utility for checking
 DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-101?page=all ]

Andrzej Bialecki  updated HADOOP-101:
-------------------------------------

    Attachment: DFSck.java

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 19:34:42 2006
Return-Path: 
 <hadoop-dev-return-512-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 99335 invoked from network); 23 Mar 2006 19:34:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 19:34:42 -0000
Received: (qmail 25359 invoked by uid 500); 23 Mar 2006 19:34:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 25274 invoked by uid 500); 23 Mar 2006 19:34:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 25265 invoked by uid 99); 23 Mar 2006 19:34:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 11:34:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 11:34:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 1A8E46ACAC
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 19:34:20 +0000 (GMT)
Message-ID: <1135581815.1143142460106.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 19:34:20 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-98) The JobTracker's count of the number of
 running maps and reduces is wrong
In-Reply-To: <1952812446.1143101653374.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-98?page=all ]

Owen O'Malley updated HADOOP-98:
--------------------------------

    Attachment: task-counter.patch

This patch consolidate all of the places where status was put in to or out of the taskTrackers status map, so that
the counts of maps and reduces are maintained consistently. 

I also added the cluster status to the webapp so that you can get a quick view of how busy the cluster is.

> The JobTracker's count of the number of running maps and reduces is wrong
> -------------------------------------------------------------------------
>
>          Key: HADOOP-98
>          URL: http://issues.apache.org/jira/browse/HADOOP-98
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: task-counter.patch
>
> When a heatbeat comes in from a task tracker, the job tracker just adds the number of currently running maps and reduces. The jobs from the previous heartbear are never subtracted. This causes the scheduling to misjudge the "loading" levels of the task trackers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 19:42:41 2006
Return-Path: 
 <hadoop-dev-return-513-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 3296 invoked from network); 23 Mar 2006 19:42:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 19:42:41 -0000
Received: (qmail 41644 invoked by uid 500); 23 Mar 2006 19:42:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41496 invoked by uid 500); 23 Mar 2006 19:42:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41487 invoked by uid 99); 23 Mar 2006 19:42:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 11:42:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 11:42:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 500CB6ACA9
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 19:42:19 +0000 (GMT)
Message-ID: <2112991218.1143142939325.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 19:42:19 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371625 ] 

Konstantin Shvachko commented on HADOOP-101:
--------------------------------------------

Looks like a good utility for collecting meta-data statistics.

It does not detect missing blocks, though.
The missing block problem is when the namenode "thinks" a block
is stored on one or several datanodes, while it is not.
In order to detect this the utility needs to actually read blocks from
each of the specified locations. Is there an API call for that?
And it does not have an option to convert the system into a consistent state,
which is usually provided by fscks.

It would be very useful to integrate this code with the DFSShell.report(),
providing more reporting options for the system.

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 19:50:44 2006
Return-Path: 
 <hadoop-dev-return-514-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 7814 invoked from network); 23 Mar 2006 19:50:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 19:50:44 -0000
Received: (qmail 60139 invoked by uid 500); 23 Mar 2006 19:50:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 60006 invoked by uid 500); 23 Mar 2006 19:50:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59924 invoked by uid 99); 23 Mar 2006 19:50:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 11:50:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 11:50:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 169ABD4A03
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 19:50:20 +0000 (GMT)
Message-ID: <554062705.1143143420090.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 19:50:20 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371628 ] 

Andrzej Bialecki  commented on HADOOP-101:
------------------------------------------

It does detect missing blocks, that's the whole point. However, you need to restart the namenode first to be sure you get the latest block reports from datanodes.

Current failure modes for DFS involve blocks that are completely missing. The only way to "fix" them would be to recover chains of blocks and put them into lost+found - and here we could do better than fsck, because we know the file name they belong to.

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 20:04:45 2006
Return-Path: 
 <hadoop-dev-return-515-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15481 invoked from network); 23 Mar 2006 20:04:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 20:04:45 -0000
Received: (qmail 85309 invoked by uid 500); 23 Mar 2006 20:04:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 85278 invoked by uid 500); 23 Mar 2006 20:04:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 85266 invoked by uid 99); 23 Mar 2006 20:04:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 12:04:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 12:04:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C35496ACAB
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 20:04:21 +0000 (GMT)
Message-ID: <768791817.1143144261797.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 20:04:21 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371631 ] 

Andrzej Bialecki  commented on HADOOP-101:
------------------------------------------

Oops, forgot to comment on another point you make: yes, it would be great if we could add an API call to request a datanode to check the status of a given block without sending it to the client, e..g read it physically off the disk and report success/failure. We can do this now only by actually retrieving the block, which is too costly.

This is the first version of the tool, any contributions are of course welcome.

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 20:09:41 2006
Return-Path: 
 <hadoop-dev-return-516-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 17000 invoked from network); 23 Mar 2006 20:09:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 20:09:41 -0000
Received: (qmail 91221 invoked by uid 500); 23 Mar 2006 20:09:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91141 invoked by uid 500); 23 Mar 2006 20:09:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 91131 invoked by uid 99); 23 Mar 2006 20:09:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 12:09:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 12:09:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 685DFD4A02
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 20:09:19 +0000 (GMT)
Message-ID: <1173420780.1143144559425.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 20:09:19 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-98) The JobTracker's count of the number
 of running maps and reduces is wrong
In-Reply-To: <1952812446.1143101653374.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-98?page=all ]
     
Doug Cutting resolved HADOOP-98:
--------------------------------

    Resolution: Fixed

This looks great.  I just committed it.  Thanks, Owen.

> The JobTracker's count of the number of running maps and reduces is wrong
> -------------------------------------------------------------------------
>
>          Key: HADOOP-98
>          URL: http://issues.apache.org/jira/browse/HADOOP-98
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: task-counter.patch
>
> When a heatbeat comes in from a task tracker, the job tracker just adds the number of currently running maps and reduces. The jobs from the previous heartbear are never subtracted. This causes the scheduling to misjudge the "loading" levels of the task trackers.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 20:36:42 2006
Return-Path: 
 <hadoop-dev-return-517-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34969 invoked from network); 23 Mar 2006 20:36:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 20:36:42 -0000
Received: (qmail 32969 invoked by uid 500); 23 Mar 2006 20:36:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 32883 invoked by uid 500); 23 Mar 2006 20:36:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32868 invoked by uid 99); 23 Mar 2006 20:36:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 12:36:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 12:36:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4297AD4A01
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 20:36:19 +0000 (GMT)
Message-ID: <1119844618.1143146179270.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 20:36:19 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-88) Configuration: separate client config
 from server config (and from other-server config)
In-Reply-To: <1512399529.1142558161467.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-88?page=all ]

Doug Cutting updated HADOOP-88:
-------------------------------

      Component: conf
    Fix Version: 0.2
      Assign To:     (was: Doug Cutting)
       Priority: Minor  (was: Major)

> Configuration: separate client config from server config (and from other-server config)
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-88
>          URL: http://issues.apache.org/jira/browse/HADOOP-88
>      Project: Hadoop
>         Type: Wish
>   Components: conf
>     Reporter: Michel Tourn
>     Priority: Minor
>      Fix For: 0.2

>
> servers = JobTracker, NameNode, TaskTracker, DataNode
> clients =  runs JobClient (to submit MapReduce jobs), or runs DFSShell (to browse )
> Server machines are administered together.
> So it is OK to have all server config together (esp file paths and network ports).
> This is stored in hadoop-default.xml or hadoop-mycluster.xml
> Client machines:
> there may be as many client machines as there are MapRed developers.
> the temp space for DFS needs to be writable by the active user.
> So it should be possible to select the client temp space directory for the machine and for the user.
> (The global /tmp is not an option as discussed elsewhere: partition may be full)
> Current situation: 
> Both the server and the clients have a copy of the server config: hadoop-default.xml
> But the XML property  "dfs.data.dir" is being used as a LOCAL directory path 
> on both the server machines (Data nodes) and the client machines.
> Effect:
> Exception in thread "main" java.io.IOException: No valid local directories in property: dfs.data.dir
>  at org.apache.hadoop.conf.Configuration.getFile(Configuration.java:286)
>  at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.newBackupFile(DFSClient.java:560)
>  ...
>  at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:267)
> Current Workaround:
> On the client use hadoop-site.xml to override dfs.data.dir
> One proposed solution:
> For the purpose of JobClient operations, use a different property in place of dfs.data.dir.
> (Ex: dfs.client.data.dir) 
> On the client, set this property in hadoop-site.xml so that it will override hadoop-default.xml 
> Another proposed solution:
> Handle the fact that the world is made of a federation of independant Hadoop systems.
> They can talk to each other (as peers) but they are administered separately.
> Each Hadoop system should have its own separate XML config file.
> Clients should be able to specify the Hadoop system they want to talk to.
> An advantage is that clients can then easily sync their local copy of a given Hadoop system config:
>  just pull its config file
> In this view of the world, a Job client is also a kind of independant (serverless) Hadoop system
> In this case the client config file may have its own dfs.data.dir, which is 
> separate from the dfs.data.dir in the server config file.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 22:13:41 2006
Return-Path: 
 <hadoop-dev-return-518-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 80227 invoked from network); 23 Mar 2006 22:13:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 22:13:41 -0000
Received: (qmail 5064 invoked by uid 500); 23 Mar 2006 22:13:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4980 invoked by uid 500); 23 Mar 2006 22:13:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4971 invoked by uid 99); 23 Mar 2006 22:13:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 14:13:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 14:13:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4C2BA6ACA9
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 22:13:19 +0000 (GMT)
Message-ID: <418257582.1143151999303.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 22:13:19 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-46) user-specified job names
In-Reply-To: <1072400095.1140559938030.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-46?page=all ]

Owen O'Malley updated HADOOP-46:
--------------------------------

    Attachment: jobname.patch

Here is a patch that puts a job name in the JobConf, JobProfile, and webapp.
The examples use the new method to set job names for themselves.

> user-specified job names
> ------------------------
>
>          Key: HADOOP-46
>          URL: http://issues.apache.org/jira/browse/HADOOP-46
>      Project: Hadoop
>         Type: New Feature
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: jobname.patch
>
> It should be possible to supply a name when a job is submitted.  This can then be used in the web ui to describe the job.  Perhaps this should just be a job property (mapred.job.name).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 22:54:42 2006
Return-Path: 
 <hadoop-dev-return-519-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1506 invoked from network); 23 Mar 2006 22:54:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 22:54:42 -0000
Received: (qmail 64330 invoked by uid 500); 23 Mar 2006 22:54:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64295 invoked by uid 500); 23 Mar 2006 22:54:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64215 invoked by uid 99); 23 Mar 2006 22:54:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 14:54:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 14:54:41 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4E5F9D4A03
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 22:54:20 +0000 (GMT)
Message-ID: <1241278729.1143154460318.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 22:54:20 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-46) user-specified job names
In-Reply-To: <1072400095.1140559938030.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-46?page=all ]
     
Doug Cutting resolved HADOOP-46:
--------------------------------

    Resolution: Fixed

This looks great.  I just committed it.  Thanks, again, Owen!

> user-specified job names
> ------------------------
>
>          Key: HADOOP-46
>          URL: http://issues.apache.org/jira/browse/HADOOP-46
>      Project: Hadoop
>         Type: New Feature
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: jobname.patch
>
> It should be possible to supply a name when a job is submitted.  This can then be used in the web ui to describe the job.  Perhaps this should just be a job property (mapred.job.name).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 23 23:11:42 2006
Return-Path: 
 <hadoop-dev-return-520-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8744 invoked from network); 23 Mar 2006 23:11:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 23 Mar 2006 23:11:42 -0000
Received: (qmail 94837 invoked by uid 500); 23 Mar 2006 23:11:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94820 invoked by uid 500); 23 Mar 2006 23:11:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 94811 invoked by uid 99); 23 Mar 2006 23:11:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 15:11:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 15:11:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 15FDCD4A01
	for <hadoop-dev@lucene.apache.org>; Thu, 23 Mar 2006 23:11:20 +0000 (GMT)
Message-ID: <1137998938.1143155480082.JavaMail.jira@ajax>
Date: Thu, 23 Mar 2006 23:11:20 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371653 ] 

Hairong Kuang commented on HADOOP-101:
--------------------------------------

The dfsck is done at the client side and hence does not lock the file system. It has a potential inconsitency problem. What if a client deletes a directory when  tool is checking it?

Another concern is the performance. The tool needs to issue a RPC to the namenode for each dir/file in the system. Any benchmark?

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 00:08:48 2006
Return-Path: 
 <hadoop-dev-return-521-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30492 invoked from network); 24 Mar 2006 00:08:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 00:08:48 -0000
Received: (qmail 93440 invoked by uid 500); 24 Mar 2006 00:08:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93383 invoked by uid 500); 24 Mar 2006 00:08:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93341 invoked by uid 99); 24 Mar 2006 00:08:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 16:08:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 16:08:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 351ADD4A03
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 00:08:21 +0000 (GMT)
Message-ID: <1194279173.1143158901214.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 00:08:21 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371657 ] 

Doug Cutting commented on HADOOP-101:
-------------------------------------

I think not locking the fs is a feature.  It should probably, if it gets file-not-found error from the namenode, backup and recheck to see if the file still exists, and, if it doesn't check whether its parent still exists, etc., attempting to ignore errors that are only the result of changes to the FS while checking it.  In the short-term, this tool is superior to anything else we currently have, and I'd vote for adding it as a 'bin/hadoop dfs -check' command.  As for performance, as a single-threaded client process it shouldn't be able to overwhelm the namenode.


> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 00:43:42 2006
Return-Path: 
 <hadoop-dev-return-522-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47405 invoked from network); 24 Mar 2006 00:43:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 00:43:42 -0000
Received: (qmail 28579 invoked by uid 500); 24 Mar 2006 00:43:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 28562 invoked by uid 500); 24 Mar 2006 00:43:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 28553 invoked by uid 99); 24 Mar 2006 00:43:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 16:43:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 16:43:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0C4B06ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 00:43:20 +0000 (GMT)
Message-ID: <495051340.1143161000044.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 00:43:20 +0000 (GMT)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371658 ] 

Yoram Arnon commented on HADOOP-101:
------------------------------------

This is a good and awaited feature, filed previously as bug hadoop-95. I vote to check it in, because as you say, it's much better than anything we have, and of critical importance.

Regarding performance, clearly the nameserver will not be overwhelmed, but the operation may take a very long time to execute. It's one thing to traverse a million entries in memory (for a modest 32TB FS), but another matter to execute a hundred thousand RPC calls from a single client. Also, when we change the open command to not return the entire list of blocks, in the interest of shortening the time of opening a file, especially when reading just a few blocks from a very large file, the implementation will need to change.

Lastly, there's extensibility. We'll want to test for things that are available only on the name server, like blocks that are not used by any file.

Wouldn't it be better to request the server to execute this code internally, and report results either to the client or to a local file?

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 00:56:41 2006
Return-Path: 
 <hadoop-dev-return-523-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51709 invoked from network); 24 Mar 2006 00:56:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 00:56:41 -0000
Received: (qmail 40177 invoked by uid 500); 24 Mar 2006 00:56:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40156 invoked by uid 500); 24 Mar 2006 00:56:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40147 invoked by uid 99); 24 Mar 2006 00:56:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 16:56:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 16:56:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 5865C6ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 00:56:19 +0000 (GMT)
Message-ID: <1014579225.1143161779359.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 00:56:19 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371659 ] 

Doug Cutting commented on HADOOP-101:
-------------------------------------

I like that this does not use anything more than the client API to check the server.  That keeps the server core lean and mean.  The use of RPC's effectively restricts the impact of the scan on the FS.

A datanode operation that streams through a block without transferring it over the wire won't correctly check checksums using our existing mechanism.  To check file content we could instead simply implement a map-reduce job that streams through all the files in the fs.  This would not take much code: nothing additional in the core.  MapReduce should handle the locality, so that most data shouldn't go over the wire.

BTW, blocks not used by any file are not known to the name node, are they?  When they're reported by a datanode the datanode is told to remove them.


> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 01:21:29 2006
Return-Path: 
 <hadoop-dev-return-524-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 60085 invoked from network); 24 Mar 2006 01:21:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 01:21:29 -0000
Received: (qmail 67667 invoked by uid 500); 24 Mar 2006 01:21:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67582 invoked by uid 500); 24 Mar 2006 01:21:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67573 invoked by uid 99); 24 Mar 2006 01:21:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 17:21:29 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [63.203.238.114] (HELO dns.duboce.net) (63.203.238.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 17:21:27 -0800
Received: from [192.168.1.105] ([192.168.1.105])
	by dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k2O0AnZ31836;
	Thu, 23 Mar 2006 16:10:49 -0800
Message-ID: <44234989.7060906@archive.org>
Date: Thu, 23 Mar 2006 17:21:13 -0800
From: Michael Stack <stack@archive.org>
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US;
 rv:1.8.0.1) Gecko/20060127 SeaMonkey/1.0
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: io.skip.checksum.errors was: Re: Hung job
References: <4411D1E5.3080807@archive.org>
 <35108254-44A9-4526-940C-058A3371F216@media-style.com>
 <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
In-Reply-To: <22531D97-3A98-44FF-BFB8-1F69C2127D0E@media-style.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Stefan Groschupf wrote:
> Hi Stack,
> I tried that but sorry to say it does not solve the problem - also 
> with the very latest hadoop update to nutch.
Thanks for the pointer Stefan (I only just saw this -- over-zealous spam 
filters).

Yeah, the property 'io.skip.checksum.errors' is of no use to the 
HADOOP-86 issue.  'io.skip.checksum.errors' effects SequenceFile only. 
The ChecksumException was being thrown when we had a map output file 
view on the map product rather than a sequence file view.

But 'io.skip.checksum.errors' looks like a good idea for SequenceFile.  
In fact, I just had a job fail because of the below 
'java.io.IOException: Corrupt GZIP trailer'.  It happened 4 times in a 
row.  The 'io.skip.checksum.errors' should be generalized to allow 
skipping of the likes of this exception too it seems like.

St.Ack



060323 204819 task_r_ack5c7 0.9615162% reduce > reduce
060323 204820 task_r_3rjkd7  Error running child
060323 204820 task_r_3rjkd7 java.lang.RuntimeException: 
java.io.IOException: Corrupt GZIP trailer
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:132)
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.mapred.lib.IdentityReducer.reduce(IdentityReducer.java:41)
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:283)
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:703)
060323 204820 task_r_3rjkd7 Caused by: java.io.IOException: Corrupt GZIP 
trailer
060323 204820 task_r_3rjkd7     at 
java.util.zip.GZIPInputStream.readTrailer(GZIPInputStream.java:175)
060323 204820 task_r_3rjkd7     at 
java.util.zip.GZIPInputStream.read(GZIPInputStream.java:89)
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.io.WritableUtils.readCompressedByteArray(WritableUtils.java:35)
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.io.WritableUtils.readCompressedString(WritableUtils.java:70)
060323 204820 task_r_3rjkd7     at 
org.apache.nutch.parse.ParseText.readFields(ParseText.java:44)
060323 204820 task_r_3rjkd7     at 
org.apache.nutch.parse.ParseImpl.readFields(ParseImpl.java:59)
060323 204820 task_r_3rjkd7     at 
org.apache.nutch.parse.ParseImpl.read(ParseImpl.java:69)
060323 204820 task_r_3rjkd7     at 
org.apache.nutch.fetcher.FetcherOutput.readFields(FetcherOutput.java:47)
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:344)
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.mapred.ReduceTask$ValuesIterator.getNext(ReduceTask.java:163)
060323 204820 task_r_3rjkd7     at 
org.apache.hadoop.mapred.ReduceTask$ValuesIterator.next(ReduceTask.java:129)
060323 204820 task_r_3rjkd7     ... 3 more


>
> @Doug as far I understand the latest update already contains this 
> rollback "Reverted changes from 384385"?
>
> To summarize I'm not able to run just one larger hadoop job e.g. nutch 
> fetching never worked.
> Always one tasktracker hangs in the last 10 % of doing a reduce (some 
> times it arrived 98 % ) than the task runs into a time out and is 
> restarted again, fails, restarted, fails ...
> After 4 fails the task in progress crash the complete job.
>
> There is just nothing in the log files, that gives any hint also I 
> configured to ignore check sum exceptions.
>
> Any ideas where to search for the problem? It is very sad to throw a 
> fetched segment with several million documents just to trash,
>  since the last 3 % of reducing of one tasktracker fail.
>
> Thanks for any comments.
> Stefan
>
>
> Am 12.03.2006 um 03:33 schrieb Stefan Groschupf:
>
>> Hi Stack,
>>
>> try set the io.skip.checksum.errors to true in your hadoop-site.xml
>>
>> <property>
>>   <name>io.skip.checksum.errors</name>
>>   <value>false</value>
>>   <description>If true, when a checksum error is encountered while
>>   reading a sequence file, entries are skipped, instead of throwing an
>>   exception.</description>
>> </property>
>>
>> This may be solve your problem but I agree that there should be a 
>> smarter way than just ignoring it. :)
>>
>> Stefan
>>
>>
>> Am 10.03.2006 um 20:22 schrieb stack:
>>
>>> On hadoop-users, I've described two recent hangs.  I'm writing here 
>>> to dev because I'm looking for pointers on how best to conjure a fix 
>>> with perhaps pointers to any existing facility I might exploit (I do 
>>> not know the codebase well).
>>>
>>> In synopsis the problem goes as follows:
>>>
>>> If a reduce cannot pick up map outputs -- for example, the output 
>>> has been moved aside because of a ChecksumException (See below stack 
>>> trace) -- then the job gets stuck with the reduce task trying and 
>>> failing every ten seconds or so to pick up the non-existent map 
>>> output part.
>>>
>>> Somehow the reduce needs to give up and the jobtracker needs to 
>>> rerun the map just as it would if the tasktracker had died completely.
>>>
>>> Thanks in advance for any pointers,
>>> St.Ack
>>>
>>>
>>> 060309 014426 Moving bad file 
>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out to
>>> /0/bad_files/part-20.out.2002824050
>>> 060309 014426 Server handler 0 on 50040 caught:
>>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>> org.apache.hadoop.fs.ChecksumException: Checksum error:
>>> /0/hadoop/tmp/task_m_bq2g76/part-20.out at 2649600
>>>      at
>>> org.apache.hadoop.fs.FSDataInputStream$Checker.verifySum(FSDataInputStream.java:122) 
>>>
>>>      at
>>> org.apache.hadoop.fs.FSDataInputStream$Checker.read(FSDataInputStream.java:98) 
>>>
>>>      at
>>> org.apache.hadoop.fs.FSDataInputStream$PositionCache.read(FSDataInputStream.java:158) 
>>>
>>>      at java.io.BufferedInputStream.read1(BufferedInputStream.java:254)
>>>      at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
>>>      at java.io.DataInputStream.read(DataInputStream.java:80)
>>>      at 
>>> org.apache.hadoop.mapred.MapOutputFile.write(MapOutputFile.java:110)
>>>      at
>>> org.apache.hadoop.io.ObjectWritable.writeObject(ObjectWritable.java:117) 
>>>
>>>      at 
>>> org.apache.hadoop.io.ObjectWritable.write(ObjectWritable.java:64)
>>>      at org.apache.hadoop.ipc.Server$Handler.run(Server.java:215)
>>>
>>>
>>>
>>
>> ---------------------------------------------
>> blog: http://www.find23.org
>> company: http://www.media-style.com
>>
>>
>>
>
> ---------------------------------------------
> blog: http://www.find23.org
> company: http://www.media-style.com
>
>
>


From MAILER-DAEMON Fri Mar 24 02:04:41 2006
Return-Path: 
 <hadoop-dev-return-525-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74504 invoked from network); 24 Mar 2006 02:04:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 02:04:41 -0000
Received: (qmail 767 invoked by uid 500); 24 Mar 2006 02:04:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 748 invoked by uid 500); 24 Mar 2006 02:04:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 739 invoked by uid 99); 24 Mar 2006 02:04:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 18:04:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 18:04:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BA1B4D4A01
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 02:04:19 +0000 (GMT)
Message-ID: <699062040.1143165859759.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 02:04:19 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-102) Two identical consecutive loops in
 FSNamesystem.chooseTarget()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Two identical consecutive loops in FSNamesystem.chooseTarget()
--------------------------------------------------------------

         Key: HADOOP-102
         URL: http://issues.apache.org/jira/browse/HADOOP-102
     Project: Hadoop
        Type: Bug
    Reporter: Konstantin Shvachko
 Attachments: chooseTargets.patch

I think this was meant to be the way I corrected.
Otherwise there is no difference in two loops except for double
bracketing in the if statement.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 02:04:43 2006
Return-Path: 
 <hadoop-dev-return-526-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 74523 invoked from network); 24 Mar 2006 02:04:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 02:04:43 -0000
Received: (qmail 946 invoked by uid 500); 24 Mar 2006 02:04:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 845 invoked by uid 500); 24 Mar 2006 02:04:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 836 invoked by uid 99); 24 Mar 2006 02:04:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 18:04:42 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Mar 2006 18:04:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3F982D4A00
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 02:04:21 +0000 (GMT)
Message-ID: <820157825.1143165861258.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 02:04:21 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-102) Two identical consecutive loops in
 FSNamesystem.chooseTarget()
In-Reply-To: <699062040.1143165859759.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-102?page=all ]

Konstantin Shvachko updated HADOOP-102:
---------------------------------------

    Attachment: chooseTargets.patch

> Two identical consecutive loops in FSNamesystem.chooseTarget()
> --------------------------------------------------------------
>
>          Key: HADOOP-102
>          URL: http://issues.apache.org/jira/browse/HADOOP-102
>      Project: Hadoop
>         Type: Bug
>     Reporter: Konstantin Shvachko
>  Attachments: chooseTargets.patch
>
> I think this was meant to be the way I corrected.
> Otherwise there is no difference in two loops except for double
> bracketing in the if statement.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 09:14:56 2006
Return-Path: 
 <hadoop-dev-return-527-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85735 invoked from network); 24 Mar 2006 09:14:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 09:14:56 -0000
Received: (qmail 4050 invoked by uid 500); 24 Mar 2006 09:14:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 4027 invoked by uid 500); 24 Mar 2006 09:14:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 4018 invoked by uid 99); 24 Mar 2006 09:14:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 01:14:55 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 01:14:55 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 1259C6ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 09:14:34 +0000 (GMT)
Message-ID: <2046308502.1143191674045.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 09:14:34 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371689 ] 

Andrzej Bialecki  commented on HADOOP-101:
------------------------------------------

Wow, lots of comments, let me address some of them:

* re: locking. I also see this as an advantage, fsck can run in parallel with normal operations. If someone else deletes a file, no big deal - the name is removed from the namesystem, so if we suddenly detect missing blocks we could always check if a file with this name still exists in the namesystem.

* re: performance. Sure, we could parallelize this, which should speed things up (currently it's rather slow, checking ~1TB takes > 2 hours), but then it would put a higher load on the namenode. Perhaps we could make this an option, e.g. start a configurable pool of fsck threads in parallel.

* re: blocks not in use by any file. I think this is already handled internally by namenode<->datanode protocol (for good and for bad), i.e. namenode detects orphaned blocks and tells datanodes to remove them. See FSNamesystem:924 .

* handling the reverse situation (missing blocks in existing files) should be straightforward, with the use of /lost+found directory: for each corrupted file a directory would be created there, and remaining chains of consecutive blocks would be stored in that directory.

* re: checking blocks through streaming: +1, I like the concept, could you perhaps implement it? ;) Also, what happens if a mapred task tries to retrieve a missing/corrupted block? I think currently this hangs the task, due to a missing break in the while loop in DFSClient:354

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 10:42:51 2006
Return-Path: 
 <hadoop-dev-return-528-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30640 invoked from network); 24 Mar 2006 10:42:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 10:42:51 -0000
Received: (qmail 31029 invoked by uid 500); 24 Mar 2006 10:42:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31012 invoked by uid 500); 24 Mar 2006 10:42:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31003 invoked by uid 99); 24 Mar 2006 10:42:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 02:42:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 02:42:49 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3D3CA6ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 10:42:28 +0000 (GMT)
Message-ID: <1467773330.1143196948243.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 10:42:28 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-95) dfs validation
In-Reply-To: <20690330.1142645739705.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-95?page=all ]

Konstantin Shvachko updated HADOOP-95:
--------------------------------------

    Attachment: TestReadFS.java
                IOMapperAdapter.java
                AccumulatingReducer.java

This map-reduce test reads all blocks of all files, and detects which of them are missing or corrupted.
See HADOOP-101 discussion.


> dfs validation
> --------------
>
>          Key: HADOOP-95
>          URL: http://issues.apache.org/jira/browse/HADOOP-95
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Hairong Kuang
>  Attachments: AccumulatingReducer.java, IOMapperAdapter.java, TestReadFS.java
>
> Dfs needs a validation operation similiar to fsck, so that we get to know the files that are corrupted and which data blocks are missing.
> Dfs namenode also needs to log more specific information such as which block is replication or is deleted. So when something goes wrong, we have a clue what has happened.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 10:49:03 2006
Return-Path: 
 <hadoop-dev-return-529-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 33622 invoked from network); 24 Mar 2006 10:49:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 10:49:03 -0000
Received: (qmail 39003 invoked by uid 500); 24 Mar 2006 10:49:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38984 invoked by uid 500); 24 Mar 2006 10:49:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38974 invoked by uid 99); 24 Mar 2006 10:49:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 02:49:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 02:49:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A159ED4A00
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 10:48:41 +0000 (GMT)
Message-ID: <1259727660.1143197321658.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 10:48:41 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-95) dfs validation
In-Reply-To: <20690330.1142645739705.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-95?page=all ]

Konstantin Shvachko updated HADOOP-95:
--------------------------------------

    Attachment: TestDFSIO.java

Posting here a similar performance test, which is related to HADOOP-72
Just because these two tests have too much in common.
TestDFSIO measures performance of the cluster for reads and writes.

> dfs validation
> --------------
>
>          Key: HADOOP-95
>          URL: http://issues.apache.org/jira/browse/HADOOP-95
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Hairong Kuang
>  Attachments: AccumulatingReducer.java, IOMapperAdapter.java, TestDFSIO.java, TestReadFS.java
>
> Dfs needs a validation operation similiar to fsck, so that we get to know the files that are corrupted and which data blocks are missing.
> Dfs namenode also needs to log more specific information such as which block is replication or is deleted. So when something goes wrong, we have a clue what has happened.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 11:05:53 2006
Return-Path: 
 <hadoop-dev-return-530-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 40975 invoked from network); 24 Mar 2006 11:05:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 11:05:53 -0000
Received: (qmail 54351 invoked by uid 500); 24 Mar 2006 11:05:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54266 invoked by uid 500); 24 Mar 2006 11:05:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54246 invoked by uid 99); 24 Mar 2006 11:05:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 03:05:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 03:05:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0B78ED4A02
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 11:05:28 +0000 (GMT)
Message-ID: <1771390012.1143198328044.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 11:05:28 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371705 ] 

Konstantin Shvachko commented on HADOOP-101:
--------------------------------------------

Just posted a map-reduce test that checks all blocks of all files.
See HADOOP-95.
The infinite loop in DFSClient is fixed now, so it works.

With respect to some of the previous comments.
Restarting the cluster (a big one) just to check its consistency is not an exciting option.
This means that we will have to wait up to 55 minutes before missing blocks will
be detected by examining just the namenode data.

A drawback of the map-reduce test is that we cannot force the system to check all replicas 
of the block. So corrupted block is reported only if all of its replicas are bad.
But yes this is better than nothing.

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 11:24:53 2006
Return-Path: 
 <hadoop-dev-return-531-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 52864 invoked from network); 24 Mar 2006 11:24:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 11:24:53 -0000
Received: (qmail 93215 invoked by uid 500); 24 Mar 2006 11:24:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93191 invoked by uid 500); 24 Mar 2006 11:24:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93181 invoked by uid 99); 24 Mar 2006 11:24:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 03:24:52 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 03:24:51 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D3E106ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 11:24:30 +0000 (GMT)
Message-ID: <1749876086.1143199470858.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 11:24:30 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371707 ] 

Andrzej Bialecki  commented on HADOOP-101:
------------------------------------------

Regarding the restarting time - yes, but I couldn't find any other way to force datanodes to update their block reports with the namenode, perhaps we should extend BlockCommand to support this (the namenode can't call datanodes, it can just return BlockCommands when datanodes call in).

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 15:55:56 2006
Return-Path: 
 <hadoop-dev-return-532-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13232 invoked from network); 24 Mar 2006 15:55:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 15:55:56 -0000
Received: (qmail 56089 invoked by uid 500); 24 Mar 2006 15:55:38 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56068 invoked by uid 500); 24 Mar 2006 15:55:38 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56058 invoked by uid 99); 24 Mar 2006 15:55:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 07:55:38 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 07:55:37 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B5B75D4A00
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 15:55:16 +0000 (GMT)
Message-ID: <65457364.1143215716741.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 15:55:16 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-101) DFSck - fsck-like utility for checking
 DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-101?page=all ]

Andrzej Bialecki  updated HADOOP-101:
-------------------------------------

    Attachment: DFSck.java

Updated version. Added options to treat inconsistencies: ignore, move to /lost+found, delete.

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 15:55:56 2006
Return-Path: 
 <hadoop-dev-return-533-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13234 invoked from network); 24 Mar 2006 15:55:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 15:55:56 -0000
Received: (qmail 56189 invoked by uid 500); 24 Mar 2006 15:55:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 56172 invoked by uid 500); 24 Mar 2006 15:55:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 56163 invoked by uid 99); 24 Mar 2006 15:55:39 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 07:55:39 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 07:55:38 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BF5CDD4A02
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 15:55:17 +0000 (GMT)
Message-ID: <1219323864.1143215717780.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 15:55:17 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-101) DFSck - fsck-like utility for checking
 DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-101?page=all ]

Andrzej Bialecki  updated HADOOP-101:
-------------------------------------

    Attachment:     (was: DFSck.java)

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 17:02:49 2006
Return-Path: 
 <hadoop-dev-return-534-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51432 invoked from network); 24 Mar 2006 17:02:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 17:02:49 -0000
Received: (qmail 25954 invoked by uid 500); 24 Mar 2006 17:02:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 25939 invoked by uid 500); 24 Mar 2006 17:02:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 25930 invoked by uid 99); 24 Mar 2006 17:02:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 09:02:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 09:02:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DED7F6ACAA
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 17:02:26 +0000 (GMT)
Message-ID: <435181568.1143219746909.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 17:02:26 +0000 (GMT)
From: "chris (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371761 ] 

chris commented on HADOOP-52:
-----------------------------

Sorry
but It seems this code will thown IOException in windows cygwin env......

it can't get file path correctly.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch, cwd3.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 17:16:18 2006
Return-Path: 
 <hadoop-dev-return-535-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57539 invoked from network); 24 Mar 2006 17:16:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 17:16:18 -0000
Received: (qmail 63221 invoked by uid 500); 24 Mar 2006 17:16:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63202 invoked by uid 500); 24 Mar 2006 17:16:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63193 invoked by uid 99); 24 Mar 2006 17:16:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 09:16:17 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 09:16:16 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E44726ACAA
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 17:15:55 +0000 (GMT)
Message-ID: <1146349435.1143220555932.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 17:15:55 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371765 ] 

Owen O'Malley commented on HADOOP-52:
-------------------------------------

Can you please include the text from the exception and the stack trace? Depending on where the exception was thrown, it might be in the server log files.

> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch, cwd3.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:22:58 2006
Return-Path: 
 <hadoop-dev-return-536-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16688 invoked from network); 24 Mar 2006 21:22:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:22:58 -0000
Received: (qmail 88738 invoked by uid 500); 24 Mar 2006 21:22:57 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88713 invoked by uid 500); 24 Mar 2006 21:22:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88704 invoked by uid 99); 24 Mar 2006 21:22:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:22:57 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:22:56 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D86E66ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:22:35 +0000 (GMT)
Message-ID: <2015099393.1143235355875.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:22:35 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-19) Datanode corruption
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-19?page=all ]

Sameer Paranjpye reassigned HADOOP-19:
--------------------------------------

    Assign To: Doug Cutting

> Datanode corruption
> -------------------
>
>          Key: HADOOP-19
>          URL: http://issues.apache.org/jira/browse/HADOOP-19
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Rod Taylor
>     Assignee: Doug Cutting
>     Priority: Critical
>      Fix For: 0.1

>
> Our admins accidentally started a second nutch datanode pointing to the same directories as one already running (same machine) which in turn caused the entire contents of the datanode to go disappear.
> This happened because the blocking was based on the username (since fixed in our start scripts) and it was started as two different users.
> The ndfs.name.dir and ndfs.data.dir directories were both completely devoid of content, where they had about 150GB not all that much earlier.
> I think the solution is improved interlocking within the data directory itself (file locked with flock or something similar).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:24:46 2006
Return-Path: 
 <hadoop-dev-return-537-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19435 invoked from network); 24 Mar 2006 21:24:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:24:46 -0000
Received: (qmail 90192 invoked by uid 500); 24 Mar 2006 21:24:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90175 invoked by uid 500); 24 Mar 2006 21:24:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90166 invoked by uid 99); 24 Mar 2006 21:24:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:24:45 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:24:45 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 589B76ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:24:24 +0000 (GMT)
Message-ID: <221697432.1143235464360.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:24:24 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-19) Datanode corruption
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-19?page=all ]

Sameer Paranjpye updated HADOOP-19:
-----------------------------------

    Fix Version: 0.1
        Version: 0.1

> Datanode corruption
> -------------------
>
>          Key: HADOOP-19
>          URL: http://issues.apache.org/jira/browse/HADOOP-19
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Rod Taylor
>     Assignee: Doug Cutting
>     Priority: Critical
>      Fix For: 0.1

>
> Our admins accidentally started a second nutch datanode pointing to the same directories as one already running (same machine) which in turn caused the entire contents of the datanode to go disappear.
> This happened because the blocking was based on the username (since fixed in our start scripts) and it was started as two different users.
> The ndfs.name.dir and ndfs.data.dir directories were both completely devoid of content, where they had about 150GB not all that much earlier.
> I think the solution is improved interlocking within the data directory itself (file locked with flock or something similar).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:30:44 2006
Return-Path: 
 <hadoop-dev-return-538-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 22045 invoked from network); 24 Mar 2006 21:30:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:30:44 -0000
Received: (qmail 95765 invoked by uid 500); 24 Mar 2006 21:30:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 95744 invoked by uid 500); 24 Mar 2006 21:30:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 95735 invoked by uid 99); 24 Mar 2006 21:30:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:30:44 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:30:43 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B40E46ACAA
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:30:22 +0000 (GMT)
Message-ID: <334450397.1143235822733.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:30:22 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-84) client should report file name in
 which IO exception occurs
In-Reply-To: <555225226.1142449324055.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-84?page=all ]

Sameer Paranjpye reassigned HADOOP-84:
--------------------------------------

    Assign To: Konstantin Shvachko

> client should report file name in which IO exception occurs
> -----------------------------------------------------------
>
>          Key: HADOOP-84
>          URL: http://issues.apache.org/jira/browse/HADOOP-84
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>     Priority: Minor

>
> A file in the DFS got corrupted somehow.
> The client gets an exception accessing a block in the file:
> 060315 105907 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105917 No node available for block blk_2690692619196463439
> It could (and should) report the file in which the error occurred, together with the block information.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:33:52 2006
Return-Path: 
 <hadoop-dev-return-540-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23418 invoked from network); 24 Mar 2006 21:33:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:33:52 -0000
Received: (qmail 98150 invoked by uid 500); 24 Mar 2006 21:33:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98133 invoked by uid 500); 24 Mar 2006 21:33:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98124 invoked by uid 99); 24 Mar 2006 21:33:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:33:50 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:33:49 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id D7DCCD4A03
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:33:28 +0000 (GMT)
Message-ID: <751454701.1143236008881.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:33:28 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-35) Files missing chunks can cause mapred
 runs to get stuck
In-Reply-To: <91087355.1139855443862.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-35?page=all ]
     
Sameer Paranjpye resolved HADOOP-35:
------------------------------------

    Resolution: Duplicate

Duplicate of HADOOP-83

> Files missing chunks can cause mapred runs to get stuck
> -------------------------------------------------------
>
>          Key: HADOOP-35
>          URL: http://issues.apache.org/jira/browse/HADOOP-35
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>  Environment: ~20 datanode DFS cluster
>     Reporter: Bryan Pendleton
>      Fix For: 0.1
>  Attachments: dfsshell.health.patch.txt
>
> I've now several times run into a problem where a large run gets stalled as a result of a missing data block. The latest was a stall in the Summer - ie, the data might've all been there, but it was impossible to proceed because the CRC file was missing a block. It would be nice to:
> 1) Have a "health check" running on a map reduce. If any data isn't available, emmit periodic warnings, and maybe have a timeout for if the data never comes back. Such warnings *should* specify which file(s) are affected by the missing blocks.
> 2) Have a utility, possible part of the existing dfs utility, which can check for dfs files with unlocatable blocks. Possibly, even show a 'health' of a file - ie, what percentage of its blocks are currently at the desired replication level. Currently, there's no way that I know of to find out if a file in DFS is going to be unreadable.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:33:52 2006
Return-Path: 
 <hadoop-dev-return-539-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 23416 invoked from network); 24 Mar 2006 21:33:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:33:52 -0000
Received: (qmail 98050 invoked by uid 500); 24 Mar 2006 21:33:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98032 invoked by uid 500); 24 Mar 2006 21:33:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98023 invoked by uid 99); 24 Mar 2006 21:33:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:33:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:33:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 16731D4A01
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:33:28 +0000 (GMT)
Message-ID: <1896689362.1143236008089.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:33:28 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-35) Files missing chunks can cause mapred
 runs to get stuck
In-Reply-To: <91087355.1139855443862.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-35?page=all ]

Sameer Paranjpye updated HADOOP-35:
-----------------------------------

    Fix Version: 0.1
        Version: 0.1

> Files missing chunks can cause mapred runs to get stuck
> -------------------------------------------------------
>
>          Key: HADOOP-35
>          URL: http://issues.apache.org/jira/browse/HADOOP-35
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>  Environment: ~20 datanode DFS cluster
>     Reporter: Bryan Pendleton
>      Fix For: 0.1
>  Attachments: dfsshell.health.patch.txt
>
> I've now several times run into a problem where a large run gets stalled as a result of a missing data block. The latest was a stall in the Summer - ie, the data might've all been there, but it was impossible to proceed because the CRC file was missing a block. It would be nice to:
> 1) Have a "health check" running on a map reduce. If any data isn't available, emmit periodic warnings, and maybe have a timeout for if the data never comes back. Such warnings *should* specify which file(s) are affected by the missing blocks.
> 2) Have a utility, possible part of the existing dfs utility, which can check for dfs files with unlocatable blocks. Possibly, even show a 'health' of a file - ie, what percentage of its blocks are currently at the desired replication level. Currently, there's no way that I know of to find out if a file in DFS is going to be unreadable.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:35:57 2006
Return-Path: 
 <hadoop-dev-return-541-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 25326 invoked from network); 24 Mar 2006 21:35:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:35:57 -0000
Received: (qmail 3567 invoked by uid 500); 24 Mar 2006 21:35:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 3511 invoked by uid 500); 24 Mar 2006 21:35:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 3491 invoked by uid 99); 24 Mar 2006 21:35:56 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:35:56 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:35:55 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BB0DFD49FC
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:35:34 +0000 (GMT)
Message-ID: <1462795493.1143236134763.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:35:34 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-73) bin/hadoop dfs -rm works only for
 absolute paths
In-Reply-To: <161615899.1141948076933.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-73?page=all ]
     
Sameer Paranjpye resolved HADOOP-73:
------------------------------------

    Fix Version: 0.1
     Resolution: Cannot Reproduce

> bin/hadoop dfs -rm works only for absolute paths
> ------------------------------------------------
>
>          Key: HADOOP-73
>          URL: http://issues.apache.org/jira/browse/HADOOP-73
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Stefan Groschupf
>     Priority: Trivial
>      Fix For: 0.1

>
> every dfs command like -du works with relative paths but remove only works only for absolute paths. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:37:44 2006
Return-Path: 
 <hadoop-dev-return-542-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26317 invoked from network); 24 Mar 2006 21:37:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:37:44 -0000
Received: (qmail 7676 invoked by uid 500); 24 Mar 2006 21:37:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7636 invoked by uid 500); 24 Mar 2006 21:37:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7612 invoked by uid 99); 24 Mar 2006 21:37:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:37:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:37:41 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 452C06ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:37:20 +0000 (GMT)
Message-ID: <2124937965.1143236240273.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:37:20 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-73) bin/hadoop dfs -rm works only for
 absolute paths
In-Reply-To: <161615899.1141948076933.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-73?page=all ]

Sameer Paranjpye reassigned HADOOP-73:
--------------------------------------

    Assign To: Sameer Paranjpye

> bin/hadoop dfs -rm works only for absolute paths
> ------------------------------------------------
>
>          Key: HADOOP-73
>          URL: http://issues.apache.org/jira/browse/HADOOP-73
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Stefan Groschupf
>     Assignee: Sameer Paranjpye
>     Priority: Trivial
>      Fix For: 0.1

>
> every dfs command like -du works with relative paths but remove only works only for absolute paths. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:39:41 2006
Return-Path: 
 <hadoop-dev-return-543-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27263 invoked from network); 24 Mar 2006 21:39:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:39:41 -0000
Received: (qmail 10276 invoked by uid 500); 24 Mar 2006 21:39:40 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10259 invoked by uid 500); 24 Mar 2006 21:39:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10250 invoked by uid 99); 24 Mar 2006 21:39:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:39:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:39:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 5191A6ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:39:19 +0000 (GMT)
Message-ID: <1999999109.1143236359331.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:39:19 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-56) hadoop nameserver does not recognise
 ndfs nameserver image
In-Reply-To: <1295923568.1140660845840.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-56?page=all ]

Sameer Paranjpye updated HADOOP-56:
-----------------------------------

    Assign To: Sameer Paranjpye

> hadoop nameserver does not recognise ndfs nameserver image
> ----------------------------------------------------------
>
>          Key: HADOOP-56
>          URL: http://issues.apache.org/jira/browse/HADOOP-56
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>     Priority: Critical
>      Fix For: 0.1
>  Attachments: ndfs.tar.gz
>
> hadoop nameserver does not recognise ndfs image
> Thus, upgrading from ndfs to hadoop dfs results in total data loss.
> The upgrade should be seemless, with the new server recognising all previous version that are not end-of-life'd.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:39:43 2006
Return-Path: 
 <hadoop-dev-return-544-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27293 invoked from network); 24 Mar 2006 21:39:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:39:43 -0000
Received: (qmail 10376 invoked by uid 500); 24 Mar 2006 21:39:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10360 invoked by uid 500); 24 Mar 2006 21:39:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10351 invoked by uid 99); 24 Mar 2006 21:39:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:39:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:39:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 94BAA6ACAA
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:39:21 +0000 (GMT)
Message-ID: <275719607.1143236361606.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:39:21 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-56) hadoop nameserver does not recognise
 ndfs nameserver image
In-Reply-To: <1295923568.1140660845840.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-56?page=all ]
     
Sameer Paranjpye resolved HADOOP-56:
------------------------------------

    Fix Version: 0.1
     Resolution: Duplicate

Duplicated by HADOOP-19

> hadoop nameserver does not recognise ndfs nameserver image
> ----------------------------------------------------------
>
>          Key: HADOOP-56
>          URL: http://issues.apache.org/jira/browse/HADOOP-56
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Sameer Paranjpye
>     Priority: Critical
>      Fix For: 0.1
>  Attachments: ndfs.tar.gz
>
> hadoop nameserver does not recognise ndfs image
> Thus, upgrading from ndfs to hadoop dfs results in total data loss.
> The upgrade should be seemless, with the new server recognising all previous version that are not end-of-life'd.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:39:45 2006
Return-Path: 
 <hadoop-dev-return-545-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 27321 invoked from network); 24 Mar 2006 21:39:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:39:45 -0000
Received: (qmail 10492 invoked by uid 500); 24 Mar 2006 21:39:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10473 invoked by uid 500); 24 Mar 2006 21:39:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10464 invoked by uid 99); 24 Mar 2006 21:39:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:39:44 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:39:43 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C3AF3D4A00
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:39:22 +0000 (GMT)
Message-ID: <115498575.1143236362798.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:39:22 +0000 (GMT)
From: "Hairong Kuang (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371806 ] 

Hairong Kuang commented on HADOOP-101:
--------------------------------------

Andrzei, for your benchmark experiment (~1TB takes > 2 hours), how many directories and files were there in your dfs? For the performance of your dfsck, I think the number of files and dirs matters rather than the size of the data in dfs.

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:53:09 2006
Return-Path: 
 <hadoop-dev-return-546-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34294 invoked from network); 24 Mar 2006 21:53:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:53:09 -0000
Received: (qmail 30956 invoked by uid 500); 24 Mar 2006 21:53:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 30936 invoked by uid 500); 24 Mar 2006 21:53:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30927 invoked by uid 99); 24 Mar 2006 21:53:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:53:08 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:53:07 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E9E546ACAA
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:52:46 +0000 (GMT)
Message-ID: <352388697.1143237166955.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:52:46 +0000 (GMT)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-67) Added statistic/reporting info to DFS
In-Reply-To: <1955843292.1141769936628.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-67?page=all ]

Doug Cutting updated HADOOP-67:
-------------------------------

    Fix Version: 0.1
        Version: 0.1
      Assign To: Doug Cutting

> Added statistic/reporting info to DFS
> -------------------------------------
>
>          Key: HADOOP-67
>          URL: http://issues.apache.org/jira/browse/HADOOP-67
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>  Environment: n/a
>     Reporter: Barry Kaplan
>     Assignee: Doug Cutting
>     Priority: Trivial
>      Fix For: 0.1
>  Attachments: dfsPatch.txt
>
> The DatanodInfo, DFSFileInfo, and DFSClient were recently changed to package level protection, this hampers the ability to get some useful reporting data that can be used for DataNode and DFS health/performance.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:57:12 2006
Return-Path: 
 <hadoop-dev-return-547-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36601 invoked from network); 24 Mar 2006 21:57:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:57:12 -0000
Received: (qmail 36649 invoked by uid 500); 24 Mar 2006 21:57:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36634 invoked by uid 500); 24 Mar 2006 21:57:12 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36625 invoked by uid 99); 24 Mar 2006 21:57:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:57:12 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:57:11 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CDF5DD4A00
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:56:50 +0000 (GMT)
Message-ID: <975808975.1143237410840.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:56:50 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-75) dfs should check full file availability
 only at close
In-Reply-To: <873621841.1142030138809.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-75?page=all ]

Sameer Paranjpye updated HADOOP-75:
-----------------------------------

    Fix Version: 0.2
                     (was: 0.1)
        Version: 0.2
                     (was: 0.1)

> dfs should check full file availability only at close
> -----------------------------------------------------
>
>          Key: HADOOP-75
>          URL: http://issues.apache.org/jira/browse/HADOOP-75
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.2

>
> Currently it appears that dfs checks that the namenode knows about all blocks in a file as each block is written.  It would be more efficient to only check that all blocks are stored somewhere when the file is closed.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:57:14 2006
Return-Path: 
 <hadoop-dev-return-548-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 36617 invoked from network); 24 Mar 2006 21:57:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:57:14 -0000
Received: (qmail 36750 invoked by uid 500); 24 Mar 2006 21:57:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36732 invoked by uid 500); 24 Mar 2006 21:57:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36723 invoked by uid 99); 24 Mar 2006 21:57:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:57:13 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:57:12 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0C422D49FC
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:56:52 +0000 (GMT)
Message-ID: <2048478087.1143237412047.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:56:52 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-51) per-file replication counts
In-Reply-To: <1529480135.1140561049677.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-51?page=all ]

Sameer Paranjpye updated HADOOP-51:
-----------------------------------

    Fix Version: 0.2
                     (was: 0.1)
        Version: 0.2
                     (was: 0.1)

> per-file replication counts
> ---------------------------
>
>          Key: HADOOP-51
>          URL: http://issues.apache.org/jira/browse/HADOOP-51
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2

>
> It should be possible to specify different replication counts for different files.  Perhaps an option when creating a new file should be the desired replication count.  MapReduce should take advantage of this feature so that job.xml and job.jar files, which are frequently accessed by lots of machines, are more highly replicated than large data files.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:58:44 2006
Return-Path: 
 <hadoop-dev-return-549-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37222 invoked from network); 24 Mar 2006 21:58:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:58:44 -0000
Received: (qmail 38474 invoked by uid 500); 24 Mar 2006 21:58:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38383 invoked by uid 500); 24 Mar 2006 21:58:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38374 invoked by uid 99); 24 Mar 2006 21:58:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:58:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:58:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E1D72D4A02
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:58:21 +0000 (GMT)
Message-ID: <403831748.1143237501922.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:58:21 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-101?page=comments#action_12371808 ] 

Andrzej Bialecki  commented on HADOOP-101:
------------------------------------------

There were around 40,000 directories, and 200,000 files.

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 21:58:44 2006
Return-Path: 
 <hadoop-dev-return-550-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 37221 invoked from network); 24 Mar 2006 21:58:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 21:58:44 -0000
Received: (qmail 38557 invoked by uid 500); 24 Mar 2006 21:58:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 38481 invoked by uid 500); 24 Mar 2006 21:58:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 38384 invoked by uid 99); 24 Mar 2006 21:58:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:58:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 13:58:43 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 5296DD4A03
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 21:58:22 +0000 (GMT)
Message-ID: <1774581611.1143237502335.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 21:58:22 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-50) dfs datanode should store blocks in
 multiple directories
In-Reply-To: <133992549.1140560804844.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-50?page=all ]

Sameer Paranjpye updated HADOOP-50:
-----------------------------------

    Fix Version: 0.2
                     (was: 0.1)
        Version: 0.2
                     (was: 0.1)

> dfs datanode should store blocks in multiple directories
> --------------------------------------------------------
>
>          Key: HADOOP-50
>          URL: http://issues.apache.org/jira/browse/HADOOP-50
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Mike Cafarella
>      Fix For: 0.2

>
> The datanode currently stores all file blocks in a single directory.  With 32MB blocks and terabyte filesystems, this will create too many files in a single directory for many filesystems.  Thus blocks should be stored in multiple directories, perhaps even a shallow hierarchy.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 22:07:49 2006
Return-Path: 
 <hadoop-dev-return-551-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57531 invoked from network); 24 Mar 2006 22:07:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 22:07:49 -0000
Received: (qmail 63423 invoked by uid 500); 24 Mar 2006 22:07:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 63388 invoked by uid 500); 24 Mar 2006 22:07:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 63361 invoked by uid 99); 24 Mar 2006 22:07:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:07:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:07:43 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 834A1D49FC
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 22:07:22 +0000 (GMT)
Message-ID: <1231518716.1143238042535.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 22:07:22 +0000 (GMT)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-103) introduce a common parent class for
 Mapper and Reducer
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

introduce a common parent class for Mapper and Reducer
------------------------------------------------------

         Key: HADOOP-103
         URL: http://issues.apache.org/jira/browse/HADOOP-103
     Project: Hadoop
        Type: Improvement
  Components: mapred  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 
    Priority: Minor
     Fix For: 0.1


I'd like to a base class that implements the default (empty) bodies for configure and close so that Mapper and Reducer classes that derive from it, which is optional, don't have to implement those methods.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 22:16:32 2006
Return-Path: 
 <hadoop-dev-return-552-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81441 invoked from network); 24 Mar 2006 22:16:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 22:16:32 -0000
Received: (qmail 78042 invoked by uid 500); 24 Mar 2006 22:16:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78012 invoked by uid 500); 24 Mar 2006 22:16:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77868 invoked by uid 99); 24 Mar 2006 22:16:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:16:26 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:16:25 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 00506D4A02
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 22:16:05 +0000 (GMT)
Message-ID: <2125592377.1143238564998.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 22:16:04 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-74) hash blocks into dfs.data.dirs
In-Reply-To: <2139698490.1142030034444.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-74?page=all ]

Sameer Paranjpye updated HADOOP-74:
-----------------------------------

    Fix Version: 0.2
                     (was: 0.1)
        Version: 0.2
                     (was: 0.1)

> hash blocks into dfs.data.dirs
> ------------------------------
>
>          Key: HADOOP-74
>          URL: http://issues.apache.org/jira/browse/HADOOP-74
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.2
>  Environment: large clusters
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2

>
> When dfs.data.dir has multiple values, we currently start a DataNode for each (all in the same JVM).  Instead we should run a single DataNode that stores block files into the different directories.  This will reduce the number of connections to the namenode.  We cannot hash because different devices might be different amounts full.  So the datanode will need to keep a table mapping from block id to file location, and add new blocks to less full devices.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 22:19:44 2006
Return-Path: 
 <hadoop-dev-return-553-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97716 invoked from network); 24 Mar 2006 22:19:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 22:19:44 -0000
Received: (qmail 80851 invoked by uid 500); 24 Mar 2006 22:19:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80833 invoked by uid 500); 24 Mar 2006 22:19:44 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80821 invoked by uid 99); 24 Mar 2006 22:19:44 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:19:44 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:19:43 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9FCB26ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 22:19:22 +0000 (GMT)
Message-ID: <1791197267.1143238762644.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 22:19:22 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-74) hash blocks into dfs.data.dirs
In-Reply-To: <2139698490.1142030034444.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-74?page=all ]
     
Sameer Paranjpye resolved HADOOP-74:
------------------------------------

    Resolution: Duplicate

> hash blocks into dfs.data.dirs
> ------------------------------
>
>          Key: HADOOP-74
>          URL: http://issues.apache.org/jira/browse/HADOOP-74
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.2
>  Environment: large clusters
>     Reporter: Doug Cutting
>     Assignee: Konstantin Shvachko
>      Fix For: 0.2

>
> When dfs.data.dir has multiple values, we currently start a DataNode for each (all in the same JVM).  Instead we should run a single DataNode that stores block files into the different directories.  This will reduce the number of connections to the namenode.  We cannot hash because different devices might be different amounts full.  So the datanode will need to keep a table mapping from block id to file location, and add new blocks to less full devices.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 22:22:17 2006
Return-Path: 
 <hadoop-dev-return-554-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16205 invoked from network); 24 Mar 2006 22:22:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 22:22:17 -0000
Received: (qmail 84964 invoked by uid 500); 24 Mar 2006 22:22:16 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84944 invoked by uid 500); 24 Mar 2006 22:22:16 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84935 invoked by uid 99); 24 Mar 2006 22:22:16 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:22:16 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:22:16 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 269D3D49FC
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 22:21:55 +0000 (GMT)
Message-ID: <992522086.1143238915155.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 22:21:55 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-47) include records/second and bytes/second
 in  task reports
In-Reply-To: <579254540.1140560374384.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-47?page=all ]

Sameer Paranjpye updated HADOOP-47:
-----------------------------------

    Fix Version: 0.2
                     (was: 0.1)
        Version: 0.2
                     (was: 0.1)

> include records/second and bytes/second in  task reports
> --------------------------------------------------------
>
>          Key: HADOOP-47
>          URL: http://issues.apache.org/jira/browse/HADOOP-47
>      Project: Hadoop
>         Type: New Feature
>   Components: mapred
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.2

>
> TaskReport should include fields for total records processed, total bytes processed and total seconds of task execution.  These should also be reported in the web ui, as bytes/second and records/second.  The job display could sum these to report total bytes/second and records/second for map and reduce.  Better yet would be a graph displaying the total rates over the course of the job...

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 22:27:57 2006
Return-Path: 
 <hadoop-dev-return-555-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42420 invoked from network); 24 Mar 2006 22:27:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 22:27:57 -0000
Received: (qmail 92216 invoked by uid 500); 24 Mar 2006 22:27:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92198 invoked by uid 500); 24 Mar 2006 22:27:56 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92085 invoked by uid 99); 24 Mar 2006 22:27:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:27:55 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:27:55 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2DA056ACAC
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 22:27:34 +0000 (GMT)
Message-ID: <363866833.1143239254184.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 22:27:34 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-59) support generic command-line options
In-Reply-To: <321463887.1140733957324.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-59?page=all ]

Sameer Paranjpye updated HADOOP-59:
-----------------------------------

    Fix Version: 0.2
                     (was: 0.1)
        Version: 0.2
                     (was: 0.1)

> support generic command-line options
> ------------------------------------
>
>          Key: HADOOP-59
>          URL: http://issues.apache.org/jira/browse/HADOOP-59
>      Project: Hadoop
>         Type: Improvement
>   Components: conf
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Michel Tourn
>      Fix For: 0.2
>  Attachments: Tool.java, ToolBase.java, bashfile.patch, toolbase.patch
>
> Hadoop commands should all support some common options.  For example, it should be possible to specify the namenode, datanode, and, for that matter, any config option, in a generic way.
> This could be implemented with code like:
> public interface Tool extends Configurable {
>   void run(String[] args) throws Exception;
> }
> public class ToolBase implements Tool extends Configured {
>   public final void main(String[] args) throws Exception {
>     Configuration conf = new Configuration();
>     ... parse config options from args into conf ...
>     this.configure(conf);
>     this.run();
>   }
> }
> public MyTool extends ExcecutableBase {
>   public static void main(String[] args) throws Exception {
>     new MyTool().main(args);
>   }
> }
> The general command line syntax could be:
> bin/hadoop [generalOptions] command [commandOptions]
> Where generalOptions are things that ToolBase handles, and only the commandOptions are passed to Tool.run().  The most important generalOption would be '-D', which would define name/value pairs that are set in the configuration.  This alone would permit folks to set the namenode, datanode, etc.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 22:50:52 2006
Return-Path: 
 <hadoop-dev-return-556-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69482 invoked from network); 24 Mar 2006 22:50:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 22:50:52 -0000
Received: (qmail 12462 invoked by uid 500); 24 Mar 2006 22:50:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12343 invoked by uid 500); 24 Mar 2006 22:50:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12318 invoked by uid 99); 24 Mar 2006 22:50:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:50:42 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:50:41 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 40EB0D4A00
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 22:50:20 +0000 (GMT)
Message-ID: <1570310083.1143240620262.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 22:50:20 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Sameer Paranjpye reassigned HADOOP-33:
--------------------------------------

    Assign To: Konstantin Shvachko

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: DF.java, DF.patch, DF2.patch, DF3.patch, DF4.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 22:50:52 2006
Return-Path: 
 <hadoop-dev-return-557-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69450 invoked from network); 24 Mar 2006 22:50:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 22:50:52 -0000
Received: (qmail 12529 invoked by uid 500); 24 Mar 2006 22:50:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 12430 invoked by uid 500); 24 Mar 2006 22:50:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 12371 invoked by uid 99); 24 Mar 2006 22:50:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:50:42 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 14:50:41 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0F718D49FC
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 22:50:21 +0000 (GMT)
Message-ID: <121281330.1143240621060.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 22:50:21 +0000 (GMT)
From: "Sameer Paranjpye (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Sameer Paranjpye updated HADOOP-33:
-----------------------------------

    Fix Version: 0.1
        Version: 0.1

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: DF.java, DF.patch, DF2.patch, DF3.patch, DF4.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 23:07:41 2006
Return-Path: 
 <hadoop-dev-return-558-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76141 invoked from network); 24 Mar 2006 23:07:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 23:07:41 -0000
Received: (qmail 32018 invoked by uid 500); 24 Mar 2006 23:07:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31932 invoked by uid 500); 24 Mar 2006 23:07:40 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31911 invoked by uid 99); 24 Mar 2006 23:07:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 15:07:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 15:07:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4F5066ACA9
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 23:07:19 +0000 (GMT)
Message-ID: <1783007685.1143241639315.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 23:07:19 +0000 (GMT)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-104) Reflexive access to non-public class
 with public ctor requires setAccessible (with some JVMs)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Reflexive access to non-public class with public ctor requires setAccessible (with some JVMs)
---------------------------------------------------------------------------------------------

         Key: HADOOP-104
         URL: http://issues.apache.org/jira/browse/HADOOP-104
     Project: Hadoop
        Type: Bug
    Reporter: Michel Tourn


Multiple times I have hit this problem which prevents the NameNode from starting.
The only fix I had so far was to loose all my DFS data...

Exception in thread "main" java.lang.RuntimeException: java.lang.IllegalAccessException: 
Class org.apache.hadoop.io.WritableFactories can not access a member of 
class org.apache.hadoop.dfs.Block with modifiers "public"
        at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
        at org.apache.hadoop.io.ArrayWritable.readFields(ArrayWritable.java:81)
        at org.apache.hadoop.dfs.FSDirectory.loadFSEdits(FSDirectory.java:374)
        at org.apache.hadoop.dfs.FSDirectory.loadFSImage(FSDirectory.java:347)
        at org.apache.hadoop.dfs.FSDirectory.<init>(FSDirectory.java:258)
        at org.apache.hadoop.dfs.FSNamesystem.<init>(FSNamesystem.java:151)
        at org.apache.hadoop.dfs.NameNode.<init>(NameNode.java:82)


According to this, 
http://forum.java.sun.com/thread.jspa?threadID=704100&messageID=4082902
this is a known issue when using
reflexive access to a non-public class with public ctor 
(class org.apache.hadoop.dfs.Block is such a class)

This problem may not occur with all JVM releases. 
(I build on 1.5.0-b64 and run on 1.5.0_05-b05)

This problem only occured for me when 
I upgrade code or change XML configuration AND 
have existing files in the DFS.
This problem does not occur when I just stop / restart the NameServer.

In any case, the attached patch fixes it by calling setAccessible
before constructing the instance with reflection.




-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 23:10:12 2006
Return-Path: 
 <hadoop-dev-return-559-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77122 invoked from network); 24 Mar 2006 23:10:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 23:10:12 -0000
Received: (qmail 33162 invoked by uid 500); 24 Mar 2006 23:10:12 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33135 invoked by uid 500); 24 Mar 2006 23:10:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 32900 invoked by uid 99); 24 Mar 2006 23:10:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 15:10:09 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 15:10:09 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 60B216ACAB
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 23:09:48 +0000 (GMT)
Message-ID: <1262388889.1143241788392.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 23:09:48 +0000 (GMT)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-104) Reflexive access to non-public class
 with public ctor requires setAccessible (with some JVMs)
In-Reply-To: <1783007685.1143241639315.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-104?page=all ]

Michel Tourn updated HADOOP-104:
--------------------------------

    Attachment: setaccessible.patch

> Reflexive access to non-public class with public ctor requires setAccessible (with some JVMs)
> ---------------------------------------------------------------------------------------------
>
>          Key: HADOOP-104
>          URL: http://issues.apache.org/jira/browse/HADOOP-104
>      Project: Hadoop
>         Type: Bug
>     Reporter: Michel Tourn
>  Attachments: setaccessible.patch
>
> Multiple times I have hit this problem which prevents the NameNode from starting.
> The only fix I had so far was to loose all my DFS data...
> Exception in thread "main" java.lang.RuntimeException: java.lang.IllegalAccessException: 
> Class org.apache.hadoop.io.WritableFactories can not access a member of 
> class org.apache.hadoop.dfs.Block with modifiers "public"
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
>         at org.apache.hadoop.io.ArrayWritable.readFields(ArrayWritable.java:81)
>         at org.apache.hadoop.dfs.FSDirectory.loadFSEdits(FSDirectory.java:374)
>         at org.apache.hadoop.dfs.FSDirectory.loadFSImage(FSDirectory.java:347)
>         at org.apache.hadoop.dfs.FSDirectory.<init>(FSDirectory.java:258)
>         at org.apache.hadoop.dfs.FSNamesystem.<init>(FSNamesystem.java:151)
>         at org.apache.hadoop.dfs.NameNode.<init>(NameNode.java:82)
> According to this, 
> http://forum.java.sun.com/thread.jspa?threadID=704100&messageID=4082902
> this is a known issue when using
> reflexive access to a non-public class with public ctor 
> (class org.apache.hadoop.dfs.Block is such a class)
> This problem may not occur with all JVM releases. 
> (I build on 1.5.0-b64 and run on 1.5.0_05-b05)
> This problem only occured for me when 
> I upgrade code or change XML configuration AND 
> have existing files in the DFS.
> This problem does not occur when I just stop / restart the NameServer.
> In any case, the attached patch fixes it by calling setAccessible
> before constructing the instance with reflection.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 24 23:32:13 2006
Return-Path: 
 <hadoop-dev-return-560-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88253 invoked from network); 24 Mar 2006 23:32:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 24 Mar 2006 23:32:13 -0000
Received: (qmail 48455 invoked by uid 500); 24 Mar 2006 23:32:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48439 invoked by uid 500); 24 Mar 2006 23:32:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48425 invoked by uid 99); 24 Mar 2006 23:32:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 15:32:11 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 15:32:10 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BEC936ACAA
	for <hadoop-dev@lucene.apache.org>; Fri, 24 Mar 2006 23:31:49 +0000 (GMT)
Message-ID: <377167766.1143243109778.JavaMail.jira@ajax>
Date: Fri, 24 Mar 2006 23:31:49 +0000 (GMT)
From: "Michel Tourn (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-104) Reflexive access to non-public class
 with public ctor requires setAccessible (with some JVMs)
In-Reply-To: <1783007685.1143241639315.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-104?page=comments#action_12371821 ] 

Michel Tourn commented on HADOOP-104:
-------------------------------------

class Block registers a factory in its static initializer.

So another thing which may occur here is:
class loading/initialization order is non-deterministic.

If class Block loads before this is called:
  WritableFactories.newInstance(Block.class)
then things work as expected, the Block factory is called.

Else 
WritableFactories does not find a registered factory for Block (yet),
tries to construct the instance reflectively,
and fails as explained in the bug.

In this case an alternate fix is to make sure that all
classes that have a factory method declared as a static initializer
are loaded before they are needed.


> Reflexive access to non-public class with public ctor requires setAccessible (with some JVMs)
> ---------------------------------------------------------------------------------------------
>
>          Key: HADOOP-104
>          URL: http://issues.apache.org/jira/browse/HADOOP-104
>      Project: Hadoop
>         Type: Bug
>     Reporter: Michel Tourn
>  Attachments: setaccessible.patch
>
> Multiple times I have hit this problem which prevents the NameNode from starting.
> The only fix I had so far was to loose all my DFS data...
> Exception in thread "main" java.lang.RuntimeException: java.lang.IllegalAccessException: 
> Class org.apache.hadoop.io.WritableFactories can not access a member of 
> class org.apache.hadoop.dfs.Block with modifiers "public"
>         at org.apache.hadoop.io.WritableFactories.newInstance(WritableFactories.java:49)
>         at org.apache.hadoop.io.ArrayWritable.readFields(ArrayWritable.java:81)
>         at org.apache.hadoop.dfs.FSDirectory.loadFSEdits(FSDirectory.java:374)
>         at org.apache.hadoop.dfs.FSDirectory.loadFSImage(FSDirectory.java:347)
>         at org.apache.hadoop.dfs.FSDirectory.<init>(FSDirectory.java:258)
>         at org.apache.hadoop.dfs.FSNamesystem.<init>(FSNamesystem.java:151)
>         at org.apache.hadoop.dfs.NameNode.<init>(NameNode.java:82)
> According to this, 
> http://forum.java.sun.com/thread.jspa?threadID=704100&messageID=4082902
> this is a known issue when using
> reflexive access to a non-public class with public ctor 
> (class org.apache.hadoop.dfs.Block is such a class)
> This problem may not occur with all JVM releases. 
> (I build on 1.5.0-b64 and run on 1.5.0_05-b05)
> This problem only occured for me when 
> I upgrade code or change XML configuration AND 
> have existing files in the DFS.
> This problem does not occur when I just stop / restart the NameServer.
> In any case, the attached patch fixes it by calling setAccessible
> before constructing the instance with reflection.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 00:04:36 2006
Return-Path: 
 <hadoop-dev-return-561-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1172 invoked from network); 25 Mar 2006 00:04:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 00:04:36 -0000
Received: (qmail 86123 invoked by uid 500); 25 Mar 2006 00:04:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 86038 invoked by uid 500); 25 Mar 2006 00:04:32 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 86029 invoked by uid 99); 25 Mar 2006 00:04:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 16:04:32 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 16:04:32 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 058EDD49FC
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 00:04:11 +0000 (GMT)
Message-ID: <2115505809.1143245051019.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 00:04:11 +0000 (GMT)
From: "chris (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-52) mapred input and output dirs must be
 absolute
In-Reply-To: <1415168910.1140561514361.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-52?page=comments#action_12371823 ] 

chris commented on HADOOP-52:
-----------------------------

I just update to the lately, start all the namenode, datanode, jobtracker and tasktracker

run nutch command (crawl / readdb etc.), and jobtracker thrown exception,


060325 001911 Property 'file.separator' is \
060325 001911 Property 'java.vendor.url.bug' is http://java.sun.com/cgi-bin/bugr
eport.cgi
060325 001911 Property 'sun.io.unicode.encoding' is UnicodeLittle
060325 001911 Property 'sun.cpu.endian' is little
060325 001911 Property 'sun.desktop' is windows
060325 001911 Property 'sun.cpu.isalist' is
060325 001911 Version Jetty/5.1.4
060325 001911 Checking Resource aliases
060325 001912 Started org.mortbay.jetty.servlet.WebApplicationHandler@1d7fbfb
060325 001912 Started WebApplicationContext[/,/]
060325 001912 Started SocketListener on 0.0.0.0:50030
060325 001912 Started org.mortbay.jetty.Server@c88440
060325 001921 Server connection on port 50020 from 192.168.1.10: starting
060325 001927 Server connection on port 50020 from 192.168.1.11: starting
060325 001933 Server connection on port 50020 from 192.168.1.12: starting
060325 002240 parsing file:/D:/jobcall_trunk/hadoop/conf/hadoop-default.xml
060325 002240 parsing file:/D:/jobcall_trunk/hadoop/conf/mapred-default.xml
060325 002240 parsing file:/D:/jobcall_trunk/hadoop/conf/hadoop-site.xml
060325 002240 parsing file:/D:/jobcall_trunk/hadoop/conf/hadoop-default.xml
060325 002240 parsing file:/D:/jobcall_trunk/hadoop/conf/mapred-default.xml
060325 002240 parsing \tmp\hadoop\mapred\local\job_3dgnm3.xml\jobTracker
060325 002240 parsing file:/D:/jobcall_trunk/hadoop/conf/hadoop-site.xml
060325 002258 parsing file:/D:/jobcall_trunk/hadoop/conf/hadoop-default.xml
060325 002258 parsing file:/D:/jobcall_trunk/hadoop/conf/mapred-default.xml
060325 002258 parsing \tmp\hadoop\mapred\local\job_3dgnm3.xml\jobTracker
060325 002258 parsing file:/D:/jobcall_trunk/hadoop/conf/hadoop-site.xml
060325 002258 job init failed
java.io.IOException: No input directories specified in: Configuration: defaults:
 hadoop-default.xml , mapred-default.xml , \tmp\hadoop\mapred\local\job_3dgnm3.x
ml\jobTrackerfinal: hadoop-site.xml
        at org.apache.hadoop.mapred.InputFormatBase.listFiles(InputFormatBase.ja
va:90)
        at org.apache.hadoop.mapred.InputFormatBase.getSplits(InputFormatBase.ja
va:100)
        at org.apache.hadoop.mapred.JobInProgress.initTasks(JobInProgress.java:1
30)
        at org.apache.hadoop.mapred.JobTracker$JobInitThread.run(JobTracker.java
:204)
        at java.lang.Thread.run(Thread.java:595)
060325 002300 Server connection on port 50020 from 192.168.1.12: exiting


> mapred input and output dirs must be absolute
> ---------------------------------------------
>
>          Key: HADOOP-52
>          URL: http://issues.apache.org/jira/browse/HADOOP-52
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Doug Cutting
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: cwd.patch, cwd2.patch, cwd3.patch
>
> DFS converts relative pathnames to be under /user/$USER.  But MapReduce jobs may be submitted by a different user than is running the jobtracker and tasktracker.  Thus relative paths must be resolved before a job is submitted, so that only absolute paths are seen on the job tracker and tasktracker.  I think the simplest way to fix this is to make JobConf.setInputDir(), setOutputDir(), etc. resolve relative pathnames. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 01:52:46 2006
Return-Path: 
 <hadoop-dev-return-562-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51251 invoked from network); 25 Mar 2006 01:52:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 01:52:46 -0000
Received: (qmail 69899 invoked by uid 500); 25 Mar 2006 01:52:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 69881 invoked by uid 500); 25 Mar 2006 01:52:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 69871 invoked by uid 99); 25 Mar 2006 01:52:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 17:52:46 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 17:52:45 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id ACDDFD4A00
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 01:52:24 +0000 (GMT)
Message-ID: <1681331066.1143251544705.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 01:52:24 +0000 (GMT)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-105) DFS commands either do not support
 some popular unix commands or have inconsistent behaviors
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

DFS commands either do not support some popular unix commands or have inconsistent behaviors
--------------------------------------------------------------------------------------------

         Key: HADOOP-105
         URL: http://issues.apache.org/jira/browse/HADOOP-105
     Project: Hadoop
        Type: Improvement
  Components: dfs  
 Environment: all 
    Reporter: Runping Qi


Several issues.

1. DFS commandline does not support rmdir
2. When executing a command like dfs -rmdir PATH, it goes through silently, without warning that -rmdir is not supported
3. DFS -rm PATH works even though PATH is a non-empty directory, which is inconsistent with unix convention.



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 02:13:49 2006
Return-Path: 
 <hadoop-dev-return-563-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 55594 invoked from network); 25 Mar 2006 02:13:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 02:13:49 -0000
Received: (qmail 88980 invoked by uid 500); 25 Mar 2006 02:13:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88962 invoked by uid 500); 25 Mar 2006 02:13:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88953 invoked by uid 99); 25 Mar 2006 02:13:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:13:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:13:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 0AEBA6ACA9
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 02:13:28 +0000 (GMT)
Message-ID: <405645521.1143252808028.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 02:13:28 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment:     (was: DF4.patch)

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: DF.java, DF.patch, DF2.patch, DF3.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 02:15:50 2006
Return-Path: 
 <hadoop-dev-return-564-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56165 invoked from network); 25 Mar 2006 02:15:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 02:15:50 -0000
Received: (qmail 90555 invoked by uid 500); 25 Mar 2006 02:15:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90533 invoked by uid 500); 25 Mar 2006 02:15:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90523 invoked by uid 99); 25 Mar 2006 02:15:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:15:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:15:49 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4FAE4D4A00
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 02:15:28 +0000 (GMT)
Message-ID: <512986515.1143252928323.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 02:15:28 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment:     (was: DF3.patch)

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: DF.java
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 02:15:52 2006
Return-Path: 
 <hadoop-dev-return-565-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56182 invoked from network); 25 Mar 2006 02:15:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 02:15:52 -0000
Received: (qmail 90718 invoked by uid 500); 25 Mar 2006 02:15:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90631 invoked by uid 500); 25 Mar 2006 02:15:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90622 invoked by uid 99); 25 Mar 2006 02:15:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:15:51 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:15:51 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 4161FD4A01
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 02:15:30 +0000 (GMT)
Message-ID: <1549155469.1143252930265.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 02:15:30 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment:     (was: DF2.patch)

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: DF.java
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 02:15:53 2006
Return-Path: 
 <hadoop-dev-return-566-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56198 invoked from network); 25 Mar 2006 02:15:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 02:15:53 -0000
Received: (qmail 90815 invoked by uid 500); 25 Mar 2006 02:15:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 90730 invoked by uid 500); 25 Mar 2006 02:15:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90721 invoked by uid 99); 25 Mar 2006 02:15:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:15:52 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:15:51 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 114BBD4A03
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 02:15:31 +0000 (GMT)
Message-ID: <2121609028.1143252931068.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 02:15:31 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment:     (was: DF.patch)

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: DF.java
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 02:40:16 2006
Return-Path: 
 <hadoop-dev-return-567-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 68413 invoked from network); 25 Mar 2006 02:40:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 02:40:16 -0000
Received: (qmail 7302 invoked by uid 500); 25 Mar 2006 02:40:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 7280 invoked by uid 500); 25 Mar 2006 02:40:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7270 invoked by uid 99); 25 Mar 2006 02:40:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:40:15 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:40:15 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2CCB2D4A00
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 02:39:54 +0000 (GMT)
Message-ID: <474455914.1143254394180.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 02:39:54 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment:     (was: DF.java)

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1

>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 02:43:45 2006
Return-Path: 
 <hadoop-dev-return-568-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69039 invoked from network); 25 Mar 2006 02:43:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 02:43:45 -0000
Received: (qmail 8607 invoked by uid 500); 25 Mar 2006 02:43:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8591 invoked by uid 500); 25 Mar 2006 02:43:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 8580 invoked by uid 99); 25 Mar 2006 02:43:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:43:45 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Mar 2006 18:43:44 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 883FBD4A00
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 02:43:23 +0000 (GMT)
Message-ID: <1436857236.1143254603555.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 02:43:23 +0000 (GMT)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]

Konstantin Shvachko updated HADOOP-33:
--------------------------------------

    Attachment: DF.java
                DF5.patch

Updating the DF patch. 
The constructor is now calling df to assign actual values to the members.
main() is back instead of the testDF.
DF.java is also updated to reflect these changes.

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: DF.java, DF5.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 19:23:14 2006
Return-Path: 
 <hadoop-dev-return-569-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57466 invoked from network); 25 Mar 2006 19:23:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 19:23:14 -0000
Received: (qmail 14609 invoked by uid 500); 25 Mar 2006 19:23:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14549 invoked by uid 500); 25 Mar 2006 19:23:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14540 invoked by uid 99); 25 Mar 2006 19:23:12 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Mar 2006 11:23:12 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Mar 2006 11:23:12 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k2PJMR79019546
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 11:22:27 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=qBvJvC8pNMdvoVGhPQcc3aV1ODoJ4ZAaVQsAcX/DMQTNhxc21cVD8Ca5tlsONZrt
Received: from [10.0.1.4] ([10.72.76.224]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Sat, 25 Mar 2006 11:22:26 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <1014579225.1143161779359.JavaMail.jira@ajax>
References: <1014579225.1143161779359.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <6588C359-5318-44B3-8BBF-41D61297F20A@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-101) DFSck - fsck-like utility for
 checking DFS volumes
Date: Sat, 25 Mar 2006 11:22:25 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 25 Mar 2006 19:22:26.0615 (UTC)
 FILETIME=[736B5C70:01C65041]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Perhaps we should implement a system by which removed blocks linger  
on the data nodes for a long period of time (a week?) (or until the  
space is needed fifo)?

Ditto with the meta data?  That would make archeology around failures  
easier.

On Mar 23, 2006, at 4:56 PM, Doug Cutting (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-101? 
> page=comments#action_12371659 ]
>
> Doug Cutting commented on HADOOP-101:
> -------------------------------------
>
> I like that this does not use anything more than the client API to  
> check the server.  That keeps the server core lean and mean.  The  
> use of RPC's effectively restricts the impact of the scan on the FS.
>
> A datanode operation that streams through a block without  
> transferring it over the wire won't correctly check checksums using  
> our existing mechanism.  To check file content we could instead  
> simply implement a map-reduce job that streams through all the  
> files in the fs.  This would not take much code: nothing additional  
> in the core.  MapReduce should handle the locality, so that most  
> data shouldn't go over the wire.
>
> BTW, blocks not used by any file are not known to the name node,  
> are they?  When they're reported by a datanode the datanode is told  
> to remove them.
>
>
>> DFSck - fsck-like utility for checking DFS volumes
>> --------------------------------------------------
>>
>>          Key: HADOOP-101
>>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>>      Project: Hadoop
>>         Type: New Feature
>>   Components: dfs
>>     Versions: 0.2
>>     Reporter: Andrzej Bialecki
>>     Assignee: Andrzej Bialecki
>>  Attachments: DFSck.java
>>
>> This is a utility to check health status of a DFS volume, and  
>> collect some additional statistics.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Sat Mar 25 20:04:55 2006
Return-Path: 
 <hadoop-dev-return-570-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 75712 invoked from network); 25 Mar 2006 20:04:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 20:04:55 -0000
Received: (qmail 39248 invoked by uid 500); 25 Mar 2006 20:04:54 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 39233 invoked by uid 500); 25 Mar 2006 20:04:54 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 39224 invoked by uid 99); 25 Mar 2006 20:04:54 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Mar 2006 12:04:54 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Mar 2006 12:04:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 721F06ACA9
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 20:04:21 +0000 (GMT)
Message-ID: <1820502878.1143317061448.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 20:04:21 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-50) dfs datanode should store blocks in
 multiple directories
In-Reply-To: <133992549.1140560804844.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-50?page=comments#action_12371869 ] 

Andrzej Bialecki  commented on HADOOP-50:
-----------------------------------------

I think this is a valid concern. Most filesystems work poorly with thousands of files in a single directory. My recent tests on ext3 show that listing the data directory with 50,000 blocks takes several seconds.

FSDataset:80 contains a commented out section, which seems to address this issue. Anyone knows why it's not used?

> dfs datanode should store blocks in multiple directories
> --------------------------------------------------------
>
>          Key: HADOOP-50
>          URL: http://issues.apache.org/jira/browse/HADOOP-50
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Mike Cafarella
>      Fix For: 0.2

>
> The datanode currently stores all file blocks in a single directory.  With 32MB blocks and terabyte filesystems, this will create too many files in a single directory for many filesystems.  Thus blocks should be stored in multiple directories, perhaps even a shallow hierarchy.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 20:21:42 2006
Return-Path: 
 <hadoop-dev-return-571-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 85630 invoked from network); 25 Mar 2006 20:21:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 20:21:42 -0000
Received: (qmail 49470 invoked by uid 500); 25 Mar 2006 20:21:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49380 invoked by uid 500); 25 Mar 2006 20:21:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49370 invoked by uid 99); 25 Mar 2006 20:21:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Mar 2006 12:21:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Mar 2006 12:21:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 5D8066ACAC
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 20:21:19 +0000 (GMT)
Message-ID: <2138966170.1143318079380.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 20:21:19 +0000 (GMT)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-106) Data blocks should be record-oriented.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Data blocks should be record-oriented.
--------------------------------------

         Key: HADOOP-106
         URL: http://issues.apache.org/jira/browse/HADOOP-106
     Project: Hadoop
        Type: Wish
  Components: dfs  
    Versions: 0.2    
    Reporter: Andrzej Bialecki 


If data blocks were starting and ending on data record boundaries, and not in random places within a file, it would give some important advantages:

* it would be possible to avoid "fishing" for the beginning of first record in a split (see SequenceFile.Reader.sync()).

* it would make recovering from DFS errors much more successful and easier - in most cases missing blocks could be just skipped and the remaining parts combined together.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sat Mar 25 22:39:41 2006
Return-Path: 
 <hadoop-dev-return-572-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 29563 invoked from network); 25 Mar 2006 22:39:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 25 Mar 2006 22:39:41 -0000
Received: (qmail 57126 invoked by uid 500); 25 Mar 2006 22:39:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 57105 invoked by uid 500); 25 Mar 2006 22:39:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 57096 invoked by uid 99); 25 Mar 2006 22:39:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Mar 2006 14:39:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Mar 2006 14:39:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 6476B6ACA9
	for <hadoop-dev@lucene.apache.org>; Sat, 25 Mar 2006 22:39:19 +0000 (GMT)
Message-ID: <755509213.1143326359408.JavaMail.jira@ajax>
Date: Sat, 25 Mar 2006 22:39:19 +0000 (GMT)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-106) Data blocks should be
 record-oriented.
In-Reply-To: <2138966170.1143318079380.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-106?page=comments#action_12371878 ] 

eric baldeschwieler commented on HADOOP-106:
--------------------------------------------

My intuition is it makes more sense to do this the other way around and have records aligned to blocks.  This keeps the FS implementation trivial.  Just pad near the end of a block.  This way you keep a good seperation of APIs too.  Fairly straight forward to change the record model to do that.  Only issues are with huge records.  You have a couple of options there.  The simplest is to disallow them...

> Data blocks should be record-oriented.
> --------------------------------------
>
>          Key: HADOOP-106
>          URL: http://issues.apache.org/jira/browse/HADOOP-106
>      Project: Hadoop
>         Type: Wish
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 

>
> If data blocks were starting and ending on data record boundaries, and not in random places within a file, it would give some important advantages:
> * it would be possible to avoid "fishing" for the beginning of first record in a split (see SequenceFile.Reader.sync()).
> * it would make recovering from DFS errors much more successful and easier - in most cases missing blocks could be just skipped and the remaining parts combined together.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Sun Mar 26 23:49:27 2006
Return-Path: 
 <hadoop-dev-return-573-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 63856 invoked from network); 26 Mar 2006 23:49:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 26 Mar 2006 23:49:27 -0000
Received: (qmail 65485 invoked by uid 500); 26 Mar 2006 23:49:27 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 65463 invoked by uid 500); 26 Mar 2006 23:49:27 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 65454 invoked by uid 99); 26 Mar 2006 23:49:26 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Mar 2006 15:49:26 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Mar 2006 15:49:26 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id 12FE21443FF
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 01:38:07 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 19316-06 for <hadoop-dev@lucene.apache.org>;
	Mon, 27 Mar 2006 01:38:06 +0200 (CEST)
Received: from [192.168.8.2] (dslb-088-073-221-049.pools.arcor-ip.net
 [88.73.221.49])
	by mslinux.media-style.com (Postfix) with ESMTP id 993501443E4
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 01:38:06 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v749.3)
Content-Transfer-Encoding: 7bit
Message-Id: <DD29BC5A-F382-4B55-9AD1-C9EF03B20626@media-style.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: hadoop-dev@lucene.apache.org
From: Stefan Groschupf <sg@media-style.com>
Subject: how blocks are compared
Date: Mon, 27 Mar 2006 01:48:55 +0200
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,
I do not clearly understand how the dfs compare blocks.

The blockId is randomly generated but the compare method looks like:

    if (getBlockId() < b.getBlockId()) {
             return -1;
         } else if (getBlockId() == b.getBlockId()) {
             return 0;
         } else {
             return 1;
         }

That wouldn't be a big problem if this would be used in the  
FSNamesystem#processBlock
   if (cmp == 0) {
                 // Do nothing, blocks are the same
...
} else if (cmp < 0) {
                 // The old report has a block the new one does not
                 removeStoredBlock(oldReport[oldPos], node);
...
   } else {
                 // The new report has a block the old one does not
                 addStoredBlock(newReport[newPos], node);

I currently just miss some glue how result of a compare of two random  
numbers can be used to decide if a block can be removed or not.

Any hints what I'm missing?

Thanks.
Stefan



---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Mon Mar 27 00:49:19 2006
Return-Path: 
 <hadoop-dev-return-574-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 83465 invoked from network); 27 Mar 2006 00:49:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Mar 2006 00:49:19 -0000
Received: (qmail 27051 invoked by uid 500); 27 Mar 2006 00:49:19 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26967 invoked by uid 500); 27 Mar 2006 00:49:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26958 invoked by uid 99); 27 Mar 2006 00:49:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Mar 2006 16:49:18 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Mar 2006 16:49:17 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id EDF141443EA;
	Mon, 27 Mar 2006 02:37:58 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 19541-04; Mon, 27 Mar 2006 02:37:58 +0200 (CEST)
Received: from [192.168.8.2] (dslb-088-073-221-049.pools.arcor-ip.net
 [88.73.221.49])
	by mslinux.media-style.com (Postfix) with ESMTP id 2A8C51443E4;
	Mon, 27 Mar 2006 02:37:58 +0200 (CEST)
In-Reply-To: <44270379.7040701@apache.org>
References: <p0623091fc04b81db8e28@[192.168.1.102]>
 <44270379.7040701@apache.org>
Mime-Version: 1.0 (Apple Message framework v749.3)
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <31462151-F5D7-4146-8D1C-6FEA363E2438@media-style.com>
Content-Transfer-Encoding: 7bit
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: "lost" NDFS blocks following network reorg
Date: Mon, 27 Mar 2006 02:48:17 +0200
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.749.3)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi hadoop developers,

I moved this discussion to the hadoop developer list since it is may  
more reponsable to this problem than the nutch users mailing list.

I spend some time to read code and find some interesting things.

The local name of the data node is  machineName + ":" + tmpPort.  So  
it can change if the port is blocked or the machine name change.
May we should create the datanode only once and write it to the data  
folder to be able read it later on.(?)

This local name is used to send block reports to the name node.  
FSNamesystem#processReport(Block newReport[], UTF8 dataNodeLocalName)  
process this report.
In the first line of this method the DatanodeInfo is loaded by the  
dataNode's localName. The datanode already is in this map since a  
heart beat is send before a block report.
So:
   DatanodeInfo node = (DatanodeInfo) datanodeMap.get(name);  // no  
problem but just a 'empty' container:
...
   Block oldReport[] = node.getBlocks(); // will return null since no  
Blocks are yet associated with this node.

Since oldReport is null all code is skipped until line 901. But this  
only adds the blocks to the node container.

In line 924 begins a section of code that collects all obsolete  
blocks. First of all I wondering why we iterate throw all blocks  
here, this could be expansice and it would be enough to iterate over  
all blocks that are reported by this datanode, isn't it?
If a block is still valid is tested by FSDirectory#isValidBlock that  
checks if the block is in activeBlocks.
The problem I see now is that the only method that adds Blocks t  
activeBlocks is unprotectedAddFile(UTF8 name, Block blocks[]). But  
here also the name node local name that may changed is involved.
This method is also used to load the state of stopped or crashed name  
node.
So in case you stop the dfs, change host names a set of blocks will  
be marked as obsolete and deleted.

Writing a test case for this behavior is very difficult since it  
involve a change of the machine name.

Makes my observation sense or do I had overseen a detail and the  
problem Ken describe is caused by a other problem?
In any case I suggest to make the data node name persistent so incase  
port or host-name change the name node will not handle the same  
datanode as a new one.

Stefan





Am 26.03.2006 um 23:11 schrieb Doug Cutting:

> Ken Krugler wrote:
>> Anyway, curious if anybody has insights here. We've done a fair  
>> amount of poking around, to no avail. I don't think there's any  
>> way to get the blocks back, as they definitely seem to be gone,  
>> and file recovery on Linux seems pretty iffy. I'm mostly  
>> interested in figuring out if this is a known issue ("Of course  
>> you can't change the server names and expect it to work"), or  
>> whether it's a symptom of lurking NDFS bugs.
>
> It's hard to tell, after the fact, whether stuff like this is pilot  
> error or a bug.  Others have reported similar things, so it's  
> either a bug or it's too easy to make pilot errors.  So something  
> needs to change.  But what?
>
> We need to start testing stuff like this systematically.  A  
> reproducible test case would make this much easier to diagnose.
>
> I'm sorry I can't be more helpful.  I'm sorry you lost data.
>
> Doug
>

---------------------------------------------
blog: http://www.find23.org
company: http://www.media-style.com



From MAILER-DAEMON Mon Mar 27 10:25:16 2006
Return-Path: 
 <hadoop-dev-return-575-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89348 invoked from network); 27 Mar 2006 10:25:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Mar 2006 10:25:16 -0000
Received: (qmail 94105 invoked by uid 500); 27 Mar 2006 10:24:55 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 94023 invoked by uid 500); 27 Mar 2006 10:24:53 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93993 invoked by uid 99); 27 Mar 2006 10:24:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 02:24:52 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 02:24:51 -0800
Received: from [192.168.0.254] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k2RAOYm05175
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 04:24:34 -0600
Message-ID: <4427BD4A.4040704@getopt.org>
Date: Mon, 27 Mar 2006 12:24:10 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: how blocks are compared
References: <DD29BC5A-F382-4B55-9AD1-C9EF03B20626@media-style.com>
In-Reply-To: <DD29BC5A-F382-4B55-9AD1-C9EF03B20626@media-style.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Stefan Groschupf wrote:
> Hi,
> I do not clearly understand how the dfs compare blocks.

> I currently just miss some glue how result of a compare of two random 
> numbers can be used to decide if a block can be removed or not.
>
> Any hints what I'm missing?

Block reports are sorted according to the same compateTo (in 
TreeSet.toArray()). It's true that IDs are random, but if both oldReport 
and newReport lists are sorted, like this:

OLD      NEW
1         2
2         3
3         4
5         5

Then the sequence of compares and pointer advances looks like this

old[oldPos=0].compareTo(new[newPos=0]) == -1; remove(old[0]); oldPos++;
old[oldPos=1].compareTo(new[newPos=0]) == 0; /* nothing */; oldPos++; 
newPos++;
old[oldPos=2].compareTo(new[newPos=1]) == 0; /* nothing */; oldPos++; 
newPos++;
old[oldPos=3].compareTo(new[newPos=2]) == 1; add(new[2]); newPos++;
old[oldPos=3].compareTo(new[newPos=3]) == 0; /* nothing */; oldPos++; 
newPos++;

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Mon Mar 27 12:20:30 2006
Return-Path: 
 <hadoop-dev-return-576-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51667 invoked from network); 27 Mar 2006 12:20:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Mar 2006 12:20:30 -0000
Received: (qmail 54463 invoked by uid 500); 27 Mar 2006 12:20:30 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 54447 invoked by uid 500); 27 Mar 2006 12:20:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 54438 invoked by uid 99); 27 Mar 2006 12:20:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 04:20:29 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [212.122.60.61] (HELO mslinux.media-style.com) (212.122.60.61)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 04:20:28 -0800
Received: from localhost (localhost [127.0.0.1])
	by mslinux.media-style.com (Postfix) with ESMTP id B9FA01443D7
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 14:09:00 +0200 (CEST)
Received: from mslinux.media-style.com ([127.0.0.1])
	by localhost (mslinux.media-style.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 23148-08 for <hadoop-dev@lucene.apache.org>;
	Mon, 27 Mar 2006 14:09:00 +0200 (CEST)
Received: from [192.168.200.39] (unknown [212.122.60.61])
	by mslinux.media-style.com (Postfix) with ESMTP id 606311443D1
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 14:09:00 +0200 (CEST)
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <4427BD4A.4040704@getopt.org>
References: <DD29BC5A-F382-4B55-9AD1-C9EF03B20626@media-style.com>
 <4427BD4A.4040704@getopt.org>
Content-Type: multipart/alternative; boundary=Apple-Mail-33--201440851
Message-Id: <50D8D79D-3B36-48CA-A9C0-35B492CDA865@media-style.com>
From: Stefan Groschupf <sg@media-style.com>
Subject: Re: how blocks are compared
Date: Mon, 27 Mar 2006 14:19:59 +0200
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at media-style.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Apple-Mail-33--201440851
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	delsp=yes;
	format=flowed

Hi Andrzej,
I see!
Thanks for the hint.
Stefan

Am 27.03.2006 um 12:24 schrieb Andrzej Bialecki:

> Stefan Groschupf wrote:
>> Hi,
>> I do not clearly understand how the dfs compare blocks.
>
>> I currently just miss some glue how result of a compare of two  
>> random numbers can be used to decide if a block can be removed or  
>> not.
>>
>> Any hints what I'm missing?
>
> Block reports are sorted according to the same compateTo (in  
> TreeSet.toArray()). It's true that IDs are random, but if both  
> oldReport and newReport lists are sorted, like this:
>
> OLD      NEW
> 1         2
> 2         3
> 3         4
> 5         5
>
> Then the sequence of compares and pointer advances looks like this
>
> old[oldPos=0].compareTo(new[newPos=0]) == -1; remove(old[0]); oldPos 
> ++;
> old[oldPos=1].compareTo(new[newPos=0]) == 0; /* nothing */; oldPos+ 
> +; newPos++;
> old[oldPos=2].compareTo(new[newPos=1]) == 0; /* nothing */; oldPos+ 
> +; newPos++;
> old[oldPos=3].compareTo(new[newPos=2]) == 1; add(new[2]); newPos++;
> old[oldPos=3].compareTo(new[newPos=3]) == 0; /* nothing */; oldPos+ 
> +; newPos++;
>
> -- 
> Best regards,
> Andrzej Bialecki     <><
> ___. ___ ___ ___ _ _   __________________________________
> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> http://www.sigram.com  Contact: info at sigram dot com
>
>
>

---------------------------------------------------------------
company:        http://www.media-style.com
forum:        http://www.text-mining.org
blog:            http://www.find23.net



--Apple-Mail-33--201440851--

From MAILER-DAEMON Mon Mar 27 17:06:46 2006
Return-Path: 
 <hadoop-dev-return-577-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42423 invoked from network); 27 Mar 2006 17:06:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Mar 2006 17:06:46 -0000
Received: (qmail 53916 invoked by uid 500); 27 Mar 2006 17:06:46 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 53828 invoked by uid 500); 27 Mar 2006 17:06:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 53817 invoked by uid 99); 27 Mar 2006 17:06:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 09:06:45 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 09:06:44 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id CA0056ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 18:06:23 +0100 (BST)
Message-ID: <1554860999.1143479183812.JavaMail.jira@ajax>
Date: Mon, 27 Mar 2006 18:06:23 +0100 (BST)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-107) Namenode errors "Failed to complete
 filename.crc  because dir.getFile()==null and null"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Namenode errors "Failed to complete filename.crc  because dir.getFile()==null and null" 
----------------------------------------------------------------------------------------

         Key: HADOOP-107
         URL: http://issues.apache.org/jira/browse/HADOOP-107
     Project: Hadoop
        Type: Bug
  Components: dfs  
 Environment: Linux
    Reporter: Igor Bolotin


We're getting lot of these errors and here is what I see in namenode log: 

060327 002016 Removing lease [Lease.  Holder: DFSClient_1897466025, heldlocks: 0, pendingcreates: 0], leases remaining: 1
060327 002523 Block report from member2.local:50010: 91895 blocks.
060327 003238 Block report from member1.local:50010: 91895 blocks.
060327 005830 Failed to complete /feedback/.feedback_10.1.10.102-33877.log.crc  because dir.getFile()==null and null
060327 005830 Server handler 1 on 50000 call error: java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
        at org.apache.hadoop.dfs.NameNode.complete(NameNode.java:205)
        at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)

I can't be 100% sure, but it looks like these errors happen with checksum files for very small data files. 


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 27 21:00:47 2006
Return-Path: 
 <hadoop-dev-return-578-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 11537 invoked from network); 27 Mar 2006 21:00:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Mar 2006 21:00:47 -0000
Received: (qmail 66866 invoked by uid 500); 27 Mar 2006 21:00:47 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66838 invoked by uid 500); 27 Mar 2006 21:00:46 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66829 invoked by uid 99); 27 Mar 2006 21:00:46 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 13:00:46 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 13:00:46 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2E7DAD49FF
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 22:00:25 +0100 (BST)
Message-ID: <32815412.1143493225187.JavaMail.jira@ajax>
Date: Mon, 27 Mar 2006 22:00:25 +0100 (BST)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-107) Namenode errors "Failed to complete
 filename.crc  because dir.getFile()==null and null"
In-Reply-To: <1554860999.1143479183812.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-107?page=comments#action_12372024 ] 

Konstantin Shvachko commented on HADOOP-107:
--------------------------------------------

It looks like your write to a file takes too long.
The client has 1 minute to complete one block write until
the lease issued for that client expires. When the lease expires the
namenode thinks the block is abandoned. If your files are small,
consisting of only 1 block, then the file will be considered abandoned
as well. So the namenode removes the file before the client reports
its completion.
Lease duration is not configurable, so you cannot control that.
But you can retry everything starting from file creation when you
receive that exception.
Is it true that your writes take longer than a minute?


> Namenode errors "Failed to complete filename.crc  because dir.getFile()==null and null"
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-107
>          URL: http://issues.apache.org/jira/browse/HADOOP-107
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>  Environment: Linux
>     Reporter: Igor Bolotin

>
> We're getting lot of these errors and here is what I see in namenode log: 
> 060327 002016 Removing lease [Lease.  Holder: DFSClient_1897466025, heldlocks: 0, pendingcreates: 0], leases remaining: 1
> 060327 002523 Block report from member2.local:50010: 91895 blocks.
> 060327 003238 Block report from member1.local:50010: 91895 blocks.
> 060327 005830 Failed to complete /feedback/.feedback_10.1.10.102-33877.log.crc  because dir.getFile()==null and null
> 060327 005830 Server handler 1 on 50000 call error: java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
> java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
>         at org.apache.hadoop.dfs.NameNode.complete(NameNode.java:205)
>         at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)
> I can't be 100% sure, but it looks like these errors happen with checksum files for very small data files. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 27 21:14:52 2006
Return-Path: 
 <hadoop-dev-return-579-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 16986 invoked from network); 27 Mar 2006 21:14:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Mar 2006 21:14:52 -0000
Received: (qmail 92235 invoked by uid 500); 27 Mar 2006 21:14:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 92215 invoked by uid 500); 27 Mar 2006 21:14:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 92206 invoked by uid 99); 27 Mar 2006 21:14:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 13:14:52 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 13:14:51 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 862956ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 22:14:30 +0100 (BST)
Message-ID: <1708028759.1143494070541.JavaMail.jira@ajax>
Date: Mon, 27 Mar 2006 22:14:30 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-107) Namenode errors "Failed to complete
 filename.crc  because dir.getFile()==null and null"
In-Reply-To: <1554860999.1143479183812.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-107?page=all ]

Doug Cutting updated HADOOP-107:
--------------------------------

    Attachment: writeLocal.patch

A connection to a datanode is opened for the checksum file when a file is opened.  Then lots of data is written to the main file, and only a little to the parallel checksum file.  So the checksum file might not get touched in up to a minute.

The last block of every file (checksum & main) is tee'd to a temporary local file, so that if the network connection dies then attempts can be made to re-transmit it to another datanode.

This patch changes things so that connections to datanodes are not initiated until the block is complete.  All writes are initially to the local, temporary file and only copied to a datanode when the block is complete.

> Namenode errors "Failed to complete filename.crc  because dir.getFile()==null and null"
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-107
>          URL: http://issues.apache.org/jira/browse/HADOOP-107
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>  Environment: Linux
>     Reporter: Igor Bolotin
>  Attachments: writeLocal.patch
>
> We're getting lot of these errors and here is what I see in namenode log: 
> 060327 002016 Removing lease [Lease.  Holder: DFSClient_1897466025, heldlocks: 0, pendingcreates: 0], leases remaining: 1
> 060327 002523 Block report from member2.local:50010: 91895 blocks.
> 060327 003238 Block report from member1.local:50010: 91895 blocks.
> 060327 005830 Failed to complete /feedback/.feedback_10.1.10.102-33877.log.crc  because dir.getFile()==null and null
> 060327 005830 Server handler 1 on 50000 call error: java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
> java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
>         at org.apache.hadoop.dfs.NameNode.complete(NameNode.java:205)
>         at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)
> I can't be 100% sure, but it looks like these errors happen with checksum files for very small data files. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 27 21:19:03 2006
Return-Path: 
 <hadoop-dev-return-580-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18885 invoked from network); 27 Mar 2006 21:19:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Mar 2006 21:19:03 -0000
Received: (qmail 99421 invoked by uid 500); 27 Mar 2006 21:19:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99336 invoked by uid 500); 27 Mar 2006 21:19:02 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99327 invoked by uid 99); 27 Mar 2006 21:19:02 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 13:19:02 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 13:19:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 29E986ACA9
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 22:18:41 +0100 (BST)
Message-ID: <1044872429.1143494321168.JavaMail.jira@ajax>
Date: Mon, 27 Mar 2006 22:18:41 +0100 (BST)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-107) Namenode errors "Failed to complete
 filename.crc  because dir.getFile()==null and null"
In-Reply-To: <1554860999.1143479183812.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-107?page=comments#action_12372028 ] 

Igor Bolotin commented on HADOOP-107:
-------------------------------------

This is correct - I tryed to write log files directly to DFS and depending on activity it could take pretty long time between calls. As a workaround - I changed my code to write to local output first and move to DFS only after file is closed (startLocalOutput/completeLocalOutput) and the problem went away.

The question is whether this behavior is expected? I though that with buffered output the blocks should not be requested until flush. If the block is requested too soon and the output takes a while for whatever reason - it's practically guaranteed to hit this problem, right? Also I never saw this happening with data files, only checksum files.

> Namenode errors "Failed to complete filename.crc  because dir.getFile()==null and null"
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-107
>          URL: http://issues.apache.org/jira/browse/HADOOP-107
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>  Environment: Linux
>     Reporter: Igor Bolotin
>  Attachments: writeLocal.patch
>
> We're getting lot of these errors and here is what I see in namenode log: 
> 060327 002016 Removing lease [Lease.  Holder: DFSClient_1897466025, heldlocks: 0, pendingcreates: 0], leases remaining: 1
> 060327 002523 Block report from member2.local:50010: 91895 blocks.
> 060327 003238 Block report from member1.local:50010: 91895 blocks.
> 060327 005830 Failed to complete /feedback/.feedback_10.1.10.102-33877.log.crc  because dir.getFile()==null and null
> 060327 005830 Server handler 1 on 50000 call error: java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
> java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
>         at org.apache.hadoop.dfs.NameNode.complete(NameNode.java:205)
>         at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)
> I can't be 100% sure, but it looks like these errors happen with checksum files for very small data files. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Mon Mar 27 22:51:44 2006
Return-Path: 
 <hadoop-dev-return-581-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 69721 invoked from network); 27 Mar 2006 22:51:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 27 Mar 2006 22:51:44 -0000
Received: (qmail 66786 invoked by uid 500); 27 Mar 2006 22:51:44 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 66763 invoked by uid 500); 27 Mar 2006 22:51:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 66748 invoked by uid 99); 27 Mar 2006 22:51:43 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 14:51:43 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 14:51:43 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 1D2B0D4A03
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 23:51:22 +0100 (BST)
Message-ID: <1165968782.1143499882115.JavaMail.jira@ajax>
Date: Mon, 27 Mar 2006 23:51:22 +0100 (BST)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-107) Namenode errors "Failed to complete
 filename.crc  because dir.getFile()==null and null"
In-Reply-To: <1554860999.1143479183812.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-107?page=comments#action_12372041 ] 

Igor Bolotin commented on HADOOP-107:
-------------------------------------

Just tested the patch and now it works as expected. 
Thanks!

> Namenode errors "Failed to complete filename.crc  because dir.getFile()==null and null"
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-107
>          URL: http://issues.apache.org/jira/browse/HADOOP-107
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>  Environment: Linux
>     Reporter: Igor Bolotin
>  Attachments: writeLocal.patch
>
> We're getting lot of these errors and here is what I see in namenode log: 
> 060327 002016 Removing lease [Lease.  Holder: DFSClient_1897466025, heldlocks: 0, pendingcreates: 0], leases remaining: 1
> 060327 002523 Block report from member2.local:50010: 91895 blocks.
> 060327 003238 Block report from member1.local:50010: 91895 blocks.
> 060327 005830 Failed to complete /feedback/.feedback_10.1.10.102-33877.log.crc  because dir.getFile()==null and null
> 060327 005830 Server handler 1 on 50000 call error: java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
> java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
>         at org.apache.hadoop.dfs.NameNode.complete(NameNode.java:205)
>         at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)
> I can't be 100% sure, but it looks like these errors happen with checksum files for very small data files. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 28 03:01:32 2006
Return-Path: 
 <hadoop-dev-return-582-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 77302 invoked from network); 28 Mar 2006 03:01:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Mar 2006 03:01:32 -0000
Received: (qmail 96097 invoked by uid 500); 28 Mar 2006 03:01:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96074 invoked by uid 500); 28 Mar 2006 03:01:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96065 invoked by uid 99); 28 Mar 2006 03:01:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 19:01:17 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Mar 2006 19:01:16 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k2S2xuCi043441
	for <hadoop-dev@lucene.apache.org>; Mon, 27 Mar 2006 18:59:56 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=VW3Z8aO7aCLSELL8Zbf9jjZSoKELNgnBNvdD2wPB6DSrTuyCa7sE5SND4gz8dA7Q
Received: from [10.0.1.4] ([172.21.179.138]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 27 Mar 2006 18:59:55 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <32815412.1143493225187.JavaMail.jira@ajax>
References: <32815412.1143493225187.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <FE497DFE-8349-4DBF-8C47-D4CCF2EB7E3A@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-107) Namenode errors "Failed to
 complete filename.crc  because dir.getFile()==null and null"
Date: Mon, 27 Mar 2006 17:01:41 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 28 Mar 2006 02:59:55.0993 (UTC)
 FILETIME=[B1598C90:01C65213]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

One should be able to renew a lease.  How does one renew a lease?   
Seems like adding a byte to the block should do that...  This seems  
very brittle as is.  If you are doing something CPU intensive that  
produces output, you don't want the system to timeout and potentially  
throw out a lot of your work.

On Mar 27, 2006, at 1:00 PM, Konstantin Shvachko (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-107? 
> page=comments#action_12372024 ]
>
> Konstantin Shvachko commented on HADOOP-107:
> --------------------------------------------
>
> It looks like your write to a file takes too long.
> The client has 1 minute to complete one block write until
> the lease issued for that client expires. When the lease expires the
> namenode thinks the block is abandoned. If your files are small,
> consisting of only 1 block, then the file will be considered abandoned
> as well. So the namenode removes the file before the client reports
> its completion.
> Lease duration is not configurable, so you cannot control that.
> But you can retry everything starting from file creation when you
> receive that exception.
> Is it true that your writes take longer than a minute?
>
>
>> Namenode errors "Failed to complete filename.crc  because  
>> dir.getFile()==null and null"
>> --------------------------------------------------------------------- 
>> ------------------
>>
>>          Key: HADOOP-107
>>          URL: http://issues.apache.org/jira/browse/HADOOP-107
>>      Project: Hadoop
>>         Type: Bug
>>   Components: dfs
>>  Environment: Linux
>>     Reporter: Igor Bolotin
>
>>
>> We're getting lot of these errors and here is what I see in  
>> namenode log:
>> 060327 002016 Removing lease [Lease.  Holder:  
>> DFSClient_1897466025, heldlocks: 0, pendingcreates: 0], leases  
>> remaining: 1
>> 060327 002523 Block report from member2.local:50010: 91895 blocks.
>> 060327 003238 Block report from member1.local:50010: 91895 blocks.
>> 060327 005830 Failed to complete / 
>> feedback/.feedback_10.1.10.102-33877.log.crc  because dir.getFile() 
>> ==null and null
>> 060327 005830 Server handler 1 on 50000 call error:  
>> java.io.IOException: Could not complete write to file / 
>> feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
>> java.io.IOException: Could not complete write to file / 
>> feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
>>         at org.apache.hadoop.dfs.NameNode.complete(NameNode.java:205)
>>         at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown  
>> Source)
>>         at sun.reflect.DelegatingMethodAccessorImpl.invoke 
>> (DelegatingMethodAccessorImpl.java:25)
>>         at java.lang.reflect.Method.invoke(Method.java:585)
>>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)
>> I can't be 100% sure, but it looks like these errors happen with  
>> checksum files for very small data files.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Tue Mar 28 08:16:36 2006
Return-Path: 
 <hadoop-dev-return-583-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20619 invoked from network); 28 Mar 2006 08:16:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Mar 2006 08:16:36 -0000
Received: (qmail 64360 invoked by uid 500); 28 Mar 2006 08:16:36 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64325 invoked by uid 500); 28 Mar 2006 08:16:35 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64314 invoked by uid 99); 28 Mar 2006 08:16:35 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 00:16:35 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of toelen@gmail.com designates
 64.233.182.191 as permitted sender)
Received: from [64.233.182.191] (HELO nproxy.gmail.com) (64.233.182.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 00:16:34 -0800
Received: by nproxy.gmail.com with SMTP id c29so1227398nfb
        for <hadoop-dev@lucene.apache.org>;
 Tue, 28 Mar 2006 00:16:13 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=LtOA1YXUSRyxLMSHa17TDgFq0RxyYmVFi5+z6HBY1bHApnsakk/3i9QPvykTp8ZP25xGrnxoFZ3s6sflxVR9opg+E2vV+f+TKBknbgU4JC5OZ/sbPsADvWT5AKMXFTtAtRlNQOhukZgqg0uEAmhrE8e83yDVwCP8dmYlqhk14Rs=
Received: by 10.48.221.4 with SMTP id t4mr2148878nfg;
        Tue, 28 Mar 2006 00:16:12 -0800 (PST)
Received: by 10.49.60.20 with HTTP; Tue, 28 Mar 2006 00:16:12 -0800 (PST)
Message-ID: <a494a0bc0603280016y421c7726u1485d98dddfccd27@mail.gmail.com>
Date: Tue, 28 Mar 2006 10:16:12 +0200
From: "Leen Toelen" <toelen@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: GreenTea
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hi,

looking at the code and examples it looks like Hadoop is created to
process large datasets. Coming from Nutch, this is not very surprising
of course. Is there any work planned to add some more generic HPC
functionality to Hadoop?

An older program, GreenTea, looked very promising at the time, and a
mix of Hadoop and GreenTea would splendid. GreenTea works without any
configuration, and all nodes can submit jobs to the system.

http://www.greenteatech.com

Regards,
Leen Toelen

From MAILER-DAEMON Tue Mar 28 17:06:04 2006
Return-Path: 
 <hadoop-dev-return-584-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51403 invoked from network); 28 Mar 2006 17:06:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Mar 2006 17:06:04 -0000
Received: (qmail 98734 invoked by uid 500); 28 Mar 2006 17:06:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 98714 invoked by uid 500); 28 Mar 2006 17:06:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 98705 invoked by uid 99); 28 Mar 2006 17:06:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 09:06:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 09:06:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DF408D49FE
	for <hadoop-dev@lucene.apache.org>; Tue, 28 Mar 2006 18:05:41 +0100 (BST)
Message-ID: <1926636101.1143565541837.JavaMail.jira@ajax>
Date: Tue, 28 Mar 2006 18:05:41 +0100 (BST)
From: "Mike Cafarella (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-50) dfs datanode should store blocks in
 multiple directories
In-Reply-To: <133992549.1140560804844.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-50?page=comments#action_12372119 ] 

Mike Cafarella commented on HADOOP-50:
--------------------------------------

Hi Andrzej,

I wrote this code and got it 90% working some time ago, but then had to abandon
it for a more important bug.  It is not ready to go in its current state, but shouldn't
be too hard.  I can bring this code back to life..

--Mike

> dfs datanode should store blocks in multiple directories
> --------------------------------------------------------
>
>          Key: HADOOP-50
>          URL: http://issues.apache.org/jira/browse/HADOOP-50
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Mike Cafarella
>      Fix For: 0.2

>
> The datanode currently stores all file blocks in a single directory.  With 32MB blocks and terabyte filesystems, this will create too many files in a single directory for many filesystems.  Thus blocks should be stored in multiple directories, perhaps even a shallow hierarchy.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 28 18:18:17 2006
Return-Path: 
 <hadoop-dev-return-585-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 87669 invoked from network); 28 Mar 2006 18:18:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Mar 2006 18:18:17 -0000
Received: (qmail 26264 invoked by uid 500); 28 Mar 2006 18:18:17 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26247 invoked by uid 500); 28 Mar 2006 18:18:17 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26238 invoked by uid 99); 28 Mar 2006 18:18:17 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 10:18:17 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 10:18:16 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A055AD49FF
	for <hadoop-dev@lucene.apache.org>; Tue, 28 Mar 2006 19:17:55 +0100 (BST)
Message-ID: <1904146098.1143569875653.JavaMail.jira@ajax>
Date: Tue, 28 Mar 2006 19:17:55 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-19) Datanode corruption
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-19?page=all ]
     
Doug Cutting resolved HADOOP-19:
--------------------------------

    Resolution: Fixed

I added a format command to namenode.  Now one must run 'bin/hadoop namenode -format' whenever a new dfs.data.dir is configured.  A misconfigured namenode will thus no longer create a new empty filesystem and then tell all datanodes to discard their blocks.

> Datanode corruption
> -------------------
>
>          Key: HADOOP-19
>          URL: http://issues.apache.org/jira/browse/HADOOP-19
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Rod Taylor
>     Assignee: Doug Cutting
>     Priority: Critical
>      Fix For: 0.1

>
> Our admins accidentally started a second nutch datanode pointing to the same directories as one already running (same machine) which in turn caused the entire contents of the datanode to go disappear.
> This happened because the blocking was based on the username (since fixed in our start scripts) and it was started as two different users.
> The ndfs.name.dir and ndfs.data.dir directories were both completely devoid of content, where they had about 150GB not all that much earlier.
> I think the solution is improved interlocking within the data directory itself (file locked with flock or something similar).

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 28 21:34:01 2006
Return-Path: 
 <hadoop-dev-return-586-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97760 invoked from network); 28 Mar 2006 21:34:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Mar 2006 21:34:01 -0000
Received: (qmail 71733 invoked by uid 500); 28 Mar 2006 21:33:59 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71635 invoked by uid 500); 28 Mar 2006 21:33:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71590 invoked by uid 99); 28 Mar 2006 21:33:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 13:33:59 -0800
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 13:33:58 -0800
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2SLXgYC019030
	for <hadoop-dev@lucene.apache.org>; Tue, 28 Mar 2006 16:33:42 -0500
X-ORBL: [69.228.218.169]
Received: from [192.168.168.15] (adsl-69-228-218-169.dsl.pltn13.pacbell.net
 [69.228.218.169])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2SLXV9U017118;
	Tue, 28 Mar 2006 16:33:34 -0500
Message-ID: <4429ABAB.7030802@apache.org>
Date: Tue, 28 Mar 2006 13:33:31 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: release 0.1
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

I'm currently planning to make a 0.1 release of Hadoop this Friday.

The bugs that we plan to fix by then are just those targetted for 0.1.

http://issues.apache.org/jira/secure/IssueNavigator.jspa?pid=12310240&fixfor=12310812

I'll also test to make sure that Nutch works in both standalone and
distributed operation on both Windows and Linux before we make the release.

Doug


From MAILER-DAEMON Tue Mar 28 21:42:00 2006
Return-Path: 
 <hadoop-dev-return-587-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 942 invoked from network); 28 Mar 2006 21:42:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Mar 2006 21:42:00 -0000
Received: (qmail 79054 invoked by uid 500); 28 Mar 2006 21:42:00 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79038 invoked by uid 500); 28 Mar 2006 21:42:00 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79029 invoked by uid 99); 28 Mar 2006 21:41:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 13:41:59 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.43] (HELO ylpvm12.prodigy.net) (207.115.57.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 13:41:59 -0800
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm12.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2SLfUbL023573
	for <hadoop-dev@lucene.apache.org>; Tue, 28 Mar 2006 16:41:32 -0500
X-ORBL: [69.228.218.169]
Received: from [192.168.168.15] (adsl-69-228-218-169.dsl.pltn13.pacbell.net
 [69.228.218.169])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2SLfPbo167672;
	Tue, 28 Mar 2006 16:41:30 -0500
Message-ID: <4429AD84.6040404@apache.org>
Date: Tue, 28 Mar 2006 13:41:24 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
References: <4429ABAB.7030802@apache.org>
In-Reply-To: <4429ABAB.7030802@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> The bugs that we plan to fix by then are just those targetted for 0.1.
> 
> http://issues.apache.org/jira/secure/IssueNavigator.jspa?pid=12310240&fixfor=12310812 

That link was broken.  Let me try again:

http://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&mode=hide&sorter/order=DESC&sorter/field=priority&resolution=-1&pid=12310240&fixfor=12310812

If that doesn't work, just visit 
http://issues.apache.org/jira/browse/HADOOP and click the "0.1" link.

Doug

From MAILER-DAEMON Tue Mar 28 23:17:43 2006
Return-Path: 
 <hadoop-dev-return-588-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 45933 invoked from network); 28 Mar 2006 23:17:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Mar 2006 23:17:43 -0000
Received: (qmail 76238 invoked by uid 500); 28 Mar 2006 23:17:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76220 invoked by uid 500); 28 Mar 2006 23:17:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76211 invoked by uid 99); 28 Mar 2006 23:17:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 15:17:42 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 15:17:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3CA62D49FF
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 00:17:21 +0100 (BST)
Message-ID: <252030003.1143587841245.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 00:17:21 +0100 (BST)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-108) EOFException in
 DataNode$DataXceiver.run
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

EOFException in DataNode$DataXceiver.run
----------------------------------------

         Key: HADOOP-108
         URL: http://issues.apache.org/jira/browse/HADOOP-108
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Reporter: Igor Bolotin


This morning - after upgrade of the system - something got wrong and we started to get lot of exceptions.
Situation didn't change after removing everything and creating new file system. 

Multiple exceptions on all data nodes:
060328 145922 108 DataXCeiver
java.io.EOFException
        at java.io.DataInputStream.readFully(DataInputStream.java:178)
        at java.io.DataInputStream.readLong(DataInputStream.java:380)
        at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:448)
        at java.lang.Thread.run(Thread.java:595)

No errors on the name node.

DFS clients report following:
060328 150923 task_r_2twzsl  Error while writing.
060328 150923 task_r_2twzsl java.net.SocketTimeoutException: Read timed out
060328 150923 task_r_2twzsl     at java.net.SocketInputStream.socketRead0(Native Method)
060328 150923 task_r_2twzsl     at java.net.SocketInputStream.read(SocketInputStream.java:129)
060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
060328 150923 task_r_2twzsl     at java.io.DataInputStream.readFully(DataInputStream.java:176)
060328 150923 task_r_2twzsl     at java.io.DataInputStream.readLong(DataInputStream.java:380)
060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:776)
060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.endBlock(DFSClient.java:751)
060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.close(DFSClient.java:814)
060328 150923 task_r_2twzsl     at org.apache.hadoop.fs.FileSystem.createNewFile(FileSystem.java:202)



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Tue Mar 28 23:41:43 2006
Return-Path: 
 <hadoop-dev-return-589-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 56902 invoked from network); 28 Mar 2006 23:41:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 28 Mar 2006 23:41:43 -0000
Received: (qmail 96683 invoked by uid 500); 28 Mar 2006 23:41:43 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96667 invoked by uid 500); 28 Mar 2006 23:41:43 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96658 invoked by uid 99); 28 Mar 2006 23:41:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 15:41:42 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 15:41:42 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 61692D49FF
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 00:41:21 +0100 (BST)
Message-ID: <1038980445.1143589281396.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 00:41:21 +0100 (BST)
From: "Igor Bolotin (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-108) EOFException in
 DataNode$DataXceiver.run
In-Reply-To: <252030003.1143587841245.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-108?page=comments#action_12372167 ] 

Igor Bolotin commented on HADOOP-108:
-------------------------------------

Found the difference - looks like it happens only when using hadoop with patch from HADOOP-107

> EOFException in DataNode$DataXceiver.run
> ----------------------------------------
>
>          Key: HADOOP-108
>          URL: http://issues.apache.org/jira/browse/HADOOP-108
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Reporter: Igor Bolotin

>
> This morning - after upgrade of the system - something got wrong and we started to get lot of exceptions.
> Situation didn't change after removing everything and creating new file system. 
> Multiple exceptions on all data nodes:
> 060328 145922 108 DataXCeiver
> java.io.EOFException
>         at java.io.DataInputStream.readFully(DataInputStream.java:178)
>         at java.io.DataInputStream.readLong(DataInputStream.java:380)
>         at org.apache.hadoop.dfs.DataNode$DataXceiver.run(DataNode.java:448)
>         at java.lang.Thread.run(Thread.java:595)
> No errors on the name node.
> DFS clients report following:
> 060328 150923 task_r_2twzsl  Error while writing.
> 060328 150923 task_r_2twzsl java.net.SocketTimeoutException: Read timed out
> 060328 150923 task_r_2twzsl     at java.net.SocketInputStream.socketRead0(Native Method)
> 060328 150923 task_r_2twzsl     at java.net.SocketInputStream.read(SocketInputStream.java:129)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
> 060328 150923 task_r_2twzsl     at java.io.BufferedInputStream.read(BufferedInputStream.java:313)
> 060328 150923 task_r_2twzsl     at java.io.DataInputStream.readFully(DataInputStream.java:176)
> 060328 150923 task_r_2twzsl     at java.io.DataInputStream.readLong(DataInputStream.java:380)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.internalClose(DFSClient.java:776)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.endBlock(DFSClient.java:751)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.close(DFSClient.java:814)
> 060328 150923 task_r_2twzsl     at org.apache.hadoop.fs.FileSystem.createNewFile(FileSystem.java:202)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 29 00:30:42 2006
Return-Path: 
 <hadoop-dev-return-590-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 76587 invoked from network); 29 Mar 2006 00:30:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 00:30:42 -0000
Received: (qmail 42027 invoked by uid 500); 29 Mar 2006 00:30:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 41941 invoked by uid 500); 29 Mar 2006 00:30:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 41929 invoked by uid 99); 29 Mar 2006 00:30:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 16:30:42 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 16:30:41 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BB592D49FF
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 01:30:20 +0100 (BST)
Message-ID: <1645127064.1143592220764.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 01:30:20 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-103) introduce a common parent class for
 Mapper and Reducer
In-Reply-To: <1231518716.1143238042535.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-103?page=all ]

Owen O'Malley updated HADOOP-103:
---------------------------------

    Attachment: user-task.patch

This patch introduces a UserTask base class that will implement the trivial configure and close methods needed for Mapper and Reducer classes. It also modifies all of the examples and built-in map and reduce classes to use the new base class. (Note that this new base class is completely optional, user code does not need to change, but it removes a lot of null function bodies that would otherwise be needed.)

> introduce a common parent class for Mapper and Reducer
> ------------------------------------------------------
>
>          Key: HADOOP-103
>          URL: http://issues.apache.org/jira/browse/HADOOP-103
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: user-task.patch
>
> I'd like to a base class that implements the default (empty) bodies for configure and close so that Mapper and Reducer classes that derive from it, which is optional, don't have to implement those methods.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 29 03:43:41 2006
Return-Path: 
 <hadoop-dev-return-591-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 57548 invoked from network); 29 Mar 2006 03:43:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 03:43:41 -0000
Received: (qmail 88387 invoked by uid 500); 29 Mar 2006 03:43:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 88361 invoked by uid 500); 29 Mar 2006 03:43:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 88352 invoked by uid 99); 29 Mar 2006 03:43:40 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 19:43:40 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 19:43:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 6C621D49FF
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 04:43:19 +0100 (BST)
Message-ID: <985692887.1143603799440.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 04:43:19 +0100 (BST)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-109) Blocks are not replicated when...
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Blocks are not replicated when...
---------------------------------

         Key: HADOOP-109
         URL: http://issues.apache.org/jira/browse/HADOOP-109
     Project: Hadoop
        Type: Bug
  Components: dfs  
    Reporter: Konstantin Shvachko


When the block is under-replicated the namenode places it into
FSNamesystem.neededReplications list.
When a datanode D1 sends getBlockwork() request to the namenode, the namenode
selects another node D2 (which it thinks is up and running) where the new replica of the
under-replicated block will be stored.
Then namenode removes the block from the neededReplications list and places it to
the pendingReplications list, and then asks D1 to replicate the block to D2.
If D2 is in fact down, then replication will fail and will never be retried later, because
the block is not in the neededReplications list, but rather in the pendingReplications list,
which namenode never checks.


-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 29 05:59:08 2006
Return-Path: 
 <hadoop-dev-return-592-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 15242 invoked from network); 29 Mar 2006 05:59:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 05:59:08 -0000
Received: (qmail 29362 invoked by uid 500); 29 Mar 2006 05:59:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 29345 invoked by uid 500); 29 Mar 2006 05:59:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 29336 invoked by uid 99); 29 Mar 2006 05:59:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 21:59:08 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Mar 2006 21:59:07 -0800
Received: from [10.10.16.235] ([64.71.164.125])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k2T5x9l26649
	for <hadoop-dev@lucene.apache.org>; Tue, 28 Mar 2006 23:59:09 -0600
Message-ID: <442A2205.6030406@getopt.org>
Date: Wed, 29 Mar 2006 07:58:29 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
References: <4429ABAB.7030802@apache.org>
In-Reply-To: <4429ABAB.7030802@apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> I'm currently planning to make a 0.1 release of Hadoop this Friday.
>
> The bugs that we plan to fix by then are just those targetted for 0.1.
>
> http://issues.apache.org/jira/secure/IssueNavigator.jspa?pid=12310240&fixfor=12310812 
>
>
> I'll also test to make sure that Nutch works in both standalone and
> distributed operation on both Windows and Linux before we make the 
> release.

I would like to commit DFSck before the release, if that's ok.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Wed Mar 29 08:28:39 2006
Return-Path: 
 <hadoop-dev-return-593-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 6019 invoked from network); 29 Mar 2006 08:28:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 08:28:39 -0000
Received: (qmail 27417 invoked by uid 500); 29 Mar 2006 08:28:39 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 27392 invoked by uid 500); 29 Mar 2006 08:28:39 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 27383 invoked by uid 99); 29 Mar 2006 08:28:38 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 00:28:38 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 00:28:38 -0800
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k2T8SBp21527
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 02:28:11 -0600
Message-ID: <442A450B.1060102@getopt.org>
Date: Wed, 29 Mar 2006 10:27:55 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Datanode / namenode UUIDs (Re: "lost" NDFS blocks following network
 reorg)
References: <p0623091fc04b81db8e28@[192.168.1.102]>
 <44270379.7040701@apache.org>
 <31462151-F5D7-4146-8D1C-6FEA363E2438@media-style.com>
In-Reply-To: <31462151-F5D7-4146-8D1C-6FEA363E2438@media-style.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Stefan Groschupf wrote:
> Hi hadoop developers,

Hi,

My comments below. Generally speaking, I think you are right - datanodes 
should be initialized with a UUID, created once and persisted across IP 
changes and hostname changes, and this UUID should be used to identify 
datanodes/namenodes. I think the "format" command should also be 
implemented for datanodes, to create their UUID when starting for the 
first time - and later on this UUID should be retrieved from the local 
file somewhere in the data dir.

> The local name of the data node is  machineName + ":" + tmpPort.  So 
> it can change if the port is blocked or the machine name change.
> May we should create the datanode only once and write it to the data 
> folder to be able read it later on.(?)
>
> This local name is used to send block reports to the name node. 
> FSNamesystem#processReport(Block newReport[], UTF8 dataNodeLocalName) 
> process this report.
> In the first line of this method the DatanodeInfo is loaded by the 
> dataNode's localName. The datanode already is in this map since a 
> heart beat is send before a block report.
> So:
>   DatanodeInfo node = (DatanodeInfo) datanodeMap.get(name);  // no 
> problem but just a 'empty' container:
> ...
>   Block oldReport[] = node.getBlocks(); // will return null since no 
> Blocks are yet associated with this node.
>
> Since oldReport is null all code is skipped until line 901. But this 
> only adds the blocks to the node container.

Umm.. I don't follow. The lines 901-905 will add these blocks from the 
newReport, because newPos == 0.

>
> In line 924 begins a section of code that collects all obsolete 
> blocks. First of all I wondering why we iterate throw all blocks here, 
> this could be expansice and it would be enough to iterate over all 
> blocks that are reported by this datanode, isn't it?
> If a block is still valid is tested by FSDirectory#isValidBlock that 
> checks if the block is in activeBlocks.
> The problem I see now is that the only method that adds Blocks t 
> activeBlocks is unprotectedAddFile(UTF8 name, Block blocks[]). But 
> here also the name node local name that may changed is involved.
> This method is also used to load the state of stopped or crashed name 
> node.
> So in case you stop the dfs, change host names a set of blocks will be 
> marked as obsolete and deleted.

I'm not 100% sure if this part is correct, but it makes me nervous, too, 
to involve such ephemeric things as IP/hostname in handling data that 
persists across IP/hostname changes...

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Wed Mar 29 09:23:41 2006
Return-Path: 
 <hadoop-dev-return-594-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41078 invoked from network); 29 Mar 2006 09:23:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 09:23:41 -0000
Received: (qmail 15568 invoked by uid 500); 29 Mar 2006 09:23:41 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15542 invoked by uid 500); 29 Mar 2006 09:23:41 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15531 invoked by uid 99); 29 Mar 2006 09:23:41 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 01:23:41 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 01:23:40 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A4EDCD49FE
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 10:23:19 +0100 (BST)
Message-ID: <853077804.1143624199665.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 10:23:19 +0100 (BST)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-50) dfs datanode should store blocks in
 multiple directories
In-Reply-To: <133992549.1140560804844.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-50?page=comments#action_12372204 ] 

Andrzej Bialecki  commented on HADOOP-50:
-----------------------------------------

That would be very useful. I've seen similar solutions in many places (e.g. squid, or Mozilla cache dir).

Currently, each time a block report is sent we need to list this huge dir. That's still ok, it's infrequent enough. However, each time we need to access a block, a correct file needs to be open. Inside the native code JVM uses an open(2) call, which causes the OS to perform a name-to-inode lookup. Even though OS is caching partial results of this lookup (in Linux this is known as dcache/dentries), still depending on the size of this LRU cache and the FS implementation details, doing real lookups for e.g. new blocks or newly requested blocks may take a long time.

Having said that, I'm not sure what would be the real performance benefit of this change, perhaps you could come up with a simpler test first...?

> dfs datanode should store blocks in multiple directories
> --------------------------------------------------------
>
>          Key: HADOOP-50
>          URL: http://issues.apache.org/jira/browse/HADOOP-50
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.2
>     Reporter: Doug Cutting
>     Assignee: Mike Cafarella
>      Fix For: 0.2

>
> The datanode currently stores all file blocks in a single directory.  With 32MB blocks and terabyte filesystems, this will create too many files in a single directory for many filesystems.  Thus blocks should be stored in multiple directories, perhaps even a shallow hierarchy.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 29 14:16:34 2006
Return-Path: 
 <hadoop-dev-return-595-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9838 invoked from network); 29 Mar 2006 14:16:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 14:16:34 -0000
Received: (qmail 71197 invoked by uid 500); 29 Mar 2006 14:15:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71173 invoked by uid 500); 29 Mar 2006 14:15:57 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71164 invoked by uid 99); 29 Mar 2006 14:15:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 06:15:57 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 06:15:56 -0800
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k2TEFhY24038
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 08:15:43 -0600
Message-ID: <442A9679.6060706@getopt.org>
Date: Wed, 29 Mar 2006 16:15:21 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: svn commit: r389633 -
 /lucene/hadoop/trunk/src/java/org/apache/hadoop/conf/Configuration.java
References: <20060329000149.62903.qmail@minotaur.apache.org>
In-Reply-To: <20060329000149.62903.qmail@minotaur.apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

cutting@apache.org wrote:
> Author: cutting
> Date: Tue Mar 28 16:01:47 2006
> New Revision: 389633
>
> URL: http://svn.apache.org/viewcvs?rev=389633&view=rev
> Log:
> Always return an absolute pathname for local files.  This fixes
> problems on Windows, where a path specified with "/foo" in a config
> file is sometimes treated as a relative path.
>   

I confirm that this fixes the issue for me. Thanks!

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Wed Mar 29 17:22:11 2006
Return-Path: 
 <hadoop-dev-return-596-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 26287 invoked from network); 29 Mar 2006 17:22:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 17:22:11 -0000
Received: (qmail 49703 invoked by uid 500); 29 Mar 2006 17:22:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49680 invoked by uid 500); 29 Mar 2006 17:22:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49670 invoked by uid 99); 29 Mar 2006 17:22:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 09:22:10 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 09:22:09 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A071C6ACAE
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 18:21:48 +0100 (BST)
Message-ID: <59600194.1143652908654.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 18:21:48 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-110) new key and value instances are
 allocated before each map
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

new key and value instances are allocated before each map
---------------------------------------------------------

         Key: HADOOP-110
         URL: http://issues.apache.org/jira/browse/HADOOP-110
     Project: Hadoop
        Type: Bug
  Components: mapred  
    Versions: 0.1    
    Reporter: Owen O'Malley
 Assigned to: Owen O'Malley 


Each time map is called with a new key and value rather than reusing the old ones.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 29 17:49:08 2006
Return-Path: 
 <hadoop-dev-return-597-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 42063 invoked from network); 29 Mar 2006 17:49:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 17:49:08 -0000
Received: (qmail 95443 invoked by uid 500); 29 Mar 2006 17:49:07 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 95332 invoked by uid 500); 29 Mar 2006 17:49:07 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 95320 invoked by uid 99); 29 Mar 2006 17:49:07 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 09:49:07 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 09:49:05 -0800
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2THmmYC001550
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 12:48:49 -0500
X-ORBL: [69.228.218.169]
Received: from [192.168.168.15] (adsl-69-228-218-169.dsl.pltn13.pacbell.net
 [69.228.218.169])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2THmWt2218294;
	Wed, 29 Mar 2006 12:48:35 -0500
Message-ID: <442AC86F.1070002@apache.org>
Date: Wed, 29 Mar 2006 09:48:31 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
References: <4429ABAB.7030802@apache.org> <442A2205.6030406@getopt.org>
In-Reply-To: <442A2205.6030406@getopt.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Andrzej Bialecki wrote:
> I would like to commit DFSck before the release, if that's ok.

That sounds fine to me.

This week, pre-release, we should be careful: (1) not to make changes 
that might destabilize things; and (2) we should not add new public APIs 
that have not been well-vetted, since once these are in a released 
version it will be harder to modify them.  But DFSck is primarily a new 
class that prints something informative, right?  So it shouldn't break 
anything, and it doesn't add any public API other than DFSck().main(), 
right?  (I can't get through to Jira right now...)

Doug

From MAILER-DAEMON Wed Mar 29 17:59:14 2006
Return-Path: 
 <hadoop-dev-return-598-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 46712 invoked from network); 29 Mar 2006 17:59:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 17:59:14 -0000
Received: (qmail 18324 invoked by uid 500); 29 Mar 2006 17:59:14 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 18297 invoked by uid 500); 29 Mar 2006 17:59:14 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 18279 invoked by uid 99); 29 Mar 2006 17:59:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 09:59:13 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 09:59:13 -0800
Received: from [192.168.0.252] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k2THwtZ24452
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 11:58:55 -0600
Message-ID: <442ACAC5.2090300@getopt.org>
Date: Wed, 29 Mar 2006 19:58:29 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
References: <4429ABAB.7030802@apache.org> <442A2205.6030406@getopt.org>
 <442AC86F.1070002@apache.org>
In-Reply-To: <442AC86F.1070002@apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Doug Cutting wrote:
> Andrzej Bialecki wrote:
>> I would like to commit DFSck before the release, if that's ok.
>
> That sounds fine to me.
>
> This week, pre-release, we should be careful: (1) not to make changes 
> that might destabilize things; and (2) we should not add new public 
> APIs that have not been well-vetted, since once these are in a 
> released version it will be harder to modify them.  But DFSck is 
> primarily a new class that prints something informative, right?  So it 
> shouldn't break anything, and it doesn't add any public API other than 
> DFSck().main(), right?  (I can't get through to Jira right now...)

Right, it doesn't touch anything in the API, just adds a shortcut 
"hadoop fsck" to bin/hadoop.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Wed Mar 29 19:27:05 2006
Return-Path: 
 <hadoop-dev-return-599-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96924 invoked from network); 29 Mar 2006 19:27:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 19:27:05 -0000
Received: (qmail 71929 invoked by uid 500); 29 Mar 2006 19:27:05 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 71906 invoked by uid 500); 29 Mar 2006 19:27:04 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 71895 invoked by uid 99); 29 Mar 2006 19:27:04 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 11:27:04 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 11:27:03 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 00A756ACAB
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 20:26:43 +0100 (BST)
Message-ID: <87753434.1143660402999.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 20:26:42 +0100 (BST)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Closed: (HADOOP-101) DFSck - fsck-like utility for checking
 DFS volumes
In-Reply-To: <958365348.1143139938715.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-101?page=all ]
     
Andrzej Bialecki  closed HADOOP-101:
------------------------------------

    Resolution: Fixed

Added as 'bin/hadoop fsck'.

> DFSck - fsck-like utility for checking DFS volumes
> --------------------------------------------------
>
>          Key: HADOOP-101
>          URL: http://issues.apache.org/jira/browse/HADOOP-101
>      Project: Hadoop
>         Type: New Feature
>   Components: dfs
>     Versions: 0.2
>     Reporter: Andrzej Bialecki 
>     Assignee: Andrzej Bialecki 
>  Attachments: DFSck.java
>
> This is a utility to check health status of a DFS volume, and collect some additional statistics.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 29 22:22:50 2006
Return-Path: 
 <hadoop-dev-return-600-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96802 invoked from network); 29 Mar 2006 22:22:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 22:22:50 -0000
Received: (qmail 42725 invoked by uid 500); 29 Mar 2006 22:22:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 42640 invoked by uid 500); 29 Mar 2006 22:22:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 42610 invoked by uid 99); 29 Mar 2006 22:22:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 14:22:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 14:22:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id F19216ACAB
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 23:22:27 +0100 (BST)
Message-ID: <1621553423.1143670947986.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 23:22:27 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-67) Added statistic/reporting info to DFS
In-Reply-To: <1955843292.1141769936628.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-67?page=all ]
     
Doug Cutting resolved HADOOP-67:
--------------------------------

    Resolution: Fixed

I just fixed this.  There is now a public API for DFS statistics.

> Added statistic/reporting info to DFS
> -------------------------------------
>
>          Key: HADOOP-67
>          URL: http://issues.apache.org/jira/browse/HADOOP-67
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>  Environment: n/a
>     Reporter: Barry Kaplan
>     Assignee: Doug Cutting
>     Priority: Trivial
>      Fix For: 0.1
>  Attachments: dfsPatch.txt
>
> The DatanodInfo, DFSFileInfo, and DFSClient were recently changed to package level protection, this hampers the ability to get some useful reporting data that can be used for DataNode and DFS health/performance.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 29 22:38:30 2006
Return-Path: 
 <hadoop-dev-return-601-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 5433 invoked from network); 29 Mar 2006 22:38:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 22:38:30 -0000
Received: (qmail 67540 invoked by uid 500); 29 Mar 2006 22:38:15 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67482 invoked by uid 500); 29 Mar 2006 22:38:15 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67431 invoked by uid 99); 29 Mar 2006 22:38:15 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 14:38:15 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 14:38:14 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2A9336ACAE
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 23:37:53 +0100 (BST)
Message-ID: <1722684178.1143671873171.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 23:37:53 +0100 (BST)
From: "Mahadev konar (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-92) Error Reporting/logging in MapReduce
In-Reply-To: <136202795.1142570952505.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-92?page=all ]

Mahadev konar updated HADOOP-92:
--------------------------------

    Attachment: interface.patch

here is patch that reports the machine on which a specific task failed. Clicking on the jobid takes you to a page where  the information is displayed as before (with a little more parsing). But each of the task's is made clickable to show all the attempts that were made to execute this task. On clikcing on this task, you can see the machine on which a particular task attempt was executed and what the error was.

> Error Reporting/logging in MapReduce
> ------------------------------------
>
>          Key: HADOOP-92
>          URL: http://issues.apache.org/jira/browse/HADOOP-92
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Mahadev konar
>     Priority: Minor
>  Attachments: interface.patch
>
> Currently Mapreduce does not tell you which machine failed to execute the task. Also, it would be nice to have features wherein there is a log report with each job, saying the number of tasks it ran (reporting which one failed and on which machine, listing any error information it can)  with  the start/end/execute time of each task. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Wed Mar 29 22:40:51 2006
Return-Path: 
 <hadoop-dev-return-602-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8118 invoked from network); 29 Mar 2006 22:40:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 29 Mar 2006 22:40:51 -0000
Received: (qmail 73234 invoked by uid 500); 29 Mar 2006 22:40:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73220 invoked by uid 500); 29 Mar 2006 22:40:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73211 invoked by uid 99); 29 Mar 2006 22:40:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 14:40:51 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 14:40:50 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id BFD126ACAB
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 23:40:29 +0100 (BST)
Message-ID: <293256189.1143672029782.JavaMail.jira@ajax>
Date: Wed, 29 Mar 2006 23:40:29 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-33) DF enhancement: performance and win XP
 support
In-Reply-To: <922804577.1139611475063.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-33?page=all ]
     
Doug Cutting resolved HADOOP-33:
--------------------------------

    Resolution: Fixed

The patch looks great.  I just committed it.  Thanks, Konstantin!

> DF enhancement: performance and win XP support
> ----------------------------------------------
>
>          Key: HADOOP-33
>          URL: http://issues.apache.org/jira/browse/HADOOP-33
>      Project: Hadoop
>         Type: Improvement
>   Components: fs, dfs
>     Versions: 0.1
>  Environment: Unix, Cygwin, Win XP
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: DF.java, DF5.patch
>
> 1. DF is called twice for each heartbeat, which happens each 3 seconds.
> There is a simple fix for that in the attached patch.
> 2. cygwin is required to run df program in windows environment.
> There is a class org.apache.commons.io.FileSystemUtils, which can return disk free space
> for different OSs, but it does not have means to get disk capacity.
> In general in windows there is no efficient and uniform way to calculate disk capacity
> using a shell command.
> The choices are 'chkdsk' and 'defrag -a', but both of them are too slow to be called
> every 3 seconds.
> WinXP and 2003 server have a new tool called fsutil, which provides all necessary info.
> I implemented a call to fsutil in case df fails, and the OS is right.
> Other win versions should still run cygwin.
> I tested this fetaure for linux, winXP and cygwin.
> See attached patch.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 00:35:20 2006
Return-Path: 
 <hadoop-dev-return-603-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 62538 invoked from network); 30 Mar 2006 00:35:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 00:35:20 -0000
Received: (qmail 48588 invoked by uid 500); 30 Mar 2006 00:35:20 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 48563 invoked by uid 500); 30 Mar 2006 00:35:19 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 48546 invoked by uid 99); 30 Mar 2006 00:35:19 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 16:35:19 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 16:35:18 -0800
Received: from pimout7-ext.prodigy.net (pimout7-int.prodigy.net
 [207.115.4.147])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2U0YMbm005461
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 19:34:22 -0500
X-ORBL: [69.228.218.169]
Received: from [192.168.168.15] (adsl-69-228-218-169.dsl.pltn13.pacbell.net
 [69.228.218.169])
	by pimout7-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2U0Ylv0207282;
	Wed, 29 Mar 2006 19:34:52 -0500
Message-ID: <442B27A6.8080500@apache.org>
Date: Wed, 29 Mar 2006 16:34:46 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: pmc@lucene.apache.org
CC: "Owen O'malley" <owen@yahoo-inc.com>, hadoop-dev@lucene.apache.org
Subject: [RESULT] VOTE: add Owen O'Malley as Hadoop committer
References: <20060322030134.69796.qmail@web50309.mail.yahoo.com>
In-Reply-To: <20060322030134.69796.qmail@web50309.mail.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

With three +1 votes and no -1 votes from the Lucene PMC, Owen O'Malley 
is now a Hadoop committer.

Welcome, Owen!

Doug



From MAILER-DAEMON Thu Mar 30 01:30:51 2006
Return-Path: 
 <hadoop-dev-return-604-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 89817 invoked from network); 30 Mar 2006 01:30:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 01:30:51 -0000
Received: (qmail 23053 invoked by uid 500); 30 Mar 2006 01:30:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23035 invoked by uid 500); 30 Mar 2006 01:30:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23026 invoked by uid 99); 30 Mar 2006 01:30:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 17:30:51 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 17:30:50 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id A3B666ACAD
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 02:30:29 +0100 (BST)
Message-ID: <1331560804.1143682229667.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 02:30:29 +0100 (BST)
From: "Konstantin Shvachko (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-84) client should report file name in which
 IO exception occurs
In-Reply-To: <555225226.1142449324055.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-84?page=all ]

Konstantin Shvachko updated HADOOP-84:
--------------------------------------

    Attachment: HADOOP-84.patch

This patch does file name and offset reporting for the failed block.
I also removed 2 unused variables.
Should be ok to include into the release.

> client should report file name in which IO exception occurs
> -----------------------------------------------------------
>
>          Key: HADOOP-84
>          URL: http://issues.apache.org/jira/browse/HADOOP-84
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>  Attachments: HADOOP-84.patch
>
> A file in the DFS got corrupted somehow.
> The client gets an exception accessing a block in the file:
> 060315 105907 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105917 No node available for block blk_2690692619196463439
> It could (and should) report the file in which the error occurred, together with the block information.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 01:42:37 2006
Return-Path: 
 <hadoop-dev-return-605-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94991 invoked from network); 30 Mar 2006 01:42:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 01:42:37 -0000
Received: (qmail 33359 invoked by uid 500); 30 Mar 2006 01:42:37 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 33339 invoked by uid 500); 30 Mar 2006 01:42:37 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 33330 invoked by uid 99); 30 Mar 2006 01:42:37 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 17:42:37 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 17:42:36 -0800
Received: from [66.228.175.136] (seemeight-dx.corp.yahoo.com [66.228.175.136])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k2U1fp7w023179
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 17:41:51 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=message-id:date:from:user-agent:x-accept-language:
	mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
	b=lH2hfKZXo1B+54y5ppS6nm6hvtgkgMRPL7WHUmTReaKUceRE3JBZpC9Kk5+/HfLH
Message-ID: <442B37CE.2040401@yahoo-inc.com>
Date: Wed, 29 Mar 2006 17:43:42 -0800
From: Konstantin Shvachko <shv@yahoo-inc.com>
User-Agent: Mozilla Thunderbird 1.0.6 (Windows/20050716)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
References: <4429ABAB.7030802@apache.org> <442A2205.6030406@getopt.org>
 <442AC86F.1070002@apache.org> <442ACAC5.2090300@getopt.org>
In-Reply-To: <442ACAC5.2090300@getopt.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Just one thing. Let's do it as Doug proposed earlier
hadoop dfs -check
This is a good piece of code, but too far from what the real
fsck should do to deserve the name :-)
I mean sooner or later somebody will write a real fsck, and we will have
to call it something else.
--Konst

Andrzej Bialecki wrote:

> Doug Cutting wrote:
>
>> Andrzej Bialecki wrote:
>>
>>> I would like to commit DFSck before the release, if that's ok.
>>
>>
>> That sounds fine to me.
>>
>> This week, pre-release, we should be careful: (1) not to make changes 
>> that might destabilize things; and (2) we should not add new public 
>> APIs that have not been well-vetted, since once these are in a 
>> released version it will be harder to modify them.  But DFSck is 
>> primarily a new class that prints something informative, right?  So 
>> it shouldn't break anything, and it doesn't add any public API other 
>> than DFSck().main(), right?  (I can't get through to Jira right now...)
>
>
> Right, it doesn't touch anything in the API, just adds a shortcut 
> "hadoop fsck" to bin/hadoop.
>


From MAILER-DAEMON Thu Mar 30 02:18:14 2006
Return-Path: 
 <hadoop-dev-return-606-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 9569 invoked from network); 30 Mar 2006 02:18:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 02:18:14 -0000
Received: (qmail 64612 invoked by uid 500); 30 Mar 2006 02:18:13 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 64591 invoked by uid 500); 30 Mar 2006 02:18:13 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 64579 invoked by uid 99); 30 Mar 2006 02:18:13 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 18:18:13 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of emanihc@gmail.com designates
 64.233.162.198 as permitted sender)
Received: from [64.233.162.198] (HELO zproxy.gmail.com) (64.233.162.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 18:18:12 -0800
Received: by zproxy.gmail.com with SMTP id o1so315053nzf
        for <hadoop-dev@lucene.apache.org>;
 Wed, 29 Mar 2006 18:17:52 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=ezqJcSbPBJqiIlqEGNI417Do1rzElctr29in+34nhcDhM/noV78nsQYq+WRVyb4wYWkC0pmNmDPaIPBKiZE3fWAnPiLyNklfNArnVRxdtqsyFUxbU0J5Y6n0S6ft0OdSLw+/0uCw27UxKRfp7OyOo6fMR6Iz2P7xHJ60l93lAuc=
Received: by 10.36.252.80 with SMTP id z80mr967566nzh;
        Wed, 29 Mar 2006 18:17:52 -0800 (PST)
Received: by 10.37.22.30 with HTTP; Wed, 29 Mar 2006 18:17:52 -0800 (PST)
Message-ID: <39209b600603291817u2ba9fc25n@mail.gmail.com>
Date: Thu, 30 Mar 2006 10:17:52 +0800
From: "emanihc emanihc" <emanihc@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Jobtracker trown IOException in windows cygwin
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_3289_22798094.1143685072290"
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_3289_22798094.1143685072290
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

start namenode,datanode,jobtracker,tasktracker
and run nutch crawl command, Exception below throwns in the jobtracker  :(

java.io.IOException: Not a file: \user\emanihc\urls\url.txt
        at org.apache.hadoop.mapred.InputFormatBase.getSplits(
InputFormatBase.ja
va:105)
        at org.apache.hadoop.mapred.JobInProgress.initTasks(
JobInProgress.java:1
30)
        at org.apache.hadoop.mapred.JobTracker$JobInitThread.run(
JobTracker.java
:204)
        at java.lang.Thread.run(Thread.java:595)
060330 101411 Server connection on port 50020 from 192.168.1.1: exiting

------=_Part_3289_22798094.1143685072290--

From MAILER-DAEMON Thu Mar 30 04:38:21 2006
Return-Path: 
 <hadoop-dev-return-607-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 64911 invoked from network); 30 Mar 2006 04:38:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 04:38:21 -0000
Received: (qmail 68698 invoked by uid 500); 30 Mar 2006 04:38:21 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 68673 invoked by uid 500); 30 Mar 2006 04:38:20 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 68664 invoked by uid 99); 30 Mar 2006 04:38:20 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 20:38:20 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.172] (HELO mrout2.yahoo.com) (216.145.54.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 20:38:19 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout2.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k2U4b9Gi084551
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 20:37:09 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=q5Wklv698couEMdH5h9vTs7OwNlBCqKJ8z69FGI7wxSYl8qtakdxXZfEcpeRvmeA
Received: from [10.0.1.4] ([10.72.76.240]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 29 Mar 2006 20:37:09 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <853077804.1143624199665.JavaMail.jira@ajax>
References: <853077804.1143624199665.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <85247E6D-7888-4741-9900-B4BC508211CC@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Commented: (HADOOP-50) dfs datanode should store blocks in
 multiple directories
Date: Wed, 29 Mar 2006 20:37:04 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 30 Mar 2006 04:37:09.0563 (UTC)
 FILETIME=[9B4130B0:01C653B3]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

don't see why we should need a test to prove the need for this.  It  
is a clear scaling problem with a simple solution deployed by many,  
many systems.  Time tested too.  Let's just make sure we don't blow  
people's data away on the upgrade!

On Mar 29, 2006, at 1:23 AM, Andrzej Bialecki (JIRA) wrote:

>     [ http://issues.apache.org/jira/browse/HADOOP-50? 
> page=comments#action_12372204 ]
>
> Andrzej Bialecki  commented on HADOOP-50:
> -----------------------------------------
>
> That would be very useful. I've seen similar solutions in many  
> places (e.g. squid, or Mozilla cache dir).
>
> Currently, each time a block report is sent we need to list this  
> huge dir. That's still ok, it's infrequent enough. However, each  
> time we need to access a block, a correct file needs to be open.  
> Inside the native code JVM uses an open(2) call, which causes the  
> OS to perform a name-to-inode lookup. Even though OS is caching  
> partial results of this lookup (in Linux this is known as dcache/ 
> dentries), still depending on the size of this LRU cache and the FS  
> implementation details, doing real lookups for e.g. new blocks or  
> newly requested blocks may take a long time.
>
> Having said that, I'm not sure what would be the real performance  
> benefit of this change, perhaps you could come up with a simpler  
> test first...?
>
>> dfs datanode should store blocks in multiple directories
>> --------------------------------------------------------
>>
>>          Key: HADOOP-50
>>          URL: http://issues.apache.org/jira/browse/HADOOP-50
>>      Project: Hadoop
>>         Type: Bug
>>   Components: dfs
>>     Versions: 0.2
>>     Reporter: Doug Cutting
>>     Assignee: Mike Cafarella
>>      Fix For: 0.2
>
>>
>> The datanode currently stores all file blocks in a single  
>> directory.  With 32MB blocks and terabyte filesystems, this will  
>> create too many files in a single directory for many filesystems.   
>> Thus blocks should be stored in multiple directories, perhaps even  
>> a shallow hierarchy.
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Thu Mar 30 04:43:29 2006
Return-Path: 
 <hadoop-dev-return-608-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 66329 invoked from network); 30 Mar 2006 04:43:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 04:43:29 -0000
Received: (qmail 76845 invoked by uid 500); 30 Mar 2006 04:43:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 76756 invoked by uid 500); 30 Mar 2006 04:43:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 76745 invoked by uid 99); 30 Mar 2006 04:43:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 20:43:29 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.171] (HELO mrout1.yahoo.com) (216.145.54.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 20:43:28 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout1.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k2U4gTUZ049648
	for <hadoop-dev@lucene.apache.org>; Wed, 29 Mar 2006 20:42:29 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=RHK/KUKVXeMW9SnnEHY0CAXOcHpCWGaZkjAhatzU+886W6J5rUP4WrzlJiMW3g0s
Received: from [10.0.1.4] ([10.72.76.240]) by SNV-XCHMAIL.xch.corp.yahoo.com
 with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 29 Mar 2006 20:42:28 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <442ACAF9.5070601@apache.org>
References: <20060329144732.keqpap9v4sggs00s@webmail.richmondinformatics.com>
 <442ACAF9.5070601@apache.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <C8E16E07-0940-4C28-8860-7CC245E4F448@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: Help: -copyFromLocal
Date: Wed, 29 Mar 2006 20:42:24 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 30 Mar 2006 04:42:29.0390 (UTC)
 FILETIME=[59E2EAE0:01C653B4]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Interesting.  It would actually be nice to include the CRCs in an  
export, so that you can validate your data when you reload it.  CRCs  
are best if they are kept end to end.

On Mar 29, 2006, at 9:59 AM, Doug Cutting wrote:

> monu.ogbe@richmondinformatics.com wrote:
>> However I'm getting the following error:
>> copyFromLocal: Target /user/root/crawl/crawldb/current/ 
>> part-00000/.data.crc
>> already exists
>
> Please file a bug report.  The problem is that when copyFromLocal  
> enumerates local files it should exclude .crc files, but it does  
> not. This is the listFiles() call on DistributedFileSystem:160.  It  
> should filter this, excluding files that are  
> FileSystem.isChecksumFile().
>
> BTW, as a workaround, it is safe to first remove all of the .crc  
> files, but your files will no longer be checksummed as they are  
> read.  On systems without ECC memory file corruption is not  
> uncommon, but I have seen very little on clusters that have ECC.
>
> Doug


From MAILER-DAEMON Thu Mar 30 06:02:34 2006
Return-Path: 
 <hadoop-dev-return-609-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 91700 invoked from network); 30 Mar 2006 06:02:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 06:02:34 -0000
Received: (qmail 40707 invoked by uid 500); 30 Mar 2006 06:02:34 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40691 invoked by uid 500); 30 Mar 2006 06:02:34 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40682 invoked by uid 99); 30 Mar 2006 06:02:34 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 22:02:34 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Mar 2006 22:02:33 -0800
Received: from [192.168.0.254] (75-mo3-2.acn.waw.pl [62.121.105.75])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id k2U62ZN14189
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 00:02:35 -0600
Message-ID: <442B7456.10505@getopt.org>
Date: Thu, 30 Mar 2006 08:01:58 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 1.5 (Windows/20051201)
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
References: <4429ABAB.7030802@apache.org> <442A2205.6030406@getopt.org>
 <442AC86F.1070002@apache.org> <442ACAC5.2090300@getopt.org>
 <442B37CE.2040401@yahoo-inc.com>
In-Reply-To: <442B37CE.2040401@yahoo-inc.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Konstantin Shvachko wrote:
> Just one thing. Let's do it as Doug proposed earlier
> hadoop dfs -check

The reason I put it under a different command is that it has more 
options than any other command in DFSShell, and adding all of them to 
the synopsis would hurt eyes, the synopsis is already too long as it is.

> This is a good piece of code, but too far from what the real
> fsck should do to deserve the name :-)
> I mean sooner or later somebody will write a real fsck, and we will have
> to call it something else.

I realize this is less than what a real fsck should be, but at the 
moment it's the closest thing we have. And SVN allows one to rename 
things...

If other people also feel it should be renamed, I can do it, no problem.

-- 
Best regards,
Andrzej Bialecki     <><
 ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com



From MAILER-DAEMON Thu Mar 30 10:51:48 2006
Return-Path: 
 <hadoop-dev-return-610-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 50428 invoked from network); 30 Mar 2006 10:51:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 10:51:48 -0000
Received: (qmail 89254 invoked by uid 500); 30 Mar 2006 10:51:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89235 invoked by uid 500); 30 Mar 2006 10:51:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89224 invoked by uid 99); 30 Mar 2006 10:51:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 02:51:47 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 02:51:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2DD8C6ACB2
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 11:51:26 +0100 (BST)
Message-ID: <3593804.1143715886185.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 11:51:26 +0100 (BST)
From: "Andrzej Bialecki  (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-111) JobClient.runJob() should return exit
 status for a job.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

JobClient.runJob() should return exit status for a job.
-------------------------------------------------------

         Key: HADOOP-111
         URL: http://issues.apache.org/jira/browse/HADOOP-111
     Project: Hadoop
        Type: Bug
    Reporter: Andrzej Bialecki 


JobClient.runJob() doesn't return any values. Any information about the exit status of a job is discarded (or appears only in logs).

It should be possible to return the exit status, so that JobClient users can determine whether a job was successfully completed or not. This is also important when using cmd-line tools in shell scripts - currently they don't return any exit codes, because it's not possible to determine the outcome of a job submitted through JobClient. As a consequence, it's difficult to automate repetitive jobs using shells scripts.

It would be also nice to have an exit message in case of errors, for human consumption.

I propose to implement one of the following:

* change the return type of this method from void to int

* or, better yet, to put the exit code and optional exit messages inside the JobConf instance under pre-defined keys.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 14:27:51 2006
Return-Path: 
 <hadoop-dev-return-611-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 75476 invoked from network); 30 Mar 2006 14:27:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 14:27:51 -0000
Received: (qmail 79907 invoked by uid 500); 30 Mar 2006 14:27:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 79879 invoked by uid 500); 30 Mar 2006 14:27:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 79870 invoked by uid 99); 30 Mar 2006 14:27:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 06:27:47 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 06:27:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 479D36ACB2
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 15:27:26 +0100 (BST)
Message-ID: <893191320.1143728846291.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 15:27:26 +0100 (BST)
From: "Monu Ogbe (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-112) copyFromLocal should exclude .crc
 files
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

copyFromLocal should exclude .crc files
---------------------------------------

         Key: HADOOP-112
         URL: http://issues.apache.org/jira/browse/HADOOP-112
     Project: Hadoop
        Type: Bug
  Components: dfs  
 Environment: DFS cluster of 6 3hz Xeons with 2Gb RAM running Centos 4.2 and Sun's JDK1.5 - but Probably applies in any environment
    Reporter: Monu Ogbe
    Priority: Minor


Doug Cutting says: "The problem is that when copyFromLocal 
enumerates local files it should exclude .crc files, but it does not. 
This is the listFiles() call on DistributedFileSystem:160.  It should 
filter this, excluding files that are FileSystem.isChecksumFile().

BTW, as a workaround, it is safe to first remove all of the .crc files, 
but your files will no longer be checksummed as they are read.  On 
systems without ECC memory file corruption is not uncommon, but I have 
seen very little on clusters that have ECC."

Original observations:

Hello Team,

I created a backup of my DFS database:

# bin/hadoop dfs -copyToLocal /user/root/crawl /mylocaldir

I now want to restore from the backup using:

# bin/hadoop dfs -copyFromLocal /mylocaldir/crawl /user/root

However I'm getting the following error:

copyFromLocal: Target /user/root/crawl/crawldb/current/part-00000/.data.crc
already exists

I get this message with every permutation of the command that I've tried, and
even after totally deleting all content in the DFS directories.

I'd be grateful for any pointers.

Many thanks,





-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 16:25:09 2006
Return-Path: 
 <hadoop-dev-return-612-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95288 invoked from network); 30 Mar 2006 16:25:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 16:25:09 -0000
Received: (qmail 49174 invoked by uid 500); 30 Mar 2006 16:25:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 49157 invoked by uid 500); 30 Mar 2006 16:25:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 49147 invoked by uid 99); 30 Mar 2006 16:25:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 08:25:08 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.46] (HELO ylpvm15.prodigy.net) (207.115.57.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 08:25:08 -0800
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm15.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2UGOnYC013160
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 11:24:52 -0500
X-ORBL: [69.228.218.169]
Received: from [192.168.168.15] (adsl-69-228-218-169.dsl.pltn13.pacbell.net
 [69.228.218.169])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2UGOWkW181712;
	Thu, 30 Mar 2006 11:24:35 -0500
Message-ID: <442C063F.1090304@apache.org>
Date: Thu, 30 Mar 2006 08:24:31 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Help: -copyFromLocal
References: <20060329144732.keqpap9v4sggs00s@webmail.richmondinformatics.com>
 <442ACAF9.5070601@apache.org>
 <C8E16E07-0940-4C28-8860-7CC245E4F448@yahoo-inc.com>
In-Reply-To: <C8E16E07-0940-4C28-8860-7CC245E4F448@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Eric Baldeschwieler wrote:
> Interesting.  It would actually be nice to include the CRCs in an  
> export, so that you can validate your data when you reload it.  CRCs  
> are best if they are kept end to end.

CRC's are included in the export.  As the files are read from dfs, the 
CRC's are checked.  As they're written to the local fs new CRCs are 
computed and written.  But then when the local files are listed, 
preparing to write them back to dfs, the CRC files are listed.  So then 
we copy a file back to dfs, we check its CRC on read and generate a new 
CRC on write.  Then we try to explicitly copy the CRC file and get an 
already-exists error.  Not to mention that we'd be generating a .crc 
file for the .crc file.  So the immediate bug is that we're listing .crc 
files from the local FS.  These should be excluded from directory 
listings there, as they are elsewhere.

We could try to copy CRC files rather than re-generate them, but that's 
a separate issue.  Things should work correctly if one lists a 
directory, opens each file, and writes its content to a new file in 
another directory.  That's valid user code using standard public APIs, 
and there's no opportunity in that case to copy CRC files directly.  The 
way to fix this is to not list CRC files in copyFromLocal.  The 
FileSystem API has both listFiles and listFilesRaw methods for this very 
purpose.  But the copyFromLocal code doesn't use these correctly.  It 
doesn't use the Hadoop FileSystem API to access local files, but rather 
the normal Java APIs.  That's the bug.

We could change file copying to copy CRC files w/o re-generating them, 
disabling re-generation in this case.  This would make CRCs more 
end-to-end, since it could catch corruption while in the 4k copying 
buffer.  When we've seen corruption is when very large buffers are used 
(e.g., when sorting), so this is not a likely place for corruption, but 
still a possible one.  And, again, this is separate from the issue reported.

Doug

From MAILER-DAEMON Thu Mar 30 16:36:48 2006
Return-Path: 
 <hadoop-dev-return-613-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1328 invoked from network); 30 Mar 2006 16:36:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 16:36:48 -0000
Received: (qmail 72512 invoked by uid 500); 30 Mar 2006 16:36:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72498 invoked by uid 500); 30 Mar 2006 16:36:47 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72486 invoked by uid 99); 30 Mar 2006 16:36:47 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 08:36:47 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 08:36:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 2F7126ACB3
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 17:36:26 +0100 (BST)
Message-ID: <144372860.1143736586191.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 17:36:26 +0100 (BST)
From: "Rod Taylor (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-113) Allow multiple Output Dirs to be
 specified for a job
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Allow multiple Output Dirs to be specified for a job
----------------------------------------------------

         Key: HADOOP-113
         URL: http://issues.apache.org/jira/browse/HADOOP-113
     Project: Hadoop
        Type: New Feature
  Components: mapred  
    Versions: 0.1    
    Reporter: Rod Taylor
 Attachments: hadoop_multisegment.patch

Allow a single job to create multiple outputs. 2 additional simple functions only

This allows for more complex branching of the process to occur either with multiple steps of the same type or allow different actions to take place on each output directory depending on the required actions.


For my specific use, it allows me to run multiple Generate Outputs instead of a single Generate Output as submitted in NUTCH-171(http://issues.apache.org/jira/browse/NUTCH-171)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 16:36:49 2006
Return-Path: 
 <hadoop-dev-return-614-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 1342 invoked from network); 30 Mar 2006 16:36:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 16:36:49 -0000
Received: (qmail 72636 invoked by uid 500); 30 Mar 2006 16:36:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72610 invoked by uid 500); 30 Mar 2006 16:36:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72601 invoked by uid 99); 30 Mar 2006 16:36:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 08:36:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 08:36:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id EC7DB6ACB5
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 17:36:26 +0100 (BST)
Message-ID: <343846317.1143736586966.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 17:36:26 +0100 (BST)
From: "Rod Taylor (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-113) Allow multiple Output Dirs to be
 specified for a job
In-Reply-To: <144372860.1143736586191.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-113?page=all ]

Rod Taylor updated HADOOP-113:
------------------------------

    Attachment: hadoop_multisegment.patch

> Allow multiple Output Dirs to be specified for a job
> ----------------------------------------------------
>
>          Key: HADOOP-113
>          URL: http://issues.apache.org/jira/browse/HADOOP-113
>      Project: Hadoop
>         Type: New Feature
>   Components: mapred
>     Versions: 0.1
>     Reporter: Rod Taylor
>  Attachments: hadoop_multisegment.patch
>
> Allow a single job to create multiple outputs. 2 additional simple functions only
> This allows for more complex branching of the process to occur either with multiple steps of the same type or allow different actions to take place on each output directory depending on the required actions.
> For my specific use, it allows me to run multiple Generate Outputs instead of a single Generate Output as submitted in NUTCH-171(http://issues.apache.org/jira/browse/NUTCH-171)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 17:52:46 2006
Return-Path: 
 <hadoop-dev-return-615-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43173 invoked from network); 30 Mar 2006 17:52:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 17:52:46 -0000
Received: (qmail 99360 invoked by uid 500); 30 Mar 2006 17:52:45 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99270 invoked by uid 500); 30 Mar 2006 17:52:45 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99261 invoked by uid 99); 30 Mar 2006 17:52:45 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 09:52:45 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 09:52:44 -0800
Received: from memberfamouslx (memberfamous-lx.corp.yahoo.com [172.21.103.73])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k2UHq42G021804
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 09:52:05 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=rcO4PDPAvfNKg5flp19P0LktFpaBCW5+Np9DLomz23MmwkqrDh3kmUZtqRLg0Fh7
From: "Yoram Arnon" <yarnon@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: release 0.1
Date: Thu, 30 Mar 2006 09:54:01 -0800
Message-ID: <00ad01c65422$edb12a70$496715ac@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <442B37CE.2040401@yahoo-inc.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZTm0IP3PawxfHiRpWez6kgC8cJYgAh6erw
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

+1 

-----Original Message-----
From: Konstantin Shvachko [mailto:shv@yahoo-inc.com] 
Sent: Wednesday, March 29, 2006 5:44 PM
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1

Just one thing. Let's do it as Doug proposed earlier hadoop dfs -check This
is a good piece of code, but too far from what the real fsck should do to
deserve the name :-) I mean sooner or later somebody will write a real fsck,
and we will have to call it something else.
--Konst

Andrzej Bialecki wrote:

> Doug Cutting wrote:
>
>> Andrzej Bialecki wrote:
>>
>>> I would like to commit DFSck before the release, if that's ok.
>>
>>
>> That sounds fine to me.
>>
>> This week, pre-release, we should be careful: (1) not to make changes 
>> that might destabilize things; and (2) we should not add new public 
>> APIs that have not been well-vetted, since once these are in a 
>> released version it will be harder to modify them.  But DFSck is 
>> primarily a new class that prints something informative, right?  So 
>> it shouldn't break anything, and it doesn't add any public API other 
>> than DFSck().main(), right?  (I can't get through to Jira right 
>> now...)
>
>
> Right, it doesn't touch anything in the API, just adds a shortcut 
> "hadoop fsck" to bin/hadoop.
>



From MAILER-DAEMON Thu Mar 30 18:33:34 2006
Return-Path: 
 <hadoop-dev-return-616-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65035 invoked from network); 30 Mar 2006 18:33:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 18:33:34 -0000
Received: (qmail 78483 invoked by uid 500); 30 Mar 2006 18:33:33 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 78464 invoked by uid 500); 30 Mar 2006 18:33:33 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 78455 invoked by uid 99); 30 Mar 2006 18:33:32 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 10:33:32 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 10:33:32 -0800
Received: from pimout5-ext.prodigy.net (pimout5-int.prodigy.net
 [207.115.4.21])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2UIWVbk014960
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 13:32:34 -0500
X-ORBL: [69.228.218.169]
Received: from [192.168.168.15] (adsl-69-228-218-169.dsl.pltn13.pacbell.net
 [69.228.218.169])
	by pimout5-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2UIWvvI239064;
	Thu, 30 Mar 2006 13:33:02 -0500
Message-ID: <442C2458.80605@apache.org>
Date: Thu, 30 Mar 2006 10:32:56 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
References: <4429ABAB.7030802@apache.org> <442A2205.6030406@getopt.org>
 <442AC86F.1070002@apache.org> <442ACAC5.2090300@getopt.org>
 <442B37CE.2040401@yahoo-inc.com>
In-Reply-To: <442B37CE.2040401@yahoo-inc.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Konstantin Shvachko wrote:
> Just one thing. Let's do it as Doug proposed earlier
> hadoop dfs -check

It's only given this name in bin/hadoop.  It should break no code to 
change what 'bin/hadoop fsck' does in the future.  So I don't see how it 
makes a difference whether this is invoked as 'bin/hadoop dfs -check' or 
'bin/hadoop fsck'.  If someone is parsing the output of bin/hadoop 
commands then they could be broken, but that would be a fragile program 
anyway.  Updating what 'bin/hadoop fsck' does will not change any public 
APIs.

> This is a good piece of code, but too far from what the real
> fsck should do to deserve the name :-)

It is the closest thing we have now.

Doug

From MAILER-DAEMON Thu Mar 30 18:35:42 2006
Return-Path: 
 <hadoop-dev-return-617-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 67645 invoked from network); 30 Mar 2006 18:35:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 18:35:42 -0000
Received: (qmail 81313 invoked by uid 500); 30 Mar 2006 18:35:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81298 invoked by uid 500); 30 Mar 2006 18:35:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81288 invoked by uid 99); 30 Mar 2006 18:35:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 10:35:41 -0800
X-ASF-Spam-Status: No, hits=0.3 required=10.0
	tests=MAILTO_TO_SPAM_ADDR
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [193.203.240.6] (HELO psa2.houxou.com) (193.203.240.6)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 10:35:41 -0800
Received: (qmail 18382 invoked from network); 30 Mar 2006 19:35:11 +0100
Received: from adsl-193.203.244.247.access.houxou.com (HELO monufujitsu)
 (193.203.244.247)
  by psa2.houxou.com with SMTP; 30 Mar 2006 19:35:10 +0100
Message-ID: <00c201c65428$b1ebbf40$561ea8c0@uk.houxou.com>
From: "Monu Ogbe" <monu.ogbe@richmondinformatics.com>
To: <hadoop-dev@lucene.apache.org>
References: <20060329144732.keqpap9v4sggs00s@webmail.richmondinformatics.com>
 <442ACAF9.5070601@apache.org>
 <C8E16E07-0940-4C28-8860-7CC245E4F448@yahoo-inc.com>
Subject: Re: Help: -copyFromLocal
Date: Thu, 30 Mar 2006 19:35:18 +0100
Organization: Richmond Informatics
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="iso-8859-1";
	reply-type=response
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.2527
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2527
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

This is now reported as HADOOP-112 in JIRA. 

----- Original Message ----- 
From: "Eric Baldeschwieler" <eric14@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Sent: Thursday, March 30, 2006 5:42 AM
Subject: Re: Help: -copyFromLocal


> Interesting.  It would actually be nice to include the CRCs in an  
> export, so that you can validate your data when you reload it.  CRCs  
> are best if they are kept end to end.
> 
> On Mar 29, 2006, at 9:59 AM, Doug Cutting wrote:
> 
>> monu.ogbe@richmondinformatics.com wrote:
>>> However I'm getting the following error:
>>> copyFromLocal: Target /user/root/crawl/crawldb/current/ 
>>> part-00000/.data.crc
>>> already exists
>>
>> Please file a bug report.  The problem is that when copyFromLocal  
>> enumerates local files it should exclude .crc files, but it does  
>> not. This is the listFiles() call on DistributedFileSystem:160.  It  
>> should filter this, excluding files that are  
>> FileSystem.isChecksumFile().
>>
>> BTW, as a workaround, it is safe to first remove all of the .crc  
>> files, but your files will no longer be checksummed as they are  
>> read.  On systems without ECC memory file corruption is not  
>> uncommon, but I have seen very little on clusters that have ECC.
>>
>> Doug
> 
>

From MAILER-DAEMON Thu Mar 30 18:47:55 2006
Return-Path: 
 <hadoop-dev-return-618-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 73618 invoked from network); 30 Mar 2006 18:47:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 18:47:55 -0000
Received: (qmail 99846 invoked by uid 500); 30 Mar 2006 18:47:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 99725 invoked by uid 500); 30 Mar 2006 18:47:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 99516 invoked by uid 99); 30 Mar 2006 18:47:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 10:47:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 10:47:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E43026ACB5
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 19:47:27 +0100 (BST)
Message-ID: <2093514116.1143744447932.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 19:47:27 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-84) client should report file name in
 which IO exception occurs
In-Reply-To: <555225226.1142449324055.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-84?page=all ]
     
Doug Cutting resolved HADOOP-84:
--------------------------------

    Fix Version: 0.1
     Resolution: Fixed

I just committed this. I removed the unused code rather than just commenting it out, and also removed some spurious empty comments inserted by the patch.

Thanks, Konstantin!

> client should report file name in which IO exception occurs
> -----------------------------------------------------------
>
>          Key: HADOOP-84
>          URL: http://issues.apache.org/jira/browse/HADOOP-84
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Konstantin Shvachko
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: HADOOP-84.patch
>
> A file in the DFS got corrupted somehow.
> The client gets an exception accessing a block in the file:
> 060315 105907 Could not obtain block from any node:  java.io.IOException: No live nodes contain current block
> 060315 105917 No node available for block blk_2690692619196463439
> It could (and should) report the file in which the error occurred, together with the block information.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 19:11:49 2006
Return-Path: 
 <hadoop-dev-return-619-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 84934 invoked from network); 30 Mar 2006 19:11:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 19:11:49 -0000
Received: (qmail 51091 invoked by uid 500); 30 Mar 2006 19:11:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 51000 invoked by uid 500); 30 Mar 2006 19:11:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50991 invoked by uid 99); 30 Mar 2006 19:11:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 11:11:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 11:11:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 63C376ACB2
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 20:11:27 +0100 (BST)
Message-ID: <449946754.1143745887406.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 20:11:27 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-112) copyFromLocal should exclude .crc
 files
In-Reply-To: <893191320.1143728846291.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-112?page=all ]
     
Doug Cutting resolved HADOOP-112:
---------------------------------

    Fix Version: 0.1
     Resolution: Fixed
      Assign To: Doug Cutting

I just committed a fix for this.  DistributedFileSystem.copyFromLocal() no longer attempts to copy CRC files.

> copyFromLocal should exclude .crc files
> ---------------------------------------
>
>          Key: HADOOP-112
>          URL: http://issues.apache.org/jira/browse/HADOOP-112
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>  Environment: DFS cluster of 6 3hz Xeons with 2Gb RAM running Centos 4.2 and Sun's JDK1.5 - but Probably applies in any environment
>     Reporter: Monu Ogbe
>     Assignee: Doug Cutting
>     Priority: Minor
>      Fix For: 0.1

>
> Doug Cutting says: "The problem is that when copyFromLocal 
> enumerates local files it should exclude .crc files, but it does not. 
> This is the listFiles() call on DistributedFileSystem:160.  It should 
> filter this, excluding files that are FileSystem.isChecksumFile().
> BTW, as a workaround, it is safe to first remove all of the .crc files, 
> but your files will no longer be checksummed as they are read.  On 
> systems without ECC memory file corruption is not uncommon, but I have 
> seen very little on clusters that have ECC."
> Original observations:
> Hello Team,
> I created a backup of my DFS database:
> # bin/hadoop dfs -copyToLocal /user/root/crawl /mylocaldir
> I now want to restore from the backup using:
> # bin/hadoop dfs -copyFromLocal /mylocaldir/crawl /user/root
> However I'm getting the following error:
> copyFromLocal: Target /user/root/crawl/crawldb/current/part-00000/.data.crc
> already exists
> I get this message with every permutation of the command that I've tried, and
> even after totally deleting all content in the DFS directories.
> I'd be grateful for any pointers.
> Many thanks,

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 19:29:51 2006
Return-Path: 
 <hadoop-dev-return-620-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 96946 invoked from network); 30 Mar 2006 19:29:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 19:29:51 -0000
Received: (qmail 91162 invoked by uid 500); 30 Mar 2006 19:29:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 91108 invoked by uid 500); 30 Mar 2006 19:29:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 90969 invoked by uid 99); 30 Mar 2006 19:29:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 11:29:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 11:29:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 7E1D76ACB4
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 20:29:27 +0100 (BST)
Message-ID: <929617411.1143746967514.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 20:29:27 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-2) Reused Keys and Values fail with a
 Combiner
In-Reply-To: <361890767.1139000103581.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-2?page=all ]

Owen O'Malley updated HADOOP-2:
-------------------------------

    Attachment: clone-map-output.patch

This patch clones the keys and values before they are cached in the CombiningCollector.
It adds a new method named WritableUtils.clone(Writable, JobConf) that copies the the given Writable.

> Reused Keys and Values fail with a Combiner
> -------------------------------------------
>
>          Key: HADOOP-2
>          URL: http://issues.apache.org/jira/browse/HADOOP-2
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: clone-map-output.patch
>
> If the map function reuses the key or value by destructively modifying it after the output.collect(key,value) call and your application uses a combiner, the data is corrupted by having lots of instances with the last key or value.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 19:31:48 2006
Return-Path: 
 <hadoop-dev-return-621-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97766 invoked from network); 30 Mar 2006 19:31:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 19:31:48 -0000
Received: (qmail 93455 invoked by uid 500); 30 Mar 2006 19:31:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 93436 invoked by uid 500); 30 Mar 2006 19:31:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 93426 invoked by uid 99); 30 Mar 2006 19:31:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 11:31:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 11:31:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B196F6ACB2
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 20:31:26 +0100 (BST)
Message-ID: <989235965.1143747086725.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 20:31:26 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-110) new key and value instances are
 allocated before each map
In-Reply-To: <59600194.1143652908654.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-110?page=all ]

Owen O'Malley updated HADOOP-110:
---------------------------------

    Attachment: reuse-map-inputs.patch

Moves the creation of the map input objects outside of the loop.

> new key and value instances are allocated before each map
> ---------------------------------------------------------
>
>          Key: HADOOP-110
>          URL: http://issues.apache.org/jira/browse/HADOOP-110
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>  Attachments: reuse-map-inputs.patch
>
> Each time map is called with a new key and value rather than reusing the old ones.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 19:56:48 2006
Return-Path: 
 <hadoop-dev-return-622-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 13131 invoked from network); 30 Mar 2006 19:56:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 19:56:48 -0000
Received: (qmail 47378 invoked by uid 500); 30 Mar 2006 19:56:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47362 invoked by uid 500); 30 Mar 2006 19:56:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47353 invoked by uid 99); 30 Mar 2006 19:56:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 11:56:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 11:56:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id B64C56ACB3
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 20:56:26 +0100 (BST)
Message-ID: <2043121647.1143748586743.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 20:56:26 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-113) Allow multiple Output Dirs to be
 specified for a job
In-Reply-To: <144372860.1143736586191.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-113?page=comments#action_12372563 ] 

Doug Cutting commented on HADOOP-113:
-------------------------------------

We should probably instead add a Configuration.getFiles() method, used by this and by getInputDirs().  This should be implemented in terms of Configuration.getStrings().   And we should add a Configuration.addFile() method that's used by this and by addInputDir().  This should be implemented in terms of a Configuration.addString() method.  Otherwise we end up copying the same code around in too many places.

However I'm not yet convinced that this feature is the best way to achieve your goal.  I've commented on NUTCH-171 that an alternate mechanism might better achive your goal.  If that or something like it makes sense (specifying, for a job, the maximum number of its maps & reduces that should be run on a single node at once, so that a job can use less than the entire cluster, permitting other jobs to pass it) then we should start a new Hadoop bug for that.

> Allow multiple Output Dirs to be specified for a job
> ----------------------------------------------------
>
>          Key: HADOOP-113
>          URL: http://issues.apache.org/jira/browse/HADOOP-113
>      Project: Hadoop
>         Type: New Feature
>   Components: mapred
>     Versions: 0.1
>     Reporter: Rod Taylor
>  Attachments: hadoop_multisegment.patch
>
> Allow a single job to create multiple outputs. 2 additional simple functions only
> This allows for more complex branching of the process to occur either with multiple steps of the same type or allow different actions to take place on each output directory depending on the required actions.
> For my specific use, it allows me to run multiple Generate Outputs instead of a single Generate Output as submitted in NUTCH-171(http://issues.apache.org/jira/browse/NUTCH-171)

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 20:11:48 2006
Return-Path: 
 <hadoop-dev-return-623-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 18127 invoked from network); 30 Mar 2006 20:11:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 20:11:48 -0000
Received: (qmail 67942 invoked by uid 500); 30 Mar 2006 20:11:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 67923 invoked by uid 500); 30 Mar 2006 20:11:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 67914 invoked by uid 99); 30 Mar 2006 20:11:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 12:11:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 12:11:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id C4B746ACB2
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 21:11:26 +0100 (BST)
Message-ID: <547024229.1143749486803.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 21:11:26 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-2) Reused Keys and Values fail with a
 Combiner
In-Reply-To: <361890767.1139000103581.JavaMail.jira@ajax.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-2?page=all ]
     
Doug Cutting resolved HADOOP-2:
-------------------------------

    Resolution: Fixed

I just committed this.  Thanks Owen!

> Reused Keys and Values fail with a Combiner
> -------------------------------------------
>
>          Key: HADOOP-2
>          URL: http://issues.apache.org/jira/browse/HADOOP-2
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: clone-map-output.patch
>
> If the map function reuses the key or value by destructively modifying it after the output.collect(key,value) call and your application uses a combiner, the data is corrupted by having lots of instances with the last key or value.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 20:17:07 2006
Return-Path: 
 <hadoop-dev-return-624-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 20188 invoked from network); 30 Mar 2006 20:17:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 20:17:07 -0000
Received: (qmail 72597 invoked by uid 500); 30 Mar 2006 20:16:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 72576 invoked by uid 500); 30 Mar 2006 20:16:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 72567 invoked by uid 99); 30 Mar 2006 20:16:52 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 12:16:52 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 12:16:51 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 036796ACB7
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 21:16:31 +0100 (BST)
Message-ID: <680050181.1143749791011.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 21:16:31 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-110) new key and value instances are
 allocated before each map
In-Reply-To: <59600194.1143652908654.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-110?page=all ]
     
Doug Cutting resolved HADOOP-110:
---------------------------------

    Fix Version: 0.1
     Resolution: Fixed

I just committed this.  Thanks, Owen.

> new key and value instances are allocated before each map
> ---------------------------------------------------------
>
>          Key: HADOOP-110
>          URL: http://issues.apache.org/jira/browse/HADOOP-110
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: reuse-map-inputs.patch
>
> Each time map is called with a new key and value rather than reusing the old ones.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 21:56:49 2006
Return-Path: 
 <hadoop-dev-return-625-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 88398 invoked from network); 30 Mar 2006 21:56:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 21:56:49 -0000
Received: (qmail 40895 invoked by uid 500); 30 Mar 2006 21:56:49 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 40867 invoked by uid 500); 30 Mar 2006 21:56:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 40851 invoked by uid 99); 30 Mar 2006 21:56:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 13:56:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 13:56:47 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id E153E6ACB2
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 22:56:26 +0100 (BST)
Message-ID: <1205995655.1143755786920.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 22:56:26 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-103) introduce a common parent class for
 Mapper and Reducer
In-Reply-To: <1231518716.1143238042535.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-103?page=all ]

Owen O'Malley updated HADOOP-103:
---------------------------------

    Attachment: user-task-2.patch

Here is a new patch that renames the base class to MapReduceBase.


> introduce a common parent class for Mapper and Reducer
> ------------------------------------------------------
>
>          Key: HADOOP-103
>          URL: http://issues.apache.org/jira/browse/HADOOP-103
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: user-task-2.patch, user-task.patch
>
> I'd like to a base class that implements the default (empty) bodies for configure and close so that Mapper and Reducer classes that derive from it, which is optional, don't have to implement those methods.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 22:19:49 2006
Return-Path: 
 <hadoop-dev-return-626-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 97504 invoked from network); 30 Mar 2006 22:19:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 22:19:49 -0000
Received: (qmail 81115 invoked by uid 500); 30 Mar 2006 22:19:48 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 81093 invoked by uid 500); 30 Mar 2006 22:19:48 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 81082 invoked by uid 99); 30 Mar 2006 22:19:48 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 14:19:48 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 14:19:48 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 208CE6ACB4
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 23:19:27 +0100 (BST)
Message-ID: <1947265950.1143757167130.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 23:19:27 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-103) introduce a common parent class for
 Mapper and Reducer
In-Reply-To: <1231518716.1143238042535.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-103?page=all ]
     
Doug Cutting resolved HADOOP-103:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen!

> introduce a common parent class for Mapper and Reducer
> ------------------------------------------------------
>
>          Key: HADOOP-103
>          URL: http://issues.apache.org/jira/browse/HADOOP-103
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>     Priority: Minor
>      Fix For: 0.1
>  Attachments: user-task-2.patch, user-task.patch
>
> I'd like to a base class that implements the default (empty) bodies for configure and close so that Mapper and Reducer classes that derive from it, which is optional, don't have to implement those methods.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 22:40:52 2006
Return-Path: 
 <hadoop-dev-return-627-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 8191 invoked from network); 30 Mar 2006 22:40:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 22:40:52 -0000
Received: (qmail 14088 invoked by uid 500); 30 Mar 2006 22:40:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 14072 invoked by uid 500); 30 Mar 2006 22:40:51 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 14063 invoked by uid 99); 30 Mar 2006 22:40:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 14:40:51 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 14:40:51 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 105F26ACB2
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 23:40:30 +0100 (BST)
Message-ID: <533665628.1143758430064.JavaMail.jira@ajax>
Date: Thu, 30 Mar 2006 23:40:30 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-107) Namenode errors "Failed to complete
 filename.crc  because dir.getFile()==null and null"
In-Reply-To: <1554860999.1143479183812.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-107?page=all ]
     
Doug Cutting resolved HADOOP-107:
---------------------------------

    Fix Version: 0.1
     Resolution: Fixed
      Assign To: Doug Cutting

I just committed a fix for this.

> Namenode errors "Failed to complete filename.crc  because dir.getFile()==null and null"
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-107
>          URL: http://issues.apache.org/jira/browse/HADOOP-107
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>  Environment: Linux
>     Reporter: Igor Bolotin
>     Assignee: Doug Cutting
>      Fix For: 0.1
>  Attachments: writeLocal.patch
>
> We're getting lot of these errors and here is what I see in namenode log: 
> 060327 002016 Removing lease [Lease.  Holder: DFSClient_1897466025, heldlocks: 0, pendingcreates: 0], leases remaining: 1
> 060327 002523 Block report from member2.local:50010: 91895 blocks.
> 060327 003238 Block report from member1.local:50010: 91895 blocks.
> 060327 005830 Failed to complete /feedback/.feedback_10.1.10.102-33877.log.crc  because dir.getFile()==null and null
> 060327 005830 Server handler 1 on 50000 call error: java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
> java.io.IOException: Could not complete write to file /feedback/.feedback_10.1.10.102-33877.log.crc by DFSClient_1897466025
>         at org.apache.hadoop.dfs.NameNode.complete(NameNode.java:205)
>         at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
>         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:237)
>         at org.apache.hadoop.ipc.Server$Handler.run(Server.java:216)
> I can't be 100% sure, but it looks like these errors happen with checksum files for very small data files. 

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 23:08:09 2006
Return-Path: 
 <hadoop-dev-return-628-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 21870 invoked from network); 30 Mar 2006 23:08:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 23:08:09 -0000
Received: (qmail 50905 invoked by uid 500); 30 Mar 2006 23:08:09 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 50885 invoked by uid 500); 30 Mar 2006 23:08:09 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 50875 invoked by uid 99); 30 Mar 2006 23:08:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 15:08:08 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 15:08:08 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 635636ACB3
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 00:07:47 +0100 (BST)
Message-ID: <1924522789.1143760067403.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 00:07:47 +0100 (BST)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12372589 ] 

Yoram Arnon commented on HADOOP-96:
-----------------------------------

the plan is to add a log line for each change in the name space and each change in block placement or replication. What we get is effectively a trace of program execution for DFS changes.
the log will go to a new log object, to enable switching this (extensive) logging on or off.
name space changes will be logged at level fine, block commit changes at finer, and block pending changes at finest.
In order to facilitate tracing of multiple concurrent operations, each line will include the thread id of the name server's thread. For that we derive a logging class, that places the thread id right after the date/time.

we log in the following methods of class name node, and in methods of class nameSystem called by them:
create (startFile)
abandonFileInProgress (abandonFileInProgress )
AbandonBlock (AbandonBlock )
reportWrittenBlock (blockReceived)
addBlock (getAdditionalBlock)
Complete (completeFile)
rename (renameTo)
delete (delete)
Mkdirs (Mkdirs)
sendHeartbeat (getHeartbeat)
blockReport (processReoprt)
blockReceived (blockReceived)
errorReport
getBlockWork (pendingTransfer, blocksToInvalidate)


> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Priority: Critical

>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 23:18:12 2006
Return-Path: 
 <hadoop-dev-return-629-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 24959 invoked from network); 30 Mar 2006 23:18:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 23:18:12 -0000
Received: (qmail 59521 invoked by uid 500); 30 Mar 2006 23:18:08 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 59471 invoked by uid 500); 30 Mar 2006 23:18:08 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 59437 invoked by uid 99); 30 Mar 2006 23:18:08 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 15:18:08 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 15:18:07 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id EEA906ACB2
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 00:17:46 +0100 (BST)
Message-ID: <567820398.1143760666974.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 00:17:46 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12372591 ] 

Doug Cutting commented on HADOOP-96:
------------------------------------

This sounds like a great plan!

Hadoop's current log formatter has an option to log thread id's.  The namenode code can simply turn this on.   Also, one can configure the JVM to rotate logs using:

http://java.sun.com/j2se/1.4.2/docs/api/java/util/logging/FileHandler.html

In any case, we should add a timestamp to the log file names generated by bin/hadoop-daemon.sh, where standard out and error are logged, regardless of JVM log configuration.

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Priority: Critical

>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 23:30:00 2006
Return-Path: 
 <hadoop-dev-return-630-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 30616 invoked from network); 30 Mar 2006 23:30:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 23:30:00 -0000
Received: (qmail 73881 invoked by uid 500); 30 Mar 2006 23:29:59 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 73859 invoked by uid 500); 30 Mar 2006 23:29:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 73850 invoked by uid 99); 30 Mar 2006 23:29:59 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 15:29:59 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 15:29:59 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 255626ACB1
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 00:29:38 +0100 (BST)
Message-ID: <290540396.1143761378150.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 00:29:38 +0100 (BST)
From: "Owen O'Malley (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-100) Inconsistent locking of the
 JobTracker.taskTrackers field
In-Reply-To: <884327691.1143133758862.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-100?page=all ]

Owen O'Malley updated HADOOP-100:
---------------------------------

    Attachment: task-tracker-table-locking.patch

I made the table private instead of package local.

I also wrapped each of the references to the table with a lock on the table.

There is still a lingering issue with the webapp's use of JobTracker.taskTrackers(). If a status update comes in while the webapp is iterating through the taskTrackers, it will get a ConcurrentModificationException.

> Inconsistent locking of the JobTracker.taskTrackers field
> ---------------------------------------------------------
>
>          Key: HADOOP-100
>          URL: http://issues.apache.org/jira/browse/HADOOP-100
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: task-tracker-table-locking.patch
>
> The JobTracker is using an inconsistant lock for protecting taskTrackers, which is the list of current task trackers. Some of the routines lock the JobTracker and others lock the taskTrackers field.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Thu Mar 30 23:46:04 2006
Return-Path: 
 <hadoop-dev-return-631-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 34538 invoked from network); 30 Mar 2006 23:46:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 30 Mar 2006 23:46:04 -0000
Received: (qmail 87110 invoked by uid 500); 30 Mar 2006 23:46:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 87086 invoked by uid 500); 30 Mar 2006 23:46:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 87077 invoked by uid 99); 30 Mar 2006 23:46:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 15:46:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 15:46:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 069266ACB1
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 00:45:42 +0100 (BST)
Message-ID: <26982331.1143762342024.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 00:45:42 +0100 (BST)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12372598 ] 

Yoram Arnon commented on HADOOP-96:
-----------------------------------

OK.
we'll use the current log formatter, and just turn on the output of thread id when we're debugging.


> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Priority: Critical

>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 00:02:03 2006
Return-Path: 
 <hadoop-dev-return-632-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 39400 invoked from network); 31 Mar 2006 00:02:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 00:02:03 -0000
Received: (qmail 10476 invoked by uid 500); 31 Mar 2006 00:02:03 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 10456 invoked by uid 500); 31 Mar 2006 00:02:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 10447 invoked by uid 99); 31 Mar 2006 00:02:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:02:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:02:02 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id DB7AD6ACB2
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 01:01:41 +0100 (BST)
Message-ID: <990029513.1143763301896.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 01:01:41 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-100) Inconsistent locking of the
 JobTracker.taskTrackers field
In-Reply-To: <884327691.1143133758862.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-100?page=all ]
     
Doug Cutting resolved HADOOP-100:
---------------------------------

    Resolution: Fixed

I just committed this.  Thanks, Owen.

> Inconsistent locking of the JobTracker.taskTrackers field
> ---------------------------------------------------------
>
>          Key: HADOOP-100
>          URL: http://issues.apache.org/jira/browse/HADOOP-100
>      Project: Hadoop
>         Type: Bug
>   Components: mapred
>     Versions: 0.1
>     Reporter: Owen O'Malley
>     Assignee: Owen O'Malley
>      Fix For: 0.1
>  Attachments: task-tracker-table-locking.patch
>
> The JobTracker is using an inconsistant lock for protecting taskTrackers, which is the list of current task trackers. Some of the routines lock the JobTracker and others lock the taskTrackers field.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 00:08:58 2006
Return-Path: 
 <hadoop-dev-return-633-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 41059 invoked from network); 31 Mar 2006 00:08:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 00:08:58 -0000
Received: (qmail 15651 invoked by uid 500); 31 Mar 2006 00:08:58 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 15636 invoked by uid 500); 31 Mar 2006 00:08:58 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 15625 invoked by uid 99); 31 Mar 2006 00:08:58 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:08:57 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:08:57 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 8EDD96ACB3
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 01:08:36 +0100 (BST)
Message-ID: <1559112313.1143763716581.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 01:08:36 +0100 (BST)
From: "Yoram Arnon (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Assigned: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-96?page=all ]

Yoram Arnon reassigned HADOOP-96:
---------------------------------

    Assign To: Hairong Kuang

> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical

>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 00:28:24 2006
Return-Path: 
 <hadoop-dev-return-634-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 47910 invoked from network); 31 Mar 2006 00:28:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 00:28:24 -0000
Received: (qmail 23875 invoked by uid 500); 31 Mar 2006 00:28:24 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23854 invoked by uid 500); 31 Mar 2006 00:28:23 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23844 invoked by uid 99); 31 Mar 2006 00:28:23 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:28:23 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:28:23 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 390096ACB3
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 01:28:02 +0100 (BST)
Message-ID: <1914778036.1143764882230.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 01:28:02 +0100 (BST)
From: "eric baldeschwieler (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-96) name server should log decisions that
 affect data: block creation, removal, replication
In-Reply-To: <949326300.1142961002892.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-96?page=comments#action_12372603 ] 

eric baldeschwieler commented on HADOOP-96:
-------------------------------------------

One thing that really helped us was to be able to specify the duration to keep log files.  So you could configure the system to keep up to N seconds of logs (think one month).  This way logs don't grow without bound, but you can be confident how much history will be available.  Also, logs gzip pretty well.  It would be nice to zip closed logs automatically.

Don't know how much of this you can get for free from the existing logs packages.  Should investigate this.

Are we just logging on the name node, or are data nodes logging all events too.  Seems like that would be desirable as well.  Using the same mechanisms of course.


> name server should log decisions that affect data: block creation, removal, replication
> ---------------------------------------------------------------------------------------
>
>          Key: HADOOP-96
>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>      Project: Hadoop
>         Type: Improvement
>   Components: dfs
>     Versions: 0.1
>     Reporter: Yoram Arnon
>     Assignee: Hairong Kuang
>     Priority: Critical

>
> currently, there's no way to analyze and debug DFS errors where blocks disapear.
> name server should log its decisions that affect data, including block creation, removal, replication:
> - block <b> created, assigned to datanodes A, B, ...
> - datanode A dead, block <b> underreplicated(1), replicating to datanode C
> - datanode B dead, block <b> underreplicated(2), replicating to datanode D
> - datanode A alive, block <b> overreplicated, removing from datanode D
> - block <removed> from datanodes C, D, ...
> that will enable me to track down, two weeks later, a block that's missing from a file, and to debug the name server.
> extra credit:
> - rotate log file, as it might grow large
> - make this behaviour optional/configurable

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 00:32:18 2006
Return-Path: 
 <hadoop-dev-return-635-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 49704 invoked from network); 31 Mar 2006 00:32:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 00:32:18 -0000
Received: (qmail 26824 invoked by uid 500); 31 Mar 2006 00:32:18 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 26733 invoked by uid 500); 31 Mar 2006 00:32:18 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 26724 invoked by uid 99); 31 Mar 2006 00:32:18 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:32:18 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [216.145.54.173] (HELO mrout3.yahoo.com) (216.145.54.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:32:17 -0800
Received: from SNV-XCHMAIL.xch.corp.yahoo.com (snv-xch2.xch.corp.yahoo.com
 [216.145.51.235])
	by mrout3.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id k2V0UCV0032748
	for <hadoop-dev@lucene.apache.org>; Thu, 30 Mar 2006 16:30:12 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=received:mime-version:in-reply-to:references:content-type:
	message-id:content-transfer-encoding:from:subject:date:to:x-mailer:
	return-path:x-originalarrivaltime;
	b=PaPYSVuat0qrQjVUYAFmIatB8XrKPaPgiJ/KNJl2z+9LdRwoMwkG84H8PlQsCnOZ
Received: from [207.126.231.236] ([207.126.231.236]) by
 SNV-XCHMAIL.xch.corp.yahoo.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Thu, 30 Mar 2006 16:30:11 -0800
Mime-Version: 1.0 (Apple Message framework v746.2)
In-Reply-To: <1559112313.1143763716581.JavaMail.jira@ajax>
References: <1559112313.1143763716581.JavaMail.jira@ajax>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <A7CFDAC0-5A9B-45F0-8112-F7929A3389DF@yahoo-inc.com>
Content-Transfer-Encoding: 7bit
From: Eric Baldeschwieler <eric14@yahoo-inc.com>
Subject: Re: [jira] Assigned: (HADOOP-96) name server should log decisions
 that affect data: block creation, removal, replication
Date: Thu, 30 Mar 2006 16:30:11 -0800
To: hadoop-dev@lucene.apache.org
X-Mailer: Apple Mail (2.746.2)
X-OriginalArrivalTime: 31 Mar 2006 00:30:11.0704 (UTC)
 FILETIME=[45891780:01C6545A]
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

do we have an easy way of loading the some of the name nodes (and  
data nodes) local directories into HDFs space?  This is an easy trick  
that would make it trivial to apply map-reduce to distributed log  
grepping.  Should we add that?  Had good success with this sort of  
thing with previous systems.

EG.

hdfs://blah:6666/SYSTEM/namenodes/<host:port>/logs/

just points allows one to HDFS browse the logs directory of a name  
node.  Can then use the plan-9 trick of putting all kinds of API info  
into "files" on the data nodes (be they real files or CGI equivalents).

Should I file a bug on this?


On Mar 30, 2006, at 4:08 PM, Yoram Arnon (JIRA) wrote:

>      [ http://issues.apache.org/jira/browse/HADOOP-96?page=all ]
>
> Yoram Arnon reassigned HADOOP-96:
> ---------------------------------
>
>     Assign To: Hairong Kuang
>
>> name server should log decisions that affect data: block creation,  
>> removal, replication
>> --------------------------------------------------------------------- 
>> ------------------
>>
>>          Key: HADOOP-96
>>          URL: http://issues.apache.org/jira/browse/HADOOP-96
>>      Project: Hadoop
>>         Type: Improvement
>>   Components: dfs
>>     Versions: 0.1
>>     Reporter: Yoram Arnon
>>     Assignee: Hairong Kuang
>>     Priority: Critical
>
>>
>> currently, there's no way to analyze and debug DFS errors where  
>> blocks disapear.
>> name server should log its decisions that affect data, including  
>> block creation, removal, replication:
>> - block <b> created, assigned to datanodes A, B, ...
>> - datanode A dead, block <b> underreplicated(1), replicating to  
>> datanode C
>> - datanode B dead, block <b> underreplicated(2), replicating to  
>> datanode D
>> - datanode A alive, block <b> overreplicated, removing from  
>> datanode D
>> - block <removed> from datanodes C, D, ...
>> that will enable me to track down, two weeks later, a block that's  
>> missing from a file, and to debug the name server.
>> extra credit:
>> - rotate log file, as it might grow large
>> - make this behaviour optional/configurable
>
> -- 
> This message is automatically generated by JIRA.
> -
> If you think it was sent incorrectly contact one of the  
> administrators:
>    http://issues.apache.org/jira/secure/Administrators.jspa
> -
> For more information on JIRA, see:
>    http://www.atlassian.com/software/jira
>


From MAILER-DAEMON Fri Mar 31 00:39:50 2006
Return-Path: 
 <hadoop-dev-return-636-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53402 invoked from network); 31 Mar 2006 00:39:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 00:39:50 -0000
Received: (qmail 31028 invoked by uid 500); 31 Mar 2006 00:39:50 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31005 invoked by uid 500); 31 Mar 2006 00:39:49 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 30995 invoked by uid 99); 31 Mar 2006 00:39:49 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:39:49 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:39:49 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 715186ACB2
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 01:39:28 +0100 (BST)
Message-ID: <1432024516.1143765568461.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 01:39:28 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Updated: (HADOOP-102) Two identical consecutive loops in
 FSNamesystem.chooseTarget()
In-Reply-To: <699062040.1143165859759.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-102?page=all ]

Doug Cutting updated HADOOP-102:
--------------------------------

      Component: dfs
    Fix Version: 0.1
        Version: 0.1
      Assign To: Konstantin Shvachko

> Two identical consecutive loops in FSNamesystem.chooseTarget()
> --------------------------------------------------------------
>
>          Key: HADOOP-102
>          URL: http://issues.apache.org/jira/browse/HADOOP-102
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.1
>  Attachments: chooseTargets.patch
>
> I think this was meant to be the way I corrected.
> Otherwise there is no difference in two loops except for double
> bracketing in the if statement.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 00:39:51 2006
Return-Path: 
 <hadoop-dev-return-637-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53416 invoked from network); 31 Mar 2006 00:39:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 00:39:51 -0000
Received: (qmail 31200 invoked by uid 500); 31 Mar 2006 00:39:51 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 31110 invoked by uid 500); 31 Mar 2006 00:39:50 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 31101 invoked by uid 99); 31 Mar 2006 00:39:50 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:39:50 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 16:39:50 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 3A71F6ACB1
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 01:39:29 +0100 (BST)
Message-ID: <1772183818.1143765569236.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 01:39:29 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-102) Two identical consecutive loops in
 FSNamesystem.chooseTarget()
In-Reply-To: <699062040.1143165859759.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-102?page=all ]
     
Doug Cutting resolved HADOOP-102:
---------------------------------

    Resolution: Fixed

I just committed the patch.  Thanks, Konstantin.

> Two identical consecutive loops in FSNamesystem.chooseTarget()
> --------------------------------------------------------------
>
>          Key: HADOOP-102
>          URL: http://issues.apache.org/jira/browse/HADOOP-102
>      Project: Hadoop
>         Type: Bug
>   Components: dfs
>     Versions: 0.1
>     Reporter: Konstantin Shvachko
>     Assignee: Konstantin Shvachko
>      Fix For: 0.1
>  Attachments: chooseTargets.patch
>
> I think this was meant to be the way I corrected.
> Otherwise there is no difference in two loops except for double
> bracketing in the if statement.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 05:15:02 2006
Return-Path: 
 <hadoop-dev-return-638-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 44695 invoked from network); 31 Mar 2006 05:15:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 05:15:02 -0000
Received: (qmail 8322 invoked by uid 500); 31 Mar 2006 05:14:59 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 8302 invoked by uid 500); 31 Mar 2006 05:14:59 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 7942 invoked by uid 99); 31 Mar 2006 05:14:57 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 21:14:57 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of emanihc@gmail.com designates
 64.233.162.207 as permitted sender)
Received: from [64.233.162.207] (HELO zproxy.gmail.com) (64.233.162.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 21:14:57 -0800
Received: by zproxy.gmail.com with SMTP id 13so635897nzn
        for <hadoop-dev@lucene.apache.org>;
 Thu, 30 Mar 2006 21:14:34 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=WOZ/JiX5te2ff6EtSGzBIeT7yKomE14Iy5LBNCoQtpXE9erFzHQs7lIFLGgkLhiHTBOjuU0BHaw5tx4x7nxdbVb5JTTS5cHuUduSgOUPgzwrNIQEeNxgHrkgB7ul8pe+m8EhC6GhB5YGanBXNbRCxmyr2JhmCgfwdeWWBeteCoI=
Received: by 10.36.39.10 with SMTP id m10mr18134nzm;
        Thu, 30 Mar 2006 21:14:34 -0800 (PST)
Received: by 10.37.22.30 with HTTP; Thu, 30 Mar 2006 21:14:34 -0800 (PST)
Message-ID: <39209b600603302114v1ee18c5bi32f3a6610e754518@mail.gmail.com>
Date: Fri, 31 Mar 2006 13:14:34 +0800
From: emanihc <emanihc@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
In-Reply-To: <442C2458.80605@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_5484_8167598.1143782074296"
References: <4429ABAB.7030802@apache.org> <442A2205.6030406@getopt.org>
	 <442AC86F.1070002@apache.org> <442ACAC5.2090300@getopt.org>
	 <442B37CE.2040401@yahoo-inc.com> <442C2458.80605@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_5484_8167598.1143782074296
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Hello Doug, is it possible to support cygwin in this release?

2006/3/31, Doug Cutting <cutting@apache.org>:
>
> Konstantin Shvachko wrote:
> > Just one thing. Let's do it as Doug proposed earlier
> > hadoop dfs -check
>
> It's only given this name in bin/hadoop.  It should break no code to
> change what 'bin/hadoop fsck' does in the future.  So I don't see how it
> makes a difference whether this is invoked as 'bin/hadoop dfs -check' or
> 'bin/hadoop fsck'.  If someone is parsing the output of bin/hadoop
> commands then they could be broken, but that would be a fragile program
> anyway.  Updating what 'bin/hadoop fsck' does will not change any public
> APIs.
>
> > This is a good piece of code, but too far from what the real
> > fsck should do to deserve the name :-)
>
> It is the closest thing we have now.
>
> Doug
>

------=_Part_5484_8167598.1143782074296--

From MAILER-DAEMON Fri Mar 31 07:24:59 2006
Return-Path: 
 <hadoop-dev-return-639-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 19003 invoked from network); 31 Mar 2006 07:24:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 07:24:59 -0000
Received: (qmail 23394 invoked by uid 500); 31 Mar 2006 07:24:56 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 23311 invoked by uid 500); 31 Mar 2006 07:24:55 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 23293 invoked by uid 99); 31 Mar 2006 07:24:55 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 23:24:55 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Mar 2006 23:24:54 -0800
Received: from explainfloorlx (snvvpn2-10-72-76-c20.corp.yahoo.com
 [10.72.76.20])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k2V7OTTc001383;
	Thu, 30 Mar 2006 23:24:29 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=D+cvnGvCXMRHJawNEMhQDNPkoB26npO9GJ1ktSxmhnFBwjPfoTEdMp3jBOAmxYEK
From: "Runping Qi" <runping@yahoo-inc.com>
To: <hadoop-user@lucene.apache.org>, <hadoop-dev@lucene.apache.org>
Subject: RE: Different Key/Value classes for Map and Reduce?
Date: Thu, 30 Mar 2006 23:26:19 -0800
Message-ID: <006201c65494$68382200$e6e77ecf@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <000601c65431$eec75790$d09215ac@ds.corp.yahoo.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZTvtF6CucszdTaRxWJWxE64pczcwAcJw5wABi5rfA=
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N



I think Teppo Kurki raised a valid point and may reveal a serious defect of
Hadoop. 

When map tasks write intermediate data out, they always use SequencialFile
RecordWriter with key/value classes from the job object.

When the reducers write the final results out, its output format is obtained
from the job object. By default, it is TextOutputFormat, and no conflicts.
However, if one wants to use SequencialFileFormat for the final results,
then the key/value classes are also obtained from the job object, the same
as the map tasks' output. Now we have a problem. It is impossible for the
map outputs and reducer outputs use different key/value classes, if one
wants the reducers generate outputs in SequentialFileFormat.

Runping
 
 
-----Original Message-----
From: Hairong Kuang [mailto:hairong@yahoo-inc.com] 
Sent: Thursday, March 30, 2006 11:41 AM
To: hadoop-user@lucene.apache.org
Subject: RE: Different Key/Value classes for Map and Reduce?

The input format specifies the format of your input files. The default
format is TextInputFormat, which the key is LongWritable (the offset of the
line in the file) and the type of value is UTF8 ( the line). So your program
does not need to specify the input format and does not need to set the input
key type and the input value type.

The output format specifies the format of the output files of the map job.
The default is TextOutputFormat. In your program, your map task emits
(LongWritable, UTF8) pairs. So you need to do

    statJob.setOutputKeyClass(LongWritable.class); // not IntWritable
    statJob.setOutputValueClass(UTF8.class);

Hope it helps.

Hairong

-----Original Message-----
From: Teppo Kurki [mailto:tjk@iki.fi] 
Sent: Wednesday, March 29, 2006 9:57 PM
To: hadoop-user@lucene.apache.org
Subject: Re: Different Key/Value classes for Map and Reduce?

Hairong Kuang wrote:

>Did you create your input file using a SequenceFile.Writer?
>
>  
>
No, my input files are line-oriented log files, conceptually similar to the
Grep example.

Here's what I'm trying to do in a simplified example (parsing the lines
replaced with simulation code).

public class MapRedClassDemo implements Mapper, Reducer {
  long count = 0;

  public void configure(JobConf job) {}
  public void close() throws IOException {}

  public void map(WritableComparable key, Writable value,
      OutputCollector output, Reporter reporter) throws IOException {
    String line = ((UTF8) value).toString();
    String s = "demo" + line.length();
    output.collect(new LongWritable(count++ % 20), new UTF8(s));
  }

  public void reduce(WritableComparable key, Iterator values,
      OutputCollector output, Reporter reporter) throws IOException {
    Set set = new HashSet();
    while (values.hasNext()) {
      set.add(values.next());
    }
    // output.collect(key, new IntWritable(set.size()));
    output.collect(key, new UTF8("" + set.size()));
  }

  public static void main(String[] args) throws Exception {
    Configuration defaults = new Configuration();
    JobConf statJob = new JobConf(defaults, MapRedClassDemo.class);

    statJob.setInputDir(new File(args[0]));
    statJob.setMapperClass(MapRedClassDemo.class);
    statJob.setReducerClass(MapRedClassDemo.class);

    statJob.setInputKeyClass(LongWritable.class);
    statJob.setInputValueClass(UTF8.class);
    statJob.setOutputDir(new File(args[1] + "/" + System.currentTimeMillis()
        + "/"));
    statJob.setOutputFormat(TextOutputFormat.class);
    statJob.setOutputKeyClass(LongWritable.class);
    // statJob.setOutputValueClass(IntWritable.class);
    statJob.setOutputValueClass(UTF8.class);

    JobClient.runJob(statJob);
  }

}

This works, since both Map and Reduce emit <LongWritable, UTF8> pairs. 
If tried with statJob.setOutputValueClass(IntWritable.class) and Recuce
emitting <LongWritable,IntWritable>s  the _Map_ operation fails with

java.io.IOException: wrong value class: demo310 is not class
org.apache.hadoop.io.IntWritable
    at
org.apache.hadoop.io.SequenceFile$Writer.append(SequenceFile.java:150)
    at org.apache.hadoop.mapred.MapTask$2.collect(MapTask.java:92)

so it appears that the setInputXXClass methods have no effect on the Map
phase.

Or have I understood something completely wrong?





From MAILER-DAEMON Fri Mar 31 08:38:03 2006
Return-Path: 
 <hadoop-dev-return-640-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 65123 invoked from network); 31 Mar 2006 08:38:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 08:38:03 -0000
Received: (qmail 89789 invoked by uid 500); 31 Mar 2006 08:37:52 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89698 invoked by uid 500); 31 Mar 2006 08:37:52 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89689 invoked by uid 99); 31 Mar 2006 08:37:51 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 00:37:51 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 00:37:51 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 5B0A46ACB2
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 09:37:30 +0100 (BST)
Message-ID: <1763868693.1143794250370.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 09:37:30 +0100 (BST)
From: "Jerome Charron (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Moved: (HADOOP-114) Non-informative error message
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-114?page=all ]

Jerome Charron moved NUTCH-241 to HADOOP-114:
---------------------------------------------

       Project: Hadoop  (was: Nutch)
           Key: HADOOP-114  (was: NUTCH-241)
    Issue Type: Improvement  (was: Bug)
       Version: 0.1
                    (was: 0.8-dev)

> Non-informative error message
> -----------------------------
>
>          Key: HADOOP-114
>          URL: http://issues.apache.org/jira/browse/HADOOP-114
>      Project: Hadoop
>         Type: Improvement
>     Versions: 0.1
>     Reporter: Rod Taylor
>     Priority: Trivial
>  Attachments: nutch241-tasktracker-warning-correction.patch
>
> 060330 105006 mapred.child.heap.size is deprecated. Use mapred.child.heap.size instead. Meantime, interpolated child.heap.size into child.java.opt: -Xmx200m
> The instructions inform you to use the deprecated option.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 12:28:43 2006
Return-Path: 
 <hadoop-dev-return-641-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 94674 invoked from network); 31 Mar 2006 12:28:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 12:28:43 -0000
Received: (qmail 89486 invoked by uid 500); 31 Mar 2006 12:28:42 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 89462 invoked by uid 500); 31 Mar 2006 12:28:42 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 89452 invoked by uid 99); 31 Mar 2006 12:28:42 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 04:28:42 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of d.zbik@softwaremind.pl
 designates 62.233.162.146 as permitted sender)
Received: from [62.233.162.146] (HELO mail.softwaremind.pl) (62.233.162.146)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 04:28:39 -0800
Received: from localhost (localhost.softwaremind.pl [127.0.0.1])
	by mail.softwaremind.pl (Postfix) with ESMTP id AFFE52845E
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 14:28:17 +0200 (CEST)
Received: from mail.softwaremind.pl ([127.0.0.1])
 by localhost (server.softwaremind.pl [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 23779-05 for <hadoop-dev@lucene.apache.org>;
 Fri, 31 Mar 2006 14:28:07 +0200 (CEST)
Received: from [193.203.246.180] (unknown [193.203.246.180])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.softwaremind.pl (Postfix) with ESMTP id 46EA32845D
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 14:28:06 +0200 (CEST)
Message-ID: <442D204E.7070705@softwaremind.pl>
Date: Fri, 31 Mar 2006 13:27:58 +0100
From: Darek Zbik <d.zbik@softwaremind.pl>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
 rv:1.7.10) Gecko/20050716
X-Accept-Language: en-us, en, pl
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: Different Key/Value classes for Map and Reduce?
References: <006201c65494$68382200$e6e77ecf@ds.corp.yahoo.com>
In-Reply-To: <006201c65494$68382200$e6e77ecf@ds.corp.yahoo.com>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by amavisd-new at mail.softwaremind.pl
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Runping Qi wrote:

>When the reducers write the final results out, its output format is obtained
>from the job object. By default, it is TextOutputFormat, and no conflicts.
>However, if one wants to use SequencialFileFormat for the final results,
>then the key/value classes are also obtained from the job object, the same
>as the map tasks' output. Now we have a problem. It is impossible for the
>map outputs and reducer outputs use different key/value classes, if one
>wants the reducers generate outputs in SequentialFileFormat.
>
>  
>
I have this problem in real situation. I solve it by creating my own output
format which is in fact copy-paste of the SequentialFileFormat with small
changes (simply a took output class from ohter (my own) job property). I 
think
that each hadoop job shoud have posibility to denote output key/value from
reduce task (eg. {set,get}ReducerOutput{Key,Value}).

darek



From MAILER-DAEMON Fri Mar 31 15:20:12 2006
Return-Path: 
 <hadoop-dev-return-642-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 95093 invoked from network); 31 Mar 2006 15:20:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 15:20:12 -0000
Received: (qmail 77616 invoked by uid 500); 31 Mar 2006 15:20:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 77595 invoked by uid 500); 31 Mar 2006 15:20:11 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 77586 invoked by uid 99); 31 Mar 2006 15:20:11 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 07:20:11 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=DNS_FROM_RFC_ABUSE,DNS_FROM_RFC_WHOIS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [216.109.112.27] (HELO mrout1-b.corp.dcn.yahoo.com)
 (216.109.112.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 07:20:09 -0800
Received: from explainfloorlx (snvvpn2-10-72-76-c20.corp.yahoo.com
 [10.72.76.20])
	by mrout1-b.corp.dcn.yahoo.com (8.13.6/8.13.4/y.out) with ESMTP id
 k2VFJc5k040112
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 07:19:38 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; s=serpent; d=yahoo-inc.com; c=nofws; q=dns;
	h=from:to:subject:date:message-id:mime-version:content-type:
	content-transfer-encoding:x-mailer:in-reply-to:x-mimeole:thread-index;
	b=OBFXkkTQ1GYUR5nNK60fmmqx6yUJ3XLBZ7fWVaQP9lL5CMADvOV99CbIU3uiNgoh
From: "Runping Qi" <runping@yahoo-inc.com>
To: <hadoop-dev@lucene.apache.org>
Subject: RE: Different Key/Value classes for Map and Reduce?
Date: Fri, 31 Mar 2006 07:21:34 -0800
Message-ID: <006301c654d6$cc9d4030$e6e77ecf@ds.corp.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <442D204E.7070705@softwaremind.pl>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180
Thread-Index: AcZUvqlyjGDAjyW+QeWwPKFqmEdV0wAF35qw
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N


A simple fix is to add another two attributes to JobConf class:
mapOutputLeyClass and mapOutputValueClass. That allows the user to have
different key/value classes for the intermediate and final outputs.

I'll file a bug for this problem.


Runping


-----Original Message-----
From: Darek Zbik [mailto:d.zbik@softwaremind.pl] 
Sent: Friday, March 31, 2006 4:28 AM
To: hadoop-dev@lucene.apache.org
Subject: Re: Different Key/Value classes for Map and Reduce?

Runping Qi wrote:

>When the reducers write the final results out, its output format is
obtained
>from the job object. By default, it is TextOutputFormat, and no conflicts.
>However, if one wants to use SequencialFileFormat for the final results,
>then the key/value classes are also obtained from the job object, the same
>as the map tasks' output. Now we have a problem. It is impossible for the
>map outputs and reducer outputs use different key/value classes, if one
>wants the reducers generate outputs in SequentialFileFormat.
>
>  
>
I have this problem in real situation. I solve it by creating my own output
format which is in fact copy-paste of the SequentialFileFormat with small
changes (simply a took output class from ohter (my own) job property). I 
think
that each hadoop job shoud have posibility to denote output key/value from
reduce task (eg. {set,get}ReducerOutput{Key,Value}).

darek




From MAILER-DAEMON Fri Mar 31 15:32:02 2006
Return-Path: 
 <hadoop-dev-return-643-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 2314 invoked from network); 31 Mar 2006 15:32:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 15:32:02 -0000
Received: (qmail 96786 invoked by uid 500); 31 Mar 2006 15:32:01 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 96769 invoked by uid 500); 31 Mar 2006 15:32:01 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 96760 invoked by uid 99); 31 Mar 2006 15:32:01 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 07:32:01 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 07:32:01 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 372026ACB1
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 16:31:40 +0100 (BST)
Message-ID: <393765989.1143819100222.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 16:31:40 +0100 (BST)
From: "Runping Qi (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Created: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output. 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------

         Key: HADOOP-115
         URL: http://issues.apache.org/jira/browse/HADOOP-115
     Project: Hadoop
        Type: Improvement
  Components: mapred  
    Reporter: Runping Qi



When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.

When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.

A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.



-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 16:52:04 2006
Return-Path: 
 <hadoop-dev-return-644-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 43353 invoked from network); 31 Mar 2006 16:52:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 16:52:04 -0000
Received: (qmail 80880 invoked by uid 500); 31 Mar 2006 16:52:04 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 80858 invoked by uid 500); 31 Mar 2006 16:52:03 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 80849 invoked by uid 99); 31 Mar 2006 16:52:03 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 08:52:03 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 08:52:03 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 61BEF6ACB2
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 17:51:42 +0100 (BST)
Message-ID: <985469168.1143823902397.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 17:51:42 +0100 (BST)
From: "Darek Zbik (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Commented: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

    [ http://issues.apache.org/jira/browse/HADOOP-115?page=comments#action_12372700 ] 

Darek Zbik commented on HADOOP-115:
-----------------------------------

New attibutes in the JobConf should denote output from reduce task not from map as suggest a the name mapOutputValueClass.

> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 17:10:11 2006
Return-Path: 
 <hadoop-dev-return-645-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 51548 invoked from network); 31 Mar 2006 17:10:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 17:10:11 -0000
Received: (qmail 24447 invoked by uid 500); 31 Mar 2006 17:10:11 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 24356 invoked by uid 500); 31 Mar 2006 17:10:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 24347 invoked by uid 99); 31 Mar 2006 17:10:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 09:10:10 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: neutral (asf.osuosl.org: local policy)
Received: from [207.115.57.60] (HELO ylpvm29.prodigy.net) (207.115.57.60)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 09:10:09 -0800
Received: from pimout6-ext.prodigy.net (pimout6-int.prodigy.net
 [207.115.4.22])
	by ylpvm29.prodigy.net (8.12.10 outbound/8.12.10) with ESMTP id
 k2VH9Abk018049
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 12:09:12 -0500
X-ORBL: [69.228.218.169]
Received: from [192.168.168.15] (adsl-69-228-218-169.dsl.pltn13.pacbell.net
 [69.228.218.169])
	by pimout6-ext.prodigy.net (8.13.4 outbound domainkey aix/8.13.4) with ESMTP
 id k2VH9YFh192978;
	Fri, 31 Mar 2006 12:09:39 -0500
Message-ID: <442D624E.1070106@apache.org>
Date: Fri, 31 Mar 2006 09:09:34 -0800
From: Doug Cutting <cutting@apache.org>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051013)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
References: <4429ABAB.7030802@apache.org>
 <442A2205.6030406@getopt.org>	 <442AC86F.1070002@apache.org>
 <442ACAC5.2090300@getopt.org>	 <442B37CE.2040401@yahoo-inc.com>
 <442C2458.80605@apache.org>
 <39209b600603302114v1ee18c5bi32f3a6610e754518@mail.gmail.com>
In-Reply-To: <39209b600603302114v1ee18c5bi32f3a6610e754518@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

emanihc wrote:
> Hello Doug, is it possible to support cygwin in this release?

Yes, that is the intent.

Doug

From MAILER-DAEMON Fri Mar 31 17:14:31 2006
Return-Path: 
 <hadoop-dev-return-646-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 53537 invoked from network); 31 Mar 2006 17:14:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 17:14:31 -0000
Received: (qmail 36674 invoked by uid 500); 31 Mar 2006 17:14:31 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 36654 invoked by uid 500); 31 Mar 2006 17:14:30 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 36645 invoked by uid 99); 31 Mar 2006 17:14:30 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 09:14:30 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: domain of emanihc@gmail.com designates
 64.233.162.201 as permitted sender)
Received: from [64.233.162.201] (HELO zproxy.gmail.com) (64.233.162.201)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 09:14:30 -0800
Received: by zproxy.gmail.com with SMTP id 13so841495nzn
        for <hadoop-dev@lucene.apache.org>;
 Fri, 31 Mar 2006 09:14:09 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Pj78V46xMuEdf/zd5Z1hGUHuYJVDnMHyju1uB6LHtfMtDtghTnoLTqeWESLZPmfNmpy1s7C8wNH/FWiF3mhZEqTc8qXYI796d+jRCjmmWpdD48em7DZ7gnkl6LT+73YT1I5Ag8ywUxRpWybyFen/a5S+ic3h4CzY6HT4Nx5Ybec=
Received: by 10.36.120.19 with SMTP id s19mr453670nzc;
        Fri, 31 Mar 2006 09:14:09 -0800 (PST)
Received: by 10.37.22.30 with HTTP; Fri, 31 Mar 2006 09:14:09 -0800 (PST)
Message-ID: <39209b600603310914h7e56d54cha9f7ece98344f763@mail.gmail.com>
Date: Sat, 1 Apr 2006 01:14:09 +0800
From: emanihc <emanihc@gmail.com>
To: hadoop-dev@lucene.apache.org
Subject: Re: release 0.1
In-Reply-To: <442D624E.1070106@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_7457_17427377.1143825249575"
References: <4429ABAB.7030802@apache.org> <442A2205.6030406@getopt.org>
	 <442AC86F.1070002@apache.org> <442ACAC5.2090300@getopt.org>
	 <442B37CE.2040401@yahoo-inc.com> <442C2458.80605@apache.org>
	 <39209b600603302114v1ee18c5bi32f3a6610e754518@mail.gmail.com>
	 <442D624E.1070106@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

------=_Part_7457_17427377.1143825249575
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Great! Thanks for your reply :)



2006/4/1, Doug Cutting <cutting@apache.org>:
>
> emanihc wrote:
> > Hello Doug, is it possible to support cygwin in this release?
>
> Yes, that is the intent.
>
> Doug
>

------=_Part_7457_17427377.1143825249575--

From MAILER-DAEMON Fri Mar 31 17:18:10 2006
Return-Path: 
 <hadoop-dev-return-647-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 54812 invoked from network); 31 Mar 2006 17:18:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 17:18:10 -0000
Received: (qmail 47393 invoked by uid 500); 31 Mar 2006 17:18:10 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 47377 invoked by uid 500); 31 Mar 2006 17:18:10 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 47362 invoked by uid 99); 31 Mar 2006 17:18:10 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 09:18:10 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received: from [192.87.106.226] (HELO ajax.apache.org) (192.87.106.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 09:18:09 -0800
Received: from ajax (localhost.localdomain [127.0.0.1])
	by ajax.apache.org (Postfix) with ESMTP id 9BC666ACB1
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 18:17:48 +0100 (BST)
Message-ID: <965888895.1143825468635.JavaMail.jira@ajax>
Date: Fri, 31 Mar 2006 18:17:48 +0100 (BST)
From: "Doug Cutting (JIRA)" <jira@apache.org>
To: hadoop-dev@lucene.apache.org
Subject: [jira] Resolved: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
In-Reply-To: <393765989.1143819100222.JavaMail.jira@ajax>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

     [ http://issues.apache.org/jira/browse/HADOOP-115?page=all ]
     
Doug Cutting resolved HADOOP-115:
---------------------------------

    Resolution: Won't Fix

This is the way it is supposed to work.  From the MapReduce paper:

  map (k1,v1) ! list(k2,v2)
  reduce (k2,list(v2)) ! list(v2)

  I.e., the input keys and values are drawn from a different
  domain than the output keys and values. Furthermore,
  the intermediate keys and values are from the same domain
  as the output keys and values.

I am closing this bug.  If someone feels strongly that we should extend the MapReduce model in this direction, then we can re-open it.  But, as it stands, things work as intended.

> Hadoop should allow the user to use SequentialFileOutputformat as the output format and to choose  key/value classes that are different from those for map output.
> ------------------------------------------------------------------------------------------------------------------------------------------------------------------
>
>          Key: HADOOP-115
>          URL: http://issues.apache.org/jira/browse/HADOOP-115
>      Project: Hadoop
>         Type: Improvement
>   Components: mapred
>     Reporter: Runping Qi

>
> When map tasks write intermediate data out, they always use SequencialFile RecordWriter with key/value classes from the job object.
> When the reducers write the final results out, its output format is obtained from the job object. By default, it is TextOutputFormat, and no conflicts.
> However, if one wants to use SequencialFileFormat for the final results, then the key/value classes are also obtained from the job object, the same as the map tasks' output. Now we have a problem. It is impossible for the map outputs and reducer outputs use different key/value classes, if one wants the reducers generate outputs in SequentialFileFormat.
> A simple fix would be to add another two attributes to JobConf class: mapOutputLeyClass and mapOutputValueClass. That allows the user to have different key/value classes for the intermediate and final outputs.

-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:
   http://issues.apache.org/jira/secure/Administrators.jspa
-
For more information on JIRA, see:
   http://www.atlassian.com/software/jira


From MAILER-DAEMON Fri Mar 31 18:18:30 2006
Return-Path: 
 <hadoop-dev-return-648-apmail-lucene-hadoop-dev-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-hadoop-dev-archive@locus.apache.org
Received: (qmail 81520 invoked from network); 31 Mar 2006 18:18:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur.apache.org with SMTP; 31 Mar 2006 18:18:30 -0000
Received: (qmail 84864 invoked by uid 500); 31 Mar 2006 18:18:29 -0000
Delivered-To: apmail-lucene-hadoop-dev-archive@lucene.apache.org
Received: (qmail 84849 invoked by uid 500); 31 Mar 2006 18:18:29 -0000
Mailing-List: contact hadoop-dev-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:hadoop-dev-help@lucene.apache.org>
List-Unsubscribe: <mailto:hadoop-dev-unsubscribe@lucene.apache.org>
List-Post: <mailto:hadoop-dev@lucene.apache.org>
List-Id: <hadoop-dev.lucene.apache.org>
Reply-To: hadoop-dev@lucene.apache.org
Delivered-To: mailing list hadoop-dev@lucene.apache.org
Received: (qmail 84840 invoked by uid 99); 31 Mar 2006 18:18:29 -0000
Received: from asf.osuosl.org (HELO asf.osuosl.org) (140.211.166.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 10:18:29 -0800
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=
X-Spam-Check-By: apache.org
Received-SPF: pass (asf.osuosl.org: local policy)
Received: from [64.62.190.91] (HELO mcnabbs.org) (64.62.190.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 31 Mar 2006 10:18:27 -0800
Received: from maude.mcnabbs.org (unknown [128.187.143.203])
	by mcnabbs.org (Postfix) with ESMTP id 163103759D
	for <hadoop-dev@lucene.apache.org>; Fri, 31 Mar 2006 12:18:07 -0600 (CST)
Received: by maude.mcnabbs.org (Postfix, from userid 501)
	id 5E02E53FC4B; Fri, 31 Mar 2006 11:18:48 -0700 (MST)
Date: Fri, 31 Mar 2006 11:18:48 -0700
From: Andrew McNabb <amcnabb@mcnabbs.org>
To: hadoop-dev@lucene.apache.org
Subject: Re: [jira] Resolved: (HADOOP-115) Hadoop should allow the user to use
 SequentialFileOutputformat as the output format and to choose  key/value
 classes that are different from those for map output.
Message-ID: <20060331181847.GB6509@mcnabbs.org>
References: <393765989.1143819100222.JavaMail.jira@ajax>
 <965888895.1143825468635.JavaMail.jira@ajax>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="Fba/0zbH8Xs+Fj9o"
Content-Disposition: inline
In-Reply-To: <965888895.1143825468635.JavaMail.jira@ajax>
User-Agent: Mutt/1.5.11
X-Virus-Checked: Checked by ClamAV on apache.org
X-Spam-Rating: minotaur.apache.org 1.6.2 0/1000/N

--Fba/0zbH8Xs+Fj9o
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Fri, Mar 31, 2006 at 06:17:48PM +0100, Doug Cutting (JIRA) wrote:
>=20
> This is the way it is supposed to work.  From the MapReduce paper:
>=20
>   map (k1,v1) ! list(k2,v2)
>   reduce (k2,list(v2)) ! list(v2)
>=20
>   I.e., the input keys and values are drawn from a different
>   domain than the output keys and values. Furthermore,
>   the intermediate keys and values are from the same domain
>   as the output keys and values.
>=20
> I am closing this bug.  If someone feels strongly that we should extend t=
he MapReduce model in this direction, then we can re-open it.  But, as it s=
tands, things work as intended.
>=20

I agree with you.  If you need to change keys, run a second map-reduce
phase.

--=20
Andrew McNabb
http://www.mcnabbs.org/andrew/
PGP Fingerprint: 8A17 B57C 6879 1863 DE55  8012 AB4D 6098 8826 6868

--Fba/0zbH8Xs+Fj9o
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2.2 (Darwin)

iD8DBQFELXKHq01gmIgmaGgRAnTKAJ4hEzfuwbbdh39qOvPvPHXf+FSDSwCePitE
Mo9KT8cqhI5/0g5g5RBIMP4=
=fHfH
-----END PGP SIGNATURE-----

--Fba/0zbH8Xs+Fj9o--

